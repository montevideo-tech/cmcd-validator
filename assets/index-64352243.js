(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function t(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(o){if(o.ep)return;o.ep=!0;const u=t(o);fetch(o.href,u)}})();var ya=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zb(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function M4(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){if(this instanceof r){var o=[null];o.push.apply(o,arguments);var u=Function.bind.apply(e,o);return new u}return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var o=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:function(){return n[r]}})}),t}var bm={},oY={get exports(){return bm},set exports(n){bm=n}},lT={},Ot={},lY={get exports(){return Ot},set exports(n){Ot=n}},vr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h0=Symbol.for("react.element"),uY=Symbol.for("react.portal"),cY=Symbol.for("react.fragment"),fY=Symbol.for("react.strict_mode"),dY=Symbol.for("react.profiler"),hY=Symbol.for("react.provider"),pY=Symbol.for("react.context"),gY=Symbol.for("react.forward_ref"),mY=Symbol.for("react.suspense"),vY=Symbol.for("react.memo"),yY=Symbol.for("react.lazy"),uk=Symbol.iterator;function EY(n){return n===null||typeof n!="object"?null:(n=uk&&n[uk]||n["@@iterator"],typeof n=="function"?n:null)}var w4={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O4=Object.assign,N4={};function dp(n,e,t){this.props=n,this.context=e,this.refs=N4,this.updater=t||w4}dp.prototype.isReactComponent={};dp.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};dp.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function F4(){}F4.prototype=dp.prototype;function eD(n,e,t){this.props=n,this.context=e,this.refs=N4,this.updater=t||w4}var tD=eD.prototype=new F4;tD.constructor=eD;O4(tD,dp.prototype);tD.isPureReactComponent=!0;var ck=Array.isArray,k4=Object.prototype.hasOwnProperty,nD={current:null},U4={key:!0,ref:!0,__self:!0,__source:!0};function B4(n,e,t){var r,o={},u=null,h=null;if(e!=null)for(r in e.ref!==void 0&&(h=e.ref),e.key!==void 0&&(u=""+e.key),e)k4.call(e,r)&&!U4.hasOwnProperty(r)&&(o[r]=e[r]);var f=arguments.length-2;if(f===1)o.children=t;else if(1<f){for(var d=Array(f),m=0;m<f;m++)d[m]=arguments[m+2];o.children=d}if(n&&n.defaultProps)for(r in f=n.defaultProps,f)o[r]===void 0&&(o[r]=f[r]);return{$$typeof:h0,type:n,key:u,ref:h,props:o,_owner:nD.current}}function _Y(n,e){return{$$typeof:h0,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function rD(n){return typeof n=="object"&&n!==null&&n.$$typeof===h0}function TY(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var fk=/\/+/g;function pC(n,e){return typeof n=="object"&&n!==null&&n.key!=null?TY(""+n.key):e.toString(36)}function _E(n,e,t,r,o){var u=typeof n;(u==="undefined"||u==="boolean")&&(n=null);var h=!1;if(n===null)h=!0;else switch(u){case"string":case"number":h=!0;break;case"object":switch(n.$$typeof){case h0:case uY:h=!0}}if(h)return h=n,o=o(h),n=r===""?"."+pC(h,0):r,ck(o)?(t="",n!=null&&(t=n.replace(fk,"$&/")+"/"),_E(o,e,t,"",function(m){return m})):o!=null&&(rD(o)&&(o=_Y(o,t+(!o.key||h&&h.key===o.key?"":(""+o.key).replace(fk,"$&/")+"/")+n)),e.push(o)),1;if(h=0,r=r===""?".":r+":",ck(n))for(var f=0;f<n.length;f++){u=n[f];var d=r+pC(u,f);h+=_E(u,e,t,d,o)}else if(d=EY(n),typeof d=="function")for(n=d.call(n),f=0;!(u=n.next()).done;)u=u.value,d=r+pC(u,f++),h+=_E(u,e,t,d,o);else if(u==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return h}function Ry(n,e,t){if(n==null)return n;var r=[],o=0;return _E(n,r,"","",function(u){return e.call(t,u,o++)}),r}function SY(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var zs={current:null},TE={transition:null},AY={ReactCurrentDispatcher:zs,ReactCurrentBatchConfig:TE,ReactCurrentOwner:nD};vr.Children={map:Ry,forEach:function(n,e,t){Ry(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Ry(n,function(){e++}),e},toArray:function(n){return Ry(n,function(e){return e})||[]},only:function(n){if(!rD(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};vr.Component=dp;vr.Fragment=cY;vr.Profiler=dY;vr.PureComponent=eD;vr.StrictMode=fY;vr.Suspense=mY;vr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AY;vr.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=O4({},n.props),o=n.key,u=n.ref,h=n._owner;if(e!=null){if(e.ref!==void 0&&(u=e.ref,h=nD.current),e.key!==void 0&&(o=""+e.key),n.type&&n.type.defaultProps)var f=n.type.defaultProps;for(d in e)k4.call(e,d)&&!U4.hasOwnProperty(d)&&(r[d]=e[d]===void 0&&f!==void 0?f[d]:e[d])}var d=arguments.length-2;if(d===1)r.children=t;else if(1<d){f=Array(d);for(var m=0;m<d;m++)f[m]=arguments[m+2];r.children=f}return{$$typeof:h0,type:n.type,key:o,ref:u,props:r,_owner:h}};vr.createContext=function(n){return n={$$typeof:pY,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:hY,_context:n},n.Consumer=n};vr.createElement=B4;vr.createFactory=function(n){var e=B4.bind(null,n);return e.type=n,e};vr.createRef=function(){return{current:null}};vr.forwardRef=function(n){return{$$typeof:gY,render:n}};vr.isValidElement=rD;vr.lazy=function(n){return{$$typeof:yY,_payload:{_status:-1,_result:n},_init:SY}};vr.memo=function(n,e){return{$$typeof:vY,type:n,compare:e===void 0?null:e}};vr.startTransition=function(n){var e=TE.transition;TE.transition={};try{n()}finally{TE.transition=e}};vr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};vr.useCallback=function(n,e){return zs.current.useCallback(n,e)};vr.useContext=function(n){return zs.current.useContext(n)};vr.useDebugValue=function(){};vr.useDeferredValue=function(n){return zs.current.useDeferredValue(n)};vr.useEffect=function(n,e){return zs.current.useEffect(n,e)};vr.useId=function(){return zs.current.useId()};vr.useImperativeHandle=function(n,e,t){return zs.current.useImperativeHandle(n,e,t)};vr.useInsertionEffect=function(n,e){return zs.current.useInsertionEffect(n,e)};vr.useLayoutEffect=function(n,e){return zs.current.useLayoutEffect(n,e)};vr.useMemo=function(n,e){return zs.current.useMemo(n,e)};vr.useReducer=function(n,e,t){return zs.current.useReducer(n,e,t)};vr.useRef=function(n){return zs.current.useRef(n)};vr.useState=function(n){return zs.current.useState(n)};vr.useSyncExternalStore=function(n,e,t){return zs.current.useSyncExternalStore(n,e,t)};vr.useTransition=function(){return zs.current.useTransition()};vr.version="18.2.0";(function(n){n.exports=vr})(lY);const Ws=Zb(Ot);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xY=Ot,CY=Symbol.for("react.element"),IY=Symbol.for("react.fragment"),RY=Object.prototype.hasOwnProperty,bY=xY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,DY={key:!0,ref:!0,__self:!0,__source:!0};function j4(n,e,t){var r,o={},u=null,h=null;t!==void 0&&(u=""+t),e.key!==void 0&&(u=""+e.key),e.ref!==void 0&&(h=e.ref);for(r in e)RY.call(e,r)&&!DY.hasOwnProperty(r)&&(o[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)o[r]===void 0&&(o[r]=e[r]);return{$$typeof:CY,type:n,key:u,ref:h,props:o,_owner:bY.current}}lT.Fragment=IY;lT.jsx=j4;lT.jsxs=j4;(function(n){n.exports=lT})(oY);const iD=bm.Fragment,ln=bm.jsx,Ts=bm.jsxs;var ZI={},jE={},PY={get exports(){return jE},set exports(n){jE=n}},Va={},eR={},LY={get exports(){return eR},set exports(n){eR=n}},K4={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(ee,ue){var ie=ee.length;ee.push(ue);e:for(;0<ie;){var Q=ie-1>>>1,se=ee[Q];if(0<o(se,ue))ee[Q]=ue,ee[ie]=se,ie=Q;else break e}}function t(ee){return ee.length===0?null:ee[0]}function r(ee){if(ee.length===0)return null;var ue=ee[0],ie=ee.pop();if(ie!==ue){ee[0]=ie;e:for(var Q=0,se=ee.length,ve=se>>>1;Q<ve;){var _e=2*(Q+1)-1,Z=ee[_e],Ee=_e+1,Se=ee[Ee];if(0>o(Z,ie))Ee<se&&0>o(Se,Z)?(ee[Q]=Se,ee[Ee]=ie,Q=Ee):(ee[Q]=Z,ee[_e]=ie,Q=_e);else if(Ee<se&&0>o(Se,ie))ee[Q]=Se,ee[Ee]=ie,Q=Ee;else break e}}return ue}function o(ee,ue){var ie=ee.sortIndex-ue.sortIndex;return ie!==0?ie:ee.id-ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var h=Date,f=h.now();n.unstable_now=function(){return h.now()-f}}var d=[],m=[],g=1,v=null,_=3,S=!1,E=!1,T=!1,C=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(ee){for(var ue=t(m);ue!==null;){if(ue.callback===null)r(m);else if(ue.startTime<=ee)r(m),ue.sortIndex=ue.expirationTime,e(d,ue);else break;ue=t(m)}}function O(ee){if(T=!1,F(ee),!E)if(t(d)!==null)E=!0,Y(L);else{var ue=t(m);ue!==null&&J(O,ue.startTime-ee)}}function L(ee,ue){E=!1,T&&(T=!1,R(B),B=-1),S=!0;var ie=_;try{for(F(ue),v=t(d);v!==null&&(!(v.expirationTime>ue)||ee&&!U());){var Q=v.callback;if(typeof Q=="function"){v.callback=null,_=v.priorityLevel;var se=Q(v.expirationTime<=ue);ue=n.unstable_now(),typeof se=="function"?v.callback=se:v===t(d)&&r(d),F(ue)}else r(d);v=t(d)}if(v!==null)var ve=!0;else{var _e=t(m);_e!==null&&J(O,_e.startTime-ue),ve=!1}return ve}finally{v=null,_=ie,S=!1}}var D=!1,x=null,B=-1,M=5,I=-1;function U(){return!(n.unstable_now()-I<M)}function w(){if(x!==null){var ee=n.unstable_now();I=ee;var ue=!0;try{ue=x(!0,ee)}finally{ue?k():(D=!1,x=null)}}else D=!1}var k;if(typeof b=="function")k=function(){b(w)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,W=K.port2;K.port1.onmessage=w,k=function(){W.postMessage(null)}}else k=function(){C(w,0)};function Y(ee){x=ee,D||(D=!0,k())}function J(ee,ue){B=C(function(){ee(n.unstable_now())},ue)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ee){ee.callback=null},n.unstable_continueExecution=function(){E||S||(E=!0,Y(L))},n.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<ee?Math.floor(1e3/ee):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_getFirstCallbackNode=function(){return t(d)},n.unstable_next=function(ee){switch(_){case 1:case 2:case 3:var ue=3;break;default:ue=_}var ie=_;_=ue;try{return ee()}finally{_=ie}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ee,ue){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var ie=_;_=ee;try{return ue()}finally{_=ie}},n.unstable_scheduleCallback=function(ee,ue,ie){var Q=n.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?Q+ie:Q):ie=Q,ee){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=ie+se,ee={id:g++,callback:ue,priorityLevel:ee,startTime:ie,expirationTime:se,sortIndex:-1},ie>Q?(ee.sortIndex=ie,e(m,ee),t(d)===null&&ee===t(m)&&(T?(R(B),B=-1):T=!0,J(O,ie-Q))):(ee.sortIndex=se,e(d,ee),E||S||(E=!0,Y(L))),ee},n.unstable_shouldYield=U,n.unstable_wrapCallback=function(ee){var ue=_;return function(){var ie=_;_=ue;try{return ee.apply(this,arguments)}finally{_=ie}}}})(K4);(function(n){n.exports=K4})(LY);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G4=Ot,Wa=eR;function fn(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var W4=new Set,Dm={};function rd(n,e){Gh(n,e),Gh(n+"Capture",e)}function Gh(n,e){for(Dm[n]=e,n=0;n<e.length;n++)W4.add(e[n])}var Pu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tR=Object.prototype.hasOwnProperty,MY=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,dk={},hk={};function wY(n){return tR.call(hk,n)?!0:tR.call(dk,n)?!1:MY.test(n)?hk[n]=!0:(dk[n]=!0,!1)}function OY(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function NY(n,e,t,r){if(e===null||typeof e>"u"||OY(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ys(n,e,t,r,o,u,h){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=u,this.removeEmptyString=h}var ms={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){ms[n]=new Ys(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];ms[e]=new Ys(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){ms[n]=new Ys(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){ms[n]=new Ys(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){ms[n]=new Ys(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){ms[n]=new Ys(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){ms[n]=new Ys(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){ms[n]=new Ys(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){ms[n]=new Ys(n,5,!1,n.toLowerCase(),null,!1,!1)});var sD=/[\-:]([a-z])/g;function aD(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(sD,aD);ms[e]=new Ys(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(sD,aD);ms[e]=new Ys(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(sD,aD);ms[e]=new Ys(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){ms[n]=new Ys(n,1,!1,n.toLowerCase(),null,!1,!1)});ms.xlinkHref=new Ys("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){ms[n]=new Ys(n,1,!1,n.toLowerCase(),null,!0,!0)});function oD(n,e,t,r){var o=ms.hasOwnProperty(e)?ms[e]:null;(o!==null?o.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(NY(e,t,o,r)&&(t=null),r||o===null?wY(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):o.mustUseProperty?n[o.propertyName]=t===null?o.type===3?!1:"":t:(e=o.attributeName,r=o.attributeNamespace,t===null?n.removeAttribute(e):(o=o.type,t=o===3||o===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var ju=G4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,by=Symbol.for("react.element"),uh=Symbol.for("react.portal"),ch=Symbol.for("react.fragment"),lD=Symbol.for("react.strict_mode"),nR=Symbol.for("react.profiler"),H4=Symbol.for("react.provider"),V4=Symbol.for("react.context"),uD=Symbol.for("react.forward_ref"),rR=Symbol.for("react.suspense"),iR=Symbol.for("react.suspense_list"),cD=Symbol.for("react.memo"),pc=Symbol.for("react.lazy"),$4=Symbol.for("react.offscreen"),pk=Symbol.iterator;function Ag(n){return n===null||typeof n!="object"?null:(n=pk&&n[pk]||n["@@iterator"],typeof n=="function"?n:null)}var Ci=Object.assign,gC;function $g(n){if(gC===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);gC=e&&e[1]||""}return`
`+gC+n}var mC=!1;function vC(n,e){if(!n||mC)return"";mC=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(m){var r=m}Reflect.construct(n,[],e)}else{try{e.call()}catch(m){r=m}n.call(e.prototype)}else{try{throw Error()}catch(m){r=m}n()}}catch(m){if(m&&r&&typeof m.stack=="string"){for(var o=m.stack.split(`
`),u=r.stack.split(`
`),h=o.length-1,f=u.length-1;1<=h&&0<=f&&o[h]!==u[f];)f--;for(;1<=h&&0<=f;h--,f--)if(o[h]!==u[f]){if(h!==1||f!==1)do if(h--,f--,0>f||o[h]!==u[f]){var d=`
`+o[h].replace(" at new "," at ");return n.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",n.displayName)),d}while(1<=h&&0<=f);break}}}finally{mC=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?$g(n):""}function FY(n){switch(n.tag){case 5:return $g(n.type);case 16:return $g("Lazy");case 13:return $g("Suspense");case 19:return $g("SuspenseList");case 0:case 2:case 15:return n=vC(n.type,!1),n;case 11:return n=vC(n.type.render,!1),n;case 1:return n=vC(n.type,!0),n;default:return""}}function sR(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case ch:return"Fragment";case uh:return"Portal";case nR:return"Profiler";case lD:return"StrictMode";case rR:return"Suspense";case iR:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case V4:return(n.displayName||"Context")+".Consumer";case H4:return(n._context.displayName||"Context")+".Provider";case uD:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case cD:return e=n.displayName||null,e!==null?e:sR(n.type)||"Memo";case pc:e=n._payload,n=n._init;try{return sR(n(e))}catch{}}return null}function kY(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sR(e);case 8:return e===lD?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function wc(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function z4(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function UY(n){var e=z4(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var o=t.get,u=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return o.call(this)},set:function(h){r=""+h,u.call(this,h)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(h){r=""+h},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Dy(n){n._valueTracker||(n._valueTracker=UY(n))}function Y4(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=z4(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function KE(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function aR(n,e){var t=e.checked;return Ci({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function gk(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=wc(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function X4(n,e){e=e.checked,e!=null&&oD(n,"checked",e,!1)}function oR(n,e){X4(n,e);var t=wc(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?lR(n,e.type,t):e.hasOwnProperty("defaultValue")&&lR(n,e.type,wc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function mk(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function lR(n,e,t){(e!=="number"||KE(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var zg=Array.isArray;function Dh(n,e,t,r){if(n=n.options,e){e={};for(var o=0;o<t.length;o++)e["$"+t[o]]=!0;for(t=0;t<n.length;t++)o=e.hasOwnProperty("$"+n[t].value),n[t].selected!==o&&(n[t].selected=o),o&&r&&(n[t].defaultSelected=!0)}else{for(t=""+wc(t),e=null,o=0;o<n.length;o++){if(n[o].value===t){n[o].selected=!0,r&&(n[o].defaultSelected=!0);return}e!==null||n[o].disabled||(e=n[o])}e!==null&&(e.selected=!0)}}function uR(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(fn(91));return Ci({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function vk(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(fn(92));if(zg(t)){if(1<t.length)throw Error(fn(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:wc(t)}}function q4(n,e){var t=wc(e.value),r=wc(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function yk(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function Q4(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cR(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?Q4(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Py,J4=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,o){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,o)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Py=Py||document.createElement("div"),Py.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Py.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Pm(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var am={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},BY=["Webkit","ms","Moz","O"];Object.keys(am).forEach(function(n){BY.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),am[e]=am[n]})});function Z4(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||am.hasOwnProperty(n)&&am[n]?(""+e).trim():e+"px"}function e3(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,o=Z4(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,o):n[t]=o}}var jY=Ci({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fR(n,e){if(e){if(jY[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(fn(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(fn(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(fn(61))}if(e.style!=null&&typeof e.style!="object")throw Error(fn(62))}}function dR(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hR=null;function fD(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var pR=null,Ph=null,Lh=null;function Ek(n){if(n=m0(n)){if(typeof pR!="function")throw Error(fn(280));var e=n.stateNode;e&&(e=hT(e),pR(n.stateNode,n.type,e))}}function t3(n){Ph?Lh?Lh.push(n):Lh=[n]:Ph=n}function n3(){if(Ph){var n=Ph,e=Lh;if(Lh=Ph=null,Ek(n),e)for(n=0;n<e.length;n++)Ek(e[n])}}function r3(n,e){return n(e)}function i3(){}var yC=!1;function s3(n,e,t){if(yC)return n(e,t);yC=!0;try{return r3(n,e,t)}finally{yC=!1,(Ph!==null||Lh!==null)&&(i3(),n3())}}function Lm(n,e){var t=n.stateNode;if(t===null)return null;var r=hT(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(fn(231,e,typeof t));return t}var gR=!1;if(Pu)try{var xg={};Object.defineProperty(xg,"passive",{get:function(){gR=!0}}),window.addEventListener("test",xg,xg),window.removeEventListener("test",xg,xg)}catch{gR=!1}function KY(n,e,t,r,o,u,h,f,d){var m=Array.prototype.slice.call(arguments,3);try{e.apply(t,m)}catch(g){this.onError(g)}}var om=!1,GE=null,WE=!1,mR=null,GY={onError:function(n){om=!0,GE=n}};function WY(n,e,t,r,o,u,h,f,d){om=!1,GE=null,KY.apply(GY,arguments)}function HY(n,e,t,r,o,u,h,f,d){if(WY.apply(this,arguments),om){if(om){var m=GE;om=!1,GE=null}else throw Error(fn(198));WE||(WE=!0,mR=m)}}function id(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function a3(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function _k(n){if(id(n)!==n)throw Error(fn(188))}function VY(n){var e=n.alternate;if(!e){if(e=id(n),e===null)throw Error(fn(188));return e!==n?null:n}for(var t=n,r=e;;){var o=t.return;if(o===null)break;var u=o.alternate;if(u===null){if(r=o.return,r!==null){t=r;continue}break}if(o.child===u.child){for(u=o.child;u;){if(u===t)return _k(o),n;if(u===r)return _k(o),e;u=u.sibling}throw Error(fn(188))}if(t.return!==r.return)t=o,r=u;else{for(var h=!1,f=o.child;f;){if(f===t){h=!0,t=o,r=u;break}if(f===r){h=!0,r=o,t=u;break}f=f.sibling}if(!h){for(f=u.child;f;){if(f===t){h=!0,t=u,r=o;break}if(f===r){h=!0,r=u,t=o;break}f=f.sibling}if(!h)throw Error(fn(189))}}if(t.alternate!==r)throw Error(fn(190))}if(t.tag!==3)throw Error(fn(188));return t.stateNode.current===t?n:e}function o3(n){return n=VY(n),n!==null?l3(n):null}function l3(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=l3(n);if(e!==null)return e;n=n.sibling}return null}var u3=Wa.unstable_scheduleCallback,Tk=Wa.unstable_cancelCallback,$Y=Wa.unstable_shouldYield,zY=Wa.unstable_requestPaint,Fi=Wa.unstable_now,YY=Wa.unstable_getCurrentPriorityLevel,dD=Wa.unstable_ImmediatePriority,c3=Wa.unstable_UserBlockingPriority,HE=Wa.unstable_NormalPriority,XY=Wa.unstable_LowPriority,f3=Wa.unstable_IdlePriority,uT=null,Il=null;function qY(n){if(Il&&typeof Il.onCommitFiberRoot=="function")try{Il.onCommitFiberRoot(uT,n,void 0,(n.current.flags&128)===128)}catch{}}var $o=Math.clz32?Math.clz32:ZY,QY=Math.log,JY=Math.LN2;function ZY(n){return n>>>=0,n===0?32:31-(QY(n)/JY|0)|0}var Ly=64,My=4194304;function Yg(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function VE(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,o=n.suspendedLanes,u=n.pingedLanes,h=t&268435455;if(h!==0){var f=h&~o;f!==0?r=Yg(f):(u&=h,u!==0&&(r=Yg(u)))}else h=t&~o,h!==0?r=Yg(h):u!==0&&(r=Yg(u));if(r===0)return 0;if(e!==0&&e!==r&&!(e&o)&&(o=r&-r,u=e&-e,o>=u||o===16&&(u&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-$o(e),o=1<<t,r|=n[t],e&=~o;return r}function eX(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tX(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,o=n.expirationTimes,u=n.pendingLanes;0<u;){var h=31-$o(u),f=1<<h,d=o[h];d===-1?(!(f&t)||f&r)&&(o[h]=eX(f,e)):d<=e&&(n.expiredLanes|=f),u&=~f}}function vR(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function d3(){var n=Ly;return Ly<<=1,!(Ly&4194240)&&(Ly=64),n}function EC(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function p0(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-$o(e),n[e]=t}function nX(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var o=31-$o(t),u=1<<o;e[o]=0,r[o]=-1,n[o]=-1,t&=~u}}function hD(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-$o(t),o=1<<r;o&e|n[r]&e&&(n[r]|=e),t&=~o}}var kr=0;function h3(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var p3,pD,g3,m3,v3,yR=!1,wy=[],Cc=null,Ic=null,Rc=null,Mm=new Map,wm=new Map,Tc=[],rX="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sk(n,e){switch(n){case"focusin":case"focusout":Cc=null;break;case"dragenter":case"dragleave":Ic=null;break;case"mouseover":case"mouseout":Rc=null;break;case"pointerover":case"pointerout":Mm.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":wm.delete(e.pointerId)}}function Cg(n,e,t,r,o,u){return n===null||n.nativeEvent!==u?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:u,targetContainers:[o]},e!==null&&(e=m0(e),e!==null&&pD(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),n)}function iX(n,e,t,r,o){switch(e){case"focusin":return Cc=Cg(Cc,n,e,t,r,o),!0;case"dragenter":return Ic=Cg(Ic,n,e,t,r,o),!0;case"mouseover":return Rc=Cg(Rc,n,e,t,r,o),!0;case"pointerover":var u=o.pointerId;return Mm.set(u,Cg(Mm.get(u)||null,n,e,t,r,o)),!0;case"gotpointercapture":return u=o.pointerId,wm.set(u,Cg(wm.get(u)||null,n,e,t,r,o)),!0}return!1}function y3(n){var e=Of(n.target);if(e!==null){var t=id(e);if(t!==null){if(e=t.tag,e===13){if(e=a3(t),e!==null){n.blockedOn=e,v3(n.priority,function(){g3(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function SE(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=ER(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);hR=r,t.target.dispatchEvent(r),hR=null}else return e=m0(t),e!==null&&pD(e),n.blockedOn=t,!1;e.shift()}return!0}function Ak(n,e,t){SE(n)&&t.delete(e)}function sX(){yR=!1,Cc!==null&&SE(Cc)&&(Cc=null),Ic!==null&&SE(Ic)&&(Ic=null),Rc!==null&&SE(Rc)&&(Rc=null),Mm.forEach(Ak),wm.forEach(Ak)}function Ig(n,e){n.blockedOn===e&&(n.blockedOn=null,yR||(yR=!0,Wa.unstable_scheduleCallback(Wa.unstable_NormalPriority,sX)))}function Om(n){function e(o){return Ig(o,n)}if(0<wy.length){Ig(wy[0],n);for(var t=1;t<wy.length;t++){var r=wy[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Cc!==null&&Ig(Cc,n),Ic!==null&&Ig(Ic,n),Rc!==null&&Ig(Rc,n),Mm.forEach(e),wm.forEach(e),t=0;t<Tc.length;t++)r=Tc[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Tc.length&&(t=Tc[0],t.blockedOn===null);)y3(t),t.blockedOn===null&&Tc.shift()}var Mh=ju.ReactCurrentBatchConfig,$E=!0;function aX(n,e,t,r){var o=kr,u=Mh.transition;Mh.transition=null;try{kr=1,gD(n,e,t,r)}finally{kr=o,Mh.transition=u}}function oX(n,e,t,r){var o=kr,u=Mh.transition;Mh.transition=null;try{kr=4,gD(n,e,t,r)}finally{kr=o,Mh.transition=u}}function gD(n,e,t,r){if($E){var o=ER(n,e,t,r);if(o===null)DC(n,e,r,zE,t),Sk(n,r);else if(iX(o,n,e,t,r))r.stopPropagation();else if(Sk(n,r),e&4&&-1<rX.indexOf(n)){for(;o!==null;){var u=m0(o);if(u!==null&&p3(u),u=ER(n,e,t,r),u===null&&DC(n,e,r,zE,t),u===o)break;o=u}o!==null&&r.stopPropagation()}else DC(n,e,r,null,t)}}var zE=null;function ER(n,e,t,r){if(zE=null,n=fD(r),n=Of(n),n!==null)if(e=id(n),e===null)n=null;else if(t=e.tag,t===13){if(n=a3(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return zE=n,null}function E3(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(YY()){case dD:return 1;case c3:return 4;case HE:case XY:return 16;case f3:return 536870912;default:return 16}default:return 16}}var Ac=null,mD=null,AE=null;function _3(){if(AE)return AE;var n,e=mD,t=e.length,r,o="value"in Ac?Ac.value:Ac.textContent,u=o.length;for(n=0;n<t&&e[n]===o[n];n++);var h=t-n;for(r=1;r<=h&&e[t-r]===o[u-r];r++);return AE=o.slice(n,1<r?1-r:void 0)}function xE(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Oy(){return!0}function xk(){return!1}function $a(n){function e(t,r,o,u,h){this._reactName=t,this._targetInst=o,this.type=r,this.nativeEvent=u,this.target=h,this.currentTarget=null;for(var f in n)n.hasOwnProperty(f)&&(t=n[f],this[f]=t?t(u):u[f]);return this.isDefaultPrevented=(u.defaultPrevented!=null?u.defaultPrevented:u.returnValue===!1)?Oy:xk,this.isPropagationStopped=xk,this}return Ci(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Oy)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Oy)},persist:function(){},isPersistent:Oy}),e}var hp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vD=$a(hp),g0=Ci({},hp,{view:0,detail:0}),lX=$a(g0),_C,TC,Rg,cT=Ci({},g0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yD,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Rg&&(Rg&&n.type==="mousemove"?(_C=n.screenX-Rg.screenX,TC=n.screenY-Rg.screenY):TC=_C=0,Rg=n),_C)},movementY:function(n){return"movementY"in n?n.movementY:TC}}),Ck=$a(cT),uX=Ci({},cT,{dataTransfer:0}),cX=$a(uX),fX=Ci({},g0,{relatedTarget:0}),SC=$a(fX),dX=Ci({},hp,{animationName:0,elapsedTime:0,pseudoElement:0}),hX=$a(dX),pX=Ci({},hp,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),gX=$a(pX),mX=Ci({},hp,{data:0}),Ik=$a(mX),vX={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yX={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},EX={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _X(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=EX[n])?!!e[n]:!1}function yD(){return _X}var TX=Ci({},g0,{key:function(n){if(n.key){var e=vX[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=xE(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?yX[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yD,charCode:function(n){return n.type==="keypress"?xE(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?xE(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),SX=$a(TX),AX=Ci({},cT,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rk=$a(AX),xX=Ci({},g0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yD}),CX=$a(xX),IX=Ci({},hp,{propertyName:0,elapsedTime:0,pseudoElement:0}),RX=$a(IX),bX=Ci({},cT,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),DX=$a(bX),PX=[9,13,27,32],ED=Pu&&"CompositionEvent"in window,lm=null;Pu&&"documentMode"in document&&(lm=document.documentMode);var LX=Pu&&"TextEvent"in window&&!lm,T3=Pu&&(!ED||lm&&8<lm&&11>=lm),bk=String.fromCharCode(32),Dk=!1;function S3(n,e){switch(n){case"keyup":return PX.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function A3(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var fh=!1;function MX(n,e){switch(n){case"compositionend":return A3(e);case"keypress":return e.which!==32?null:(Dk=!0,bk);case"textInput":return n=e.data,n===bk&&Dk?null:n;default:return null}}function wX(n,e){if(fh)return n==="compositionend"||!ED&&S3(n,e)?(n=_3(),AE=mD=Ac=null,fh=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return T3&&e.locale!=="ko"?null:e.data;default:return null}}var OX={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pk(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!OX[n.type]:e==="textarea"}function x3(n,e,t,r){t3(r),e=YE(e,"onChange"),0<e.length&&(t=new vD("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var um=null,Nm=null;function NX(n){N3(n,0)}function fT(n){var e=ph(n);if(Y4(e))return n}function FX(n,e){if(n==="change")return e}var C3=!1;if(Pu){var AC;if(Pu){var xC="oninput"in document;if(!xC){var Lk=document.createElement("div");Lk.setAttribute("oninput","return;"),xC=typeof Lk.oninput=="function"}AC=xC}else AC=!1;C3=AC&&(!document.documentMode||9<document.documentMode)}function Mk(){um&&(um.detachEvent("onpropertychange",I3),Nm=um=null)}function I3(n){if(n.propertyName==="value"&&fT(Nm)){var e=[];x3(e,Nm,n,fD(n)),s3(NX,e)}}function kX(n,e,t){n==="focusin"?(Mk(),um=e,Nm=t,um.attachEvent("onpropertychange",I3)):n==="focusout"&&Mk()}function UX(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return fT(Nm)}function BX(n,e){if(n==="click")return fT(e)}function jX(n,e){if(n==="input"||n==="change")return fT(e)}function KX(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Xo=typeof Object.is=="function"?Object.is:KX;function Fm(n,e){if(Xo(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var o=t[r];if(!tR.call(e,o)||!Xo(n[o],e[o]))return!1}return!0}function wk(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Ok(n,e){var t=wk(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=wk(t)}}function R3(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?R3(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function b3(){for(var n=window,e=KE();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=KE(n.document)}return e}function _D(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function GX(n){var e=b3(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&R3(t.ownerDocument.documentElement,t)){if(r!==null&&_D(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var o=t.textContent.length,u=Math.min(r.start,o);r=r.end===void 0?u:Math.min(r.end,o),!n.extend&&u>r&&(o=r,r=u,u=o),o=Ok(t,u);var h=Ok(t,r);o&&h&&(n.rangeCount!==1||n.anchorNode!==o.node||n.anchorOffset!==o.offset||n.focusNode!==h.node||n.focusOffset!==h.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),n.removeAllRanges(),u>r?(n.addRange(e),n.extend(h.node,h.offset)):(e.setEnd(h.node,h.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var WX=Pu&&"documentMode"in document&&11>=document.documentMode,dh=null,_R=null,cm=null,TR=!1;function Nk(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;TR||dh==null||dh!==KE(r)||(r=dh,"selectionStart"in r&&_D(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),cm&&Fm(cm,r)||(cm=r,r=YE(_R,"onSelect"),0<r.length&&(e=new vD("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=dh)))}function Ny(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var hh={animationend:Ny("Animation","AnimationEnd"),animationiteration:Ny("Animation","AnimationIteration"),animationstart:Ny("Animation","AnimationStart"),transitionend:Ny("Transition","TransitionEnd")},CC={},D3={};Pu&&(D3=document.createElement("div").style,"AnimationEvent"in window||(delete hh.animationend.animation,delete hh.animationiteration.animation,delete hh.animationstart.animation),"TransitionEvent"in window||delete hh.transitionend.transition);function dT(n){if(CC[n])return CC[n];if(!hh[n])return n;var e=hh[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in D3)return CC[n]=e[t];return n}var P3=dT("animationend"),L3=dT("animationiteration"),M3=dT("animationstart"),w3=dT("transitionend"),O3=new Map,Fk="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jc(n,e){O3.set(n,e),rd(e,[n])}for(var IC=0;IC<Fk.length;IC++){var RC=Fk[IC],HX=RC.toLowerCase(),VX=RC[0].toUpperCase()+RC.slice(1);jc(HX,"on"+VX)}jc(P3,"onAnimationEnd");jc(L3,"onAnimationIteration");jc(M3,"onAnimationStart");jc("dblclick","onDoubleClick");jc("focusin","onFocus");jc("focusout","onBlur");jc(w3,"onTransitionEnd");Gh("onMouseEnter",["mouseout","mouseover"]);Gh("onMouseLeave",["mouseout","mouseover"]);Gh("onPointerEnter",["pointerout","pointerover"]);Gh("onPointerLeave",["pointerout","pointerover"]);rd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));rd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));rd("onBeforeInput",["compositionend","keypress","textInput","paste"]);rd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));rd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));rd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$X=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xg));function kk(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,HY(r,e,void 0,n),n.currentTarget=null}function N3(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],o=r.event;r=r.listeners;e:{var u=void 0;if(e)for(var h=r.length-1;0<=h;h--){var f=r[h],d=f.instance,m=f.currentTarget;if(f=f.listener,d!==u&&o.isPropagationStopped())break e;kk(o,f,m),u=d}else for(h=0;h<r.length;h++){if(f=r[h],d=f.instance,m=f.currentTarget,f=f.listener,d!==u&&o.isPropagationStopped())break e;kk(o,f,m),u=d}}}if(WE)throw n=mR,WE=!1,mR=null,n}function si(n,e){var t=e[IR];t===void 0&&(t=e[IR]=new Set);var r=n+"__bubble";t.has(r)||(F3(e,n,2,!1),t.add(r))}function bC(n,e,t){var r=0;e&&(r|=4),F3(t,n,r,e)}var Fy="_reactListening"+Math.random().toString(36).slice(2);function km(n){if(!n[Fy]){n[Fy]=!0,W4.forEach(function(t){t!=="selectionchange"&&($X.has(t)||bC(t,!1,n),bC(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Fy]||(e[Fy]=!0,bC("selectionchange",!1,e))}}function F3(n,e,t,r){switch(E3(e)){case 1:var o=aX;break;case 4:o=oX;break;default:o=gD}t=o.bind(null,e,t,n),o=void 0,!gR||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),r?o!==void 0?n.addEventListener(e,t,{capture:!0,passive:o}):n.addEventListener(e,t,!0):o!==void 0?n.addEventListener(e,t,{passive:o}):n.addEventListener(e,t,!1)}function DC(n,e,t,r,o){var u=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var h=r.tag;if(h===3||h===4){var f=r.stateNode.containerInfo;if(f===o||f.nodeType===8&&f.parentNode===o)break;if(h===4)for(h=r.return;h!==null;){var d=h.tag;if((d===3||d===4)&&(d=h.stateNode.containerInfo,d===o||d.nodeType===8&&d.parentNode===o))return;h=h.return}for(;f!==null;){if(h=Of(f),h===null)return;if(d=h.tag,d===5||d===6){r=u=h;continue e}f=f.parentNode}}r=r.return}s3(function(){var m=u,g=fD(t),v=[];e:{var _=O3.get(n);if(_!==void 0){var S=vD,E=n;switch(n){case"keypress":if(xE(t)===0)break e;case"keydown":case"keyup":S=SX;break;case"focusin":E="focus",S=SC;break;case"focusout":E="blur",S=SC;break;case"beforeblur":case"afterblur":S=SC;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=Ck;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=cX;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=CX;break;case P3:case L3:case M3:S=hX;break;case w3:S=RX;break;case"scroll":S=lX;break;case"wheel":S=DX;break;case"copy":case"cut":case"paste":S=gX;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=Rk}var T=(e&4)!==0,C=!T&&n==="scroll",R=T?_!==null?_+"Capture":null:_;T=[];for(var b=m,F;b!==null;){F=b;var O=F.stateNode;if(F.tag===5&&O!==null&&(F=O,R!==null&&(O=Lm(b,R),O!=null&&T.push(Um(b,O,F)))),C)break;b=b.return}0<T.length&&(_=new S(_,E,null,t,g),v.push({event:_,listeners:T}))}}if(!(e&7)){e:{if(_=n==="mouseover"||n==="pointerover",S=n==="mouseout"||n==="pointerout",_&&t!==hR&&(E=t.relatedTarget||t.fromElement)&&(Of(E)||E[Lu]))break e;if((S||_)&&(_=g.window===g?g:(_=g.ownerDocument)?_.defaultView||_.parentWindow:window,S?(E=t.relatedTarget||t.toElement,S=m,E=E?Of(E):null,E!==null&&(C=id(E),E!==C||E.tag!==5&&E.tag!==6)&&(E=null)):(S=null,E=m),S!==E)){if(T=Ck,O="onMouseLeave",R="onMouseEnter",b="mouse",(n==="pointerout"||n==="pointerover")&&(T=Rk,O="onPointerLeave",R="onPointerEnter",b="pointer"),C=S==null?_:ph(S),F=E==null?_:ph(E),_=new T(O,b+"leave",S,t,g),_.target=C,_.relatedTarget=F,O=null,Of(g)===m&&(T=new T(R,b+"enter",E,t,g),T.target=F,T.relatedTarget=C,O=T),C=O,S&&E)t:{for(T=S,R=E,b=0,F=T;F;F=$d(F))b++;for(F=0,O=R;O;O=$d(O))F++;for(;0<b-F;)T=$d(T),b--;for(;0<F-b;)R=$d(R),F--;for(;b--;){if(T===R||R!==null&&T===R.alternate)break t;T=$d(T),R=$d(R)}T=null}else T=null;S!==null&&Uk(v,_,S,T,!1),E!==null&&C!==null&&Uk(v,C,E,T,!0)}}e:{if(_=m?ph(m):window,S=_.nodeName&&_.nodeName.toLowerCase(),S==="select"||S==="input"&&_.type==="file")var L=FX;else if(Pk(_))if(C3)L=jX;else{L=UX;var D=kX}else(S=_.nodeName)&&S.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(L=BX);if(L&&(L=L(n,m))){x3(v,L,t,g);break e}D&&D(n,_,m),n==="focusout"&&(D=_._wrapperState)&&D.controlled&&_.type==="number"&&lR(_,"number",_.value)}switch(D=m?ph(m):window,n){case"focusin":(Pk(D)||D.contentEditable==="true")&&(dh=D,_R=m,cm=null);break;case"focusout":cm=_R=dh=null;break;case"mousedown":TR=!0;break;case"contextmenu":case"mouseup":case"dragend":TR=!1,Nk(v,t,g);break;case"selectionchange":if(WX)break;case"keydown":case"keyup":Nk(v,t,g)}var x;if(ED)e:{switch(n){case"compositionstart":var B="onCompositionStart";break e;case"compositionend":B="onCompositionEnd";break e;case"compositionupdate":B="onCompositionUpdate";break e}B=void 0}else fh?S3(n,t)&&(B="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(B="onCompositionStart");B&&(T3&&t.locale!=="ko"&&(fh||B!=="onCompositionStart"?B==="onCompositionEnd"&&fh&&(x=_3()):(Ac=g,mD="value"in Ac?Ac.value:Ac.textContent,fh=!0)),D=YE(m,B),0<D.length&&(B=new Ik(B,n,null,t,g),v.push({event:B,listeners:D}),x?B.data=x:(x=A3(t),x!==null&&(B.data=x)))),(x=LX?MX(n,t):wX(n,t))&&(m=YE(m,"onBeforeInput"),0<m.length&&(g=new Ik("onBeforeInput","beforeinput",null,t,g),v.push({event:g,listeners:m}),g.data=x))}N3(v,e)})}function Um(n,e,t){return{instance:n,listener:e,currentTarget:t}}function YE(n,e){for(var t=e+"Capture",r=[];n!==null;){var o=n,u=o.stateNode;o.tag===5&&u!==null&&(o=u,u=Lm(n,t),u!=null&&r.unshift(Um(n,u,o)),u=Lm(n,e),u!=null&&r.push(Um(n,u,o))),n=n.return}return r}function $d(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Uk(n,e,t,r,o){for(var u=e._reactName,h=[];t!==null&&t!==r;){var f=t,d=f.alternate,m=f.stateNode;if(d!==null&&d===r)break;f.tag===5&&m!==null&&(f=m,o?(d=Lm(t,u),d!=null&&h.unshift(Um(t,d,f))):o||(d=Lm(t,u),d!=null&&h.push(Um(t,d,f)))),t=t.return}h.length!==0&&n.push({event:e,listeners:h})}var zX=/\r\n?/g,YX=/\u0000|\uFFFD/g;function Bk(n){return(typeof n=="string"?n:""+n).replace(zX,`
`).replace(YX,"")}function ky(n,e,t){if(e=Bk(e),Bk(n)!==e&&t)throw Error(fn(425))}function XE(){}var SR=null,AR=null;function xR(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var CR=typeof setTimeout=="function"?setTimeout:void 0,XX=typeof clearTimeout=="function"?clearTimeout:void 0,jk=typeof Promise=="function"?Promise:void 0,qX=typeof queueMicrotask=="function"?queueMicrotask:typeof jk<"u"?function(n){return jk.resolve(null).then(n).catch(QX)}:CR;function QX(n){setTimeout(function(){throw n})}function PC(n,e){var t=e,r=0;do{var o=t.nextSibling;if(n.removeChild(t),o&&o.nodeType===8)if(t=o.data,t==="/$"){if(r===0){n.removeChild(o),Om(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=o}while(t);Om(e)}function bc(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function Kk(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var pp=Math.random().toString(36).slice(2),Tl="__reactFiber$"+pp,Bm="__reactProps$"+pp,Lu="__reactContainer$"+pp,IR="__reactEvents$"+pp,JX="__reactListeners$"+pp,ZX="__reactHandles$"+pp;function Of(n){var e=n[Tl];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Lu]||t[Tl]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=Kk(n);n!==null;){if(t=n[Tl])return t;n=Kk(n)}return e}n=t,t=n.parentNode}return null}function m0(n){return n=n[Tl]||n[Lu],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function ph(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(fn(33))}function hT(n){return n[Bm]||null}var RR=[],gh=-1;function Kc(n){return{current:n}}function ai(n){0>gh||(n.current=RR[gh],RR[gh]=null,gh--)}function qr(n,e){gh++,RR[gh]=n.current,n.current=e}var Oc={},Is=Kc(Oc),da=Kc(!1),zf=Oc;function Wh(n,e){var t=n.type.contextTypes;if(!t)return Oc;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o={},u;for(u in t)o[u]=e[u];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=o),o}function ha(n){return n=n.childContextTypes,n!=null}function qE(){ai(da),ai(Is)}function Gk(n,e,t){if(Is.current!==Oc)throw Error(fn(168));qr(Is,e),qr(da,t)}function k3(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var o in r)if(!(o in e))throw Error(fn(108,kY(n)||"Unknown",o));return Ci({},t,r)}function QE(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Oc,zf=Is.current,qr(Is,n),qr(da,da.current),!0}function Wk(n,e,t){var r=n.stateNode;if(!r)throw Error(fn(169));t?(n=k3(n,e,zf),r.__reactInternalMemoizedMergedChildContext=n,ai(da),ai(Is),qr(Is,n)):ai(da),qr(da,t)}var Tu=null,pT=!1,LC=!1;function U3(n){Tu===null?Tu=[n]:Tu.push(n)}function eq(n){pT=!0,U3(n)}function Gc(){if(!LC&&Tu!==null){LC=!0;var n=0,e=kr;try{var t=Tu;for(kr=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Tu=null,pT=!1}catch(o){throw Tu!==null&&(Tu=Tu.slice(n+1)),u3(dD,Gc),o}finally{kr=e,LC=!1}}return null}var mh=[],vh=0,JE=null,ZE=0,so=[],ao=0,Yf=null,Cu=1,Iu="";function Cf(n,e){mh[vh++]=ZE,mh[vh++]=JE,JE=n,ZE=e}function B3(n,e,t){so[ao++]=Cu,so[ao++]=Iu,so[ao++]=Yf,Yf=n;var r=Cu;n=Iu;var o=32-$o(r)-1;r&=~(1<<o),t+=1;var u=32-$o(e)+o;if(30<u){var h=o-o%5;u=(r&(1<<h)-1).toString(32),r>>=h,o-=h,Cu=1<<32-$o(e)+o|t<<o|r,Iu=u+n}else Cu=1<<u|t<<o|r,Iu=n}function TD(n){n.return!==null&&(Cf(n,1),B3(n,1,0))}function SD(n){for(;n===JE;)JE=mh[--vh],mh[vh]=null,ZE=mh[--vh],mh[vh]=null;for(;n===Yf;)Yf=so[--ao],so[ao]=null,Iu=so[--ao],so[ao]=null,Cu=so[--ao],so[ao]=null}var Ka=null,ja=null,di=!1,jo=null;function j3(n,e){var t=lo(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function Hk(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ka=n,ja=bc(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ka=n,ja=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Yf!==null?{id:Cu,overflow:Iu}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=lo(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ka=n,ja=null,!0):!1;default:return!1}}function bR(n){return(n.mode&1)!==0&&(n.flags&128)===0}function DR(n){if(di){var e=ja;if(e){var t=e;if(!Hk(n,e)){if(bR(n))throw Error(fn(418));e=bc(t.nextSibling);var r=Ka;e&&Hk(n,e)?j3(r,t):(n.flags=n.flags&-4097|2,di=!1,Ka=n)}}else{if(bR(n))throw Error(fn(418));n.flags=n.flags&-4097|2,di=!1,Ka=n}}}function Vk(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ka=n}function Uy(n){if(n!==Ka)return!1;if(!di)return Vk(n),di=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!xR(n.type,n.memoizedProps)),e&&(e=ja)){if(bR(n))throw K3(),Error(fn(418));for(;e;)j3(n,e),e=bc(e.nextSibling)}if(Vk(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(fn(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){ja=bc(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}ja=null}}else ja=Ka?bc(n.stateNode.nextSibling):null;return!0}function K3(){for(var n=ja;n;)n=bc(n.nextSibling)}function Hh(){ja=Ka=null,di=!1}function AD(n){jo===null?jo=[n]:jo.push(n)}var tq=ju.ReactCurrentBatchConfig;function Uo(n,e){if(n&&n.defaultProps){e=Ci({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var e_=Kc(null),t_=null,yh=null,xD=null;function CD(){xD=yh=t_=null}function ID(n){var e=e_.current;ai(e_),n._currentValue=e}function PR(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function wh(n,e){t_=n,xD=yh=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(fa=!0),n.firstContext=null)}function fo(n){var e=n._currentValue;if(xD!==n)if(n={context:n,memoizedValue:e,next:null},yh===null){if(t_===null)throw Error(fn(308));yh=n,t_.dependencies={lanes:0,firstContext:n}}else yh=yh.next=n;return e}var Nf=null;function RD(n){Nf===null?Nf=[n]:Nf.push(n)}function G3(n,e,t,r){var o=e.interleaved;return o===null?(t.next=t,RD(e)):(t.next=o.next,o.next=t),e.interleaved=t,Mu(n,r)}function Mu(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var gc=!1;function bD(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function W3(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ru(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Dc(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,Cr&2){var o=r.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),r.pending=e,Mu(n,t)}return o=r.interleaved,o===null?(e.next=e,RD(r)):(e.next=o.next,o.next=e),r.interleaved=e,Mu(n,t)}function CE(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,hD(n,t)}}function $k(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var o=null,u=null;if(t=t.firstBaseUpdate,t!==null){do{var h={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};u===null?o=u=h:u=u.next=h,t=t.next}while(t!==null);u===null?o=u=e:u=u.next=e}else o=u=e;t={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:u,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function n_(n,e,t,r){var o=n.updateQueue;gc=!1;var u=o.firstBaseUpdate,h=o.lastBaseUpdate,f=o.shared.pending;if(f!==null){o.shared.pending=null;var d=f,m=d.next;d.next=null,h===null?u=m:h.next=m,h=d;var g=n.alternate;g!==null&&(g=g.updateQueue,f=g.lastBaseUpdate,f!==h&&(f===null?g.firstBaseUpdate=m:f.next=m,g.lastBaseUpdate=d))}if(u!==null){var v=o.baseState;h=0,g=m=d=null,f=u;do{var _=f.lane,S=f.eventTime;if((r&_)===_){g!==null&&(g=g.next={eventTime:S,lane:0,tag:f.tag,payload:f.payload,callback:f.callback,next:null});e:{var E=n,T=f;switch(_=e,S=t,T.tag){case 1:if(E=T.payload,typeof E=="function"){v=E.call(S,v,_);break e}v=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=T.payload,_=typeof E=="function"?E.call(S,v,_):E,_==null)break e;v=Ci({},v,_);break e;case 2:gc=!0}}f.callback!==null&&f.lane!==0&&(n.flags|=64,_=o.effects,_===null?o.effects=[f]:_.push(f))}else S={eventTime:S,lane:_,tag:f.tag,payload:f.payload,callback:f.callback,next:null},g===null?(m=g=S,d=v):g=g.next=S,h|=_;if(f=f.next,f===null){if(f=o.shared.pending,f===null)break;_=f,f=_.next,_.next=null,o.lastBaseUpdate=_,o.shared.pending=null}}while(1);if(g===null&&(d=v),o.baseState=d,o.firstBaseUpdate=m,o.lastBaseUpdate=g,e=o.shared.interleaved,e!==null){o=e;do h|=o.lane,o=o.next;while(o!==e)}else u===null&&(o.shared.lanes=0);qf|=h,n.lanes=h,n.memoizedState=v}}function zk(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],o=r.callback;if(o!==null){if(r.callback=null,r=t,typeof o!="function")throw Error(fn(191,o));o.call(r)}}}var H3=new G4.Component().refs;function LR(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Ci({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var gT={isMounted:function(n){return(n=n._reactInternals)?id(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Vs(),o=Lc(n),u=Ru(r,o);u.payload=e,t!=null&&(u.callback=t),e=Dc(n,u,o),e!==null&&(zo(e,n,o,r),CE(e,n,o))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Vs(),o=Lc(n),u=Ru(r,o);u.tag=1,u.payload=e,t!=null&&(u.callback=t),e=Dc(n,u,o),e!==null&&(zo(e,n,o,r),CE(e,n,o))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Vs(),r=Lc(n),o=Ru(t,r);o.tag=2,e!=null&&(o.callback=e),e=Dc(n,o,r),e!==null&&(zo(e,n,r,t),CE(e,n,r))}};function Yk(n,e,t,r,o,u,h){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,u,h):e.prototype&&e.prototype.isPureReactComponent?!Fm(t,r)||!Fm(o,u):!0}function V3(n,e,t){var r=!1,o=Oc,u=e.contextType;return typeof u=="object"&&u!==null?u=fo(u):(o=ha(e)?zf:Is.current,r=e.contextTypes,u=(r=r!=null)?Wh(n,o):Oc),e=new e(t,u),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=gT,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=o,n.__reactInternalMemoizedMaskedChildContext=u),e}function Xk(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&gT.enqueueReplaceState(e,e.state,null)}function MR(n,e,t,r){var o=n.stateNode;o.props=t,o.state=n.memoizedState,o.refs=H3,bD(n);var u=e.contextType;typeof u=="object"&&u!==null?o.context=fo(u):(u=ha(e)?zf:Is.current,o.context=Wh(n,u)),o.state=n.memoizedState,u=e.getDerivedStateFromProps,typeof u=="function"&&(LR(n,e,u,t),o.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&gT.enqueueReplaceState(o,o.state,null),n_(n,t,o,r),o.state=n.memoizedState),typeof o.componentDidMount=="function"&&(n.flags|=4194308)}function bg(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(fn(309));var r=t.stateNode}if(!r)throw Error(fn(147,n));var o=r,u=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===u?e.ref:(e=function(h){var f=o.refs;f===H3&&(f=o.refs={}),h===null?delete f[u]:f[u]=h},e._stringRef=u,e)}if(typeof n!="string")throw Error(fn(284));if(!t._owner)throw Error(fn(290,n))}return n}function By(n,e){throw n=Object.prototype.toString.call(e),Error(fn(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function qk(n){var e=n._init;return e(n._payload)}function $3(n){function e(R,b){if(n){var F=R.deletions;F===null?(R.deletions=[b],R.flags|=16):F.push(b)}}function t(R,b){if(!n)return null;for(;b!==null;)e(R,b),b=b.sibling;return null}function r(R,b){for(R=new Map;b!==null;)b.key!==null?R.set(b.key,b):R.set(b.index,b),b=b.sibling;return R}function o(R,b){return R=Mc(R,b),R.index=0,R.sibling=null,R}function u(R,b,F){return R.index=F,n?(F=R.alternate,F!==null?(F=F.index,F<b?(R.flags|=2,b):F):(R.flags|=2,b)):(R.flags|=1048576,b)}function h(R){return n&&R.alternate===null&&(R.flags|=2),R}function f(R,b,F,O){return b===null||b.tag!==6?(b=UC(F,R.mode,O),b.return=R,b):(b=o(b,F),b.return=R,b)}function d(R,b,F,O){var L=F.type;return L===ch?g(R,b,F.props.children,O,F.key):b!==null&&(b.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===pc&&qk(L)===b.type)?(O=o(b,F.props),O.ref=bg(R,b,F),O.return=R,O):(O=LE(F.type,F.key,F.props,null,R.mode,O),O.ref=bg(R,b,F),O.return=R,O)}function m(R,b,F,O){return b===null||b.tag!==4||b.stateNode.containerInfo!==F.containerInfo||b.stateNode.implementation!==F.implementation?(b=BC(F,R.mode,O),b.return=R,b):(b=o(b,F.children||[]),b.return=R,b)}function g(R,b,F,O,L){return b===null||b.tag!==7?(b=Bf(F,R.mode,O,L),b.return=R,b):(b=o(b,F),b.return=R,b)}function v(R,b,F){if(typeof b=="string"&&b!==""||typeof b=="number")return b=UC(""+b,R.mode,F),b.return=R,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case by:return F=LE(b.type,b.key,b.props,null,R.mode,F),F.ref=bg(R,null,b),F.return=R,F;case uh:return b=BC(b,R.mode,F),b.return=R,b;case pc:var O=b._init;return v(R,O(b._payload),F)}if(zg(b)||Ag(b))return b=Bf(b,R.mode,F,null),b.return=R,b;By(R,b)}return null}function _(R,b,F,O){var L=b!==null?b.key:null;if(typeof F=="string"&&F!==""||typeof F=="number")return L!==null?null:f(R,b,""+F,O);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case by:return F.key===L?d(R,b,F,O):null;case uh:return F.key===L?m(R,b,F,O):null;case pc:return L=F._init,_(R,b,L(F._payload),O)}if(zg(F)||Ag(F))return L!==null?null:g(R,b,F,O,null);By(R,F)}return null}function S(R,b,F,O,L){if(typeof O=="string"&&O!==""||typeof O=="number")return R=R.get(F)||null,f(b,R,""+O,L);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case by:return R=R.get(O.key===null?F:O.key)||null,d(b,R,O,L);case uh:return R=R.get(O.key===null?F:O.key)||null,m(b,R,O,L);case pc:var D=O._init;return S(R,b,F,D(O._payload),L)}if(zg(O)||Ag(O))return R=R.get(F)||null,g(b,R,O,L,null);By(b,O)}return null}function E(R,b,F,O){for(var L=null,D=null,x=b,B=b=0,M=null;x!==null&&B<F.length;B++){x.index>B?(M=x,x=null):M=x.sibling;var I=_(R,x,F[B],O);if(I===null){x===null&&(x=M);break}n&&x&&I.alternate===null&&e(R,x),b=u(I,b,B),D===null?L=I:D.sibling=I,D=I,x=M}if(B===F.length)return t(R,x),di&&Cf(R,B),L;if(x===null){for(;B<F.length;B++)x=v(R,F[B],O),x!==null&&(b=u(x,b,B),D===null?L=x:D.sibling=x,D=x);return di&&Cf(R,B),L}for(x=r(R,x);B<F.length;B++)M=S(x,R,B,F[B],O),M!==null&&(n&&M.alternate!==null&&x.delete(M.key===null?B:M.key),b=u(M,b,B),D===null?L=M:D.sibling=M,D=M);return n&&x.forEach(function(U){return e(R,U)}),di&&Cf(R,B),L}function T(R,b,F,O){var L=Ag(F);if(typeof L!="function")throw Error(fn(150));if(F=L.call(F),F==null)throw Error(fn(151));for(var D=L=null,x=b,B=b=0,M=null,I=F.next();x!==null&&!I.done;B++,I=F.next()){x.index>B?(M=x,x=null):M=x.sibling;var U=_(R,x,I.value,O);if(U===null){x===null&&(x=M);break}n&&x&&U.alternate===null&&e(R,x),b=u(U,b,B),D===null?L=U:D.sibling=U,D=U,x=M}if(I.done)return t(R,x),di&&Cf(R,B),L;if(x===null){for(;!I.done;B++,I=F.next())I=v(R,I.value,O),I!==null&&(b=u(I,b,B),D===null?L=I:D.sibling=I,D=I);return di&&Cf(R,B),L}for(x=r(R,x);!I.done;B++,I=F.next())I=S(x,R,B,I.value,O),I!==null&&(n&&I.alternate!==null&&x.delete(I.key===null?B:I.key),b=u(I,b,B),D===null?L=I:D.sibling=I,D=I);return n&&x.forEach(function(w){return e(R,w)}),di&&Cf(R,B),L}function C(R,b,F,O){if(typeof F=="object"&&F!==null&&F.type===ch&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case by:e:{for(var L=F.key,D=b;D!==null;){if(D.key===L){if(L=F.type,L===ch){if(D.tag===7){t(R,D.sibling),b=o(D,F.props.children),b.return=R,R=b;break e}}else if(D.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===pc&&qk(L)===D.type){t(R,D.sibling),b=o(D,F.props),b.ref=bg(R,D,F),b.return=R,R=b;break e}t(R,D);break}else e(R,D);D=D.sibling}F.type===ch?(b=Bf(F.props.children,R.mode,O,F.key),b.return=R,R=b):(O=LE(F.type,F.key,F.props,null,R.mode,O),O.ref=bg(R,b,F),O.return=R,R=O)}return h(R);case uh:e:{for(D=F.key;b!==null;){if(b.key===D)if(b.tag===4&&b.stateNode.containerInfo===F.containerInfo&&b.stateNode.implementation===F.implementation){t(R,b.sibling),b=o(b,F.children||[]),b.return=R,R=b;break e}else{t(R,b);break}else e(R,b);b=b.sibling}b=BC(F,R.mode,O),b.return=R,R=b}return h(R);case pc:return D=F._init,C(R,b,D(F._payload),O)}if(zg(F))return E(R,b,F,O);if(Ag(F))return T(R,b,F,O);By(R,F)}return typeof F=="string"&&F!==""||typeof F=="number"?(F=""+F,b!==null&&b.tag===6?(t(R,b.sibling),b=o(b,F),b.return=R,R=b):(t(R,b),b=UC(F,R.mode,O),b.return=R,R=b),h(R)):t(R,b)}return C}var Vh=$3(!0),z3=$3(!1),v0={},Rl=Kc(v0),jm=Kc(v0),Km=Kc(v0);function Ff(n){if(n===v0)throw Error(fn(174));return n}function DD(n,e){switch(qr(Km,e),qr(jm,n),qr(Rl,v0),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:cR(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=cR(e,n)}ai(Rl),qr(Rl,e)}function $h(){ai(Rl),ai(jm),ai(Km)}function Y3(n){Ff(Km.current);var e=Ff(Rl.current),t=cR(e,n.type);e!==t&&(qr(jm,n),qr(Rl,t))}function PD(n){jm.current===n&&(ai(Rl),ai(jm))}var Ei=Kc(0);function r_(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var MC=[];function LD(){for(var n=0;n<MC.length;n++)MC[n]._workInProgressVersionPrimary=null;MC.length=0}var IE=ju.ReactCurrentDispatcher,wC=ju.ReactCurrentBatchConfig,Xf=0,xi=null,zi=null,ns=null,i_=!1,fm=!1,Gm=0,nq=0;function ys(){throw Error(fn(321))}function MD(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Xo(n[t],e[t]))return!1;return!0}function wD(n,e,t,r,o,u){if(Xf=u,xi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,IE.current=n===null||n.memoizedState===null?aq:oq,n=t(r,o),fm){u=0;do{if(fm=!1,Gm=0,25<=u)throw Error(fn(301));u+=1,ns=zi=null,e.updateQueue=null,IE.current=lq,n=t(r,o)}while(fm)}if(IE.current=s_,e=zi!==null&&zi.next!==null,Xf=0,ns=zi=xi=null,i_=!1,e)throw Error(fn(300));return n}function OD(){var n=Gm!==0;return Gm=0,n}function ml(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ns===null?xi.memoizedState=ns=n:ns=ns.next=n,ns}function ho(){if(zi===null){var n=xi.alternate;n=n!==null?n.memoizedState:null}else n=zi.next;var e=ns===null?xi.memoizedState:ns.next;if(e!==null)ns=e,zi=n;else{if(n===null)throw Error(fn(310));zi=n,n={memoizedState:zi.memoizedState,baseState:zi.baseState,baseQueue:zi.baseQueue,queue:zi.queue,next:null},ns===null?xi.memoizedState=ns=n:ns=ns.next=n}return ns}function Wm(n,e){return typeof e=="function"?e(n):e}function OC(n){var e=ho(),t=e.queue;if(t===null)throw Error(fn(311));t.lastRenderedReducer=n;var r=zi,o=r.baseQueue,u=t.pending;if(u!==null){if(o!==null){var h=o.next;o.next=u.next,u.next=h}r.baseQueue=o=u,t.pending=null}if(o!==null){u=o.next,r=r.baseState;var f=h=null,d=null,m=u;do{var g=m.lane;if((Xf&g)===g)d!==null&&(d=d.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),r=m.hasEagerState?m.eagerState:n(r,m.action);else{var v={lane:g,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};d===null?(f=d=v,h=r):d=d.next=v,xi.lanes|=g,qf|=g}m=m.next}while(m!==null&&m!==u);d===null?h=r:d.next=f,Xo(r,e.memoizedState)||(fa=!0),e.memoizedState=r,e.baseState=h,e.baseQueue=d,t.lastRenderedState=r}if(n=t.interleaved,n!==null){o=n;do u=o.lane,xi.lanes|=u,qf|=u,o=o.next;while(o!==n)}else o===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function NC(n){var e=ho(),t=e.queue;if(t===null)throw Error(fn(311));t.lastRenderedReducer=n;var r=t.dispatch,o=t.pending,u=e.memoizedState;if(o!==null){t.pending=null;var h=o=o.next;do u=n(u,h.action),h=h.next;while(h!==o);Xo(u,e.memoizedState)||(fa=!0),e.memoizedState=u,e.baseQueue===null&&(e.baseState=u),t.lastRenderedState=u}return[u,r]}function X3(){}function q3(n,e){var t=xi,r=ho(),o=e(),u=!Xo(r.memoizedState,o);if(u&&(r.memoizedState=o,fa=!0),r=r.queue,ND(Z3.bind(null,t,r,n),[n]),r.getSnapshot!==e||u||ns!==null&&ns.memoizedState.tag&1){if(t.flags|=2048,Hm(9,J3.bind(null,t,r,o,e),void 0,null),ss===null)throw Error(fn(349));Xf&30||Q3(t,e,o)}return o}function Q3(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=xi.updateQueue,e===null?(e={lastEffect:null,stores:null},xi.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function J3(n,e,t,r){e.value=t,e.getSnapshot=r,ej(e)&&tj(n)}function Z3(n,e,t){return t(function(){ej(e)&&tj(n)})}function ej(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Xo(n,t)}catch{return!0}}function tj(n){var e=Mu(n,1);e!==null&&zo(e,n,1,-1)}function Qk(n){var e=ml();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wm,lastRenderedState:n},e.queue=n,n=n.dispatch=sq.bind(null,xi,n),[e.memoizedState,n]}function Hm(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=xi.updateQueue,e===null?(e={lastEffect:null,stores:null},xi.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function nj(){return ho().memoizedState}function RE(n,e,t,r){var o=ml();xi.flags|=n,o.memoizedState=Hm(1|e,t,void 0,r===void 0?null:r)}function mT(n,e,t,r){var o=ho();r=r===void 0?null:r;var u=void 0;if(zi!==null){var h=zi.memoizedState;if(u=h.destroy,r!==null&&MD(r,h.deps)){o.memoizedState=Hm(e,t,u,r);return}}xi.flags|=n,o.memoizedState=Hm(1|e,t,u,r)}function Jk(n,e){return RE(8390656,8,n,e)}function ND(n,e){return mT(2048,8,n,e)}function rj(n,e){return mT(4,2,n,e)}function ij(n,e){return mT(4,4,n,e)}function sj(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function aj(n,e,t){return t=t!=null?t.concat([n]):null,mT(4,4,sj.bind(null,e,n),t)}function FD(){}function oj(n,e){var t=ho();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&MD(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function lj(n,e){var t=ho();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&MD(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function uj(n,e,t){return Xf&21?(Xo(t,e)||(t=d3(),xi.lanes|=t,qf|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,fa=!0),n.memoizedState=t)}function rq(n,e){var t=kr;kr=t!==0&&4>t?t:4,n(!0);var r=wC.transition;wC.transition={};try{n(!1),e()}finally{kr=t,wC.transition=r}}function cj(){return ho().memoizedState}function iq(n,e,t){var r=Lc(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},fj(n))dj(e,t);else if(t=G3(n,e,t,r),t!==null){var o=Vs();zo(t,n,r,o),hj(t,e,r)}}function sq(n,e,t){var r=Lc(n),o={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(fj(n))dj(e,o);else{var u=n.alternate;if(n.lanes===0&&(u===null||u.lanes===0)&&(u=e.lastRenderedReducer,u!==null))try{var h=e.lastRenderedState,f=u(h,t);if(o.hasEagerState=!0,o.eagerState=f,Xo(f,h)){var d=e.interleaved;d===null?(o.next=o,RD(e)):(o.next=d.next,d.next=o),e.interleaved=o;return}}catch{}finally{}t=G3(n,e,o,r),t!==null&&(o=Vs(),zo(t,n,r,o),hj(t,e,r))}}function fj(n){var e=n.alternate;return n===xi||e!==null&&e===xi}function dj(n,e){fm=i_=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function hj(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,hD(n,t)}}var s_={readContext:fo,useCallback:ys,useContext:ys,useEffect:ys,useImperativeHandle:ys,useInsertionEffect:ys,useLayoutEffect:ys,useMemo:ys,useReducer:ys,useRef:ys,useState:ys,useDebugValue:ys,useDeferredValue:ys,useTransition:ys,useMutableSource:ys,useSyncExternalStore:ys,useId:ys,unstable_isNewReconciler:!1},aq={readContext:fo,useCallback:function(n,e){return ml().memoizedState=[n,e===void 0?null:e],n},useContext:fo,useEffect:Jk,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,RE(4194308,4,sj.bind(null,e,n),t)},useLayoutEffect:function(n,e){return RE(4194308,4,n,e)},useInsertionEffect:function(n,e){return RE(4,2,n,e)},useMemo:function(n,e){var t=ml();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=ml();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=iq.bind(null,xi,n),[r.memoizedState,n]},useRef:function(n){var e=ml();return n={current:n},e.memoizedState=n},useState:Qk,useDebugValue:FD,useDeferredValue:function(n){return ml().memoizedState=n},useTransition:function(){var n=Qk(!1),e=n[0];return n=rq.bind(null,n[1]),ml().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=xi,o=ml();if(di){if(t===void 0)throw Error(fn(407));t=t()}else{if(t=e(),ss===null)throw Error(fn(349));Xf&30||Q3(r,e,t)}o.memoizedState=t;var u={value:t,getSnapshot:e};return o.queue=u,Jk(Z3.bind(null,r,u,n),[n]),r.flags|=2048,Hm(9,J3.bind(null,r,u,t,e),void 0,null),t},useId:function(){var n=ml(),e=ss.identifierPrefix;if(di){var t=Iu,r=Cu;t=(r&~(1<<32-$o(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Gm++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=nq++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},oq={readContext:fo,useCallback:oj,useContext:fo,useEffect:ND,useImperativeHandle:aj,useInsertionEffect:rj,useLayoutEffect:ij,useMemo:lj,useReducer:OC,useRef:nj,useState:function(){return OC(Wm)},useDebugValue:FD,useDeferredValue:function(n){var e=ho();return uj(e,zi.memoizedState,n)},useTransition:function(){var n=OC(Wm)[0],e=ho().memoizedState;return[n,e]},useMutableSource:X3,useSyncExternalStore:q3,useId:cj,unstable_isNewReconciler:!1},lq={readContext:fo,useCallback:oj,useContext:fo,useEffect:ND,useImperativeHandle:aj,useInsertionEffect:rj,useLayoutEffect:ij,useMemo:lj,useReducer:NC,useRef:nj,useState:function(){return NC(Wm)},useDebugValue:FD,useDeferredValue:function(n){var e=ho();return zi===null?e.memoizedState=n:uj(e,zi.memoizedState,n)},useTransition:function(){var n=NC(Wm)[0],e=ho().memoizedState;return[n,e]},useMutableSource:X3,useSyncExternalStore:q3,useId:cj,unstable_isNewReconciler:!1};function zh(n,e){try{var t="",r=e;do t+=FY(r),r=r.return;while(r);var o=t}catch(u){o=`
Error generating stack: `+u.message+`
`+u.stack}return{value:n,source:e,stack:o,digest:null}}function FC(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function wR(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var uq=typeof WeakMap=="function"?WeakMap:Map;function pj(n,e,t){t=Ru(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){o_||(o_=!0,WR=r),wR(n,e)},t}function gj(n,e,t){t=Ru(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var o=e.value;t.payload=function(){return r(o)},t.callback=function(){wR(n,e)}}var u=n.stateNode;return u!==null&&typeof u.componentDidCatch=="function"&&(t.callback=function(){wR(n,e),typeof r!="function"&&(Pc===null?Pc=new Set([this]):Pc.add(this));var h=e.stack;this.componentDidCatch(e.value,{componentStack:h!==null?h:""})}),t}function Zk(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new uq;var o=new Set;r.set(e,o)}else o=r.get(e),o===void 0&&(o=new Set,r.set(e,o));o.has(t)||(o.add(t),n=Aq.bind(null,n,e,t),e.then(n,n))}function eU(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function tU(n,e,t,r,o){return n.mode&1?(n.flags|=65536,n.lanes=o,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ru(-1,1),e.tag=2,Dc(t,e,1))),t.lanes|=1),n)}var cq=ju.ReactCurrentOwner,fa=!1;function Fs(n,e,t,r){e.child=n===null?z3(e,null,t,r):Vh(e,n.child,t,r)}function nU(n,e,t,r,o){t=t.render;var u=e.ref;return wh(e,o),r=wD(n,e,t,r,u,o),t=OD(),n!==null&&!fa?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~o,wu(n,e,o)):(di&&t&&TD(e),e.flags|=1,Fs(n,e,r,o),e.child)}function rU(n,e,t,r,o){if(n===null){var u=t.type;return typeof u=="function"&&!HD(u)&&u.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=u,mj(n,e,u,r,o)):(n=LE(t.type,null,r,e,e.mode,o),n.ref=e.ref,n.return=e,e.child=n)}if(u=n.child,!(n.lanes&o)){var h=u.memoizedProps;if(t=t.compare,t=t!==null?t:Fm,t(h,r)&&n.ref===e.ref)return wu(n,e,o)}return e.flags|=1,n=Mc(u,r),n.ref=e.ref,n.return=e,e.child=n}function mj(n,e,t,r,o){if(n!==null){var u=n.memoizedProps;if(Fm(u,r)&&n.ref===e.ref)if(fa=!1,e.pendingProps=r=u,(n.lanes&o)!==0)n.flags&131072&&(fa=!0);else return e.lanes=n.lanes,wu(n,e,o)}return OR(n,e,t,r,o)}function vj(n,e,t){var r=e.pendingProps,o=r.children,u=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},qr(_h,Ua),Ua|=t;else{if(!(t&1073741824))return n=u!==null?u.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,qr(_h,Ua),Ua|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=u!==null?u.baseLanes:t,qr(_h,Ua),Ua|=r}else u!==null?(r=u.baseLanes|t,e.memoizedState=null):r=t,qr(_h,Ua),Ua|=r;return Fs(n,e,o,t),e.child}function yj(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function OR(n,e,t,r,o){var u=ha(t)?zf:Is.current;return u=Wh(e,u),wh(e,o),t=wD(n,e,t,r,u,o),r=OD(),n!==null&&!fa?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~o,wu(n,e,o)):(di&&r&&TD(e),e.flags|=1,Fs(n,e,t,o),e.child)}function iU(n,e,t,r,o){if(ha(t)){var u=!0;QE(e)}else u=!1;if(wh(e,o),e.stateNode===null)bE(n,e),V3(e,t,r),MR(e,t,r,o),r=!0;else if(n===null){var h=e.stateNode,f=e.memoizedProps;h.props=f;var d=h.context,m=t.contextType;typeof m=="object"&&m!==null?m=fo(m):(m=ha(t)?zf:Is.current,m=Wh(e,m));var g=t.getDerivedStateFromProps,v=typeof g=="function"||typeof h.getSnapshotBeforeUpdate=="function";v||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(f!==r||d!==m)&&Xk(e,h,r,m),gc=!1;var _=e.memoizedState;h.state=_,n_(e,r,h,o),d=e.memoizedState,f!==r||_!==d||da.current||gc?(typeof g=="function"&&(LR(e,t,g,r),d=e.memoizedState),(f=gc||Yk(e,t,f,r,_,d,m))?(v||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(e.flags|=4194308)):(typeof h.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=d),h.props=r,h.state=d,h.context=m,r=f):(typeof h.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{h=e.stateNode,W3(n,e),f=e.memoizedProps,m=e.type===e.elementType?f:Uo(e.type,f),h.props=m,v=e.pendingProps,_=h.context,d=t.contextType,typeof d=="object"&&d!==null?d=fo(d):(d=ha(t)?zf:Is.current,d=Wh(e,d));var S=t.getDerivedStateFromProps;(g=typeof S=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(f!==v||_!==d)&&Xk(e,h,r,d),gc=!1,_=e.memoizedState,h.state=_,n_(e,r,h,o);var E=e.memoizedState;f!==v||_!==E||da.current||gc?(typeof S=="function"&&(LR(e,t,S,r),E=e.memoizedState),(m=gc||Yk(e,t,m,r,_,E,d)||!1)?(g||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(r,E,d),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(r,E,d)),typeof h.componentDidUpdate=="function"&&(e.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof h.componentDidUpdate!="function"||f===n.memoizedProps&&_===n.memoizedState||(e.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||f===n.memoizedProps&&_===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),h.props=r,h.state=E,h.context=d,r=m):(typeof h.componentDidUpdate!="function"||f===n.memoizedProps&&_===n.memoizedState||(e.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||f===n.memoizedProps&&_===n.memoizedState||(e.flags|=1024),r=!1)}return NR(n,e,t,r,u,o)}function NR(n,e,t,r,o,u){yj(n,e);var h=(e.flags&128)!==0;if(!r&&!h)return o&&Wk(e,t,!1),wu(n,e,u);r=e.stateNode,cq.current=e;var f=h&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&h?(e.child=Vh(e,n.child,null,u),e.child=Vh(e,null,f,u)):Fs(n,e,f,u),e.memoizedState=r.state,o&&Wk(e,t,!0),e.child}function Ej(n){var e=n.stateNode;e.pendingContext?Gk(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Gk(n,e.context,!1),DD(n,e.containerInfo)}function sU(n,e,t,r,o){return Hh(),AD(o),e.flags|=256,Fs(n,e,t,r),e.child}var FR={dehydrated:null,treeContext:null,retryLane:0};function kR(n){return{baseLanes:n,cachePool:null,transitions:null}}function _j(n,e,t){var r=e.pendingProps,o=Ei.current,u=!1,h=(e.flags&128)!==0,f;if((f=h)||(f=n!==null&&n.memoizedState===null?!1:(o&2)!==0),f?(u=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(o|=1),qr(Ei,o&1),n===null)return DR(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(h=r.children,n=r.fallback,u?(r=e.mode,u=e.child,h={mode:"hidden",children:h},!(r&1)&&u!==null?(u.childLanes=0,u.pendingProps=h):u=ET(h,r,0,null),n=Bf(n,r,t,null),u.return=e,n.return=e,u.sibling=n,e.child=u,e.child.memoizedState=kR(t),e.memoizedState=FR,n):kD(e,h));if(o=n.memoizedState,o!==null&&(f=o.dehydrated,f!==null))return fq(n,e,h,r,f,o,t);if(u){u=r.fallback,h=e.mode,o=n.child,f=o.sibling;var d={mode:"hidden",children:r.children};return!(h&1)&&e.child!==o?(r=e.child,r.childLanes=0,r.pendingProps=d,e.deletions=null):(r=Mc(o,d),r.subtreeFlags=o.subtreeFlags&14680064),f!==null?u=Mc(f,u):(u=Bf(u,h,t,null),u.flags|=2),u.return=e,r.return=e,r.sibling=u,e.child=r,r=u,u=e.child,h=n.child.memoizedState,h=h===null?kR(t):{baseLanes:h.baseLanes|t,cachePool:null,transitions:h.transitions},u.memoizedState=h,u.childLanes=n.childLanes&~t,e.memoizedState=FR,r}return u=n.child,n=u.sibling,r=Mc(u,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function kD(n,e){return e=ET({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function jy(n,e,t,r){return r!==null&&AD(r),Vh(e,n.child,null,t),n=kD(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function fq(n,e,t,r,o,u,h){if(t)return e.flags&256?(e.flags&=-257,r=FC(Error(fn(422))),jy(n,e,h,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(u=r.fallback,o=e.mode,r=ET({mode:"visible",children:r.children},o,0,null),u=Bf(u,o,h,null),u.flags|=2,r.return=e,u.return=e,r.sibling=u,e.child=r,e.mode&1&&Vh(e,n.child,null,h),e.child.memoizedState=kR(h),e.memoizedState=FR,u);if(!(e.mode&1))return jy(n,e,h,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var f=r.dgst;return r=f,u=Error(fn(419)),r=FC(u,r,void 0),jy(n,e,h,r)}if(f=(h&n.childLanes)!==0,fa||f){if(r=ss,r!==null){switch(h&-h){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|h)?0:o,o!==0&&o!==u.retryLane&&(u.retryLane=o,Mu(n,o),zo(r,n,o,-1))}return WD(),r=FC(Error(fn(421))),jy(n,e,h,r)}return o.data==="$?"?(e.flags|=128,e.child=n.child,e=xq.bind(null,n),o._reactRetry=e,null):(n=u.treeContext,ja=bc(o.nextSibling),Ka=e,di=!0,jo=null,n!==null&&(so[ao++]=Cu,so[ao++]=Iu,so[ao++]=Yf,Cu=n.id,Iu=n.overflow,Yf=e),e=kD(e,r.children),e.flags|=4096,e)}function aU(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),PR(n.return,e,t)}function kC(n,e,t,r,o){var u=n.memoizedState;u===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:o}:(u.isBackwards=e,u.rendering=null,u.renderingStartTime=0,u.last=r,u.tail=t,u.tailMode=o)}function Tj(n,e,t){var r=e.pendingProps,o=r.revealOrder,u=r.tail;if(Fs(n,e,r.children,t),r=Ei.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&aU(n,t,e);else if(n.tag===19)aU(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(qr(Ei,r),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(t=e.child,o=null;t!==null;)n=t.alternate,n!==null&&r_(n)===null&&(o=t),t=t.sibling;t=o,t===null?(o=e.child,e.child=null):(o=t.sibling,t.sibling=null),kC(e,!1,o,t,u);break;case"backwards":for(t=null,o=e.child,e.child=null;o!==null;){if(n=o.alternate,n!==null&&r_(n)===null){e.child=o;break}n=o.sibling,o.sibling=t,t=o,o=n}kC(e,!0,t,null,u);break;case"together":kC(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function bE(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function wu(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),qf|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(fn(153));if(e.child!==null){for(n=e.child,t=Mc(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Mc(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function dq(n,e,t){switch(e.tag){case 3:Ej(e),Hh();break;case 5:Y3(e);break;case 1:ha(e.type)&&QE(e);break;case 4:DD(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,o=e.memoizedProps.value;qr(e_,r._currentValue),r._currentValue=o;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(qr(Ei,Ei.current&1),e.flags|=128,null):t&e.child.childLanes?_j(n,e,t):(qr(Ei,Ei.current&1),n=wu(n,e,t),n!==null?n.sibling:null);qr(Ei,Ei.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return Tj(n,e,t);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),qr(Ei,Ei.current),r)break;return null;case 22:case 23:return e.lanes=0,vj(n,e,t)}return wu(n,e,t)}var Sj,UR,Aj,xj;Sj=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};UR=function(){};Aj=function(n,e,t,r){var o=n.memoizedProps;if(o!==r){n=e.stateNode,Ff(Rl.current);var u=null;switch(t){case"input":o=aR(n,o),r=aR(n,r),u=[];break;case"select":o=Ci({},o,{value:void 0}),r=Ci({},r,{value:void 0}),u=[];break;case"textarea":o=uR(n,o),r=uR(n,r),u=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=XE)}fR(t,r);var h;t=null;for(m in o)if(!r.hasOwnProperty(m)&&o.hasOwnProperty(m)&&o[m]!=null)if(m==="style"){var f=o[m];for(h in f)f.hasOwnProperty(h)&&(t||(t={}),t[h]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(Dm.hasOwnProperty(m)?u||(u=[]):(u=u||[]).push(m,null));for(m in r){var d=r[m];if(f=o!=null?o[m]:void 0,r.hasOwnProperty(m)&&d!==f&&(d!=null||f!=null))if(m==="style")if(f){for(h in f)!f.hasOwnProperty(h)||d&&d.hasOwnProperty(h)||(t||(t={}),t[h]="");for(h in d)d.hasOwnProperty(h)&&f[h]!==d[h]&&(t||(t={}),t[h]=d[h])}else t||(u||(u=[]),u.push(m,t)),t=d;else m==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,f=f?f.__html:void 0,d!=null&&f!==d&&(u=u||[]).push(m,d)):m==="children"?typeof d!="string"&&typeof d!="number"||(u=u||[]).push(m,""+d):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(Dm.hasOwnProperty(m)?(d!=null&&m==="onScroll"&&si("scroll",n),u||f===d||(u=[])):(u=u||[]).push(m,d))}t&&(u=u||[]).push("style",t);var m=u;(e.updateQueue=m)&&(e.flags|=4)}};xj=function(n,e,t,r){t!==r&&(e.flags|=4)};function Dg(n,e){if(!di)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Es(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var o=n.child;o!==null;)t|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=n,o=o.sibling;else for(o=n.child;o!==null;)t|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=n,o=o.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function hq(n,e,t){var r=e.pendingProps;switch(SD(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Es(e),null;case 1:return ha(e.type)&&qE(),Es(e),null;case 3:return r=e.stateNode,$h(),ai(da),ai(Is),LD(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Uy(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,jo!==null&&($R(jo),jo=null))),UR(n,e),Es(e),null;case 5:PD(e);var o=Ff(Km.current);if(t=e.type,n!==null&&e.stateNode!=null)Aj(n,e,t,r,o),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(fn(166));return Es(e),null}if(n=Ff(Rl.current),Uy(e)){r=e.stateNode,t=e.type;var u=e.memoizedProps;switch(r[Tl]=e,r[Bm]=u,n=(e.mode&1)!==0,t){case"dialog":si("cancel",r),si("close",r);break;case"iframe":case"object":case"embed":si("load",r);break;case"video":case"audio":for(o=0;o<Xg.length;o++)si(Xg[o],r);break;case"source":si("error",r);break;case"img":case"image":case"link":si("error",r),si("load",r);break;case"details":si("toggle",r);break;case"input":gk(r,u),si("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!u.multiple},si("invalid",r);break;case"textarea":vk(r,u),si("invalid",r)}fR(t,u),o=null;for(var h in u)if(u.hasOwnProperty(h)){var f=u[h];h==="children"?typeof f=="string"?r.textContent!==f&&(u.suppressHydrationWarning!==!0&&ky(r.textContent,f,n),o=["children",f]):typeof f=="number"&&r.textContent!==""+f&&(u.suppressHydrationWarning!==!0&&ky(r.textContent,f,n),o=["children",""+f]):Dm.hasOwnProperty(h)&&f!=null&&h==="onScroll"&&si("scroll",r)}switch(t){case"input":Dy(r),mk(r,u,!0);break;case"textarea":Dy(r),yk(r);break;case"select":case"option":break;default:typeof u.onClick=="function"&&(r.onclick=XE)}r=o,e.updateQueue=r,r!==null&&(e.flags|=4)}else{h=o.nodeType===9?o:o.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Q4(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=h.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=h.createElement(t,{is:r.is}):(n=h.createElement(t),t==="select"&&(h=n,r.multiple?h.multiple=!0:r.size&&(h.size=r.size))):n=h.createElementNS(n,t),n[Tl]=e,n[Bm]=r,Sj(n,e,!1,!1),e.stateNode=n;e:{switch(h=dR(t,r),t){case"dialog":si("cancel",n),si("close",n),o=r;break;case"iframe":case"object":case"embed":si("load",n),o=r;break;case"video":case"audio":for(o=0;o<Xg.length;o++)si(Xg[o],n);o=r;break;case"source":si("error",n),o=r;break;case"img":case"image":case"link":si("error",n),si("load",n),o=r;break;case"details":si("toggle",n),o=r;break;case"input":gk(n,r),o=aR(n,r),si("invalid",n);break;case"option":o=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},o=Ci({},r,{value:void 0}),si("invalid",n);break;case"textarea":vk(n,r),o=uR(n,r),si("invalid",n);break;default:o=r}fR(t,o),f=o;for(u in f)if(f.hasOwnProperty(u)){var d=f[u];u==="style"?e3(n,d):u==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&J4(n,d)):u==="children"?typeof d=="string"?(t!=="textarea"||d!=="")&&Pm(n,d):typeof d=="number"&&Pm(n,""+d):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Dm.hasOwnProperty(u)?d!=null&&u==="onScroll"&&si("scroll",n):d!=null&&oD(n,u,d,h))}switch(t){case"input":Dy(n),mk(n,r,!1);break;case"textarea":Dy(n),yk(n);break;case"option":r.value!=null&&n.setAttribute("value",""+wc(r.value));break;case"select":n.multiple=!!r.multiple,u=r.value,u!=null?Dh(n,!!r.multiple,u,!1):r.defaultValue!=null&&Dh(n,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(n.onclick=XE)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Es(e),null;case 6:if(n&&e.stateNode!=null)xj(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(fn(166));if(t=Ff(Km.current),Ff(Rl.current),Uy(e)){if(r=e.stateNode,t=e.memoizedProps,r[Tl]=e,(u=r.nodeValue!==t)&&(n=Ka,n!==null))switch(n.tag){case 3:ky(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&ky(r.nodeValue,t,(n.mode&1)!==0)}u&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Tl]=e,e.stateNode=r}return Es(e),null;case 13:if(ai(Ei),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(di&&ja!==null&&e.mode&1&&!(e.flags&128))K3(),Hh(),e.flags|=98560,u=!1;else if(u=Uy(e),r!==null&&r.dehydrated!==null){if(n===null){if(!u)throw Error(fn(318));if(u=e.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(fn(317));u[Tl]=e}else Hh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Es(e),u=!1}else jo!==null&&($R(jo),jo=null),u=!0;if(!u)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Ei.current&1?Yi===0&&(Yi=3):WD())),e.updateQueue!==null&&(e.flags|=4),Es(e),null);case 4:return $h(),UR(n,e),n===null&&km(e.stateNode.containerInfo),Es(e),null;case 10:return ID(e.type._context),Es(e),null;case 17:return ha(e.type)&&qE(),Es(e),null;case 19:if(ai(Ei),u=e.memoizedState,u===null)return Es(e),null;if(r=(e.flags&128)!==0,h=u.rendering,h===null)if(r)Dg(u,!1);else{if(Yi!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(h=r_(n),h!==null){for(e.flags|=128,Dg(u,!1),r=h.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)u=t,n=r,u.flags&=14680066,h=u.alternate,h===null?(u.childLanes=0,u.lanes=n,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=h.childLanes,u.lanes=h.lanes,u.child=h.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=h.memoizedProps,u.memoizedState=h.memoizedState,u.updateQueue=h.updateQueue,u.type=h.type,n=h.dependencies,u.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return qr(Ei,Ei.current&1|2),e.child}n=n.sibling}u.tail!==null&&Fi()>Yh&&(e.flags|=128,r=!0,Dg(u,!1),e.lanes=4194304)}else{if(!r)if(n=r_(h),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Dg(u,!0),u.tail===null&&u.tailMode==="hidden"&&!h.alternate&&!di)return Es(e),null}else 2*Fi()-u.renderingStartTime>Yh&&t!==1073741824&&(e.flags|=128,r=!0,Dg(u,!1),e.lanes=4194304);u.isBackwards?(h.sibling=e.child,e.child=h):(t=u.last,t!==null?t.sibling=h:e.child=h,u.last=h)}return u.tail!==null?(e=u.tail,u.rendering=e,u.tail=e.sibling,u.renderingStartTime=Fi(),e.sibling=null,t=Ei.current,qr(Ei,r?t&1|2:t&1),e):(Es(e),null);case 22:case 23:return GD(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ua&1073741824&&(Es(e),e.subtreeFlags&6&&(e.flags|=8192)):Es(e),null;case 24:return null;case 25:return null}throw Error(fn(156,e.tag))}function pq(n,e){switch(SD(e),e.tag){case 1:return ha(e.type)&&qE(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return $h(),ai(da),ai(Is),LD(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return PD(e),null;case 13:if(ai(Ei),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(fn(340));Hh()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return ai(Ei),null;case 4:return $h(),null;case 10:return ID(e.type._context),null;case 22:case 23:return GD(),null;case 24:return null;default:return null}}var Ky=!1,Ss=!1,gq=typeof WeakSet=="function"?WeakSet:Set,bn=null;function Eh(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Di(n,e,r)}else t.current=null}function BR(n,e,t){try{t()}catch(r){Di(n,e,r)}}var oU=!1;function mq(n,e){if(SR=$E,n=b3(),_D(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var o=r.anchorOffset,u=r.focusNode;r=r.focusOffset;try{t.nodeType,u.nodeType}catch{t=null;break e}var h=0,f=-1,d=-1,m=0,g=0,v=n,_=null;t:for(;;){for(var S;v!==t||o!==0&&v.nodeType!==3||(f=h+o),v!==u||r!==0&&v.nodeType!==3||(d=h+r),v.nodeType===3&&(h+=v.nodeValue.length),(S=v.firstChild)!==null;)_=v,v=S;for(;;){if(v===n)break t;if(_===t&&++m===o&&(f=h),_===u&&++g===r&&(d=h),(S=v.nextSibling)!==null)break;v=_,_=v.parentNode}v=S}t=f===-1||d===-1?null:{start:f,end:d}}else t=null}t=t||{start:0,end:0}}else t=null;for(AR={focusedElem:n,selectionRange:t},$E=!1,bn=e;bn!==null;)if(e=bn,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,bn=n;else for(;bn!==null;){e=bn;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var T=E.memoizedProps,C=E.memoizedState,R=e.stateNode,b=R.getSnapshotBeforeUpdate(e.elementType===e.type?T:Uo(e.type,T),C);R.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var F=e.stateNode.containerInfo;F.nodeType===1?F.textContent="":F.nodeType===9&&F.documentElement&&F.removeChild(F.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(fn(163))}}catch(O){Di(e,e.return,O)}if(n=e.sibling,n!==null){n.return=e.return,bn=n;break}bn=e.return}return E=oU,oU=!1,E}function dm(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&n)===n){var u=o.destroy;o.destroy=void 0,u!==void 0&&BR(e,t,u)}o=o.next}while(o!==r)}}function vT(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function jR(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function Cj(n){var e=n.alternate;e!==null&&(n.alternate=null,Cj(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Tl],delete e[Bm],delete e[IR],delete e[JX],delete e[ZX])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Ij(n){return n.tag===5||n.tag===3||n.tag===4}function lU(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Ij(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function KR(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=XE));else if(r!==4&&(n=n.child,n!==null))for(KR(n,e,t),n=n.sibling;n!==null;)KR(n,e,t),n=n.sibling}function GR(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(GR(n,e,t),n=n.sibling;n!==null;)GR(n,e,t),n=n.sibling}var fs=null,Bo=!1;function oc(n,e,t){for(t=t.child;t!==null;)Rj(n,e,t),t=t.sibling}function Rj(n,e,t){if(Il&&typeof Il.onCommitFiberUnmount=="function")try{Il.onCommitFiberUnmount(uT,t)}catch{}switch(t.tag){case 5:Ss||Eh(t,e);case 6:var r=fs,o=Bo;fs=null,oc(n,e,t),fs=r,Bo=o,fs!==null&&(Bo?(n=fs,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):fs.removeChild(t.stateNode));break;case 18:fs!==null&&(Bo?(n=fs,t=t.stateNode,n.nodeType===8?PC(n.parentNode,t):n.nodeType===1&&PC(n,t),Om(n)):PC(fs,t.stateNode));break;case 4:r=fs,o=Bo,fs=t.stateNode.containerInfo,Bo=!0,oc(n,e,t),fs=r,Bo=o;break;case 0:case 11:case 14:case 15:if(!Ss&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var u=o,h=u.destroy;u=u.tag,h!==void 0&&(u&2||u&4)&&BR(t,e,h),o=o.next}while(o!==r)}oc(n,e,t);break;case 1:if(!Ss&&(Eh(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(f){Di(t,e,f)}oc(n,e,t);break;case 21:oc(n,e,t);break;case 22:t.mode&1?(Ss=(r=Ss)||t.memoizedState!==null,oc(n,e,t),Ss=r):oc(n,e,t);break;default:oc(n,e,t)}}function uU(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new gq),e.forEach(function(r){var o=Cq.bind(null,n,r);t.has(r)||(t.add(r),r.then(o,o))})}}function Oo(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var o=t[r];try{var u=n,h=e,f=h;e:for(;f!==null;){switch(f.tag){case 5:fs=f.stateNode,Bo=!1;break e;case 3:fs=f.stateNode.containerInfo,Bo=!0;break e;case 4:fs=f.stateNode.containerInfo,Bo=!0;break e}f=f.return}if(fs===null)throw Error(fn(160));Rj(u,h,o),fs=null,Bo=!1;var d=o.alternate;d!==null&&(d.return=null),o.return=null}catch(m){Di(o,e,m)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)bj(e,n),e=e.sibling}function bj(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Oo(e,n),pl(n),r&4){try{dm(3,n,n.return),vT(3,n)}catch(T){Di(n,n.return,T)}try{dm(5,n,n.return)}catch(T){Di(n,n.return,T)}}break;case 1:Oo(e,n),pl(n),r&512&&t!==null&&Eh(t,t.return);break;case 5:if(Oo(e,n),pl(n),r&512&&t!==null&&Eh(t,t.return),n.flags&32){var o=n.stateNode;try{Pm(o,"")}catch(T){Di(n,n.return,T)}}if(r&4&&(o=n.stateNode,o!=null)){var u=n.memoizedProps,h=t!==null?t.memoizedProps:u,f=n.type,d=n.updateQueue;if(n.updateQueue=null,d!==null)try{f==="input"&&u.type==="radio"&&u.name!=null&&X4(o,u),dR(f,h);var m=dR(f,u);for(h=0;h<d.length;h+=2){var g=d[h],v=d[h+1];g==="style"?e3(o,v):g==="dangerouslySetInnerHTML"?J4(o,v):g==="children"?Pm(o,v):oD(o,g,v,m)}switch(f){case"input":oR(o,u);break;case"textarea":q4(o,u);break;case"select":var _=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!u.multiple;var S=u.value;S!=null?Dh(o,!!u.multiple,S,!1):_!==!!u.multiple&&(u.defaultValue!=null?Dh(o,!!u.multiple,u.defaultValue,!0):Dh(o,!!u.multiple,u.multiple?[]:"",!1))}o[Bm]=u}catch(T){Di(n,n.return,T)}}break;case 6:if(Oo(e,n),pl(n),r&4){if(n.stateNode===null)throw Error(fn(162));o=n.stateNode,u=n.memoizedProps;try{o.nodeValue=u}catch(T){Di(n,n.return,T)}}break;case 3:if(Oo(e,n),pl(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Om(e.containerInfo)}catch(T){Di(n,n.return,T)}break;case 4:Oo(e,n),pl(n);break;case 13:Oo(e,n),pl(n),o=n.child,o.flags&8192&&(u=o.memoizedState!==null,o.stateNode.isHidden=u,!u||o.alternate!==null&&o.alternate.memoizedState!==null||(jD=Fi())),r&4&&uU(n);break;case 22:if(g=t!==null&&t.memoizedState!==null,n.mode&1?(Ss=(m=Ss)||g,Oo(e,n),Ss=m):Oo(e,n),pl(n),r&8192){if(m=n.memoizedState!==null,(n.stateNode.isHidden=m)&&!g&&n.mode&1)for(bn=n,g=n.child;g!==null;){for(v=bn=g;bn!==null;){switch(_=bn,S=_.child,_.tag){case 0:case 11:case 14:case 15:dm(4,_,_.return);break;case 1:Eh(_,_.return);var E=_.stateNode;if(typeof E.componentWillUnmount=="function"){r=_,t=_.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(T){Di(r,t,T)}}break;case 5:Eh(_,_.return);break;case 22:if(_.memoizedState!==null){fU(v);continue}}S!==null?(S.return=_,bn=S):fU(v)}g=g.sibling}e:for(g=null,v=n;;){if(v.tag===5){if(g===null){g=v;try{o=v.stateNode,m?(u=o.style,typeof u.setProperty=="function"?u.setProperty("display","none","important"):u.display="none"):(f=v.stateNode,d=v.memoizedProps.style,h=d!=null&&d.hasOwnProperty("display")?d.display:null,f.style.display=Z4("display",h))}catch(T){Di(n,n.return,T)}}}else if(v.tag===6){if(g===null)try{v.stateNode.nodeValue=m?"":v.memoizedProps}catch(T){Di(n,n.return,T)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===n)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===n)break e;for(;v.sibling===null;){if(v.return===null||v.return===n)break e;g===v&&(g=null),v=v.return}g===v&&(g=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:Oo(e,n),pl(n),r&4&&uU(n);break;case 21:break;default:Oo(e,n),pl(n)}}function pl(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Ij(t)){var r=t;break e}t=t.return}throw Error(fn(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(Pm(o,""),r.flags&=-33);var u=lU(n);GR(n,u,o);break;case 3:case 4:var h=r.stateNode.containerInfo,f=lU(n);KR(n,f,h);break;default:throw Error(fn(161))}}catch(d){Di(n,n.return,d)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function vq(n,e,t){bn=n,Dj(n)}function Dj(n,e,t){for(var r=(n.mode&1)!==0;bn!==null;){var o=bn,u=o.child;if(o.tag===22&&r){var h=o.memoizedState!==null||Ky;if(!h){var f=o.alternate,d=f!==null&&f.memoizedState!==null||Ss;f=Ky;var m=Ss;if(Ky=h,(Ss=d)&&!m)for(bn=o;bn!==null;)h=bn,d=h.child,h.tag===22&&h.memoizedState!==null?dU(o):d!==null?(d.return=h,bn=d):dU(o);for(;u!==null;)bn=u,Dj(u),u=u.sibling;bn=o,Ky=f,Ss=m}cU(n)}else o.subtreeFlags&8772&&u!==null?(u.return=o,bn=u):cU(n)}}function cU(n){for(;bn!==null;){var e=bn;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ss||vT(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ss)if(t===null)r.componentDidMount();else{var o=e.elementType===e.type?t.memoizedProps:Uo(e.type,t.memoizedProps);r.componentDidUpdate(o,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var u=e.updateQueue;u!==null&&zk(e,u,r);break;case 3:var h=e.updateQueue;if(h!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}zk(e,h,t)}break;case 5:var f=e.stateNode;if(t===null&&e.flags&4){t=f;var d=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&t.focus();break;case"img":d.src&&(t.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var m=e.alternate;if(m!==null){var g=m.memoizedState;if(g!==null){var v=g.dehydrated;v!==null&&Om(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(fn(163))}Ss||e.flags&512&&jR(e)}catch(_){Di(e,e.return,_)}}if(e===n){bn=null;break}if(t=e.sibling,t!==null){t.return=e.return,bn=t;break}bn=e.return}}function fU(n){for(;bn!==null;){var e=bn;if(e===n){bn=null;break}var t=e.sibling;if(t!==null){t.return=e.return,bn=t;break}bn=e.return}}function dU(n){for(;bn!==null;){var e=bn;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{vT(4,e)}catch(d){Di(e,t,d)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var o=e.return;try{r.componentDidMount()}catch(d){Di(e,o,d)}}var u=e.return;try{jR(e)}catch(d){Di(e,u,d)}break;case 5:var h=e.return;try{jR(e)}catch(d){Di(e,h,d)}}}catch(d){Di(e,e.return,d)}if(e===n){bn=null;break}var f=e.sibling;if(f!==null){f.return=e.return,bn=f;break}bn=e.return}}var yq=Math.ceil,a_=ju.ReactCurrentDispatcher,UD=ju.ReactCurrentOwner,uo=ju.ReactCurrentBatchConfig,Cr=0,ss=null,Gi=null,gs=0,Ua=0,_h=Kc(0),Yi=0,Vm=null,qf=0,yT=0,BD=0,hm=null,oa=null,jD=0,Yh=1/0,yu=null,o_=!1,WR=null,Pc=null,Gy=!1,xc=null,l_=0,pm=0,HR=null,DE=-1,PE=0;function Vs(){return Cr&6?Fi():DE!==-1?DE:DE=Fi()}function Lc(n){return n.mode&1?Cr&2&&gs!==0?gs&-gs:tq.transition!==null?(PE===0&&(PE=d3()),PE):(n=kr,n!==0||(n=window.event,n=n===void 0?16:E3(n.type)),n):1}function zo(n,e,t,r){if(50<pm)throw pm=0,HR=null,Error(fn(185));p0(n,t,r),(!(Cr&2)||n!==ss)&&(n===ss&&(!(Cr&2)&&(yT|=t),Yi===4&&Sc(n,gs)),pa(n,r),t===1&&Cr===0&&!(e.mode&1)&&(Yh=Fi()+500,pT&&Gc()))}function pa(n,e){var t=n.callbackNode;tX(n,e);var r=VE(n,n===ss?gs:0);if(r===0)t!==null&&Tk(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&Tk(t),e===1)n.tag===0?eq(hU.bind(null,n)):U3(hU.bind(null,n)),qX(function(){!(Cr&6)&&Gc()}),t=null;else{switch(h3(r)){case 1:t=dD;break;case 4:t=c3;break;case 16:t=HE;break;case 536870912:t=f3;break;default:t=HE}t=kj(t,Pj.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function Pj(n,e){if(DE=-1,PE=0,Cr&6)throw Error(fn(327));var t=n.callbackNode;if(Oh()&&n.callbackNode!==t)return null;var r=VE(n,n===ss?gs:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=u_(n,r);else{e=r;var o=Cr;Cr|=2;var u=Mj();(ss!==n||gs!==e)&&(yu=null,Yh=Fi()+500,Uf(n,e));do try{Tq();break}catch(f){Lj(n,f)}while(1);CD(),a_.current=u,Cr=o,Gi!==null?e=0:(ss=null,gs=0,e=Yi)}if(e!==0){if(e===2&&(o=vR(n),o!==0&&(r=o,e=VR(n,o))),e===1)throw t=Vm,Uf(n,0),Sc(n,r),pa(n,Fi()),t;if(e===6)Sc(n,r);else{if(o=n.current.alternate,!(r&30)&&!Eq(o)&&(e=u_(n,r),e===2&&(u=vR(n),u!==0&&(r=u,e=VR(n,u))),e===1))throw t=Vm,Uf(n,0),Sc(n,r),pa(n,Fi()),t;switch(n.finishedWork=o,n.finishedLanes=r,e){case 0:case 1:throw Error(fn(345));case 2:If(n,oa,yu);break;case 3:if(Sc(n,r),(r&130023424)===r&&(e=jD+500-Fi(),10<e)){if(VE(n,0)!==0)break;if(o=n.suspendedLanes,(o&r)!==r){Vs(),n.pingedLanes|=n.suspendedLanes&o;break}n.timeoutHandle=CR(If.bind(null,n,oa,yu),e);break}If(n,oa,yu);break;case 4:if(Sc(n,r),(r&4194240)===r)break;for(e=n.eventTimes,o=-1;0<r;){var h=31-$o(r);u=1<<h,h=e[h],h>o&&(o=h),r&=~u}if(r=o,r=Fi()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*yq(r/1960))-r,10<r){n.timeoutHandle=CR(If.bind(null,n,oa,yu),r);break}If(n,oa,yu);break;case 5:If(n,oa,yu);break;default:throw Error(fn(329))}}}return pa(n,Fi()),n.callbackNode===t?Pj.bind(null,n):null}function VR(n,e){var t=hm;return n.current.memoizedState.isDehydrated&&(Uf(n,e).flags|=256),n=u_(n,e),n!==2&&(e=oa,oa=t,e!==null&&$R(e)),n}function $R(n){oa===null?oa=n:oa.push.apply(oa,n)}function Eq(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var o=t[r],u=o.getSnapshot;o=o.value;try{if(!Xo(u(),o))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Sc(n,e){for(e&=~BD,e&=~yT,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-$o(e),r=1<<t;n[t]=-1,e&=~r}}function hU(n){if(Cr&6)throw Error(fn(327));Oh();var e=VE(n,0);if(!(e&1))return pa(n,Fi()),null;var t=u_(n,e);if(n.tag!==0&&t===2){var r=vR(n);r!==0&&(e=r,t=VR(n,r))}if(t===1)throw t=Vm,Uf(n,0),Sc(n,e),pa(n,Fi()),t;if(t===6)throw Error(fn(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,If(n,oa,yu),pa(n,Fi()),null}function KD(n,e){var t=Cr;Cr|=1;try{return n(e)}finally{Cr=t,Cr===0&&(Yh=Fi()+500,pT&&Gc())}}function Qf(n){xc!==null&&xc.tag===0&&!(Cr&6)&&Oh();var e=Cr;Cr|=1;var t=uo.transition,r=kr;try{if(uo.transition=null,kr=1,n)return n()}finally{kr=r,uo.transition=t,Cr=e,!(Cr&6)&&Gc()}}function GD(){Ua=_h.current,ai(_h)}function Uf(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,XX(t)),Gi!==null)for(t=Gi.return;t!==null;){var r=t;switch(SD(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&qE();break;case 3:$h(),ai(da),ai(Is),LD();break;case 5:PD(r);break;case 4:$h();break;case 13:ai(Ei);break;case 19:ai(Ei);break;case 10:ID(r.type._context);break;case 22:case 23:GD()}t=t.return}if(ss=n,Gi=n=Mc(n.current,null),gs=Ua=e,Yi=0,Vm=null,BD=yT=qf=0,oa=hm=null,Nf!==null){for(e=0;e<Nf.length;e++)if(t=Nf[e],r=t.interleaved,r!==null){t.interleaved=null;var o=r.next,u=t.pending;if(u!==null){var h=u.next;u.next=o,r.next=h}t.pending=r}Nf=null}return n}function Lj(n,e){do{var t=Gi;try{if(CD(),IE.current=s_,i_){for(var r=xi.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}i_=!1}if(Xf=0,ns=zi=xi=null,fm=!1,Gm=0,UD.current=null,t===null||t.return===null){Yi=1,Vm=e,Gi=null;break}e:{var u=n,h=t.return,f=t,d=e;if(e=gs,f.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var m=d,g=f,v=g.tag;if(!(g.mode&1)&&(v===0||v===11||v===15)){var _=g.alternate;_?(g.updateQueue=_.updateQueue,g.memoizedState=_.memoizedState,g.lanes=_.lanes):(g.updateQueue=null,g.memoizedState=null)}var S=eU(h);if(S!==null){S.flags&=-257,tU(S,h,f,u,e),S.mode&1&&Zk(u,m,e),e=S,d=m;var E=e.updateQueue;if(E===null){var T=new Set;T.add(d),e.updateQueue=T}else E.add(d);break e}else{if(!(e&1)){Zk(u,m,e),WD();break e}d=Error(fn(426))}}else if(di&&f.mode&1){var C=eU(h);if(C!==null){!(C.flags&65536)&&(C.flags|=256),tU(C,h,f,u,e),AD(zh(d,f));break e}}u=d=zh(d,f),Yi!==4&&(Yi=2),hm===null?hm=[u]:hm.push(u),u=h;do{switch(u.tag){case 3:u.flags|=65536,e&=-e,u.lanes|=e;var R=pj(u,d,e);$k(u,R);break e;case 1:f=d;var b=u.type,F=u.stateNode;if(!(u.flags&128)&&(typeof b.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(Pc===null||!Pc.has(F)))){u.flags|=65536,e&=-e,u.lanes|=e;var O=gj(u,f,e);$k(u,O);break e}}u=u.return}while(u!==null)}Oj(t)}catch(L){e=L,Gi===t&&t!==null&&(Gi=t=t.return);continue}break}while(1)}function Mj(){var n=a_.current;return a_.current=s_,n===null?s_:n}function WD(){(Yi===0||Yi===3||Yi===2)&&(Yi=4),ss===null||!(qf&268435455)&&!(yT&268435455)||Sc(ss,gs)}function u_(n,e){var t=Cr;Cr|=2;var r=Mj();(ss!==n||gs!==e)&&(yu=null,Uf(n,e));do try{_q();break}catch(o){Lj(n,o)}while(1);if(CD(),Cr=t,a_.current=r,Gi!==null)throw Error(fn(261));return ss=null,gs=0,Yi}function _q(){for(;Gi!==null;)wj(Gi)}function Tq(){for(;Gi!==null&&!$Y();)wj(Gi)}function wj(n){var e=Fj(n.alternate,n,Ua);n.memoizedProps=n.pendingProps,e===null?Oj(n):Gi=e,UD.current=null}function Oj(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=pq(t,e),t!==null){t.flags&=32767,Gi=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Yi=6,Gi=null;return}}else if(t=hq(t,e,Ua),t!==null){Gi=t;return}if(e=e.sibling,e!==null){Gi=e;return}Gi=e=n}while(e!==null);Yi===0&&(Yi=5)}function If(n,e,t){var r=kr,o=uo.transition;try{uo.transition=null,kr=1,Sq(n,e,t,r)}finally{uo.transition=o,kr=r}return null}function Sq(n,e,t,r){do Oh();while(xc!==null);if(Cr&6)throw Error(fn(327));t=n.finishedWork;var o=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(fn(177));n.callbackNode=null,n.callbackPriority=0;var u=t.lanes|t.childLanes;if(nX(n,u),n===ss&&(Gi=ss=null,gs=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Gy||(Gy=!0,kj(HE,function(){return Oh(),null})),u=(t.flags&15990)!==0,t.subtreeFlags&15990||u){u=uo.transition,uo.transition=null;var h=kr;kr=1;var f=Cr;Cr|=4,UD.current=null,mq(n,t),bj(t,n),GX(AR),$E=!!SR,AR=SR=null,n.current=t,vq(t),zY(),Cr=f,kr=h,uo.transition=u}else n.current=t;if(Gy&&(Gy=!1,xc=n,l_=o),u=n.pendingLanes,u===0&&(Pc=null),qY(t.stateNode),pa(n,Fi()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)o=e[t],r(o.value,{componentStack:o.stack,digest:o.digest});if(o_)throw o_=!1,n=WR,WR=null,n;return l_&1&&n.tag!==0&&Oh(),u=n.pendingLanes,u&1?n===HR?pm++:(pm=0,HR=n):pm=0,Gc(),null}function Oh(){if(xc!==null){var n=h3(l_),e=uo.transition,t=kr;try{if(uo.transition=null,kr=16>n?16:n,xc===null)var r=!1;else{if(n=xc,xc=null,l_=0,Cr&6)throw Error(fn(331));var o=Cr;for(Cr|=4,bn=n.current;bn!==null;){var u=bn,h=u.child;if(bn.flags&16){var f=u.deletions;if(f!==null){for(var d=0;d<f.length;d++){var m=f[d];for(bn=m;bn!==null;){var g=bn;switch(g.tag){case 0:case 11:case 15:dm(8,g,u)}var v=g.child;if(v!==null)v.return=g,bn=v;else for(;bn!==null;){g=bn;var _=g.sibling,S=g.return;if(Cj(g),g===m){bn=null;break}if(_!==null){_.return=S,bn=_;break}bn=S}}}var E=u.alternate;if(E!==null){var T=E.child;if(T!==null){E.child=null;do{var C=T.sibling;T.sibling=null,T=C}while(T!==null)}}bn=u}}if(u.subtreeFlags&2064&&h!==null)h.return=u,bn=h;else e:for(;bn!==null;){if(u=bn,u.flags&2048)switch(u.tag){case 0:case 11:case 15:dm(9,u,u.return)}var R=u.sibling;if(R!==null){R.return=u.return,bn=R;break e}bn=u.return}}var b=n.current;for(bn=b;bn!==null;){h=bn;var F=h.child;if(h.subtreeFlags&2064&&F!==null)F.return=h,bn=F;else e:for(h=b;bn!==null;){if(f=bn,f.flags&2048)try{switch(f.tag){case 0:case 11:case 15:vT(9,f)}}catch(L){Di(f,f.return,L)}if(f===h){bn=null;break e}var O=f.sibling;if(O!==null){O.return=f.return,bn=O;break e}bn=f.return}}if(Cr=o,Gc(),Il&&typeof Il.onPostCommitFiberRoot=="function")try{Il.onPostCommitFiberRoot(uT,n)}catch{}r=!0}return r}finally{kr=t,uo.transition=e}}return!1}function pU(n,e,t){e=zh(t,e),e=pj(n,e,1),n=Dc(n,e,1),e=Vs(),n!==null&&(p0(n,1,e),pa(n,e))}function Di(n,e,t){if(n.tag===3)pU(n,n,t);else for(;e!==null;){if(e.tag===3){pU(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Pc===null||!Pc.has(r))){n=zh(t,n),n=gj(e,n,1),e=Dc(e,n,1),n=Vs(),e!==null&&(p0(e,1,n),pa(e,n));break}}e=e.return}}function Aq(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Vs(),n.pingedLanes|=n.suspendedLanes&t,ss===n&&(gs&t)===t&&(Yi===4||Yi===3&&(gs&130023424)===gs&&500>Fi()-jD?Uf(n,0):BD|=t),pa(n,e)}function Nj(n,e){e===0&&(n.mode&1?(e=My,My<<=1,!(My&130023424)&&(My=4194304)):e=1);var t=Vs();n=Mu(n,e),n!==null&&(p0(n,e,t),pa(n,t))}function xq(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),Nj(n,t)}function Cq(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,o=n.memoizedState;o!==null&&(t=o.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(fn(314))}r!==null&&r.delete(e),Nj(n,t)}var Fj;Fj=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||da.current)fa=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return fa=!1,dq(n,e,t);fa=!!(n.flags&131072)}else fa=!1,di&&e.flags&1048576&&B3(e,ZE,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;bE(n,e),n=e.pendingProps;var o=Wh(e,Is.current);wh(e,t),o=wD(null,e,r,n,o,t);var u=OD();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ha(r)?(u=!0,QE(e)):u=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,bD(e),o.updater=gT,e.stateNode=o,o._reactInternals=e,MR(e,r,n,t),e=NR(null,e,r,!0,u,t)):(e.tag=0,di&&u&&TD(e),Fs(null,e,o,t),e=e.child),e;case 16:r=e.elementType;e:{switch(bE(n,e),n=e.pendingProps,o=r._init,r=o(r._payload),e.type=r,o=e.tag=Rq(r),n=Uo(r,n),o){case 0:e=OR(null,e,r,n,t);break e;case 1:e=iU(null,e,r,n,t);break e;case 11:e=nU(null,e,r,n,t);break e;case 14:e=rU(null,e,r,Uo(r.type,n),t);break e}throw Error(fn(306,r,""))}return e;case 0:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:Uo(r,o),OR(n,e,r,o,t);case 1:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:Uo(r,o),iU(n,e,r,o,t);case 3:e:{if(Ej(e),n===null)throw Error(fn(387));r=e.pendingProps,u=e.memoizedState,o=u.element,W3(n,e),n_(e,r,null,t);var h=e.memoizedState;if(r=h.element,u.isDehydrated)if(u={element:r,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},e.updateQueue.baseState=u,e.memoizedState=u,e.flags&256){o=zh(Error(fn(423)),e),e=sU(n,e,r,t,o);break e}else if(r!==o){o=zh(Error(fn(424)),e),e=sU(n,e,r,t,o);break e}else for(ja=bc(e.stateNode.containerInfo.firstChild),Ka=e,di=!0,jo=null,t=z3(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Hh(),r===o){e=wu(n,e,t);break e}Fs(n,e,r,t)}e=e.child}return e;case 5:return Y3(e),n===null&&DR(e),r=e.type,o=e.pendingProps,u=n!==null?n.memoizedProps:null,h=o.children,xR(r,o)?h=null:u!==null&&xR(r,u)&&(e.flags|=32),yj(n,e),Fs(n,e,h,t),e.child;case 6:return n===null&&DR(e),null;case 13:return _j(n,e,t);case 4:return DD(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Vh(e,null,r,t):Fs(n,e,r,t),e.child;case 11:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:Uo(r,o),nU(n,e,r,o,t);case 7:return Fs(n,e,e.pendingProps,t),e.child;case 8:return Fs(n,e,e.pendingProps.children,t),e.child;case 12:return Fs(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,o=e.pendingProps,u=e.memoizedProps,h=o.value,qr(e_,r._currentValue),r._currentValue=h,u!==null)if(Xo(u.value,h)){if(u.children===o.children&&!da.current){e=wu(n,e,t);break e}}else for(u=e.child,u!==null&&(u.return=e);u!==null;){var f=u.dependencies;if(f!==null){h=u.child;for(var d=f.firstContext;d!==null;){if(d.context===r){if(u.tag===1){d=Ru(-1,t&-t),d.tag=2;var m=u.updateQueue;if(m!==null){m=m.shared;var g=m.pending;g===null?d.next=d:(d.next=g.next,g.next=d),m.pending=d}}u.lanes|=t,d=u.alternate,d!==null&&(d.lanes|=t),PR(u.return,t,e),f.lanes|=t;break}d=d.next}}else if(u.tag===10)h=u.type===e.type?null:u.child;else if(u.tag===18){if(h=u.return,h===null)throw Error(fn(341));h.lanes|=t,f=h.alternate,f!==null&&(f.lanes|=t),PR(h,t,e),h=u.sibling}else h=u.child;if(h!==null)h.return=u;else for(h=u;h!==null;){if(h===e){h=null;break}if(u=h.sibling,u!==null){u.return=h.return,h=u;break}h=h.return}u=h}Fs(n,e,o.children,t),e=e.child}return e;case 9:return o=e.type,r=e.pendingProps.children,wh(e,t),o=fo(o),r=r(o),e.flags|=1,Fs(n,e,r,t),e.child;case 14:return r=e.type,o=Uo(r,e.pendingProps),o=Uo(r.type,o),rU(n,e,r,o,t);case 15:return mj(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:Uo(r,o),bE(n,e),e.tag=1,ha(r)?(n=!0,QE(e)):n=!1,wh(e,t),V3(e,r,o),MR(e,r,o,t),NR(null,e,r,!0,n,t);case 19:return Tj(n,e,t);case 22:return vj(n,e,t)}throw Error(fn(156,e.tag))};function kj(n,e){return u3(n,e)}function Iq(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lo(n,e,t,r){return new Iq(n,e,t,r)}function HD(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Rq(n){if(typeof n=="function")return HD(n)?1:0;if(n!=null){if(n=n.$$typeof,n===uD)return 11;if(n===cD)return 14}return 2}function Mc(n,e){var t=n.alternate;return t===null?(t=lo(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function LE(n,e,t,r,o,u){var h=2;if(r=n,typeof n=="function")HD(n)&&(h=1);else if(typeof n=="string")h=5;else e:switch(n){case ch:return Bf(t.children,o,u,e);case lD:h=8,o|=8;break;case nR:return n=lo(12,t,e,o|2),n.elementType=nR,n.lanes=u,n;case rR:return n=lo(13,t,e,o),n.elementType=rR,n.lanes=u,n;case iR:return n=lo(19,t,e,o),n.elementType=iR,n.lanes=u,n;case $4:return ET(t,o,u,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case H4:h=10;break e;case V4:h=9;break e;case uD:h=11;break e;case cD:h=14;break e;case pc:h=16,r=null;break e}throw Error(fn(130,n==null?n:typeof n,""))}return e=lo(h,t,e,o),e.elementType=n,e.type=r,e.lanes=u,e}function Bf(n,e,t,r){return n=lo(7,n,r,e),n.lanes=t,n}function ET(n,e,t,r){return n=lo(22,n,r,e),n.elementType=$4,n.lanes=t,n.stateNode={isHidden:!1},n}function UC(n,e,t){return n=lo(6,n,null,e),n.lanes=t,n}function BC(n,e,t){return e=lo(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function bq(n,e,t,r,o){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=EC(0),this.expirationTimes=EC(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=EC(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function VD(n,e,t,r,o,u,h,f,d){return n=new bq(n,e,t,f,d),e===1?(e=1,u===!0&&(e|=8)):e=0,u=lo(3,null,null,e),n.current=u,u.stateNode=n,u.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},bD(u),n}function Dq(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:uh,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function Uj(n){if(!n)return Oc;n=n._reactInternals;e:{if(id(n)!==n||n.tag!==1)throw Error(fn(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ha(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(fn(171))}if(n.tag===1){var t=n.type;if(ha(t))return k3(n,t,e)}return e}function Bj(n,e,t,r,o,u,h,f,d){return n=VD(t,r,!0,n,o,u,h,f,d),n.context=Uj(null),t=n.current,r=Vs(),o=Lc(t),u=Ru(r,o),u.callback=e??null,Dc(t,u,o),n.current.lanes=o,p0(n,o,r),pa(n,r),n}function _T(n,e,t,r){var o=e.current,u=Vs(),h=Lc(o);return t=Uj(t),e.context===null?e.context=t:e.pendingContext=t,e=Ru(u,h),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Dc(o,e,h),n!==null&&(zo(n,o,h,u),CE(n,o,h)),h}function c_(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function gU(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function $D(n,e){gU(n,e),(n=n.alternate)&&gU(n,e)}function Pq(){return null}var jj=typeof reportError=="function"?reportError:function(n){console.error(n)};function zD(n){this._internalRoot=n}TT.prototype.render=zD.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(fn(409));_T(n,e,null,null)};TT.prototype.unmount=zD.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Qf(function(){_T(null,n,null,null)}),e[Lu]=null}};function TT(n){this._internalRoot=n}TT.prototype.unstable_scheduleHydration=function(n){if(n){var e=m3();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Tc.length&&e!==0&&e<Tc[t].priority;t++);Tc.splice(t,0,n),t===0&&y3(n)}};function YD(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function ST(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function mU(){}function Lq(n,e,t,r,o){if(o){if(typeof r=="function"){var u=r;r=function(){var m=c_(h);u.call(m)}}var h=Bj(e,r,n,0,null,!1,!1,"",mU);return n._reactRootContainer=h,n[Lu]=h.current,km(n.nodeType===8?n.parentNode:n),Qf(),h}for(;o=n.lastChild;)n.removeChild(o);if(typeof r=="function"){var f=r;r=function(){var m=c_(d);f.call(m)}}var d=VD(n,0,!1,null,null,!1,!1,"",mU);return n._reactRootContainer=d,n[Lu]=d.current,km(n.nodeType===8?n.parentNode:n),Qf(function(){_T(e,d,t,r)}),d}function AT(n,e,t,r,o){var u=t._reactRootContainer;if(u){var h=u;if(typeof o=="function"){var f=o;o=function(){var d=c_(h);f.call(d)}}_T(e,h,n,o)}else h=Lq(t,e,n,o,r);return c_(h)}p3=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Yg(e.pendingLanes);t!==0&&(hD(e,t|1),pa(e,Fi()),!(Cr&6)&&(Yh=Fi()+500,Gc()))}break;case 13:Qf(function(){var r=Mu(n,1);if(r!==null){var o=Vs();zo(r,n,1,o)}}),$D(n,1)}};pD=function(n){if(n.tag===13){var e=Mu(n,134217728);if(e!==null){var t=Vs();zo(e,n,134217728,t)}$D(n,134217728)}};g3=function(n){if(n.tag===13){var e=Lc(n),t=Mu(n,e);if(t!==null){var r=Vs();zo(t,n,e,r)}$D(n,e)}};m3=function(){return kr};v3=function(n,e){var t=kr;try{return kr=n,e()}finally{kr=t}};pR=function(n,e,t){switch(e){case"input":if(oR(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var o=hT(r);if(!o)throw Error(fn(90));Y4(r),oR(r,o)}}}break;case"textarea":q4(n,t);break;case"select":e=t.value,e!=null&&Dh(n,!!t.multiple,e,!1)}};r3=KD;i3=Qf;var Mq={usingClientEntryPoint:!1,Events:[m0,ph,hT,t3,n3,KD]},Pg={findFiberByHostInstance:Of,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},wq={bundleType:Pg.bundleType,version:Pg.version,rendererPackageName:Pg.rendererPackageName,rendererConfig:Pg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ju.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=o3(n),n===null?null:n.stateNode},findFiberByHostInstance:Pg.findFiberByHostInstance||Pq,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wy.isDisabled&&Wy.supportsFiber)try{uT=Wy.inject(wq),Il=Wy}catch{}}Va.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Mq;Va.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!YD(e))throw Error(fn(200));return Dq(n,e,null,t)};Va.createRoot=function(n,e){if(!YD(n))throw Error(fn(299));var t=!1,r="",o=jj;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=VD(n,1,!1,null,null,t,!1,r,o),n[Lu]=e.current,km(n.nodeType===8?n.parentNode:n),new zD(e)};Va.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(fn(188)):(n=Object.keys(n).join(","),Error(fn(268,n)));return n=o3(e),n=n===null?null:n.stateNode,n};Va.flushSync=function(n){return Qf(n)};Va.hydrate=function(n,e,t){if(!ST(e))throw Error(fn(200));return AT(null,n,e,!0,t)};Va.hydrateRoot=function(n,e,t){if(!YD(n))throw Error(fn(405));var r=t!=null&&t.hydratedSources||null,o=!1,u="",h=jj;if(t!=null&&(t.unstable_strictMode===!0&&(o=!0),t.identifierPrefix!==void 0&&(u=t.identifierPrefix),t.onRecoverableError!==void 0&&(h=t.onRecoverableError)),e=Bj(e,null,n,1,t??null,o,!1,u,h),n[Lu]=e.current,km(n),r)for(n=0;n<r.length;n++)t=r[n],o=t._getVersion,o=o(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,o]:e.mutableSourceEagerHydrationData.push(t,o);return new TT(e)};Va.render=function(n,e,t){if(!ST(e))throw Error(fn(200));return AT(null,n,e,!1,t)};Va.unmountComponentAtNode=function(n){if(!ST(n))throw Error(fn(40));return n._reactRootContainer?(Qf(function(){AT(null,null,n,!1,function(){n._reactRootContainer=null,n[Lu]=null})}),!0):!1};Va.unstable_batchedUpdates=KD;Va.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!ST(t))throw Error(fn(200));if(n==null||n._reactInternals===void 0)throw Error(fn(38));return AT(n,e,t,!1,r)};Va.version="18.2.0-next-9e3b772b8-20220608";(function(n){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}e(),n.exports=Va})(PY);const qg=Zb(jE);var vU=jE;ZI.createRoot=vU.createRoot,ZI.hydrateRoot=vU.hydrateRoot;var Oq=Ot;function Nq(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var Fo=Nq(Oq);function zR(){return zR=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},zR.apply(this,arguments)}function Fq(n,e){if(n==null)return{};var t={},r=Object.keys(n),o,u;for(u=0;u<r.length;u++)o=r[u],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}function kq(n,e){if(n==null)return{};var t=Fq(n,e),r,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);for(o=0;o<u.length;o++)r=u[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function yU(n,e){return Uq(n)||Bq(n,e)||jq(n,e)||Kq()}function Uq(n){if(Array.isArray(n))return n}function Bq(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r=[],o=!0,u=!1,h,f;try{for(t=t.call(n);!(o=(h=t.next()).done)&&(r.push(h.value),!(e&&r.length===e));o=!0);}catch(d){u=!0,f=d}finally{try{!o&&t.return!=null&&t.return()}finally{if(u)throw f}}return r}}function jq(n,e){if(n){if(typeof n=="string")return EU(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return EU(n,e)}}function EU(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Kq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Gq=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ya<"u"?ya:typeof self<"u"?self:{},YR={};/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/(function(n){(function(){var e=typeof window<"u"?window:Gq,t={};(function(o,u,h){var f;function d(i){var l=0;return function(){return l<i.length?{done:!1,value:i[l++]}:{done:!0}}}var m=typeof Object.defineProperties=="function"?Object.defineProperty:function(i,l,c){return i==Array.prototype||i==Object.prototype||(i[l]=c.value),i};function g(i){i=[typeof globalThis=="object"&&globalThis,i,typeof o=="object"&&o,typeof self=="object"&&self,typeof u=="object"&&u];for(var l=0;l<i.length;++l){var c=i[l];if(c&&c.Math==Math)return c}throw Error("Cannot find global object")}var v=g(this);function _(i,l){if(l)e:{for(var c=v,p=i.split("."),y=0;y<p.length-1;y++){var A=p[y];if(!(A in c))break e;c=c[A]}p=p[p.length-1],y=c[p],A=l(y),A!=y&&A!=null&&m(c,p,{configurable:!0,writable:!0,value:A})}}_("Symbol",function(i){function l(A){if(this instanceof l)throw new TypeError("Symbol is not a constructor");return new c(p+(A||"")+"_"+y++,A)}function c(A,P){this.g=A,m(this,"description",{configurable:!0,writable:!0,value:P})}if(i)return i;c.prototype.toString=function(){return this.g};var p="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",y=0;return l}),_("Symbol.iterator",function(i){if(i)return i;i=Symbol("Symbol.iterator");for(var l="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<l.length;c++){var p=v[l[c]];typeof p=="function"&&typeof p.prototype[i]!="function"&&m(p.prototype,i,{configurable:!0,writable:!0,value:function(){return S(d(this))}})}return i});function S(i){return i={next:i},i[Symbol.iterator]=function(){return this},i}function E(i){var l=typeof Symbol<"u"&&Symbol.iterator&&i[Symbol.iterator];return l?l.call(i):{next:d(i)}}function T(i){if(!(i instanceof Array)){i=E(i);for(var l,c=[];!(l=i.next()).done;)c.push(l.value);i=c}return i}var C=typeof Object.create=="function"?Object.create:function(i){function l(){}return l.prototype=i,new l},R;if(typeof Object.setPrototypeOf=="function")R=Object.setPrototypeOf;else{var b;e:{var F={a:!0},O={};try{O.__proto__=F,b=O.a;break e}catch{}b=!1}R=b?function(i,l){if(i.__proto__=l,i.__proto__!==l)throw new TypeError(i+" is not extensible");return i}:null}var L=R;function D(i,l){if(i.prototype=C(l.prototype),i.prototype.constructor=i,L)L(i,l);else for(var c in l)if(c!="prototype")if(Object.defineProperties){var p=Object.getOwnPropertyDescriptor(l,c);p&&Object.defineProperty(i,c,p)}else i[c]=l[c];i.Wi=l.prototype}function x(){this.B=!1,this.l=null,this.h=void 0,this.g=1,this.j=this.s=0,this.G=this.i=null}function B(i){if(i.B)throw new TypeError("Generator is already running");i.B=!0}x.prototype.C=function(i){this.h=i};function M(i,l){i.i={ef:l,qf:!0},i.g=i.s||i.j}x.prototype.return=function(i){this.i={return:i},this.g=this.j};function I(i,l,c){return i.g=c,{value:l}}x.prototype.D=function(i){this.g=i};function U(i){i.g=0}function w(i,l,c){i.s=l,c!=null&&(i.j=c)}function k(i){i.s=0,i.j=2}function K(i,l,c){i.g=l,i.s=c||0}function W(i,l){i.s=l||0;var c=i.i.ef;return i.i=null,c}function Y(i){i.G=[i.i],i.s=0,i.j=0}function J(i,l){var c=i.G.splice(0)[0];(c=i.i=i.i||c)?c.qf?i.g=i.s||i.j:c.D!=null&&i.j<c.D?(i.g=c.D,i.i=null):i.g=i.j:i.g=l}function ee(i){this.g=new x,this.h=i}function ue(i,l){B(i.g);var c=i.g.l;return c?ie(i,"return"in c?c.return:function(p){return{value:p,done:!0}},l,i.g.return):(i.g.return(l),Q(i))}function ie(i,l,c,p){try{var y=l.call(i.g.l,c);if(!(y instanceof Object))throw new TypeError("Iterator result "+y+" is not an object");if(!y.done)return i.g.B=!1,y;var A=y.value}catch(P){return i.g.l=null,M(i.g,P),Q(i)}return i.g.l=null,p.call(i.g,A),Q(i)}function Q(i){for(;i.g.g;)try{var l=i.h(i.g);if(l)return i.g.B=!1,{value:l.value,done:!1}}catch(c){i.g.h=void 0,M(i.g,c)}if(i.g.B=!1,i.g.i){if(l=i.g.i,i.g.i=null,l.qf)throw l.ef;return{value:l.return,done:!0}}return{value:void 0,done:!0}}function se(i){this.next=function(l){return B(i.g),i.g.l?l=ie(i,i.g.l.next,l,i.g.C):(i.g.C(l),l=Q(i)),l},this.throw=function(l){return B(i.g),i.g.l?l=ie(i,i.g.l.throw,l,i.g.C):(M(i.g,l),l=Q(i)),l},this.return=function(l){return ue(i,l)},this[Symbol.iterator]=function(){return this}}function ve(i,l){var c=new se(new ee(l));return L&&i.prototype&&L(c,i.prototype),c}function _e(i){function l(p){return i.next(p)}function c(p){return i.throw(p)}return new Promise(function(p,y){function A(P){P.done?p(P.value):Promise.resolve(P.value).then(l,c).then(A,y)}A(i.next())})}function Z(i){return _e(new se(new ee(i)))}_("Promise",function(i){function l(P){this.h=0,this.i=void 0,this.g=[],this.B=!1;var N=this.j();try{P(N.resolve,N.reject)}catch(G){N.reject(G)}}function c(){this.g=null}function p(P){return P instanceof l?P:new l(function(N){N(P)})}if(i)return i;c.prototype.h=function(P){if(this.g==null){this.g=[];var N=this;this.i(function(){N.l()})}this.g.push(P)};var y=v.setTimeout;c.prototype.i=function(P){y(P,0)},c.prototype.l=function(){for(;this.g&&this.g.length;){var P=this.g;this.g=[];for(var N=0;N<P.length;++N){var G=P[N];P[N]=null;try{G()}catch(q){this.j(q)}}}this.g=null},c.prototype.j=function(P){this.i(function(){throw P})},l.prototype.j=function(){function P(q){return function(ae){G||(G=!0,q.call(N,ae))}}var N=this,G=!1;return{resolve:P(this.L),reject:P(this.l)}},l.prototype.L=function(P){if(P===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(P instanceof l)this.P(P);else{e:switch(typeof P){case"object":var N=P!=null;break e;case"function":N=!0;break e;default:N=!1}N?this.J(P):this.s(P)}},l.prototype.J=function(P){var N=void 0;try{N=P.then}catch(G){this.l(G);return}typeof N=="function"?this.S(N,P):this.s(P)},l.prototype.l=function(P){this.C(2,P)},l.prototype.s=function(P){this.C(1,P)},l.prototype.C=function(P,N){if(this.h!=0)throw Error("Cannot settle("+P+", "+N+"): Promise already settled in state"+this.h);this.h=P,this.i=N,this.h===2&&this.M(),this.G()},l.prototype.M=function(){var P=this;y(function(){if(P.I()){var N=v.console;typeof N<"u"&&N.error(P.i)}},1)},l.prototype.I=function(){if(this.B)return!1;var P=v.CustomEvent,N=v.Event,G=v.dispatchEvent;return typeof G>"u"?!0:(typeof P=="function"?P=new P("unhandledrejection",{cancelable:!0}):typeof N=="function"?P=new N("unhandledrejection",{cancelable:!0}):(P=v.document.createEvent("CustomEvent"),P.initCustomEvent("unhandledrejection",!1,!0,P)),P.promise=this,P.reason=this.i,G(P))},l.prototype.G=function(){if(this.g!=null){for(var P=0;P<this.g.length;++P)A.h(this.g[P]);this.g=null}};var A=new c;return l.prototype.P=function(P){var N=this.j();P.ld(N.resolve,N.reject)},l.prototype.S=function(P,N){var G=this.j();try{P.call(N,G.resolve,G.reject)}catch(q){G.reject(q)}},l.prototype.then=function(P,N){function G(Ie,Ne){return typeof Ie=="function"?function(Ve){try{q(Ie(Ve))}catch(qe){ae(qe)}}:Ne}var q,ae,Te=new l(function(Ie,Ne){q=Ie,ae=Ne});return this.ld(G(P,q),G(N,ae)),Te},l.prototype.catch=function(P){return this.then(void 0,P)},l.prototype.ld=function(P,N){function G(){switch(q.h){case 1:P(q.i);break;case 2:N(q.i);break;default:throw Error("Unexpected state: "+q.h)}}var q=this;this.g==null?A.h(G):this.g.push(G),this.B=!0},l.resolve=p,l.reject=function(P){return new l(function(N,G){G(P)})},l.race=function(P){return new l(function(N,G){for(var q=E(P),ae=q.next();!ae.done;ae=q.next())p(ae.value).ld(N,G)})},l.all=function(P){var N=E(P),G=N.next();return G.done?p([]):new l(function(q,ae){function Te(Ve){return function(qe){Ie[Ve]=qe,Ne--,Ne==0&&q(Ie)}}var Ie=[],Ne=0;do Ie.push(void 0),Ne++,p(G.value).ld(Te(Ie.length-1),ae),G=N.next();while(!G.done)})},l});function Ee(i,l){return Object.prototype.hasOwnProperty.call(i,l)}_("WeakMap",function(i){function l(G){if(this.g=(N+=Math.random()+1).toString(),G){G=E(G);for(var q;!(q=G.next()).done;)q=q.value,this.set(q[0],q[1])}}function c(){}function p(G){var q=typeof G;return q==="object"&&G!==null||q==="function"}function y(G){if(!Ee(G,P)){var q=new c;m(G,P,{value:q})}}function A(G){var q=Object[G];q&&(Object[G]=function(ae){return ae instanceof c?ae:(Object.isExtensible(ae)&&y(ae),q(ae))})}if(function(){if(!i||!Object.seal)return!1;try{var G=Object.seal({}),q=Object.seal({}),ae=new i([[G,2],[q,3]]);return ae.get(G)!=2||ae.get(q)!=3?!1:(ae.delete(G),ae.set(q,4),!ae.has(G)&&ae.get(q)==4)}catch{return!1}}())return i;var P="$jscomp_hidden_"+Math.random();A("freeze"),A("preventExtensions"),A("seal");var N=0;return l.prototype.set=function(G,q){if(!p(G))throw Error("Invalid WeakMap key");if(y(G),!Ee(G,P))throw Error("WeakMap key fail: "+G);return G[P][this.g]=q,this},l.prototype.get=function(G){return p(G)&&Ee(G,P)?G[P][this.g]:void 0},l.prototype.has=function(G){return p(G)&&Ee(G,P)&&Ee(G[P],this.g)},l.prototype.delete=function(G){return p(G)&&Ee(G,P)&&Ee(G[P],this.g)?delete G[P][this.g]:!1},l}),_("Map",function(i){function l(){var N={};return N.wb=N.next=N.head=N}function c(N,G){var q=N.g;return S(function(){if(q){for(;q.head!=N.g;)q=q.wb;for(;q.next!=q.head;)return q=q.next,{done:!1,value:G(q)};q=null}return{done:!0,value:void 0}})}function p(N,G){var q=G&&typeof G;q=="object"||q=="function"?A.has(G)?q=A.get(G):(q=""+ ++P,A.set(G,q)):q="p_"+G;var ae=N.h[q];if(ae&&Ee(N.h,q))for(var Te=0;Te<ae.length;Te++){var Ie=ae[Te];if(G!==G&&Ie.key!==Ie.key||G===Ie.key)return{id:q,list:ae,index:Te,Ea:Ie}}return{id:q,list:ae,index:-1,Ea:void 0}}function y(N){if(this.h={},this.g=l(),this.size=0,N){N=E(N);for(var G;!(G=N.next()).done;)G=G.value,this.set(G[0],G[1])}}if(function(){if(!i||typeof i!="function"||!i.prototype.entries||typeof Object.seal!="function")return!1;try{var N=Object.seal({x:4}),G=new i(E([[N,"s"]]));if(G.get(N)!="s"||G.size!=1||G.get({x:4})||G.set({x:4},"t")!=G||G.size!=2)return!1;var q=G.entries(),ae=q.next();return ae.done||ae.value[0]!=N||ae.value[1]!="s"?!1:(ae=q.next(),!(ae.done||ae.value[0].x!=4||ae.value[1]!="t"||!q.next().done))}catch{return!1}}())return i;var A=new WeakMap;y.prototype.set=function(N,G){N=N===0?0:N;var q=p(this,N);return q.list||(q.list=this.h[q.id]=[]),q.Ea?q.Ea.value=G:(q.Ea={next:this.g,wb:this.g.wb,head:this.g,key:N,value:G},q.list.push(q.Ea),this.g.wb.next=q.Ea,this.g.wb=q.Ea,this.size++),this},y.prototype.delete=function(N){return N=p(this,N),N.Ea&&N.list?(N.list.splice(N.index,1),N.list.length||delete this.h[N.id],N.Ea.wb.next=N.Ea.next,N.Ea.next.wb=N.Ea.wb,N.Ea.head=null,this.size--,!0):!1},y.prototype.clear=function(){this.h={},this.g=this.g.wb=l(),this.size=0},y.prototype.has=function(N){return!!p(this,N).Ea},y.prototype.get=function(N){return(N=p(this,N).Ea)&&N.value},y.prototype.entries=function(){return c(this,function(N){return[N.key,N.value]})},y.prototype.keys=function(){return c(this,function(N){return N.key})},y.prototype.values=function(){return c(this,function(N){return N.value})},y.prototype.forEach=function(N,G){for(var q=this.entries(),ae;!(ae=q.next()).done;)ae=ae.value,N.call(G,ae[1],ae[0],this)},y.prototype[Symbol.iterator]=y.prototype.entries;var P=0;return y});function Se(i,l){i instanceof String&&(i+="");var c=0,p=!1,y={next:function(){if(!p&&c<i.length){var A=c++;return{value:l(A,i[A]),done:!1}}return p=!0,{done:!0,value:void 0}}};return y[Symbol.iterator]=function(){return y},y}_("Array.prototype.keys",function(i){return i||function(){return Se(this,function(l){return l})}}),_("Set",function(i){function l(c){if(this.g=new Map,c){c=E(c);for(var p;!(p=c.next()).done;)this.add(p.value)}this.size=this.g.size}return function(){if(!i||typeof i!="function"||!i.prototype.entries||typeof Object.seal!="function")return!1;try{var c=Object.seal({x:4}),p=new i(E([c]));if(!p.has(c)||p.size!=1||p.add(c)!=p||p.size!=1||p.add({x:4})!=p||p.size!=2)return!1;var y=p.entries(),A=y.next();return A.done||A.value[0]!=c||A.value[1]!=c?!1:(A=y.next(),A.done||A.value[0]==c||A.value[0].x!=4||A.value[1]!=A.value[0]?!1:y.next().done)}catch{return!1}}()?i:(l.prototype.add=function(c){return c=c===0?0:c,this.g.set(c,c),this.size=this.g.size,this},l.prototype.delete=function(c){return c=this.g.delete(c),this.size=this.g.size,c},l.prototype.clear=function(){this.g.clear(),this.size=0},l.prototype.has=function(c){return this.g.has(c)},l.prototype.entries=function(){return this.g.entries()},l.prototype.values=function(){return this.g.values()},l.prototype.keys=l.prototype.values,l.prototype[Symbol.iterator]=l.prototype.values,l.prototype.forEach=function(c,p){var y=this;this.g.forEach(function(A){return c.call(p,A,A,y)})},l)}),_("Array.from",function(i){return i||function(l,c,p){c=c??function(N){return N};var y=[],A=typeof Symbol<"u"&&Symbol.iterator&&l[Symbol.iterator];if(typeof A=="function"){l=A.call(l);for(var P=0;!(A=l.next()).done;)y.push(c.call(p,A.value,P++))}else for(A=l.length,P=0;P<A;P++)y.push(c.call(p,l[P],P));return y}});function Me(i,l,c){i instanceof String&&(i=String(i));for(var p=i.length,y=0;y<p;y++){var A=i[y];if(l.call(c,A,y,i))return{wa:y,v:A}}return{wa:-1,v:void 0}}_("Array.prototype.findIndex",function(i){return i||function(l,c){return Me(this,l,c).wa}}),_("Object.is",function(i){return i||function(l,c){return l===c?l!==0||1/l===1/c:l!==l&&c!==c}}),_("Array.prototype.includes",function(i){return i||function(l,c){var p=this;p instanceof String&&(p=String(p));var y=p.length,A=c||0;for(0>A&&(A=Math.max(A+y,0));A<y;A++){var P=p[A];if(P===l||Object.is(P,l))return!0}return!1}});function de(i,l,c){if(i==null)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(l instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return i+""}_("String.prototype.includes",function(i){return i||function(l,c){return de(this,l,"includes").indexOf(l,c||0)!==-1}}),_("Array.prototype.find",function(i){return i||function(l,c){return Me(this,l,c).v}}),_("String.prototype.startsWith",function(i){return i||function(l,c){for(var p=de(this,l,"startsWith"),y=p.length,A=l.length,P=Math.max(0,Math.min(c|0,p.length)),N=0;N<A&&P<y;)if(p[P++]!=l[N++])return!1;return N>=A}});var xe=typeof Object.assign=="function"?Object.assign:function(i,l){for(var c=1;c<arguments.length;c++){var p=arguments[c];if(p)for(var y in p)Ee(p,y)&&(i[y]=p[y])}return i};_("Object.assign",function(i){return i||xe}),_("Array.prototype.values",function(i){return i||function(){return Se(this,function(l,c){return c})}}),_("Promise.prototype.finally",function(i){return i||function(l){return this.then(function(c){return Promise.resolve(l()).then(function(){return c})},function(c){return Promise.resolve(l()).then(function(){throw c})})}}),_("Array.prototype.entries",function(i){return i||function(){return Se(this,function(l,c){return[l,c]})}}),_("String.prototype.repeat",function(i){return i||function(l){var c=de(this,null,"repeat");if(0>l||1342177279<l)throw new RangeError("Invalid count value");l|=0;for(var p="";l;)l&1&&(p+=c),(l>>>=1)&&(c+=c);return p}}),_("Number.isNaN",function(i){return i||function(l){return typeof l=="number"&&isNaN(l)}}),_("Object.values",function(i){return i||function(l){var c=[],p;for(p in l)Ee(l,p)&&c.push(l[p]);return c}}),_("Math.log2",function(i){return i||function(l){return Math.log(l)/Math.LN2}}),_("Object.entries",function(i){return i||function(l){var c=[],p;for(p in l)Ee(l,p)&&c.push([p,l[p]]);return c}});var Fe=this||self;function Le(i,l){var c=i.split("."),p=Fe;c[0]in p||typeof p.execScript>"u"||p.execScript("var "+c[0]);for(var y;c.length&&(y=c.shift());)c.length||l===void 0?p[y]&&p[y]!==Object.prototype[y]?p=p[y]:p=p[y]={}:p[y]=l}function De(i,l){if(l)if(l instanceof Map)for(var c=E(l.keys()),p=c.next();!p.done;p=c.next())p=p.value,Object.defineProperty(this,p,{value:l.get(p),writable:!0,enumerable:!0});else for(c in l)Object.defineProperty(this,c,{value:l[c],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=o.performance&&o.performance.now?o.performance.now():Date.now(),this.type=i,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function Ae(i){var l=new De(i.type),c;for(c in i)Object.defineProperty(l,c,{value:i[c],writable:!0,enumerable:!0});return l}De.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},De.prototype.stopImmediatePropagation=function(){this.g=!0},De.prototype.stopPropagation=function(){},Le("shaka.util.FakeEvent",De);function ge(){}function pe(){}function Re(){}function me(i,l){for(var c=[],p=1;p<arguments.length;++p)c[p-1]=arguments[p];oe.has(i)||(oe.add(i),Re.apply(ge,T(c)))}function V(){}function j(){}function $(){}function re(){}var oe=new Set;if(o.console&&o.console.log.bind){var X={},z=(X[1]=console.error.bind(console),X[2]=console.warn.bind(console),X[3]=console.info.bind(console),X[4]=console.log.bind(console),X[5]=console.debug.bind(console),X[6]=console.debug.bind(console),X);Re=z[2],pe=z[1]}function ne(){this.g={}}f=ne.prototype,f.push=function(i,l){this.g.hasOwnProperty(i)?this.g[i].push(l):this.g[i]=[l]},f.get=function(i){return(i=this.g[i])?i.slice():null},f.remove=function(i,l){i in this.g&&(this.g[i]=this.g[i].filter(function(c){return c!=l}),this.g[i].length==0&&delete this.g[i])};function fe(i,l){for(var c in i.g)l(c,i.g[c])}f.size=function(){return Object.keys(this.g).length},f.keys=function(){return Object.keys(this.g)};function Ce(){this.ea=new ne,this.hd=this}Ce.prototype.addEventListener=function(i,l){this.ea&&this.ea.push(i,l)},Ce.prototype.removeEventListener=function(i,l){this.ea&&this.ea.remove(i,l)},Ce.prototype.dispatchEvent=function(i){if(!this.ea)return!0;var l=this.ea.get(i.type)||[],c=this.ea.get("All");for(c&&(l=l.concat(c)),l=E(l),c=l.next();!c.done;c=l.next()){c=c.value,i.target=this.hd,i.currentTarget=this.hd;try{c.handleEvent?c.handleEvent(i):c.call(this,i)}catch{}if(i.g)break}return i.defaultPrevented},Ce.prototype.release=function(){this.ea=null};function Pe(i,l){for(var c=[],p=E(i),y=p.next();!y.done;y=p.next())c.push(l(y.value));return c}function he(i,l){for(var c=E(i),p=c.next();!p.done;p=c.next())if(!l(p.value))return!1;return!0}function Ue(i,l){for(var c=E(i),p=c.next();!p.done;p=c.next())if(l(p.value))return!0;return!1}function we(i,l){for(var c=[],p=E(i),y=p.next();!y.done;y=p.next())y=y.value,l(y)&&c.push(y);return c}var $e=function i(l){var c;return ve(i,function(p){return p.g==1&&(c=0),p.g!=3?c<l?I(p,c,3):p.D(0):(c++,p.D(2))})},it=function i(l){var c,p,y,A,P,N;return ve(i,function(G){return G.g==1&&(c=-1,y=p=void 0,A=E(l),P=A.next()),G.g!=5?P.done?c==-1?G.D(0):I(G,{wa:c,Yg:p,item:y,next:void 0},0):(N=P.value,0<=c?I(G,{wa:c,item:y,Yg:p,next:N},5):G.D(5)):(c++,p=y,y=N,P=A.next(),G.D(2))})};/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/var mt=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/function pt(i){var l;i instanceof pt?(Pt(this,i.ab),this.$b=i.$b,this.eb=i.eb,lt(this,i.vc),this.Sa=i.Sa,Ye(this,i.g.clone()),this.Pb=i.Pb):i&&(l=String(i).match(mt))?(Pt(this,l[1]||"",!0),this.$b=st(l[2]||""),this.eb=st(l[3]||"",!0),lt(this,l[4]),this.Sa=st(l[5]||"",!0),Ye(this,l[6]||"",!0),this.Pb=st(l[7]||"")):this.g=new Vt(null)}f=pt.prototype,f.ab="",f.$b="",f.eb="",f.vc=null,f.Sa="",f.Pb="",f.toString=function(){var i=[],l=this.ab;if(l&&i.push(Nt(l,Ht,!0),":"),l=this.eb){i.push("//");var c=this.$b;c&&i.push(Nt(c,Ht,!0),"@"),i.push(encodeURIComponent(l).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.vc,l!=null&&i.push(":",String(l))}return(l=this.Sa)&&(this.eb&&l.charAt(0)!="/"&&i.push("/"),i.push(Nt(l,l.charAt(0)=="/"?Et:nt,!0))),(l=this.g.toString())&&i.push("?",l),(l=this.Pb)&&i.push("#",Nt(l,Ut)),i.join("")},f.resolve=function(i){var l=this.clone();l.ab==="data"&&(l=new pt);var c=!!i.ab;c?Pt(l,i.ab):c=!!i.$b,c?l.$b=i.$b:c=!!i.eb,c?l.eb=i.eb:c=i.vc!=null;var p=i.Sa;if(c)lt(l,i.vc);else if(c=!!i.Sa){if(p.charAt(0)!="/")if(this.eb&&!this.Sa)p="/"+p;else{var y=l.Sa.lastIndexOf("/");y!=-1&&(p=l.Sa.substr(0,y+1)+p)}if(p==".."||p==".")p="";else if(p.indexOf("./")!=-1||p.indexOf("/.")!=-1){y=p.lastIndexOf("/",0)==0,p=p.split("/");for(var A=[],P=0;P<p.length;){var N=p[P++];N=="."?y&&P==p.length&&A.push(""):N==".."?((1<A.length||A.length==1&&A[0]!="")&&A.pop(),y&&P==p.length&&A.push("")):(A.push(N),y=!0)}p=A.join("/")}}return c?l.Sa=p:c=i.g.toString()!=="",c?Ye(l,i.g.clone()):c=!!i.Pb,c&&(l.Pb=i.Pb),l},f.clone=function(){return new pt(this)};function Pt(i,l,c){i.ab=c?st(l,!0):l,i.ab&&(i.ab=i.ab.replace(/:$/,""))}function lt(i,l){if(l){if(l=Number(l),isNaN(l)||0>l)throw Error("Bad port number "+l);i.vc=l}else i.vc=null}function Ye(i,l,c){l instanceof Vt?i.g=l:(c||(l=Nt(l,St)),i.g=new Vt(l))}function st(i,l){return i?l?decodeURI(i):decodeURIComponent(i):""}function Nt(i,l,c){return i!=null?(i=encodeURI(i).replace(l,Wt),c&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function Wt(i){return i=i.charCodeAt(0),"%"+(i>>4&15).toString(16)+(i&15).toString(16)}var Ht=/[#\/\?@]/g,nt=/[#\?:]/g,Et=/[#\?]/g,St=/[#\?@]/g,Ut=/#/g;function Vt(i){this.g=i||null}function Zt(i){if(!i.Ja&&(i.Ja={},i.nd=0,i.g))for(var l=i.g.split("&"),c=0;c<l.length;c++){var p=l[c].indexOf("="),y=null;if(0<=p){var A=l[c].substring(0,p);y=l[c].substring(p+1)}else A=l[c];A=decodeURIComponent(A.replace(/\+/g," ")),y=y||"",i.add(A,decodeURIComponent(y.replace(/\+/g," ")))}}f=Vt.prototype,f.Ja=null,f.nd=null,f.add=function(i,l){Zt(this),this.g=null;var c=this.Ja.hasOwnProperty(i)&&this.Ja[i];return c||(this.Ja[i]=c=[]),c.push(l),this.nd++,this},f.set=function(i,l){return Zt(this),this.g=null,this.Ja.hasOwnProperty(i)?this.Ja[i]=[l]:this.add(i,l),this},f.toString=function(){if(this.g)return this.g;if(!this.Ja)return"";var i=[],l;for(l in this.Ja)for(var c=encodeURIComponent(l),p=this.Ja[l],y=0;y<p.length;y++){var A=c;p[y]!==""&&(A+="="+encodeURIComponent(p[y])),i.push(A)}return this.g=i.join("&")},f.clone=function(){var i=new Vt;if(i.g=this.g,this.Ja){var l={},c;for(c in this.Ja)l[c]=this.Ja[c].concat();i.Ja=l,i.nd=this.nd}return i};function We(i,l,c,p){for(var y=[],A=3;A<arguments.length;++A)y[A-3]=arguments[A];this.severity=i,this.category=l,this.code=c,this.data=y,this.handled=!1}We.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},Le("shaka.util.Error",We),We.Severity={RECOVERABLE:1,CRITICAL:2},We.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},We.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004};function In(i,l){this.g=i,this.h=l}In.prototype.toString=function(){return"v"+this.g+"."+this.h};function Ct(i,l){var c=new In(4,0),p=ze,y=p.g,A=c.h-y.h;(0<(c.g-y.g||A)?p.i:p.h)(p.g,c,i,l)}function je(i,l,c,p){Re([c,"has been deprecated and will be removed in",l,". We are currently at version",i,". Additional information:",p].join(" "))}function Oe(i,l,c,p){pe([c,"has been deprecated and has been removed in",l,". We are now at version",i,". Additional information:",p].join(""))}var ze=null;function ct(i,l){return i.concat(l)}function dt(){}function bt(i){return i!=null}function Ft(i){var l=Object.create(i.prototype||Object.prototype);try{var c=i.call(l);c||(Ct("Factories requiring new","Factories should be plain functions"),c=l)}catch{Ct("Factories requiring new","Factories should be plain functions"),c=new i}return c}function Dt(i,l){if(l.length==0)return i;var c=l.map(function(p){return new pt(p)});return i.map(function(p){return new pt(p)}).map(function(p){return c.map(function(y){return p.resolve(y)})}).reduce(ct,[]).map(function(p){return p.toString()})}function Kt(i,l){return{keySystem:i,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:l||[],keyIds:new Set}}function on(i,l){if(l.length==1)return l[0];var c=Tn(i,l);if(c!=null)return c;throw new We(2,4,4025,l)}function Tn(i,l){for(var c=E(wt[i]),p=c.next();!p.done;p=c.next()){p=p.value;for(var y=E(l),A=y.next();!A.done;A=y.next())if(A=A.value,p.test(A.trim()))return A.trim()}return i==Ke?"":null}var Ke="text",ut={mb:"video",Nb:"audio",ua:Ke,Gc:"image",Ah:"application"},wt={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]};function Gt(){}function Qt(i,l){return i=pn(i),l=pn(l),i.split("-")[0]==l.split("-")[0]}function sn(i,l){i=pn(i),l=pn(l);var c=i.split("-"),p=l.split("-");return c[0]==p[0]&&c.length==1&&p.length==2}function Dn(i,l){i=pn(i),l=pn(l);var c=i.split("-"),p=l.split("-");return c.length==2&&p.length==2&&c[0]==p[0]}function pn(i){var l=i.split("-");return i=l[0]||"",l=l[1]||"",i=i.toLowerCase(),i=gt.get(i)||i,(l=l.toUpperCase())?i+"-"+l:i}function sr(i,l){var c=Tt(i),p=Tt(l);return i!=c&&l!=p&&c==p}function Be(i,l){return i=pn(i),l=pn(l),l==i?4:sn(l,i)?3:Dn(l,i)?2:sn(i,l)?1:0}function Tt(i){var l=i.indexOf("-");return i=0<=l?i.substring(0,l):i,i=i.toLowerCase(),i=gt.get(i)||i}function Xt(i){return i.language?pn(i.language):i.audio&&i.audio.language?pn(i.audio.language):i.video&&i.video.language?pn(i.video.language):"und"}function et(i,l){for(var c=pn(i),p=new Set,y=E(l),A=y.next();!A.done;A=y.next())p.add(pn(A.value));for(y=E(p),A=y.next();!A.done;A=y.next())if(A=A.value,A==c)return A;for(y=E(p),A=y.next();!A.done;A=y.next())if(A=A.value,sn(A,c))return A;for(y=E(p),A=y.next();!A.done;A=y.next())if(A=A.value,Dn(A,c))return A;for(p=E(p),A=p.next();!A.done;A=p.next())if(A=A.value,sn(c,A))return A;return null}Le("shaka.util.LanguageUtils",Gt),Gt.findClosestLocale=et,Gt.getLocaleForVariant=Xt,Gt.getLocaleForText=function(i){return pn(i.language||"und")},Gt.getBase=Tt,Gt.relatedness=Be,Gt.areSiblings=sr,Gt.normalize=pn,Gt.isSiblingOf=Dn,Gt.isParentOf=sn,Gt.areLanguageCompatible=Qt,Gt.areLocaleCompatible=function(i,l){return i=pn(i),l=pn(l),i==l};var gt=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function At(i){Ce.call(this),this.j=pn(i),this.i=new Map,this.g=new Set,this.h=new Map}D(At,Ce),f=At.prototype,f.release=function(){Ce.prototype.release.call(this)},f.We=function(i){var l=this;this.g.clear(),i=E(i);for(var c=i.next();!c.done;c=i.next())this.g.add(pn(c.value));en(this),i=we(this.g,function(p){return!l.h.has(p)}),i.length&&this.dispatchEvent(new De("unknown-locales",new Map().set("locales",i))),i=we(this.g,function(p){return l.h.has(p)}),i=new Map().set("locales",i.length?i:[this.j]),this.dispatchEvent(new De("locale-changed",i))},f.ma=function(i,l,c){i=pn(i),c===void 0&&(c=_n);var p=this.h.get(i)||new Map;return l.forEach(function(y,A){p.has(A)&&c!=_n||p.set(A,y)}),this.h.set(i,p),en(this),this.dispatchEvent(new De("locale-updated")),this},f.hh=function(i){for(var l=E(i.keys()),c=l.next();!c.done;c=l.next())c=c.value,i.set(c,this.resolve(c))},f.resolve=function(i){var l=this.i.get(i);return l||(i=new Map().set("locales",Array.from(this.g)).set("missing",i),this.dispatchEvent(new De("unknown-localization",i)),"")};function en(i){for(var l=i.h,c=i.j,p=i.g,y=new Set,A={},P=E(p),N=P.next();!N.done;A={ec:A.ec},N=P.next()){A.ec=N.value,y.add(A.ec),y.add(Tt(A.ec)),N=we(l.keys(),function(q){return function(ae){return sr(ae,q.ec)}}(A)),N.sort();var G=E(N);for(N=G.next();!N.done;N=G.next())y.add(N.value);for(N=we(l.keys(),function(q){return function(ae){return Tt(ae)==q.ec}}(A)),N.sort(),G=E(N),N=G.next();!N.done;N=G.next())y.add(N.value)}for(y.add(c),c=[],y=E(y),N=y.next();!N.done;N=y.next())(N=l.get(N.value))&&c.push(N);for(c.reverse(),i.i.clear(),l=E(c),N=l.next();!N.done;N=l.next())N.value.forEach(function(q,ae){i.i.set(ae,q)});for(l=i.i.keys(),y=new Set,c=E(i.g),N=c.next();!N.done;N=c.next())N=i.h.get(N.value)||new Map,Nn(N,l,y);0<y.size&&(p=new Map().set("locales",Array.from(p)).set("missing",Array.from(y)),i.dispatchEvent(new De("missing-localizations",p)))}function Nn(i,l,c){l=E(l);for(var p=l.next();!p.done;p=l.next())p=p.value,i.get(p)||c.add(p)}Le("shaka.ui.Localization",At),At.prototype.resolve=At.prototype.resolve,At.prototype.resolveDictionary=At.prototype.hh,At.prototype.insert=At.prototype.ma,At.prototype.changeLocale=At.prototype.We,At.prototype.release=At.prototype.release;var _n=1;At.ConflictResolution={USE_OLD:0,USE_NEW:_n},At.UNKNOWN_LOCALES="unknown-locales",At.UNKNOWN_LOCALIZATION="unknown-localization",At.MISSING_LOCALIZATIONS="missing-localizations",At.LOCALE_CHANGED="locale-changed",At.LOCALE_UPDATED="locale-updated";var En={ci:"MUTE",Qi:"VOLUME",Xh:"LOOP",ti:"RESOLUTION",Di:"STATISTICS",xh:"AD_TIME",Ni:"UNMUTE",Lh:"ENTER_LOOP_MODE",Uh:"FULL_SCREEN",Oi:"UNRECOGNIZED_LANGUAGE",Fh:"CAPTIONS",ai:"MORE_SETTINGS",Bi:"SKIP_TO_LIVE",Mi:"UNDETERMINED_LANGUAGE",ni:"PAUSE",Mh:"ENTER_PICTURE_IN_PICTURE",si:"REPLAY",Oh:"EXIT_FULL_SCREEN",Wh:"LANGUAGE",ii:"OFF",BACK:"BACK",pi:"PLAY",Nf:"SUBTITLE_FORCED",AD_PROGRESS:"AD_PROGRESS",gi:"NOT_APPLICABLE",wh:"AD_DURATION",oi:"PICTURE_IN_PICTURE",Ai:"SKIP_AD",Ph:"EXIT_LOOP_MODE",Se:"LIVE",wi:"REWIND",ri:"PLAYBACK_RATE",Gh:"CAST",zi:"SEEK",ji:"ON",Bh:"AUTO_QUALITY",bi:"MULTIPLE_LANGUAGES",yh:"AIRPLAY",Qh:"EXIT_PICTURE_IN_PICTURE",Th:"FAST_FORWARD"};function mr(i){this.g=Math.exp(Math.log(.5)/i),this.i=this.h=0}function jn(i,l,c){var p=Math.pow(i.g,l);c=c*(1-p)+p*i.h,isNaN(c)||(i.h=c,i.i+=l)}function Mt(i){return i.h/(1-Math.pow(i.g,i.i))}function gn(){this.h=new mr(2),this.j=new mr(5),this.g=0,this.i=128e3,this.l=16e3}gn.prototype.configure=function(i){this.i=i.minTotalBytes,this.l=i.minBytes,this.h.g=Math.exp(Math.log(.5)/i.fastHalfLife),this.j.g=Math.exp(Math.log(.5)/i.slowHalfLife)},gn.prototype.getBandwidthEstimate=function(i){return this.g<this.i?i:Math.min(Mt(this.h),Mt(this.j))};function cn(i,l){return typeof i=="number"&&typeof l=="number"&&isNaN(i)&&isNaN(l)?!0:i===l}function tt(i,l){var c=i.indexOf(l);-1<c&&i.splice(c,1)}function vt(i,l,c){if(c||(c=cn),i.length!=l.length)return!1;l=l.slice();var p={};i=E(i);for(var y=i.next();!y.done;p={Ld:p.Ld},y=i.next()){if(p.Ld=y.value,y=l.findIndex(function(A){return function(P){return c(A.Ld,P)}}(p)),y==-1)return!1;l[y]=l[l.length-1],l.pop()}return l.length==0}function He(i,l,c){if(c||(c=cn),i.length!=l.length)return!1;for(var p=0;p<i.length;p++)if(!c(i[p],l[p]))return!1;return!0}function ft(i,l,c){this.startTime=i,this.direction=Br,this.endTime=l,this.payload=c,this.region=new qs,this.position=null,this.positionAlign=vn,this.size=0,this.textAlign=yn,this.writingMode=Mi,this.lineInterpretation=Bi,this.line=null,this.lineHeight="",this.lineAlign=li,this.displayAlign=nr,this.fontSize=this.textStrokeWidth=this.textStrokeColor=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=bs,this.fontStyle=Aa,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.spacer=this.lineBreak=this.isContainer=!1,this.cellResolution={columns:32,rows:15}}ft.prototype.clone=function(){var i=new ft(0,0,""),l;for(l in this)i[l]=this[l],i[l]&&i[l].constructor==Array&&(i[l]=i[l].slice());return i};function $t(i,l){if(i.startTime!=l.startTime||i.endTime!=l.endTime||i.payload!=l.payload)return!1;for(var c in i)if(c!="startTime"&&c!="endTime"&&c!="payload"){if(c=="nestedCues"){if(!He(i.nestedCues,l.nestedCues,$t))return!1}else if(c=="region"||c=="cellResolution"){for(var p in i[c])if(i[c][p]!=l[c][p])return!1}else if(Array.isArray(i[c])){if(!He(i[c],l[c]))return!1}else if(i[c]!=l[c])return!1}return!0}Le("shaka.text.Cue",ft);var vn="auto";ft.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:vn};var yn="center",On={LEFT:"left",RIGHT:"right",CENTER:yn,START:"start",END:"end"};ft.textAlign=On;var nr="after",Un={BEFORE:"before",CENTER:"center",AFTER:nr};ft.displayAlign=Un;var Br="ltr";ft.direction={HORIZONTAL_LEFT_TO_RIGHT:Br,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var Mi="horizontal-tb";ft.writingMode={HORIZONTAL_TOP_TO_BOTTOM:Mi,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var Bi=0;ft.lineInterpretation={LINE_NUMBER:Bi,PERCENTAGE:1};var li="start",Xs={CENTER:"center",START:li,END:"end"};ft.lineAlign=Xs;var Sa={white:"#FFF",lime:"#0F0",cyan:"#0FF",red:"#F00",yellow:"#FF0",magenta:"#F0F",blue:"#00F",black:"#000"};ft.defaultTextColor=Sa;var Zo={bg_white:"#FFF",bg_lime:"#0F0",bg_cyan:"#0FF",bg_red:"#F00",bg_yellow:"#FF0",bg_magenta:"#F0F",bg_blue:"#00F",bg_black:"#000"};ft.defaultTextBackgroundColor=Zo;var bs=400;ft.fontWeight={NORMAL:bs,BOLD:700};var Aa="normal",Ds={NORMAL:Aa,ITALIC:"italic",OBLIQUE:"oblique"};ft.fontStyle=Ds,ft.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"};function qs(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=ji,this.scroll=Gl}Le("shaka.text.CueRegion",qs);var ji=1;qs.units={PX:0,PERCENTAGE:ji,LINES:2};var Gl="";qs.scrollMode={NONE:Gl,UP:"up"};function Eo(){}function Wi(i,l){if(!i&&!l)return!0;if(!i||!l||i.byteLength!=l.byteLength)return!1;if(el(i)==el(l)&&(i.byteOffset||0)==(l.byteOffset||0))return!0;for(var c=er(i),p=er(l),y=E($e(i.byteLength)),A=y.next();!A.done;A=y.next())if(A=A.value,c[A]!=p[A])return!1;return!0}function el(i){return i instanceof ArrayBuffer?i:i.buffer}function Hi(i){return i instanceof ArrayBuffer?i:i.byteOffset==0&&i.byteLength==i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer}function er(i,l,c){return c=c===void 0?1/0:c,_o(i,l===void 0?0:l,c,Uint8Array)}function Ii(i,l,c){return c=c===void 0?1/0:c,_o(i,l===void 0?0:l,c,DataView)}function _o(i,l,c,p){var y=(i.byteOffset||0)+i.byteLength;return l=Math.max(0,Math.min((i.byteOffset||0)+l,y)),new p(el(i),l,Math.min(l+Math.max(c,0),y)-l)}Le("shaka.util.BufferUtils",Eo),Eo.toDataView=Ii,Eo.toUint8=er,Eo.toArrayBuffer=Hi,Eo.equal=Wi;function To(){}Le("shaka.dependencies",To),To.has=function(i){return at.has(i)},To.add=function(i,l){if(!xa[i])throw Error(i+" is not supported");at.set(i,function(){return l})};var xa={muxjs:"muxjs"};To.Allowed=xa;var at=new Map([["muxjs",function(){return o.muxjs}]]);function Rt(){var i,l,c=new Promise(function(p,y){i=p,l=y});return c.resolve=i,c.reject=l,c}Rt.prototype.resolve=function(){},Rt.prototype.reject=function(){};function an(i){this.h=i,this.g=void 0}an.prototype.value=function(){return this.g==null&&(this.g=this.h()),this.g};function Rn(){}function Cn(i){return i?(i=er(i),i[0]==239&&i[1]==187&&i[2]==191&&(i=i.subarray(3)),i=new TextDecoder().decode(i),i.includes("�")&&pe('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),i):""}function Xn(i,l,c){if(!i)return"";if(!c&&i.byteLength%2!=0)throw new We(2,2,2004);var p=Math.floor(i.byteLength/2);c=new Uint16Array(p),i=Ii(i),p=E($e(p));for(var y=p.next();!y.done;y=p.next())y=y.value,c[y]=i.getUint16(2*y,l);return qi.value()(c)}function ar(i){function l(p){return c.byteLength<=p||32<=c[p]&&126>=c[p]}if(!i)return"";var c=er(i);if(c[0]==239&&c[1]==187&&c[2]==191)return Cn(c);if(c[0]==254&&c[1]==255)return Xn(c.subarray(2),!1);if(c[0]==255&&c[1]==254)return Xn(c.subarray(2),!0);if(c[0]==0&&c[2]==0)return Xn(i,!1);if(c[1]==0&&c[3]==0)return Xn(i,!0);if(l(0)&&l(1)&&l(2)&&l(3))return Cn(i);throw new We(2,2,2003)}function hi(i){var l=new TextEncoder;return Hi(l.encode(i))}function ti(i,l){for(var c=new ArrayBuffer(2*i.length),p=new DataView(c),y=E(it(i)),A=y.next();!A.done;A=y.next())A=A.value,p.setUint16(2*A.wa,A.item.charCodeAt(0),l);return c}Le("shaka.util.StringUtils",Rn),Rn.resetFromCharCode=function(){qi.g=void 0},Rn.toUTF16=ti,Rn.toUTF8=hi,Rn.fromBytesAutoDetect=ar,Rn.fromUTF16=Xn,Rn.fromUTF8=Cn;var qi=new an(function(){function i(c){try{var p=new Uint8Array(c);return 0<String.fromCharCode.apply(null,p).length}catch{return!1}}for(var l={Bb:65536};0<l.Bb;l={Bb:l.Bb},l.Bb/=2)if(i(l.Bb))return function(c){return function(p){for(var y="",A=0;A<p.length;A+=c.Bb)y+=String.fromCharCode.apply(null,p.subarray(A,A+c.Bb));return y}}(l);return null});function Kr(){}function Ca(i){return i=er(i),i=qi.value()(i),btoa(i)}function Ia(i,l){l=l??!0;var c=Ca(i).replace(/\+/g,"-").replace(/\//g,"_");return l?c:c.replace(/[=]*$/,"")}function Xa(i){var l=o.atob(i.replace(/-/g,"+").replace(/_/g,"/"));i=new Uint8Array(l.length),l=E(it(l));for(var c=l.next();!c.done;c=l.next())c=c.value,i[c.wa]=c.item.charCodeAt(0);return i}function zc(i){var l=i.length/2,c=new Uint8Array(l);l=E($e(l));for(var p=l.next();!p.done;p=l.next())p=p.value,c[p]=o.parseInt(i.substr(2*p,2),16);return c}function Wl(i){var l=er(i);i="",l=E(l);for(var c=l.next();!c.done;c=l.next())c=c.value,c=c.toString(16),c.length==1&&(c="0"+c),i+=c;return i}function Hl(i){for(var l=[],c=0;c<arguments.length;++c)l[c]=arguments[c];var p=0,y=E(l);for(c=y.next();!c.done;c=y.next())p+=c.value.byteLength;for(p=new Uint8Array(p),y=0,l=E(l),c=l.next();!c.done;c=l.next())c=c.value,p.set(er(c),y),y+=c.byteLength;return p}Le("shaka.util.Uint8ArrayUtils",Kr),Kr.concat=Hl,Kr.toHex=Wl,Kr.fromHex=zc,Kr.fromBase64=Xa,Kr.toBase64=Ia,Kr.toStandardBase64=Ca,Kr.equal=function(i,l){return Ct("shaka.util.Uint8ArrayUtils.equal","Please use shaka.util.BufferUtils.equal instead."),Wi(i,l)};function Yc(){var i=this;this.B=at.get("muxjs")(),this.g=new this.B.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.h=null,this.s=[],this.j=[],this.i=[],this.l=!1,this.g.on("data",function(l){i.j=l.captions,i.i=l.metadata,i.s.push(Hl(l.initSegment,l.data))}),this.g.on("done",function(){var l={data:Hl.apply(Kr,T(i.s)),captions:i.j,metadata:i.i};i.h.resolve(l),i.l=!1})}Yc.prototype.destroy=function(){return this.g.dispose(),this.g=null,Promise.resolve()};function Vl(i,l){if(!at.get("muxjs")()||!tl(i))return!1;if(l)return MediaSource.isTypeSupported(Ra(l,i));var c=Ra("audio",i),p=Ra("video",i);return MediaSource.isTypeSupported(c)||MediaSource.isTypeSupported(p)}function tl(i){return i.toLowerCase().split(";")[0].split("/")[1]=="mp2t"}function Ra(i,l){var c=l.replace(/mp2t/i,"mp4");i=="audio"&&(c=c.replace("video","audio"));var p=/avc1\.(66|77|100)\.(\d+)/.exec(c);if(p){var y="avc1.",A=p[1],P=Number(p[2]);y=(A=="66"?y+"4200":A=="77"?y+"4d00":y+"6400")+(P>>4).toString(16),y+=(P&15).toString(16),c=c.replace(p[0],y)}return c}function Hu(i,l){i.l=!0,i.h=new Rt,i.s=[],i.j=[],i.i=[];var c=er(l);return i.g.push(c),i.g.flush(),i.l&&i.h.reject(new We(2,3,3018)),i.h}function ui(i,l){var c=i;return l&&(c+='; codecs="'+l+'"'),c}function Qi(i,l,c){return i=ui(i,l),at.get("muxjs")()&&tl(i)?Ra(c,i):i}function Vi(i){i=i.split(".");var l=i[0];return i.pop(),l}function ld(i){return i=i.split(/ *; */),i.shift(),(i=i.find(function(l){return l.startsWith("codecs=")}))?i.split("=")[1].replace(/^"|"$/g,""):""}new Map().set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function ba(i){this.C=null,this.i=i,this.j=this.G=0,this.l=1/0,this.h=this.g=null,this.B="",this.s=new Map}function $l(i){return!!(Hr[i]||i=="application/cea-608"||i=="application/cea-708")}ba.prototype.destroy=function(){return this.i=this.C=null,this.s.clear(),Promise.resolve()};function xp(i,l,c,p){var y,A,P;return Z(function(N){if(N.g==1)return I(N,Promise.resolve(),2);if(!i.C||!i.i)return N.return();if(c==null||p==null)return i.C.parseInit(er(l)),N.return();y={periodStart:i.G,segmentStart:c,segmentEnd:p},A=i.C.parseMedia(er(l),y),P=A.filter(function(G){return G.startTime>=i.j&&G.startTime<i.l}),i.i.append(P),i.g==null&&(i.g=Math.max(c,i.j)),i.h=Math.min(p,i.l),U(N)})}ba.prototype.remove=function(i,l){var c=this;return Z(function(p){if(p.g==1)return I(p,Promise.resolve(),2);!c.i||!c.i.remove(i,l)||c.g==null||l<=c.g||i>=c.h||(i<=c.g&&l>=c.h?c.g=c.h=null:i<=c.g&&l<c.h?c.g=l:i>c.g&&l>=c.h&&(c.h=i)),U(p)})};function Cp(i,l,c){i.j=l,i.l=c}function Vu(i,l,c){if(i.B=l,l=i.s.get(l))for(var p=E(l.keys()),y=p.next();!y.done;y=p.next())(y=l.get(y.value).filter(function(A){return A.endTime<=c}))&&i.i.append(y)}function Xc(i){var l=[];i=E(i);for(var c=i.next();!c.done;c=i.next())c=c.value,l.push({stream:c.stream,cue:new ft(c.startTime,c.endTime,c.text)});return l}function nl(i,l,c){l.startTime+=c,l.endTime+=c,l=E(l.nestedCues);for(var p=l.next();!p.done;p=l.next())nl(i,p.value,c)}function So(i,l,c,p,y){var A=c+" "+p,P=new Map;l=E(l);for(var N=l.next();!N.done;N=l.next()){var G=N.value;N=G.stream,G=G.cue,P.has(N)||P.set(N,new Map),P.get(N).has(A)||P.get(N).set(A,[]),nl(i,G,y),G.startTime>=i.j&&G.startTime<i.l&&(P.get(N).get(A).push(G),N==i.B&&i.i.append([G]))}for(y=E(P.keys()),A=y.next();!A.done;A=y.next())for(A=A.value,i.s.has(A)||i.s.set(A,new Map),l=E(P.get(A).keys()),N=l.next();!N.done;N=l.next())N=N.value,G=P.get(A).get(N),i.s.get(A).set(N,G);i.g=i.g==null?Math.max(c,i.j):Math.min(i.g,Math.max(c,i.j)),i.h=Math.max(i.h,Math.min(p,i.l))}Le("shaka.text.TextEngine",ba),ba.prototype.destroy=ba.prototype.destroy,ba.findParser=function(i){return Hr[i]},ba.unregisterParser=function(i){delete Hr[i]},ba.registerParser=function(i,l){Hr[i]=l};var Hr={};function Ps(i){this.h=i,this.g=null}Ps.prototype.U=function(i){var l=this;this.stop();var c=!0,p=null;return this.g=function(){o.clearTimeout(p),c=!1},p=o.setTimeout(function(){c&&l.h()},1e3*i),this},Ps.prototype.stop=function(){this.g&&(this.g(),this.g=null)};function kn(i){this.h=i,this.g=null}kn.prototype.Ga=function(){return this.stop(),this.h(),this},kn.prototype.U=function(i){var l=this;return this.stop(),this.g=new Ps(function(){l.h()}).U(i),this},kn.prototype.na=function(i){var l=this;return this.stop(),this.g=new Ps(function(){l.g.U(i),l.h()}).U(i),this},kn.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},Le("shaka.util.Timer",kn),kn.prototype.stop=kn.prototype.stop,kn.prototype.tickEvery=kn.prototype.na,kn.prototype.tickAfter=kn.prototype.U,kn.prototype.tickNow=kn.prototype.Ga;function vs(){return!!(o.MediaSource&&MediaSource.isTypeSupported)}function Da(i){return cd().canPlayType(i)!=""}function Pa(){return pi("Tizen")}function zl(){return pi("CrKey")}function Yl(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!Pa()}function ud(){if(!Yl())return null;var i=navigator.userAgent.match(/Version\/(\d+)/);return i||(i=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(i[1],10):null}function pi(i){return(navigator.userAgent||"").includes(i)}function cd(){return rl||(Ao||(Ao=new kn(function(){rl=null})),(rl=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(rl=document.createElement("video")),Ao.U(1),rl)}var Ao=null,rl=null;function fd(i,l,c,p,y){var A=i.variants;(l.length||c.length)&&(A=Ip(A,l,c)),A=N0(A,p),l=dd(A),l=qc(l);var P=Qc(l,y);i.variants=i.variants.filter(function(N){return pd(N)==P})}function dd(i){var l=new ne;i=E(i);for(var c=i.next();!c.done;c=i.next()){c=c.value;var p=pd(c);l.push(p,c)}return l}function qc(i){var l=0,c=new Map,p=i.size();return fe(i,function(y,A){for(var P=E(A),N=P.next();!N.done;N=P.next()){N=N.value;var G=N.video;if(G&&G.width&&G.height){G=G.width*G.height*(G.frameRate||1),c.has(G)||c.set(G,new ne);var q=c.get(G);q.push(y,N),q.size()===p&&(l=Math.max(l,G))}}}),l?c.get(l):i}function Ip(i,l,c){var p={};l=E(l);for(var y=l.next();!y.done;p={Wd:p.Wd},y=l.next())if(p.Wd=y.value,y=i.filter(function(A){return function(P){return P.video&&P.video.codecs.startsWith(A.Wd)}}(p)),y.length){i=y;break}for(p={},c=E(c),l=c.next();!l.done;p={Id:p.Id},l=c.next())if(p.Id=l.value,l=i.filter(function(A){return function(P){return P.audio&&P.audio.codecs.startsWith(A.Id)}}(p)),l.length){i=l;break}return i}function Qc(i,l){for(var c=E(l),p=c.next();!p.done;p=c.next())if(p=p.value,p==_S||p==TS){if(i=Jc(i,p),i.size()==1)return i.keys()[0]}else if(p==U0)break;return hd(i)}function Jc(i,l){var c=0,p=new ne;return fe(i,function(y,A){for(var P=0,N=0,G=E(A),q=G.next();!q.done;q=G.next())q=q.value,q.decodingInfos.length&&(P+=q.decodingInfos[0][l]?1:0,N++);P/=N,P>c?(p.g={},p.push(y,A),c=P):P==c&&p.push(y,A)}),p}function hd(i){var l="",c=1/0;return fe(i,function(p,y){for(var A=0,P=0,N=E(y),G=N.next();!G.done;G=N.next())A+=G.value.bandwidth||0,++P;A/=P,A<c&&(l=p,c=A)}),l}function pd(i){var l="";i.video&&(l=Vi(i.video.codecs));var c="";return i.audio&&(c=Vi(i.audio.codecs)),l+"-"+c}function gd(i,l,c){i.variants=i.variants.filter(function(p){return Xl(p,l,c)})}function Xl(i,l,c){function p(A,P,N){return A>=P&&A<=N}var y=i.video;return!(y&&y.width&&y.height&&(!p(y.width,l.minWidth,Math.min(l.maxWidth,c.width))||!p(y.height,l.minHeight,Math.min(l.maxHeight,c.height))||!p(y.width*y.height,l.minPixels,l.maxPixels))||i&&i.video&&i.video.frameRate&&!p(i.video.frameRate,l.minFrameRate,l.maxFrameRate)||!p(i.bandwidth,l.minBandwidth,l.maxBandwidth))}function Zc(i,l){return Z(function(c){if(c.g==1)return I(c,ht(l,0<l.offlineSessionIds.length),2);il(i,l),sl(l),ef(l),U(c)})}function ht(i,l){return Z(function(c){if(c.g==1)return I(c,nn(i.variants,l,!1),2);i.variants=i.variants.filter(function(p){var y=p.video;if(y){var A=wr(y.codecs);if(y.codecs.includes(",")){var P=y.codecs.split(",");if(A=on("video",P),P=on("audio",P),P=Qi(y.mimeType,P,"audio"),!MediaSource.isTypeSupported(P))return!1}if(A=Qi(y.mimeType,A,"video"),!MediaSource.isTypeSupported(A))return!1}return(A=p.audio)&&(P=hr(A.codecs),A=Qi(A.mimeType,P,"audio"),!MediaSource.isTypeSupported(A))?!1:pi("Xbox One")&&y&&(y.width&&1920<y.width||y.height&&1080<y.height)&&y.codecs.includes("avc1.")?(rf(p),!1):((y=p.decodingInfos.some(function(N){return N.supported}))||(rf(p),void 0),y)}),U(c)})}function nn(i,l,c){var p,y,A,P,N,G,q,ae,Te,Ie;return Z(function(Ne){if(i.some(function(Ve){return Ve.decodingInfos.length}))return Ne.return();for(p=navigator.mediaCapabilities,y=[],A=function(Ve,qe){var Ze;return Z(function(Qe){if(Qe.g==1)return w(Qe,2),I(Qe,p.decodingInfo(qe),4);if(Qe.g!=2)return Ze=Qe.h,Ve.decodingInfos.push(Ze),K(Qe,0);W(Qe),JSON.stringify(qe),U(Qe)})},P=E(i),N=P.next();!N.done;N=P.next())for(G=N.value,q=Ln(G,l,c),ae=E(q),Te=ae.next();!Te.done;Te=ae.next())Ie=Te.value,y.push(A(G,Ie));return I(Ne,Promise.all(y),0)})}function Ln(i,l,c){var p=i.audio,y=i.video;if(c={type:c?"file":"media-source"},y){var A=y.codecs;if(y.codecs.includes(",")){var P=y.codecs.split(",");A=on("video",P),A=wr(A),P=on("audio",P),P=Qi(y.mimeType,P,"audio"),c.audio={contentType:P,channels:2,bitrate:i.bandwidth||1,samplerate:1,spatialRendering:!1}}if(A=wr(A),A=Qi(y.mimeType,A,"video"),c.video={contentType:A,width:y.width||1,height:y.height||1,bitrate:y.bandwidth||i.bandwidth||1,framerate:y.frameRate||1},y.hdr)switch(y.hdr){case"SDR":c.video.transferFunction="srgb";break;case"PQ":c.video.transferFunction="pq";break;case"HLG":c.video.transferFunction="hlg"}}if(p&&(A=hr(p.codecs),A=Qi(p.mimeType,A,"audio"),c.audio={contentType:A,channels:p.channelsCount||2,bitrate:p.bandwidth||i.bandwidth||1,samplerate:p.audioSamplingRate||1,spatialRendering:p.spatialAudio}),P=(i.video?i.video.drmInfos:[]).concat(i.audio?i.audio.drmInfos:[]),!P.length)return[c];i=[],A=new Map,P=E(P);for(var N=P.next();!N.done;N=P.next()){var G=N.value;A.get(G.keySystem)||A.set(G.keySystem,[]),A.get(G.keySystem).push(G)}P=l?"required":"optional",l=l?["persistent-license"]:["temporary"],G=E(A.keys());for(var q=G.next();!q.done;q=G.next()){var ae=q.value;q=Object.assign({},c);var Te=A.get(ae);for(ae={keySystem:ae,initDataType:"cenc",persistentState:P,distinctiveIdentifier:"optional",sessionTypes:l},Te=E(Te),N=Te.next();!N.done;N=Te.next()){if(N=N.value,N.initData&&N.initData.length){for(var Ie=new Set,Ne=E(N.initData),Ve=Ne.next();!Ve.done;Ve=Ne.next())Ie.add(Ve.value.initDataType);ae.initDataType=N.initData[0].initDataType}N.distinctiveIdentifierRequired&&(ae.distinctiveIdentifier="required"),N.persistentStateRequired&&(ae.persistentState="required"),N.sessionType&&(ae.sessionTypes=[N.sessionType]),p&&(ae.audio?ae.audio.robustness=ae.audio.robustness||N.audioRobustness:ae.audio={robustness:N.audioRobustness}),y&&(ae.video?ae.video.robustness=ae.video.robustness||N.videoRobustness:ae.video={robustness:N.videoRobustness})}q.keySystemConfiguration=ae,i.push(q)}return i}function hr(i){return Pa()&&i.toLowerCase()=="ac-3"?"ec-3":i}function wr(i){return i=="vp9"?"vp09.00.10.08":i}function il(i,l){l.variants=l.variants.filter(function(c){var p=c.audio;return c=c.video,!(p&&i&&i.audio&&!M0(p,i.audio)||c&&i&&i.video&&!M0(c,i.video))})}function sl(i){i.textStreams=i.textStreams.filter(function(l){return $l(ui(l.mimeType,l.codecs))})}function ef(i){i.imageStreams=i.imageStreams.filter(function(l){var c=["image/svg+xml","image/png","image/jpeg"];return(pi("Web0S")||Pa()||zl())&&c.push("image/webp"),c.includes(l.mimeType)})}function M0(i,l){return!(i.mimeType!=l.mimeType||i.codecs.split(".")[0]!=l.codecs.split(".")[0])}function ql(i){var l=i.audio,c=i.video,p=l?l.codecs:null,y=c?c.codecs:null,A=[];y&&A.push(y),p&&A.push(p);var P=[];c&&P.push(c.mimeType),l&&P.push(l.mimeType),P=P[0]||null;var N=[];l&&N.push(l.kind),c&&N.push(c.kind),N=N[0]||null;var G=new Set;if(l)for(var q=E(l.roles),ae=q.next();!ae.done;ae=q.next())G.add(ae.value);if(c)for(q=E(c.roles),ae=q.next();!ae.done;ae=q.next())G.add(ae.value);return i={id:i.id,active:!1,type:"variant",bandwidth:i.bandwidth,language:i.language,label:null,kind:N,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:P,codecs:A.join(", "),audioCodec:p,videoCodec:y,primary:i.primary,roles:Array.from(G),audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null},c&&(i.videoId=c.id,i.originalVideoId=c.originalId,i.width=c.width||null,i.height=c.height||null,i.frameRate=c.frameRate||null,i.pixelAspectRatio=c.pixelAspectRatio||null,i.videoBandwidth=c.bandwidth||null),l&&(i.audioId=l.id,i.originalAudioId=l.originalId,i.channelsCount=l.channelsCount,i.audioSamplingRate=l.audioSamplingRate,i.audioBandwidth=l.bandwidth||null,i.label=l.label,i.audioRoles=l.roles),i}function tf(i){return{id:i.id,active:!1,type:Ke,bandwidth:0,language:i.language,label:i.label,kind:i.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:i.mimeType,codecs:i.codecs||null,audioCodec:null,videoCodec:null,primary:i.primary,roles:i.roles,audioRoles:null,forced:i.forced,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:i.originalId,originalImageId:null}}function Rp(i){var l=i.width||null,c=i.height||null,p=null;i.segmentIndex&&(p=i.segmentIndex.get(0));var y=i.tilesLayout;return p&&(y=p.tilesLayout||y),y&&l!=null&&(l/=Number(y.split("x")[0])),y&&c!=null&&(c/=Number(y.split("x")[1])),{id:i.id,active:!1,type:"image",bandwidth:i.bandwidth||0,language:"",label:null,kind:null,width:l,height:c,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:i.mimeType,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:y||null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:i.originalId}}function bp(i){return i.__shaka_id||(i.__shaka_id=ES++),i.__shaka_id}function w0(i){var l=O0(i);return l.active=i.mode!="disabled",l.type="text",l.originalTextId=i.id,i.kind=="captions"&&(l.mimeType="application/cea-608"),i.kind&&(l.roles=[i.kind]),i.kind=="forced"&&(l.forced=!0),l}function md(i){var l=O0(i);return l.active=i.enabled,l.type="variant",l.originalAudioId=i.id,i.kind=="main"&&(l.primary=!0),i.kind&&(l.roles=[i.kind],l.audioRoles=[i.kind],l.label=i.label),l}function O0(i){return{id:bp(i),active:!1,type:"",bandwidth:0,language:pn(i.language),label:i.label,kind:i.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],forced:!1,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null}}function nf(i){return i.allowedByApplication&&i.allowedByKeySystem}function yS(i){return i.filter(function(l){return nf(l)})}function N0(i,l){var c=i.filter(function(P){return P.audio&&P.audio.channelsCount}),p=new Map;c=E(c);for(var y=c.next();!y.done;y=c.next()){y=y.value;var A=y.audio.channelsCount;p.has(A)||p.set(A,[]),p.get(A).push(y)}return c=Array.from(p.keys()),c.length==0?i:(y=c.filter(function(P){return P<=l}),y.length?p.get(Math.max.apply(Math,T(y))):p.get(Math.min.apply(Math,T(c))))}function Dp(i,l,c,p){var y=i,A=i.filter(function(G){return G.primary});A.length&&(y=A);var P=y.length?y[0].language:"";if(y=y.filter(function(G){return G.language==P}),l){var N=et(pn(l),i.map(function(G){return G.language}));N&&(y=i.filter(function(G){return pn(G.language)==N}))}if(y=y.filter(function(G){return G.forced==p}),c){if(i=F0(y,c),i.length)return i}else if(i=y.filter(function(G){return G.roles.length==0}),i.length)return i;return i=y.map(function(G){return G.roles}).reduce(ct,[]),i.length?F0(y,i[0]):y}function F0(i,l){return i.filter(function(c){return c.roles.includes(l)})}function rf(i){var l=[];return i.audio&&l.push(k0(i.audio)),i.video&&l.push(k0(i.video)),l.join(", ")}function k0(i){return i.type=="audio"?"type=audio codecs="+i.codecs+" bandwidth="+i.bandwidth+" channelsCount="+i.channelsCount+" audioSamplingRate="+i.audioSamplingRate:i.type=="video"?"type=video codecs="+i.codecs+" bandwidth="+i.bandwidth+" frameRate="+i.frameRate+" width="+i.width+" height="+i.height:"unexpected stream type"}var ES=0,_S="smooth",TS="powerEfficient",U0="bandwidth";function ni(){var i=this;this.j=null,this.h=!1,this.g=new gn,navigator.connection&&navigator.connection.addEventListener("change",function(){if(i.m.useNetworkInformation&&i.h){i.g=new gn,i.m&&i.g.configure(i.m.advanced);var l=i.chooseVariant();l&&i.j(l)}}),this.i=[],this.s=1,this.B=!1,this.m=this.l=null}f=ni.prototype,f.stop=function(){this.j=null,this.h=!1,this.i=[],this.s=1,this.l=null},f.init=function(i){this.j=i},f.chooseVariant=function(){var i=$u(this.m.restrictions,this.i),l=this.g.getBandwidthEstimate(sf(this));this.i.length&&!i.length&&(i=$u(null,this.i),i=[i[0]]);var c=i[0]||null;i=E(it(i));for(var p=i.next();!p.done;p=i.next()){var y=p.value;p=y.item;var A=isNaN(this.s)?1:Math.abs(this.s);y=A*(y.next||{bandwidth:1/0}).bandwidth/this.m.bandwidthUpgradeTarget,l>=A*p.bandwidth/this.m.bandwidthDowngradeTarget&&l<=y&&(c=p)}return this.l=Date.now(),c},f.enable=function(){this.h=!0},f.disable=function(){this.h=!1},f.segmentDownloaded=function(i,l){var c=this.g;if(!(l<c.l)){var p=8e3*l/i,y=i/1e3;c.g+=l,jn(c.h,y,p),jn(c.j,y,p)}if(this.l!=null&&this.h)e:{if(this.B){if(Date.now()-this.l<1e3*this.m.switchInterval)break e}else{if(c=this.g,!(c.g>=c.i))break e;this.B=!0}c=this.chooseVariant(),this.g.getBandwidthEstimate(sf(this)),c&&this.j(c)}},f.getBandwidthEstimate=function(){return this.g.getBandwidthEstimate(this.m.defaultBandwidthEstimate)},f.setVariants=function(i){this.i=i},f.playbackRateChanged=function(i){this.s=i},f.configure=function(i){this.m=i,this.g&&this.m&&this.g.configure(this.m.advanced)};function sf(i){var l=i.m.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&i.m.useNetworkInformation&&(l=1e6*navigator.connection.downlink),l}function $u(i,l){return i&&(l=l.filter(function(c){return Xl(c,i,{width:1/0,height:1/0})})),l.sort(function(c,p){return c.bandwidth-p.bandwidth})}Le("shaka.abr.SimpleAbrManager",ni),ni.prototype.configure=ni.prototype.configure,ni.prototype.playbackRateChanged=ni.prototype.playbackRateChanged,ni.prototype.setVariants=ni.prototype.setVariants,ni.prototype.getBandwidthEstimate=ni.prototype.getBandwidthEstimate,ni.prototype.segmentDownloaded=ni.prototype.segmentDownloaded,ni.prototype.disable=ni.prototype.disable,ni.prototype.enable=ni.prototype.enable,ni.prototype.chooseVariant=ni.prototype.chooseVariant,ni.prototype.init=ni.prototype.init,ni.prototype.stop=ni.prototype.stop;function Vr(i,l){this.h=i,this.g=new Set([i]),l=l||[];for(var c=E(l),p=c.next();!p.done;p=c.next())this.add(p.value)}Vr.prototype.add=function(i){return al(this.h,i)?(this.g.add(i),!0):!1};function al(i,l){var c;if(!(c=!!i.audio!=!!l.audio||!!i.video!=!!l.video||i.language!=l.language)&&(c=i.audio&&l.audio)){c=i.audio;var p=l.audio;c=!((!(!c.channelsCount||!p.channelsCount||2<c.channelsCount||2<p.channelsCount)||c.channelsCount==p.channelsCount)&&vd(c,p)&&B0(c.roles,p.roles))}return!c&&(c=i.video&&l.video)&&(c=i.video,p=l.video,c=!(vd(c,p)&&B0(c.roles,p.roles))),!c}Vr.prototype.values=function(){return this.g.values()};function vd(i,l){if(i.mimeType!=l.mimeType)return!1;var c=i.codecs.split(",").map(function(P){return Vi(P)}),p=l.codecs.split(",").map(function(P){return Vi(P)});if(c.length!=p.length)return!1;c.sort(),p.sort();for(var y=E($e(c.length)),A=y.next();!A.done;A=y.next())if(A=A.value,c[A]!=p[A])return!1;return!0}function B0(i,l){var c=new Set(i),p=new Set(l);if(c.delete("main"),p.delete("main"),c.size!=p.size)return!1;c=E(c);for(var y=c.next();!y.done;y=c.next())if(!p.has(y.value))return!1;return!0}function j0(i){this.g=i,this.h=new zu(i.language,"",i.audio&&i.audio.channelsCount?i.audio.channelsCount:0,"")}j0.prototype.create=function(i){var l=this,c=i.filter(function(p){return al(l.g,p)});return c.length?new Vr(c[0],c):this.h.create(i)};function zu(i,l,c,p){this.i=i,this.j=l,this.g=c,this.h=p===void 0?"":p}zu.prototype.create=function(i){var l=[];l=SS(i,this.i);var c=i.filter(function(p){return p.primary});for(l=l.length?l:c.length?c:i,i=K0(l,this.j),i.length&&(l=i),this.g&&(i=N0(l,this.g),i.length&&(l=i)),this.h&&(i=G0(l,this.h),i.length&&(l=i)),i=new Vr(l[0]),l=E(l),c=l.next();!c.done;c=l.next())c=c.value,al(i.h,c)&&i.add(c);return i};function SS(i,l){var c=pn(l),p=et(c,i.map(function(y){return Xt(y)}));return p?i.filter(function(y){return p==Xt(y)}):[]}function K0(i,l){return i.filter(function(c){return c.audio?l?c.audio.roles.includes(l):c.audio.roles.length==0:!1})}function G0(i,l){return i.filter(function(c){return c.audio?c.audio.label.toLowerCase()==l.toLowerCase():!1})}function W0(){this.g=Yu,this.h=new Map().set(Yu,2).set(Ql,1)}function Pp(i,l,c){i.h.set(Yu,c).set(Ql,l)}var Ql=0,Yu=1;function Lp(i,l){var c=Xu();this.l=i.maxAttempts==null?c.maxAttempts:i.maxAttempts,this.j=i.baseDelay==null?c.baseDelay:i.baseDelay,this.B=i.fuzzFactor==null?c.fuzzFactor:i.fuzzFactor,this.s=i.backoffFactor==null?c.backoffFactor:i.backoffFactor,this.g=0,this.h=this.j,(this.i=l===void 0?!1:l)&&(this.g=1)}function yd(i){var l,c;return Z(function(p){if(p.g==1){if(i.g>=i.l)if(i.i)i.g=1,i.h=i.j;else throw new We(2,7,1010);return l=i.g,i.g++,l==0?p.return():(c=i.h*(1+(2*Math.random()-1)*i.B),I(p,new Promise(function(y){new kn(y).U(c/1e3)}),2))}i.h*=i.s,U(p)})}function Xu(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}}function Dr(i,l){this.promise=i,this.i=l,this.g=!1}function xo(i){return new Dr(Promise.reject(i),function(){return Promise.resolve()})}function Ed(){var i=Promise.reject(new We(2,7,7001));return i.catch(function(){}),new Dr(i,function(){return Promise.resolve()})}function Co(i){return new Dr(Promise.resolve(i),function(){return Promise.resolve()})}function Ls(i){return new Dr(i,function(){return i.catch(function(){})})}Dr.prototype.abort=function(){return this.g=!0,this.i()};function H0(i){return new Dr(Promise.all(i.map(function(l){return l.promise})),function(){return Promise.all(i.map(function(l){return l.abort()}))})}Dr.prototype.finally=function(i){return this.promise.then(function(){return i(!0)},function(){return i(!1)}),this},Dr.prototype.va=function(i,l){function c(N){return function(G){if(y.g&&N)A.reject(P);else{var q=N?i:l;q?p=AS(q,G,A):(N?A.resolve:A.reject)(G)}}}function p(){return A.reject(P),y.abort()}var y=this,A=new Rt,P=new We(2,7,7001);return this.promise.then(c(!0),c(!1)),new Dr(A,function(){return p()})};function AS(i,l,c){try{var p=i(l);return p&&p.promise&&p.abort?(c.resolve(p.promise),function(){return p.abort()}):(c.resolve(p),function(){return Promise.resolve(p).then(function(){},function(){})})}catch(y){return c.reject(y),function(){return Promise.resolve()}}}Le("shaka.util.AbortableOperation",Dr),Dr.prototype.chain=Dr.prototype.va,Dr.prototype.finally=Dr.prototype.finally,Dr.all=H0,Dr.prototype.abort=Dr.prototype.abort,Dr.notAbortable=Ls,Dr.completed=Co,Dr.aborted=Ed,Dr.failed=xo;function qu(i){function l(p){switch(typeof p){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return p;default:if(!p||p.buffer&&p.buffer.constructor==ArrayBuffer)return p;if(c.has(p))return null;var y=p.constructor==Array;if(p.constructor!=Object&&!y)return null;c.add(p);var A=y?[]:{},P;for(P in p)A[P]=l(p[P]);return y&&(A.length=p.length),A}}var c=new Set;return l(i)}function V0(i){var l={},c;for(c in i)l[c]=i[c];return l}function _d(){this.g=[]}function ol(i,l){i.g.push(l.finally(function(){tt(i.g,l)}))}_d.prototype.destroy=function(){for(var i=[],l=E(this.g),c=l.next();!c.done;c=l.next())c=c.value,c.promise.catch(function(){}),i.push(c.abort());return this.g=[],Promise.all(i)};function Tr(i,l,c){Ce.call(this),this.i=!1,this.s=new _d,this.g=new Set,this.h=new Set,this.l=i||null,this.j=l||null,this.C=c||null,this.B=!1}D(Tr,Ce),f=Tr.prototype,f.Ee=function(i){this.B=i};function Io(i,l,c,p){c=c||Mp;var y=Td[i];(!y||c>=y.priority)&&(Td[i]={priority:c,Xg:l,Zg:p===void 0?!1:p})}f.$g=function(i){this.g.add(i)},f.qh=function(i){this.g.delete(i)},f.Vf=function(){this.g.clear()},f.ah=function(i){this.h.add(i)},f.rh=function(i){this.h.delete(i)},f.Wf=function(){this.h.clear()};function Qs(i,l,c){return{uris:i,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:l,licenseRequestType:null,sessionId:null,streamDataCallback:c===void 0?null:c}}f.destroy=function(){return this.i=!0,this.g.clear(),this.h.clear(),Ce.prototype.release.call(this),this.s.destroy()},f.request=function(i,l){var c=this,p=new Ji;if(this.i){var y=Promise.reject(new We(2,7,7001));return y.catch(function(){}),new Ms(y,function(){return Promise.resolve()},p)}l.method=l.method||"GET",l.headers=l.headers||{},l.retryParameters=l.retryParameters?qu(l.retryParameters):Xu(),l.uris=qu(l.uris),y=Qu(this,i,l);var A=y.va(function(){return Ir(c,i,l,new Lp(l.retryParameters,!1),0,null,p)}),P=A.va(function(Te){return Jl(c,i,Te)}),N=Date.now(),G=0;y.promise.then(function(){G=Date.now()-N},function(){});var q=0;A.promise.then(function(){q=Date.now()},function(){});var ae=P.va(function(Te){var Ie=Date.now()-q,Ne=Te.response;return Ne.timeMs+=G,Ne.timeMs+=Ie,Te.Kg||!c.l||Ne.fromCache||i!=Ro||c.l(Ne.timeMs,Ne.data.byteLength),Ne},function(Te){throw Te&&(Te.severity=2),Te});return y=new Ms(ae.promise,function(){return ae.abort()},p),ol(this.s,y),y};function Qu(i,l,c){var p=Co(void 0),y={};i=E(i.g);for(var A=i.next();!A.done;y={Rd:y.Rd},A=i.next())y.Rd=A.value,p=p.va(function(P){return function(){return c.body&&(c.body=Hi(c.body)),P.Rd(l,c)}}(y));return p.va(void 0,function(P){throw P instanceof We&&P.code==7001?P:new We(2,1,1006,P)})}function Ir(i,l,c,p,y,A,P){i.B&&(c.uris[y]=c.uris[y].replace("http://","https://"));var N=new pt(c.uris[y]),G=N.ab,q=!1;G||(G=location.protocol,G=G.slice(0,-1),Pt(N,G),c.uris[y]=N.toString()),G=G.toLowerCase();var ae=(G=Td[G])?G.Xg:null;if(!ae)return xo(new We(2,1,1e3,N));var Te=G.Zg,Ie=null,Ne=null,Ve=!1,qe=!1,Ze;return Ls(yd(p)).va(function(){if(i.i)return Ed();Ze=Date.now();var Qe=ae(c.uris[y],c,l,function(yt,Jt,un){Ie&&Ie.stop(),Ne&&Ne.U(It/1e3),i.l&&l==Ro&&(i.l(yt,Jt),q=!0,P.g=un)},function(yt){i.j&&i.j(yt,c,l),qe=!0});if(!Te)return Qe;var Lt=c.retryParameters.connectionTimeout;Lt&&(Ie=new kn(function(){Ve=!0,Qe.abort()}),Ie.U(Lt/1e3));var It=c.retryParameters.stallTimeout;return It&&(Ne=new kn(function(){Ve=!0,Qe.abort()})),Qe}).va(function(Qe){Ie&&Ie.stop(),Ne&&Ne.stop(),Qe.timeMs==null&&(Qe.timeMs=Date.now()-Ze);var Lt={response:Qe,Kg:q};return!qe&&i.j&&i.j(Qe.headers,c,l),Lt},function(Qe){if(Ie&&Ie.stop(),Ne&&Ne.stop(),i.C){var Lt=null,It=0;Qe instanceof We&&(Lt=Qe,Qe.code==1001&&(It=Qe.data[1])),i.C(c,Lt,It,Ve)}if(i.i)return Ed();if(Ve&&(Qe=new We(1,1,1003,c.uris[y],l)),Qe instanceof We){if(Qe.code==7001)throw Qe;if(Qe.code==1010)throw A;if(Qe.severity==1)return Lt=new Map().set("error",Qe),Lt=new De("retry",Lt),i.dispatchEvent(Lt),y=(y+1)%c.uris.length,Ir(i,l,c,p,y,Qe,P)}throw Qe})}function Jl(i,l,c){var p=Co(void 0),y={};i=E(i.h);for(var A=i.next();!A.done;y={Sd:y.Sd},A=i.next())y.Sd=A.value,p=p.va(function(P){return function(){var N=c.response;return N.data&&(N.data=Hi(N.data)),P.Sd(l,N)}}(y));return p.va(function(){return c},function(P){var N=2;if(P instanceof We){if(P.code==7001)throw P;N=P.severity}throw new We(N,1,1007,P)})}Le("shaka.net.NetworkingEngine",Tr),Tr.prototype.request=Tr.prototype.request,Tr.prototype.destroy=Tr.prototype.destroy,Tr.makeRequest=Qs,Tr.defaultRetryParameters=function(){return Xu()},Tr.prototype.clearAllResponseFilters=Tr.prototype.Wf,Tr.prototype.unregisterResponseFilter=Tr.prototype.rh,Tr.prototype.registerResponseFilter=Tr.prototype.ah,Tr.prototype.clearAllRequestFilters=Tr.prototype.Vf,Tr.prototype.unregisterRequestFilter=Tr.prototype.qh,Tr.prototype.registerRequestFilter=Tr.prototype.$g,Tr.unregisterScheme=function(i){delete Td[i]},Tr.registerScheme=Io,Tr.prototype.setForceHTTPS=Tr.prototype.Ee;function Ji(){this.g=0}Tr.NumBytesRemainingClass=Ji;function Ms(i,l,c){Dr.call(this,i,l),this.h=c}D(Ms,Dr),Tr.PendingRequest=Ms;var Ro=1;Tr.RequestType={MANIFEST:0,SEGMENT:Ro,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5};var Mp=3;Tr.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:Mp};var Td={};function Zl(i){this.g=!1,this.h=new Rt,this.i=i}Zl.prototype.destroy=function(){var i=this;return this.g?this.h:(this.g=!0,this.i().then(function(){i.h.resolve()},function(){i.h.resolve()}))};function Pr(i,l){if(i.g)throw l instanceof We&&l.code==7003?l:new We(2,7,7003,l)}function _r(){this.g=new ne}f=_r.prototype,f.release=function(){this.Yb(),this.g=null},f.o=function(i,l,c,p){this.g&&(i=new $0(i,l,c,p),this.g.push(l,i))},f.Qa=function(i,l,c,p){function y(P){A.Ta(i,l,y),c(P)}var A=this;this.o(i,l,y,p)},f.Ta=function(i,l,c){if(this.g){var p=this.g.get(l)||[];p=E(p);for(var y=p.next();!y.done;y=p.next())y=y.value,y.target!=i||c!=y.listener&&c||(y.Ta(),this.g.remove(l,y))}},f.Yb=function(){if(this.g){var i=this.g,l=[],c;for(c in i.g)l.push.apply(l,T(i.g[c]));for(i=E(l),l=i.next();!l.done;l=i.next())l.value.Ta();this.g.g={}}},Le("shaka.util.EventManager",_r),_r.prototype.removeAll=_r.prototype.Yb,_r.prototype.unlisten=_r.prototype.Ta,_r.prototype.listenOnce=_r.prototype.Qa,_r.prototype.listen=_r.prototype.o,_r.prototype.release=_r.prototype.release;function $0(i,l,c,p){this.target=i,this.type=l,this.listener=c,this.g=xS(i,p),this.target.addEventListener(l,c,this.g)}$0.prototype.Ta=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1};function xS(i,l){if(l==null)return!1;if(typeof l=="boolean")return l;var c=new Set(["passive","capture"]);return Object.keys(l).filter(function(p){return!c.has(p)}),CS(i)?l:l.capture||!1}function CS(i){var l=wp;if(l==null){l=!1;try{var c={},p={get:function(){return l=!0,!1}};Object.defineProperty(c,"passive",p),Object.defineProperty(c,"capture",p),p=function(){},i.addEventListener("test",p,c),i.removeEventListener("test",p,c)}catch{l=!1}wp=l}return l||!1}var wp=void 0;function H(){}function te(i){return i=ar(i),new pt(i).eb}function ce(i,l,c){function p(N){Ii(A).setUint32(P,N.byteLength,!0),P+=4,A.set(er(N),P),P+=N.byteLength}if(!c||!c.byteLength)throw new We(2,6,6015);var y;typeof l=="string"?y=ti(l,!0):y=l,i=ar(i),i=ti(i,!0);var A=new Uint8Array(12+i.byteLength+y.byteLength+c.byteLength),P=0;return p(i),p(y),p(c),A}Le("shaka.util.FairPlayUtils",H),H.initDataTransform=ce,H.defaultGetContentId=te;function le(i){for(var l=new Map,c=E(Object.keys(i)),p=c.next();!p.done;p=c.next())p=p.value,l.set(p,i[p]);return l}function ye(i){var l={};return i.forEach(function(c,p){l[p]=c}),l}function be(i,l){if(i||l){if(i&&!l||l&&!i)return!1}else return!0;if(i.size!=l.size)return!1;for(var c=E(i),p=c.next();!p.done;p=c.next()){var y=E(p.value);if(p=y.next().value,y=y.next().value,!l.has(p)||(p=l.get(p),p!=y||p==null))return!1}return!0}function Ge(i,l){var c=this;l=l===void 0?1:l,this.F=i,this.G=new Set,this.g=this.s=null,this.ia=this.ea=!1,this.I=0,this.i=null,this.h=new _r,this.j=new Map,this.C=[],this.B=new Rt,this.m=null,this.l=function(p){c.B.reject(p),i.onError(p)},this.ka=new Map,this.$=new Map,this.P=new kn(function(){return X5(c)}),this.L=!1,this.J=[],this.M=!1,this.ha=new kn(function(){J5(c)}).na(l),this.B.catch(function(){}),this.N=new Zl(function(){return Xe(c)}),this.S=!1}f=Ge.prototype,f.destroy=function(){return this.N.destroy()};function Xe(i){return Z(function(l){switch(l.g){case 1:return i.h.release(),i.h=null,i.B.reject(),i.ha.stop(),i.ha=null,i.P.stop(),i.P=null,I(l,rL(i),2);case 2:if(!i.g){l.D(3);break}return w(l,4),I(l,i.g.setMediaKeys(null),6);case 6:K(l,5);break;case 4:W(l);case 5:i.g=null;case 3:i.i=null,i.G.clear(),i.s=null,i.C=[],i.m=null,i.l=function(){},i.F=null,i.S=!1,U(l)}})}f.configure=function(i){this.m=i};function Je(i,l,c){return i.ia=!0,i.C=[],i.L=c,Bt(i,l)}function ot(i,l,c){return i.C=c,i.L=0<c.length,Bt(i,l)}function _t(i,l,c,p,y,A){var P=new Map;return y={audioCapabilities:y,videoCapabilities:A,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:l},y.drmInfos=[{keySystem:l,licenseServerUri:c,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:p,serverCertificateUri:"",initData:null,keyIds:null}],P.set(l,y),ll(i,P,[])}function Bt(i,l){var c,p,y,A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe;return Z(function(Ze){if(Ze.g==1){if(c=X0(i))for(p=E(l),y=p.next();!y.done;y=p.next())A=y.value,A.video&&(A.video.drmInfos=[c]),A.audio&&(A.audio.drmInfos=[c]);for(P=l.some(function(Qe){return!!(Qe.video&&Qe.video.drmInfos.length||Qe.audio&&Qe.audio.drmInfos.length)}),P||(N=le(i.m.servers),Z5(l,N)),G=E(l),y=G.next();!y.done;y=G.next())for(q=y.value,ae=iL(q),Te=E(ae),Ie=Te.next();!Ie.done;Ie=Te.next())Ne=Ie.value,eH(Ne,le(i.m.servers),le(i.m.advanced||{}));return I(Ze,nn(l,i.L,i.S),2)}return Ve=P||Object.keys(i.m.servers).length,Ve?(qe=ll(i,void 0,l),Ze.return(P?qe:qe.catch(function(){}))):(i.ea=!0,Ze.return(Promise.resolve()))})}f.Hc=function(i){var l=this,c,p;return Z(function(y){if(y.g==1)return l.s?(l.g=i,l.h.Qa(l.g,"play",function(){for(var A=E(l.J),P=A.next();!P.done;P=A.next())Ad(l,P.value);l.M=!0,l.J=[]}),"webkitCurrentPlaybackTargetIsWireless"in l.g&&l.h.o(l.g,"webkitcurrentplaybacktargetiswirelesschanged",function(){return rL(l)}),c=l.g.setMediaKeys(l.s),c=c.catch(function(A){return Promise.reject(new We(2,6,6003,A.message))}),I(y,c,2)):(l.h.Qa(i,"encrypted",function(){l.l(new We(2,6,6010))}),y.return());Pr(l.N),Kn(l),l.i.initData.length||l.C.length||(p=function(A){return Vn(l,A.initDataType,er(A.initData))},l.h.o(l.g,"encrypted",p)),U(y)})};function Sn(i){var l,c,p,y,A;return Z(function(P){switch(P.g){case 1:if(!i.s||!i.i)return P.return();if(!i.i.serverCertificateUri||i.i.serverCertificate&&i.i.serverCertificate.length){P.D(2);break}return l=Qs([i.i.serverCertificateUri],i.m.retryParameters),w(P,3),c=i.F.Wb.request(5,l),I(P,c.promise,5);case 5:p=P.h,i.i.serverCertificate=er(p.data),K(P,4);break;case 3:throw y=W(P),new We(2,6,6017,y);case 4:if(i.N.g)return P.return();case 2:return!i.i.serverCertificate||!i.i.serverCertificate.length?P.return():(w(P,6),I(P,i.s.setServerCertificate(i.i.serverCertificate),8));case 8:K(P,0);break;case 6:throw A=W(P),new We(2,6,6004,A.message)}})}function tn(i,l){var c,p,y;return Z(function(A){if(A.g==1)return I(A,Sd(i,l),2);if(A.g!=3)return c=A.h,c?(p=[],(y=i.j.get(c))&&(y.jb=new Rt,p.push(y.jb)),p.push(c.remove()),I(A,Promise.all(p),3)):A.return();i.j.delete(c),U(A)})}function Kn(i){for(var l=(i.i?i.i.initData:[])||[],c=E(l),p=c.next();!p.done;p=c.next())p=p.value,Vn(i,p.initDataType,p.initData);for(c=E(i.C),p=c.next();!p.done;p=c.next())Sd(i,p.value);return l.length||i.C.length||i.B.resolve(),i.B}function Vn(i,l,c){var p=i.j.values();p=E(p);for(var y=p.next();!y.done;y=p.next())if(Wi(c,y.value.initData)&&!pi("Tizen 2"))return;q0(i,l,c,i.i.sessionType)}function Ri(i){return i?!!i.match(/^com\.(microsoft|chromecast)\.playready/):!1}function ws(i){return i=i.j.keys(),i=Pe(i,function(l){return l.sessionId}),Array.from(i)}f.Lc=function(){var i=1/0,l=this.j.keys();l=E(l);for(var c=l.next();!c.done;c=l.next())c=c.value,isNaN(c.expiration)||(i=Math.min(i,c.expiration));return i},f.qd=function(){return ye(this.$)};function ll(i,l,c){var p,y,A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe;return Z(function(Ze){switch(Ze.g){case 1:if(p=new Map,c.length){y=z0(i,c,p),Ze.D(2);break}return I(Ze,Y0(i,l),3);case 3:y=Ze.h;case 2:if(A=y,!A)throw new We(2,6,6001);for(Pr(i.N),w(Ze,4),i.G.clear(),P=A.getConfiguration(),N=P.audioCapabilities||[],G=P.videoCapabilities||[],q=E(N),ae=q.next();!ae.done;ae=q.next())Te=ae.value,i.G.add(Te.contentType.toLowerCase());for(Ie=E(G),ae=Ie.next();!ae.done;ae=Ie.next())Ne=ae.value,i.G.add(Ne.contentType.toLowerCase());if(c.length){var Qe=A.keySystem,Lt=p.get(A.keySystem),It=[],yt=[],Jt=[],un=[],dn=new Set;sL(Lt,It,Jt,yt,un,dn);var xn=i.L?"persistent-license":"temporary";for(Qe={keySystem:Qe,licenseServerUri:It[0],distinctiveIdentifierRequired:Lt[0].distinctiveIdentifierRequired,persistentStateRequired:Lt[0].persistentStateRequired,sessionType:Lt[0].sessionType||xn,audioRobustness:Lt[0].audioRobustness||"",videoRobustness:Lt[0].videoRobustness||"",serverCertificate:Jt[0],serverCertificateUri:yt[0],initData:un,keyIds:dn},Lt=E(Lt),It=Lt.next();!It.done;It=Lt.next())It=It.value,It.distinctiveIdentifierRequired&&(Qe.distinctiveIdentifierRequired=It.distinctiveIdentifierRequired),It.persistentStateRequired&&(Qe.persistentStateRequired=It.persistentStateRequired);Lt=Qe}else Lt=A.keySystem,Qe=l.get(A.keySystem),It=[],yt=[],Jt=[],un=[],dn=new Set,sL(Qe.drmInfos,It,Jt,yt,un,dn),Lt={keySystem:Lt,licenseServerUri:It[0],distinctiveIdentifierRequired:Qe.distinctiveIdentifier=="required",persistentStateRequired:Qe.persistentState=="required",sessionType:Qe.sessionTypes[0]||"temporary",audioRobustness:(Qe.audioCapabilities?Qe.audioCapabilities[0].robustness:"")||"",videoRobustness:(Qe.videoCapabilities?Qe.videoCapabilities[0].robustness:"")||"",serverCertificate:Jt[0],serverCertificateUri:yt[0],initData:un,keyIds:dn};if(i.i=Lt,!i.i.licenseServerUri)throw new We(2,6,6012,i.i.keySystem);return I(Ze,A.createMediaKeys(),6);case 6:return Ve=Ze.h,Pr(i.N),i.s=Ve,i.ea=!0,I(Ze,Sn(i),7);case 7:Pr(i.N),K(Ze,0);break;case 4:throw qe=W(Ze),Pr(i.N,qe),i.i=null,i.G.clear(),qe instanceof We?qe:new We(2,6,6002,qe.message)}})}function z0(i,l,c){for(var p=E(l),y=p.next();!y.done;y=p.next()){var A=E(iL(y.value));for(y=A.next();!y.done;y=A.next())y=y.value,c.has(y.keySystem)||c.set(y.keySystem,[]),c.get(y.keySystem).push(y)}if(c.size==1&&c.has(""))throw new We(2,6,6e3);for(p={},i=E(i.m.preferredKeySystems),y=i.next();!y.done;p={Pd:p.Pd},y=i.next())for(p.Pd=y.value,A=E(l),y=A.next();!y.done;y=A.next())if(y=y.value.decodingInfos.find(function(q){return function(ae){return ae.supported&&ae.keySystemAccess!=null&&ae.keySystemAccess.keySystem==q.Pd}}(p)))return y.keySystemAccess;for(i=E([!0,!1]),y=i.next();!y.done;y=i.next())for(p=y.value,A=E(l),y=A.next();!y.done;y=A.next()){var P=E(y.value.decodingInfos);for(y=P.next();!y.done;y=P.next()){var N=y.value;if(N.supported&&N.keySystemAccess){y=c.get(N.keySystemAccess.keySystem);var G=E(y);for(y=G.next();!y.done;y=G.next())if(!!y.value.licenseServerUri==p)return N.keySystemAccess}}}return null}function Y0(i,l){var c,p,y,A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe,Ze;return Z(function(Qe){switch(Qe.g){case 1:if(l.size==1&&l.has(""))throw new We(2,6,6e3);for(p=E(l.values()),y=p.next();!y.done;y=p.next())A=y.value,A.audioCapabilities.length==0&&delete A.audioCapabilities,A.videoCapabilities.length==0&&delete A.videoCapabilities;P=E(i.m.preferredKeySystems),N=P.next();case 2:if(N.done){Qe.D(4);break}if(G=N.value,!l.has(G)){Qe.D(3);break}return q=l.get(G),w(Qe,6),I(Qe,navigator.requestMediaKeySystemAccess(G,[q]),8);case 8:return c=Qe.h,Qe.return(c);case 6:W(Qe);case 7:Pr(i.N);case 3:N=P.next(),Qe.D(2);break;case 4:ae=E([!0,!1]),Te=ae.next();case 9:if(Te.done){Qe.D(11);break}Ie=Te.value,Ne=E(l.keys()),N=Ne.next();case 12:if(N.done){Te=ae.next(),Qe.D(9);break}if(Ve=N.value,qe=l.get(Ve),Ze=qe.drmInfos.some(function(Lt){return!!Lt.licenseServerUri}),Ze!=Ie){Qe.D(13);break}return w(Qe,15),I(Qe,navigator.requestMediaKeySystemAccess(Ve,[qe]),17);case 17:return c=Qe.h,Qe.return(c);case 15:W(Qe);case 16:Pr(i.N);case 13:N=Ne.next(),Qe.D(12);break;case 11:return Qe.return(c)}})}function X0(i){if(i=le(i.m.clearKeys),i.size==0)return null;var l=[],c=[];i.forEach(function(y,A){var P=zc(A),N=zc(y);P={kty:"oct",kid:Ia(P,!1),k:Ia(N,!1)},l.push(P),c.push(P.kid)}),i=JSON.stringify({keys:l});var p=JSON.stringify({kids:c});return p=[{initData:er(hi(p)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+o.btoa(i),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:p,keyIds:new Set(c)}}function Sd(i,l){var c,p,y,A,P;return Z(function(N){switch(N.g){case 1:try{c=i.s.createSession("persistent-license")}catch(G){return p=new We(2,6,6005,G.message),i.l(p),N.return(Promise.reject(p))}return i.h.o(c,"message",function(G){i.g&&i.m.delayLicenseRequestUntilPlayed&&i.g.paused&&!i.M?i.J.push(G):Ad(i,G)}),i.h.o(c,"keystatuseschange",function(G){return nL(i,G)}),y={initData:null,loaded:!1,pe:1/0,jb:null,type:"persistent-license"},i.j.set(c,y),w(N,2),I(N,c.load(l),4);case 4:return A=N.h,Pr(i.N),A?(y.loaded=!0,IS(i)&&i.B.resolve(),N.return(c)):(i.j.delete(c),i.l(new We(2,6,6013)),N.return(Promise.resolve()));case 2:P=W(N),Pr(i.N,P),i.j.delete(c),i.l(new We(2,6,6005,P.message));case 3:return N.return(Promise.resolve())}})}function q0(i,l,c,p){try{var y=i.s.createSession(p)}catch(A){i.l(new We(2,6,6005,A.message));return}i.h.o(y,"message",function(A){i.g&&i.m.delayLicenseRequestUntilPlayed&&i.g.paused&&!i.M?i.J.push(A):Ad(i,A)}),i.h.o(y,"keystatuseschange",function(A){return nL(i,A)}),i.j.set(y,{initData:c,loaded:!1,pe:1/0,jb:null,type:p});try{c=i.m.initDataTransform(c,l,i.i)}catch(A){l=A,A instanceof We||(l=new We(2,6,6016,A)),i.l(l);return}i.m.logLicenseExchange&&Ia(c),y.generateRequest(l,c).catch(function(A){if(!i.N.g){i.j.delete(y);var P=A.errorCode;if(P&&P.systemCode){var N=P.systemCode;0>N&&(N+=Math.pow(2,32)),N="0x"+N.toString(16)}i.l(new We(2,6,6006,A.message,A,N))}})}function gi(i,l,c){return l=="skd"&&(l=c.serverCertificate,c=te(i),i=ce(i,c,l)),i}function Ad(i,l){var c,p,y,A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe;Z(function(Ze){switch(Ze.g){case 1:return c=l.target,i.m.logLicenseExchange&&Ia(l.message),p=i.j.get(c),y=i.i.licenseServerUri,A=i.m.advanced[i.i.keySystem],l.messageType=="individualization-request"&&A&&A.individualizationServer&&(y=A.individualizationServer),P=Qs([y],i.m.retryParameters),P.body=l.message,P.method="POST",P.licenseRequestType=l.messageType,P.sessionId=c.sessionId,Ri(i.i.keySystem)&&eu(P),N=Date.now(),w(Ze,2),q=i.F.Wb.request(2,P),I(Ze,q.promise,4);case 4:G=Ze.h,K(Ze,3);break;case 2:return ae=W(Ze),Te=new We(2,6,6007,ae),i.l(Te),p&&p.jb&&p.jb.reject(Te),Ze.return();case 3:return i.N.g?Ze.return():(i.I+=(Date.now()-N)/1e3,i.m.logLicenseExchange&&Ia(G.data),w(Ze,5),I(Ze,c.update(G.data),7));case 7:K(Ze,6);break;case 5:return Ie=W(Ze),Ne=new We(2,6,6008,Ie.message),i.l(Ne),p&&p.jb&&p.jb.reject(Ne),Ze.return();case 6:Ve=new De("drmsessionupdate"),i.F.onEvent(Ve),p&&(p.jb&&p.jb.resolve(),qe=new kn(function(){p.loaded=!0,IS(i)&&i.B.resolve()}),qe.U(nH)),U(Ze)}})}function eu(i){var l=Xn(i.body,!0,!0);if(l.includes("PlayReadyKeyMessage")){l=new DOMParser().parseFromString(l,"application/xml");for(var c=E(l.getElementsByTagName("HttpHeader")),p=c.next();!p.done;p=c.next())p=p.value,i.headers[p.getElementsByTagName("name")[0].textContent]=p.getElementsByTagName("value")[0].textContent;i.body=Xa(l.getElementsByTagName("Challenge")[0].textContent)}else i.headers["Content-Type"]="text/xml; charset=utf-8"}function nL(i,l){var c=l.target,p=i.j.get(c),y=!1;c.keyStatuses.forEach(function(P,N){if(typeof N=="string"){var G=N;N=P,P=G}if(Ri(i.i.keySystem)&&N.byteLength==16&&navigator.userAgent.match(/Edge?\//)){G=Ii(N);var q=G.getUint32(0,!0),ae=G.getUint16(4,!0),Te=G.getUint16(6,!0);G.setUint32(0,q,!1),G.setUint16(4,ae,!1),G.setUint16(6,Te,!1)}P!="status-pending"&&(p.loaded=!0),P=="expired"&&(y=!0),G=Wl(N),i.ka.set(G,P)});var A=c.expiration-Date.now();(0>A||y&&1e3>A)&&p&&!p.jb&&(i.j.delete(c),c.close().catch(function(){})),IS(i)&&(i.B.resolve(),i.P.U(rH))}function X5(i){var l=i.ka,c=i.$;c.clear(),l.forEach(function(p,y){return c.set(y,p)}),l=Array.from(c.values()),l.length&&l.every(function(p){return p=="expired"})&&i.l(new We(2,6,6014)),i.F.wd(ye(c))}function q5(){var i,l,c,p,y,A,P,N;return Z(function(G){return G.g==1?(i="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.microsoft.playready.recommendation com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" "),l=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],c={initDataTypes:["cenc"],videoCapabilities:l},p={videoCapabilities:l,persistentState:"required",sessionTypes:["persistent-license"]},y=[p,c],A=new Map,P=function(q){var ae,Te,Ie;return Z(function(Ne){switch(Ne.g){case 1:return w(Ne,2),I(Ne,navigator.requestMediaKeySystemAccess(q,y),4);case 4:return ae=Ne.h,Ie=(Te=ae.getConfiguration().sessionTypes)?Te.includes("persistent-license"):!1,pi("Tizen 3")&&(Ie=!1),A.set(q,{persistentState:Ie}),I(Ne,ae.createMediaKeys(),5);case 5:K(Ne,0);break;case 2:W(Ne),A.set(q,null),U(Ne)}})},N=i.map(function(q){return P(q)}),I(G,Promise.all(N),2)):G.return(ye(A))})}function Q5(i){var l;return Z(function(c){if(c.g==1)return l=new Promise(function(p,y){new kn(y).U(tH)}),w(c,2),I(c,Promise.race([Promise.all([i.close(),i.closed]),l]),4);if(c.g!=2)return K(c,0);W(c),U(c)})}function rL(i){var l;return Z(function(c){return l=Array.from(i.j.entries()),i.j.clear(),I(c,Promise.all(l.map(function(p){p=E(p);var y=p.next().value,A=p.next().value;return Z(function(P){if(P.g==1)return w(P,2),i.ia||i.C.includes(y.sessionId)||A.type!=="persistent-license"?I(P,Q5(y),5):I(P,y.remove(),5);if(P.g!=2)return K(P,0);W(P),U(P)})})),0)})}function Q0(i,l){if(!i.length)return l;if(!l.length)return i;for(var c=[],p=E(i),y=p.next();!y.done;y=p.next()){y=y.value;for(var A={},P=E(l),N=P.next();!N.done;A={Za:A.Za},N=P.next())if(N=N.value,y.keySystem==N.keySystem){A.Za=[],A.Za=A.Za.concat(y.initData||[]),A.Za=A.Za.concat(N.initData||[]),A.Za=A.Za.filter(function(G){return function(q,ae){return q.keyId===void 0||ae===G.Za.findIndex(function(Te){return Te.keyId===q.keyId})}}(A)),P=y.keyIds&&N.keyIds?new Set([].concat(T(y.keyIds),T(N.keyIds))):y.keyIds||N.keyIds,c.push({keySystem:y.keySystem,licenseServerUri:y.licenseServerUri||N.licenseServerUri,distinctiveIdentifierRequired:y.distinctiveIdentifierRequired||N.distinctiveIdentifierRequired,persistentStateRequired:y.persistentStateRequired||N.persistentStateRequired,videoRobustness:y.videoRobustness||N.videoRobustness,audioRobustness:y.audioRobustness||N.audioRobustness,serverCertificate:y.serverCertificate||N.serverCertificate,serverCertificateUri:y.serverCertificateUri||N.serverCertificateUri,initData:A.Za,keyIds:P});break}}return c}function iL(i){return(i.video?i.video.drmInfos:[]).concat(i.audio?i.audio.drmInfos:[])}function J5(i){i.j.forEach(function(l,c){var p=l.pe,y=c.expiration;isNaN(y)&&(y=1/0),y!=p&&(i.F.onExpirationUpdated(c.sessionId,y),l.pe=y)})}function IS(i){return i=i.j.values(),he(i,function(l){return l.loaded})}function Z5(i,l){var c=[];l.forEach(function(A,P){c.push({keySystem:P,licenseServerUri:A,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})});for(var p=E(i),y=p.next();!y.done;y=p.next())y=y.value,y.video&&(y.video.drmInfos=c),y.audio&&(y.audio.drmInfos=c)}function sL(i,l,c,p,y,A){var P={};i=E(i);for(var N=i.next();!N.done;P={La:P.La},N=i.next()){if(P.La=N.value,l.includes(P.La.licenseServerUri)||l.push(P.La.licenseServerUri),p.includes(P.La.serverCertificateUri)||p.push(P.La.serverCertificateUri),P.La.serverCertificate&&(c.some(function(ae){return function(Te){return Wi(Te,ae.La.serverCertificate)}}(P))||c.push(P.La.serverCertificate)),P.La.initData){N={};for(var G=E(P.La.initData),q=G.next();!q.done;N={dd:N.dd},q=G.next())N.dd=q.value,y.some(function(ae){return function(Te){var Ie=ae.dd;return Te.keyId&&Te.keyId==Ie.keyId?!0:Te.initDataType==Ie.initDataType&&Wi(Te.initData,Ie.initData)}}(N))||y.push(N.dd)}if(P.La.keyIds)for(N=E(P.La.keyIds),G=N.next();!G.done;G=N.next())A.add(G.value)}}function eH(i,l,c){i.keySystem&&(i.keySystem!="org.w3.clearkey"||!i.licenseServerUri)&&(l.size&&(l=l.get(i.keySystem)||"",i.licenseServerUri=l),i.keyIds||(i.keyIds=new Set),(c=c.get(i.keySystem))&&(i.distinctiveIdentifierRequired||(i.distinctiveIdentifierRequired=c.distinctiveIdentifierRequired),i.persistentStateRequired||(i.persistentStateRequired=c.persistentStateRequired),i.videoRobustness||(i.videoRobustness=c.videoRobustness),i.audioRobustness||(i.audioRobustness=c.audioRobustness),i.serverCertificate||(i.serverCertificate=c.serverCertificate),c.sessionType&&(i.sessionType=c.sessionType),i.serverCertificateUri||(i.serverCertificateUri=c.serverCertificateUri)),o.cast&&o.cast.__platform__&&i.keySystem=="com.microsoft.playready"&&(i.keySystem="com.chromecast.playready"))}var tH=1,nH=5,rH=.5,xd=new an(function(){return Hi(new Uint8Array([0]))});function J0(){}function aL(i,l,c,p){var y,A,P,N;return Z(function(G){if(G.g==1)return p&&(y=qa[p.toLowerCase()])?G.return(y):(A=af(i))&&(P=of[A])?G.return(P):p?G.D(2):I(G,oL(i,l,c),3);if(G.g!=2&&(p=G.h)&&(N=qa[p]))return G.return(N);throw new We(2,4,4e3,i)})}function oL(i,l,c){var p,y,A;return Z(function(P){return P.g==1?(p=Qs([i],c),p.method="HEAD",I(P,l.request(0,p).promise,2)):(y=P.h,A=y.headers["content-type"],P.return(A?A.toLowerCase().split(";").shift():""))})}function af(i){return i=new pt(i).Sa.split("/").pop().split("."),i.length==1?"":i.pop().toLowerCase()}Le("shaka.media.ManifestParser",J0),J0.unregisterParserByMime=function(i){delete qa[i]},J0.registerParserByMime=function(i,l){qa[i]=l},J0.registerParserByExtension=function(i,l){of[i]=l};var qa={},of={};function yr(i,l){this.X=Ii(i),this.h=l==lL,this.g=0}f=yr.prototype,f.Ia=function(){return this.g<this.X.byteLength},f.qa=function(){return this.g},f.og=function(){return this.X.byteLength},f.ra=function(){try{var i=this.X.getUint8(this.g);return this.g+=1,i}catch{throw tu()}},f.wc=function(){try{var i=this.X.getUint16(this.g,this.h);return this.g+=2,i}catch{throw tu()}},f.T=function(){try{var i=this.X.getUint32(this.g,this.h);return this.g+=4,i}catch{throw tu()}},f.wf=function(){try{var i=this.X.getInt32(this.g,this.h);return this.g+=4,i}catch{throw tu()}},f.xc=function(){try{if(this.h)var i=this.X.getUint32(this.g,!0),l=this.X.getUint32(this.g+4,!0);else l=this.X.getUint32(this.g,!1),i=this.X.getUint32(this.g+4,!1)}catch{throw tu()}if(2097151<l)throw new We(2,3,3001);return this.g+=8,l*Math.pow(2,32)+i},f.Lb=function(i){if(this.g+i>this.X.byteLength)throw tu();var l=er(this.X,this.g,i);return this.g+=i,l},f.skip=function(i){if(this.g+i>this.X.byteLength)throw tu();this.g+=i},f.yf=function(i){if(this.g<i)throw tu();this.g-=i},f.seek=function(i){if(0>i||i>this.X.byteLength)throw tu();this.g=i},f.Wc=function(){for(var i=this.g;this.Ia()&&this.X.getUint8(this.g)!=0;)this.g+=1;return i=er(this.X,i,this.g-i),this.g+=1,Cn(i)};function tu(){return new We(2,3,3e3)}Le("shaka.util.DataViewReader",yr),yr.prototype.readTerminatedString=yr.prototype.Wc,yr.prototype.seek=yr.prototype.seek,yr.prototype.rewind=yr.prototype.yf,yr.prototype.skip=yr.prototype.skip,yr.prototype.readBytes=yr.prototype.Lb,yr.prototype.readUint64=yr.prototype.xc,yr.prototype.readInt32=yr.prototype.wf,yr.prototype.readUint32=yr.prototype.T,yr.prototype.readUint16=yr.prototype.wc,yr.prototype.readUint8=yr.prototype.ra,yr.prototype.getLength=yr.prototype.og,yr.prototype.getPosition=yr.prototype.qa,yr.prototype.hasMoreData=yr.prototype.Ia;var lL=1;yr.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:lL};function Lr(){this.i=[],this.h=[],this.g=!1}f=Lr.prototype,f.box=function(i,l){var c=uL(i);return this.i[c]=iH,this.h[c]=l,this},f.Z=function(i,l){var c=uL(i);return this.i[c]=fL,this.h[c]=l,this},f.stop=function(){this.g=!0},f.parse=function(i,l,c){for(i=new yr(i,0),this.g=!1;i.Ia()&&!this.g;)this.yd(0,i,l,c)},f.yd=function(i,l,c,p){var y=l.qa();if(p&&y+8>l.X.byteLength)this.g=!0;else{var A=l.T(),P=l.T(),N=!1;switch(A){case 0:A=l.X.byteLength-y;break;case 1:if(p&&l.qa()+8>l.X.byteLength){this.g=!0;return}A=l.xc(),N=!0}var G=this.h[P];if(G){var q=null,ae=null;if(this.i[P]==fL){if(p&&l.qa()+4>l.X.byteLength){this.g=!0;return}ae=l.T(),q=ae>>>24,ae&=16777215}P=y+A,c&&P>l.X.byteLength&&(P=l.X.byteLength),p&&P>l.X.byteLength?this.g=!0:(p=P-l.qa(),l=0<p?l.Lb(p):new Uint8Array(0),l=new yr(l,0),G({parser:this,partialOkay:c||!1,version:q,flags:ae,reader:l,size:A,start:y+i,has64BitSize:N}))}else l.skip(Math.min(y+A-l.qa(),l.X.byteLength-l.qa()))}};function $r(i){for(var l=ev(i);i.reader.Ia()&&!i.parser.g;)i.parser.yd(i.start+l,i.reader,i.partialOkay)}function Z0(i){var l=ev(i),c=i.reader.T();c=E($e(c));for(var p=c.next();!p.done&&(i.parser.yd(i.start+l,i.reader,i.partialOkay),!i.parser.g);p=c.next());}function Cd(i){return function(l){i(l.reader.Lb(l.reader.X.byteLength-l.reader.qa()))}}function uL(i){var l=0;i=E(i);for(var c=i.next();!c.done;c=i.next())l=l<<8|c.value.charCodeAt(0);return l}function cL(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function ev(i){return 8+(i.has64BitSize?8:0)+(i.flags!=null?4:0)}Le("shaka.util.Mp4Parser",Lr),Lr.headerSize=ev,Lr.typeToString=cL,Lr.allData=Cd,Lr.sampleDescription=Z0,Lr.children=$r,Lr.prototype.parseNext=Lr.prototype.yd,Lr.prototype.parse=Lr.prototype.parse,Lr.prototype.stop=Lr.prototype.stop,Lr.prototype.fullBox=Lr.prototype.Z,Lr.prototype.box=Lr.prototype.box;var iH=0,fL=1;function sH(i){function l(){p=!0}function c(q){A.push(q),$r(q)}i=er(i);var p=!1,y,A=[],P=[];if(new Lr().box("moov",c).box("trak",c).box("mdia",c).box("minf",c).box("stbl",c).Z("stsd",function(q){y=q,A.push(q),Z0(q)}).Z("encv",l).Z("enca",l).Z("avc1",function(q){P.push({box:q,Sc:1701733238})}).Z("avc3",function(q){P.push({box:q,Sc:1701733238})}).Z("ac-3",function(q){P.push({box:q,Sc:1701733217})}).Z("ec-3",function(q){P.push({box:q,Sc:1701733217})}).Z("mp4a",function(q){P.push({box:q,Sc:1701733217})}).parse(i),p)return i;if(P.length==0||!y)throw Wl(i),new We(2,3,3019);P.reverse();for(var N=E(P),G=N.next();!G.done;G=N.next())G=G.value,i=aH(i,y,G.box,A,G.Sc);return i}function aH(i,l,c,p,y){var A=oH.value(),P=i.subarray(c.start,c.start+c.size),N=Ii(P),G=new Uint8Array(c.size+A.byteLength);for(G.set(P,0),P=Ii(G),P.setUint32(4,y),G.set(A,c.size),y=N.getUint32(4),P.setUint32(c.size+16,y),dL(G,0,G.byteLength),y=new Uint8Array(i.byteLength+G.byteLength),c=pi("Xbox One")?c.start:c.start+c.size,A=i.subarray(c),y.set(i.subarray(0,c)),y.set(G,c),y.set(A,c+G.byteLength),i=E(p),p=i.next();!p.done;p=i.next())p=p.value,dL(y,p.start,p.size+G.byteLength);return G=Ii(y,l.start),l=ev(l),i=G.getUint32(l),G.setUint32(l,i+1),y}function dL(i,l,c){i=Ii(i,l),l=i.getUint32(0),l!=0&&(l==1?(i.setUint32(8,c>>32),i.setUint32(12,c&4294967295)):i.setUint32(0,c))}var oH=new an(function(){return new Uint8Array([0,0,0,80,115,105,110,102,0,0,0,12,102,114,109,97,0,0,0,0,0,0,0,20,115,99,104,109,0,0,0,0,99,101,110,99,0,1,0,0,0,0,0,40,115,99,104,105,0,0,0,32,116,101,110,99,0,0,0,0,0,0,1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])});function hL(i,l,c,p,y){if(p>=y)return null;for(var A=-1,P=-1,N=0;N<c.length;N++)if(c[N].some(function(yt){return yt!=null&&yt.g.trim()!=""})){A=N;break}for(N=c.length-1;0<=N;N--)if(c[N].some(function(yt){return yt!=null&&yt.g.trim()!=""})){P=N;break}if(A===-1||P===-1)return null;for(var G=N=!1,q="white",ae="black",Te=RS(p,y,N,G,q,ae);A<=P;A++){for(var Ie=c[A],Ne=-1,Ve=-1,qe=0;qe<Ie.length;qe++)if(Ie[qe]!=null&&Ie[qe].g.trim()!==""){Ne=qe;break}for(qe=Ie.length-1;0<=qe;qe--)if(Ie[qe]!=null&&Ie[qe].g.trim()!==""){Ve=qe;break}if(Ne===-1||Ve===-1)Ie=pL(p,y),i.nestedCues.push(Ie);else{for(;Ne<=Ve;Ne++)if(qe=Ie[Ne]){var Ze=qe.l,Qe=qe.i,Lt=qe.j,It=qe.h;(Ze!=N||Qe!=G||Lt!=q||It!=ae)&&(Te.payload&&i.nestedCues.push(Te),Te=RS(p,y,Ze,Qe,Lt,It),N=Ze,G=Qe,q=Lt,ae=It),Te.payload+=qe.g}else Te.payload+=" ";Te.payload&&i.nestedCues.push(Te),A!==P&&(Te=pL(p,y),i.nestedCues.push(Te)),Te=RS(p,y,N,G,q,ae)}}return i.nestedCues.length?{cue:i,stream:l}:null}function RS(i,l,c,p,y,A){return i=new ft(i,l,""),c&&i.textDecoration.push("underline"),p&&(i.fontStyle="italic"),i.color=y,i.backgroundColor=A,i}function pL(i,l){var c=new ft(i,l,"");return c.lineBreak=!0,c}function gL(i,l,c,p,y){this.g=i,this.l=l,this.i=c,this.h=p,this.j=y}function bS(i,l){this.i=[],this.g=1,this.h=0,this.G=i,this.C=l,this.j=this.s=!1,this.l="white",this.B="black",Op(this)}function tv(i,l,c){return hL(new ft(l,c,""),"CC"+(i.G<<1|i.C+1),i.i,l,c)}function Op(i){nu(i,0,15),i.g=1}function Id(i,l,c){if(!(32>c||127<c)){var p="";switch(l){case Np:p=_L.has(c)?_L.get(c):String.fromCharCode(c);break;case vL:p=lH.get(c);break;case yL:i.i[i.g].pop(),p=uH.get(c);break;case EL:i.i[i.g].pop(),p=cH.get(c)}p&&i.i[i.g].push(new gL(p,i.s,i.j,i.B,i.l))}}function mL(i,l,c,p){if(l>=c)for(--p;0<=p;p--)i.i[l+p]=i.i[c+p].map(function(A){return A});else for(var y=0;y<p;y++)i.i[l+y]=i.i[c+y].map(function(A){return A})}function nu(i,l,c){for(var p=0;p<=c;p++)i.i[l+p]=[]}var Np=0,vL=1,yL=2,EL=3,_L=new Map([[39,"’"],[42,"á"],[92,"é"],[92,"é"],[94,"í"],[95,"ó"],[96,"ú"],[123,"ç"],[124,"÷"],[125,"Ñ"],[126,"ñ"],[127,"█"]]),lH=new Map([[48,"®"],[49,"°"],[50,"½"],[51,"¿"],[52,"™"],[53,"¢"],[54,"£"],[55,"♪"],[56,"à"],[57,"⠀"],[58,"è"],[59,"â"],[60,"ê"],[61,"î"],[62,"ô"],[63,"û"]]),uH=new Map([[32,"Á"],[33,"É"],[34,"Ó"],[35,"Ú"],[36,"Ü"],[37,"ü"],[38,"‘"],[39,"¡"],[40,"*"],[41,"'"],[42,"─"],[43,"©"],[44,"℠"],[45,"·"],[46,"“"],[47,"”"],[48,"À"],[49,"Â"],[50,"Ç"],[51,"È"],[52,"Ê"],[53,"Ë"],[54,"ë"],[55,"Î"],[56,"Ï"],[57,"ï"],[58,"Ô"],[59,"Ù"],[60,"ù"],[61,"Û"],[62,"«"],[63,"»"]]),cH=new Map([[32,"Ã"],[33,"ã"],[34,"Í"],[35,"Ì"],[36,"ì"],[37,"Ò"],[38,"ò"],[39,"Õ"],[40,"õ"],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,"Ä"],[49,"ä"],[50,"Ö"],[51,"ö"],[52,"ß"],[53,"¥"],[54,"¤"],[55,"│"],[56,"Å"],[57,"å"],[58,"Ø"],[59,"ø"],[60,"┌"],[61,"┐"],[62,"└"],[63,"┘"]]);function nv(i,l){this.h=fH,this.B=new bS(i,l),this.i=new bS(i,l),this.l=new bS(i,l),this.g=this.i,this.j=0,this.s=null}function DS(i,l,c){i.g=i.i;var p=i.g,y=null;return i.h!==rv&&i.h!==Fp&&(y=tv(p,i.j,c),c=i.i,c.g=0<c.h?c.h:0,nu(c,0,15),c=i.l,c.g=0<c.h?c.h:0,nu(c,0,15),p.g=15),i.h=rv,p.h=l,y}function TL(i){i.h=dH,i.g=i.l,i.g.h=0}function SL(i){me("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),i.g=i.B,i.h=Fp}var fH=0,dH=1,rv=3,Fp=4,hH="black green blue cyan red yellow magenta black".split(" "),AL="white green blue cyan red yellow magenta white_italics".split(" ");function xL(){this.l=!1,this.I=this.L=0,this.J=mH,this.i=[],this.g=this.h=this.j=0,this.G=this.B=!1,this.C="white",this.s="black",PS(this)}function PS(i){i.i=[];for(var l=0;15>l;l++)i.i.push(LS())}function LS(){for(var i=[],l=0;42>l;l++)i.push(null);return i}function lf(i,l){CL(i)&&(i.i[i.h][i.g]=new gL(l,i.G,i.B,i.s,i.C),i.g++)}function CL(i){var l=i.g<i.I&&0<=i.g;return i.h<i.L&&0<=i.h&&l}xL.prototype.isVisible=function(){return this.l};function uf(i,l,c){var p=new ft(i.j,l,"");return p.textAlign=i.J===pH?"left":i.J===gH?"right":yn,(c=hL(p,"svc"+c,i.i,i.j,l))&&(i.j=l),c}var pH=0,gH=1,mH=2;function vH(){this.i=[],this.h=null,this.g=0}function yH(i,l){l.type===3?(i.g=2*(l.value&63)-1,i.h=[]):i.h&&(0<i.g&&(i.h.push(l),i.g--),i.g===0&&(i.i.push(new iv(i.h)),i.h=null,i.g=0))}function iv(i){this.g=0,this.h=i}iv.prototype.Ia=function(){return this.g<this.h.length},iv.prototype.qa=function(){return this.g};function wi(i){if(!i.Ia())throw new We(2,2,3e3);return i.h[i.g++]}iv.prototype.skip=function(i){if(this.g+i>this.h.length)throw new We(2,2,3e3);this.g+=i};function EH(i){this.i=i,this.h=[null,null,null,null,null,null,null,null],this.g=null}function _H(i,l,c,p){if(128<=c&&135>=c)p=c&7,i.h[p]&&(i.g=i.h[p]);else{if(c===136){c=wi(l).value,l=null,c=E(kp(i,c));for(var y=c.next();!y.done;y=c.next())y=i.h[y.value],y.isVisible()&&(l=uf(y,p,i.i)),PS(y);return l}if(c===137)for(l=wi(l).value,l=E(kp(i,l)),c=l.next();!c.done;c=l.next())c=i.h[c.value],c.isVisible()||(c.j=p),c.l=!0;else{if(c===138){for(c=wi(l).value,l=null,c=E(kp(i,c)),y=c.next();!y.done;y=c.next())y=i.h[y.value],y.isVisible()&&(l=uf(y,p,i.i)),y.l=!1;return l}if(c===139){for(c=wi(l).value,l=null,c=E(kp(i,c)),y=c.next();!y.done;y=c.next())y=i.h[y.value],y.isVisible()?l=uf(y,p,i.i):y.j=p,y.l=!y.l;return l}if(c===140)return l=wi(l).value,IL(i,l,p);if(c===143)return p=IL(i,255,p),RL(i),p;if(c===144)l.skip(1),p=wi(l).value,i.g&&(i.g.B=0<(p&128),i.g.G=0<(p&64));else if(c===145)p=wi(l).value,c=wi(l).value,l.skip(1),i.g&&(l=bL((c&48)>>4,(c&12)>>2,c&3),i.g.C=bL((p&48)>>4,(p&12)>>2,p&3),i.g.s=l);else if(c===146)p=wi(l).value,l=wi(l).value,i.g&&(i=i.g,i.h=p&15,i.g=l&63);else if(c===151)l.skip(1),l.skip(1),p=wi(l).value,l.skip(1),i.g&&(i.g.J=p&3);else if(152<=c&&159>=c){if(c=(c&15)-8,y=i.h[c]!==null,!y){var A=new xL;A.j=p,i.h[c]=A}p=wi(l).value,wi(l),wi(l),A=wi(l).value;var P=wi(l).value;l=wi(l).value,y&&!(l&7)||(l=i.h[c],l.h=0,l.g=0,l.G=!1,l.B=!1,l.C="white",l.s="black"),l=i.h[c],l.l=0<(p&32),l.L=(A&15)+1,l.I=(P&63)+1,i.g=i.h[c]}}}return null}var kp=function i(l,c){var p;return ve(i,function(y){return y.g==1&&(p=0),y.g!=5?8>p?(c&1)===1&&l.h[p]?I(y,p,5):y.D(5):y.D(0):(c>>=1,p++,y.D(2))})};function IL(i,l,c){var p=null;l=E(kp(i,l));for(var y=l.next();!y.done;y=l.next()){y=y.value;var A=i.h[y];A.isVisible()&&(p=uf(A,c,i.i)),i.h[y]=null}return p}function RL(i){i.g=null,i.h=[null,null,null,null,null,null,null,null]}function bL(i,l,c){var p={0:0,1:0,2:1,3:1};return i=p[i],l=p[l],c=p[c],TH[i<<2|l<<1|c]}var DL=new Map([[32," "],[33," "],[37,"…"],[42,"Š"],[44,"Œ"],[48,"█"],[49,"‘"],[50,"’"],[51,"“"],[52,"”"],[53,"•"],[57,"™"],[58,"š"],[60,"œ"],[61,"℠"],[63,"Ÿ"],[118,"⅛"],[119,"⅜"],[120,"⅝"],[121,"⅞"],[122,"│"],[123,"┐"],[124,"└"],[125,"─"],[126,"┘"],[127,"┌"]]),TH="black blue green cyan red magenta yellow white".split(" ");function SH(){this.h=[],this.g=[],this.i=new vH,this.l=0,this.C=new Map([["CC1",new nv(0,0)],["CC2",new nv(0,1)],["CC3",new nv(1,0)],["CC4",new nv(1,1)]]),this.B=this.s=0,this.j=new Map,MS(this)}function MS(i){i.s=0,i.B=0,i=E(i.C.values());for(var l=i.next();!l.done;l=i.next())l=l.value,l.h=2,l.g=l.i,l.s=null,Op(l.i),Op(l.l),Op(l.B)}function AH(i){function l(A,P){return A.pts-P.pts||A.order-P.order}var c=[];i.h.sort(l),i.g.sort(l);for(var p=E(i.h),y=p.next();!y.done;y=p.next())(y=xH(i,y.value))&&c.push(y);for(p=E(i.g),y=p.next();!y.done;y=p.next())yH(i.i,y.value);for(p=E(i.i.i),y=p.next();!y.done;y=p.next())y=CH(i,y.value),c.push.apply(c,T(y));return i.i.i=[],i.h=[],i.g=[],c}function xH(i,l){var c=l.type;if((l.Wa&112)===16){var p=l.Wa>>3&1;c===0?i.s=p:i.B=p}if(c=i.C.get("CC"+(c<<1|(c?i.B:i.s)+1)),l.Wa===255&&l.rb===255||!l.Wa&&!l.rb||!PL(l.Wa)||!PL(l.rb))return 45<=++i.l&&MS(i),null;if(i.l=0,l.Wa&=127,l.rb&=127,!l.Wa&&!l.rb)return null;if(p=null,(l.Wa&112)===16)e:{var y=l.Wa;if(p=l.rb,c.s===(y<<8|p))c.s=null;else if(c.s=y<<8|p,(y&240)===16&&(p&192)===64){y=[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(y&7)<<1|p>>5&1];var A=(p&30)>>1,P="white",N=!1;if(7>A?P=AL[A]:A===7&&(N=!0),p=(p&1)===1,c.h!==Fp){if(A=c.g,c.h===rv&&y!==A.g){var G=1+y-A.h;mL(A,G,1+A.g-A.h,A.h),nu(A,0,G-1),nu(A,y+1,15-y)}A.g=y,c.g.s=p,c.g.j=N,c.g.l=P,c.g.B="black"}}else if((y&247)===17&&(p&240)===32)c.g.s=!1,c.g.j=!1,c.g.l="white",Id(c.g,Np,32),P=!1,y=AL[(p&14)>>1],y==="white_italics"&&(y="white",P=!0),c.g.s=(p&1)===1,c.g.j=P,c.g.l=y;else if((y&247)===16&&(p&240)===32||(y&247)===23&&(p&255)===45)P="black",!(y&7)&&(P=hH[(p&14)>>1]),c.g.B=P;else if((y&247)===17&&(p&240)===48)Id(c.g,vL,p);else if((y&246)===18&&(p&224)===32)Id(c.g,y&1?EL:yL,p);else if((y&246)===20&&(p&240)===32){switch(p=l.pts,y=null,l.rb){case 32:TL(c);break;case 33:c=c.g,c.i[c.g].pop();break;case 37:y=DS(c,2,p);break;case 38:y=DS(c,3,p);break;case 39:y=DS(c,4,p);break;case 40:Id(c.g,Np,32);break;case 41:c.h=2,c.g=c.i,c.g.h=0,c.j=p;break;case 42:Op(c.B),SL(c);break;case 43:SL(c);break;case 44:y=c.i,P=null,c.h!==Fp&&(P=tv(y,c.j,p)),nu(y,0,15),y=P;break;case 45:y=c.g,c.h!==rv?y=null:(P=tv(y,c.j,p),N=y.g-y.h+1,mL(y,N-1,N,y.h),nu(y,0,N-1),nu(y,y.g,15-y.g),c.j=p,y=P);break;case 46:nu(c.l,0,15);break;case 47:y=null,c.h!==Fp&&(y=tv(c.i,c.j,p)),P=c.l,c.l=c.i,c.i=P,TL(c),c.j=p}p=y;break e}p=null}else y=l.rb,Id(c.g,Np,l.Wa),Id(c.g,Np,y);return p}function CH(i,l){var c=[];try{for(;l.Ia();){var p=wi(l).value,y=(p&224)>>5,A=p&31;if(y===7&&A!=0&&(y=wi(l).value&63),y!=0){i.j.has(y)||i.j.set(y,new EH(y));for(var P=i.j.get(y),N=l.qa();l.qa()-N<A;){y=l;var G=wi(y),q=G.value,ae=G.pts;if(q===16){var Te=wi(y);q=q<<16|Te.value}if(0<=q&&31>=q){var Ie=ae;if(P.g){var Ne=P.g;switch(y=null,q){case 8:!CL(Ne)||0>=Ne.g&&0>=Ne.h||(0>=Ne.g?(Ne.g=Ne.I-1,Ne.h--):Ne.g--,Ne.i[Ne.h][Ne.g]=null);break;case 13:if(Ne.isVisible()&&(y=uf(Ne,Ie,P.i)),Ne.h+1>=Ne.L){Ie=Ne;for(var Ve=0,qe=1;15>qe;qe++,Ve++)Ie.i[Ve]=Ie.i[qe];for(qe=0;1>qe;qe++,Ve++)Ie.i[Ve]=LS()}else Ne.h++;Ne.g=0;break;case 14:Ne.isVisible()&&(y=uf(Ne,Ie,P.i)),Ne.i[Ne.h]=LS(),Ne.g=0;break;case 12:Ne.isVisible()&&(y=uf(Ne,Ie,P.i)),PS(Ne),Ie=Ne,Ie.h=0,Ie.g=0}var Ze=y}else Ze=null}else if(128<=q&&159>=q)Ze=_H(P,y,q,ae);else{if(4096<=q&&4127>=q)Ie=q&255,8<=Ie&&15>=Ie?y.skip(1):16<=Ie&&23>=Ie?y.skip(2):24<=Ie&&31>=Ie&&y.skip(3);else if(4224<=q&&4255>=q)Ie=q&255,128<=Ie&&135>=Ie?y.skip(4):136<=Ie&&143>=Ie&&y.skip(5);else if(32<=q&&127>=q)y=q,P.g&&(y===127?lf(P.g,"♪"):lf(P.g,String.fromCharCode(y)));else if(160<=q&&255>=q)P.g&&lf(P.g,String.fromCharCode(q));else if(4128<=q&&4223>=q){if(y=q&255,P.g)if(DL.has(y)){var Qe=DL.get(y);lf(P.g,Qe)}else lf(P.g,"_")}else 4256<=q&&4351>=q&&P.g&&((q&255)!=160?lf(P.g,"_"):lf(P.g,"[CC]"));Ze=null}(y=Ze)&&c.push(y)}}}}catch(Lt){if(Lt instanceof We&&Lt.code===3e3)me("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.");else throw Lt}return c}function PL(i){for(var l=0;i;)l^=i&1,i>>=1;return l===1}function IH(){}var RH=function i(l,c){var p,y,A,P;return ve(i,function(N){if(N.g==1){for(var G=c,q=0,ae=0;ae<G.length;)q==2&&G[ae]==3?(q=0,G=[].concat(T(G)),G.splice(ae,1),G=new Uint8Array(G)):G[ae]==0?q++:q=0,ae++;p=G,y=0}if(N.g!=4){if(!(y<p.length))return N.D(0);for(A=0;p[y]==255;)A+=255,y++;for(A+=p[y++],P=0;p[y]==255;)P+=255,y++;return P+=p[y++],A!=4?N.D(4):I(N,p.subarray(y,y+P),4)}return y+=P,N.D(2)})};function LL(i,l){var c=null,p=null,y=i.T();return l&1&&i.skip(8),l&2&&i.skip(4),l&8&&(c=i.T()),l&16&&(p=i.T()),{trackId:y,cf:c,Yf:p}}function wS(i,l){return{Xd:l==1?i.xc():i.T()}}function OS(i,l){return l==1?(i.skip(8),i.skip(8)):(i.skip(4),i.skip(4)),{timescale:i.T()}}function ML(i,l,c){var p=i.T(),y=[];c&1&&i.skip(4),c&4&&i.skip(4);for(var A=E($e(p)),P=A.next();!P.done;P=A.next())P={ye:null,sampleSize:null,Cd:null},c&256&&(P.ye=i.T()),c&512&&(P.sampleSize=i.T()),c&1024&&i.skip(4),c&2048&&(P.Cd=l==0?i.T():i.wf()),y.push(P);return{Vi:p,zf:y}}function NS(){this.j=new IH,this.i=new Map,this.h=this.g=0}NS.prototype.init=function(i){var l=this,c=[],p=[];if(new Lr().box("moov",$r).box("mvex",$r).Z("trex",function(y){var A=y.reader;A.skip(4),A.skip(4),y=A.T(),A=A.T(),l.g=y,l.h=A}).box("trak",$r).Z("tkhd",function(y){var A=y.reader;y.version==1?(A.skip(8),A.skip(8)):(A.skip(4),A.skip(4)),y=A.T(),c.push(y)}).box("mdia",$r).Z("mdhd",function(y){y=OS(y.reader,y.version),p.push(y.timescale)}).parse(i,!0),!c.length||!p.length||c.length!=p.length)throw new We(2,2,2010);c.forEach(function(y,A){l.i.set(y,p[A])})},NS.prototype.parse=function(i){var l=this,c=[],p=this.g,y=this.h,A=[],P=null,N=9e4;return new Lr().box("moof",$r).box("traf",$r).Z("trun",function(G){A=ML(G.reader,G.version,G.flags).zf}).Z("tfhd",function(G){G=LL(G.reader,G.flags),p=G.cf||l.g,y=G.Yf||l.h,G=G.trackId,l.i.has(G)&&(N=l.i.get(G))}).Z("tfdt",function(G){P=wS(G.reader,G.version).Xd}).box("mdat",function(G){if(P===null)throw new We(2,2,2010);G=G.reader;var q=P,ae=N,Te=p,Ie=y,Ne=A,Ve=0,qe=Ie;for(Ne.length&&(qe=Ne[0].sampleSize||Ie);G.Ia();){var Ze=G.T();if((G.ra()&31)==6){var Qe=0;Ne.length>Ve&&(Qe=Ne[Ve].Cd||0),Qe=(q+Qe)/ae;for(var Lt=E(RH(l.j,G.Lb(Ze-1))),It=Lt.next();!It.done;It=Lt.next())c.push({Wg:It.value,pts:Qe})}else G.skip(Ze-1);qe-=Ze+4,qe==0&&(q=Ne.length>Ve?q+(Ne[Ve].ye||Te):q+Te,Ve++,qe=Ne.length>Ve&&Ne[Ve].sampleSize||Ie)}}).parse(i,!1),c};function wL(){this.h=new NS,this.g=new SH}wL.prototype.init=function(i){this.h.init(i)};function bH(i,l){var c=i.h.parse(l);c=E(c);for(var p=c.next();!p.done;p=c.next()){var y=p.value,A=er(y.Wg);if(0<A.length&&(p=i.g,y=y.pts,A=new yr(A,0),A.ra()===181&&A.wc()===49&&A.T()===1195456820&&A.ra()===3)){var P=A.ra();if(P&64){P&=31,A.skip(1);for(var N=0;N<P;N++){var G=A.ra(),q=(G&4)>>2,ae=A.ra(),Te=A.ra();q&&(G&=3,G===0||G===1?p.h.push({pts:y,type:G,Wa:ae,rb:Te,order:p.h.length}):(p.g.push({pts:y,type:G,value:ae,order:p.g.length}),p.g.push({pts:y,type:2,value:Te,order:p.g.length})))}}}}return AH(i.g)}function FS(i){return!i||i.length==1&&1e-6>i.end(0)-i.start(0)?null:i.length?i.end(i.length-1):null}function kS(i,l,c){return c=c===void 0?0:c,!i||!i.length||i.length==1&&1e-6>i.end(0)-i.start(0)||l>i.end(i.length-1)?!1:l+c>=i.start(0)}function OL(i,l){if(!i||!i.length||i.length==1&&1e-6>i.end(0)-i.start(0))return 0;for(var c=0,p=E(Ju(i)),y=p.next();!y.done;y=p.next()){var A=y.value;y=A.start,A=A.end,A>l&&(c+=A-Math.max(y,l))}return c}function DH(i,l,c){return!i||!i.length||i.length==1&&1e-6>i.end(0)-i.start(0)?null:(i=Ju(i).findIndex(function(p,y,A){return p.start>l&&(y==0||A[y-1].end-l<=c)}),0<=i?i:null)}function Ju(i){if(!i)return[];for(var l=[],c=E($e(i.length)),p=c.next();!p.done;p=c.next())p=p.value,l.push({start:i.start(p),end:i.end(p)});return l}function NL(i,l,c,p){var y=this;this.g=i,this.s=c,this.j={},this.L={},this.i=null,this.M=p||function(){},this.l={},this.h=new _r,this.C={},this.G=l,this.I=new Rt,this.B=PH(this,this.I),this.N=new Zl(function(){return LH(y)}),this.J=""}function PH(i,l){var c=new MediaSource;return i.h.Qa(c,"sourceopen",function(){URL.revokeObjectURL(i.J),l.resolve()}),i.J=jS(c),i.g.src=i.J,c}f=NL.prototype,f.destroy=function(){return this.N.destroy()};function LH(i){var l,c,p,y,A,P,N,G;return Z(function(q){if(q.g==1){l=[];for(c in i.l)for(p=i.l[c],y=p[0],i.l[c]=p.slice(0,1),y&&l.push(y.p.catch(dt)),A=E(p.slice(1)),P=A.next();!P.done;P=A.next())N=P.value,N.p.reject(new We(2,7,7003,void 0));i.i&&l.push(i.i.destroy()),i.s&&l.push(i.s.destroy());for(G in i.C)l.push(i.C[G].destroy());return I(q,Promise.all(l),2)}i.h&&(i.h.release(),i.h=null),i.g&&(i.g.removeAttribute("src"),i.g.load(),i.g=null),i.B=null,i.i=null,i.s=null,i.j={},i.C={},i.G=null,i.l={},U(q)})}f.init=function(i,l){var c=this,p,y,A,P,N,G,q;return Z(function(ae){if(ae.g==1)return p=ut,I(ae,c.I,2);for(y={},A=E(i.keys()),P=A.next();!P.done;y={Oa:y.Oa},P=A.next())y.Oa=P.value,N=i.get(y.Oa),G=ui(N.mimeType,N.codecs),y.Oa==p.ua?Up(c,G):(!l&&MediaSource.isTypeSupported(G)||!Vl(G,y.Oa)||(c.C[y.Oa]=new Yc,G=Ra(y.Oa,G)),q=c.B.addSourceBuffer(G),c.h.o(q,"error",function(Te){return function(){c.l[Te.Oa][0].p.reject(new We(2,3,3014,c.g.error?c.g.error.code:0))}}(y)),c.h.o(q,"updateend",function(Te){return function(){return cf(c,Te.Oa)}}(y)),c.j[y.Oa]=q,c.L[y.Oa]=G,c.l[y.Oa]=[]);U(ae)})};function Up(i,l){i.i||(i.i=new ba(i.s)),l!="application/cea-608"&&l!="application/cea-708"&&(i.i.C=Ft(Hr[l]))}function FL(i){return i.B?i.B.readyState=="ended":!0}function kL(i,l){if(l==Ke)var c=i.i.g;else c=Rd(i,l),c=!c||c.length==1&&1e-6>c.end(0)-c.start(0)?null:c.length==1&&0>c.start(0)?0:c.length?c.start(0):null;return c}function sv(i,l){return l==Ke?i.i.h:FS(Rd(i,l))}function MH(i,l,c){return l==Ke?(i=i.i,i.h==null||i.h<c?0:i.h-Math.max(c,i.g)):(i=Rd(i,l),OL(i,c))}f.Ib=function(){var i={total:Ju(this.g.buffered),audio:Ju(Rd(this,"audio")),video:Ju(Rd(this,"video")),text:[]};if(this.i){var l=this.i.g,c=this.i.h;l!=null&&c!=null&&i.text.push({start:l,end:c})}return i};function Rd(i,l){try{return i.j[l].buffered}catch{return null}}function UL(i,l,c,p,y,A){var P,N,G,q,ae,Te,Ie,Ne;return Z(function(Ve){return Ve.g==1?(P=ut,l==P.ua?I(Ve,xp(i.i,c,p,y),0):i.C[l]?I(Ve,Hu(i.C[l],c),10):A?(i.i||Up(i,"text/vtt"),p==null&&y==null?i.G.init(c):(N=bH(i.G,c),N.length&&(G=i.j[P.mb].timestampOffset,So(i.i,N,p,y,G))),c=BS(i,c,p,l),I(Ve,ru(i,l,function(){i.j[l].appendBuffer(c)}),0)):(c=BS(i,c,p,l),I(Ve,ru(i,l,function(){i.j[l].appendBuffer(c)}),0))):(q=Ve.h,i.i||Up(i,"text/vtt"),q.metadata&&(ae=i.j[l].timestampOffset,i.M(q.metadata,ae,y)),q.captions&&q.captions.length&&(Te=i.j[P.mb].timestampOffset,Ie=Xc(q.captions),So(i.i,Ie,p,y,Te)),Ne=q.data,Ne=BS(i,Ne,p,l),I(Ve,ru(i,l,function(){i.j[l].appendBuffer(Ne)}),0))})}function wH(i,l){var c=sv(i,"video")||0;Vu(i.i,l,c)}function OH(i){i.i&&Vu(i.i,"",0)}f.remove=function(i,l,c){var p=this,y;return Z(function(A){return y=ut,i==y.ua?I(A,p.i.remove(l,c),0):I(A,ru(p,i,function(){c<=l?cf(p,i):p.j[i].remove(l,c)}),0)})};function BL(i,l){var c;return Z(function(p){return c=ut,l==c.ua?i.i?I(p,i.i.remove(0,1/0),0):p.return():I(p,ru(i,l,function(){var y=i.B.duration;0>=y?cf(i,l):i.j[l].remove(0,y)}),0)})}f.flush=function(i){var l=this,c;return Z(function(p){return c=ut,i==c.ua?p.return():I(p,ru(l,i,function(){l.g.currentTime-=.001,cf(l,i)}),0)})};function NH(i,l,c,p,y){var A;return Z(function(P){return A=ut,l==A.ua?(i.i.G=c,Cp(i.i,p,y),P.return()):I(P,Promise.all([ru(i,l,function(){var N=i.j[l].appendWindowStart,G=i.j[l].appendWindowEnd;i.j[l].abort(),i.j[l].appendWindowStart=N,i.j[l].appendWindowEnd=G,cf(i,l)}),ru(i,l,function(){var N=c;0>N&&(N+=.001),i.j[l].timestampOffset=N,cf(i,l)}),ru(i,l,function(){i.j[l].appendWindowStart=0,i.j[l].appendWindowEnd=y,i.j[l].appendWindowStart=p,cf(i,l)})]),0)})}f.endOfStream=function(i){var l=this;return Z(function(c){return I(c,jL(l,function(){FL(l)||(i?l.B.endOfStream(i):l.B.endOfStream())}),0)})},f.ib=function(i){var l=this;return Z(function(c){return I(c,jL(l,function(){l.B.duration=i}),0)})},f.getDuration=function(){return this.B.duration};function cf(i,l){var c=i.l[l][0];c&&(c.p.resolve(),US(i,l))}function ru(i,l,c){return Pr(i.N),c={start:c,p:new Rt},i.l[l].push(c),i.l[l].length==1&&KL(i,l),c.p}function jL(i,l){var c,p,y,A,P,N;return Z(function(G){switch(G.g){case 1:Pr(i.N),c=[],p={};for(y in i.j)p.Dc=new Rt,A={start:function(q){return function(){return q.Dc.resolve()}}(p),p:p.Dc},i.l[y].push(A),c.push(p.Dc),i.l[y].length==1&&A.start(),p={Dc:p.Dc};return w(G,2),I(G,Promise.all(c),4);case 4:K(G,3);break;case 2:throw P=W(G),P;case 3:try{l()}catch(q){throw new We(2,3,3015,q)}finally{for(N in i.j)US(i,N)}U(G)}})}function US(i,l){i.l[l].shift(),KL(i,l)}function KL(i,l){var c=i.l[l][0];if(c)try{c.start()}catch(p){p.name=="QuotaExceededError"?c.p.reject(new We(2,3,3017,l)):c.p.reject(new We(2,3,3015,p)),US(i,l)}}function BS(i,l,c,p){var y=i.g.mediaKeys;return c==null&&y&&(Pa()||pi("Xbox One"))&&i.L[p].split(";")[0].split("/")[1]=="mp4"&&(l=sH(l)),l}var jS=o.URL.createObjectURL;function Js(i,l,c,p){this.Ma=i,this.Ka=l,this.Da=c,this.ge=p===void 0?null:p}Js.prototype.Oc=function(){return this.Ka},Js.prototype.Kc=function(){return this.Da};function FH(i,l){return i&&l?i.Oc()==l.Oc()&&i.Kc()==l.Kc()&&He(i.Ma(),l.Ma()):i==l}Le("shaka.media.InitSegmentReference",Js),Js.prototype.getEndByte=Js.prototype.Kc,Js.prototype.getStartByte=Js.prototype.Oc;function Gr(i,l,c,p,y,A,P,N,G,q,ae,Te){q=q===void 0?[]:q,this.startTime=i,this.l=this.endTime=l,this.j=c,this.Ka=p,this.Da=y,this.g=A,this.timestampOffset=P,this.appendWindowStart=N,this.appendWindowEnd=G,this.h=q,this.tilesLayout=ae===void 0?"":ae,this.i=Te===void 0?null:Te}f=Gr.prototype,f.Ma=function(){return this.j()},f.Bg=function(){return this.startTime},f.mg=function(){return this.endTime},f.Oc=function(){return this.Ka},f.Kc=function(){return this.Da},f.Hg=function(){return this.tilesLayout},f.Gg=function(){return this.i},Le("shaka.media.SegmentReference",Gr),Gr.prototype.getTileDuration=Gr.prototype.Gg,Gr.prototype.getTilesLayout=Gr.prototype.Hg,Gr.prototype.getEndByte=Gr.prototype.Kc,Gr.prototype.getStartByte=Gr.prototype.Oc,Gr.prototype.getEndTime=Gr.prototype.mg,Gr.prototype.getStartTime=Gr.prototype.Bg,Gr.prototype.getUris=Gr.prototype.Ma;function Wn(i,l,c){this.j=i,this.zd=l,this.s=this.l=1/0,this.g=1,this.h=this.i=null,this.B=0,this.C=!0,this.G=0,this.I=c===void 0?!0:c,this.J=0}f=Wn.prototype,f.getDuration=function(){return this.l},f.vg=function(){return this.g},f.ib=function(i){this.l=i},f.zg=function(){return this.j},f.Cf=function(i){this.B=i},f.Zc=function(i){this.C=i},f.Ie=function(i){this.s=i},f.nh=function(i){this.zd=i},f.lg=function(){return this.zd},f.tc=function(i){if(i.length!=0){var l=i[i.length-1].endTime;this.me(i[0].startTime),this.g=i.reduce(function(c,p){return Math.max(c,p.endTime-p.startTime)},this.g),this.h=Math.max(this.h,l),this.j!=null&&this.I&&(this.j=(Date.now()+this.B)/1e3-this.h-this.g)}},f.me=function(i){this.i=this.i==null?i:Math.min(this.i,i)},f.le=function(i){this.g=Math.max(this.g,i)},f.offset=function(i){this.i!=null&&(this.i+=i),this.h!=null&&(this.h+=i)},f.W=function(){return this.l==1/0&&!this.C},f.Tb=function(){return this.l!=1/0&&!this.C},f.ub=function(){return Math.max(this.G,this.Qb()-this.s)},f.Ff=function(i){this.G=i},f.Qb=function(){return this.W()||this.Tb()?Math.min(Math.max(0,(Date.now()+this.B)/1e3-this.g-this.j)+this.J,this.l):this.h||this.l},f.Nc=function(i){var l=Math.max(this.i,this.G);return this.s==1/0?Math.ceil(1e3*l)/1e3:Math.max(l,Math.min(this.Qb()-this.s+i,this.sb()))},f.mc=function(){return this.Nc(0)},f.sb=function(){return Math.max(0,this.Qb()-(this.W()||this.Tb()?this.zd:0))},f.Kf=function(){return!(this.j==null||this.h!=null&&this.I)},f.Bf=function(i){this.J=i},Le("shaka.media.PresentationTimeline",Wn),Wn.prototype.setAvailabilityTimeOffset=Wn.prototype.Bf,Wn.prototype.usingPresentationStartTime=Wn.prototype.Kf,Wn.prototype.getSeekRangeEnd=Wn.prototype.sb,Wn.prototype.getSeekRangeStart=Wn.prototype.mc,Wn.prototype.getSafeSeekRangeStart=Wn.prototype.Nc,Wn.prototype.getSegmentAvailabilityEnd=Wn.prototype.Qb,Wn.prototype.setUserSeekStart=Wn.prototype.Ff,Wn.prototype.getSegmentAvailabilityStart=Wn.prototype.ub,Wn.prototype.isInProgress=Wn.prototype.Tb,Wn.prototype.isLive=Wn.prototype.W,Wn.prototype.offset=Wn.prototype.offset,Wn.prototype.notifyMaxSegmentDuration=Wn.prototype.le,Wn.prototype.notifyMinSegmentStartTime=Wn.prototype.me,Wn.prototype.notifySegments=Wn.prototype.tc,Wn.prototype.getDelay=Wn.prototype.lg,Wn.prototype.setDelay=Wn.prototype.nh,Wn.prototype.setSegmentAvailabilityDuration=Wn.prototype.Ie,Wn.prototype.setStatic=Wn.prototype.Zc,Wn.prototype.setClockOffset=Wn.prototype.Cf,Wn.prototype.getPresentationStartTime=Wn.prototype.zg,Wn.prototype.setDuration=Wn.prototype.ib,Wn.prototype.getMaxSegmentDuration=Wn.prototype.vg,Wn.prototype.getDuration=Wn.prototype.getDuration;function GL(i,l){this.j=i,this.s=WL(i),this.g=i.g.currentTime,this.l=Date.now()/1e3,this.h=!1,this.B=l,this.i=function(){}}GL.prototype.release=function(){this.j=null,this.i=function(){}};function kH(i,l){i.i=l}function UH(i){this.g=i}function WL(i){if(i.g.paused||i.g.playbackRate==0||i.g.buffered.length==0)var l=!1;else e:{l=i.g.currentTime,i=E(Ju(i.g.buffered));for(var c=i.next();!c.done;c=i.next())if(c=c.value,!(l<c.start-.1||l>c.end-.5)){l=!0;break e}l=!1}return l}function KS(i,l,c,p,y){var A=this;this.g=i,this.G=l,this.m=c,this.C=y,this.h=new _r,this.B=!1,this.I=i.readyState,this.j=!1,this.i=p,this.s=!1,this.h.o(i,"waiting",function(){return GS(A)}),this.l=new kn(function(){GS(A)}).na(.25)}KS.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.l!=null&&(this.l.stop(),this.l=null),this.i&&(this.i.release(),this.i=null),this.g=this.G=this.C=null},KS.prototype.qe=function(){this.s=!0,GS(this)};function GS(i){if(i.g.readyState!=0){if(i.g.seeking){if(!i.B)return}else i.B=!1;if(!i.g.paused||i.g.currentTime==0&&(i.g.autoplay||i.g.currentTime!=0)){i.g.readyState!=i.I&&(i.j=!1,i.I=i.g.readyState);var l;if(!(l=!i.i)){l=i.i;var c=l.j,p=WL(c),y=c.g.currentTime,A=Date.now()/1e3;(l.g!=y||l.s!=p)&&(l.l=A,l.g=y,l.s=p,l.h=!1),y=A-l.l,(p=y>=l.B&&p&&!l.h)&&(l.i(l.g,y),l.h=!0,l.g=c.g.currentTime),l=!p}if(l){y=i.m.smallGapLimit;var P=i.g.currentTime;if(l=i.g.buffered,c=DH(l,P,i.m.gapDetectionThreshold),!(c==null||c==0&&!i.s||(p=l.start(c),p>=i.G.sb()))){var N=p-P;y=N<=y,A=!1,.001>N||(y||i.j||(i.j=!0,P=new Map().set("currentTime",P).set("gapSize",N),P=new De("largegap",P),P.cancelable=!0,i.C(P),i.m.jumpLargeGaps&&!P.defaultPrevented&&(A=!0)),!y&&!A)||(c!=0&&l.end(c-1),i.g.currentTime=p)}}}}}function ff(i,l,c,p){l==HTMLMediaElement.HAVE_NOTHING||i.readyState>=l?p():(l=BH.value().get(l),c.Qa(i,l,p))}var BH=new an(function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])});function HL(i,l,c){var p=this;this.g=i,this.l=l,this.j=c,this.s=!1,this.h=new _r,this.i=new YL(i),ff(this.g,HTMLMediaElement.HAVE_METADATA,this.h,function(){$L(p,p.j)})}HL.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.i!=null&&(this.i.release(),this.i=null),this.l=function(){},this.g=null};function WS(i){return i.s?i.g.currentTime:i.j}function VL(i,l){0<i.g.readyState?XL(i.i,l):ff(i.g,HTMLMediaElement.HAVE_METADATA,i.h,function(){$L(i,i.j)})}function $L(i,l){.001>Math.abs(i.g.currentTime-l)?zL(i):(i.h.Qa(i.g,"seeking",function(){zL(i)}),XL(i.i,i.g.currentTime==0?l:i.g.currentTime))}function zL(i){i.s=!0,i.h.o(i.g,"seeking",function(){return i.l()})}function YL(i){var l=this;this.h=i,this.s=10,this.l=this.j=this.i=0,this.g=new kn(function(){0>=l.i||l.h.currentTime!=l.j?l.g.stop():(l.h.currentTime=l.l,l.i--)})}YL.prototype.release=function(){this.g&&(this.g.stop(),this.g=null),this.h=null};function XL(i,l){i.j=i.h.currentTime,i.l=l,i.i=i.s,i.h.currentTime=l,i.g.na(.1)}function Bp(i){function l(){c.i==null||c.i==0?c.j=!0:(c.h.Qa(c.g,"seeking",function(){c.j=!0}),c.g.currentTime=Math.max(0,c.g.currentTime+c.i))}var c=this;this.g=i,this.j=!1,this.i=null,this.h=new _r,ff(this.g,HTMLMediaElement.HAVE_CURRENT_DATA,this.h,function(){l()})}Bp.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.g=null},Bp.prototype.s=function(i){this.i=this.j?this.i:i},Bp.prototype.l=function(){return(this.j?this.g.currentTime:this.i)||0},Bp.prototype.I=function(){};function jp(i,l,c,p,y,A){var P=this;this.i=i,this.g=l.presentationTimeline,this.J=l.minBufferTime||0,this.m=c,this.G=y,this.C=null,this.j=new KS(i,l.presentationTimeline,c,KH(i,c),A),this.h=new HL(i,function(){e:{var N=P.j;N.B=!0,N.s=!1,N.j=!1;var G=WS(P.h);if(N=QL(P,G),.001<Math.abs(N-G)&&(G=Date.now()/1e3,!P.C||P.C<G-1)){P.C=G,VL(P.h,N),N=void 0;break e}P.G(),N=void 0}return N},jH(this,p)),this.B=new kn(function(){if(P.i.readyState!=0&&!P.i.paused){var N=WS(P.h),G=P.g.mc(),q=P.g.sb();3>q-G&&(G=q-3),N<G&&(N=QL(P,N),P.i.currentTime=N)}}).na(.25)}jp.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.j&&(this.j.release(),this.j=null),this.B&&(this.B.stop(),this.B=null),this.i=this.h=this.g=this.m=null,this.G=function(){}},jp.prototype.s=function(i){VL(this.h,i)},jp.prototype.l=function(){var i=WS(this.h);return 0<this.i.readyState&&!this.i.paused?JL(this,i):i};function jH(i,l){return l==null?l=1/0>i.g.getDuration()?i.g.mc():i.g.sb():0>l&&(l=i.g.sb()+l),qL(i,JL(i,l))}jp.prototype.I=function(){this.j.qe()};function qL(i,l){var c=i.g.getDuration();return l>=c?c-i.m.durationBackoff:l}function QL(i,l){var c=Math.max(i.J,i.m.rebufferingGoal),p=i.m.safeSeekOffset,y=i.g.mc(),A=i.g.sb(),P=i.g.getDuration();3>A-y&&(y=A-3);var N=i.g.Nc(c),G=i.g.Nc(p);return c=i.g.Nc(c+p),l>=P?qL(i,l):l>A?A:l<y?kS(i.i.buffered,G)?G:c:l>=N||kS(i.i.buffered,l)?l:c}function JL(i,l){var c=i.g.mc();return l<c?c:(c=i.g.sb(),l>c?c:l)}function KH(i,l){if(!l.stallEnabled)return null;var c=l.stallSkip,p=new GL(new UH(i),l.stallThreshold);return kH(p,function(){c?i.currentTime+=c:(i.pause(),i.play())}),p}function fr(i){this.R=i,this.g=null,this.h=0,this.i=!1}f=fr.prototype,f.destroy=function(){return Ct("shaka.media.SegmentIndex","Please use release() instead of destroy()."),this.release(),Promise.resolve()},f.release=function(){this.i||(this.R=[],this.g&&this.g.stop(),this.g=null)},f.Qg=function(){this.i=!0},f.find=function(i){for(var l=this.R.length-1,c=l;0<=c;--c){var p=this.R[c],y=c<l?this.R[c+1].startTime:p.endTime;if(i>=p.startTime&&i<y)return c+this.h}return this.R.length&&i<this.R[0].startTime?this.h:null},f.get=function(i){return this.R.length==0?null:(i-=this.h,0>i||i>=this.R.length?null:this.R[i])},f.offset=function(i){if(!this.i)for(var l=E(this.R),c=l.next();!c.done;c=l.next())c=c.value,c.startTime+=i,c.endTime+=i,c.timestampOffset+=i},f.rc=function(i){!this.i&&i.length&&(this.R=this.R.filter(function(l){return l.startTime<i[0].startTime}),this.R.push.apply(this.R,T(i)))},f.sc=function(i,l){var c=this;i=i.filter(function(p){return p.endTime>l&&(c.R.length==0||p.endTime>c.R[0].startTime)}),this.rc(i),this.Ob(l)},f.Ob=function(i){if(!this.i){var l=this.R.length;this.R=this.R.filter(function(c){return c.endTime>i}),this.h+=l-this.R.length}},f.Hb=function(i,l,c){if(c=c===void 0?!1:c,!this.i){for(;this.R.length&&this.R[this.R.length-1].startTime>=l;)this.R.pop();for(;this.R.length&&this.R[0].endTime<=i;)this.R.shift(),c||this.h++;this.R.length!=0&&(i=this.R[this.R.length-1],this.R[this.R.length-1]=new Gr(i.startTime,l,i.j,i.Ka,i.Da,i.g,i.timestampOffset,i.appendWindowStart,i.appendWindowEnd,i.h,i.tilesLayout,i.i))}},f.Ed=function(i,l){var c=this;this.i||(this.g&&this.g.stop(),this.g=new kn(function(){var p=l();p?c.R.push.apply(c.R,T(p)):(c.g.stop(),c.g=null)}),this.g.na(i))},fr.prototype[Symbol.iterator]=function(){return this.kc(0)},fr.prototype.kc=function(i){var l=this.find(i);if(l==null)return null;l--;var c=this.get(l+1),p=-1;if(c&&0<c.h.length)for(var y=c.h.length-1;0<=y;--y){var A=c.h[y];if(i>=A.startTime&&i<A.endTime){l++,p=y-1;break}}return new bo(this,l,p)};function av(i,l,c){return new fr([new Gr(i,i+l,function(){return c},0,null,null,i,i,i+l)])}Le("shaka.media.SegmentIndex",fr),fr.forSingleSegment=av,fr.prototype.getIteratorForTime=fr.prototype.kc,fr.prototype.updateEvery=fr.prototype.Ed,fr.prototype.fit=fr.prototype.Hb,fr.prototype.evict=fr.prototype.Ob,fr.prototype.mergeAndEvict=fr.prototype.sc,fr.prototype.merge=fr.prototype.rc,fr.prototype.offset=fr.prototype.offset,fr.prototype.get=fr.prototype.get,fr.prototype.find=fr.prototype.find,fr.prototype.markImmutable=fr.prototype.Qg,fr.prototype.release=fr.prototype.release,fr.prototype.destroy=fr.prototype.destroy;function bo(i,l,c){this.i=i,this.h=l,this.g=c}bo.prototype.seek=function(i){return Ct("shaka.media.SegmentIterator","Please use SegmentIndex.getIteratorForTime instead of seek()."),(i=this.i.kc(i))?(this.h=i.h,this.g=i.g):(this.h=Number.MAX_VALUE,this.g=0),this.next().value},bo.prototype.current=function(){var i=this.i.get(this.h);return i&&0<i.h.length&&i.Ma().length&&this.g>=i.h.length&&(this.h++,this.g=0,i=this.i.get(this.h)),i&&0<i.h.length?i.h[this.g]:i},bo.prototype.next=function(){var i=this.i.get(this.h);return i&&0<i.h.length?(this.g++,i.Ma().length&&this.g==i.h.length&&(this.h++,this.g=0)):(this.h++,this.g=0),i=this.current(),{value:i,done:!i}},Le("shaka.media.SegmentIterator",bo),bo.prototype.next=bo.prototype.next,bo.prototype.current=bo.prototype.current,bo.prototype.seek=bo.prototype.seek;function ri(){fr.call(this,[]),this.j=[]}D(ri,fr),f=ri.prototype,f.clone=function(){var i=new ri;return i.j=this.j.slice(),i},f.release=function(){for(var i=E(this.j),l=i.next();!l.done;l=i.next())l.value.release();this.j=[]},f.find=function(i){for(var l=0,c=E(this.j),p=c.next();!p.done;p=c.next()){p=p.value;var y=p.find(i);if(y!=null)return y+l;l+=p.h+p.R.length}return null},f.get=function(i){for(var l=0,c=E(this.j),p=c.next();!p.done;p=c.next()){p=p.value;var y=p.get(i-l);if(y)return y;l+=p.h+p.R.length}return null},f.offset=function(){},f.rc=function(){},f.Ob=function(){},f.sc=function(){},f.Hb=function(){},f.Ed=function(){},Le("shaka.media.MetaSegmentIndex",ri),ri.prototype.updateEvery=ri.prototype.Ed,ri.prototype.fit=ri.prototype.Hb,ri.prototype.mergeAndEvict=ri.prototype.sc,ri.prototype.evict=ri.prototype.Ob,ri.prototype.merge=ri.prototype.rc,ri.prototype.offset=ri.prototype.offset,ri.prototype.get=ri.prototype.get,ri.prototype.find=ri.prototype.find,ri.prototype.release=ri.prototype.release;function Kp(i){var l=this;this.g=i,this.j=!1,this.i=this.g.sd(),this.h=new kn(function(){l.g.uf(.25*l.i)})}Kp.prototype.release=function(){this.h&&(this.h.stop(),this.h=null),this.g=null},Kp.prototype.set=function(i){this.i=i,ZL(this)},Kp.prototype.pd=function(){return this.g.pd()};function ZL(i){i.h.stop();var l=i.j?0:i.i;if(0<=l)try{i.g.sd()!=l&&i.g.Ge(l);return}catch{}i.h.na(.25),i.g.sd()!=0&&i.g.Ge(0)}function eM(i){var l=this;this.h=i,this.g=new Set,this.i=new kn(function(){tM(l,!1)}).na(.25)}eM.prototype.release=function(){this.i.stop();for(var i=E(this.g),l=i.next();!l.done;l=i.next())l.value.release();this.g.clear()};function tM(i,l){for(var c=E(i.g),p=c.next();!p.done;p=c.next())p.value.j(i.h.currentTime,l)}function ov(i){Ce.call(this),this.g=new Map,this.h=i}D(ov,Ce),ov.prototype.release=function(){this.g.clear(),Ce.prototype.release.call(this)};function GH(i,l){var c=i.g.get(l);return c||(c={Vc:[],$e:null,contentType:l},i.g.set(l,c)),c}function WH(i,l,c){var p=GH(i,l.contentType);HH(i,p),i={ge:l,position:c},p=p.Vc,l=p.findIndex(function(y){return y.position>=c}),0<=l?p.splice(l,p[l].position==c?1:0,i):p.push(i)}ov.prototype.j=function(i){for(var l=E(this.g.values()),c=l.next();!c.done;c=l.next()){c=c.value;e:{for(var p=c.Vc,y=p.length-1;0<=y;y--){var A=p[y];if(A.position<=i){p=A.ge;break e}}p=null}if((y=p)&&(y=c.$e,y=!(y===p||y&&p&&y.bandwidth==p.bandwidth&&y.audioSamplingRate==p.audioSamplingRate&&y.codecs==p.codecs&&y.contentType==p.contentType&&y.frameRate==p.frameRate&&y.height==p.height&&y.mimeType==p.mimeType&&y.channelsCount==p.channelsCount&&y.pixelAspectRatio==p.pixelAspectRatio&&y.width==p.width)),y)e:{if(y=i,A=p.contentType,(A=this.h()[A])&&0<A.length){var P=A[A.length-1].end;if(y>=A[0].start&&y<P){y=!0;break e}}y=!1}y&&(c.$e=p,JSON.stringify(p),c=new De("qualitychange",new Map([["quality",p],["position",i]])),this.dispatchEvent(c))}};function HH(i,l){var c=i.h()[l.contentType];if(c&&0<c.length){var p=c[0].start,y=c[c.length-1].end,A=l.Vc;l.Vc=A.filter(function(P,N){return!(P.position<=p&&N+1<A.length&&A[N+1].position<=p||P.position>=y)})}else l.Vc=[]}function HS(i){Ce.call(this);var l=this;this.g=new Set,this.i=i,this.h=new kn(function(){for(var c=l.i(),p=E(l.g),y=p.next();!y.done;y=p.next())y=y.value,y.endTime<c.start&&(l.g.delete(y),y=new De("regionremove",new Map([["region",y]])),l.dispatchEvent(y))}).na(2)}D(HS,Ce),HS.prototype.release=function(){this.g.clear(),this.h.stop(),Ce.prototype.release.call(this)};function lv(i){Ce.call(this);var l=this;this.i=i,this.g=new Map,this.l=[{cc:null,bc:bd,Sb:function(c,p){return df(l,"enter",c,p)}},{cc:Gp,bc:bd,Sb:function(c,p){return df(l,"enter",c,p)}},{cc:Wp,bc:bd,Sb:function(c,p){return df(l,"enter",c,p)}},{cc:bd,bc:Gp,Sb:function(c,p){return df(l,"exit",c,p)}},{cc:bd,bc:Wp,Sb:function(c,p){return df(l,"exit",c,p)}},{cc:Gp,bc:Wp,Sb:function(c,p){return df(l,"skip",c,p)}},{cc:Wp,bc:Gp,Sb:function(c,p){return df(l,"skip",c,p)}}],this.h=new _r,this.h.o(this.i,"regionremove",function(c){l.g.delete(c.region)})}D(lv,Ce),lv.prototype.release=function(){this.i=null,this.g.clear(),this.h.release(),this.h=null,Ce.prototype.release.call(this)},lv.prototype.j=function(i,l){for(var c=E(this.i.g),p=c.next();!p.done;p=c.next()){p=p.value;var y=this.g.get(p),A=i<p.startTime?Gp:i>p.endTime?Wp:bd;this.g.set(p,A);for(var P=E(this.l),N=P.next();!N.done;N=P.next())N=N.value,N.cc==y&&N.bc==A&&N.Sb(p,l)}};function df(i,l,c,p){l=new De(l,new Map([["region",c],["seeking",p]])),i.dispatchEvent(l)}var Gp=1,bd=2,Wp=3;function Hp(i,l,c,p,y){return i=Qs(i,p,y),(l!=0||c!=null)&&(i.headers.Range=c?"bytes="+l+"-"+c:"bytes="+l+"-"),i}function Vp(i,l){var c=this;this.F=l,this.H=i,this.m=null,this.l=1,this.i=this.h=null,this.g=new Map,this.s=!1,this.B=null,this.j=!1,this.N=new Zl(function(){return VH(c)})}Vp.prototype.destroy=function(){return this.N.destroy()};function VH(i){var l,c,p,y;return Z(function(A){if(A.g==1){for(l=[],c=E(i.g.values()),p=c.next();!p.done;p=c.next())y=p.value,cv(y),l.push(aM(y));return I(A,Promise.all(l),2)}i.g.clear(),i.F=null,i.H=null,i.m=null,U(A)})}Vp.prototype.configure=function(i){this.m=i,this.B=new Lp({maxAttempts:Math.max(i.retryParameters.maxAttempts,2),baseDelay:i.retryParameters.baseDelay,backoffFactor:i.retryParameters.backoffFactor,fuzzFactor:i.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0)},Vp.prototype.start=function(){var i=this;return Z(function(l){if(l.g==1)return I(l,qH(i),2);Pr(i.N),i.s=!0,U(l)})};function $H(i,l){var c,p,y,A,P;Z(function(N){switch(N.g){case 1:return c=ut,w(N,2),I(N,BL(i.F.Y,c.ua),4);case 4:K(N,3);break;case 2:p=W(N),i.F&&i.F.onError(p);case 3:y=ui(l.mimeType,l.codecs),Up(i.F.Y,y),A=i.F.Y.s,(A.isTextVisible()||i.m.alwaysStreamText)&&(P=iM(l),i.g.set(c.ua,P),Qa(i,P,0)),U(N)}})}function zH(i){var l=i.g.get(Ke);l&&(cv(l),aM(l).catch(function(){}),i.g.delete(Ke)),i.i=null}function nM(i,l){var c=i.g.get("video");if(c){var p=c.stream;if(p)if(l){var y=p.trickModeVideo;y&&!c.Zb&&(Dd(i,y,!1,0,!1),c.Zb=p)}else(p=c.Zb)&&(c.Zb=null,Dd(i,p,!0,0,!1))}}function rM(i,l,c,p,y){c=c===void 0?!1:c,p=p===void 0?0:p,y=y===void 0?!1:y,i.h=l,i.s&&(l.video&&Dd(i,l.video,c,p,y),l.audio&&Dd(i,l.audio,c,p,y))}function uv(i,l){i.i=l,i.s&&Dd(i,l,!0,0,!1)}function Dd(i,l,c,p,y){var A=i.g.get(l.type);A||l.type!=Ke?A&&(A.Zb&&(l.trickModeVideo?(A.Zb=l,l=l.trickModeVideo):A.Zb=null),A.stream!=l||y)&&(l.type==Ke&&Up(i.F.Y,ui(l.mimeType,l.codecs)),A.stream.closeSegmentIndex&&A.stream.closeSegmentIndex(),A.stream=l,A.za=null,c&&(A.Ic?A.Hd=!0:A.hb?(A.ac=!0,A.md=p,A.Hd=!0):(cv(A),zS(i,A,!0,p).catch(function(P){i.F&&i.F.onError(P)}))),YH(i,A).catch(function(P){i.F&&i.F.onError(P)})):$H(i,l)}function YH(i,l){var c,p;return Z(function(y){if(y.g==1)return l.Ra?(c=l.stream,p=l.Ra,c.segmentIndex?y.D(2):I(y,c.createSegmentIndex(),2)):y.return();if(l.Ra!=p||l.stream!=c)return y.return();var A=i.F.rd(),P=sv(i.F.Y,l.type),N=l.stream.segmentIndex.find(l.Xa?l.Xa.endTime:A),G=N==null?null:l.stream.segmentIndex.get(N);N=G&&G.Da?G.Da-G.Ka:null,G&&!N&&(N=(G.endTime-G.startTime)*(l.stream.bandwidth||0)/8),N?((G=G.g)&&(N+=(G.Da?G.Da-G.Ka:null)||0),G=i.F.getBandwidthEstimate(),A=8*N/G<(P||0)-A-Math.max(i.H.minBufferTime||0,i.m.rebufferingGoal)||l.Ra.h.g>N):A=!1,A&&l.Ra.abort(),U(y)})}function XH(i,l){l.Ic||l.ac||(l.hb?(l.ac=!0,l.md=0):kL(i.F.Y,l.type)==null?l.kb==null&&Qa(i,l,0):(cv(l),zS(i,l,!1,0).catch(function(c){i.F&&i.F.onError(c)})))}function qH(i){var l,c,p,y,A,P,N,G,q,ae;return Z(function(Te){if(Te.g==1){if(l=ut,!i.h)throw new We(2,5,5006);return c=new Map,p=new Set,i.h.audio&&(c.set(l.Nb,i.h.audio),p.add(i.h.audio)),i.h.video&&(c.set(l.mb,i.h.video),p.add(i.h.video)),i.i&&(c.set(l.ua,i.i),p.add(i.i)),y=i.F.Y,A=i.m.forceTransmuxTS,I(Te,y.init(c,A),2)}Pr(i.N);var Ie=i.H.presentationTimeline.getDuration();for(1/0>Ie?i.F.Y.ib(Ie):i.F.Y.ib(Math.pow(2,32)),P=E(c.keys()),N=P.next();!N.done;N=P.next())G=N.value,q=c.get(G),i.g.has(G)||(ae=iM(q),i.g.set(G,ae),Qa(i,ae,0));U(Te)})}function iM(i){return{stream:i,type:i.type,za:null,Xa:null,td:null,ee:null,ce:null,be:null,Zb:null,endOfStream:!1,hb:!1,kb:null,ac:!1,md:0,Hd:!1,Ic:!1,ve:!1,Pc:!1,Ra:null}}Vp.prototype.Tc=function(i){var l=this,c,p,y,A,P;return Z(function(N){switch(N.g){case 1:if(Pr(l.N),i.hb||i.kb==null||i.Ic)return N.return();if(i.kb=null,!i.ac){N.D(2);break}return I(N,zS(l,i,i.Hd,i.md),3);case 3:return N.return();case 2:if(i.stream.segmentIndex){N.D(4);break}return c=i.stream,I(N,i.stream.createSegmentIndex(),5);case 5:if(c!=i.stream)return c.closeSegmentIndex&&c.closeSegmentIndex(),i.kb==null&&Qa(l,i,0),N.return();case 4:w(N,6),p=QH(l,i),p!=null&&(Qa(l,i,p),i.Pc=!1),K(N,7);break;case 6:return y=W(N),I(N,oM(l,y),8);case 8:return N.return();case 7:if(A=Array.from(l.g.values()),!l.s||!A.every(function(G){return G.endOfStream})){N.D(0);break}return I(N,l.F.Y.endOfStream(),10);case 10:Pr(l.N),P=l.F.Y.getDuration(),P!=0&&P<l.H.presentationTimeline.getDuration()&&l.H.presentationTimeline.ib(P),U(N)}})};function QH(i,l){if(VS(l))return wH(i.F.Y,l.stream.originalId||""),null;l.type==Ke&&OH(i.F.Y);var c=i.F.rd(),p=l.Xa?l.Xa.endTime:c,y=MH(i.F.Y,l.type,c),A=Math.max(i.H.minBufferTime||0,i.m.rebufferingGoal,i.m.bufferingGoal)*i.l;if(1e-6>i.H.presentationTimeline.getDuration()-p)return l.endOfStream=!0,l.type=="video"&&(c=i.g.get(Ke))&&VS(c)&&(c.endOfStream=!0),null;if(l.endOfStream=!1,y>=A)return i.m.updateIntervalSeconds/2;if(y=sv(i.F.Y,l.type),y=JH(i,l,c,y),!y)return i.m.updateIntervalSeconds;A=1/0;var P=Array.from(i.g.values());P=E(P);for(var N=P.next();!N.done;N=P.next())N=N.value,VS(N)||N.za&&!N.za.current()||(A=Math.min(A,N.Xa?N.Xa.endTime:c));return p>=A+i.H.presentationTimeline.g?i.m.updateIntervalSeconds:(ZH(i,l,c,y).catch(function(){}),null)}function JH(i,l,c,p){if(l.za)return l.za.current();if(l.Xa||p)return l.za=l.stream.segmentIndex.kc(l.Xa?l.Xa.endTime:p),l.za&&l.za.next().value;i=i.m.inaccurateManifestTolerance,p=Math.max(c-i,0);var y=null;return i&&(l.za=l.stream.segmentIndex.kc(p),y=l.za&&l.za.next().value),y||(l.za=l.stream.segmentIndex.kc(c),y=l.za&&l.za.next().value),y}function ZH(i,l,c,p){var y,A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe;return Z(function(Ze){switch(Ze.g){case 1:return y=ut,A=l.stream,P=l.za,l.hb=!0,w(Ze,2),I(Ze,nV(i,l,p),4);case 4:return Pr(i.N),i.j?Ze.return():(N=A.mimeType=="video/mp4"||A.mimeType=="audio/mp4",G=o.ReadableStream,i.m.lowLatencyMode&&G&&N?(Te=new Uint8Array(0),Ie=function(Qe){var Lt,It,yt;return Z(function(Jt){return Pr(i.N),i.j?Jt.return():(Te=eV(Te,Qe),Lt=!1,It=0,new Lr().box("mdat",function(un){It=un.size+un.start,Lt=!0}).parse(Te,!1,!0),Lt?(yt=Te.subarray(0,It),Te=Te.subarray(It),I(Jt,sM(i,l,c,A,p,yt),0)):Jt.D(0))})},I(Ze,$S(i,l,p,Ie),6)):(q=$S(i,l,p),I(Ze,q,7)));case 7:return ae=Ze.h,Pr(i.N),i.j?Ze.return():l.ac?(l.hb=!1,Qa(i,l,0),Ze.return()):I(Ze,sM(i,l,c,A,p,ae),6);case 6:if(Pr(i.N),i.j)return Ze.return();l.Xa=p,P.next(),l.hb=!1,l.ve=!1,Ne=i.F.Y.Ib(),Ve=Ne[l.type],JSON.stringify(Ve),l.ac||i.F.qe(),Qa(i,l,0),K(Ze,0);break;case 2:if(qe=W(Ze),Pr(i.N,qe),i.j)return Ze.return();if(l.hb=!1,qe.code==7001)l.hb=!1,l.kb=null,Qa(i,l,0),Ze.D(0);else if(l.type==y.ua&&i.m.ignoreTextStreamFailures)i.g.delete(y.ua),Ze.D(0);else if(qe.code==3017)tV(i,l,qe),Ze.D(0);else if(qe.code==1001&&qe.data&&qe.data[1]==404)l.hb=!1,l.kb=null,Qa(i,l,1),Ze.D(0);else return l.Pc=!0,qe.severity=2,I(Ze,oM(i,qe),0)}})}function eV(i,l){var c=new Uint8Array(i.length+l.length);return c.set(i),c.set(l,i.length),c}function tV(i,l,c){if(!Array.from(i.g.values()).some(function(y){return y!=l&&y.ve})){var p=Math.round(100*i.l);if(20<p)i.l-=.2;else if(4<p)i.l-=.04;else{l.Pc=!0,i.j=!0,i.F.onError(c);return}l.ve=!0}Qa(i,l,4)}function nV(i,l,c){var p,y,A,P,N,G,q;return Z(function(ae){return p=[],y=Math.max(0,c.appendWindowStart-.1),A=c.appendWindowEnd+.01,P=c.timestampOffset,(P!=l.ee||y!=l.ce||A!=l.be)&&(N=function(){var Te;return Z(function(Ie){if(Ie.g==1)return w(Ie,2),l.ce=y,l.be=A,l.ee=P,I(Ie,NH(i.F.Y,l.type,P,y,A),4);if(Ie.g!=2)return K(Ie,0);throw Te=W(Ie),l.ce=null,l.be=null,l.ee=null,Te})},p.push(N())),!FH(c.g,l.td)&&(l.td=c.g)&&(G=$S(i,l,c.g),q=function(){var Te,Ie,Ne;return Z(function(Ve){switch(Ve.g){case 1:return w(Ve,2),I(Ve,G,4);case 4:return Te=Ve.h,Pr(i.N),Ie=l.stream.closedCaptions&&0<l.stream.closedCaptions.size,I(Ve,UL(i.F.Y,l.type,Te,null,null,Ie),5);case 5:K(Ve,0);break;case 2:throw Ne=W(Ve),l.td=null,Ne}})},i.F.Ug(c.startTime,c.g),p.push(q())),I(ae,Promise.all(p),0)})}function sM(i,l,c,p,y,A){var P;return Z(function(N){if(N.g==1)return P=p.closedCaptions&&0<p.closedCaptions.size,(p.emsgSchemeIdUris!=null&&0<p.emsgSchemeIdUris.length||i.m.dispatchAllEmsgBoxes)&&new Lr().Z("emsg",function(G){var q=p.emsgSchemeIdUris;if(G.version===0)var ae=G.reader.Wc(),Te=G.reader.Wc(),Ie=G.reader.T(),Ne=G.reader.T(),Ve=G.reader.T(),qe=G.reader.T(),Ze=y.startTime+Ne/Ie;else Ie=G.reader.T(),Ze=G.reader.xc()/Ie+y.timestampOffset,Ne=Ze-y.startTime,Ve=G.reader.T(),qe=G.reader.T(),ae=G.reader.Wc(),Te=G.reader.Wc();G=G.reader.Lb(G.reader.X.byteLength-G.reader.qa()),(q&&q.includes(ae)||i.m.dispatchAllEmsgBoxes)&&(ae=="urn:mpeg:dash:event:2012"?i.F.Vg():(q=new Map().set("detail",{startTime:Ze,endTime:Ze+Ve/Ie,schemeIdUri:ae,value:Te,timescale:Ie,presentationTimeDelta:Ne,eventDuration:Ve,id:qe,messageData:G}),q=new De(YM,q),i.F.onEvent(q)))}).parse(A),I(N,rV(i,l,c),2);if(N.g!=3)return Pr(i.N),I(N,UL(i.F.Y,l.type,A,y.startTime,y.endTime,P),3);Pr(i.N),U(N)})}function rV(i,l,c){var p,y,A,P;return Z(function(N){if(N.g==1)return p=Math.max(i.m.bufferBehind,i.H.presentationTimeline.g),y=kL(i.F.Y,l.type),y==null?N.return():(A=c-y,P=A-p,.01>=P?N.return():I(N,i.F.Y.remove(l.type,y,y+P),2));Pr(i.N),U(N)})}function VS(i){return i&&i.type==Ke&&(i.stream.mimeType=="application/cea-608"||i.stream.mimeType=="application/cea-708")}function $S(i,l,c,p){var y,A,P,N,G;return Z(function(q){return q.g==1?(y=Ro,A=Hp(c.Ma(),c.Ka,c.Da,i.m.retryParameters,p),P=l.stream,i.F.modifySegmentRequest(A,{type:P.type,init:c instanceof Js,duration:c.endTime-c.startTime,mimeType:P.mimeType,codecs:P.codecs,bandwidth:P.bandwidth}),N=i.F.Wb.request(y,A),l.Ra=N,I(q,N.promise,2)):(G=q.h,l.Ra=null,q.return(G.data))})}function zS(i,l,c,p){var y,A;return Z(function(P){if(P.g==1)return l.ac=!1,l.Hd=!1,l.md=0,l.Ic=!0,l.Xa=null,l.td=null,l.za=null,p?(y=i.F.rd(),A=i.F.Y.getDuration(),I(P,i.F.Y.remove(l.type,y+p,A),3)):I(P,BL(i.F.Y,l.type),4);if(P.g!=3)return Pr(i.N),c?I(P,i.F.Y.flush(l.type),3):P.D(3);Pr(i.N),l.Ic=!1,l.endOfStream=!1,Qa(i,l,0),U(P)})}function Qa(i,l,c){var p=l.type;(p!=Ke||i.g.has(p))&&(l.kb=new Ps(function(){var y;return Z(function(A){if(A.g==1)return w(A,2),I(A,i.Tc(l),4);if(A.g!=2)return K(A,0);y=W(A),i.F&&i.F.onError(y),U(A)})}).U(c))}function cv(i){i.kb!=null&&(i.kb.stop(),i.kb=null)}function aM(i){return Z(function(l){return i.Ra?I(l,i.Ra.abort(),0):l.D(0)})}function oM(i,l){return Z(function(c){if(c.g==1)return I(c,yd(i.B),2);Pr(i.N),i.F.onError(l),l.handled||i.m.failureCallback(l),U(c)})}function lM(i,l){var c=Nd(),p=this;this.j=l,this.i=i,this.l=c,this.B=null,this.s=[],this.h=this.g=null,this.C=Promise.resolve().then(function(){return sV(p)}),this.N=new Zl(function(){return iV(p)})}lM.prototype.destroy=function(){return this.N.destroy()};function iV(i){var l,c,p;return Z(function(y){if(y.g==1)return i.h&&i.h.abort(),uM(i),I(y,i.C,2);for(i.g&&i.g.gb.Xb(),l=E(i.s),c=l.next();!c.done;c=l.next())p=c.value,p.gb.Xb();i.g=null,i.s=[],i.j=null,U(y)})}function $p(i,l){var c={uc:function(){},vd:function(){},Xb:function(){},onError:function(){},xd:function(){},Ui:function(){}};return i.s.push({create:l,gb:c}),i.h&&i.h.abort(),uM(i),c}function sV(i){return Z(function(l){if(i.N.g)l=l.D(0);else{if(i.s.length==0||i.g&&!i.g.Rb)var c=!1;else{i.g&&(i.g.gb.Xb(),i.g=null),c=i.s.shift();var p=c.create(i.l);p?(c.gb.uc(),i.g={node:p.node,payload:p.payload,Rb:p.Rb,gb:c.gb}):c.gb.xd(),c=!0}c?c=Promise.resolve():i.g?c=aV(i):(i.j.Tg(i.i),i.B=new Rt,c=i.B),l=I(l,c,1)}return l})}function aV(i){var l,c;return Z(function(p){switch(p.g){case 1:return i.i=i.j.xg(i.i,i.l,i.g.node,i.g.payload),w(p,2),i.h=i.j.$f(i.i,i.l,i.g.payload),I(p,i.h.promise,4);case 4:i.h=null,i.i==i.g.node&&(i.g.gb.vd(),i.g=null),K(p,0);break;case 2:return l=W(p),l.code==7001?i.g.gb.Xb():i.g.gb.onError(l),i.g=null,i.h=null,c=i,I(p,i.j.handleError(i.l,l),5);case 5:c.i=p.h,U(p)}})}function uM(i){i.B&&(i.B.resolve(),i.B=null)}function La(i){this.g=null;for(var l=E(Array.from(i.textTracks)),c=l.next();!c.done;c=l.next())c=c.value,c.mode="disabled",c.label=="Shaka Player TextTrack"&&(this.g=c);this.g||(this.g=i.addTextTrack("subtitles","Shaka Player TextTrack")),this.g.mode="hidden"}f=La.prototype,f.remove=function(i,l){return this.g?(cM(this.g,function(c){return c.startTime<l&&c.endTime>i}),!0):!1},f.append=function(i){function l(P){var N=[],G=700<=P.fontWeight,q=P.fontStyle=="italic",ae=P.textDecoration.includes("underline");return G&&N.push("b"),q&&N.push("i"),ae&&N.push("u"),G=N.reduce(function(Te,Ie){return Te+"<"+Ie+">"},""),N=N.reduceRight(function(Te,Ie){return Te+"</"+Ie+">"},""),P.lineBreak||P.spacer?(P.spacer&&Ct("shaka.extern.Cue","Please use lineBreak instead of spacer."),`
`):P.nestedCues.length?P.nestedCues.map(l).join(""):G+P.payload+N}var c=i.map(function(P){if(P.nestedCues.length){var N=P.clone();return N.nestedCues=[],N.payload=l(P),N}return P}),p=[];i=this.g.cues?Array.from(this.g.cues):[];var y={};c=E(c);for(var A=c.next();!A.done;y={dc:y.dc},A=c.next())y.dc=A.value,i.some(function(P){return function(N){return N.startTime==P.dc.startTime&&N.endTime==P.dc.endTime&&N.text==P.dc.payload}}(y))||(A=oV(y.dc))&&p.push(A);for(i=p.slice().sort(function(P,N){return P.startTime!=N.startTime?P.startTime-N.startTime:P.endTime!=N.endTime?P.endTime-N.startTime:"line"in VTTCue.prototype?p.indexOf(N)-p.indexOf(P):p.indexOf(P)-p.indexOf(N)}),i=E(i),y=i.next();!y.done;y=i.next())this.g.addCue(y.value)},f.destroy=function(){return this.g&&(cM(this.g,function(){return!0}),this.g.mode="disabled"),this.g=null,Promise.resolve()},f.isTextVisible=function(){return this.g.mode=="showing"},f.setTextVisibility=function(i){this.g.mode=i?"showing":"hidden"};function oV(i){if(i.startTime>=i.endTime)return null;var l=new VTTCue(i.startTime,i.endTime,i.payload);l.lineAlign=i.lineAlign,l.positionAlign=i.positionAlign,i.size&&(l.size=i.size);try{l.align=i.textAlign}catch{}return i.textAlign=="center"&&l.align!="center"&&(l.align="middle"),i.writingMode=="vertical-lr"?l.vertical="lr":i.writingMode=="vertical-rl"&&(l.vertical="rl"),i.lineInterpretation==1&&(l.snapToLines=!1),i.line!=null&&(l.line=i.line),i.position!=null&&(l.position=i.position),l}function cM(i,l){var c=i.mode;i.mode=c=="showing"?"showing":"hidden";for(var p=E(Array.from(i.cues)),y=p.next();!y.done;y=p.next())(y=y.value)&&l(y)&&i.removeCue(y);i.mode=c}Le("shaka.text.SimpleTextDisplayer",La),La.prototype.setTextVisibility=La.prototype.setTextVisibility,La.prototype.isTextVisible=La.prototype.isTextVisible,La.prototype.destroy=La.prototype.destroy,La.prototype.append=La.prototype.append,La.prototype.remove=La.prototype.remove;function fM(){}function wn(i){return document.createElement(i)}function Oi(){return document.createElement("button")}function Pd(i){for(;i.firstChild;)i.removeChild(i.firstChild)}Le("shaka.util.Dom",fM),fM.removeAllChildren=Pd;function Ma(i,l){var c=this;this.s=!1,this.l=[],this.g=i,this.C=l,this.i=wn("div"),this.i.classList.add("shaka-text-container"),this.i.style.textAlign="center",this.i.style.display="flex",this.i.style.flexDirection="column",this.i.style.alignItems="center",this.i.style.justifyContent="flex-end",this.C.appendChild(this.i),this.G=new kn(function(){zp(c)}).na(.25),this.j=new Map,this.h=new _r,this.h.o(document,"fullscreenchange",function(){zp(c,!0)}),this.B=null,"ResizeObserver"in o&&(this.B=new ResizeObserver(function(){zp(c,!0)}),this.B.observe(this.i))}f=Ma.prototype,f.append=function(i){var l=[].concat(T(this.l)),c={};i=E(i);for(var p=i.next();!p.done;c={$c:c.$c},p=i.next())c.$c=p.value,l.some(function(y){return function(A){return $t(A,y.$c)}}(c))||this.l.push(c.$c);zp(this)},f.destroy=function(){this.C.removeChild(this.i),this.i=null,this.s=!1,this.l=[],this.G&&this.G.stop(),this.j.clear(),this.h&&(this.h.release(),this.h=null),this.B&&(this.B.disconnect(),this.B=null)},f.remove=function(i,l){if(!this.i)return!1;var c=this.l.length;return this.l=this.l.filter(function(p){return p.startTime<i||p.endTime>=l}),zp(this,c>this.l.length),!0},f.isTextVisible=function(){return this.s},f.setTextVisibility=function(i){this.s=i};function dM(i,l,c,p,y){var A=!1,P=[],N=[];l=E(l);for(var G=l.next();!G.done;G=l.next()){G=G.value,y.push(G);var q=i.j.get(G),ae=G.startTime<=p&&G.endTime>p,Te=q?q.Mf:null;q&&(P.push(q.Ze),ae||(A=!0,i.j.delete(G),q=null)),ae&&(N.push(G),q||(lV(i,G,y),q=i.j.get(G),Te=q.Mf,A=!0)),0<G.nestedCues.length&&Te&&dM(i,G.nestedCues,Te,p,y),y.pop()}if(A){for(p=E(P),y=p.next();!y.done;y=p.next())c.removeChild(y.value);for(N.sort(function(Ie,Ne){return Ie.startTime!=Ne.startTime?Ie.startTime-Ne.startTime:Ie.endTime-Ne.endTime}),N=E(N),G=N.next();!G.done;G=N.next())p=i.j.get(G.value),c.appendChild(p.Ze)}}function zp(i,l){if(i.i){var c=i.g.currentTime;if((!i.s||l!==void 0&&l)&&0<i.j.size&&(Pd(i.i),i.j.clear()),i.s){for(var p=new Map,y=E(i.j.keys()),A=y.next();!A.done;A=y.next())A=A.value,p.set(A,i.j.get(A));dM(i,i.l,i.i,c,[])}}}function lV(i,l,c){var p=1<c.length,y=p?"span":"div";(l.lineBreak||l.spacer)&&(l.spacer&&Ct("shaka.extern.Cue","Please use lineBreak instead of spacer."),y="br"),p=!p&&0<l.nestedCues.length;var A=wn(y);y!="br"&&uV(i,A,l,c,p),c=A,p&&(c=wn("span"),c.classList.add("shaka-text-wrapper"),c.style.backgroundColor=l.backgroundColor,A.appendChild(c)),i.j.set(l,{Ze:A,Mf:c})}function uV(i,l,c,p,y){var A=l.style,P=c.nestedCues.length==0,N=1<p.length;A.whiteSpace="pre-wrap";var G=c.payload.replace(/\s+$/g,function(ae){return" ".repeat(ae.length)});if(A.webkitTextStrokeColor=c.textStrokeColor,A.webkitTextStrokeWidth=c.textStrokeWidth,A.color=c.color,A.direction=c.direction,A.opacity=c.opacity,A.paddingLeft=YS(c.linePadding,c,i.C),A.paddingRight=YS(c.linePadding,c,i.C),c.backgroundImage)A.backgroundImage="url('"+c.backgroundImage+"')",A.backgroundRepeat="no-repeat",A.backgroundSize="contain",A.backgroundPosition="center";else{if(c.nestedCues.length)var q=l;else q=wn("span"),l.appendChild(q);c.border&&(q.style.border=c.border),y||((l=cV(p,function(ae){return ae.backgroundColor}))?q.style.backgroundColor=l:G&&(q.style.backgroundColor="rgba(0, 0, 0, 0.8)")),G&&(q.textContent=G)}N&&!p[p.length-1].isContainer?A.display="inline":(A.display="flex",A.flexDirection="column",A.alignItems="center",A.justifyContent=c.displayAlign=="before"?"flex-start":c.displayAlign=="center"?"center":"flex-end"),P||(A.margin="0"),A.fontFamily=c.fontFamily,A.fontWeight=c.fontWeight.toString(),A.fontStyle=c.fontStyle,A.letterSpacing=c.letterSpacing,A.fontSize=YS(c.fontSize,c,i.C),c.line?c.lineInterpretation==1&&(A.position="absolute",A.left="0",A.top="0",c.writingMode==Mi?(A.width="100%",c.lineAlign==li?A.top=c.line+"%":c.lineAlign=="end"&&(A.bottom=c.line+"%")):c.writingMode=="vertical-lr"?(A.height="100%",c.lineAlign==li?A.left=c.line+"%":c.lineAlign=="end"&&(A.right=c.line+"%")):(A.height="100%",c.lineAlign==li?A.right=c.line+"%":c.lineAlign=="end"&&(A.left=c.line+"%"))):c.region&&c.region.id&&(i=c.region.widthUnits==ji?"%":"px",p=c.region.viewportAnchorUnits==ji?"%":"px",A.height=c.region.height+(c.region.heightUnits==ji?"%":"px"),A.width=c.region.width+i,A.position="absolute",A.top=c.region.viewportAnchorY+p,A.left=c.region.viewportAnchorX+p),A.lineHeight=c.lineHeight,c.position&&(c.writingMode==Mi?A.paddingLeft=c.position:A.paddingTop=c.position),c.positionAlign=="line-left"?A.cssFloat="left":c.positionAlign=="line-right"&&(A.cssFloat="right"),A.textAlign=c.textAlign,A.textDecoration=c.textDecoration.join(" "),A.writingMode=c.writingMode,"writingMode"in document.documentElement.style&&A.writingMode==c.writingMode||(A.webkitWritingMode=c.writingMode),c.size&&(c.writingMode==Mi?A.width=c.size+"%":A.height=c.size+"%")}function YS(i,l,c){var p=(p=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(i))?{value:Number(p[1]),ph:p[2]}:null;if(!p)return i;var y=p.value;switch(p.ph){case"%":return y/100*c.clientHeight/l.cellResolution.rows+"px";case"c":return c.clientHeight*y/l.cellResolution.rows+"px";default:return i}}function cV(i,l){for(var c=i.length-1;0<=c;c--){var p=l(i[c]);if(p||p===0)return p}return null}Le("shaka.text.UITextDisplayer",Ma),Ma.prototype.setTextVisibility=Ma.prototype.setTextVisibility,Ma.prototype.isTextVisible=Ma.prototype.isTextVisible,Ma.prototype.remove=Ma.prototype.remove,Ma.prototype.destroy=Ma.prototype.destroy,Ma.prototype.append=Ma.prototype.append;function fV(i,l){function c(N){for(var G=N,q=E(l),ae=q.next();!ae.done;ae=q.next())ae=ae.value,ae.end&&ae.start<N&&(G+=ae.end-ae.start);return N=Math.floor(G/3600),q=Math.floor(G/60%60),ae=Math.floor(G%60),G=Math.floor(1e3*G%1e3),(10>N?"0":"")+N+":"+(10>q?"0":"")+q+":"+(10>ae?"0":"")+ae+"."+(100>G?10>G?"00":"0":"")+G}function p(N){var G=[],q=700<=N.fontWeight,ae=N.fontStyle=="italic",Te=N.textDecoration.includes("underline");return q&&G.push("b"),ae&&G.push("i"),Te&&G.push("u"),q=G.reduce(function(Ie,Ne){return Ie+"<"+Ne+">"},""),G=G.reduceRight(function(Ie,Ne){return Ie+"</"+Ne+">"},""),N.lineBreak||N.spacer?(N.spacer&&Ct("shaka.text.Cue","Please use lineBreak instead of spacer."),`
`):N.nestedCues.length?N.nestedCues.map(p).join(""):q+N.payload+G}var y=i.map(function(N){if(N.nestedCues.length){var G=N.clone();return G.nestedCues=[],G.payload=p(N),G}return N}),A=`WEBVTT

`;y=E(y);for(var P=y.next();!P.done;P=y.next())P=P.value,A+=c(P.startTime)+" --> "+c(P.endTime)+function(N){var G=[];switch(N.textAlign){case"left":G.push("align:left");break;case"right":G.push("align:right");break;case yn:G.push("align:middle");break;case"start":G.push("align:start");break;case"end":G.push("align:end")}switch(N.writingMode){case"vertical-lr":G.push("vertical:lr");break;case"vertical-rl":G.push("vertical:rl")}return G.length?" "+G.join(" "):""}(P)+`
`,A+=P.payload+`

`;return A}Le("shaka.text.WebVttGenerator",function(){});function dV(i,l){this.F=i,this.m=l,this.h="",this.l=void 0,this.g=!1,this.j=!0,this.i=!1}function hM(i,l,c){try{if(i.m.enabled){var p={d:1e3*c.duration,st:i.F.W()?_V:EV};p.ot=pV(c);var y=p.ot===dv||p.ot===JS||p.ot===hv||p.ot===eA;y&&(p.bl=gV(i,c.type)),c.bandwidth&&(p.br=c.bandwidth/1e3),y&&p.ot!==eA&&(p.tb=mV(i,p.ot)/1e3),qS(i,l,p)}}catch(A){me("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",A)}}function hV(i,l,c){try{if(!i.m.enabled)return l;var p=XS(i);e:{switch(c){case"video/webm":case"video/mp4":var y=hv;break e;case"application/x-mpegurl":y=gM;break e}y=void 0}p.ot=y,p.su=!0;var A=fv(p);return QS(l,A)}catch(P){return me("CMCD_SRC_ERROR","Could not generate src CMCD data.",P),l}}function pM(i,l){try{if(!i.m.enabled)return l;var c=XS(i);c.ot=ZS,c.su=!0;var p=fv(c);return QS(l,p)}catch(y){return me("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",y),l}}function XS(i){return i.h||(i.h=i.m.sessionId||o.crypto.randomUUID()),{v:1,sf:i.l,sid:i.h,cid:i.m.contentId,mtp:i.F.getBandwidthEstimate()/1e3}}function qS(i,l,c){c=c===void 0?{}:c;var p=p===void 0?i.m.useHeaders:p;if(i.m.enabled){Object.assign(c,XS(i)),c.pr=i.F.Jb();var y=c.ot===dv||c.ot===hv;if(i.i&&y&&(c.bs=!0,c.su=!0,i.i=!1),c.su==null&&(c.su=i.j),p)i=vV(c),Object.keys(i).length&&Object.assign(l.headers,i);else{var A=fv(c);A&&(l.uris=l.uris.map(function(P){return QS(P,A)}))}}}function pV(i){var l=i.type;if(i.init)return yV;if(l=="video")return i.codecs.includes(",")?hv:dv;if(l=="audio")return JS;if(l=="text")return i.mimeType==="application/mp4"?eA:ZS}function gV(i,l){var c=i.F.Ib()[l];if(!c.length)return NaN;var p=i.F.kg();return(c=c.find(function(y){return y.start<=p&&y.end>=p}))?1e3*(c.end-p):NaN}function mV(i,l){var c=i.F.fb();if(!c.length)return NaN;var p=c[0];c=E(c);for(var y=c.next();!y.done;y=c.next())y=y.value,y.type==="variant"&&y.bandwidth>p.bandwidth&&(p=y);switch(l){case dv:return p.videoBandwidth||NaN;case JS:return p.audioBandwidth||NaN;default:return p.bandwidth}}function fv(i){function l(Te){return 100*c(Te/100)}function c(Te){return Math.round(Te)}function p(Te){return!Number.isNaN(Te)&&Te!=null&&Te!==""&&Te!==!1}var y=[],A={br:c,d:c,bl:l,dl:l,mtp:l,nor:function(Te){return encodeURIComponent(Te)},rtp:l,tb:c},P=Object.keys(i||{}).sort();P=E(P);for(var N=P.next();!N.done;N=P.next()){N=N.value;var G=i[N];if(p(G)&&(N!=="v"||G!==1)&&(N!="pr"||G!==1)){var q=A[N];q&&(G=q(G)),q=typeof G;var ae=void 0;ae=q==="string"&&N!=="ot"&&N!=="sf"&&N!=="st"?N+"="+JSON.stringify(G):q==="boolean"?N:q==="symbol"?N+"="+G.description:N+"="+G,y.push(ae)}}return y.join(",")}function vV(i){var l=Object.keys(i),c={},p=["Object","Request","Session","Status"],y=[{},{},{},{}],A={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};l=E(l);for(var P=l.next();!P.done;P=l.next())P=P.value,y[A[P]!=null?A[P]:1][P]=i[P];for(i=0;i<y.length;i++)(A=fv(y[i]))&&(c["CMCD-"+p[i]]=A);return c}function QS(i,l){if(!l||i.includes("offline:"))return i;var c=new pt(i);return c.g.set("CMCD",l),c.toString()}var gM="m",JS="a",dv="v",hv="av",yV="i",ZS="c",eA="tt",EV="v",_V="l";Le("shaka.util.CmcdManager.StreamingFormat",{Hh:"d",Vh:"h",Ci:"s",ki:"o"});function tA(){}function Yp(i,l,c,p,y){var A=y in p,P=!0,N;for(N in l){var G=y+"."+N,q=A?p[y]:c[N];A||N in c?l[N]===void 0?q===void 0||A?delete i[N]:i[N]=qu(q):q.constructor==Object&&l[N]&&l[N].constructor==Object?(i[N]||(i[N]=qu(q)),G=Yp(i[N],l[N],q,p,G),P=P&&G):typeof l[N]!=typeof q||l[N]==null||typeof l[N]!="function"&&l[N].constructor!=q.constructor?(pe("Invalid config, wrong type for "+G),P=!1):(typeof c[N]=="function"&&c[N].length!=l[N].length&&Re("Unexpected number of arguments for "+G),i[N]=l[N]):(pe("Invalid config, unrecognized key "+G),P=!1)}return P}function pv(i,l){for(var c={},p=c,y=0,A=0;y=i.indexOf(".",y),!(0>y);)(y==0||i[y-1]!="\\")&&(A=i.substring(A,y).replace(/\\\./g,"."),p[A]={},p=p[A],A=y+1),y+=1;return p[i.substring(A).replace(/\\\./g,".")]=l,c}Le("shaka.util.ConfigUtils",tA),tA.convertToConfigObject=pv,tA.mergeConfigObjects=Yp;function mM(){}function Xp(){var i=1/0;navigator.connection&&navigator.connection.saveData&&(i=360);var l={retryParameters:Xu(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:gi,logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[]},c={retryParameters:Xu(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,defaultPresentationDelay:0,dash:{clockSyncUri:"",ignoreDrmInfo:!1,disableXlinkProcessing:!1,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},manifestPreprocessor:function(P){return P}},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,useFullSegmentsForStartTime:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E"}},p={retryParameters:Xu(),failureCallback:function(P){return[P]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0,inaccurateManifestTolerance:2,lowLatencyMode:!1,autoLowLatencyMode:!1,forceHTTPS:!1,preferNativeHls:!1,updateIntervalSeconds:1,dispatchAllEmsgBoxes:!1,observeQualityChanges:!1};(navigator.userAgent.match(/Edge\//)||Pa()||zl())&&(p.gapDetectionThreshold=.5),(pi("Web0S")||Pa()||zl())&&(p.stallSkip=0);var y={trackSelectionCallback:function(P){return Z(function(N){return N.return(P)})},downloadSizeCallback:function(P){var N;return Z(function(G){return G.g==1?navigator.storage&&navigator.storage.estimate?I(G,navigator.storage.estimate(),3):G.return(!0):(N=G.h,G.return(N.usage+P<.95*N.quota))})},progressCallback:function(P,N){return[P,N]},usePersistentLicense:!0},A={drm:l,manifest:c,streaming:p,offline:y,abrFactory:function(){return new ni},abr:{enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:i,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoCodecs:[],preferredAudioCodecs:[],preferForcedSubs:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",useHeaders:!1}};return y.trackSelectionCallback=function(P){return Z(function(N){return N.return(TV(P,A.preferredAudioLanguage))})},A}function Ld(i,l,c){var p={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:""}};return Yp(i,l,c||Xp(),p,"")}function TV(i,l){var c=i.filter(function(N){return N.type=="variant"}),p=[],y=et(l,c.map(function(N){return N.language}));y&&(p=c.filter(function(N){return pn(N.language)==y})),p.length==0&&(p=c.filter(function(N){return N.primary})),p.length==0&&(c.map(function(N){return N.language}),p=c);var A=p.filter(function(N){return N.height&&480>=N.height});if(A.length&&(A.sort(function(N,G){return G.height-N.height}),p=A.filter(function(N){return N.height==A[0].height})),c=[],p.length){var P=Math.floor(p.length/2);p.sort(function(N,G){return N.bandwidth-G.bandwidth}),c.push(p[P])}for(p=E(i),P=p.next();!P.done;P=p.next())P=P.value,P.type!=Ke&&P.type!="image"||c.push(P);return c}Le("shaka.util.PlayerConfiguration",mM),mM.mergeConfigObjects=Ld;function SV(){this.g=null,this.h=[]}function gv(i,l){if(i.g==null)i.g={timestamp:Date.now()/1e3,state:l,duration:0};else{var c=Date.now()/1e3;i.g.duration=c-i.g.timestamp,i.g.state!=l&&(i.h.push(i.g),i.g={timestamp:c,state:l,duration:0})}}function nA(i,l){var c=0;i.g&&i.g.state==l&&(c+=i.g.duration);for(var p=E(i.h),y=p.next();!y.done;y=p.next())y=y.value,c+=y.state==l?y.duration:0;return c}function AV(i){function l(A){return{timestamp:A.timestamp,state:A.state,duration:A.duration}}for(var c=[],p=E(i.h),y=p.next();!y.done;y=p.next())c.push(l(y.value));return i.g&&c.push(l(i.g)),c}function xV(){this.i=this.h=null,this.g=[]}function rA(i,l,c){i.i!=l&&(i.i=l,i.g.push({timestamp:Date.now()/1e3,id:l.id,type:"text",fromAdaptation:c,bandwidth:null}))}function vM(){this.B=this.C=this.L=this.I=this.s=this.j=this.J=this.l=this.i=this.M=this.P=this.S=this.G=this.ea=NaN,this.g=new SV,this.h=new xV}function Yt(i,l){Ce.call(this);var c=this;this.l=pA,this.Db=this.g=null,this.ha=!1,this.h=new _r,this.nc=this.B=this.bb=this.H=this.Eb=this.C=this.i=this.ia=this.P=this.Gb=this.L=this.zb=this.J=this.Ca=this.I=this.M=this.s=this.V=null,this.se=1e9,this.m=Md(this),this.oe={width:1/0,height:1/0},this.j=null,this.sa=new zu(this.m.preferredAudioLanguage,this.m.preferredVariantRole,this.m.preferredAudioChannelCount),this.Aa=this.m.preferredTextLanguage,this.ob=this.m.preferredTextRole,this.cb=this.m.preferForcedSubs,this.Zd=[],this.pb=null,l&&l(this),this.V=UV(this),this.V.Ee(this.m.streaming.forceHTTPS),this.G=null,Av&&(this.G=Ft(Av)),this.h.o(o,"online",function(){c.we()}),this.Pa={name:"detach"},this.qb={name:"attach"},this.$={name:"unload"},this.ue={name:"manifest-parser"},this.ke={name:"manifest"},this.Ba={name:"media-source"},this.ae={name:"drm-engine"},this.S={name:"load"},this.xe={name:"src-equals-drm-engine"},this.Ua={name:"src-equals"};var p=new Map;p.set(this.qb,function(y,A){return Ls(IV(c,y,A))}),p.set(this.Pa,function(y){return y.K&&(c.h.Ta(y.K,"error"),y.K=null),c.G&&c.G.release(),c.g=null,y=Promise.resolve(),Ls(y)}),p.set(this.$,function(y){return Ls(EM(c,y))}),p.set(this.Ba,function(y){return y=RV(c,y),Ls(y)}),p.set(this.ue,function(y,A){var P=bV(c,y,A);return Ls(P)}),p.set(this.ke,function(y){return DV(c,y)}),p.set(this.ae,function(y){return y=PV(c,y),Ls(y)}),p.set(this.S,function(y,A){return Ls(LV(c,y,A))}),p.set(this.xe,function(y,A){var P=MV(c,y,A);return Ls(P)}),p.set(this.Ua,function(y,A){return wV(c,y,A)}),this.ka=new lM(this.Pa,{xg:function(y,A,P,N){var G=null;return y==c.Pa&&(G=P==c.Pa?c.Pa:c.qb),y==c.qb&&(G=P==c.Pa||A.K!=N.K?c.Pa:P==c.qb?c.qb:P==c.Ba||P==c.S?c.Ba:P==c.Ua?c.xe:null),y==c.Ba&&(G=P==c.S&&A.K==N.K?c.ue:c.$),y==c.ue&&(G=lA(c.S,c.ke,c.$,P,A,N)),y==c.ke&&(G=lA(c.S,c.ae,c.$,P,A,N)),y==c.ae&&(G=lA(c.S,c.S,c.$,P,A,N)),y==c.xe&&(G=P==c.Ua&&A.K==N.K?c.Ua:c.$),(y==c.S||y==c.Ua)&&(G=c.$),y==c.$&&(G=N.K&&A.K==N.K?c.qb:c.Pa),G},$f:function(y,A,P){return c.dispatchEvent(mi(tw,new Map().set("state",y.name))),p.get(y)(A,P)},handleError:function(y){return Z(function(A){return A.g==1?I(A,EM(c,y),2):A.return(y.K?c.qb:c.Pa)})},Tg:function(y){c.dispatchEvent(mi(nw,new Map().set("state",y.name)))}}),i&&this.Hc(i,!0)}D(Yt,Ce);function mi(i,l){return new De(i,l)}f=Yt.prototype,f.destroy=function(){var i=this,l;return Z(function(c){switch(c.g){case 1:return i.l==Do?c.return():(i.l=Do,l=$p(i.ka,function(){return{node:i.Pa,payload:Nd(),Rb:!1}}),I(c,new Promise(function(p){l.uc=function(){},l.vd=function(){p()},l.Xb=function(){p()},l.onError=function(){p()},l.xd=function(){p()}}),2));case 2:return I(c,i.ka.destroy(),3);case 3:if(i.h&&(i.h.release(),i.h=null),i.nc=null,i.B=null,i.m=null,i.j=null,i.Db=null,i.P=null,!i.V){c.D(4);break}return I(c,i.V.destroy(),5);case 5:i.V=null;case 4:Ce.prototype.release.call(i),U(c)}})};function yM(){if(o.Promise||Re("A Promise implementation or polyfill is required"),o.TextDecoder&&o.TextEncoder||Re("A TextDecoder/TextEncoder implementation or polyfill is required"),!(o.Promise&&o.Uint8Array&&o.TextDecoder&&o.TextEncoder&&Array.prototype.forEach)||pi("Trident/"))return!1;var i=ud();return i&&12>i||!(o.MediaKeys&&o.navigator&&o.navigator.requestMediaKeySystemAccess&&o.MediaKeySystemAccess&&o.MediaKeySystemAccess.prototype.getConfiguration)?!1:vs()?!0:Da("application/x-mpegurl")}f.Hc=function(i,l){if(l=l===void 0?!0:l,this.l==Do)return Promise.reject(pf());var c=Nd();c.K=i,vs()||(l=!1);var p=l?this.Ba:this.qb,y=$p(this.ka,function(){return{node:p,payload:c,Rb:!1}});return y.uc=function(){},uA(y)},f.detach=function(){var i=this;if(this.l==Do)return Promise.reject(pf());var l=$p(this.ka,function(){return{node:i.Pa,payload:Nd(),Rb:!1}});return l.uc=function(){},uA(l)},f.Qe=function(i){var l=this;if(i=i===void 0?!0:i,this.l==Do)return Promise.reject(pf());vs()||(i=!1);var c=Nd(),p=$p(this.ka,function(y){var A=y.K&&i?l.Ba:y.K?l.qb:l.Pa;return c.K=y.K,{node:A,payload:c,Rb:!1}});return p.uc=function(){},uA(p)},f.vh=function(i){this.pb=i},f.load=function(i,l,c){var p=this;if(this.pb=null,this.l==Do)return Promise.reject(pf());this.dispatchEvent(mi(QM));var y=Nd();y.uri=i,y.Le=Date.now()/1e3,c&&(y.mimeType=c),l!==void 0&&(y.startTime=l);var A=CV(this,y)?this.Ua:this.S,P=$p(this.ka,function(N){return N.K==null?null:(y.K=N.K,{node:A,payload:y,Rb:!0})});return this.j=new vM,this.P=GV(this),P.uc=function(){},new Promise(function(N,G){P.xd=function(){return G(new We(2,7,7002))},P.vd=function(){N(),p.dispatchEvent(mi(qM))},P.Xb=function(){return G(pf())},P.onError=function(q){return G(q)}})};function CV(i,l){if(!vs())return!0;var c=l.mimeType,p=l.uri||"";if(c||(c=af(p),c=mA[c]),c){if((l.K||cd()).canPlayType(c)=="")return!1;if(!vs()||!(c in qa||af(p)in of)||i.m.streaming.preferNativeHls)return!0;if(Yl())return i.m.streaming.useNativeHlsOnSafari}return!1}function IV(i,l,c){return l.K==null&&(l.K=c.K,i.h.o(l.K,"error",function(){var p=oA(i);p&&hf(i,p)})),i.g=l.K,Promise.resolve()}function EM(i,l){var c,p,y,A,P,N,G,q,ae;return Z(function(Te){switch(Te.g){case 1:return i.l!=Do&&(i.l=pA),c=i.Zd.map(function(Ie){return Ie()}),i.Zd=[],I(Te,Promise.all(c),2);case 2:if(i.dispatchEvent(mi(lw)),l.mimeType=null,l.startTime=null,l.uri=null,l.K&&(i.h.Ta(l.K,"loadedmetadata"),i.h.Ta(l.K,"playing"),i.h.Ta(l.K,"pause"),i.h.Ta(l.K,"ended"),i.h.Ta(l.K,"ratechange")),i.Ca&&(i.Ca.release(),i.Ca=null),i.zb&&(i.zb.stop(),i.zb=null),!i.C){Te.D(3);break}return I(Te,i.C.stop(),4);case 4:i.C=null,i.Eb=null;case 3:if(!i.B){Te.D(5);break}return I(Te,i.B.stop(),5);case 5:if(!i.i){Te.D(7);break}return I(Te,i.i.destroy(),8);case 8:i.i=null;case 7:if(i.J&&(i.J.release(),i.J=null),i.I&&(i.I.release(),i.I=null),!i.M){Te.D(9);break}return I(Te,i.M.destroy(),10);case 10:i.M=null;case 9:if(i.G&&i.G.onAssetUnload(),!l.K||!l.K.src){Te.D(11);break}return I(Te,new Promise(function(Ie){return new kn(Ie).U(.1)}),12);case 12:for(l.K.removeAttribute("src"),l.K.load();l.K.lastChild;)l.K.removeChild(l.K.firstChild);case 11:if(!i.s){Te.D(13);break}return I(Te,i.s.destroy(),14);case 14:i.s=null;case 13:if(i.bb=null,i.L=null,i.H){for(p=E(i.H.variants),y=p.next();!y.done;y=p.next())for(A=y.value,P=E([A.audio,A.video]),N=P.next();!N.done;N=P.next())(G=N.value)&&G.segmentIndex&&G.segmentIndex.release();for(q=E(i.H.textStreams),N=q.next();!N.done;N=q.next())ae=N.value,ae.segmentIndex&&ae.segmentIndex.release()}i.H=null,i.j=new vM,i.fe=null,sA(i),U(Te)}})}function RV(i,l){var c,p,y,A;return Z(function(P){if(P.g==1)return c=new wL,p=i.m.textDisplayFactory,y=Ft(p),i.fe=p,A=KV(l.K,c,y,function(N,G,q){N=E(N);for(var ae=N.next();!ae.done;ae=N.next())if(ae=ae.value,ae.data&&ae.cueTime&&ae.frames){for(var Te=ae.cueTime+G,Ie=q,Ne=E(ae.frames),Ve=Ne.next();!Ve.done;Ve=Ne.next())_M(i,Te,Ie,"ID3",Ve.value);i.G&&i.G.onHlsTimedMetadata(ae,Te)}}),I(P,A.I,2);i.M=A,U(P)})}function bV(i,l,c){var p,y,A,P;return Z(function(N){if(N.g==1)return l.mimeType=c.mimeType,l.uri=c.uri,p=l.uri,y=i.V,i.bb=p,A=i,I(N,aL(p,y,i.m.manifest.retryParameters,l.mimeType),2);A.Eb=N.h,i.C=Ft(i.Eb),P=qu(i.m.manifest),c.K&&c.K.nodeName==="AUDIO"&&(P.disableVideo=!0),i.C.configure(P),U(N)})}function DV(i,l){var c=l.uri,p=i.V;i.Gb=new HS(function(){return i.Na()}),i.Gb.addEventListener("regionadd",function(P){P=P.region,Qp(i,aw,P),i.G&&i.G.onDashTimedMetadata(P)}),i.ia=null,i.m.streaming.observeQualityChanges&&(i.ia=new ov(function(){return i.Ib()}),i.ia.addEventListener("qualitychange",function(P){var N=P.quality;P=P.position,N=new Map().set("mediaQuality",{bandwidth:N.bandwidth,audioSamplingRate:N.audioSamplingRate,codecs:N.codecs,contentType:N.contentType,frameRate:N.frameRate,height:N.height,mimeType:N.mimeType,channelsCount:N.channelsCount,pixelAspectRatio:N.pixelAspectRatio,width:N.width}).set("position",P),i.dispatchEvent(mi(ZM,N))}));var y={networkingEngine:p,modifyManifestRequest:function(P,N){var G=i.P;try{G.m.enabled&&(G.l=N.format,qS(G,P,{ot:gM,su:!G.g}))}catch(q){me("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",q)}},modifySegmentRequest:function(P,N){hM(i.P,P,N)},filter:function(P){return DM(i,P)},makeTextStreamsForClosedCaptions:function(P){return VV(i,P)},onTimelineRegionAdded:function(P){var N=i.Gb;e:{for(var G=E(N.g),q=G.next();!q.done;q=G.next())if(q=q.value,q.schemeIdUri==P.schemeIdUri&&q.id==P.id&&q.startTime==P.startTime&&q.endTime==P.endTime){G=q;break e}G=null}G==null&&(N.g.add(P),P=new De("regionadd",new Map([["region",P]])),N.dispatchEvent(P))},onEvent:function(P){return i.dispatchEvent(P)},onError:function(P){return hf(i,P)},isLowLatencyMode:function(){return i.m.streaming.lowLatencyMode},isAutoLowLatencyMode:function(){return i.m.streaming.autoLowLatencyMode},enableLowLatencyMode:function(){i.configure("streaming.lowLatencyMode",!0)}},A=Date.now()/1e3;return new Dr(function(){var P,N,G,q;return Z(function(ae){if(ae.g==1)return P=i,I(ae,i.C.start(c,y),2);if(P.H=ae.h,N=mi(JM),i.dispatchEvent(N),i.H.variants.length==0)throw new We(2,4,4036);kV(i.H),G=Date.now()/1e3,q=G-A,i.j.J=q,U(ae)})}(),function(){return i.C.stop()})}function PV(i,l){var c,p;return Z(function(y){return y.g==1?(c=Date.now()/1e3,p=!0,i.s=SM(i,{Wb:i.V,onError:function(A){hf(i,A)},wd:function(A){FM(i,A)},onExpirationUpdated:function(A,P){kM(i,A,P)},onEvent:function(A){i.dispatchEvent(A),A.type==cA&&p&&(p=!1,i.j.j=Date.now()/1e3-c)}}),i.s.configure(i.m.drm),I(y,ot(i.s,i.H.variants,i.H.offlineSessionIds),2)):y.g!=3?I(y,i.s.Hc(l.K),3):I(y,DM(i,i.H),0)})}function LV(i,l,c){var p,y,A,P,N,G,q,ae,Te,Ie,Ne;return Z(function(Ve){switch(Ve.g){case 1:if(l.startTime=c.startTime,i.pb!=null&&(l.startTime=i.pb,i.pb=null),p=l.K,y=l.uri,i.bb=y,i.J=new Kp({sd:function(){return l.K.playbackRate},pd:function(){return l.K.defaultPlaybackRate},Ge:function(qe){l.K.playbackRate=qe},uf:function(qe){l.K.currentTime+=qe}}),A=function(){return vv(i)},P=function(){return LM(i)},i.h.o(p,"playing",A),i.h.o(p,"pause",A),i.h.o(p,"ended",A),i.h.o(p,"ratechange",P),N=i.m.abrFactory,i.B&&i.nc==N||(i.nc=N,i.B=Ft(N),typeof i.B.playbackRateChanged!="function"&&(Ct("AbrManager","Please use an AbrManager with playbackRateChanged function."),i.B.playbackRateChanged=function(){}),i.B.configure(i.m.abr)),i.sa=new zu(i.m.preferredAudioLanguage,i.m.preferredVariantRole,i.m.preferredAudioChannelCount),i.Aa=i.m.preferredTextLanguage,i.ob=i.m.preferredTextRole,i.cb=i.m.preferForcedSubs,UM(i.H.presentationTimeline,i.m.playRangeStart,i.m.playRangeEnd),i.B.init(function(qe,Ze,Qe){i.i&&qe!=i.i.h&&Ev(i,qe,!0,Ze===void 0?!1:Ze,Qe===void 0?0:Qe)}),i.I=BV(i,l.startTime),i.Ca=jV(i),G=Math.max(i.H.minBufferTime,i.m.streaming.rebufferingGoal),AM(i,G),fd(i.H,i.m.preferredVideoCodecs,i.m.preferredAudioCodecs,i.m.preferredAudioChannelCount,i.m.preferredDecodingAttributes),i.i=WV(i),i.i.configure(i.m.streaming),i.l=Oa,i.dispatchEvent(mi(fA)),q=null,i.fb().find(function(qe){return qe.active})){Ve.D(2);break}if(q=wd(i)?i.B.chooseVariant():null,Ev(i,q,!0,!1,0),!i.m.streaming.startAtSegmentBoundary){Ve.D(3);break}return ae=i.I.l(),I(Ve,zV(q,ae),4);case 4:Te=Ve.h,i.I.s(Te);case 3:MM(i,null,ql(q));case 2:return Ie=i.vb().find(function(qe){return qe.active}),Ie||((Ne=Dp(i.H.textStreams,i.Aa,i.ob,i.cb)[0]||null)&&rA(i.j.h,Ne,!0),q&&(Ne?(q.audio&&YV(i,q.audio,Ne)&&(i.ha=!0),i.ha&&i.M.s.setTextVisibility(!0),OM(i)):i.ha=!1),Ne&&(i.m.streaming.alwaysStreamText||i.Vb())&&uv(i.i,Ne)),I(Ve,i.i.start(),5);case 5:i.m.abr.enabled&&(i.B.enable(),NM(i)),il(i.i?i.i.h:null,i.H),jM(i.H),wa(i),wd(i),i.H.variants.some(function(qe){return qe.primary}),i.h.Qa(p,"loadedmetadata",function(){i.j.l=Date.now()/1e3-c.Le}),U(Ve)}})}function MV(i,l,c){var p,y,A,P,N,G,q;return Z(function(ae){return ae.g==1?(p=ut,y=Date.now()/1e3,A=!0,i.s=SM(i,{Wb:i.V,onError:function(Te){hf(i,Te)},wd:function(Te){FM(i,Te)},onExpirationUpdated:function(Te,Ie){kM(i,Te,Ie)},onEvent:function(Te){i.dispatchEvent(Te),Te.type==cA&&A&&(A=!1,i.j.j=Date.now()/1e3-y)}}),i.s.configure(i.m.drm),P=c.uri||"",N=af(P),G=mA[N],G=="application/x-mpegurl"&&Yl()&&(G="application/vnd.apple.mpegurl"),G||(G="video/mp4"),q={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:c.mimeType?c.mimeType.split(";")[0]:G,codecs:c.mimeType?ld(c.mimeType):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",label:null,type:p.mb,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null},bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},i.s.S=!0,I(ae,ot(i.s,[q],[]),2)):I(ae,i.s.Hc(l.K),0)})}function wV(i,l,c){function p(){return vv(i)}l.uri=c.uri,l.startTime=c.startTime,i.bb=l.uri,i.I=new Bp(l.K),l.startTime!=null&&i.I.s(l.startTime),i.J=new Kp({sd:function(){return l.K.playbackRate},pd:function(){return l.K.defaultPlaybackRate},Ge:function(N){l.K.playbackRate=N},uf:function(N){l.K.currentTime+=N}}),AM(i,i.m.streaming.rebufferingGoal),i.h.o(l.K,"playing",p),i.h.o(l.K,"pause",p),i.h.o(l.K,"ended",p),i.h.o(l.K,"ratechange",function(){return LM(i)}),i.g.preload!="none"&&i.h.Qa(i.g,"loadedmetadata",function(){i.j.l=Date.now()/1e3-c.Le}),i.g.audioTracks&&(i.h.o(i.g.audioTracks,"addtrack",function(){return wa(i)}),i.h.o(i.g.audioTracks,"removetrack",function(){return wa(i)}),i.h.o(i.g.audioTracks,"change",function(){return wa(i)})),i.g.textTracks&&(i.h.o(i.g.textTracks,"addtrack",function(N){if(N.track)switch(N=N.track,N.kind){case"metadata":FV(i,N);break;case"chapters":TM(i,N);break;default:wa(i)}}),i.h.o(i.g.textTracks,"removetrack",function(){return wa(i)}),i.h.o(i.g.textTracks,"change",function(){return wa(i)}));var y=af(l.uri);l.K.src=hV(i.P,l.uri,mA[y]),(Pa()||pi("Web0S"))&&l.K.load(),i.l=Ja,i.dispatchEvent(mi(fA));var A=new Rt;ff(i.g,HTMLMediaElement.HAVE_METADATA,i.h,function(){A.resolve()});var P=!1;return i.Zd.push(function(){P=!0}),ff(i.g,HTMLMediaElement.HAVE_CURRENT_DATA,i.h,function(){var N;return Z(function(G){if(G.g==1)return P?G.return():(OV(i),N=qp(i),N.find(function(q){return q.mode!="disabled"})?G.D(2):I(G,new Promise(function(q){i.h.Qa(i.g.textTracks,"change",q),new kn(q).U(1)}),2));if(P)return G.return();NV(i),U(G)})}),i.g.error?A.reject(oA(i)):i.g.preload=="none"&&(Re('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),A.resolve()),i.h.Qa(i.g,"error",function(){A.reject(oA(i))}),new Dr(A,function(){return A.reject(new We(2,7,7001)),Promise.resolve()})}function OV(i){var l=i.m.preferredAudioLanguage;if(l!=""){i.Dd(l);var c=i.m.preferredVariantRole;c!=""&&i.Dd(l,c)}}function NV(i){var l=i.m.preferredTextLanguage,c=i.m.preferForcedSubs;if(l!=""){i.ze(l,"",c);var p=i.m.preferredTextRole;p!=""&&i.ze(l,p,c)}}function FV(i,l){l.kind=="metadata"&&(l.mode="hidden",i.h.o(l,"cuechange",function(){if(l.activeCues)for(var c=E(l.activeCues),p=c.next();!p.done;p=c.next())p=p.value,_M(i,p.startTime,p.endTime,p.type,p.value),i.G&&i.G.onCueMetadataChange(p.value)}),new kn(function(){var c=HV(i);c=E(c);for(var p=c.next();!p.done;p=c.next())p.value.mode="hidden"}).Ga().U(.5))}function _M(i,l,c,p,y){l=new Map().set("startTime",l).set("endTime",c).set("metadataType",p).set("payload",y),i.dispatchEvent(mi(ew,l))}function TM(i,l){l&&l.kind=="chapters"&&(l.mode="hidden",new kn(function(){var c=mv(i);c=E(c);for(var p=c.next();!p.done;p=c.next())p.value.mode="hidden"}).Ga().U(.5))}function kV(i){function l(c){return c.video&&c.audio||c.video&&c.video.codecs.includes(",")}i.variants.some(l)&&(i.variants=i.variants.filter(l))}function SM(i,l){return new Ge(l,i.m.drm.updateExpirationTime)}function UV(i){return new Tr(function(l,c){i.B&&i.B.segmentDownloaded(l,c)},function(l,c,p){l=new Map().set("headers",l).set("request",c).set("requestType",p),i.dispatchEvent(mi(zM,l))},function(l,c,p,y){l=new Map().set("request",l).set("error",c).set("httpResponseCode",p).set("aborted",y),i.dispatchEvent(mi($M,l))})}function BV(i,l){return new jp(i.g,i.H,i.m.streaming,l,function(){if(i.Ca&&tM(i.Ca,!0),i.i)for(var c=i.i,p=c.F.rd(),y=c.m.smallGapLimit,A=E(c.g.keys()),P=A.next();!P.done;P=A.next()){P=P.value;var N=c.g.get(P);N.za=null;var G=c.F.Y;if(P==Ke?(G=G.i,G=G.g==null||G.h==null?!1:p>=G.g&&p<G.h):(G=Rd(G,P),G=kS(G,p,y)),!G&&((sv(c.F.Y,P)!=null||N.hb)&&XH(c,N),N.Ra&&(N.Ra.abort(),N.Ra=null),P===Ke))for(P=c.F.Y.G.g,P.l=0,P.h=[],P.g=[],N=P.i,N.i=[],N.h=[],N.g=0,MS(P),P=E(P.j.values()),N=P.next();!N.done;N=P.next())RL(N.value)}i.L&&iA(i)},function(c){return i.dispatchEvent(c)})}function jV(i){var l=new lv(i.Gb);l.addEventListener("enter",function(p){Qp(i,dA,p.region)}),l.addEventListener("exit",function(p){Qp(i,hA,p.region)}),l.addEventListener("skip",function(p){var y=p.region;p.seeking||(Qp(i,dA,y),Qp(i,hA,y))});var c=new eM(i.g);return c.g.add(l),i.ia&&c.g.add(i.ia),c}function AM(i,l){i.L=new W0,i.L.g=Ql,Pp(i.L,l,Math.min(.5,l/2)),sA(i),i.zb=new kn(function(){iA(i)}).na(.25)}function iA(i){switch(i.l){case Ja:if(i.g.ended)var l=!0;else{var c=FS(i.g.buffered);l=c!=null&&c>=i.g.duration-1}break;case Oa:e:if(i.g.ended||FL(i.M))l=!0;else{if(i.H.presentationTimeline.W()){c=i.H.presentationTimeline.Qb();var p=FS(i.g.buffered);if(p!=null&&p>=c){l=!0;break e}}l=!1}break;default:l=!1}p=OL(i.g.buffered,i.g.currentTime),c=i.L;var y=l,A=c.h.get(c.g);l=c.g,p=y||p>=A?Yu:Ql,c.g=p,l!=p&&sA(i)}function KV(i,l,c,p){return new NL(i,l,c,p)}function GV(i){return new dV({getBandwidthEstimate:function(){return i.B?i.B.getBandwidthEstimate():NaN},Ib:function(){return i.Ib()},kg:function(){return i.g?i.g.currentTime:0},fb:function(){return i.fb()},Jb:function(){return i.Jb()},W:function(){return i.W()}},i.m.cmcd)}function WV(i){return new Vp(i.H,{rd:function(){return i.I.l()},getBandwidthEstimate:function(){return i.B.getBandwidthEstimate()},modifySegmentRequest:function(l,c){hM(i.P,l,c)},Y:i.M,Wb:i.V,onError:function(l){return hf(i,l)},onEvent:function(l){return i.dispatchEvent(l)},Vg:function(){i.C&&i.C.update&&i.C.update()},qe:function(){i.I&&i.I.I(),iA(i)},Ug:function(l,c){var p=c.ge;p&&i.ia&&WH(i.ia,p,l)}})}f.configure=function(i,l){arguments.length==2&&typeof i=="string"&&(i=pv(i,l)),i.manifest&&i.manifest.dash&&"defaultPresentationDelay"in i.manifest.dash&&(Ct("manifest.dash.defaultPresentationDelay configuration","Please Use manifest.defaultPresentationDelay instead."),i.manifest.defaultPresentationDelay=i.manifest.dash.defaultPresentationDelay,delete i.manifest.dash.defaultPresentationDelay),i.streaming&&i.streaming.lowLatencyMode&&(i.streaming.inaccurateManifestTolerance==null&&(i.streaming.inaccurateManifestTolerance=0),i.streaming.rebufferingGoal==null&&(i.streaming.rebufferingGoal=.01));var c=Ld(this.m,i,Md(this));return xM(this),c};function xM(i){if(i.C){var l=qu(i.m.manifest);i.g&&i.g.nodeName==="AUDIO"&&(l.disableVideo=!0),i.C.configure(l)}if(i.s&&i.s.configure(i.m.drm),i.i){i.i.configure(i.m.streaming);try{PM(i,i.H)}catch(A){hf(i,A)}i.B&&wd(i),l=i.i.h,!l||l.allowedByApplication&&l.allowedByKeySystem||yv(i)}if(i.V&&i.V.Ee(i.m.streaming.forceHTTPS),i.M&&(l=i.m.textDisplayFactory,i.fe!=l)){var c=Ft(l),p=i.M,y=p.s;p.s=c,y&&(c.setTextVisibility(y.isTextVisible()),y.destroy()),p.i&&(p.i.i=c),i.fe=l,i.i&&(l=i.i,(c=l.g.get(Ke))&&Dd(l,c.stream,!0,0,!0))}i.B&&(i.B.configure(i.m.abr),i.m.abr.enabled?i.B.enable():i.B.disable(),NM(i)),i.L&&(l=i.m.streaming.rebufferingGoal,i.H&&(l=Math.max(l,i.H.minBufferTime)),Pp(i.L,l,Math.min(.5,l/2))),i.H&&UM(i.H.presentationTimeline,i.m.playRangeStart,i.m.playRangeEnd)}f.getConfiguration=function(){var i=Md(this);return Ld(i,this.m,Md(this)),i},f.dg=function(){if(this.g){var i=this.g.buffered.length;i=i?this.g.buffered.end(i-1):0;var l=this.getConfiguration().streaming.bufferingGoal;if(l=Math.min(this.g.currentTime+l,this.Na().end),i>=l)return 1;if(!(i<=this.g.currentTime)&&i<l)return(i-this.g.currentTime)/(l-this.g.currentTime)}return 0},f.gh=function(){for(var i in this.m)delete this.m[i];Ld(this.m,Md(this),Md(this)),xM(this)},f.kf=function(){return this.l},f.wg=function(){return this.g},f.Mc=function(){return this.V},f.Yd=function(){return this.bb},f.od=function(){return this.G?this.G:null},f.W=function(){return this.H?this.H.presentationTimeline.W():this.g&&this.g.src?this.g.duration==1/0:!1},f.Tb=function(){return this.H?this.H.presentationTimeline.Tb():!1},f.pf=function(){if(this.H){var i=this.H.variants;return i.length?!i[0].video:!1}return this.g&&this.g.src?this.g.videoTracks?this.g.videoTracks.length==0:this.g.videoHeight==0:!1},f.Na=function(){if(this.H){var i=this.H.presentationTimeline;return{start:i.mc(),end:i.sb()}}return this.g&&this.g.src&&(i=this.g.seekable,i.length)?{start:i.start(0),end:i.end(i.length-1)}:{start:0,end:0}},f.Jg=function(){this.W()&&(this.g.currentTime=this.Na().end)},f.keySystem=function(){var i=this.drmInfo();return i?i.keySystem:""},f.drmInfo=function(){return this.s?this.s.i:null},f.Lc=function(){return this.s?this.s.Lc():1/0},f.qd=function(){return this.s?this.s.qd():{}},f.Rc=function(){return this.L?this.L.g==Ql:!1},f.Jb=function(){return this.g?this.J?this.J.i:1:0},f.Pe=function(i){i==0?Re("A trick play rate of 0 is unsupported!"):(this.g.paused&&this.g.play(),this.J.set(i),this.l==Oa&&(this.B.playbackRateChanged(i),nM(this.i,1<Math.abs(i))))},f.Ue=function(){var i=this.J.pd();this.l==Ja&&this.J.set(i),this.l==Oa&&(this.J.set(i),this.B.playbackRateChanged(i),nM(this.i,!1))},f.fb=function(){if(this.H){for(var i=this.i?this.i.h:null,l=[],c=0,p=E(this.H.variants),y=p.next();!y.done;y=p.next())if(y=y.value,nf(y)){var A=ql(y);A.active=y==i,A.active||c==1||i==null||y.video!=i.video||y.audio!=i.audio||(A.active=!0),A.active&&c++,l.push(A)}return l}return this.g&&this.g.audioTracks?Array.from(this.g.audioTracks).map(function(P){return md(P)}):[]},f.vb=function(){if(this.H){for(var i=this.i?this.i.i:null,l=[],c=E(this.H.textStreams),p=c.next();!p.done;p=c.next()){p=p.value;var y=tf(p);y.active=p==i,l.push(y)}return l}return this.g&&this.g.src&&this.g.textTracks?qp(this).map(function(A){return w0(A)}):[]},f.ng=function(){return this.H?this.H.imageStreams.map(function(i){return Rp(i)}):[]},f.Fg=function(i,l){var c=this,p,y,A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe,Ze,Qe,Lt,It,yt;return Z(function(Jt){return Jt.g==1?c.H?(p=c.H.imageStreams.find(function(un){return un.id==i}))?p.segmentIndex?Jt.D(3):I(Jt,p.createSegmentIndex(),3):Jt.return(null):Jt.D(2):Jt.g!=2?(y=p.segmentIndex.find(l),y==null||(A=p.segmentIndex.get(y),P=A.tilesLayout||p.tilesLayout,N=/(\d+)x(\d+)/.exec(P),!N)?Jt.return(null):(G=p.width||0,q=p.height||0,ae=parseInt(N[1],10),Te=parseInt(N[2],10),Ie=G/ae,Ne=q/Te,Ve=ae*Te,qe=A.l-A.startTime,Ze=A.i||qe/Ve,Qe=A.startTime,It=Lt=0,1<Ve&&(yt=Math.floor((l-A.startTime)/Ze),Qe=A.startTime+yt*Ze,Lt=yt%ae*Ie,It=Math.floor(yt/ae)*Ne),Jt.return({imageHeight:q,imageWidth:G,height:Ne,positionX:Lt,positionY:It,startTime:Qe,duration:Ze,uris:A.Ma(),width:Ie}))):Jt.return(null)})},f.Ae=function(i){if(this.H&&this.i){var l=this.H.textStreams.find(function(p){return p.id==i.id});l&&l!=this.i.i&&(rA(this.j.h,l,!1),uv(this.i,l),_v(this),this.Aa=l.language)}else if(this.g&&this.g.src&&this.g.textTracks){l=qp(this),l=E(l);for(var c=l.next();!c.done;c=l.next())c=c.value,bp(c)==i.id?c.mode=this.ha?"showing":"hidden":c.mode="disabled";_v(this)}},f.Be=function(i,l,c){if(l=l===void 0?!1:l,c=c===void 0?0:c,this.H&&this.i){this.m.abr.enabled&&Re("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var p=this.H.variants.find(function(y){return y.id==i.id});p&&nf(p)&&(Ev(this,p,!1,l,c),this.sa=new j0(p),wd(this))}else if(this.g&&this.g.audioTracks){for(l=Array.from(this.g.audioTracks),l=E(l),c=l.next();!c.done;c=l.next())if(c=c.value,bp(c)==i.id){aA(this,c);break}}},f.cg=function(){return GM(this.fb())},f.Eg=function(){return GM(this.vb())},f.ag=function(){return Array.from(KM(this.fb()))},f.Dg=function(){return Array.from(KM(this.vb()))},f.Dd=function(i,l){if(this.H&&this.I){this.sa=new zu(i,l||"",0,"");var c=function(G,q){return G.video||q.video?G.video&&q.video?Math.abs((G.video.height||0)-(q.video.height||0))+Math.abs((G.video.width||0)-(q.video.width||0)):1/0:0},p=this.i.h,y=this.sa.create(this.H.variants),A=null;y=E(y.values());for(var P=y.next();!P.done;P=y.next())P=P.value,(!A||c(A,p)>c(P,p))&&(A=P);A?(c=ql(A),this.Be(c,!0)):yv(this)}else if(this.g&&this.g.audioTracks){for(y=Array.from(this.g.audioTracks),c=pn(i),A=p=null,y=E(y),P=y.next();!P.done;P=y.next()){P=P.value;var N=md(P);pn(N.language)==c&&(p=P,l?N.roles.includes(l)&&(A=P):N.roles.length==0&&(A=P))}A?aA(this,A):p&&aA(this,p)}},f.ze=function(i,l,c){if(c=c===void 0?!1:c,this.H&&this.I)this.Aa=i,this.ob=l||"",this.cb=c,(i=Dp(this.H.textStreams,this.Aa,this.ob,this.cb)[0]||null)&&i!=this.i.i&&(rA(this.j.h,i,!1),this.m.streaming.alwaysStreamText||this.Vb())&&(uv(this.i,i),_v(this));else{var p=pn(i);(i=this.vb().find(function(y){return pn(y.language)==p&&(!l||y.roles.includes(l))&&y.forced==c}))&&this.Ae(i)}},f.ih=function(i){if(this.H&&this.I){for(var l=null,c=E(this.H.variants),p=c.next();!p.done;p=c.next())if(p=p.value,p.audio.label==i){l=p;break}l!=null&&(this.sa=new zu(l.language,"",0,i),yv(this))}},f.Vb=function(){var i=this.ha;return this.M?this.M.s.isTextVisible():this.g&&this.g.src&&this.g.textTracks?qp(this).some(function(l){return l.mode=="showing"}):i},f.hf=function(){return this.g&&this.g.src&&this.g.textTracks?mv(this).map(function(i){return w0(i)}):[]},f.fg=function(i){var l=pn(i),c=mv(this).filter(function(A){return pn(A.language)==l});if(!c||!c.length)return[];i=[],c=E(c);for(var p=c.next();!p.done;p=c.next())if((p=p.value)&&p.cues){p=E(p.cues);for(var y=p.next();!y.done;y=p.next())y=y.value,i.push({title:y.text,startTime:y.startTime,endTime:y.endTime})}return i};function qp(i){return Array.from(i.g.textTracks).filter(function(l){return l.kind!="metadata"&&l.kind!="chapters"&&l.label!="Shaka Player TextTrack"})}function HV(i){return Array.from(i.g.textTracks).filter(function(l){return l.kind=="metadata"})}function mv(i){return Array.from(i.g.textTracks).filter(function(l){return l.kind=="chapters"})}f.Je=function(i){if(i=!!i,this.ha!=i){if(this.ha=i,this.l==Oa)this.M.s.setTextVisibility(i),this.m.streaming.alwaysStreamText||(i?this.i.i||(i=Dp(this.H.textStreams,this.Aa,this.ob,this.cb),0<i.length&&(uv(this.i,i[0]),_v(this))):zH(this.i));else if(this.g&&this.g.src&&this.g.textTracks){var l=qp(this);l=E(l);for(var c=l.next();!c.done;c=l.next())c=c.value,c.mode!="disabled"&&(c.mode=i?"showing":"hidden")}OM(this)}},f.yg=function(){if(!this.W())return null;var i=this.ka.l,l=0;if(this.I)l=this.I.l();else if(i){if(i.startTime==null)return new Date;l=i.startTime}return this.H?new Date(1e3*(this.H.presentationTimeline.j+l)):this.g&&this.g.getStartDate?(i=this.g.getStartDate(),isNaN(i.getTime())?null:new Date(i.getTime()+1e3*l)):null},f.lf=function(){if(!this.W())return null;if(this.H)return new Date(1e3*this.H.presentationTimeline.j);if(this.g&&this.g.getStartDate){var i=this.g.getStartDate();return isNaN(i.getTime())?null:i}return null},f.Ib=function(){if(this.l==Oa)return this.M.Ib();var i={total:[],audio:[],video:[],text:[]};return this.l==Ja&&(i.total=Ju(this.g.buffered)),i},f.getStats=function(){if(this.l!=Oa&&this.l!=Ja)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,switchHistory:[],stateHistory:[]};vv(this);var i=this.g,l=i.currentTime/i.duration;if(!isNaN(l)){var c=this.j;l=Math.round(100*l),c.i=isNaN(c.i)?l:Math.max(c.i,l)}i.getVideoPlaybackQuality&&(i=i.getVideoPlaybackQuality(),c=this.j,l=Number(i.totalVideoFrames),c.S=Number(i.droppedVideoFrames),c.P=l,this.j.M=Number(i.corruptedVideoFrames)),this.s?(i=this.s,i=i.I?i.I:NaN):i=NaN,this.j.s=i,this.l==Oa&&((i=this.i.h)&&(this.j.C=(this.J?this.J.i:1)*i.bandwidth),i&&i.video&&(c=this.j,l=i.video.height||NaN,c.ea=i.video.width||NaN,c.G=l),this.W()&&(i=this.lf().valueOf()+1e3*this.Na().end,this.j.I=(Date.now()-i)/1e3),this.H&&this.H.presentationTimeline&&(this.j.L=this.H.presentationTimeline.g),i=this.B.getBandwidthEstimate(),this.j.B=i);var p=this.j;i=p.ea,c=p.G,l=p.C;var y=p.P,A=p.S,P=p.M,N=p.B,G=p.i,q=p.l,ae=p.J,Te=p.j,Ie=nA(p.g,"playing"),Ne=nA(p.g,"paused"),Ve=nA(p.g,"buffering"),qe=p.s,Ze=p.I,Qe=p.L,Lt=AV(p.g),It=[];p=E(p.h.g);for(var yt=p.next();!yt.done;yt=p.next())yt=yt.value,It.push({timestamp:yt.timestamp,id:yt.id,type:yt.type,fromAdaptation:yt.fromAdaptation,bandwidth:yt.bandwidth});return{width:i,height:c,streamBandwidth:l,decodedFrames:y,droppedFrames:A,corruptedFrames:P,estimatedBandwidth:N,completionPercent:G,loadLatency:q,manifestTimeSeconds:ae,drmTimeSeconds:Te,playTime:Ie,pauseTime:Ne,bufferingTime:Ve,licenseTime:qe,liveLatency:Ze,maxSegmentDuration:Qe,stateHistory:Lt,switchHistory:It}},f.addTextTrack=function(i,l,c,p,y,A,P){if(P=P===void 0?!1:P,Ct("addTextTrack","Please use an addTextTrackAsync."),this.l!=Oa&&this.l!=Ja)throw new We(1,7,7004);if(!p){var N=af(i);if(p=dw[N],!p)throw new We(1,2,2011,N)}if(this.l==Ja){if(p!="text/vtt")throw new We(1,2,2013,p);if(P&&(c="forced"),p=document.createElement("track"),p.src=pM(this.P,i),p.label=A||"",p.kind=c,p.srclang=l,this.g.getAttribute("crossorigin")||this.g.setAttribute("crossorigin","anonymous"),this.g.appendChild(p),i=this.vb().find(function(G){return G.language==l&&G.label==(A||"")&&G.kind==c}))return wa(this),i;throw new We(1,2,2012)}if(N=this.H.presentationTimeline.getDuration(),N==1/0)throw new We(1,4,4033);if(i={id:this.se++,originalId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:av(0,N,[i]),mimeType:p||"",codecs:y||"",kind:c,encrypted:!1,drmInfos:[],keyIds:new Set,language:l,label:A||null,type:Ke,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!!P,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null},!$l(ui(i.mimeType,i.codecs)))throw new We(2,2,2014,p);return this.H.textStreams.push(i),wa(this),tf(i)},f.Rf=function(i,l,c,p,y,A,P){P=P===void 0?!1:P;var N=this,G,q,ae,Te,Ie,Ne,Ve,qe,Ze,Qe,Lt;return Z(function(It){switch(It.g){case 1:if(N.l!=Oa&&N.l!=Ja)throw new We(1,7,7004);if(p){It.D(2);break}return I(It,CM(N,i),3);case 3:p=It.h;case 2:if(G=[],N.G)try{G=N.G.getServerSideCuePoints()}catch{}if(N.l!=Ja){It.D(4);break}return P&&(c="forced"),I(It,IM(N,i,l,c,p,A||"",G),5);case 5:if(q=N.vb(),ae=q.find(function(yt){return yt.language==l&&yt.label==(A||"")&&yt.kind==c}))return wa(N),It.return(ae);throw new We(1,2,2012);case 4:if(Te=ut,Ie=N.H.presentationTimeline.getDuration(),Ie==1/0)throw new We(1,4,4033);if(!G.length){It.D(6);break}return I(It,RM(N,i,N.V,N.m.streaming.retryParameters),7);case 7:Ne=It.h,Ve=bM(N,Ne,p,G),qe=new Blob([Ve],{type:"text/vtt"}),i=jS(qe),p="text/vtt";case 6:if(Ze={id:N.se++,originalId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:av(0,Ie,[i]),mimeType:p||"",codecs:y||"",kind:c,encrypted:!1,drmInfos:[],keyIds:new Set,language:l,label:A||null,type:Te.ua,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!!P,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null},Qe=ui(Ze.mimeType,Ze.codecs),Lt=$l(Qe),!Lt)throw new We(2,2,2014,p);return N.H.textStreams.push(Ze),wa(N),It.return(tf(Ze))}})},f.Qf=function(i,l,c){var p=this,y,A,P,N,G,q,ae;return Z(function(Te){switch(Te.g){case 1:if(p.l!=Oa&&p.l!=Ja)throw new We(1,7,7004);if(c){Te.D(2);break}return I(Te,CM(p,i),3);case 3:c=Te.h;case 2:if(y=[],p.G)try{y=p.G.getServerSideCuePoints()}catch{}return I(Te,IM(p,i,l,"chapters",c,"",y),4);case 4:if(A=p.hf(),P=A.find(function(Ie){return Ie.language==l})){for(N=mv(p),G=E(N),q=G.next();!q.done;q=G.next())ae=q.value,TM(p,ae);return Te.return(P)}throw new We(1,2,2012)}})};function CM(i,l){var c,p;return Z(function(y){switch(y.g){case 1:return c=af(l),(p=dw[c])?y.return(p):(w(y,2),I(y,oL(l,i.V,i.m.streaming.retryParameters),4));case 4:p=y.h,K(y,3);break;case 2:W(y);case 3:if(p)return y.return(p);throw new We(1,2,2011,c)}})}function IM(i,l,c,p,y,A,P){var N,G,q,ae;return Z(function(Te){if(Te.g==1)return y!="text/vtt"||P.length?I(Te,RM(i,l,i.V,i.m.streaming.retryParameters),3):Te.D(2);Te.g!=2&&(N=Te.h,G=bM(i,N,y,P),q=new Blob([G],{type:"text/vtt"}),l=jS(q),y="text/vtt"),ae=document.createElement("track"),ae.src=pM(i.P,l),ae.label=A,ae.kind=p,ae.srclang=c,i.g.getAttribute("crossorigin")||i.g.setAttribute("crossorigin","anonymous"),i.g.appendChild(ae),U(Te)})}function RM(i,l,c,p){var y,A,P;return Z(function(N){if(N.g==1){y=Ro,A=Qs([l],p),A.method="GET";var G=i.P;try{G.m.enabled&&qS(G,A,{ot:ZS,su:!0})}catch(q){me("CMCD_TEXT_ERROR","Could not generate text CMCD data.",q)}return I(N,c.request(y,A).promise,2)}return P=N.h,N.return(P.data)})}function bM(i,l,c,p){var y=Hr[c];if(y)return c=y(),i={periodStart:0,segmentStart:0,segmentEnd:i.g.duration},l=er(l),l=c.parseMedia(l,i),fV(l,p);throw new We(2,2,2014,c)}f.Fe=function(i,l){this.oe.width=i,this.oe.height=l},f.we=function(){if(this.l==Oa){var i=this.i;if(i.N.g)i=!1;else if(i.j)i=!1;else{for(var l=E(i.g.values()),c=l.next();!c.done;c=l.next())c=c.value,c.Pc&&(c.Pc=!1,Qa(i,c,.1));i=!0}}else i=!1;return i},f.sg=function(){return Re("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.H},f.ug=function(){return this.Eb};function Md(i){var l=Xp();return l.streaming.failureCallback=function(c){var p=[1001,1002,1003];i.W()&&p.includes(c.code)&&(c.severity=1,i.we())},l.textDisplayFactory=function(){return i.Db?new Ma(i.g,i.Db):new La(i.g)},l}f.Ke=function(i){this.Db=i};function VV(i,l){for(var c=new Set,p=E(l.textStreams),y=p.next();!y.done;y=p.next())y=y.value,y.mimeType!="application/cea-608"&&y.mimeType!="application/cea-708"||c.add(y.originalId);for(p=E(l.variants),y=p.next();!y.done;y=p.next())if((y=y.value.video)&&y.closedCaptions){for(var A=E(y.closedCaptions.keys()),P=A.next();!P.done;P=A.next())if(P=P.value,!c.has(P)){var N=P.startsWith("CC")?"application/cea-608":"application/cea-708",G=new ri;N={id:i.se++,originalId:P,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:G,mimeType:N,codecs:"",kind:"caption",encrypted:!1,drmInfos:[],keyIds:new Set,language:y.closedCaptions.get(P),label:null,type:Ke,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:y.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null},l.textStreams.push(N),c.add(P)}}}function DM(i,l){return Z(function(c){if(c.g==1)return I(c,$V(i,l),2);PM(i,l),U(c)})}function $V(i,l){var c;return Z(function(p){if(p.g==1)return c=i.i?i.i.h:null,I(p,Zc(c,l),2);jM(l),U(p)})}function PM(i,l){if(i.l!=Do){for(var c=i.m.restrictions,p=i.oe,y=!1,A=E(l.variants),P=A.next();!P.done;P=A.next()){P=P.value;var N=P.allowedByApplication;P.allowedByApplication=Xl(P,c,p),N!=P.allowedByApplication&&(y=!0)}if(y&&i.i&&wa(i),(c=i.s?i.s.i:null)&&i.s.s){for(p=E(l.variants),y=p.next();!y.done;y=p.next())for(y=y.value,y=E((y.video?y.video.drmInfos:[]).concat(y.audio?y.audio.drmInfos:[])),A=y.next();!A.done;A=y.next())if(A=A.value,A.keySystem==c.keySystem)for(A=E(A.initData||[]),P=A.next();!P.done;P=A.next())P=P.value,Vn(i.s,P.initDataType,P.initData)}BM(i,l)}}function zV(i,l){var c,p,y,A,P;return Z(function(N){return N.g==1?(c=i.audio,p=i.video,y=function(G,q){var ae,Te;return Z(function(Ie){return Ie.g==1?G?I(Ie,G.createSegmentIndex(),2):Ie.return(null):(ae=G.segmentIndex[Symbol.iterator]().seek(q),ae?(Te=ae.startTime,Ie.return(Te)):Ie.return(null))})},I(N,y(c,l),2)):N.g!=3?(A=N.h,I(N,y(p,l),3)):(P=N.h,P!=null&&A!=null?N.return(Math.max(P,A)):P!=null?N.return(P):A!=null?N.return(A):N.return(l))})}function sA(i){var l=i.Rc();if(i.j&&i.L&&i.I){var c=i.J;c.j=l,ZL(c),i.P&&(c=i.P,l||c.g||(c.g=!0),c.g&&l&&(c.i=!0),c.j=l),vv(i)}l=new Map().set("buffering",l),i.dispatchEvent(mi(VM,l))}function LM(i){var l=i.g.playbackRate;l!=0&&(i.J&&i.J.set(l),l=mi(rw),i.dispatchEvent(l))}function vv(i){if(i.j&&i.L){var l=i.j.g;i.L.g==Ql?gv(l,"buffering"):i.g.paused?gv(l,"paused"):i.g.ended?gv(l,"ended"):gv(l,"playing")}}function wd(i){try{BM(i,i.H)}catch(c){return hf(i,c),!1}var l=i.H.variants.filter(function(c){return nf(c)});return l=i.sa.create(l),i.B.setVariants(Array.from(l.values())),!0}function yv(i){var l;(l=wd(i)?i.B.chooseVariant():null)&&Ev(i,l,!0,!0,0)}function Ev(i,l,c,p,y){var A=i.i.h;if(l==A)p&&rM(i.i,l,p,y,!0);else{var P=i.j.h;P.h!=l&&(P.h=l,P.g.push({timestamp:Date.now()/1e3,id:l.id,type:"variant",fromAdaptation:c,bandwidth:l.bandwidth})),rM(i.i,l,p,y),p=null,A&&(p=ql(A)),l=ql(l),c?MM(i,p,l):wM(i,p,l)}}function aA(i,l){var c=Array.from(i.g.audioTracks).find(function(y){return y.enabled});l.enabled=!0,l.id!==c.id&&(c.enabled=!1),c=md(c);var p=md(l);wM(i,c,p)}function YV(i,l,c){return i=pn(i.m.preferredTextLanguage),l=pn(l.language),c=pn(c.language),Qt(c,i)&&!Qt(l,c)}function MM(i,l,c){l=new Map().set("oldTrack",l).set("newTrack",c),l=mi(HM,l),Od(i,l)}function wa(i){var l=mi(ow);Od(i,l)}function wM(i,l,c){l=new Map().set("oldTrack",l).set("newTrack",c),l=mi(uw,l),Od(i,l)}function _v(i){var l=mi(iw);Od(i,l)}function OM(i){var l=mi(sw);Od(i,l)}function NM(i){var l=new Map().set("newStatus",i.m.abr.enabled);Od(i,mi(WM,l))}function hf(i,l){if(i.l!=Do){var c=mi(Tv,new Map().set("detail",l));i.dispatchEvent(c),c.defaultPrevented&&(l.handled=!0)}}function Qp(i,l,c){c=new Map().set("detail",{schemeIdUri:c.schemeIdUri,value:c.value,startTime:c.startTime,endTime:c.endTime,id:c.id,eventElement:c.eventElement}),i.dispatchEvent(mi(l,c))}function oA(i){if(!i.g.error)return null;var l=i.g.error.code;if(l==1)return null;var c=i.g.error.msExtendedCode;return c&&(0>c&&(c+=Math.pow(2,32)),c=c.toString(16)),new We(2,3,3016,l,c,i.g.error.message)}function FM(i,l){if(i.i){var c=Object.keys(l),p=c.length==1&&c[0]=="00",y=!1;if(c.length){c=E(i.H.variants);for(var A=c.next();!A.done;A=c.next()){A=A.value;var P=[];A.audio&&P.push(A.audio),A.video&&P.push(A.video),P=E(P);for(var N=P.next();!N.done;N=P.next()){var G=N.value;if(N=A.allowedByKeySystem,G.keyIds.size){A.allowedByKeySystem=!0,G=E(G.keyIds);for(var q=G.next();!q.done;q=G.next())q=q.value,q=l[p?"00":q],A.allowedByKeySystem=A.allowedByKeySystem&&!!q&&!fw.includes(q)}N!=A.allowedByKeySystem&&(y=!0)}}}y&&wd(i),(p=i.i.h)&&!p.allowedByKeySystem&&yv(i),y&&wa(i)}}function kM(i,l,c){i.C&&i.C.onExpirationUpdated&&i.C.onExpirationUpdated(l,c),l=mi(XM),i.dispatchEvent(l)}function UM(i,l,c){0<l&&(i.W()||i.Ff(l)),l=i.getDuration(),c<l&&(i.W()||i.ib(c))}function BM(i,l){var c=i.s?i.s.qd():{},p=Object.keys(c);p=p.length&&p[0]=="00";for(var y=!1,A=!1,P=new Set,N=new Set,G=E(l.variants),q=G.next();!q.done;q=G.next()){q=q.value;var ae=[];q.audio&&ae.push(q.audio),q.video&&ae.push(q.video),ae=E(ae);for(var Te=ae.next();!Te.done;Te=ae.next())if(Te=Te.value,Te.keyIds.size){Te=E(Te.keyIds);for(var Ie=Te.next();!Ie.done;Ie=Te.next()){Ie=Ie.value;var Ne=c[p?"00":Ie];Ne?fw.includes(Ne)&&N.add(Ne):P.add(Ie)}}q.allowedByApplication?q.allowedByKeySystem&&(y=!0):A=!0}if(!y)throw c={hasAppRestrictions:A,missingKeys:Array.from(P),restrictedKeyStatuses:Array.from(N)},new We(2,4,4012,c)}function jM(i){if(!i.variants.some(nf))throw new We(2,4,4032)}function Od(i,l){Z(function(c){if(c.g==1)return I(c,Promise.resolve(),2);i.l!=Do&&i.dispatchEvent(l),U(c)})}function KM(i){var l=new Set;i=E(i);for(var c=i.next();!c.done;c=i.next())c=c.value,c.language?l.add(pn(c.language)):l.add("und");return l}function GM(i){var l=new Map,c=new Map;i=E(i);for(var p=i.next();!p.done;p=i.next()){p=p.value;var y="und",A=[];p.language&&(y=pn(p.language)),p.type=="variant"?A=p.audioRoles:A=p.roles,A&&A.length||(A=[""]),l.has(y)||l.set(y,new Set),A=E(A);for(var P=A.next();!P.done;P=A.next())P=P.value,l.get(y).add(P),p.label&&(c.has(y)||c.set(y,new Map),c.get(y).set(P,p.label))}var N=[];return l.forEach(function(G,q){for(var ae=E(G),Te=ae.next();!Te.done;Te=ae.next()){Te=Te.value;var Ie=null;c.has(q)&&c.get(q).has(Te)&&(Ie=c.get(q).get(Te)),N.push({language:q,role:Te,label:Ie})}}),N}function pf(){return new We(2,7,7e3)}function lA(i,l,c,p,y,A){return p==i&&y.K==A.K&&y.uri==A.uri&&y.mimeType==A.mimeType?l:c}function Nd(){return{K:null,mimeType:null,startTime:null,Le:NaN,uri:null}}function uA(i){return new Promise(function(l,c){i.Xb=function(){return c(pf())},i.vd=function(){return l()},i.onError=function(p){return c(p)},i.xd=function(){return c(pf())}})}Le("shaka.Player",Yt),Yt.prototype.setVideoContainer=Yt.prototype.Ke,Yt.prototype.getManifestParserFactory=Yt.prototype.ug,Yt.prototype.getManifest=Yt.prototype.sg,Yt.prototype.retryStreaming=Yt.prototype.we,Yt.prototype.setMaxHardwareResolution=Yt.prototype.Fe,Yt.prototype.addChaptersTrack=Yt.prototype.Qf,Yt.prototype.addTextTrackAsync=Yt.prototype.Rf,Yt.prototype.addTextTrack=Yt.prototype.addTextTrack,Yt.prototype.getStats=Yt.prototype.getStats,Yt.prototype.getBufferedInfo=Yt.prototype.Ib,Yt.prototype.getPresentationStartTimeAsDate=Yt.prototype.lf,Yt.prototype.getPlayheadTimeAsDate=Yt.prototype.yg,Yt.prototype.setTextTrackVisibility=Yt.prototype.Je,Yt.prototype.getChapters=Yt.prototype.fg,Yt.prototype.getChaptersTracks=Yt.prototype.hf,Yt.prototype.isTextTrackVisible=Yt.prototype.Vb,Yt.prototype.selectVariantsByLabel=Yt.prototype.ih,Yt.prototype.selectTextLanguage=Yt.prototype.ze,Yt.prototype.selectAudioLanguage=Yt.prototype.Dd,Yt.prototype.getTextLanguages=Yt.prototype.Dg,Yt.prototype.getAudioLanguages=Yt.prototype.ag,Yt.prototype.getTextLanguagesAndRoles=Yt.prototype.Eg,Yt.prototype.getAudioLanguagesAndRoles=Yt.prototype.cg,Yt.prototype.selectVariantTrack=Yt.prototype.Be,Yt.prototype.selectTextTrack=Yt.prototype.Ae,Yt.prototype.getThumbnails=Yt.prototype.Fg,Yt.prototype.getImageTracks=Yt.prototype.ng,Yt.prototype.getTextTracks=Yt.prototype.vb,Yt.prototype.getVariantTracks=Yt.prototype.fb,Yt.prototype.cancelTrickPlay=Yt.prototype.Ue,Yt.prototype.trickPlay=Yt.prototype.Pe,Yt.prototype.getPlaybackRate=Yt.prototype.Jb,Yt.prototype.isBuffering=Yt.prototype.Rc,Yt.prototype.getKeyStatuses=Yt.prototype.qd,Yt.prototype.getExpiration=Yt.prototype.Lc,Yt.prototype.drmInfo=Yt.prototype.drmInfo,Yt.prototype.keySystem=Yt.prototype.keySystem,Yt.prototype.goToLive=Yt.prototype.Jg,Yt.prototype.seekRange=Yt.prototype.Na,Yt.prototype.isAudioOnly=Yt.prototype.pf,Yt.prototype.isInProgress=Yt.prototype.Tb,Yt.prototype.isLive=Yt.prototype.W,Yt.prototype.getAdManager=Yt.prototype.od,Yt.prototype.getAssetUri=Yt.prototype.Yd,Yt.prototype.getNetworkingEngine=Yt.prototype.Mc,Yt.prototype.getMediaElement=Yt.prototype.wg,Yt.prototype.getLoadMode=Yt.prototype.kf,Yt.prototype.resetConfiguration=Yt.prototype.gh,Yt.prototype.getBufferFullness=Yt.prototype.dg,Yt.prototype.getConfiguration=Yt.prototype.getConfiguration,Yt.prototype.configure=Yt.prototype.configure,Yt.prototype.load=Yt.prototype.load,Yt.prototype.updateStartTime=Yt.prototype.vh,Yt.prototype.unload=Yt.prototype.Qe,Yt.prototype.detach=Yt.prototype.detach,Yt.prototype.attach=Yt.prototype.Hc,Yt.probeSupport=function(i){i=i===void 0?!0:i;var l,c,p,y,A,P;return Z(function(N){if(N.g==1)return l={},i?I(N,q5(),3):N.D(2);N.g!=2&&(l=N.h);var G={};if(vs()){for(var q in qa)G[q]=!0;for(var ae in of)G[ae]=!0}q={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"},ae=E(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]);for(var Te=ae.next();!Te.done;Te=ae.next())Te=Te.value,G[Te]=vs()?!!qa[Te]:Da(Te);for(var Ie in q)G[Ie]=vs()?!!of[Ie]:Da(q[Ie]);for(c=G,G={},Ie=E('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),q=Ie.next();!q.done;q=Ie.next())q=q.value,G[q]=vs()?$l(q)?!0:MediaSource.isTypeSupported(q)||Vl(q):Da(q),ae=q.split(";")[0],G[ae]=G[ae]||G[q];p=G,y={manifest:c,media:p,drm:l},A=gA;for(P in A)y[P]=A[P]();return N.return(y)})},Yt.isBrowserSupported=yM,Yt.setAdManagerFactory=function(i){Av=i},Yt.registerSupportPlugin=function(i,l){gA[i]=l},Yt.prototype.destroy=Yt.prototype.destroy;var WM="abrstatuschanged",HM="adaptation",VM="buffering",$M="downloadfailed",zM="downloadheadersreceived",cA="drmsessionupdate",YM="emsg",Tv="error",XM="expirationupdated",qM="loaded",QM="loading",JM="manifestparsed",ZM="mediaqualitychanged",ew="metadata",tw="onstatechange",nw="onstateidle",rw="ratechange",fA="streaming",iw="textchanged",sw="texttrackvisibility",aw="timelineregionadded",dA="timelineregionenter",hA="timelineregionexit",ow="trackschanged",lw="unloading",uw="variantchanged",Sv={Ch:WM,Dh:HM,Eh:VM,Ih:$M,Jh:zM,Kh:cA,Rh:YM,Error:Tv,Sh:XM,Yh:"largegap",Zh:qM,$h:QM,di:JM,ei:ZM,Metadata:ew,li:tw,mi:nw,xi:rw,Ei:"sessiondata",Fi:fA,Gi:iw,Hi:sw,Ii:aw,Ji:dA,Ki:hA,Li:ow,Pi:lw,Ri:uw},Do=0,pA=1,Oa=2,Ja=3;Yt.LoadMode={DESTROYED:Do,NOT_LOADED:pA,MEDIA_SOURCE:Oa,SRC_EQUALS:Ja},Yt.version="v3.3.2";var cw=["3","3"];ze=new function(i){this.g=i,this.i=je,this.h=Oe}(new In(Number(cw[0]),Number(cw[1])));var fw=["output-restricted","internal-error"],gA={},Av=null,mA={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mpd:"application/dash+xml",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"},dw={sbv:"text/x-subviewer",srt:"text/srt",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml",lrc:"application/x-subtitle-lrc",ssa:"text/x-ssa",ass:"text/x-ssa"};function hw(){this.h=[],this.j=this.i=this.g=0}function or(i,l){var c=this;this.i=i,this.g=l,this.j=!1,this.l=this.g.getVolume(),this.h=new _r,this.h.o(this.g,google.ima.AdEvent.Type.PAUSED,function(){c.j=!0}),this.h.o(this.g,google.ima.AdEvent.Type.RESUMED,function(){c.j=!1})}f=or.prototype,f.getDuration=function(){return this.i.getDuration()},f.getMinSuggestedDuration=function(){return this.i.getMinSuggestedDuration()},f.getRemainingTime=function(){return this.g.getRemainingTime()},f.isPaused=function(){return this.j},f.isSkippable=function(){return 0<=this.i.getSkipTimeOffset()},f.getTimeUntilSkippable=function(){var i=this.i.getSkipTimeOffset();return i=this.getRemainingTime()-i,Math.max(i,0)},f.canSkipNow=function(){return this.g.getAdSkippableState()},f.skip=function(){return this.g.skip()},f.pause=function(){return this.g.pause()},f.play=function(){return this.g.resume()},f.getVolume=function(){return this.g.getVolume()},f.setVolume=function(i){return this.g.setVolume(i)},f.isMuted=function(){return this.g.getVolume()==0},f.isLinear=function(){return this.i.isLinear()},f.resize=function(i,l){this.g.resize(i,l,document.fullscreenElement?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)},f.setMuted=function(i){i?(this.l=this.getVolume(),this.setVolume(0)):this.setVolume(this.l)},f.getSequenceLength=function(){var i=this.i.getAdPodInfo();return i==null?1:i.getTotalAds()},f.getPositionInSequence=function(){var i=this.i.getAdPodInfo();return i==null?1:i.getAdPosition()},f.release=function(){this.g=this.i=null},Le("shaka.ads.ClientSideAd",or),or.prototype.release=or.prototype.release,or.prototype.getPositionInSequence=or.prototype.getPositionInSequence,or.prototype.getSequenceLength=or.prototype.getSequenceLength,or.prototype.setMuted=or.prototype.setMuted,or.prototype.resize=or.prototype.resize,or.prototype.isLinear=or.prototype.isLinear,or.prototype.isMuted=or.prototype.isMuted,or.prototype.setVolume=or.prototype.setVolume,or.prototype.getVolume=or.prototype.getVolume,or.prototype.play=or.prototype.play,or.prototype.pause=or.prototype.pause,or.prototype.skip=or.prototype.skip,or.prototype.canSkipNow=or.prototype.canSkipNow,or.prototype.getTimeUntilSkippable=or.prototype.getTimeUntilSkippable,or.prototype.isSkippable=or.prototype.isSkippable,or.prototype.isPaused=or.prototype.isPaused,or.prototype.getRemainingTime=or.prototype.getRemainingTime,or.prototype.getMinSuggestedDuration=or.prototype.getMinSuggestedDuration,or.prototype.getDuration=or.prototype.getDuration;function vA(i,l,c,p){var y=this;this.B=i,this.g=l,this.C=null,this.G=NaN,this.j=p,this.s=null,this.h=new _r,google.ima.settings.setLocale(c),i=new google.ima.AdDisplayContainer(this.B,this.g),i.initialize(),this.l=new google.ima.AdsLoader(i),this.l.getSettings().setPlayerType("shaka-player"),this.l.getSettings().setPlayerVersion("v3.3.2"),this.i=null,this.h.Qa(this.l,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(A){XV(y,A)}),this.h.o(this.l,google.ima.AdErrorEvent.Type.AD_ERROR,function(A){pw(y,A)}),this.g.onended=function(){y.l.contentComplete()}}vA.prototype.stop=function(){this.i&&this.i.stop(),this.B&&Pd(this.B)},vA.prototype.release=function(){this.stop(),this.C&&this.C.disconnect(),this.h&&this.h.release(),this.i&&this.i.destroy(),this.l.destroy()};function pw(i,l){l.getError(),xv(i,null),i.j(new De("ad-cue-points-changed",new Map().set("cuepoints",[])))}function XV(i,l){i.j(new De("ads-loaded",new Map().set("loadTime",Date.now()/1e3-i.G))),i.i=l.getAdsManager(i.g),i.j(new De("ima-ad-manager-loaded",new Map().set("imaAdManager",i.i)));var c=i.i.getCuePoints();if(c.length){var p=[];c=E(c);for(var y=c.next();!y.done;y=c.next())p.push({start:y.value,end:null});i.j(new De("ad-cue-points-changed",new Map().set("cuepoints",p)))}qV(i);try{i.i.init(i.g.offsetWidth,i.g.offsetHeight,document.fullscreenElement?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL),i.h.o(i.g,"loadeddata",function(){i.i.resize(i.g.offsetWidth,i.g.offsetHeight,document.fullscreenElement?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),"ResizeObserver"in o&&(i.C=new ResizeObserver(function(){i.i.resize(i.g.offsetWidth,i.g.offsetHeight,document.fullscreenElement?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),i.C.observe(i.g)),i.i.start()}catch{xv(i,null)}}function qV(i){function l(c,p){var y=new Map().set("originalEvent",c);i.j(new De(p,y))}i.h.o(i.i,google.ima.AdErrorEvent.Type.AD_ERROR,function(c){pw(i,c)}),i.h.o(i.i,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,function(c){gw(i,c)}),i.h.o(i.i,google.ima.AdEvent.Type.STARTED,function(c){gw(i,c)}),i.h.o(i.i,google.ima.AdEvent.Type.FIRST_QUARTILE,function(c){l(c,"ad-first-quartile")}),i.h.o(i.i,google.ima.AdEvent.Type.MIDPOINT,function(c){l(c,"ad-midpoint")}),i.h.o(i.i,google.ima.AdEvent.Type.THIRD_QUARTILE,function(c){l(c,"ad-third-quartile")}),i.h.o(i.i,google.ima.AdEvent.Type.COMPLETE,function(c){l(c,"ad-complete")}),i.h.o(i.i,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,function(c){xv(i,c)}),i.h.o(i.i,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(c){xv(i,c)}),i.h.o(i.i,google.ima.AdEvent.Type.SKIPPED,function(c){l(c,"ad-skipped")}),i.h.o(i.i,google.ima.AdEvent.Type.VOLUME_CHANGED,function(c){l(c,"ad-volume-changed")}),i.h.o(i.i,google.ima.AdEvent.Type.VOLUME_MUTED,function(c){l(c,"ad-muted")}),i.h.o(i.i,google.ima.AdEvent.Type.PAUSED,function(c){i.s.j=!0,l(c,"ad-paused")}),i.h.o(i.i,google.ima.AdEvent.Type.RESUMED,function(c){i.s.j=!1,l(c,"ad-resumed")}),i.h.o(i.i,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,function(c){l(c,"ad-skip-state-changed")}),i.h.o(i.i,google.ima.AdEvent.Type.CLICK,function(c){l(c,"ad-clicked")}),i.h.o(i.i,google.ima.AdEvent.Type.AD_PROGRESS,function(c){l(c,"ad-progress")}),i.h.o(i.i,google.ima.AdEvent.Type.AD_BUFFERING,function(c){l(c,"ad-buffering")}),i.h.o(i.i,google.ima.AdEvent.Type.IMPRESSION,function(c){l(c,"ad-impression")}),i.h.o(i.i,google.ima.AdEvent.Type.DURATION_CHANGE,function(c){l(c,"ad-duration-changed")}),i.h.o(i.i,google.ima.AdEvent.Type.USER_CLOSE,function(c){l(c,"ad-closed")}),i.h.o(i.i,google.ima.AdEvent.Type.LOADED,function(c){l(c,"ad-loaded")}),i.h.o(i.i,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(c){l(c,"all-ads-completed")}),i.h.o(i.i,google.ima.AdEvent.Type.LINEAR_CHANGED,function(c){l(c,"ad-linear-changed")}),i.h.o(i.i,google.ima.AdEvent.Type.AD_METADATA,function(c){l(c,"ad-metadata")}),i.h.o(i.i,google.ima.AdEvent.Type.LOG,function(c){l(c,"ad-recoverable-error")}),i.h.o(i.i,google.ima.AdEvent.Type.AD_BREAK_READY,function(c){l(c,"ad-break-ready")}),i.h.o(i.i,google.ima.AdEvent.Type.INTERACTION,function(c){l(c,"ad-interaction")})}function gw(i,l){var c=l.getAd();i.s=new or(c,i.i),c=new Map().set("ad",i.s).set("sdkAdObject",c).set("originalEvent",l),i.j(new De("ad-started",c)),i.s.isLinear()&&(i.B.setAttribute("ad-active","true"),i.g.pause())}function xv(i,l){i.j(new De("ad-stopped",new Map().set("originalEvent",l))),i.s.isLinear()&&(i.B.removeAttribute("ad-active"),i.g.play())}function lr(i,l){this.i=i,this.h=null,this.g=l}f=lr.prototype,f.getDuration=function(){return this.h?this.h.duration:-1},f.getMinSuggestedDuration=function(){return this.getDuration()},f.getRemainingTime=function(){return this.h?this.h.duration-this.h.currentTime:-1},f.isPaused=function(){return this.g.paused},f.isSkippable=function(){return this.i.isSkippable()},f.getTimeUntilSkippable=function(){var i=this.i.getSkipTimeOffset();return i=this.getRemainingTime()-i,Math.max(i,0)},f.canSkipNow=function(){return this.getTimeUntilSkippable()==0},f.skip=function(){this.g.currentTime+=this.getRemainingTime()},f.pause=function(){return this.g.pause()},f.play=function(){return this.g.play()},f.getVolume=function(){return this.g.volume},f.setVolume=function(i){this.g.volume=i},f.isMuted=function(){return this.g.muted},f.isLinear=function(){return!0},f.resize=function(){},f.setMuted=function(i){this.g.muted=i},f.getSequenceLength=function(){var i=this.i.getAdPodInfo();return i==null?1:i.getTotalAds()},f.getPositionInSequence=function(){var i=this.i.getAdPodInfo();return i==null?1:i.getAdPosition()},f.release=function(){this.g=this.h=this.i=null},Le("shaka.ads.ServerSideAd",lr),lr.prototype.release=lr.prototype.release,lr.prototype.getPositionInSequence=lr.prototype.getPositionInSequence,lr.prototype.getSequenceLength=lr.prototype.getSequenceLength,lr.prototype.setMuted=lr.prototype.setMuted,lr.prototype.resize=lr.prototype.resize,lr.prototype.isLinear=lr.prototype.isLinear,lr.prototype.isMuted=lr.prototype.isMuted,lr.prototype.setVolume=lr.prototype.setVolume,lr.prototype.getVolume=lr.prototype.getVolume,lr.prototype.play=lr.prototype.play,lr.prototype.pause=lr.prototype.pause,lr.prototype.skip=lr.prototype.skip,lr.prototype.canSkipNow=lr.prototype.canSkipNow,lr.prototype.getTimeUntilSkippable=lr.prototype.getTimeUntilSkippable,lr.prototype.isSkippable=lr.prototype.isSkippable,lr.prototype.isPaused=lr.prototype.isPaused,lr.prototype.getRemainingTime=lr.prototype.getRemainingTime,lr.prototype.getMinSuggestedDuration=lr.prototype.getMinSuggestedDuration,lr.prototype.getDuration=lr.prototype.getDuration;function Cv(i,l,c,p){var y=this;this.C=i,this.g=l,this.l=null,this.M=NaN,this.j=p,this.L=!1,this.G=this.s=this.B=null,this.I="",this.J=[],this.h=new _r,i=new google.ima.dai.api.UiSettings,i.setLocale(c),this.i=new google.ima.dai.api.StreamManager(this.g,this.C,i),this.j(new De("ima-stream-manager-loaded",new Map().set("imaStreamManager",this.i))),this.h.o(this.i,google.ima.dai.api.StreamEvent.Type.LOADED,function(A){QV(y,A)}),this.h.o(this.i,google.ima.dai.api.StreamEvent.Type.ERROR,function(){y.I.length?y.l.resolve(y.I):y.l.reject("IMA Stream request returned an error and there was no backup asset uri provided."),y.l=null}),this.h.o(this.i,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,function(){}),this.h.o(this.i,google.ima.dai.api.StreamEvent.Type.STARTED,function(A){A=A.getAd(),y.s=new lr(A,y.g),y.G&&(y.s.h=y.G),y.j(new De("ad-started",new Map().set("ad",y.s))),y.C.setAttribute("ad-active","true")}),this.h.o(this.i,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,function(){y.C.removeAttribute("ad-active");var A=y.g.currentTime;y.B&&y.B>A&&(y.g.currentTime=y.B,y.B=null)}),this.h.o(this.i,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,function(A){y.G=A.getStreamData().adProgressData,y.s&&(y.s.h=y.G)}),this.h.o(this.i,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,function(){y.j(new De("ad-first-quartile"))}),this.h.o(this.i,google.ima.dai.api.StreamEvent.Type.MIDPOINT,function(){y.j(new De("ad-midpoint"))}),this.h.o(this.i,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,function(){y.j(new De("ad-third-quartile"))}),this.h.o(this.i,google.ima.dai.api.StreamEvent.Type.COMPLETE,function(){y.j(new De("ad-complete")),y.j(new De("ad-stopped")),y.C.removeAttribute("ad-active"),y.s=null}),this.h.o(this.i,google.ima.dai.api.StreamEvent.Type.SKIPPED,function(){y.j(new De("ad-skipped")),y.j(new De("ad-stopped"))}),this.h.o(this.i,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,function(A){var P=A.getStreamData();A=[],P=E(P.cuepoints);for(var N=P.next();!N.done;N=P.next())N=N.value,A.push({start:N.start,end:N.end});y.J=A,y.j(new De("ad-cue-points-changed",new Map().set("cuepoints",A)))})}Cv.prototype.stop=function(){this.I="",this.B=null,this.J=[]},Cv.prototype.release=function(){this.stop(),this.h&&this.h.release()},Cv.prototype.onCueMetadataChange=function(i){if(i.key&&i.data){var l={};l[i.key]=i.data,this.i.onTimedMetadata(l)}};function QV(i,l){i.j(new De("ads-loaded",new Map().set("loadTime",Date.now()/1e3-i.M)));var c=l.getStreamData().url;i.l.resolve(c),i.l=null,i.L||i.h.o(i.g,"seeked",function(){var p=i.g.currentTime;if(p!=0){i.i.streamTimeForContentTime(p);var y=i.i.previousCuePointForStreamTime(p);y&&!y.played&&(i.B=p,i.g.currentTime=y.start)}})}function Fn(){Ce.call(this),this.g=this.h=null,this.j=new hw,this.i=navigator.language}D(Fn,Ce),f=Fn.prototype,f.setLocale=function(i){this.i=i},f.initClientSide=function(i,l){var c=this;if(!o.google||!google.ima||!google.ima.AdsLoader)throw new We(2,10,1e4);this.h&&this.h.release(),this.h=new vA(i,l,this.i,function(p){if(p&&p.type)switch(p.type){case"ads-loaded":c.j.h.push(p.loadTime);break;case"ad-started":c.j.g++;break;case"ad-complete":c.j.i++;break;case"ad-skipped":c.j.j++}c.dispatchEvent(p)})},f.release=function(){this.h&&(this.h.release(),this.h=null),this.g&&(this.g.release(),this.g=null),Ce.prototype.release.call(this)},f.onAssetUnload=function(){this.h&&this.h.stop(),this.g&&this.g.stop(),this.dispatchEvent(new De("ad-stopped")),this.j=new hw},f.requestClientSideAds=function(i){if(!this.h)throw new We(1,10,10001);var l=this.h;l.G=Date.now()/1e3,l.l.requestAds(i)},f.initServerSide=function(i,l){var c=this;if(!o.google||!google.ima||!google.ima.dai)throw new We(2,10,10002);this.g&&this.g.release(),this.g=new Cv(i,l,this.i,function(p){if(p&&p.type)switch(p.type){case"ads-loaded":c.j.h.push(p.loadTime);break;case"ad-started":c.j.g++;break;case"ad-complete":c.j.i++;break;case"ad-skipped":c.j.j++}c.dispatchEvent(p)})},f.requestServerSideStream=function(i,l){if(l=l===void 0?"":l,!this.g)throw new We(1,10,10003);i.adTagParameters||(i.adTagParameters={});var c=i.adTagParameters;(c.mpt||c.mpv)&&Re('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),i.adTagParameters.mpt="shaka-player",i.adTagParameters.mpv="v3.3.2",c=this.g;var p=l;return c.l?c=Promise.reject(new We(1,10,10004)):(i instanceof google.ima.dai.api.LiveStreamRequest&&(c.L=!0),c.l=new Rt,c.i.requestStream(i),c.I=p||"",c.M=Date.now()/1e3,c=c.l),c},f.replaceServerSideAdTagParameters=function(i){if(!this.g)throw new We(1,10,10003);(i.mpt||i.mpv)&&Re('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),i.mpt="Shaka Player",i.mpv="v3.3.2",this.g.i.replaceAdTagParameters(i)},f.getServerSideCuePoints=function(){if(!this.g)throw new We(1,10,10003);return this.g.J},f.getStats=function(){var i=this.j;return{loadTimes:i.h,started:i.g,playedCompletely:i.i,skipped:i.j}},f.onDashTimedMetadata=function(i){if(this.g&&i.schemeIdUri=="urn:google:dai:2018"){var l=i.schemeIdUri,c=i.eventElement?i.eventElement.getAttribute("messageData"):null;this.g.i.processMetadata(l,c,i.startTime)}},f.onHlsTimedMetadata=function(i,l){this.g&&this.g.i.processMetadata("ID3",i.data,l)},f.onCueMetadataChange=function(i){this.g&&this.g.onCueMetadataChange(i)},Le("shaka.ads.AdManager",Fn),Fn.prototype.onCueMetadataChange=Fn.prototype.onCueMetadataChange,Fn.prototype.onHlsTimedMetadata=Fn.prototype.onHlsTimedMetadata,Fn.prototype.onDashTimedMetadata=Fn.prototype.onDashTimedMetadata,Fn.prototype.getStats=Fn.prototype.getStats,Fn.prototype.getServerSideCuePoints=Fn.prototype.getServerSideCuePoints,Fn.prototype.replaceServerSideAdTagParameters=Fn.prototype.replaceServerSideAdTagParameters,Fn.prototype.requestServerSideStream=Fn.prototype.requestServerSideStream,Fn.prototype.initServerSide=Fn.prototype.initServerSide,Fn.prototype.requestClientSideAds=Fn.prototype.requestClientSideAds,Fn.prototype.onAssetUnload=Fn.prototype.onAssetUnload,Fn.prototype.release=Fn.prototype.release,Fn.prototype.initClientSide=Fn.prototype.initClientSide,Fn.prototype.setLocale=Fn.prototype.setLocale,Fn.ADS_LOADED="ads-loaded",Fn.AD_STARTED="ad-started",Fn.AD_FIRST_QUARTILE="ad-first-quartile",Fn.AD_MIDPOINT="ad-midpoint",Fn.AD_THIRD_QUARTILE="ad-third-quartile",Fn.AD_COMPLETE="ad-complete",Fn.AD_STOPPED="ad-stopped",Fn.AD_SKIPPED="ad-skipped",Fn.AD_VOLUME_CHANGED="ad-volume-changed",Fn.AD_MUTED="ad-muted",Fn.AD_PAUSED="ad-paused",Fn.AD_RESUMED="ad-resumed",Fn.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",Fn.CUEPOINTS_CHANGED="ad-cue-points-changed",Fn.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",Fn.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",Fn.AD_CLICKED="ad-clicked",Fn.AD_PROGRESS="ad-progress",Fn.AD_BUFFERING="ad-buffering",Fn.AD_IMPRESSION="ad-impression",Fn.AD_DURATION_CHANGED="ad-duration-changed",Fn.AD_CLOSED="ad-closed",Fn.AD_LOADED="ad-loaded",Fn.ALL_ADS_COMPLETED="all-ads-completed",Fn.AD_LINEAR_CHANGED="ad-linear-changed",Fn.AD_METADATA="ad-metadata",Fn.AD_RECOVERABLE_ERROR="ad-recoverable-error",Fn.AD_BREAK_READY="ad-break-ready",Fn.AD_INTERACTION="ad-interaction",Av=function(){return new Fn};function mw(i){return JSON.stringify(i,function(l,c){if(typeof c!="function"){if(c instanceof Event||c instanceof De){var p={};for(A in c){var y=c[A];y&&typeof y=="object"?A=="detail"&&(p[A]=y):A in Event||(p[A]=y)}return p}if(c instanceof Error){var A=new Set(["name","message","stack"]);for(p in c)A.add(p);for(y=E(Object.getOwnPropertyNames(c)),p=y.next();!p.done;p=y.next())A.add(p.value);for(y={},A=E(A),p=A.next();!p.done;p=A.next())p=p.value,y[p]=c[p];A={__type__:"Error",contents:y}}else if(c instanceof TimeRanges)for(A={__type__:"TimeRanges",length:c.length,start:[],end:[]},p=E(Ju(c)),y=p.next();!y.done;y=p.next()){y=y.value;var P=y.end;A.start.push(y.start),A.end.push(P)}else A=c instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(c)}:typeof c=="number"?isNaN(c)?"NaN":isFinite(c)?c:0>c?"-Infinity":"Infinity":c;return A}})}function yA(i){return JSON.parse(i,function(l,c){if(c=="NaN")var p=NaN;else if(c=="-Infinity")p=-1/0;else if(c=="Infinity")p=1/0;else if(c&&typeof c=="object"&&c.__type__=="TimeRanges")p=JV(c);else if(c&&typeof c=="object"&&c.__type__=="Uint8Array")p=new Uint8Array(c.entries);else if(c&&typeof c=="object"&&c.__type__=="Error"){p=c.contents;var y=Error(p.message),A;for(A in p)y[A]=p[A];p=y}else p=c;return p})}function JV(i){return{length:i.length,start:function(l){return i.start[l]},end:function(l){return i.end[l]}}}var vw="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),ZV="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),EA=["loop","playbackRate"],e$=["pause","play"],Iv={getAssetUri:2,getAudioLanguages:4,getAudioLanguagesAndRoles:4,getBufferFullness:1,getBufferedInfo:2,getConfiguration:4,getExpiration:2,getKeyStatuses:2,getPlaybackRate:2,getTextLanguages:4,getTextLanguagesAndRoles:4,getTextTracks:2,getStats:5,getVariantTracks:2,getImageTracks:2,getThumbnails:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,getLoadMode:10},_A={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},yw=[["getConfiguration","configure"]],Ew=[["isTextTrackVisible","setTextTrackVisibility"]],t$="addChaptersTrack addTextTrack addTextTrackAsync cancelTrickPlay configure getChapters getChaptersTracks resetConfiguration retryStreaming selectAudioLanguage selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay updateStartTime goToLive".split(" "),n$=["attach","detach","load","unload"];function TA(i,l,c,p,y,A){var P=this;this.M=i,this.j=new kn(l),this.$=c,this.G=!1,this.C=p,this.L=y,this.S=A,this.h=this.s=!1,this.ea="",this.B=null,this.I=function(){return AA(P)},this.J=function(N,G){var q=yA(G);switch(q.type){case"event":var ae=q.targetName;q=Ae(q.event),P.C(ae,q);break;case"update":ae=q.update;for(var Te in ae){q=P.g[Te]||{};for(var Ie in ae[Te])q[Ie]=ae[Te][Ie]}P.G&&(P.$(),P.G=!1);break;case"asyncComplete":if(Te=q.id,q=q.error,Ie=P.i[Te],delete P.i[Te],Ie)if(q){Te=new We(q.severity,q.category,q.code);for(ae in q)Te[ae]=q[ae];Ie.reject(Te)}else Ie.resolve()}},this.g={video:{},player:{}},this.P=0,this.i={},this.l=null,Zp.add(this)}f=TA.prototype,f.destroy=function(){return Zp.delete(this),xA(this),Za&&Sw(this),this.j&&(this.j.stop(),this.j=null),this.L=this.C=null,this.h=this.s=!1,this.J=this.I=this.l=this.i=this.g=this.B=null,Promise.resolve()},f.xa=function(){return this.h},f.Bd=function(){return this.ea},f.init=function(){if(this.M.length)if(o.chrome&&chrome.cast&&chrome.cast.isAvailable){this.s=!0,this.j.Ga();var i=new chrome.cast.SessionRequest(this.M);i=new chrome.cast.ApiConfig(i,function(l){for(var c=E(Zp),p=c.next();!p.done;p=c.next())Tw(p.value,l)},function(l){for(var c=E(Zp),p=c.next();!p.done;p=c.next())p=p.value,Rv=l=="available",p.j.Ga()},"origin_scoped"),chrome.cast.initialize(i,function(){},function(){}),Rv&&this.j.U(i$),(i=Za)&&i.status!=chrome.cast.SessionStatus.STOPPED?Tw(this,i):Za=null}else o.__onGCastApiAvailable||(o.__onGCastApiAvailable=Aw),o.__onGCastApiAvailable!=Aw&&Re("A global Cast SDK hook is already installed! Shaka Player will be unable to receive a notification when the Cast SDK is ready.")},f.Ce=function(i){this.B=i,this.h&&Jp(this,{type:"appData",appData:this.B})},f.cast=function(i){var l=this;return Z(function(c){if(!l.s)throw new We(1,8,8e3);if(!Rv)throw new We(1,8,8001);if(l.h)throw new We(1,8,8002);return l.l=new Rt,chrome.cast.requestSession(function(p){return SA(l,i,p)},function(p){return _w(l,p)}),I(c,l.l,0)})};function r$(i){if(i.h){var l=i.S();chrome.cast.requestSession(function(c){return SA(i,l,c)},function(c){return _w(i,c)})}}f.ic=function(){if(this.h){if(xA(this),Za){Sw(this);try{Za.stop(function(){},function(){})}catch{}Za=null}AA(this)}},f.get=function(i,l){var c=this;if(i=="video"){if(e$.includes(l))return function(p){for(var y=[],A=0;A<arguments.length;++A)y[A]=arguments[A];return c.xf.apply(c,[i,l].concat(T(y)))}}else if(i=="player"){if(_A[l]&&!this.get("player","isLive")())return function(){};if(t$.includes(l))return function(p){for(var y=[],A=0;A<arguments.length;++A)y[A]=arguments[A];return c.xf.apply(c,[i,l].concat(T(y)))};if(n$.includes(l))return function(p){for(var y=[],A=0;A<arguments.length;++A)y[A]=arguments[A];return c.dh.apply(c,[i,l].concat(T(y)))};if(Iv[l])return function(){return c.g[i][l]}}return this.g[i][l]},f.set=function(i,l,c){this.g[i][l]=c,Jp(this,{type:"set",targetName:i,property:l,value:c})};function SA(i,l,c){Za=c,c.addUpdateListener(i.I),c.addMessageListener("urn:x-cast:com.google.shaka.v2",i.J),AA(i),Jp(i,{type:"init",initState:l,appData:i.B}),i.l.resolve()}function _w(i,l){var c=8003;switch(l.code){case"cancel":c=8004;break;case"timeout":c=8005;break;case"receiver_unavailable":c=8006}i.l.reject(new We(2,8,c,l))}f.xf=function(i,l,c){for(var p=[],y=2;y<arguments.length;++y)p[y-2]=arguments[y];Jp(this,{type:"call",targetName:i,methodName:l,args:p})},f.dh=function(i,l,c){for(var p=[],y=2;y<arguments.length;++y)p[y-2]=arguments[y];y=new Rt;var A=this.P.toString();this.P++,this.i[A]=y;try{Jp(this,{type:"asyncCall",targetName:i,methodName:l,args:p,id:A})}catch(P){y.reject(P)}return y};function Tw(i,l){var c=i.S();i.l=new Rt,i.G=!0,SA(i,c,l)}function Sw(i){var l=Za;l.removeUpdateListener(i.I),l.removeMessageListener("urn:x-cast:com.google.shaka.v2",i.J)}function AA(i){var l=Za?Za.status=="connected":!1;if(i.h&&!l){i.L();for(var c in i.g)i.g[c]={};xA(i)}i.h=l,i.ea=l?Za.receiver.friendlyName:"",i.j.Ga()}function xA(i){for(var l in i.i){var c=i.i[l];delete i.i[l],c.reject(new We(1,7,7e3))}}function Jp(i,l){var c=mw(l),p=Za;try{p.sendMessage("urn:x-cast:com.google.shaka.v2",c,function(){},V)}catch(y){throw c=new We(2,8,8005,y),p=new De("error",new Map().set("detail",c)),i.C("player",p),i.ic(),c}}var i$=.02,Rv=!1,Za=null,Zp=new Set;function Aw(i){if(i){i=E(Zp);for(var l=i.next();!l.done;l=i.next())l.value.init()}}function zr(i,l,c){Ce.call(this);var p=this;this.j=i,this.i=l,this.h=this.B=this.l=this.C=this.s=null,this.I=c,this.G=new Map,this.g=new TA(c,function(){return Cw(p)},function(){return Iw(p)},function(y,A){return bw(p,y,A)},function(){return Rw(p)},function(){return CA(p)}),s$(this)}D(zr,Ce),f=zr.prototype,f.destroy=function(i){return i&&this.g.ic(),this.h&&(this.h.release(),this.h=null),i=[],this.i&&(i.push(this.i.destroy()),this.i=null),this.g&&(i.push(this.g.destroy()),this.g=null),this.C=this.s=this.j=null,Ce.prototype.release.call(this),Promise.all(i)},f.Kb=function(){return this.s},f.lc=function(){return this.C},f.Te=function(){return this.g.s&&Rv},f.xa=function(){return this.g.xa()},f.Bd=function(){return this.g.Bd()},f.cast=function(){var i=this,l;return Z(function(c){return c.g==1?(l=CA(i),I(c,i.g.cast(l),2)):i.i?I(c,i.i.Qe(),0):c.return()})},f.Ce=function(i){this.g.Ce(i)},f.Hf=function(){r$(this.g)},f.ic=function(){this.g.ic()},f.Xe=function(i){var l=this;return Z(function(c){if(c.g==1)return i==l.I?c.return():(l.I=i,l.g.ic(),I(c,l.g.destroy(),2));l.g=null,l.g=new TA(i,function(){return Cw(l)},function(){return Iw(l)},function(p,y){return bw(l,p,y)},function(){return Rw(l)},function(){return CA(l)}),l.g.init(),U(c)})};function s$(i){i.g.init(),i.h=new _r;for(var l=E(vw),c=l.next();!c.done;c=l.next())i.h.o(i.j,c.value,function(A){i.g.xa()||(A=Ae(A),i.l.dispatchEvent(A))});for(var p in Sv)i.h.o(i.i,Sv[p],function(A){i.g.xa()||i.B.dispatchEvent(A)});i.s={},l={};for(var y in i.j)l.zc=y,Object.defineProperty(i.s,l.zc,{configurable:!1,enumerable:!0,get:function(A){return function(){return o$(i,A.zc)}}(l),set:function(A){return function(P){var N=A.zc;i.g.xa()?i.g.set("video",N,P):i.j[N]=P}}(l)}),l={zc:l.zc};i.C={},xw(i,function(A){Object.defineProperty(i.C,A,{configurable:!1,enumerable:!0,get:function(){return l$(i,A)}})}),a$(i),i.l=new Ce,i.l.hd=i.s,i.B=new Ce,i.B.hd=i.C}function a$(i){var l=new Map;xw(i,function(c,p){if(l.has(p)){var y=l.get(p);c.length<y.length?i.G.set(c,y):i.G.set(y,c)}else l.set(p,c)})}function xw(i,l){function c(q){return q=="constructor"||typeof p[q]!="function"?!1:!y.has(q)}var p=i.i,y=new Set;for(A in p)c(A)&&(y.add(A),l(A,p[A]));for(var A=Object.getPrototypeOf(p),P=Object.getPrototypeOf({});A&&A!=P;){for(var N=E(Object.getOwnPropertyNames(A)),G=N.next();!G.done;G=N.next())G=G.value,c(G)&&(y.add(G),l(G,p[G]));A=Object.getPrototypeOf(A)}}function CA(i){var l={video:{},player:{},playerAfterLoad:{},manifest:i.i.Yd(),startTime:null};i.j.pause();for(var c=E(EA),p=c.next();!p.done;p=c.next())p=p.value,l.video[p]=i.j[p];for(i.j.ended||(l.startTime=i.j.currentTime),c=E(yw),p=c.next();!p.done;p=c.next()){var y=p.value;p=y[1],y=i.i[y[0]](),l.player[p]=y}for(c=E(Ew),p=c.next();!p.done;p=c.next())y=p.value,p=y[1],y=i.i[y[0]](),l.playerAfterLoad[p]=y;return l}function Cw(i){var l=new De("caststatuschanged");i.dispatchEvent(l)}function Iw(i){var l=new De(i.s.paused?"pause":"play");i.l.dispatchEvent(l)}function Rw(i){for(var l=E(yw),c=l.next();!c.done;c=l.next()){var p=c.value;c=p[1],p=i.g.get("player",p[0])(),i.i[c](p)}var y=i.g.get("player","getAssetUri")();c=i.g.get("video","ended"),l=Promise.resolve();var A=i.j.autoplay;p=null,c||(p=i.g.get("video","currentTime")),y&&(i.j.autoplay=!1,l=i.i.load(y,p));var P={};for(c=E(EA),p=c.next();!p.done;p=c.next())p=p.value,P[p]=i.g.get("video",p);l.then(function(){if(i.j){for(var N=E(EA),G=N.next();!G.done;G=N.next())G=G.value,i.j[G]=P[G];for(N=E(Ew),G=N.next();!G.done;G=N.next()){var q=G.value;G=q[1],q=i.g.get("player",q[0])(),i.i[G](q)}i.j.autoplay=A,y&&i.j.play()}},function(N){N=new Map().set("detail",N),N=new De(Tv,N),i.i.dispatchEvent(N)})}function o$(i,l){if(l=="addEventListener")return function(p,y,A){return i.l.addEventListener(p,y,A)};if(l=="removeEventListener")return function(p,y,A){return i.l.removeEventListener(p,y,A)};if(i.g.xa()&&Object.keys(i.g.g.video).length==0){var c=i.j[l];if(typeof c!="function")return c}return i.g.xa()?i.g.get("video",l):(c=i.j[l],typeof c=="function"&&(c=c.bind(i.j)),c)}function l$(i,l){if(i.G.has(l)&&(l=i.G.get(l)),l=="addEventListener")return function(c,p,y){return i.B.addEventListener(c,p,y)};if(l=="removeEventListener")return function(c,p,y){return i.B.removeEventListener(c,p,y)};if(l=="getMediaElement")return function(){return i.s};if(l=="getSharedConfiguration")return i.g.get("player","getConfiguration");if(l=="getNetworkingEngine")return function(){return i.i.Mc()};if(l=="getDrmEngine")return function(){return i.i.s};if(l=="getAdManager")return function(){return i.i.od()};if(l=="setVideoContainer")return function(c){return i.i.Ke(c)};if(i.g.xa()){if(l=="getManifest"||l=="drmInfo")return function(){return Re(l+"() does not work while casting!"),null};if(l=="attach"||l=="detach")return function(){return Re(l+"() does not work while casting!"),Promise.resolve()}}return i.g.xa()&&Object.keys(i.g.g.video).length==0&&Iv[l]||!i.g.xa()?i.i[l].bind(i.i):i.g.get("player",l)}function bw(i,l,c){i.g.xa()&&(l=="video"?i.l.dispatchEvent(c):l=="player"&&i.B.dispatchEvent(c))}Le("shaka.cast.CastProxy",zr),zr.prototype.changeReceiverId=zr.prototype.Xe,zr.prototype.forceDisconnect=zr.prototype.ic,zr.prototype.suggestDisconnect=zr.prototype.Hf,zr.prototype.setAppData=zr.prototype.Ce,zr.prototype.cast=zr.prototype.cast,zr.prototype.receiverName=zr.prototype.Bd,zr.prototype.isCasting=zr.prototype.xa,zr.prototype.canCast=zr.prototype.Te,zr.prototype.getPlayer=zr.prototype.lc,zr.prototype.getVideo=zr.prototype.Kb,zr.prototype.destroy=zr.prototype.destroy;function $i(i,l,c,p){Ce.call(this);var y=this;this.g=i,this.i=l,this.h=new _r,this.P={video:i,player:l},this.J=c||function(){},this.S=p||function(A){return A},this.j=null,this.L=!1,this.B=!0,this.s=0,this.I=!1,this.G=!0,this.C=this.l=null,this.M=new kn(function(){IA(y)}),u$(this)}D($i,Ce),f=$i.prototype,f.isConnected=function(){return this.L},f.Mg=function(){return this.B},f.lh=function(i){this.j=i},f.Xf=function(){this.j=null},f.mh=function(i){this.j||(this.j={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.j.title=i},f.kh=function(i){this.j||(this.j={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.j.images=[{url:i}]},f.jh=function(i){this.j||(this.j={}),this.j.artist=i,this.j.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},f.destroy=function(){var i=this,l,c;return Z(function(p){if(p.g==1)return i.h&&(i.h.release(),i.h=null),l=[],i.i&&(l.push(i.i.destroy()),i.i=null),i.M&&(i.M.stop(),i.M=null),i.g=null,i.P=null,i.J=null,i.L=!1,i.B=!0,i.l=null,i.C=null,Ce.prototype.release.call(i),I(p,Promise.all(l),2);c=cast.receiver.CastReceiverManager.getInstance(),c.stop(),U(p)})};function u$(i){var l=cast.receiver.CastReceiverManager.getInstance();l.onSenderConnected=function(){return Dw(i)},l.onSenderDisconnected=function(){return Dw(i)},l.onSystemVolumeChanged=function(){var y=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();y&&Zu(i,{type:"update",update:{video:{volume:y.level,muted:y.muted}}},i.l),Zu(i,{type:"event",targetName:"video",event:{type:"volumechange"}},i.l)},i.C=l.getCastMessageBus("urn:x-cast:com.google.cast.media"),i.C.onMessage=function(y){return d$(i,y)},i.l=l.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),i.l.onMessage=function(y){return f$(i,y)},l.start(),l=E(vw);for(var c=l.next();!c.done;c=l.next())i.h.o(i.g,c.value,function(y){return Pw(i,"video",y)});for(var p in Sv)i.h.o(i.i,Sv[p],function(y){return Pw(i,"player",y)});cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?i.i.Fe(3840,2160):i.i.Fe(1920,1080),i.h.o(i.g,"loadeddata",function(){i.I=!0}),i.h.o(i.i,"loading",function(){i.B=!1,Fd(i)}),i.h.o(i.g,"playing",function(){i.B=!1,Fd(i)}),i.h.o(i.g,"pause",function(){Fd(i)}),i.h.o(i.i,"unloading",function(){i.B=!0,Fd(i)}),i.h.o(i.g,"ended",function(){new kn(function(){i.g&&i.g.ended&&(i.B=!0,Fd(i))}).U(p$)})}function Dw(i){i.s=0,i.G=!0,i.L=cast.receiver.CastReceiverManager.getInstance().getSenders().length!=0,Fd(i)}function Fd(i){var l;Z(function(c){if(c.g==1)return I(c,Promise.resolve(),2);if(!i.i)return c.return();l=new De("caststatuschanged"),i.dispatchEvent(l),Lw(i)||iu(i),U(c)})}function c$(i,l,c){var p,y,A,P,N,G,q,ae,Te,Ie,Ne;Z(function(Ve){switch(Ve.g){case 1:for(p in l.player)y=l.player[p],i.i[p](y);return i.J(c),A=i.g.autoplay,l.manifest?(i.g.autoplay=!1,w(Ve,5),I(Ve,i.i.load(l.manifest,l.startTime),7)):I(Ve,Promise.resolve(),3);case 7:K(Ve,3);break;case 5:return P=W(Ve),N=Tv,G=new Map().set("detail",P),q=new De(N,G),i.i&&i.i.dispatchEvent(q),Ve.return();case 3:if(!i.i)return Ve.return();for(ae in l.video)Te=l.video[ae],i.g[ae]=Te;for(Ie in l.playerAfterLoad)Ne=l.playerAfterLoad[Ie],i.i[Ie](Ne);i.g.autoplay=A,l.manifest&&(i.g.play(),iu(i)),U(Ve)}})}function Pw(i,l,c){i.i&&(IA(i),Zu(i,{type:"event",targetName:l,event:c},i.l))}function IA(i){i.M.U(h$);for(var l={video:{},player:{}},c=E(ZV),p=c.next();!p.done;p=c.next())p=p.value,l.video[p]=i.g[p];if(i.i.W())for(var y in _A)i.s%_A[y]==0&&(l.player[y]=i.i[y]());for(var A in Iv)i.s%Iv[A]==0&&(l.player[A]=i.i[A]());(c=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(l.video.volume=c.level,l.video.muted=c.muted),i.I&&(i.s+=1),Zu(i,{type:"update",update:l},i.l),Lw(i)}function Lw(i){return i.G&&(i.g.duration||i.i.W())?(RA(i),i.G=!1,!0):!1}function RA(i,l){var c={contentId:i.i.Yd(),streamType:i.i.W()?"LIVE":"BUFFERED",contentType:""};i.i.W()||(c.duration=i.g.duration),i.j&&(c.metadata=i.j),iu(i,l===void 0?0:l,c)}function f$(i,l){var c=yA(l.data);switch(c.type){case"init":i.s=0,i.I=!1,i.G=!0,c$(i,c.initState,c.appData),IA(i);break;case"appData":i.J(c.appData);break;case"set":var p=c.targetName,y=c.property;if(c=c.value,p=="video"){var A=cast.receiver.CastReceiverManager.getInstance();if(y=="volume"){A.setSystemVolumeLevel(c);break}else if(y=="muted"){A.setSystemVolumeMuted(c);break}}i.P[p][y]=c;break;case"call":p=i.P[c.targetName],p[c.methodName].apply(p,c.args);break;case"asyncCall":p=c.targetName,y=c.methodName,p=="player"&&y=="load"&&(i.s=0,i.I=!1);var P=c.id,N=l.senderId;A=i.P[p],c=A[y].apply(A,c.args),p=="player"&&y=="load"&&(c=c.then(function(){i.G=!0})),c.then(function(){return Mw(i,N,P,null)},function(G){return Mw(i,N,P,G)})}}function d$(i,l){var c=yA(l.data);switch(c.type){case"PLAY":i.g.play(),iu(i);break;case"PAUSE":i.g.pause(),iu(i);break;case"SEEK":var p=c.currentTime,y=c.resumeState;p!=null&&(i.g.currentTime=Number(p)),y&&y=="PLAYBACK_START"?(i.g.play(),iu(i)):y&&y=="PLAYBACK_PAUSE"&&(i.g.pause(),iu(i));break;case"STOP":i.i.Qe().then(function(){i.i&&iu(i)});break;case"GET_STATUS":RA(i,Number(c.requestId));break;case"VOLUME":y=c.volume,p=y.level,y=y.muted;var A=i.g.volume,P=i.g.muted;p!=null&&(i.g.volume=Number(p)),y!=null&&(i.g.muted=y),A==i.g.volume&&P==i.g.muted||iu(i);break;case"LOAD":i.s=0,i.I=!1,i.G=!1,p=c.media,y=c.currentTime,A=i.S(p.contentId),P=c.autoplay||!0,i.J(p.customData),P&&(i.g.autoplay=!0),i.i.load(A,y).then(function(){i.i&&RA(i)}).catch(function(N){var G="LOAD_FAILED";N.category==7&&N.code==7e3&&(G="LOAD_CANCELLED"),Zu(i,{requestId:Number(c.requestId),type:G},i.C)});break;default:Zu(i,{requestId:Number(c.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},i.C)}}function Mw(i,l,c,p){i.i&&Zu(i,{type:"asyncComplete",id:c,error:p},i.l,l)}function Zu(i,l,c,p){i.L&&(i=mw(l),p?c.getCastChannel(p).send(i):c.broadcast(i))}function iu(i,l,c){c=c===void 0?null:c;var p={mediaSessionId:0,playbackRate:i.g.playbackRate,playerState:i.B?g$:i.i.Rc()?v$:i.g.paused?y$:m$,currentTime:i.g.currentTime,supportedMediaCommands:63,volume:{level:i.g.volume,muted:i.g.muted}};c&&(p.media=c),Zu(i,{requestId:l===void 0?0:l,type:"MEDIA_STATUS",status:[p]},i.C)}Le("shaka.cast.CastReceiver",$i),$i.prototype.destroy=$i.prototype.destroy,$i.prototype.setContentArtist=$i.prototype.jh,$i.prototype.setContentImage=$i.prototype.kh,$i.prototype.setContentTitle=$i.prototype.mh,$i.prototype.clearContentMetadata=$i.prototype.Xf,$i.prototype.setContentMetadata=$i.prototype.lh,$i.prototype.isIdle=$i.prototype.Mg,$i.prototype.isConnected=$i.prototype.isConnected;var h$=.5,p$=5,g$="IDLE",m$="PLAYING",v$="BUFFERING",y$="PAUSED";function ww(i){var l=this;this.g=[],this.h=[],this.data=[],new Lr().box("moov",$r).Z("pssh",function(c){if(!(1<c.version)){var p=er(c.reader.X,-12,c.size);if(l.data.push(p),l.g.push(Wl(c.reader.Lb(16))),0<c.version){p=c.reader.T(),p=E($e(p));for(var y=p.next();!y.done;y=p.next())y=Wl(c.reader.Lb(16)),l.h.push(y)}}}).parse(i)}function Ow(i,l){var c=i.length,p=l.length+16+c,y=new Uint8Array(p),A=Ii(y),P=0;return A.setUint32(P,p),P+=4,A.setUint32(P,1886614376),P+=4,A.setUint32(P,0),P+=4,y.set(l,P),P+=l.length,A.setUint32(P,c),y.set(i,P+4),y}function E$(i){if(!i)return i;var l=new ww(i);if(1>=l.data.length)return i;i=[];var c={};l=E(l.data);for(var p=l.next();!p.done;c={cd:c.cd},p=l.next())c.cd=p.value,i.some(function(y){return function(A){return Wi(A,y.cd)}}(c))||i.push(c.cd);return Hl.apply(Kr,T(i))}function bv(i,l){var c=Yr(i,l);return c.length!=1?null:c[0]}function bA(i,l,c){return i=Nw(i,l,c),i.length!=1?null:i[0]}function Yr(i,l){return Array.from(i.childNodes).filter(function(c){return c instanceof Element&&c.tagName==l})}function _$(i){return Array.from(i.childNodes).filter(function(l){return l instanceof Element})}function Nw(i,l,c){return Array.from(i.childNodes).filter(function(p){return p instanceof Element&&p.localName==c&&p.namespaceURI==l})}function gf(i,l,c){return i.hasAttributeNS(l,c)?i.getAttributeNS(l,c):null}function su(i,l,c){l=E(l);for(var p=l.next();!p.done;p=l.next())if(p=p.value,i.hasAttributeNS(p,c))return i.getAttributeNS(p,c);return null}function Dv(i){return Array.from(i.childNodes).every(Fw)?i.textContent.trim():null}function Fw(i){return i.nodeType==Node.TEXT_NODE||i.nodeType==Node.CDATA_SECTION_NODE}function Or(i,l,c,p){p=p===void 0?null:p;var y=null;return i=i.getAttribute(l),i!=null&&(y=c(i)),y??p}function T$(i){return i?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(i)&&(i+="Z"),i=Date.parse(i),isNaN(i)?null:Math.floor(i/1e3)):null}function au(i){return!i||(i=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(i),!i)?null:(i=31536e3*Number(i[1]||null)+2592e3*Number(i[2]||null)+86400*Number(i[3]||null)+3600*Number(i[4]||null)+60*Number(i[5]||null)+Number(i[6]||null),isFinite(i)?i:null)}function Pv(i){var l=/([0-9]+)-([0-9]+)/.exec(i);return!l||(i=Number(l[1]),!isFinite(i))?null:(l=Number(l[2]),isFinite(l)?{start:i,end:l}:null)}function S$(i){return i=Number(i),i%1===0?i:null}function Lv(i){return i=Number(i),i%1===0&&0<i?i:null}function ul(i){return i=Number(i),i%1===0&&0<=i?i:null}function eg(i){return i=Number(i),isNaN(i)?null:i}function A$(i){var l;return i=(l=i.match(/^(\d+)\/(\d+)$/))?Number(l[1])/Number(l[2]):Number(i),isNaN(i)?null:i}function DA(i,l){var c=new DOMParser,p=null;try{p=c.parseFromString(i,"text/xml")}catch{return null}return c=p.documentElement,!c||c.getElementsByTagName("parsererror").length||p.documentElement.tagName!=l?null:c}function kw(i,l){try{var c=Cn(i);return DA(c,l)}catch{return null}}function Uw(i,l,c){var p=b$(i),y=null;i=[];var A=[],P=new Set(p.map(function(N){return N.keyId}));if(P.delete(null),1<P.size)throw new We(2,4,4010);if(l||(A=p.filter(function(N){return N.Af=="urn:mpeg:dash:mp4protection:2011"?(y=N.init||y,!1):!0}),A.length&&(i=R$(y,A,c),i.length==0&&(i=[Kt("",y)]))),p.length&&(l||!A.length))for(i=[],l=E(Object.values(c)),c=l.next();!c.done;c=l.next())c=c.value,c!="org.w3.clearkey"&&i.push(Kt(c,y));if(P=Array.from(P)[0]||null)for(l=E(i),c=l.next();!c.done;c=l.next())for(c=E(c.value.initData),p=c.next();!p.done;p=c.next())p.value.keyId=P;return{bf:P,Si:y,drmInfos:i,gf:!0}}function x$(i,l,c,p){var y=Uw(i,c,p);if(l.gf)i=l.drmInfos.length==1&&!l.drmInfos[0].keySystem,c=y.drmInfos.length==0,(l.drmInfos.length==0||i&&!c)&&(l.drmInfos=y.drmInfos),l.gf=!1;else if(0<y.drmInfos.length&&(l.drmInfos=l.drmInfos.filter(function(A){return y.drmInfos.some(function(P){return P.keySystem==A.keySystem})}),l.drmInfos.length==0))throw new We(2,4,4008);return y.bf||l.bf}function C$(i){var l=0,c=Ii(i),p=c.getUint32(l,!0);if(p!=i.byteLength)return[];e:{for(i=l+6,l=[];i<c.byteLength-1;){p=c.getUint16(i,!0),i+=2;var y=c.getUint16(i,!0);if(i+=2,y&1||y+i>c.byteLength){c=[];break e}var A=er(c,i,y);l.push({type:p,value:A}),i+=y}c=l}return c}function I$(i){i=E(i.getElementsByTagName("DATA"));for(var l=i.next();!l.done;l=i.next()){l=E(l.value.childNodes);for(var c=l.next();!c.done;c=l.next())if(c=c.value,c instanceof Element&&c.tagName=="LA_URL")return c.textContent}return""}function Mv(i){return i=bA(i.node,"urn:microsoft:playready","pro"),!i||(i=Xa(i.textContent),i=C$(i).filter(function(l){return l.type===P$})[0],!i)?"":(i=Xn(i.value,!0),(i=DA(i,"WRMHEADER"))?I$(i):"")}function R$(i,l,c){var p=[];l=E(l);for(var y=l.next();!y.done;y=l.next()){y=y.value;var A=c[y.Af];if(A){var P;if(P=bA(y.node,"urn:microsoft:playready","pro")){P=Xa(P.textContent);var N=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);P=[{initData:Ow(P,N),initDataType:"cenc",keyId:y.keyId}]}else P=null;P=Kt(A,y.init||i||P),(A=L$.get(A))&&(P.licenseServerUri=A(y)),p.push(P)}}return p}function b$(i){var l=[];i=E(i);for(var c=i.next();!c.done;c=i.next())(c=D$(c.value))&&l.push(c);return l}function D$(i){var l=i.getAttribute("schemeIdUri"),c=gf(i,"urn:mpeg:cenc:2013","default_KID"),p=Nw(i,"urn:mpeg:cenc:2013","pssh").map(Dv);if(!l)return null;if(l=l.toLowerCase(),c&&(c=c.replace(/-/g,"").toLowerCase(),c.includes(" ")))throw new We(2,4,4009);var y=[];try{y=p.map(function(A){return{initDataType:"cenc",initData:Xa(A),keyId:null}})}catch{throw new We(2,4,4007)}return{node:i,Af:l,keyId:c,init:0<y.length?y:null}}var P$=1,L$=new Map().set("com.widevine.alpha",function(i){return(i=bA(i.node,"urn:microsoft","laurl"))&&i.getAttribute("licenseUrl")||""}).set("com.microsoft.playready",Mv).set("com.microsoft.playready.recommendation",Mv).set("com.microsoft.playready.software",Mv).set("com.microsoft.playready.hardware",Mv);function wv(i,l,c,p,y){var A={RepresentationID:l,Number:c,Bandwidth:p,Time:y};return i.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(P,N,G,q){if(P=="$$")return"$";var ae=A[N];if(ae==null)return P;switch(N=="RepresentationID"&&G&&(G=void 0),N=="Time"&&(ae=Math.round(ae)),q){case void 0:case"d":case"i":case"u":P=ae.toString();break;case"o":P=ae.toString(8);break;case"x":P=ae.toString(16);break;case"X":P=ae.toString(16).toUpperCase();break;default:P=ae.toString()}return G=o.parseInt(G,10)||1,Array(Math.max(0,G-P.length)+1).join("0")+P})}function Bw(i,l){var c=cl(i,l,"timescale"),p=1;c&&(p=Lv(c)||1);var y=cl(i,l,"duration");c=Lv(y||""),i.O.contentType=="image"&&(c=eg(y||"")),c&&(c/=p);var A=cl(i,l,"startNumber");y=Number(cl(i,l,"presentationTimeOffset"))||0;var P=ul(A||"");(A==null||P==null)&&(P=1);var N=Ov(i,l,"SegmentTimeline");if(A=null,N){A=p;var G=i.ba.duration||1/0,q=Yr(N,"S");N=[];var ae=-y;q=E(it(q));for(var Te=q.next();!Te.done;Te=q.next()){Te=Te.value;var Ie=Te.item,Ne=Te.next,Ve=Or(Ie,"t",ul);Te=Or(Ie,"d",ul);var qe=Or(Ie,"r",S$);if(Ve!=null&&(Ve-=y),!Te)break;if(Ie=Ve??ae,Ve=qe||0,0>Ve)if(Ne){if(Ne=Or(Ne,"t",ul),Ne==null)break;if(Ie>=Ne)break;Ve=Math.ceil((Ne-Ie)/Te)-1}else{if(G==1/0)break;if(Ie/A>=G)break;Ve=Math.ceil((G*A-Ie)/Te)-1}for(0<N.length&&Ie!=ae&&(N[N.length-1].end=Ie/A),Ne=E($e(Ve+1)),Ve=Ne.next();!Ve.done;Ve=Ne.next())ae=Ie+Te,N.push({start:Ie/A,end:ae/A,sh:Ie}),Ie=ae}A=N}return{timescale:p,Fa:c,yc:P,xb:y/p||0,Re:y,timeline:A}}function cl(i,l,c){return[l(i.O),l(i.Ha),l(i.ya)].filter(bt).map(function(p){return p.getAttribute(c)}).reduce(function(p,y){return p||y})}function Ov(i,l,c){return[l(i.O),l(i.Ha),l(i.ya)].filter(bt).map(function(p){return bv(p,c)}).reduce(function(p,y){return p||y})}function M$(i,l,c,p,y,A){for(var P=gf(i,"http://www.w3.org/1999/xlink","href"),N=gf(i,"http://www.w3.org/1999/xlink","actuate")||"onRequest",G=E(Array.from(i.attributes)),q=G.next();!q.done;q=G.next())q=q.value,q.namespaceURI=="http://www.w3.org/1999/xlink"&&i.removeAttributeNS(q.namespaceURI,q.localName);if(5<=A)return xo(new We(2,4,4028));if(N!="onLoad")return xo(new We(2,4,4027));var ae=Dt([p],[P]);return y.request(0,Qs(ae,l)).va(function(Te){if(Te=kw(Te.data,i.tagName),!Te)return xo(new We(2,4,4001,P));for(;i.childNodes.length;)i.removeChild(i.childNodes[0]);for(;Te.childNodes.length;){var Ie=Te.childNodes[0];Te.removeChild(Ie),i.appendChild(Ie)}for(Te=E(Array.from(Te.attributes)),Ie=Te.next();!Ie.done;Ie=Te.next())i.setAttributeNode(Ie.value.cloneNode(!1));return Nv(i,l,c,ae[0],y,A+1)})}function Nv(i,l,c,p,y,A){if(A=A===void 0?0:A,gf(i,"http://www.w3.org/1999/xlink","href")){var P=M$(i,l,c,p,y,A);return c&&(P=P.va(void 0,function(){return Nv(i,l,c,p,y,A)})),P}P=[];for(var N=E(Array.from(i.childNodes)),G=N.next();!G.done;G=N.next())G=G.value,G instanceof Element&&(gf(G,"http://www.w3.org/1999/xlink","href")=="urn:mpeg:dash:resolve-to-zero:2013"?i.removeChild(G):G.tagName!="SegmentTimeline"&&P.push(Nv(G,l,c,p,y,A)));return H0(P).va(function(){return i})}function w$(i,l,c,p,y,A,P){var N,G=new Lr().Z("sidx",function(q){N=O$(l,p,y,A,P,c,q)});if(i&&G.parse(i),N)return N;throw new We(2,3,3004)}function O$(i,l,c,p,y,A,P){var N=[];P.reader.skip(4);var G=P.reader.T();if(G==0)throw new We(2,3,3005);if(P.version==0)var q=P.reader.T(),ae=P.reader.T();else q=P.reader.xc(),ae=P.reader.xc();P.reader.skip(2);var Te=P.reader.wc();for(i=i+P.size+ae,Te=E($e(Te)),ae=Te.next();!ae.done;ae=Te.next()){var Ie=P.reader.T();ae=(Ie&2147483648)>>>31,Ie&=2147483647;var Ne=P.reader.T();if(P.reader.skip(4),ae==1)throw new We(2,3,3006);N.push(new Gr(q/G+c,(q+Ne)/G+c,function(){return A},i,i+Ie-1,l,c,p,y)),q+=Ne,i+=Ie}return P.parser.stop(),N}function ec(i){this.h=Ii(i),this.g=new yr(this.h,0)}ec.prototype.Ia=function(){return this.g.Ia()};function ou(i){var l=jw(i);if(7<l.length)throw new We(2,3,3002);var c=0;l=E(l);for(var p=l.next();!p.done;p=l.next())c=256*c+p.value;l=jw(i);e:{p=E(N$);for(var y=p.next();!y.done;y=p.next())if(Wi(l,new Uint8Array(y.value))){p=!0;break e}p=!1}if(p)l=i.h.byteLength-i.g.qa();else{if(l.length==8&&l[1]&224)throw new We(2,3,3001);p=0,y=E(it(l));for(var A=y.next();!A.done;A=y.next()){A=A.value;var P=A.item;p=A.wa==0?P&(1<<8-l.length)-1:256*p+P}l=p}return l=i.g.qa()+l<=i.h.byteLength?l:i.h.byteLength-i.g.qa(),p=Ii(i.h,i.g.qa(),l),i.g.skip(l),new F$(c,p)}function jw(i){var l=i.g.qa(),c=i.g.ra();if(c==0)throw new We(2,3,3002);return c=8-Math.floor(Math.log2(c)),i.g.skip(c-1),er(i.h,l,c)}var N$=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];function F$(i,l){this.id=i,this.g=l}function PA(i){if(8<i.g.byteLength)throw new We(2,3,3002);if(i.g.byteLength==8&&i.g.getUint8(0)&224)throw new We(2,3,3001);for(var l=0,c=E($e(i.g.byteLength)),p=c.next();!p.done;p=c.next())p=i.g.getUint8(p.value),l=256*l+p;return l}function k$(i,l,c,p,y,A,P,N,G){function q(){return y}var ae=[];i=new ec(i.g);for(var Te=null,Ie=null;i.Ia();){var Ne=ou(i);if(Ne.id==187){var Ve=U$(Ne);Ve&&(Ne=c*Ve.uh,Ve=l+Ve.bh,Te!=null&&ae.push(new Gr(Te+P,Ne+P,q,Ie,Ve-1,A,P,N,G)),Te=Ne,Ie=Ve)}}return Te!=null&&ae.push(new Gr(Te+P,p+P,q,Ie,null,A,P,N,G)),ae}function U$(i){var l=new ec(i.g);if(i=ou(l),i.id!=179)throw new We(2,3,3013);if(i=PA(i),l=ou(l),l.id!=183)throw new We(2,3,3012);l=new ec(l.g);for(var c=0;l.Ia();){var p=ou(l);if(p.id==241){c=PA(p);break}}return{uh:i,bh:c}}function Kw(i,l){var c=Ov(i,l,"Initialization");if(!c)return null;var p=i.O.Va,y=c.getAttribute("sourceURL");y&&(p=Dt(i.O.Va,[y])),y=0;var A=null;return(c=Or(c,"range",Pv))&&(y=c.start,A=c.end),new Js(function(){return p},y,A,Vw(i))}function B$(i,l){var c=Number(cl(i,kd,"presentationTimeOffset"))||0,p=cl(i,kd,"timescale"),y=1;p&&(y=Lv(p)||1);var A=c/y||0,P=Kw(i,kd);j$(i,P);var N=V0(i);return{jc:function(){var G=Ov(N,kd,"RepresentationIndex"),q=N.O.Va;return G&&(G=G.getAttribute("sourceURL"))&&(q=Dt(N.O.Va,[G])),G=Ww(N),Gw(N,l,P,q,G.start,G.end,A)}}}function Gw(i,l,c,p,y,A,P){var N,G,q,ae,Te,Ie,Ne,Ve,qe,Ze,Qe,Lt,It,yt,Jt;return Z(function(un){if(un.g==1)return N=i.presentationTimeline,G=!i.Fb||!i.ba.rf,q=i.ba.start,ae=i.ba.duration,Te=i.O.mimeType.split("/")[1],Ie=l,Ne=null,Ve=[Ie(p,y,A),Te=="webm"?Ie(c.Ma(),c.Ka,c.Da):null],Ie=null,I(un,Promise.all(Ve),2);if(qe=un.h,Ze=qe[0],Qe=qe[1]||null,Lt=null,It=q-P,yt=q,Jt=ae?q+ae:1/0,Te=="mp4")var dn=w$(Ze,y,p,c,It,yt,Jt);else{if(dn=new ec(Qe),ou(dn).id!=440786851)throw new We(2,3,3008);var xn=ou(dn);if(xn.id!=408125543)throw new We(2,3,3009);dn=xn.g.byteOffset,xn=new ec(xn.g);for(var hn=null;xn.Ia();){var Mn=ou(xn);if(Mn.id==357149030){hn=Mn;break}}if(!hn)throw new We(2,3,3010);for(hn=new ec(hn.g),Mn=1e6,xn=null;hn.Ia();){var Qn=ou(hn);if(Qn.id==2807729)Mn=PA(Qn);else if(Qn.id==17545)if(Qn.g.byteLength==4)xn=Qn.g.getFloat32(0);else if(Qn.g.byteLength==8)xn=Qn.g.getFloat64(0);else throw new We(2,3,3003)}if(xn==null)throw new We(2,3,3011);if(hn=Mn/1e9,xn*=hn,Mn=ou(new ec(Ze)),Mn.id!=475249515)throw new We(2,3,3007);dn=k$(Mn,dn,hn,xn,p,c,It,yt,Jt)}return Lt=dn,N.tc(Lt),Ne=new fr(Lt),G&&Ne.Hb(yt,Jt,!0),un.return(Ne)})}function kd(i){return i.Xc}function Ww(i){var l=Ov(i,kd,"RepresentationIndex");return i=cl(i,kd,"indexRange"),i=Pv(i||""),l&&(i=Or(l,"range",Pv,i)),i}function j$(i,l){if(Hw(i,l),!Ww(i))throw new We(2,4,4002)}function Hw(i,l){var c=i.O.mimeType.split("/")[1];if(i.O.contentType!=Ke&&c!="mp4"&&c!="webm")throw new We(2,4,4006);if(c=="webm"&&!l)throw new We(2,4,4005)}function Vw(i){var l=i.O;return{bandwidth:i.bandwidth,audioSamplingRate:l.audioSamplingRate,codecs:l.codecs,contentType:l.contentType,frameRate:l.frameRate||null,height:l.height||null,mimeType:l.mimeType,channelsCount:l.ud,pixelAspectRatio:l.pixelAspectRatio||null,width:l.width||null}}function K$(i,l){var c=Kw(i,$w),p=G$(i);if(!p.Fa&&!p.timeline&&1<p.qc.length)throw new We(2,4,4002);if(!p.Fa&&!i.ba.duration&&!p.timeline&&p.qc.length==1)throw new We(2,4,4002);if(p.timeline&&p.timeline.length==0)throw new We(2,4,4002);var y=null,A=null;i.ya.id&&i.O.id&&(A=l[i.ya.id+","+i.O.id])&&(y=A.segmentIndex);var P=W$(i.ba.start,i.ba.duration,i.O.Va,p,c);return c=!y,y?y.sc(P,i.presentationTimeline.ub()):y=new fr(P),i.presentationTimeline.tc(P),i.Fb&&i.ba.rf||y.Hb(i.ba.start,i.ba.duration?i.ba.start+i.ba.duration:1/0,c),A&&(A.segmentIndex=y),{jc:function(){return y&&y.R.length!=0||y.rc(P),Promise.resolve(y)}}}function $w(i){return i.Mb}function G$(i){var l=H$(i);i=Bw(i,$w);var c=i.yc;c==0&&(c=1);var p=0;return i.Fa?p=i.Fa*(c-1):i.timeline&&0<i.timeline.length&&(p=i.timeline[0].start),{Fa:i.Fa,startTime:p,yc:c,xb:i.xb,timeline:i.timeline,qc:l}}function W$(i,l,c,p,y){var A=p.qc.length;p.timeline&&p.timeline.length!=p.qc.length&&(A=Math.min(p.timeline.length,p.qc.length));var P=i-p.xb,N=l?i+l:1/0,G=[],q=p.startTime,ae={};A=E($e(A));for(var Te=A.next();!Te.done;ae={Nd:ae.Nd},Te=A.next()){Te=Te.value;var Ie=p.qc[Te];ae.Nd=Dt(c,[Ie.Sg]);var Ne=void 0;Ne=p.Fa!=null?q+p.Fa:p.timeline?p.timeline[Te].end:q+l,G.push(new Gr(i+q,i+Ne,function(Ve){return function(){return Ve.Nd}}(ae),Ie.start,Ie.end,y,P,i,N)),q=Ne}return G}function H$(i){return[i.O.Mb,i.Ha.Mb,i.ya.Mb].filter(bt).map(function(l){return Yr(l,"SegmentURL")}).reduce(function(l,c){return 0<l.length?l:c}).map(function(l){l.getAttribute("indexRange")&&!i.nf&&(i.nf=!0);var c=l.getAttribute("media");return l=Or(l,"mediaRange",Pv,{start:0,end:null}),{Sg:c,start:l.start,end:l.end}})}function V$(i,l,c,p,y,A){var P=q$(i),N=$$(i);z$(N);var G=V0(i);if(N.Qc)return Hw(i,P),{jc:function(){var Ne=wv(N.Qc,G.O.id,null,G.bandwidth||null,null);return Ne=Dt(G.O.Va,[Ne]),Gw(G,l,P,Ne,0,null,N.xb)}};if(N.Fa)return p||(i.presentationTimeline.le(N.Fa),i.presentationTimeline.me(i.ba.start)),{jc:function(){return Y$(G,N,y,P,A)}};var q=null;p=p=null,i.ya.id&&i.O.id&&(p=i.ya.id+","+i.O.id,p=c[p])&&(q=p.segmentIndex);var ae=X$(G,N,P);c=i.ba.start;var Te=i.ba.duration?i.ba.start+i.ba.duration:1/0,Ie=Te!=1/0;return q?(Ie&&new fr(ae).Hb(c,Te,!0),q.sc(ae,i.presentationTimeline.ub())):q=new fr(ae),i.presentationTimeline.tc(ae),Ie&&q.Hb(c,Te),p&&i.Fb&&(p.segmentIndex=q),{jc:function(){return q&&q.R.length!=0||q.rc(ae),Promise.resolve(q)}}}function Fv(i){return i.Yc}function $$(i){var l=Bw(i,Fv),c=cl(i,Fv,"media");return i=cl(i,Fv,"index"),{Fa:l.Fa,timescale:l.timescale,yc:l.yc,xb:l.xb,Re:l.Re,timeline:l.timeline,je:c,Qc:i}}function z$(i){var l=i.Qc?1:0;if(l+=i.timeline?1:0,l+=i.Fa?1:0,l==0)throw new We(2,4,4002);if(l!=1&&(i.Qc&&(i.timeline=null),i.Fa=null),!i.Qc&&!i.je)throw new We(2,4,4002)}function Y$(i,l,c,p,y){function A(hn){var Mn=(hn-Ne)*Ie,Qn=Mn+l.xb,Jn=Mn+q;Mn=Jn+Ie;var ur=Math.min(Mn,N());return Jn=new Gr(Jn,ur,function(){var rr=wv(qe,Qe,hn,Ze,Qn*Ve);return Dt(Lt,[rr])},0,null,p,It,q,N()),Jn.l=Mn,Jn}function P(){var hn=[Math.max(G.ub(),q),Math.min(G.Qb(),N())].map(function(Mn){return Mn-q});return[Math.ceil(hn[0]/Ie),Math.ceil(hn[1]/Ie)-1].map(function(Mn){return Mn+Ne})}function N(){var hn=ae!=null&&y[ae]||Te;return hn?q+hn:1/0}var G=i.presentationTimeline,q=i.ba.start,ae=i.ya.id,Te=i.ba.duration,Ie=l.Fa,Ne=l.yc,Ve=l.timescale,qe=l.je,Ze=i.bandwidth||null,Qe=i.O.id,Lt=i.O.Va,It=q-l.xb,yt=P();i=i.Fb?Math.max(yt[0],yt[1]-c+1):yt[0],yt=yt[1],c=[];for(var Jt=i;Jt<=yt;++Jt){var un=A(Jt);c.push(un)}var dn=new fr(c);if(c=G.Qb()<N(),Jt=G.W(),c||Jt){var xn=Math.max(i,yt+1);dn.Ed(Ie,function(){var hn=G.ub();dn.Ob(hn);var Mn=E(P());Mn.next(),Mn=Mn.next().value;for(var Qn=[];xn<=Mn;){var Jn=A(xn);Qn.push(Jn),xn++}return hn>N()&&!Qn.length?null:Qn})}return Promise.resolve(dn)}function X$(i,l,c){var p=i.ba.start,y=i.ba.duration,A=p-l.xb;y=y?p+y:1/0;for(var P=[],N={},G=E(it(l.timeline)),q=G.next();!q.done;N={Md:N.Md,Qd:N.Qd,Td:N.Td,Jd:N.Jd,Vd:N.Vd,Kd:N.Kd},q=G.next()){q=q.value;var ae=q.item,Te=ae.start,Ie=ae.sh;ae=ae.end,N.Td=q.wa+l.yc,N.Vd=Ie+l.Re,N.Qd=i.O.id,N.Jd=i.bandwidth||null,N.Md=l.je,N.Kd=i.O.Va,P.push(new Gr(p+Te,p+ae,function(Ne){return function(){var Ve=wv(Ne.Md,Ne.Qd,Ne.Td,Ne.Jd||null,Ne.Vd);return Dt(Ne.Kd,[Ve]).map(function(qe){return qe.toString()})}}(N),0,null,c,A,p,y))}return P}function q$(i){var l=cl(i,Fv,"initialization");if(!l)return null;var c=i.O.id,p=i.bandwidth||null,y=i.O.Va;return new Js(function(){var A=wv(l,c,null,p,null);return Dt(y,[A])},0,null,Vw(i))}function zw(){this.l=[],this.g=[],this.h=[],this.j=[],this.i=[],this.s=new Set}zw.prototype.release=function(){for(var i=E(this.g.concat(this.h,this.j,this.i)),l=i.next();!l.done;l=i.next())l=l.value,l.segmentIndex&&l.segmentIndex.release();this.g=[],this.h=[],this.j=[],this.i=[],this.l=[]};function Q$(i,l,c){var p,y,A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe,Ze,Qe,Lt,It,yt,Jt,un,dn,xn,hn,Mn,Qn,Jn,ur,rr,Rr,ii,Sr,cs,pu;return Z(function(ts){switch(ts.g){case 1:if(p=ut,J$(l),ez(l),Z$(l),tz(l),!c&&l.length==1){y=l[0],i.g=y.kd,i.h=y.Gd,i.j=y.textStreams,i.i=y.imageStreams,ts.D(2);break}for(A=-1,P=E(it(l)),N=P.next();!N.done;N=P.next())G=N.value,q=G.wa,ae=G.item,i.s.has(ae.id)||(i.s.add(ae.id),A==-1&&(A=q));if(A==-1)return ts.return();for(Te=l.map(function(ea){return ea.kd}),Ie=l.map(function(ea){return ea.Gd}),Ne=l.map(function(ea){return ea.textStreams}),Ve=l.map(function(ea){return ea.imageStreams}),qe=E(Ne),Ze=qe.next();!Ze.done;Ze=qe.next())Qe=Ze.value,Qe.push(eO(p.ua));for(Lt=E(Ve),It=Lt.next();!It.done;It=Lt.next())yt=It.value,yt.push(eO(p.Gc));return I(ts,tc(i.g,Te,A,tg,Ud),3);case 3:return I(ts,tc(i.h,Ie,A,tg,Ud),4);case 4:return I(ts,tc(i.j,Ne,A,tg,Ud),5);case 5:return I(ts,tc(i.i,Ve,A,tg,Ud),2);case 2:if(Jt=0,un=[],i.h.length&&i.g.length)for(Jn=E(i.g),ur=Jn.next();!ur.done;ur=Jn.next())for(rr=ur.value,Rr=E(i.h),ii=Rr.next();!ii.done;ii=Rr.next())Sr=ii.value,cs=Q0(rr.drmInfos,Sr.drmInfos),rr.drmInfos.length&&Sr.drmInfos.length&&!cs.length||(pu=Jt++,un.push({id:pu,language:rr.language,primary:rr.primary,audio:rr,video:Sr,bandwidth:(rr.bandwidth||0)+(Sr.bandwidth||0),drmInfos:cs,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(dn=i.h.concat(i.g),xn=E(dn),hn=xn.next();!hn.done;hn=xn.next())Mn=hn.value,Qn=Jt++,un.push({id:Qn,language:Mn.language,primary:Mn.primary,audio:Mn.type==p.Nb?Mn:null,video:Mn.type==p.mb?Mn:null,bandwidth:Mn.bandwidth||0,drmInfos:Mn.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});i.l=un,U(ts)}})}function J$(i){i=E(i);for(var l=i.next();!l.done;l=i.next()){l=l.value;for(var c=[],p=E(l.kd),y=p.next();!y.done;y=p.next()){y=y.value;for(var A=!1,P=E(c),N=P.next();!N.done;N=P.next())N=N.value,y.id!=N.id&&y.channelsCount==N.channelsCount&&y.language==N.language&&y.bandwidth==N.bandwidth&&y.label==N.label&&y.codecs==N.codecs&&y.mimeType==N.mimeType&&vt(y.roles,N.roles)&&y.audioSamplingRate==N.audioSamplingRate&&y.primary==N.primary&&(A=!0);A||c.push(y)}l.kd=c}}function Z$(i){i=E(i);for(var l=i.next();!l.done;l=i.next()){l=l.value;for(var c=[],p=E(l.textStreams),y=p.next();!y.done;y=p.next()){y=y.value;for(var A=!1,P=E(c),N=P.next();!N.done;N=P.next())N=N.value,y.id!=N.id&&y.language==N.language&&y.label==N.label&&y.codecs==N.codecs&&y.mimeType==N.mimeType&&vt(y.roles,N.roles)&&(A=!0);A||c.push(y)}l.textStreams=c}}function ez(i){i=E(i);for(var l=i.next();!l.done;l=i.next()){l=l.value;for(var c=[],p=E(l.Gd),y=p.next();!y.done;y=p.next()){y=y.value;for(var A=!1,P=E(c),N=P.next();!N.done;N=P.next())N=N.value,y.id!=N.id&&y.width==N.width&&y.frameRate==N.frameRate&&y.codecs==N.codecs&&y.mimeType==N.mimeType&&y.label==N.label&&vt(y.roles,N.roles)&&be(y.closedCaptions,N.closedCaptions)&&y.bandwidth==N.bandwidth&&(A=!0);A||c.push(y)}l.Gd=c}}function tz(i){i=E(i);for(var l=i.next();!l.done;l=i.next()){l=l.value;for(var c=[],p=E(l.imageStreams),y=p.next();!y.done;y=p.next()){y=y.value;for(var A=!1,P=E(c),N=P.next();!N.done;N=P.next())N=N.value,y.id!=N.id&&y.width==N.width&&y.codecs==N.codecs&&y.mimeType==N.mimeType&&(A=!0);A||c.push(y)}l.imageStreams=c}}function Yw(i){var l,c,p,y,A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe,Ze,Qe,Lt,It,yt,Jt,un,dn,xn,hn,Mn,Qn;return Z(function(Jn){switch(Jn.g){case 1:if(l=ut,i.length==1)return Jn.return(i[0]);for(c=i.map(function(ur){return ur.filter(function(rr){return rr.type==l.Nb})}),p=i.map(function(ur){return ur.filter(function(rr){return rr.type==l.mb})}),y=i.map(function(ur){return ur.filter(function(rr){return rr.type==l.ua})}),A=i.map(function(ur){return ur.filter(function(rr){return rr.type==l.Gc})}),P=E(y),N=P.next();!N.done;N=P.next())G=N.value,G.push(Zw(l.ua));for(q=E(A),ae=q.next();!ae.done;ae=q.next())Te=ae.value,Te.push(Zw(l.Gc));return I(Jn,tc([],c,0,kv,Uv),2);case 2:return Ie=Jn.h,I(Jn,tc([],p,0,kv,Uv),3);case 3:return Ne=Jn.h,I(Jn,tc([],y,0,kv,Uv),4);case 4:return Ve=Jn.h,I(Jn,tc([],A,0,kv,Uv),5);case 5:if(qe=Jn.h,Ze=0,Ne.length&&Ie.length)for(Jt=E(Ie),un=Jt.next();!un.done;un=Jt.next())for(dn=un.value,xn=E(Ne),hn=xn.next();!hn.done;hn=xn.next())Mn=hn.value,Qn=Ze++,Mn.variantIds.push(Qn),dn.variantIds.push(Qn);else for(Qe=Ne.concat(Ie),Lt=E(Qe),It=Lt.next();!It.done;It=Lt.next())yt=It.value,yt.variantIds=[Ze++];return Jn.return(Ne.concat(Ie).concat(Ve).concat(qe))}})}function tc(i,l,c,p,y){var A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe,Ze,Qe,Lt,It,yt,Jt,un,dn,xn,hn,Mn,Qn,Jn;return Z(function(ur){switch(ur.g){case 1:for(A=ut,P=[],N=E(it(l)),G=N.next();!G.done;G=N.next())q=G.value,ae=q.wa,Te=q.item,ae>=c?P.push(new Set(Te)):P.push(new Set);Ie=E(i),Ne=Ie.next();case 2:if(Ne.done){ur.D(4);break}return Ve=Ne.value,I(ur,nz(Ve,l,c,y,P),5);case 5:if(qe=ur.h,!qe)throw new We(2,4,4037);Ne=Ie.next(),ur.D(2);break;case 4:for(Ze=E(P),Qe=Ze.next();!Qe.done;Qe=Ze.next())for(Lt=Qe.value,It=E(Lt),yt=It.next();!yt.done;yt=It.next())Jt=yt.value,(un=rz(Jt,l,p,y,P))&&i.push(un);for(dn=E(P),Qe=dn.next();!Qe.done;Qe=dn.next())for(xn=Qe.value,hn={},Mn=E(xn),yt=Mn.next();!yt.done;hn={Cb:hn.Cb},yt=Mn.next())if(hn.Cb=yt.value,Qn=hn.Cb.type==A.ua&&!hn.Cb.language,Jn=hn.Cb.type==A.Gc&&!hn.Cb.tilesLayout,!Qn&&!Jn&&i.some(function(rr){return function(Rr){return Rr.mimeType==rr.Cb.mimeType&&Vi(Rr.codecs)==Vi(rr.Cb.codecs)}}(hn)))throw new We(2,4,4037);return ur.return(i)}})}function nz(i,l,c,p,y){return Z(function(A){return A.g==1?(Qw(l,i),i.matchedStreams?i.segmentIndex?I(A,Xw(i,c),2):A.D(2):A.return(!1)):(qw(i,c,p,y),A.return(!0))})}function Xw(i,l){var c,p,y,A,P,N,G,q,ae,Te;return Z(function(Ie){if(Ie.g==1){for(c=[],p=i.matchedStreams,y=E(p),A=y.next();!A.done;A=y.next())P=A.value,c.push(P.createSegmentIndex()),P.trickModeVideo&&!P.trickModeVideo.segmentIndex&&c.push(P.trickModeVideo.createSegmentIndex());return I(Ie,Promise.all(c),2)}if(i.segmentIndex instanceof ri)for(N=E(it(p)),G=N.next();!G.done;G=N.next())q=G.value,ae=q.wa,Te=q.item,Te.segmentIndex&&ae>=l&&i.segmentIndex.j.push(Te.segmentIndex);U(Ie)})}function rz(i,l,c,p,y){var A=c(i);return Qw(l,A),A.createSegmentIndex&&(A.createSegmentIndex=function(){return Z(function(P){return A.segmentIndex?P.D(0):(A.segmentIndex=new ri,I(P,Xw(A,0),0))})}),A.matchedStreams?(qw(A,0,p,y),A):null}function qw(i,l,c,p){for(var y=E(it(i.matchedStreams)),A=y.next();!A.done;A=y.next()){var P=A.value;if(A=P.wa,P=P.item,A>=l){c(i,P);var N=!0;i.type=="audio"&&Be(i.language,P.language)==0&&(N=!1),N&&p[A].delete(P)}}}function tg(i){var l=Object.assign({},i);return l.originalId=null,l.createSegmentIndex=function(){return Promise.resolve()},l.closeSegmentIndex=function(){if(l.segmentIndex&&(l.segmentIndex.release(),l.segmentIndex=null),l.matchedStreams)for(var c=E(l.matchedStreams),p=c.next();!p.done;p=c.next())p=p.value,p.segmentIndex&&(p.segmentIndex.release(),p.segmentIndex=null)},l.segmentIndex=null,l.emsgSchemeIdUris=[],l.keyIds=new Set,l.closedCaptions=null,l.trickModeVideo=null,l}function kv(i){return i=Object.assign({},i),i.keyIds=new Set,i.segments=[],i.variantIds=[],i.closedCaptions=null,i}function Ud(i,l){i.roles=Array.from(new Set(i.roles.concat(l.roles))),l.emsgSchemeIdUris&&(i.emsgSchemeIdUris=Array.from(new Set(i.emsgSchemeIdUris.concat(l.emsgSchemeIdUris)))),i.keyIds=function(A,P){return new Set([].concat(T(A),T(P)))}(i.keyIds,l.keyIds),i.originalId==null?i.originalId=l.originalId:i.originalId+=","+(l.originalId||"");var c=Q0(i.drmInfos,l.drmInfos);if(l.drmInfos.length&&i.drmInfos.length&&!c.length)throw new We(2,4,4038);if(i.drmInfos=c,i.encrypted=i.encrypted||l.encrypted,l.closedCaptions){i.closedCaptions||(i.closedCaptions=new Map),c=E(l.closedCaptions);for(var p=c.next();!p.done;p=c.next()){var y=E(p.value);p=y.next().value,y=y.next().value,i.closedCaptions.set(p,y)}}l.trickModeVideo?(i.trickModeVideo||(i.trickModeVideo=tg(l.trickModeVideo),i.trickModeVideo.createSegmentIndex=function(){return i.trickModeVideo.segmentIndex=i.segmentIndex.clone(),Promise.resolve()}),Ud(i.trickModeVideo,l.trickModeVideo)):i.trickModeVideo&&Ud(i.trickModeVideo,l)}function Uv(i,l){i.roles=Array.from(new Set(i.roles.concat(l.roles)));var c=l.keyIds;if(c=new Set([].concat(T(i.keyIds),T(c))),i.keyIds=c,i.encrypted=i.encrypted&&l.encrypted,i.segments.push.apply(i.segments,T(l.segments)),l.closedCaptions){i.closedCaptions||(i.closedCaptions=new Map),c=E(l.closedCaptions);for(var p=c.next();!p.done;p=c.next()){var y=E(p.value);p=y.next().value,y=y.next().value,i.closedCaptions.set(p,y)}}}function Qw(i,l){for(var c=[],p=E(i),y=p.next();!y.done;y=p.next()){var A=l,P={audio:Jw,video:Jw,text:iz,image:sz}[A.type],N={audio:az,video:oz,text:lz,image:uz}[A.type],G=null;y=E(y.value);for(var q=y.next();!q.done;q=y.next())q=q.value,!P(A,q)||G&&!N(A,G,q)||(G=q);if(A=G,!A)return;c.push(A)}l.matchedStreams=c}function Jw(i,l){var c;if(!(c=l.mimeType!=i.mimeType||Vi(l.codecs)!=Vi(i.codecs))&&(c=i.drmInfos)){c=i.drmInfos;var p=l.drmInfos;c=!(!(c.length&&p.length)||0<Q0(c,p).length)}return!c}function iz(i,l){return i.language?l.language?!(Be(i.language,l.language)==0||l.kind!=i.kind):!0:!1}function sz(i){return!!i.tilesLayout}function az(i,l,c){if(i.id==c.id)return!0;var p=Be(i.language,l.language),y=Be(i.language,c.language);return y>p?!0:y<p?!1:!l.primary&&c.primary?!0:l.primary&&!c.primary?!1:i.roles.length?(p=l.roles.filter(function(A){return i.roles.includes(A)}),y=c.roles.filter(function(A){return i.roles.includes(A)}),y.length>p.length?!0:y.length<p.length?!1:c.roles.length<l.roles.length):!c.roles.length&&l.roles.length?!0:c.roles.length&&!l.roles.length?!1:(p=ng(i.channelsCount,l.channelsCount,c.channelsCount),p==Po?!0:p==lu?!1:(p=ng(i.audioSamplingRate,l.audioSamplingRate,c.audioSamplingRate),p==Po?!0:p==lu?!1:!!(i.bandwidth&&tO(i.bandwidth,l.bandwidth,c.bandwidth)==Po)))}function oz(i,l,c){if(i.id==c.id)return!0;var p=ng(i.width*i.height,l.width*l.height,c.width*c.height);if(p==Po)return!0;if(p==lu)return!1;if(i.frameRate){if(p=ng(i.frameRate,l.frameRate,c.frameRate),p==Po)return!0;if(p==lu)return!1}return!!(i.bandwidth&&tO(i.bandwidth,l.bandwidth,c.bandwidth)==Po)}function lz(i,l,c){if(i.id==c.id)return!0;var p=Be(i.language,l.language),y=Be(i.language,c.language);if(y>p)return!0;if(y<p)return!1;if(!l.primary&&c.primary)return!0;if(l.primary&&!c.primary)return!1;if(i.roles.length){if(p=l.roles.filter(function(A){return i.roles.includes(A)}),y=c.roles.filter(function(A){return i.roles.includes(A)}),y.length>p.length)return!0;if(y.length<p.length)return!1}else{if(!c.roles.length&&l.roles.length)return!0;if(c.roles.length&&!l.roles.length)return!1}return!(c.mimeType!=i.mimeType||c.codecs!=i.codecs||l.mimeType==i.mimeType&&l.codecs==i.codecs)}function uz(i,l,c){return i.id==c.id?!0:ng(i.width*i.height,l.width*l.height,c.width*c.height)==Po}function Zw(i){return{id:0,originalId:"",primary:!1,type:i,mimeType:"",codecs:"",language:"",label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null}}function eO(i){return{id:0,originalId:"",createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new fr([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",label:null,type:i,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null}}function ng(i,l,c){if(l==i&&i!=c)return lu;if(c==i&&i!=l)return Po;if(l>i){if(c<=i||c-i<l-i)return Po;if(c-i>l-i)return lu}else{if(c>i)return lu;if(i-c<i-l)return Po;if(i-c>i-l)return lu}return nO}function tO(i,l,c){return l=Math.abs(i-l),i=Math.abs(i-c),i<l?Po:l<i?lu:nO}var Po=1,nO=0,lu=-1;function rg(){var i=this;this.F=this.m=null,this.h=[],this.H=null,this.G=1,this.yb={},this.L={},this.g=new zw,this.C=0,this.I=new mr(5),this.B=new kn(function(){i.Tc()}),this.i=new _d,this.j=null,this.J=[],this.l=1/0,this.s=!1}f=rg.prototype,f.configure=function(i){this.m=i},f.start=function(i,l){var c=this,p;return Z(function(y){if(y.g==1)return c.s=l.isLowLatencyMode(),c.h=[i],c.F=l,I(y,LA(c),2);if(p=y.h,c.F&&iO(c,p),!c.F)throw new We(2,7,7001);return y.return(c.H)})},f.stop=function(){for(var i=E(Object.values(this.yb)),l=i.next();!l.done;l=i.next())l=l.value,l.segmentIndex&&l.segmentIndex.release();return this.g&&this.g.release(),this.m=this.F=null,this.h=[],this.H=null,this.yb={},this.g=null,this.B!=null&&(this.B.stop(),this.B=null),this.i.destroy()},f.update=function(){var i=this,l;return Z(function(c){if(c.g==1)return w(c,2),I(c,LA(i),4);if(c.g!=2)return K(c,0);if(l=W(c),!i.F||!l)return c.return();i.F.onError(l),U(c)})},f.onExpirationUpdated=function(){};function LA(i){var l,c,p,y,A,P,N;return Z(function(G){return G.g==1?(l=Qs(i.h,i.m.retryParameters),c=i.F.networkingEngine,i.F.modifyManifestRequest(l,{format:"d"}),p=Date.now(),y=c.request(0,l),ol(i.i,y),I(G,y.promise,2)):G.g!=3?(A=G.h,i.F?(A.uri&&!i.h.includes(A.uri)&&i.h.unshift(A.uri),I(G,cz(i,A.data,A.uri),3)):G.return(0)):(P=Date.now(),N=(P-p)/1e3,jn(i.I,1,N),G.return(N))})}function cz(i,l,c){var p,y,A,P;return Z(function(N){if(N.g==1){if(p=kw(l,"MPD"),!p)throw new We(2,4,4001,c);return i.m.dash.disableXlinkProcessing?N.return(rO(i,p,c)):(y=i.m.dash.xlinkFailGracefully,A=Nv(p,i.m.retryParameters,y,c,i.F.networkingEngine),ol(i.i,A),I(N,A.promise,2))}return P=N.h,N.return(rO(i,P,c))})}function rO(i,l,c){var p,y,A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe,Ze,Qe,Lt,It,yt,Jt,un,dn,xn,hn,Mn,Qn,Jn,ur,rr,Rr,ii;return Z(function(Sr){switch(Sr.g){case 1:if((p=i.m.dash.manifestPreprocessor)&&p(l),y=[c],A=Yr(l,"Location").map(Dv).filter(bt),0<A.length&&(P=Dt(y,A),y=i.h=P),N=Yr(l,"BaseURL"),G=N.map(Dv),q=Dt(y,G),ae=0,N&&N.length&&(ae=Or(N[0],"availabilityTimeOffset",eg)||0),Te=i.m.dash.ignoreMinBufferTime,Ie=0,Te||(Ie=Or(l,"minBufferTime",au)||0),i.C=Or(l,"minimumUpdatePeriod",au,-1),Ne=Or(l,"availabilityStartTime",T$),Ve=Or(l,"timeShiftBufferDepth",au),qe=i.m.dash.ignoreSuggestedPresentationDelay,Ze=null,qe||(Ze=Or(l,"suggestedPresentationDelay",au)),Qe=i.m.dash.ignoreMaxSegmentDuration,Lt=null,Qe||(Lt=Or(l,"maxSegmentDuration",au)),It=l.getAttribute("type")||"static",i.H)for(yt=i.H.presentationTimeline,Jt=E(Object.values(i.yb)),un=Jt.next();!un.done;un=Jt.next())dn=un.value,dn.segmentIndex&&dn.segmentIndex.Ob(yt.ub());else xn=i.m.defaultPresentationDelay||1.5*Ie,hn=Ze??xn,yt=new Wn(Ne,hn,i.m.dash.autoCorrectDrift);return yt.Zc(It=="static"),yt.W()&&!isNaN(i.m.availabilityWindowOverride)&&(Ve=i.m.availabilityWindowOverride),Ve==null&&(Ve=1/0),yt.Ie(Ve),Mn=l.getAttribute("profiles")||"",Qn={Fb:It!="static",presentationTimeline:yt,ya:null,ba:null,Ha:null,O:null,bandwidth:0,nf:!1,hc:ae,profiles:Mn.split(",")},Jn=fz(i,Qn,q,l),ur=Jn.duration,rr=Jn.periods,It!="static"&&Jn.df||yt.ib(ur||1/0),i.l&&!i.s&&i.F.isAutoLowLatencyMode()&&(i.F.enableLowLatencyMode(),i.s=i.F.isLowLatencyMode()),i.s?yt.Bf(i.l):i.l&&Re("Low-latency DASH live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details."),yt.le(Lt||1),I(Sr,Q$(i.g,rr,Qn.Fb),2);case 2:if(i.H){i.H.variants=i.g.l,i.H.textStreams=i.g.j.slice(),i.H.imageStreams=i.g.i,i.F.filter(i.H),Sr.D(3);break}if(i.H={presentationTimeline:yt,variants:i.g.l,textStreams:i.g.j.slice(),imageStreams:i.g.i,offlineSessionIds:[],minBufferTime:Ie||0},!yt.Kf()){Sr.D(3);break}return Rr=Yr(l,"UTCTiming"),I(Sr,vz(i,q,Rr),5);case 5:if(ii=Sr.h,!i.F)return Sr.return();yt.Cf(ii);case 3:i.F.makeTextStreamsForClosedCaptions(i.H),U(Sr)}})}function fz(i,l,c,p){var y=Or(p,"mediaPresentationDuration",au),A=[],P=0;p=Yr(p,"Period");for(var N=E(it(p)),G=N.next();!G.done;G=N.next()){var q=G.value;G=q.wa;var ae=q.item,Te=q.next;q=Or(ae,"start",au,P);var Ie=ae.id,Ne=Or(ae,"duration",au),Ve=null;if(Te){var qe=Or(Te,"start",au);qe!=null&&(Ve=qe-q)}else y!=null&&(Ve=y-q);if(Ve==null&&(Ve=Ne),!(i.j!==null&&Ie!==null&&q!==null&&q<i.j)||i.J.includes(Ie)||G+1==p.length){if(q!==null&&(i.j===null||q>i.j)&&(i.j=q),P=dz(i,l,c,{start:q,duration:Ve,node:ae,rf:Ve==null||!Te}),A.push(P),l.ya.id&&Ve&&(i.L[l.ya.id]=Ve),Ve==null){P=null;break}P=q+Ve}}return i.J=A.map(function(Ze){return Ze.id}),y!=null?{periods:A,duration:y,df:!1}:{periods:A,duration:P,df:!0}}function dz(i,l,c,p){l.ya=MA(p.node,null,c),l.ba=p,l.ya.hc=l.hc,l.ya.id||(l.ya.id="__shaka_period_"+p.start);var y=Yr(p.node,"EventStream");c=l.presentationTimeline.ub(),y=E(y);for(var A=y.next();!A.done;A=y.next())yz(i,p.start,p.duration,A.value,c);if(c=Yr(p.node,"AdaptationSet").map(function(ae){return hz(i,l,ae)}).filter(bt),l.Fb){for(p=[],y=E(c),A=y.next();!A.done;A=y.next()){A=E(A.value.fh);for(var P=A.next();!P.done;P=A.next())p.push(P.value)}if(p.length!=new Set(p).size)throw new We(2,4,4018)}for(p=c.filter(function(ae){return!ae.Oe}),c=c.filter(function(ae){return ae.Oe}),c=E(c),y=c.next();!y.done;y=c.next()){y=y.value,A=y.Oe.split(" "),P=E(p);for(var N=P.next();!N.done;N=P.next()){var G=N.value;if(A.includes(G.id)){N={},G=E(G.streams);for(var q=G.next();!q.done;N={gd:N.gd},q=G.next())N.gd=q.value,N.gd.trickModeVideo=y.streams.find(function(ae){return function(Te){return Vi(ae.gd.codecs)==Vi(Te.codecs)}}(N))}}}if(y=i.m.disableAudio?[]:Bv(p,"audio"),P=i.m.disableVideo?[]:Bv(p,"video"),A=i.m.disableText?[]:Bv(p,Ke),c=i.m.disableThumbnails?[]:Bv(p,"image"),!P.length&&!y.length)throw new We(2,4,4004);for(p=[],y=E(y),N=y.next();!N.done;N=y.next())p.push.apply(p,T(N.value.streams));for(y=[],P=E(P),N=P.next();!N.done;N=P.next())y.push.apply(y,T(N.value.streams));for(P=[],A=E(A),N=A.next();!N.done;N=A.next())P.push.apply(P,T(N.value.streams));for(A=[],c=E(c),N=c.next();!N.done;N=c.next())A.push.apply(A,T(N.value.streams));return{id:l.ya.id,kd:p,Gd:y,textStreams:P,imageStreams:A}}function Bv(i,l){return i.filter(function(c){return c.contentType==l})}function hz(i,l,c){function p(un){switch(un){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}}l.Ha=MA(c,l.ya,null);var y=!1,A=Yr(c,"Role"),P=A.map(function(un){return un.getAttribute("value")}).filter(bt),N=void 0,G=l.Ha.contentType==Ke;G&&(N="subtitle"),A=E(A);for(var q=A.next();!q.done;q=A.next()){q=q.value;var ae=q.getAttribute("schemeIdUri");if(ae==null||ae=="urn:mpeg:dash:role:2011")switch(q=q.getAttribute("value"),q){case"main":y=!0;break;case"caption":case"subtitle":N=q}}var Te;ae=Yr(c,"EssentialProperty"),A=null,q=!1,ae=E(ae);for(var Ie=ae.next();!Ie.done;Ie=ae.next()){Ie=Ie.value;var Ne=Ie.getAttribute("schemeIdUri");Ne=="http://dashif.org/guidelines/trickmode"?A=Ie.getAttribute("value"):Ne=="urn:mpeg:mpegB:cicp:TransferCharacteristics"?Te=p(parseInt(Ie.getAttribute("value"),10)):q=!0}for(ae=Yr(c,"SupplementalProperty"),ae=E(ae),Ie=ae.next();!Ie.done;Ie=ae.next())Ie=Ie.value,Ie.getAttribute("schemeIdUri")=="urn:mpeg:mpegB:cicp:TransferCharacteristics"&&(Te=p(parseInt(Ie.getAttribute("value"),10)));ae=Yr(c,"Accessibility");var Ve=new Map;for(ae=E(ae),Ie=ae.next();!Ie.done;Ie=ae.next())if(Ne=Ie.value,Ie=Ne.getAttribute("schemeIdUri"),Ne=Ne.getAttribute("value"),Ie=="urn:scte:dash:cc:cea-608:2015")if(Ie=1,Ne!=null){Ne=Ne.split(";");for(var qe=E(Ne),Ze=qe.next();!Ze.done;Ze=qe.next()){var Qe=Ze.value,Lt=Ze=void 0;Qe.includes("=")?(Qe=Qe.split("="),Ze=Qe[0].startsWith("CC")?Qe[0]:"CC"+Qe[0],Lt=Qe[1]||"und"):(Ze="CC"+Ie,Ne.length==2?Ie+=2:Ie++,Lt=Qe),Ve.set(Ze,pn(Lt))}}else Ve.set("CC1","und");else if(Ie=="urn:scte:dash:cc:cea-708:2015")if(Ie=1,Ne!=null)for(Ne=E(Ne.split(";")),Ze=Ne.next();!Ze.done;Ze=Ne.next())Ze=Ze.value,Qe=qe=void 0,Ze.includes("=")?(Ze=Ze.split("="),qe="svc"+Ze[0],Qe=Ze[1].split(",")[0].split(":").pop()):(qe="svc"+Ie,Ie++,Qe=Ze),Ve.set(qe,pn(Qe));else Ve.set("svc1","und");else Ie=="urn:mpeg:dash:role:2011"&&Ne!=null&&(P.push(Ne),Ne=="captions"&&(N="caption"));if(q)return null;q=Yr(c,"ContentProtection");var It=Uw(q,i.m.dash.ignoreDrmInfo,i.m.dash.keySystemsByURI),yt=pn(c.getAttribute("lang")||"und"),Jt=c.getAttribute("label");if((q=Yr(c,"Label"))&&q.length&&(q=q[0],q.textContent&&(Jt=q.textContent)),q=Yr(c,"Representation"),c=q.map(function(un){return(un=pz(i,l,It,N,yt,Jt,y,P,Ve,un))&&(un.hdr=un.hdr||Te),un}).filter(function(un){return!!un}),c.length==0){if(A=l.Ha.contentType=="image",i.m.dash.ignoreEmptyAdaptationSet||G||A)return null;throw new We(2,4,4003)}if(!l.Ha.contentType||l.Ha.contentType=="application")for(l.Ha.contentType=aO(c[0].mimeType,c[0].codecs),G=E(c),ae=G.next();!ae.done;ae=G.next())ae.value.type=l.Ha.contentType;for(G=E(c),ae=G.next();!ae.done;ae=G.next())for(ae=ae.value,Ie=E(It.drmInfos),Ne=Ie.next();!Ne.done;Ne=Ie.next())Ne=Ne.value,Ne.keyIds=Ne.keyIds&&ae.keyIds?new Set([].concat(T(Ne.keyIds),T(ae.keyIds))):Ne.keyIds||ae.keyIds;return G=q.map(function(un){return un.getAttribute("id")}).filter(bt),{id:l.Ha.id||"__fake__"+i.G++,contentType:l.Ha.contentType,language:yt,Ti:y,streams:c,drmInfos:It.drmInfos,Oe:A,fh:G}}function pz(i,l,c,p,y,A,P,N,G,q){if(l.O=MA(q,l.Ha,null),i.l=Math.min(i.l,l.O.hc),!mz(l.O))return null;var ae=l.ba.start;l.bandwidth=Or(q,"bandwidth",Lv)||0;var Te=l.O.contentType,Ie=Te==Ke||Te=="application";Te=Te=="image";try{var Ne=function(dn,xn,hn){return Ez(i,dn,xn,hn)};if(l.O.Xc)var Ve=B$(l,Ne);else if(l.O.Mb)Ve=K$(l,i.yb);else if(l.O.Yc)Ve=V$(l,Ne,i.yb,!!i.H,i.m.dash.initialSegmentLimit,i.L);else{var qe=l.O.Va,Ze=l.ba.duration||0;Ve={jc:function(){return Promise.resolve(av(ae,Ze,qe))}}}}catch(dn){if((Ie||Te)&&dn.code==4002)return null;throw dn}Ne=Yr(q,"ContentProtection"),Ne=x$(Ne,c,i.m.dash.ignoreDrmInfo,i.m.dash.keySystemsByURI),Ne=new Set(Ne?[Ne]:[]);var Qe=!1;Yr(q,"SupplementalProperty").some(function(dn){return dn.getAttribute("schemeIdUri")=="tag:dolby.com,2018:dash:EC3_ExtensionType:2018"&&dn.getAttribute("value")=="JOC"})&&(l.O.mimeType="audio/eac3-joc",Qe=!0);var Lt=!1;Ie&&(Lt=N.includes("forced_subtitle")||N.includes("forced-subtitle"));var It;if(Te&&((q=Yr(q,"EssentialProperty").find(function(dn){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(dn.getAttribute("schemeIdUri"))}))&&(It=q.getAttribute("value")),!It))return null;var yt;q=l.O.codecs,l.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(q.includes("hvc1.2.4.L153.B0")||q.includes("hev1.2.4.L153.B0"))&&(yt="PQ");var Jt=l.O.id?l.ya.id+","+l.O.id:"",un={id:i.G++,originalId:l.O.id,createSegmentIndex:function(){var dn,xn;return Z(function(hn){if(hn.g==1)return dn=Jt&&l.Fb&&i.yb[Jt]?i.yb[Jt]:un,dn.segmentIndex?hn.D(0):(xn=dn,I(hn,Ve.jc(),3));xn.segmentIndex=hn.h,U(hn)})},closeSegmentIndex:function(){un.segmentIndex&&(un.segmentIndex.release(),un.segmentIndex=null)},segmentIndex:null,mimeType:l.O.mimeType,codecs:l.O.codecs,frameRate:l.O.frameRate,pixelAspectRatio:l.O.pixelAspectRatio,bandwidth:l.bandwidth,width:l.O.width,height:l.O.height,kind:p,encrypted:0<c.drmInfos.length,drmInfos:c.drmInfos,keyIds:Ne,language:y,label:A,type:l.Ha.contentType,primary:P,trickModeVideo:null,emsgSchemeIdUris:l.O.emsgSchemeIdUris,roles:N,forced:Lt,channelsCount:l.O.ud,audioSamplingRate:l.O.audioSamplingRate,spatialAudio:Qe,closedCaptions:G,hdr:yt,tilesLayout:It,matchedStreams:[]};return Jt&&l.Fb&&!i.yb[Jt]&&(i.yb[Jt]=un),un}f.Tc=function(){var i=this,l,c;return Z(function(p){switch(p.g){case 1:return l=0,w(p,2),I(p,LA(i),4);case 4:l=p.h,K(p,3);break;case 2:c=W(p),i.F&&(c.severity=1,i.F.onError(c));case 3:if(!i.F)return p.return();iO(i,l),U(p)}})};function iO(i,l){0>i.C||i.B.U(Math.max(3,i.C-l,Mt(i.I)))}function MA(i,l,c){l=l||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,ud:null,audioSamplingRate:null,hc:0},c=c||l.Va;var p=Yr(i,"BaseURL"),y=p.map(Dv),A=i.getAttribute("contentType")||l.contentType,P=i.getAttribute("mimeType")||l.mimeType,N=i.getAttribute("codecs")||l.codecs,G=Or(i,"frameRate",A$)||l.frameRate,q=i.getAttribute("sar")||l.pixelAspectRatio,ae=Yr(i,"InbandEventStream"),Te=l.emsgSchemeIdUris.slice();ae=E(ae);for(var Ie=ae.next();!Ie.done;Ie=ae.next())Ie=Ie.value.getAttribute("schemeIdUri"),Te.includes(Ie)||Te.push(Ie);ae=Yr(i,"AudioChannelConfiguration"),ae=gz(ae)||l.ud,Ie=Or(i,"audioSamplingRate",ul)||l.audioSamplingRate,A||(A=aO(P,N));var Ne=bv(i,"SegmentBase"),Ve=bv(i,"SegmentTemplate"),qe=Ne&&Or(Ne,"availabilityTimeOffset",eg)||0,Ze=Ve&&Or(Ve,"availabilityTimeOffset",eg)||0;return p=p&&p.length&&Or(p[0],"availabilityTimeOffset",eg)||0,p=l.hc+p+qe+Ze,{Va:Dt(c,y),Xc:Ne||l.Xc,Mb:bv(i,"SegmentList")||l.Mb,Yc:Ve||l.Yc,width:Or(i,"width",ul)||l.width,height:Or(i,"height",ul)||l.height,contentType:A,mimeType:P,codecs:N,frameRate:G,pixelAspectRatio:q,emsgSchemeIdUris:Te,id:i.getAttribute("id"),ud:ae,audioSamplingRate:Ie,hc:p}}function gz(i){i=E(i);for(var l=i.next();!l.done;l=i.next()){var c=l.value;if((l=c.getAttribute("schemeIdUri"))&&(c=c.getAttribute("value")))switch(l){case"urn:mpeg:dash:outputChannelPositionList:2012":return c.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(l=parseInt(c,10),!l)continue;return l;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(l=parseInt(c,16),!l)continue;for(i=0;l;)l&1&&++i,l>>=1;return i;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(l=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],(c=parseInt(c,10))&&0<c&&c<l.length)return l[c]}}return null}function mz(i){var l=i.Xc?1:0;return l+=i.Mb?1:0,l+=i.Yc?1:0,l==0?i.contentType==Ke||i.contentType=="application":(l!=1&&(i.Xc&&(i.Mb=null),i.Yc=null),!0)}function sO(i,l,c,p){var y,A,P,N,G,q;return Z(function(ae){if(ae.g==1)return y=Dt(l,[c]),A=Qs(y,i.m.retryParameters),A.method=p,P=i.F.networkingEngine.request(4,A),ol(i.i,P),I(ae,P.promise,2);if(N=ae.h,p=="HEAD"){if(!N.headers||!N.headers.date)return ae.return(0);G=N.headers.date}else G=Cn(N.data);return q=Date.parse(G),isNaN(q)?ae.return(0):ae.return(q-Date.now())})}function vz(i,l,c){var p,y,A,P,N,G,q,ae;return Z(function(Te){switch(Te.g){case 1:p=c.map(function(Ie){return{scheme:Ie.getAttribute("schemeIdUri"),value:Ie.getAttribute("value")}}),y=i.m.dash.clockSyncUri,!p.length&&y&&p.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:y}),A=E(p),P=A.next();case 2:if(P.done){Te.D(4);break}switch(N=P.value,w(Te,5),G=N.scheme,q=N.value,G){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return Te.D(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return Te.D(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return ae=Date.parse(q),Te.return(isNaN(ae)?0:ae-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":Re("NTP UTCTiming scheme is not supported");break;default:Re("Unrecognized scheme in UTCTiming element",G)}Te.D(9);break;case 7:return I(Te,sO(i,l,q,"HEAD"),10);case 10:return Te.return(Te.h);case 8:return I(Te,sO(i,l,q,"GET"),11);case 11:return Te.return(Te.h);case 9:K(Te,3);break;case 5:W(Te);case 3:P=A.next(),Te.D(2);break;case 4:return Re("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),Te.return(0)}})}function yz(i,l,c,p,y){var A=p.getAttribute("schemeIdUri")||"",P=p.getAttribute("value")||"",N=Or(p,"timescale",ul)||1;p=E(Yr(p,"Event"));for(var G=p.next();!G.done;G=p.next()){G=G.value;var q=Or(G,"presentationTime",ul)||0,ae=Or(G,"duration",ul)||0;q=q/N+l,ae=q+ae/N,c!=null&&(q=Math.min(q,l+c),ae=Math.min(ae,l+c)),ae<y||(G={schemeIdUri:A,value:P,startTime:q,endTime:ae,id:G.getAttribute("id")||"",eventElement:G},i.F.onTimelineRegionAdded(G))}}function Ez(i,l,c,p){var y,A,P,N,G;return Z(function(q){return q.g==1?(y=Ro,A=Hp(l,c,p,i.m.retryParameters),P=i.F.networkingEngine,N=P.request(y,A),ol(i.i,N),I(q,N.promise,2)):(G=q.h,q.return(G.data))})}function aO(i,l){return $l(ui(i,l))?Ke:i.split("/")[0]}Le("shaka.dash.DashParser",rg),of.mpd=function(){return new rg},qa["application/dash+xml"]=function(){return new rg},qa["video/vnd.mpeg.dash.mpd"]=function(){return new rg};function oO(i,l,c,p){this.g=i,this.type=l,this.aa=c,this.segments=p||null}function wA(i,l,c,p){this.id=i,this.name=l,this.g=c,this.value=p===void 0?null:p}wA.prototype.toString=function(){function i(p){return p.name+"="+(isNaN(Number(p.value))?'"'+p.value+'"':p.value)}var l="#"+this.name,c=this.g?this.g.map(i):[];return this.value&&c.unshift(this.value),0<c.length&&(l+=":"+c.join(",")),l},wA.prototype.getAttribute=function(i){var l=this.g.filter(function(c){return c.name==i});return l.length?l[0]:null};function tr(i,l,c){return(i=i.getAttribute(l))?i.value:c||null}function Ni(i,l){var c=i.getAttribute(l);if(!c)throw new We(2,4,4023,l);return c.value}function lO(i,l,c){c=c===void 0?[]:c,this.aa=l,this.g=i,this.h=c}function uO(i,l){this.name=i,this.value=l}function uu(i,l){return i.filter(function(c){return c.name==l})}function cO(i,l){return i.filter(function(c){return Ni(c,"TYPE")==l})}function Os(i,l){var c=uu(i,l);return c.length?c[0]:null}function OA(i,l,c){return c=c===void 0?0:c,(i=Os(i,l))?Number(i.value):c}function Bd(i){this.h=i,this.g=0}function jd(i){nc(i,/[ \t]+/gm)}function nc(i,l){l.lastIndex=i.g;var c=l.exec(i.h);return c=c==null?null:{position:c.index,length:c[0].length,results:c},i.g==i.h.length||c==null||c.position!=i.g?null:(i.g+=c.length,c.results)}function mf(i){return i.g==i.h.length?null:(i=nc(i,/[^ \t\n]*/gm))?i[0]:null}function _z(){this.g=0}function NA(i,l,c){l=Cn(l),l=l.replace(/\r\n|\r(?=[^\n]|$)/gm,`
`).trim();var p=l.split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(p[0]))throw new We(2,4,4015);l=0;for(var y=!0,A=E(p),P=A.next();!P.done;P=A.next())if(P=P.value,/^#(?!EXT)/m.test(P)||y)y=!1;else if(P=FA(i.g++,P),--i.g,fO.includes(P.name)){l=1;break}else P.name=="EXT-X-STREAM-INF"&&(y=!0);A=[],y=!0,P=E(it(p));for(var N=P.next();!N.done;N=P.next()){var G=N.value;N=G.wa;var q=G.item;if(G=G.next,/^#(?!EXT)/m.test(q)||y)y=!1;else{if(q=FA(i.g++,q),Tz.includes(q.name)){if(l!=1)throw new We(2,4,4017);G=p.splice(N,p.length-N),p=c,y=[],P=[],N=[],q=null,G=E(G);for(var ae=G.next();!ae.done;ae=G.next())ae=ae.value,/^(#EXT)/.test(ae)?(ae=FA(i.g++,ae),fO.includes(ae.name)?A.push(ae):ae.name=="EXT-X-MAP"?q=ae:ae.name=="EXT-X-PART"?N.push(ae):ae.name=="EXT-X-PRELOAD-HINT"?tr(ae,"TYPE")=="PART"?N.push(ae):tr(ae,"TYPE")=="MAP"&&(ae.name="EXT-X-MAP",q=ae):P.push(ae)):/^#(?!EXT)/m.test(ae)||(ae=Dt([p],[ae.trim()])[0],q&&P.push(q),y.push(new lO(ae,P,N)),P=[],N=[]);return N.length&&(q&&P.push(q),y.push(new lO("",P,N))),new oO(c,l,A,y)}A.push(q),q.name=="EXT-X-STREAM-INF"&&(q.g.push(new uO("URI",G)),y=!0)}}return new oO(c,l,A)}function FA(i,l){var c=l.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!c)throw new We(2,4,4016,l);var p=c[1],y=c[2];c=[];var A;if(y){y=new Bd(y);var P;(P=nc(y,/^([^,=]+)(?:,|$)/g))&&(A=P[1]);for(var N=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;P=nc(y,N);)c.push(new uO(P[1],P[2]||P[3])),jd(y)}return new wA(i,p,c,A)}var fO="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP".split(" "),Tz="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP".split(" ");function dO(){}function hO(i){try{var l=kA(i);return Co({uri:i,vf:i,data:l.data,headers:{"content-type":l.contentType}})}catch(c){return xo(c)}}function kA(i){var l=i.split(":");if(2>l.length||l[0]!="data")throw new We(2,1,1004,i);if(l=l.slice(1).join(":").split(","),2>l.length)throw new We(2,1,1004,i);var c=l[0];i=o.decodeURIComponent(l.slice(1).join(",")),l=c.split(";"),c=l[0];var p=!1;1<l.length&&l[l.length-1]=="base64"&&(p=!0,l.pop());var y;return p?y=Xa(i):y=hi(i),{data:y,contentType:c}}Le("shaka.net.DataUriPlugin",dO),dO.parse=hO,Io("data",hO);function ig(){var i=this;this.m=this.F=null,this.Aa=1,this.l=new Map,this.B=new Map,this.sa=new Set,this.g=new Map,this.h=null,this.M="",this.$=new _z,this.ka=0,this.C=new kn(function(){i.Tc()}),this.j=cu,this.H=null,this.ia=0,this.I=1/0,this.ea=this.Ca=0,this.G=new _d,this.S=[],this.L=new Map,this.Ba=!1,this.s=new Map,this.P=null,this.ha=new Map,this.J=new Map,this.i=!1}f=ig.prototype,f.configure=function(i){this.m=i},f.start=function(i,l){var c=this,p,y;return Z(function(A){return A.g==1?(c.F=l,c.i=l.isLowLatencyMode(),I(A,GA(c,i),2)):A.g!=3?(p=A.h,c.M=p.uri,I(A,Sz(c,p.data),3)):(y=c.ka,0<y&&c.C.U(y),A.return(c.H))})},f.stop=function(){this.C&&(this.C.stop(),this.C=null);var i=[];return this.G&&(i.push(this.G.destroy()),this.G=null),this.m=this.F=null,this.sa.clear(),this.H=null,this.g.clear(),this.B.clear(),this.s.clear(),this.l.clear(),Promise.all(i)},f.update=function(){var i=this,l,c,p;return Z(function(y){if(y.g==1)return i.j==cu?y.return():(l=[],i.P=null,c=Array.from(i.g.values()),c.length?I(y,pO(i,c[0]),2):y.D(2));for(p=1;p<c.length;p++)l.push(pO(i,c[p]));return I(y,Promise.all(l),0)})};function pO(i,l){var c,p,y,A,P,N,G,q,ae,Te,Ie,Ne;return Z(function(Ve){if(Ve.g==1)return c=IO,p=l.Pf,y=new pt(p),i.i&&l.Uf&&Ye(y,new Vt("_HLS_skip=YES")),I(Ve,GA(i,y.toString()),2);if(Ve.g!=3){if(A=Ve.h,P=NA(i.$,A.data,A.uri),P.type!=1)throw new We(2,4,4017);return N=uu(P.aa,"EXT-X-DEFINE"),G=gO(i,N),q=l.stream,I(Ve,TO(i,l.Fd,P,q.type,q.mimeType,l.ie,G,l.Zf,q.codecs,q.bandwidth),3)}ae=Ve.h,q.segmentIndex.sc(ae,i.h.ub()),ae.length&&(Te=OA(P.aa,"EXT-X-MEDIA-SEQUENCE",0),Ie=l.ie.get(Te),q.segmentIndex.Ob(Ie)),Ne=ae[ae.length-1],Os(P.aa,"EXT-X-ENDLIST")&&(jv(i,c.Of),i.h.ib(Ne.endTime)),U(Ve)})}f.onExpirationUpdated=function(){};function Sz(i,l){var c,p,y,A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe,Ze,Qe,Lt,It,yt,Jt,un,dn,xn,hn,Mn,Qn,Jn,ur,rr,Rr,ii,Sr,cs,pu,ts,ea;return Z(function(ta){switch(ta.g){case 1:if(c=NA(i.$,l,i.M),c.type!=0)throw new We(2,4,4022);for(p=uu(c.aa,"EXT-X-DEFINE"),Az(i,p),y=uu(c.aa,"EXT-X-MEDIA"),A=uu(c.aa,"EXT-X-STREAM-INF"),P=uu(c.aa,"EXT-X-IMAGE-STREAM-INF"),xz(i,A),N=uu(c.aa,"EXT-X-SESSION-DATA"),G=E(N),q=G.next();!q.done;q=G.next())ae=q.value,Te=tr(ae,"DATA-ID"),Ie=tr(ae,"URI"),Ne=tr(ae,"LANGUAGE"),Ve=tr(ae,"VALUE"),qe=new Map().set("id",Te),Ie&&qe.set("uri",Dt([i.M],[Ie])[0]),Ne&&qe.set("language",Ne),Ve&&qe.set("value",Ve),Ze=new De("sessiondata",qe),i.F&&i.F.onEvent(Ze);return I(ta,Rz(i,y),2);case 2:return Lz(i,y),I(ta,bz(i,A),3);case 3:return Qe=ta.h,I(ta,Cz(i,y),4);case 4:return Lt=ta.h,I(ta,Iz(i,P),5);case 5:if(It=ta.h,!i.F)throw new We(2,7,7001);if(i.Ba&&Qe.length==0)throw new We(2,4,4034);for(Jt=yt=1/0,un=E(i.g.values()),dn=un.next();!dn.done;dn=un.next())xn=dn.value,yt=Math.min(yt,xn.tf),xn.stream.type!="text"&&(Jt=Math.min(Jt,xn.Rg-xn.tf));if(i.j!=cu?(i.h=new Wn(0,i.m.defaultPresentationDelay?i.m.defaultPresentationDelay:i.ea?i.ea:3*i.ia),i.h.Zc(!1)):(i.h=new Wn(null,0),i.h.Zc(!0)),_O(i),i.j!=cu)i.ka=i.I,hn=IO,i.j==hn.Se&&(Mn=i.h.zd,isNaN(i.m.availabilityWindowOverride)||(Mn=i.m.availabilityWindowOverride),i.h.Ie(Mn));else for(i.h.ib(Jt),i.h.offset(-yt),Qn=E(i.g.values()),dn=Qn.next();!dn.done;dn=Qn.next())Jn=dn.value,Jn.stream.segmentIndex.offset(-yt),Jn.stream.segmentIndex.Hb(0,Jt);for(i.S=[],ur=[],rr=E(Qe),Rr=rr.next();!Rr.done;Rr=rr.next())for(ii=Rr.value,Sr=E([ii.video,ii.audio]),cs=Sr.next();!cs.done;cs=Sr.next())(pu=cs.value)&&ur.push(pu);return I(ta,Promise.all(ur.map(function(Sf){return Z(function(Sg){return I(Sg,Sf.createSegmentIndex(),0)})})),6);case 6:for(ts=E(ur),cs=ts.next();!cs.done;cs=ts.next())ea=cs.value,i.S.push(ea.segmentIndex.R);_O(i),i.H={presentationTimeline:i.h,variants:Qe,textStreams:Lt,imageStreams:It,offlineSessionIds:[],minBufferTime:0},i.F.makeTextStreamsForClosedCaptions(i.H),U(ta)}})}function Az(i,l){for(var c=E(l),p=c.next();!p.done;p=c.next()){var y=p.value;p=tr(y,"NAME"),y=tr(y,"VALUE"),p&&y&&(i.l.has(p)||i.l.set(p,y))}}function gO(i,l){for(var c=new Map,p=E(l),y=p.next();!y.done;y=p.next()){var A=y.value;y=tr(A,"NAME");var P=tr(A,"VALUE");A=tr(A,"IMPORT"),y&&P&&c.set(y,P),A&&(y=i.l.get(A))&&c.set(A,y)}return c}function xz(i,l){for(var c=E(l),p=c.next();!p.done;p=c.next()){var y=p.value,A=tr(y,"AUDIO");p=tr(y,"VIDEO");var P=tr(y,"SUBTITLES");if(y=mO(i,y),P){var N=Tn(Ke,y);i.s.set(P,N),tt(y,N)}A&&(P=on("audio",y),i.s.set(A,P)),p&&(A=on("video",y),i.s.set(p,A))}}function Cz(i,l){var c,p,y,A,P,N,G,q,ae,Te,Ie,Ne;return Z(function(Ve){if(Ve.g==1)return c=cO(l,"SUBTITLES"),p=c.map(function(qe){var Ze,Qe;return Z(function(Lt){if(Lt.g==1)return i.m.disableText?Lt.return(null):(w(Lt,2),I(Lt,BA(i,qe),4));if(Lt.g!=2)return Ze=Lt.h,Lt.return(Ze.stream);if(Qe=W(Lt),i.m.hls.ignoreTextStreamFailures)return Lt.return(null);throw Qe})}),I(Ve,Promise.all(p),2);for(y=Ve.h,A=E(c),P=A.next();!P.done;P=A.next())if(N=P.value,G=Ni(N,"GROUP-ID"),(q=i.s.get(G))&&(ae=i.B.get(G)))for(Te=E(ae),Ie=Te.next();!Ie.done;Ie=Te.next())Ne=Ie.value,Ne.stream.codecs=q;return Ve.return(y.filter(function(qe){return qe}))})}function Iz(i,l){var c,p;return Z(function(y){return y.g==1?(c=l.map(function(A){var P,N;return Z(function(G){if(G.g==1)return i.m.disableThumbnails?G.return(null):(w(G,2),I(G,Mz(i,A),4));if(G.g!=2)return P=G.h,G.return(P.stream);if(N=W(G),i.m.hls.ignoreImageStreamFailures)return G.return(null);throw N})}),I(y,Promise.all(c),2)):(p=y.h,y.return(p.filter(function(A){return A})))})}function Rz(i,l){var c;return Z(function(p){return p.g==1?(l=l.filter(function(y){var A=tr(y,"URI")||"";return tr(y,"TYPE")!="SUBTITLES"&&A!=""}),l.length?I(p,BA(i,l[0]),2):p.D(2)):(c=l.slice(1).map(function(y){return BA(i,y)}),I(p,Promise.all(c),0))})}function bz(i,l){var c,p,y;return Z(function(A){return A.g==1?(c=l.map(function(P){var N,G,q,ae,Te,Ie,Ne,Ve;return Z(function(qe){if(qe.g==1)return N=tr(P,"FRAME-RATE"),G=Number(tr(P,"AVERAGE-BANDWIDTH"))||Number(Ni(P,"BANDWIDTH")),q=tr(P,"RESOLUTION"),ae=E(q?q.split("x"):[null,null]),Te=ae.next().value,Ie=ae.next().value,Ne=tr(P,"VIDEO-RANGE"),I(qe,Dz(i,P,G),2);if(Ve=qe.h){for(var Ze=qe.return,Qe=Ve.audio,Lt=Ve.video,It=E(Lt),yt=It.next();!yt.done;yt=It.next())(yt=yt.value.stream)&&(yt.width=Number(Te)||void 0,yt.height=Number(Ie)||void 0,yt.frameRate=Number(N)||void 0,yt.hdr=Ne||void 0);for(It=i.m.disableAudio,(!Qe.length||It)&&(Qe=[null]),It=i.m.disableVideo,(!Lt.length||It)&&(Lt=[null]),It=[],Qe=E(Qe),yt=Qe.next();!yt.done;yt=Qe.next()){yt=yt.value;for(var Jt=E(Lt),un=Jt.next();!un.done;un=Jt.next()){var dn=un.value;un=yt?yt.stream:null;var xn=dn?dn.stream:null,hn=yt?yt.stream.drmInfos:null,Mn=dn?dn.stream.drmInfos:null;dn=(dn?dn.Fd:"")+" - "+(yt?yt.Fd:""),un&&xn&&hn.length&&Mn.length&&!(0<Q0(hn,Mn).length)||i.sa.has(dn)||(un={id:i.Aa++,language:un?un.language:"und",primary:!!un&&un.primary||!!xn&&xn.primary,audio:un,video:xn,bandwidth:G,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},It.push(un),i.sa.add(dn))}}qe=Ze.call(qe,It)}else qe=qe.return([]);return qe})}),I(A,Promise.all(c),2)):(p=A.h,y=p.reduce(ct,[]),y=y.filter(function(P){return P!=null}),A.return(y))})}function Dz(i,l,c){var p,y,A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe,Ze;return Z(function(Qe){if(Qe.g==1)return p=ut,y=mO(i,l),A=tr(l,"AUDIO"),P=tr(l,"VIDEO"),G=(N=A||P)&&i.B.has(N)?i.B.get(N):[],q={audio:A?G:[],video:P?G:[]},Te=!1,Ie=Ni(l,"URI"),Ne=q.audio.find(function(Lt){return Lt&&Lt.Fd==Ie}),Ve=Tn(p.mb,y),(qe=Tn(p.Nb,y))&&!Ve?ae=p.Nb:!G.length&&qe&&Ve?(ae=p.mb,y=[[Ve,qe].join()]):q.audio.length&&Ne?(ae=p.Nb,Te=!0):ae=q.video.length?p.Nb:p.mb,Te?Qe.D(2):I(Qe,wz(i,l,y,ae,c),3);if(Qe.g!=2&&(Ze=Qe.h),Ze)q[Ze.stream.type]=[Ze];else if(Ze===null)return Qe.return(null);return Pz(q),Qe.return(q)})}function mO(i,l){var c=[];i.m.disableVideo||c.push(i.m.hls.defaultVideoCodec),i.m.disableAudio||c.push(i.m.hls.defaultAudioCodec);var p=tr(l,"CODECS",c.join(",")).split(/\s*,\s*/);c=new Set;var y=[];p=E(p);for(var A=p.next();!A.done;A=p.next()){A=A.value;var P=Vi(A);c.has(P)||(y.push(A),c.add(P))}return y}function UA(i){return i=tr(i,"LANGUAGE")||"und",pn(i)}function Pz(i){i=E(i.audio.concat(i.video));for(var l=i.next();!l.done;l=i.next())if(l=l.value){var c=l.stream.codecs.split(",");c=c.filter(function(p){return p!="mp4a.40.34"}),l.stream.codecs=c.join(",")}}function Lz(i,l){var c=cO(l,"CLOSED-CAPTIONS");c=E(c);for(var p=c.next();!p.done;p=c.next()){var y=p.value;p=UA(y);var A=Ni(y,"GROUP-ID");y=Ni(y,"INSTREAM-ID"),i.L.get(A)||i.L.set(A,new Map),i.L.get(A).set(y,p)}}function BA(i,l){var c,p,y,A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe;return Z(function(Ze){if(Ze.g==1){c=Ni(l,"GROUP-ID"),p="";var Qe=Ni(l,"TYPE").toLowerCase();return Qe=="subtitles"&&(Qe=Ke),y=Qe,y!=Ke&&c&&i.s.has(c)&&(p=i.s.get(c)),A=Kd(Ni(l,"URI"),i.l),i.g.has(A)?Ze.return(i.g.get(A)):(P=UA(l),N=tr(l,"NAME"),G=tr(l,"DEFAULT"),q=G=="YES",y=="audio"?Qe=(Qe=tr(l,"CHANNELS"))?parseInt(Qe.split("/")[0],10):null:Qe=null,ae=Qe,y=="audio"?Qe=(Qe=tr(l,"CHANNELS"))?Qe.includes("/JOC"):!1:Qe=!1,Te=Qe,Ie=tr(l,"CHARACTERISTICS"),Ne=tr(l,"FORCED"),Ve=Ne=="YES",I(Ze,jA(i,A,p,y,P,q,N,ae,null,Ie,Ve,Te),2))}return qe=Ze.h,i.B.has(c)?i.B.get(c).push(qe):i.B.set(c,[qe]),qe==null?Ze.return(null):i.g.has(A)?Ze.return(i.g.get(A)):(i.g.set(A,qe),Ze.return(qe))})}function Mz(i,l){var c,p,y,A,P,N,G,q,ae,Te;return Z(function(Ie){return Ie.g==1?(c=Kd(Ni(l,"URI"),i.l),p=tr(l,"CODECS","jpeg")||"",i.g.has(c)?Ie.return(i.g.get(c)):(y=UA(l),A=tr(l,"NAME"),P=tr(l,"CHARACTERISTICS"),I(Ie,jA(i,c,p,"image",y,!1,A,null,null,P,!1,!1),2))):(N=Ie.h,N==null?Ie.return(null):i.g.has(c)?Ie.return(i.g.get(c)):((G=tr(l,"RESOLUTION"))&&(q=N.stream.segmentIndex.get(0),(ae=q.tilesLayout)&&(N.stream.width=Number(G.split("x")[0])*Number(ae.split("x")[0]),N.stream.height=Number(G.split("x")[1])*Number(ae.split("x")[1]))),(Te=tr(l,"BANDWIDTH"))&&(N.stream.bandwidth=Number(Te)),i.g.set(c,N),Ie.return(N)))})}function wz(i,l,c,p,y){var A,P,N,G;return Z(function(q){if(q.g==1){if(A=Kd(Ni(l,"URI"),i.l),i.g.has(A))return q.return(i.g.get(A));var ae=tr(l,"CLOSED-CAPTIONS");return P=p=="video"&&ae&&ae!="NONE"?i.L.get(ae):null,N=on(p,c),I(q,jA(i,A,N,p,"und",!1,null,null,P,null,!1,!1,y),2)}return G=q.h,G==null?q.return(null):i.g.has(A)?q.return(i.g.get(A)):(i.g.set(A,G),q.return(G))})}function jA(i,l,c,p,y,A,P,N,G,q,ae,Te,Ie){var Ne,Ve,qe,Ze,Qe,Lt,It,yt,Jt,un,dn,xn,hn,Mn,Qn,Jn,ur,rr,Rr,ii,Sr,cs,pu,ts,ea,ta,Sf,Sg,tk,nk,rk,ik,dC,hC,Iy,sk,ak,ok,lk;return Z(function(Na){switch(Na.g){case 1:return Ne=Dt([i.M],[l])[0],I(Na,GA(i,Ne),2);case 2:if(Ve=Na.h,Ne=Ve.uri,qe=NA(i.$,Ve.data,Ne),qe.type!=1)throw new We(2,4,4017);if(Ze=[],qe.segments)for(Qe=E(qe.segments),Lt=Qe.next();!Lt.done;Lt=Qe.next())It=Lt.value,yt=uu(It.aa,"EXT-X-KEY"),Ze.push.apply(Ze,T(yt));for(Jt=!1,un=[],dn=new Set,xn=E(Ze),hn=xn.next();!hn.done;hn=xn.next())if(Mn=hn.value,Qn=Ni(Mn,"METHOD"),Qn!="NONE"){if(Jt=!0,Qn=="AES-128")return i.Ba=!0,Na.return(null);if(Jn=Ni(Mn,"KEYFORMAT"),rr=(ur=Kz[Jn])?ur(Mn):null){if(rr.keyIds)for(Rr=E(rr.keyIds),ii=Rr.next();!ii.done;ii=Rr.next())Sr=ii.value,dn.add(Sr);un.push(rr)}}if(Jt&&!un.length)throw new We(2,4,4026);return cs=uu(qe.aa,"EXT-X-DEFINE"),pu=gO(i,cs),Oz(i,qe),I(Na,Bz(i,p,c,qe,pu),3);case 3:return ts=Na.h,AO.includes(ts)&&(c=""),ea=new Map,ta=new Map,w(Na,4),I(Na,TO(i,l,qe,p,ts,ea,pu,ta,c,Ie),6);case 6:Sf=Na.h,K(Na,5);break;case 4:if(Sg=W(Na),Sg.code==4035)return Re("Skipping unsupported HLS stream",ts,l),Na.return(null);throw Sg;case 5:if(tk=Sf[0].startTime,nk=Sf[Sf.length-1].endTime,rk=new fr(Sf),ik=p==Ke?"subtitle":void 0,dC=[],q)for(hC=E(q.split(",")),Iy=hC.next();!Iy.done;Iy=hC.next())sk=Iy.value,dC.push(sk);return ok=(ak=Os(qe.aa,"EXT-X-SERVER-CONTROL"))?ak.getAttribute("CAN-SKIP-UNTIL")!=null:!1,lk={id:i.Aa++,originalId:P,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:rk,mimeType:ts,codecs:c,kind:ik,encrypted:Jt,drmInfos:un,keyIds:dn,language:y,label:P,type:p,primary:A,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:dC,forced:ae,channelsCount:N,audioSamplingRate:null,spatialAudio:Te,closedCaptions:G,hdr:void 0,tilesLayout:void 0},Na.return({stream:lk,Fd:l,Pf:Ne,tf:tk,Rg:nk,ie:ea,Zf:ta,Uf:ok})}})}function Oz(i,l){var c=Os(l.aa,"EXT-X-PLAYLIST-TYPE"),p=Os(l.aa,"EXT-X-ENDLIST");if(p=c&&c.value=="VOD"||p,c=c&&c.value=="EVENT"&&!p,c=!p&&!c,p)jv(i,cu);else{if(c?jv(i,CO):jv(i,xO),p=Os(l.aa,"EXT-X-TARGETDURATION"),!p)throw new We(2,4,4024,"EXT-X-TARGETDURATION");p=Number(p.value),c=Os(l.aa,"EXT-X-PART-INF"),i.i&&c?(i.Ca=Number(Ni(c,"PART-TARGET")),i.I=Math.min(i.Ca,i.I),c=Os(l.aa,"EXT-X-SERVER-CONTROL"),i.ea=c?Number(Ni(c,"PART-HOLD-BACK")):0):i.I=Math.min(p,i.I),i.ia=Math.max(p,i.ia)}}function vO(i,l,c,p){if(c=Os(c,"EXT-X-MAP"),!c)return null;var y=Ni(c,"URI");return p=Kd(Dt([l],[y])[0],p),l=[p,tr(c,"BYTERANGE","")].join("-"),i.ha.has(l)||(c=Nz(p,c),i.ha.set(l,c)),i.ha.get(l)}function Nz(i,l){var c=0,p=null,y=tr(l,"BYTERANGE");return y&&(c=y.split("@"),p=Number(c[0]),c=Number(c[1]),p=c+p-1),new Js(function(){return[i]},c,p)}function yO(i,l,c,p,y,A,P,N,G){var q=p.aa,ae=Kd(p.g,P),Te=Os(q,"EXTINF"),Ie=P=0,Ne=null,Ve=[];if(i.i&&p.h.length){i={},p=E(it(p.h));for(var qe=p.next();!qe.done;i={Od:i.Od},qe=p.next()){qe=qe.value;var Ze=qe.wa;qe=qe.item;var Qe=Ze==0?c:Ve[Ve.length-1];Ze=Ze==0?y:Qe.endTime;var Lt=Number(tr(qe,"DURATION"));Lt=Ze+Lt;var It=0,yt=null;qe.name=="EXT-X-PRELOAD-HINT"?It=(Qe=tr(qe,"BYTERANGE-START"))?Number(Qe):0:(It=tr(qe,"BYTERANGE"),Qe=E(EO(Qe,It)),It=Qe.next().value,yt=Qe.next().value),qe=tr(qe,"URI"),i.Od=Dt([N],[qe])[0],Ve.push(new Gr(Ze,Lt,function(Jt){return function(){return[Jt.Od]}}(i),It,yt,l,A,0,1/0))}}else if(!Te)throw new We(2,4,4024,"EXTINF");return Te?P=y+Number(Te.value.split(",")[0]):P=Ve[Ve.length-1].endTime,(N=Os(q,"EXT-X-BYTERANGE"))?(Ne=E(EO(c,N.value)),Ie=Ne.next().value,Ne=Ne.next().value):Ve.length&&(Ie=Ve[0].Ka,Ne=Ve[Ve.length-1].Da),c="",N=null,G=="image"&&(c="1x1",G=Os(q,"EXT-X-TILES"))&&(c=Ni(G,"LAYOUT"),(G=tr(G,"DURATION"))&&(N=Number(G))),new Gr(y,P,function(){return ae.length?[ae]:[]},Ie,Ne,l,A,0,1/0,Ve,c,N)}function EO(i,l){var c=0,p=null;return l&&(c=l.split("@"),p=Number(c[0]),c=c[1]?Number(c[1]):i.Da+1,p=c+p-1),[c,p]}function _O(i){if(i.h){for(var l=E(i.S),c=l.next();!c.done;c=l.next())i.h.tc(c.value);i.S=[]}}function TO(i,l,c,p,y,A,P,N,G,q){var ae,Te,Ie,Ne,Ve,qe,Ze,Qe,Lt,It,yt,Jt,un,dn,xn,hn,Mn,Qn,Jn,ur,rr,Rr,ii;return Z(function(Sr){switch(Sr.g){case 1:if(ae=c.segments,Ie=OA(c.aa,"EXT-X-MEDIA-SEQUENCE",0),Ve=(Ne=Os(c.aa,"EXT-X-SKIP"))?Number(tr(Ne,"SKIPPED-SEGMENTS")):0,qe=Ie+Ve,i.j!=cu&&A.has(qe)){Ze=A.get(qe),Sr.D(2);break}if(i.P!=null){Sr.D(3);break}return Te=vO(i,c.g,ae[0].aa,P),Qe=i,I(Sr,SO(i,l,Te,y,qe,!1,ae[0],P,p,G,q),4);case 4:Qe.P=Sr.h;case 3:Ze=i.P;case 2:if(Lt=ae[0].g,Lt.split("/").pop(),It=OA(c.aa,"EXT-X-DISCONTINUITY-SEQUENCE"),i.i&&(N.has(It)||N.set(It,qe),Ve))for(;N.has(It+1)&&N.get(It+1)<qe;)It++;yt=i.J.get(It)||0,Jt=[],un=function(cs){return it(cs)},dn=E(un(ae)),xn=dn.next();case 5:if(xn.done){Sr.D(7);break}if(hn=xn.value,Mn=hn.wa,Qn=hn.item,Jn=Jt[Jt.length-1],ur=Mn==0?Ze:Jn.endTime,qe=Ie+Ve+Mn,A.set(qe,ur),Te=vO(i,c.g,Qn.aa,P),rr=Os(Qn.aa,"EXT-X-DISCONTINUITY"),!rr){Sr.D(8);break}return It++,N.set(It,qe),I(Sr,Fz(i,It,l,Te,y,qe,Qn,P,ur,p,G,q),9);case 9:yt=Sr.h;case 8:!i.i&&i.F.isAutoLowLatencyMode()&&(i.F.enableLowLatencyMode(),i.i=i.F.isLowLatencyMode()),Rr=Os(Qn.aa,"EXTINF"),i.i||Rr?(ii=yO(i,Te,Jn,Qn,ur,yt,P,c.g,p),Jt.push(ii)):i.i||Re("Low-latency HLS live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details."),xn=dn.next(),Sr.D(5);break;case 7:return Sr.return(Jt)}})}function Fz(i,l,c,p,y,A,P,N,G,q,ae,Te){var Ie,Ne;return Z(function(Ve){return Ve.g==1?(Ie=0,i.J.has(l)?(Ie=i.J.get(l),Ve.D(2)):I(Ve,SO(i,c,p,y,A,!0,P,N,q,ae,Te),3)):(Ve.g!=2&&(Ne=Ve.h,Ie=G-Ne,i.J.set(l,Ie)),Ve.return(Ie))})}function KA(i,l,c,p,y,A){var P,N,G,q,ae,Te;return Z(function(Ie){switch(Ie.g){case 1:return P=Ro,N=Hp(l.Ma(),l.Ka,l.Da,i.m.retryParameters),i.F.modifySegmentRequest(N,{type:c,init:l instanceof Js,duration:l.endTime-l.startTime,mimeType:p,codecs:y,bandwidth:A}),i.m.hls.useFullSegmentsForStartTime?Ie.return(sg(i,N,P)):(G=Hp(l.Ma(),l.Ka,l.Ka+2048-1,i.m.retryParameters),i.F.modifySegmentRequest(G,{type:c,init:l instanceof Js,duration:l.endTime-l.startTime,mimeType:p,codecs:y,bandwidth:A}),w(Ie,2),I(Ie,sg(i,G,P),4));case 4:return q=Ie.h,Ie.return(q);case 2:if(ae=W(Ie),ae.code==7001)throw ae;return Re("Unable to fetch the starting part of HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",G.uris[0]),I(Ie,sg(i,N,P),5);case 5:return Te=Ie.h,Ie.return(Te)}})}function SO(i,l,c,p,y,A,P,N,G,q,ae){var Te,Ie,Ne,Ve,qe,Ze,Qe,Lt;return Z(function(It){switch(It.g){case 1:if(Te=yO(i,c,null,P,0,0,N,"",G),i.H&&!A&&(Ie=i.g.get(l),Ne=Ie.ie.get(y),Ne!=null))return It.return(Ne);if(p=p.toLowerCase(),AO.includes(p))throw Re("Raw formats are not yet supported.  Skipping "+p),new We(1,4,4035);if(p=="video/webm")throw Re("WebM in HLS is not yet supported.  Skipping."),new We(1,4,4035);if(p!="video/mp4"&&p!="audio/mp4"){It.D(2);break}return Ve=[KA(i,Te,G,p,q,ae)],c&&Ve.push(KA(i,c,G,p,q,ae)),I(It,Promise.all(Ve),3);case 3:return qe=It.h,Ze=qe[0],Qe=qe[1]||qe[0],It.return(kz(l,Ze.uri,Ze.data,Qe.data));case 2:if(p!="video/mp2t"){It.D(4);break}return I(It,KA(i,Te,G,p,q,ae),5);case 5:return Lt=It.h,It.return(Uz(l,Lt.uri,Lt.data));case 4:throw new We(2,4,4030,l)}})}function kz(i,l,c,p){var y=0;if(new Lr().box("moov",$r).box("trak",$r).box("mdia",$r).Z("mdhd",function(N){y=OS(N.reader,N.version).timescale,N.parser.stop()}).parse(p,!0),!y)throw new We(2,4,4030,i,l);var A=0,P=!1;if(new Lr().box("moof",$r).box("traf",$r).Z("tfdt",function(N){A=wS(N.reader,N.version).Xd/y,P=!0,N.parser.stop()}).parse(c,!0),!P)throw new We(2,4,4030,i,l);return A}function Uz(i,l,c){function p(){A.seek(P+188),N=A.ra(),N!=71&&(A.seek(P+192),N=A.ra()),N!=71&&(A.seek(P+204),N=A.ra()),N!=71&&y(),A.yf(1)}function y(){throw new We(2,4,4030,i,l)}var A=new yr(c,0),P=0,N=0;for(c=Math.min(A.X.byteLength-188,940);;){if(P=A.qa(),N=A.ra(),N!=71){if(0<c){--c;continue}y()}c=0;var G=A.wc();if((G&8191)==8191)p();else if(G&16384)if(G=(A.ra()&48)>>4,G!=0&&G!=2||y(),G==3&&(G=A.ra(),A.skip(G)),A.T()>>8!=1)p();else{A.skip(3),c=A.ra()>>6,c!=0&&c!=1||y(),A.ra()==0&&y(),c=A.ra(),G=A.wc();var q=A.wc();return(1073741824*((c&14)>>1)+((G&65534)<<14|(q&65534)>>1))/9e4}else p()}}function Kd(i,l){var c=String(i).replace(/%7B/g,"{").replace(/%7D/g,"}"),p=c.match(/{\$\w*}/g);if(p){p=E(p);for(var y=p.next();!y.done;y=p.next()){y=y.value;var A=y.slice(2,y.length-1),P=l.get(A);if(P)c=c.replace(y,P);else throw new We(2,4,4039,A)}}return c}function Bz(i,l,c,p,y){var A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe;return Z(function(Ze){return Ze.g==1?(A=ut,P=Ro,N=Kd(p.segments[0].g,y),G=new pt(N),q=G.Sa.split(".").pop(),ae=jz[l],(Te=ae[q])?Ze.return(Te):l==A.ua?c&&c!="vtt"&&c!="wvtt"?Ze.return("application/mp4"):Ze.return("text/vtt"):l==A.Gc&&(!c||c=="jpeg")?Ze.return("image/jpeg"):(Ie=Qs([N],i.m.retryParameters),Ie.method="HEAD",I(Ze,sg(i,Ie,P),2))):(Ne=Ze.h,Ve=Ne.headers["content-type"],Ve?Ze.return(Ve.split(";")[0]):(qe=ae.mp4,Ze.return(qe)))})}function GA(i,l){var c=Qs([l],i.m.retryParameters);return i.F.modifyManifestRequest(c,{format:"h"}),sg(i,c,0)}f.Tc=function(){var i=this,l,c;return Z(function(p){if(p.g==1)return i.F?(w(p,2),I(p,i.update(),4)):p.return();if(p.g!=2)return l=i.ka,i.C.U(l),K(p,0);if(c=W(p),!i.F)return p.return();c.severity=1,i.F.onError(c),i.C.U(.1),U(p)})};function jv(i,l){i.j=l,i.h&&i.h.Zc(i.j==cu),i.j!=cu||i.C.stop()}function sg(i,l,c){if(!i.G)throw new We(2,7,7001);return l=i.F.networkingEngine.request(c,l),ol(i.G,l),l.promise}Le("shaka.hls.HlsParser",ig);var AO=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],jz={audio:{mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},video:{mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"},image:{jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",webp:"image/webp",avif:"image/avif"}},Kz={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(i){var l=Ni(i,"METHOD");return["SAMPLE-AES","SAMPLE-AES-CTR"].includes(l)?(l=Ni(i,"URI"),l=kA(l),l=er(l.data),l=Kt("com.widevine.alpha",[{initDataType:"cenc",initData:l}]),(i=tr(i,"KEYID"))&&(l.keyIds=new Set([i.toLowerCase().substr(2)])),l):null},"com.microsoft.playready":function(i){var l=Ni(i,"METHOD");return["SAMPLE-AES","SAMPLE-AES-CTR"].includes(l)?(i=Ni(i,"URI"),i=kA(i),i=er(i.data),l=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),i=Ow(i,l),Kt("com.microsoft.playready",[{initDataType:"cenc",initData:i}])):null}},cu="VOD",xO="EVENT",CO="LIVE",IO={Of:cu,Nh:xO,Se:CO};of.m3u8=function(){return new ig},qa["application/x-mpegurl"]=function(){return new ig},qa["application/vnd.apple.mpegurl"]=function(){return new ig};function RO(i,l,c,p,y,A){if(200<=c&&299>=c&&c!=202)return{uri:y||p,vf:p,data:l,status:c,headers:i,fromCache:!!i["x-shaka-from-cache"]};y=null;try{y=ar(l)}catch{}throw new We(c==401||c==403?2:1,1,1001,p,c,y,i,A)}function WA(){}function Kv(i,l,c,p,y){var A=new $z;le(l.headers).forEach(function(q,ae){A.append(ae,q)});var P=new Hz,N={Ve:!1,If:!1};if(i=Gz(i,c,{body:l.body||void 0,headers:A,method:l.method,signal:P.signal,credentials:l.allowCrossSiteCredentials?"include":void 0},N,p,y,l.streamDataCallback),i=new Dr(i,function(){return N.Ve=!0,P.abort(),Promise.resolve()}),l=l.retryParameters.timeout){var G=new kn(function(){N.If=!0,P.abort()});G.U(l/1e3),i.finally(function(){G.stop()})}return i}function Gz(i,l,c,p,y,A,P){var N,G,q,ae,Te,Ie,Ne,Ve,qe,Ze,Qe,Lt,It;return Z(function(yt){switch(yt.g){case 1:return N=Wz,G=Vz,Ie=Te=0,Ne=Date.now(),w(yt,2),I(yt,N(i,c),4);case 4:return q=yt.h,A(bO(q.headers)),Ve=q.clone().body.getReader(),Ze=(qe=q.headers.get("Content-Length"))?parseInt(qe,10):0,Qe=function(Jt){function un(){var dn,xn;return Z(function(hn){switch(hn.g){case 1:return w(hn,2),I(hn,Ve.read(),4);case 4:dn=hn.h,K(hn,3);break;case 2:return W(hn),hn.return();case 3:if(dn.done){hn.D(5);break}if(Te+=dn.value.byteLength,!P){hn.D(5);break}return I(hn,P(dn.value),5);case 5:xn=Date.now(),(100<xn-Ne||dn.done)&&(y(xn-Ne,Te-Ie,Ze-Te),Ie=Te,Ne=xn),dn.done?Jt.close():(Jt.enqueue(dn.value),un()),U(hn)}})}un()},new G({start:Qe}),I(yt,q.arrayBuffer(),5);case 5:ae=yt.h,K(yt,3);break;case 2:throw Lt=W(yt),p.Ve?new We(1,1,7001,i,l):p.If?new We(1,1,1003,i,l):new We(1,1,1002,i,Lt,l);case 3:return It=bO(q.headers),yt.return(RO(It,ae,q.status,i,q.url,l))}})}function bO(i){var l={};return i.forEach(function(c,p){l[p.trim()]=c}),l}function DO(){if(o.ReadableStream)try{new ReadableStream({})}catch{return!1}else return!1;return!(!o.fetch||!o.AbortController)}Le("shaka.net.HttpFetchPlugin",WA),WA.isSupported=DO,WA.parse=Kv;var Wz=o.fetch,Hz=o.AbortController,Vz=o.ReadableStream,$z=o.Headers;DO()&&(Io("http",Kv,2,!0),Io("https",Kv,2,!0),Io("blob",Kv,2,!0));function PO(){}function Gv(i,l,c,p,y){var A=new zz,P=Date.now(),N=0,G=new Promise(function(q,ae){A.open(l.method,i,!0),A.responseType="arraybuffer",A.timeout=l.retryParameters.timeout,A.withCredentials=l.allowCrossSiteCredentials,A.onabort=function(){ae(new We(1,1,7001,i,c))};var Te=!1;A.onreadystatechange=function(){if(A.readyState==2&&!Te){var Ne=LO(A);y(Ne),Te=!0}},A.onload=function(){var Ne=LO(A),Ve=A.response;try{var qe=RO(Ne,Ve,A.status,i,A.responseURL,c);q(qe)}catch(Ze){ae(Ze)}},A.onerror=function(Ne){ae(new We(1,1,1002,i,Ne,c))},A.ontimeout=function(){ae(new We(1,1,1003,i,c))},A.onprogress=function(Ne){var Ve=Date.now();(100<Ve-P||Ne.lengthComputable&&Ne.loaded==Ne.total)&&(p(Ve-P,Ne.loaded-N,Ne.total-Ne.loaded),N=Ne.loaded,P=Ve)};for(var Ie in l.headers)A.setRequestHeader(Ie.toLowerCase(),l.headers[Ie]);A.send(l.body)});return new Dr(G,function(){return A.abort(),Promise.resolve()})}function LO(i){var l=i.getAllResponseHeaders().trim().split(`\r
`);i={},l=E(l);for(var c=l.next();!c.done;c=l.next())c=c.value.split(": "),i[c[0].toLowerCase()]=c.slice(1).join(": ");return i}Le("shaka.net.HttpXHRPlugin",PO),PO.parse=Gv;var zz=o.XMLHttpRequest;Io("http",Gv,1,!0),Io("https",Gv,1,!0),Io("blob",Gv,1,!0);function MO(i,l,c,p){this.g=i,this.i=l,this.groupId=c,this.h=p}function HA(i){return i.Ma().map(function(l){return"{"+encodeURI(l)+"}"}).join("")+":"+i.Ka+":"+i.Da}function Yz(i,l){return Hp(i.g.Ma(),i.g.Ka,i.g.Da,l.streaming.retryParameters)}function wO(){this.h=this.j=this.i=0,this.g=new Map,this.l=0}function OO(i,l){i.i+=l;var c=i.l;return i.l++,i.g.set(c,l),c}wO.prototype.close=function(i,l){if(this.g.has(i)){var c=this.g.get(i);this.g.delete(i),this.j+=c,this.h+=l}};function NO(i){var l=this;this.V=i,this.g=new Map,this.N=new Zl(function(){return VA(l).catch(function(){})}),this.h=[],this.Lf=function(){},this.Jf=function(){},this.fc=new wO}NO.prototype.destroy=function(){return this.N.destroy()};function Xz(i,l,c){i.Lf=l,i.Jf=c}function VA(i){var l=i.h.map(function(c){return c()});return i.h=[],Promise.all(l)}function qz(i,l,c,p,y,A){Pr(i.N);var P=(i.g.get(l)||Promise.resolve()).then(function(){var N,G,q,ae,Te,Ie,Ne;return Z(function(Ve){if(Ve.g==1)return I(Ve,Zz(i,c),2);if(N=Ve.h,i.N.g)throw new We(2,9,7001);if(y)for(ae in G=er(N),q=new ww(G),q.data)Te=Number(ae),Ie=q.data[Te],Ne=q.g[Te],i.Jf(Ie,Ne);i.fc.close(p,N.byteLength);var qe=i.fc;return i.Lf(qe.i==0?0:qe.j/qe.i,i.fc.h),Ve.return(A(N))})});i.g.set(l,P)}function Qz(i,l,c){Pr(i.N);var p=(i.g.get(l)||Promise.resolve()).then(function(){return Z(function(y){return I(y,c(),0)})});i.g.set(l,p)}function Jz(i){return Z(function(l){return l.g==1?I(l,Promise.all(i.g.values()),2):l.return(i.fc.h)})}function Zz(i,l){var c,p,y,A;return Z(function(P){return P.g==1?(c=Ro,p=i.V.request(c,l),y=function(){return p.abort()},i.h.push(y),I(P,p.promise,2)):(A=P.h,tt(i.h,y),P.return(A.data))})}function Wv(i,l){var c=this;this.i=i,this.h=i.objectStore(l),this.g=new Rt,i.onabort=function(p){p.preventDefault(),c.g.reject()},i.onerror=function(p){p.preventDefault(),c.g.reject()},i.oncomplete=function(){c.g.resolve()}}Wv.prototype.abort=function(){var i=this;return Z(function(l){if(l.g==1){try{i.i.abort()}catch{}return w(l,2),I(l,i.g,4)}if(l.g!=2)return K(l,0);W(l),U(l)})};function $A(i,l){return new Promise(function(c,p){var y=i.h.openCursor();y.onerror=p,y.onsuccess=function(){var A;return Z(function(P){if(P.g==1)return y.result==null?(c(),P.return()):(A=y.result,I(P,l(A.key,A.value,A),2));A.continue(),U(P)})}})}Wv.prototype.store=function(){return this.h},Wv.prototype.promise=function(){return this.g};function zA(i){this.h=i,this.g=[]}zA.prototype.destroy=function(){return Promise.all(this.g.map(function(i){return i.abort()}))};function vf(i,l){return Hv(i,l,"readwrite")}function Hv(i,l,c){c=i.h.transaction([l],c);var p=new Wv(c,l);return i.g.push(p),p.promise().then(function(){tt(i.g,p)},function(){tt(i.g,p)}),p}function yf(i,l,c){this.h=new zA(i),this.i=l,this.g=c}f=yf.prototype,f.destroy=function(){return this.h.destroy()},f.hasFixedKeySpace=function(){return!0},f.addSegments=function(){return FO(this.i)},f.removeSegments=function(i,l){return kO(this,this.i,i,l)},f.getSegments=function(i){var l=this,c;return Z(function(p){return p.g==1?I(p,UO(l,l.i,i),2):(c=p.h,p.return(c.map(function(y){return l.Ye(y)})))})},f.addManifests=function(){return FO(this.g)},f.updateManifest=function(){return Promise.reject(new We(2,9,9016,"Cannot modify values in "+this.g))};function e7(i,l,c){i=vf(i.h,i.g);var p=i.store();return p.get(l).onsuccess=function(){p.put(c,l)},i.promise()}f.updateManifestExpiration=function(i,l){var c=vf(this.h,this.g),p=c.store();return p.get(i).onsuccess=function(y){(y=y.target.result)&&(y.expiration=l,p.put(y,i))},c.promise()},f.removeManifests=function(i,l){return kO(this,this.g,i,l)},f.getManifests=function(i){var l=this,c;return Z(function(p){return p.g==1?I(p,UO(l,l.g,i),2):(c=p.h,p.return(Promise.all(c.map(function(y){return l.Jc(y)}))))})},f.getAllManifests=function(){var i=this,l,c;return Z(function(p){return p.g==1?(l=Hv(i.h,i.g,"readonly"),c=new Map,I(p,$A(l,function(y,A){var P;return Z(function(N){if(N.g==1)return I(N,i.Jc(A),2);P=N.h,c.set(y,P),U(N)})}),2)):p.g!=3?I(p,l.promise(),3):p.return(c)})},f.Ye=function(i){return i},f.Jc=function(i){return Promise.resolve(i)};function FO(i){return Promise.reject(new We(2,9,9011,"Cannot add new value to "+i))}f.add=function(i,l){var c=this,p,y,A,P,N,G,q;return Z(function(ae){if(ae.g==1){for(p=vf(c.h,i),y=p.store(),A=[],P={},N=E(l),G=N.next();!G.done;P={fd:P.fd},G=N.next())q=G.value,P.fd=y.add(q),P.fd.onsuccess=function(Te){return function(){A.push(Te.fd.result)}}(P);return I(ae,p.promise(),2)}return ae.return(A)})};function kO(i,l,c,p){i=vf(i.h,l),l=i.store();var y={};c=E(c);for(var A=c.next();!A.done;y={ed:y.ed},A=c.next())y.ed=A.value,l.delete(y.ed).onsuccess=function(P){return function(){return p(P.ed)}}(y);return i.promise()}function UO(i,l,c){var p,y,A,P,N,G,q;return Z(function(ae){if(ae.g==1){for(p=Hv(i.h,l,"readonly"),y=p.store(),A={},P=[],N={},G=E(c),q=G.next();!q.done;N={Ec:N.Ec,Ac:N.Ac},q=G.next())N.Ac=q.value,N.Ec=y.get(N.Ac),N.Ec.onsuccess=function(Te){return function(){Te.Ec.result==null&&P.push(Te.Ac),A[Te.Ac]=Te.Ec.result}}(N);return I(ae,p.promise(),2)}if(P.length)throw new We(2,9,9012,"Could not find values for "+P);return ae.return(c.map(function(Te){return A[Te]}))})}function ag(i){this.g=new zA(i)}ag.prototype.destroy=function(){return this.g.destroy()},ag.prototype.getAll=function(){var i=this,l,c;return Z(function(p){return p.g==1?(l=Hv(i.g,"session-ids","readonly"),c=[],I(p,$A(l,function(y,A){c.push(A)}),2)):p.g!=3?I(p,l.promise(),3):p.return(c)})},ag.prototype.add=function(i){var l=vf(this.g,"session-ids"),c=l.store();i=E(i);for(var p=i.next();!p.done;p=i.next())c.add(p.value);return l.promise()},ag.prototype.remove=function(i){var l=this,c;return Z(function(p){return p.g==1?(c=vf(l.g,"session-ids"),I(p,$A(c,function(y,A,P){i.includes(A.sessionId)&&P.delete()}),2)):I(p,c.promise(),0)})};function os(){this.g=new Map}os.prototype.destroy=function(){for(var i=[],l=E(this.g.values()),c=l.next();!c.done;c=l.next())i.push(c.value.destroy());return this.g.clear(),Promise.all(i)},os.prototype.init=function(){var i=this;og.forEach(function(y,A){var P=y();P&&i.g.set(A,P)});for(var l=[],c=E(this.g.values()),p=c.next();!p.done;p=c.next())l.push(p.value.init());return Promise.all(l)};function YA(i){var l=null;if(i.g.forEach(function(c,p){c.getCells().forEach(function(y,A){y.hasFixedKeySpace()||l||(l={path:{Ya:p,oa:A},oa:y})})}),l)return l;throw new We(2,9,9013,"Could not find a cell that supports add-operations")}function t7(i,l){i.g.forEach(function(c,p){c.getCells().forEach(function(y,A){l({Ya:p,oa:A},y)})})}function Vv(i,l,c){if(i=i.g.get(l),!i)throw new We(2,9,9013,"Could not find mechanism with name "+l);if(l=i.getCells().get(c),!l)throw new We(2,9,9013,"Could not find cell with name "+c);return l}function n7(i,l){i.g.forEach(function(c){l(c.getEmeSessionCell())})}function r7(i){var l=Array.from(i.g.keys());if(!l.length)throw new We(2,9,9e3,"No supported storage mechanisms found");return i.g.get(l[0]).getEmeSessionCell()}function i7(i){var l,c,p;return Z(function(y){return y.g==1?(l=Array.from(i.g.values()),c=0<l.length,c||(p=og,p.forEach(function(A){(A=A())&&l.push(A)})),I(y,Promise.all(l.map(function(A){return A.erase()})),2)):c?y.D(0):I(y,Promise.all(l.map(function(A){return A.destroy()})),0)})}function BO(i,l){og.set(i,l)}Le("shaka.offline.StorageMuxer",os),os.unregister=function(i){og.delete(i)},os.register=BO,os.prototype.destroy=os.prototype.destroy;var og=new Map;function lg(){yf.apply(this,arguments)}D(lg,yf),lg.prototype.updateManifestExpiration=function(i,l){var c=this,p,y,A;return Z(function(P){return p=vf(c.h,c.g),y=p.store(),A=new Rt,y.get(i).onsuccess=function(N){(N=N.target.result)?(N.expiration=l,y.put(N),A.resolve()):A.reject(new We(2,9,9012,"Could not find values for "+i))},I(P,Promise.all([p.promise(),A]),0)})},lg.prototype.Jc=function(i){var l,c,p,y,A,P;return Z(function(N){if(N.g==1){for(l=[],c=0;c<i.periods.length;++c)p=c==i.periods.length-1?i.duration:i.periods[c+1].startTime,y=p-i.periods[c].startTime,A=s7(i.periods[c],y),l.push(A);return I(N,Yw(l),2)}return P=N.h,N.return({creationTime:0,originalManifestUri:i.originalManifestUri,duration:i.duration,size:i.size,expiration:i.expiration==null?1/0:i.expiration,streams:P,sessionIds:i.sessionIds,drmInfo:i.drmInfo,appMetadata:i.appMetadata})})};function s7(i,l){o7(i);for(var c=E(i.streams),p=c.next();!p.done;p=c.next());return i.streams.map(function(y){return a7(y,i.startTime,l)})}function a7(i,l,c){var p=i.initSegmentUri?jO(i.initSegmentUri):null,y=l+i.presentationTimeOffset,A=l+c;return{id:i.id,originalId:null,primary:i.primary,type:i.contentType,mimeType:i.mimeType,codecs:i.codecs,frameRate:i.frameRate,pixelAspectRatio:void 0,hdr:void 0,kind:i.kind,language:i.language,label:i.label,width:i.width,height:i.height,initSegmentKey:p,encrypted:i.encrypted,keyIds:new Set([i.keyId]),segments:i.segments.map(function(P){var N=jO(P.uri);return{startTime:l+P.startTime,endTime:l+P.endTime,dataKey:N,initSegmentKey:p,appendWindowStart:l,appendWindowEnd:A,timestampOffset:y,tilesLayout:""}}),variantIds:i.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0}}lg.prototype.Ye=function(i){return{data:i.data}};function jO(i){var l;if((l=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(i))||(l=/^offline:segment\/([0-9]+)$/.exec(i)))return Number(l[1]);throw new We(2,9,9004,"Could not parse uri "+i)}function o7(i){var l=i.streams.filter(function(N){return N.contentType=="audio"});if(i=i.streams.filter(function(N){return N.contentType=="video"}),!l.every(function(N){return N.variantIds})||!i.every(function(N){return N.variantIds})){for(var c=E(l),p=c.next();!p.done;p=c.next())p.value.variantIds=[];for(c=E(i),p=c.next();!p.done;p=c.next())p.value.variantIds=[];if(c=0,i.length&&!l.length){var y=c++,A=E(i);for(p=A.next();!p.done;p=A.next())p.value.variantIds.push(y)}if(!i.length&&l.length)for(y=c++,A=E(l),p=A.next();!p.done;p=A.next())p.value.variantIds.push(y);if(i.length&&l.length)for(l=E(l),p=l.next();!p.done;p=l.next())for(p=p.value,y=E(i),A=y.next();!A.done;A=y.next()){A=A.value;var P=c++;p.variantIds.push(P),A.variantIds.push(P)}}}function $v(){yf.apply(this,arguments)}D($v,yf),$v.prototype.Jc=function(i){var l,c,p,y,A,P;return Z(function(N){if(N.g==1){for(l=[],c=0;c<i.periods.length;++c){p=c==i.periods.length-1?i.duration:i.periods[c+1].startTime,y=p-i.periods[c].startTime;for(var G=i.periods[c],q=[],ae=E(G.streams),Te=ae.next();!Te.done;Te=ae.next())Te=Te.value,Te.variantIds.length!=0&&q.push(l7(Te,G.startTime,G.startTime+y));A=q,l.push(A)}return I(N,Yw(l),2)}return P=N.h,N.return({appMetadata:i.appMetadata,creationTime:0,drmInfo:i.drmInfo,duration:i.duration,expiration:i.expiration==null?1/0:i.expiration,originalManifestUri:i.originalManifestUri,sessionIds:i.sessionIds,size:i.size,streams:P})})};function l7(i,l,c){return{id:i.id,originalId:i.originalId,primary:i.primary,type:i.contentType,mimeType:i.mimeType,codecs:i.codecs,frameRate:i.frameRate,pixelAspectRatio:i.pixelAspectRatio,hdr:void 0,kind:i.kind,language:i.language,label:i.label,width:i.width,height:i.height,encrypted:i.encrypted,keyIds:new Set([i.keyId]),segments:i.segments.map(function(p){return{startTime:l+p.startTime,endTime:l+p.endTime,initSegmentKey:i.initSegmentKey,appendWindowStart:l,appendWindowEnd:c,timestampOffset:l-i.presentationTimeOffset,dataKey:p.dataKey,tilesLayout:""}}),variantIds:i.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0}}function XA(){yf.apply(this,arguments)}D(XA,yf),f=XA.prototype,f.hasFixedKeySpace=function(){return!1},f.addSegments=function(i){return this.add(this.i,i)},f.addManifests=function(i){return this.add(this.g,i)},f.updateManifest=function(i,l){return e7(this,i,l)},f.Jc=function(i){return i.expiration==null&&(i.expiration=1/0),Promise.resolve(i)};function KO(){this.s=this.j=this.i=this.h=this.g=this.l=null}f=KO.prototype,f.init=function(){var i=this,l=new Rt,c=o.indexedDB.open("shaka_offline_db",5);return c.onsuccess=function(){var p=c.result;i.l=p;var y=p.objectStoreNames;y=y.contains("manifest")&&y.contains("segment")?new lg(p,"segment","manifest"):null,i.g=y,y=p.objectStoreNames,y=y.contains("manifest-v2")&&y.contains("segment-v2")?new $v(p,"segment-v2","manifest-v2"):null,i.h=y,y=p.objectStoreNames,y=y.contains("manifest-v3")&&y.contains("segment-v3")?new $v(p,"segment-v3","manifest-v3"):null,i.i=y,y=p.objectStoreNames,y=y.contains("manifest-v5")&&y.contains("segment-v5")?new XA(p,"segment-v5","manifest-v5"):null,i.j=y,p=p.objectStoreNames.contains("session-ids")?new ag(p):null,i.s=p,l.resolve()},c.onupgradeneeded=function(){for(var p=c.result,y=E(["segment-v5","manifest-v5","session-ids"]),A=y.next();!A.done;A=y.next())A=A.value,p.objectStoreNames.contains(A)||p.createObjectStore(A,{autoIncrement:!0})},c.onerror=function(p){l.reject(new We(2,9,9001,c.error)),p.preventDefault()},l},f.destroy=function(){var i=this;return Z(function(l){switch(l.g){case 1:if(!i.g){l.D(2);break}return I(l,i.g.destroy(),2);case 2:if(!i.h){l.D(4);break}return I(l,i.h.destroy(),4);case 4:if(!i.i){l.D(6);break}return I(l,i.i.destroy(),6);case 6:if(!i.j){l.D(8);break}return I(l,i.j.destroy(),8);case 8:if(!i.s){l.D(10);break}return I(l,i.s.destroy(),10);case 10:i.l&&i.l.close(),U(l)}})},f.getCells=function(){var i=new Map;return this.g&&i.set("v1",this.g),this.h&&i.set("v2",this.h),this.i&&i.set("v3",this.i),this.j&&i.set("v5",this.j),i},f.getEmeSessionCell=function(){return this.s},f.erase=function(){var i=this;return Z(function(l){switch(l.g){case 1:if(!i.g){l.D(2);break}return I(l,i.g.destroy(),2);case 2:if(!i.h){l.D(4);break}return I(l,i.h.destroy(),4);case 4:if(!i.i){l.D(6);break}return I(l,i.i.destroy(),6);case 6:if(!i.j){l.D(8);break}return I(l,i.j.destroy(),8);case 8:return i.l&&i.l.close(),I(l,u7(),10);case 10:return i.l=null,i.g=null,i.h=null,i.i=null,i.j=null,I(l,i.init(),0)}})};function u7(){var i=new Rt,l=o.indexedDB.deleteDatabase("shaka_offline_db");return l.onblocked=function(){},l.onsuccess=function(){i.resolve()},l.onerror=function(c){i.reject(new We(2,9,9001,l.error)),c.preventDefault()},i}BO("idb",function(){return zl()||!o.indexedDB?null:new KO});function fl(i,l,c,p){this.g=i,this.i=l,this.h=c,this.l=p,this.j=["offline:",i,"/",l,"/",c,"/",p].join("")}fl.prototype.Ya=function(){return this.i},fl.prototype.oa=function(){return this.h},fl.prototype.key=function(){return this.l},fl.prototype.toString=function(){return this.j};function qA(i){if(i=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(i),i==null)return null;var l=i[1];if(l!="manifest"&&l!="segment")return null;var c=i[2];if(!c)return null;var p=i[3];return p&&l!=null?new fl(l,c,p,Number(i[4])):null}function GO(i,l){this.h=i,this.g=l}function WO(i,l){var c=new Wn(null,0);c.ib(l.duration);var p=l.streams.filter(function(q){return q.type=="audio"}),y=l.streams.filter(function(q){return q.type=="video"});p=c7(i,p,y,c),y=l.streams.filter(function(q){return q.type==Ke}).map(function(q){return zv(i,q,c)});var A=l.streams.filter(function(q){return q.type=="image"}).map(function(q){return zv(i,q,c)}),P=l.drmInfo?[l.drmInfo]:[];if(l.drmInfo)for(var N=E(p.values()),G=N.next();!G.done;G=N.next())G=G.value,G.audio&&G.audio.encrypted&&(G.audio.drmInfos=P),G.video&&G.video.encrypted&&(G.video.drmInfos=P);return{presentationTimeline:c,minBufferTime:2,offlineSessionIds:l.sessionIds,variants:Array.from(p.values()),textStreams:y,imageStreams:A}}function c7(i,l,c,p){for(var y=new Set,A=E(l),P=A.next();!P.done;P=A.next()){var N=E(P.value.variantIds);for(P=N.next();!P.done;P=N.next())y.add(P.value)}for(A=E(c),P=A.next();!P.done;P=A.next())for(N=E(P.value.variantIds),P=N.next();!P.done;P=N.next())y.add(P.value);for(A=new Map,y=E(y),P=y.next();!P.done;P=y.next())P=P.value,A.set(P,{id:P,language:"",primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});for(l=E(l),y=l.next();!y.done;y=l.next())for(y=y.value,P=zv(i,y,p),N=E(y.variantIds),y=N.next();!y.done;y=N.next())y=A.get(y.value),y.language=P.language,y.primary=y.primary||P.primary,y.audio=P;for(c=E(c),l=c.next();!l.done;l=c.next())for(y=l.value,l=zv(i,y,p),P=E(y.variantIds),y=P.next();!y.done;y=P.next())y=A.get(y.value),y.primary=y.primary||l.primary,y.video=l;return A}function zv(i,l,c){var p=l.segments.map(function(y){return f7(i,y)});return c.tc(p),{id:l.id,originalId:l.originalId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new fr(p),mimeType:l.mimeType,codecs:l.codecs,width:l.width||void 0,height:l.height||void 0,frameRate:l.frameRate,pixelAspectRatio:l.pixelAspectRatio,hdr:l.hdr,kind:l.kind,encrypted:l.encrypted,drmInfos:[],keyIds:l.keyIds,language:l.language,label:l.label,type:l.type,primary:l.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:l.roles,forced:l.forced,channelsCount:l.channelsCount,audioSamplingRate:l.audioSamplingRate,spatialAudio:l.spatialAudio,closedCaptions:l.closedCaptions,tilesLayout:l.tilesLayout}}function f7(i,l){var c=new fl("segment",i.h,i.g,l.dataKey);return new Gr(l.startTime,l.endTime,function(){return[c.toString()]},0,null,l.initSegmentKey!=null?d7(i,l.initSegmentKey):null,l.timestampOffset,l.appendWindowStart,l.appendWindowEnd,[],l.tilesLayout||"")}function d7(i,l){var c=new fl("segment",i.h,i.g,l);return new Js(function(){return[c.toString()]},0,null)}function HO(){this.g=null}f=HO.prototype,f.configure=function(){},f.start=function(i,l){var c=this,p,y,A,P,N,G,q;return Z(function(ae){switch(ae.g){case 1:if(p=qA(i),c.g=p,p==null||p.g!="manifest")throw new We(2,1,9004,i);return y=new os,k(ae),I(ae,y.init(),4);case 4:return I(ae,Vv(y,p.Ya(),p.oa()),5);case 5:return A=ae.h,I(ae,A.getManifests([p.key()]),6);case 6:return P=ae.h,N=P[0],G=new GO(p.Ya(),p.oa()),q=WO(G,N),l.makeTextStreamsForClosedCaptions(q),ae.return(q);case 2:return Y(ae),I(ae,y.destroy(),7);case 7:J(ae,0)}})},f.stop=function(){return Promise.resolve()},f.update=function(){},f.onExpirationUpdated=function(i,l){var c=this,p,y,A,P,N,G,q;return Z(function(ae){switch(ae.g){case 1:return p=c.g,y=new os,w(ae,2,3),I(ae,y.init(),5);case 5:return I(ae,Vv(y,p.Ya(),p.oa()),6);case 6:return A=ae.h,I(ae,A.getManifests([p.key()]),7);case 7:if(P=ae.h,N=P[0],G=N.sessionIds.includes(i),q=N.expiration==null||N.expiration>l,!G||!q){ae.D(3);break}return I(ae,A.updateManifestExpiration(p.key(),l),3);case 3:return Y(ae),I(ae,y.destroy(),10);case 10:J(ae,0);break;case 2:W(ae),ae.D(3)}})},qa["application/x-offline-manifest"]=function(){return new HO};function VO(){}function $O(i){var l=qA(i);return l&&l.g=="manifest"?(i={uri:i,vf:i,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}},i=Co(i)):i=l&&l.g=="segment"?h7(l.key(),l):xo(new We(2,1,9004,i)),i}function h7(i,l){var c=new os;return Co(void 0).va(function(){return c.init()}).va(function(){return Vv(c,l.Ya(),l.oa())}).va(function(p){return p.getSegments([l.key()])}).va(function(p){return{uri:l,data:p[0].data,headers:{}}}).finally(function(){return c.destroy()})}Le("shaka.offline.OfflineScheme",VO),VO.plugin=$O,Io("offline",$O);function zO(i,l,c){var p,y,A,P,N,G;return Z(function(q){switch(q.g){case 1:p=[];for(var ae=[],Te=E(c),Ie=Te.next();!Ie.done;Ie=Te.next()){Ie=Ie.value;for(var Ne=!1,Ve=E(ae),qe=Ve.next();!qe.done;qe=Ve.next())if(qe=qe.value,g7(qe.info,Ie)){qe.sessionIds.push(Ie.sessionId),Ne=!0;break}Ne||ae.push({info:Ie,sessionIds:[Ie.sessionId]})}y=E(ae),A=y.next();case 2:if(A.done){q.D(4);break}return P=A.value,N=p7(i,l,P),I(q,N,5);case 5:G=q.h,p=p.concat(G),A=y.next(),q.D(2);break;case 4:return q.return(p)}})}function p7(i,l,c){var p,y;return Z(function(A){switch(A.g){case 1:return p=new Ge({Wb:l,onError:function(){},wd:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),w(A,2),p.configure(i),I(A,_t(p,c.info.keySystem,c.info.licenseUri,c.info.serverCertificate,c.info.audioCapabilities,c.info.videoCapabilities),4);case 4:K(A,3);break;case 2:return W(A),I(A,p.destroy(),5);case 5:return A.return([]);case 3:return w(A,6),I(A,Sn(p),8);case 8:K(A,7);break;case 6:return W(A),I(A,p.destroy(),9);case 9:return A.return([]);case 7:return y=[],I(A,Promise.all(c.sessionIds.map(function(P){return Z(function(N){if(N.g==1)return w(N,2),I(N,tn(p,P),4);if(N.g!=2)return y.push(P),K(N,0);W(N),U(N)})})),10);case 10:return I(A,p.destroy(),11);case 11:return A.return(y)}})}function g7(i,l){function c(p,y){return p.robustness==y.robustness&&p.contentType==y.contentType}return i.keySystem==l.keySystem&&i.licenseUri==l.licenseUri&&vt(i.audioCapabilities,l.audioCapabilities,c)&&vt(i.videoCapabilities,l.videoCapabilities,c)}function m7(i,l,c){var p=l.presentationTimeline.getDuration();return l=YO(l),{offlineUri:null,originalManifestUri:i,duration:p,size:0,expiration:1/0,tracks:l,appMetadata:c,isIncomplete:!1}}function QA(i,l){var c=WO(new GO(i.Ya(),i.oa()),l),p=l.appMetadata||{};return c=YO(c),{offlineUri:i.toString(),originalManifestUri:l.originalManifestUri,duration:l.duration,size:l.size,expiration:l.expiration,tracks:c,appMetadata:p,isIncomplete:l.isIncomplete||!1}}function YO(i){var l=[],c=yS(i.variants);c=E(c);for(var p=c.next();!p.done;p=c.next())l.push(ql(p.value));for(i=E(i.textStreams),c=i.next();!c.done;c=i.next())l.push(tf(c.value));return l}function v7(){this.g={}}function y7(i,l){var c=l.audio,p=l.video;if(c&&!p&&(i.g[c.id]=c.bandwidth||l.bandwidth),!c&&p&&(i.g[p.id]=p.bandwidth||l.bandwidth),c&&p){var y=c.bandwidth||393216,A=p.bandwidth||l.bandwidth-y;0>=A&&(A=l.bandwidth),i.g[c.id]=y,i.g[p.id]=A}}function E7(i,l){i.g[l.id]=l.bandwidth||2048}function XO(i,l){var c=i.g[l];return c==null&&(c=0),c}function qO(){this.h=[],this.g=this.i=0}function _7(){var i=tN,l;return Z(function(c){return c.g==1?(l=++i.i,i.g?I(c,new Promise(function(p){i.h.push(function(){i.g=l,p()})}),2):(i.g=l,c.D(2))):c.return(l)})}qO.prototype.release=function(i){i==this.g&&(this.g=0,0<this.h.length&&this.h.shift()())};function vi(i){var l=this;if(i&&i.constructor!=Yt)throw new We(2,9,9008);this.V=this.m=null,i?(this.m=i.m,this.V=i.Mc()):(this.m=Xp(),this.V=new Tr),this.Uc=[],this.re=[];var c=!i;this.N=new Zl(function(){var p,y,A,P,N;return Z(function(G){switch(G.g){case 1:return I(G,Promise.all(l.re.map(function(q){return VA(q)})),2);case 2:for(p=function(){},y=[],A=E(l.Uc),P=A.next();!P.done;P=A.next())N=P.value,y.push(N.then(p,p));return I(G,Promise.all(y),3);case 3:if(!c){G.D(4);break}return I(G,l.V.destroy(),4);case 4:l.m=null,l.V=null,U(G)}})})}function JA(){if(vs())e:{for(var i=E(og.values()),l=i.next();!l.done;l=i.next())if(l=l.value,l=l()){l.destroy(),i=!0;break e}i=!1}else i=!1;return i}f=vi.prototype,f.destroy=function(){return this.N.destroy()},f.configure=function(i,l){return arguments.length==2&&typeof i=="string"&&(i=pv(i,l)),i.manifest&&i.manifest.dash&&"defaultPresentationDelay"in i.manifest.dash&&(Ct("manifest.dash.defaultPresentationDelay configuration","Please Use manifest.defaultPresentationDelay instead."),i.manifest.defaultPresentationDelay=i.manifest.dash.defaultPresentationDelay,delete i.manifest.dash.defaultPresentationDelay),Ld(this.m,i)},f.getConfiguration=function(){var i=Xp();return Ld(i,this.m,Xp()),i},f.Mc=function(){return this.V},f.store=function(i,l,c){var p=this,y=this.getConfiguration(),A=new NO(this.V);this.re.push(A),l=T7(this,i,l||{},function(){var N;return Z(function(G){return G.g==1?I(G,aL(i,p.V,y.manifest.retryParameters,c||null),2):(N=G.h,G.return(Ft(N)))})},y,A);var P=new Dr(l,function(){return VA(A)});return P.finally(function(){tt(p.re,A)}),P.then=function(N){return Ct("shaka.offline.Storage.store.then","Storage operations now return a shaka.util.AbortableOperation, rather than a promise.  Please update to conform to this new API; you can use the |chain| method instead."),P.promise.then(N)},k7(this,P)},f.Cg=function(){return Ct("shaka.offline.Storage.getStoreInProgress","Multiple concurrent downloads are now supported."),!1};function T7(i,l,c,p,y,A){var P,N,G,q,ae,Te,Ie,Ne,Ve,qe,Ze,Qe,Lt,It;return Z(function(yt){switch(yt.g){case 1:return Yv(),N=P=null,G=new os,Te=ae=q=null,w(yt,2,3),I(yt,p(),5);case 5:return P=yt.h,I(yt,M7(i,l,P,y),6);case 6:if(Ie=yt.h,Zs(i),Ne=!Ie.presentationTimeline.W()&&!Ie.presentationTimeline.Tb(),!Ne)throw new We(2,9,9005,l);return I(yt,w7(i,Ie,function(Jt){Te=Te||Jt},y),7);case 7:if(N=yt.h,Zs(i),Te)throw Te;return I(yt,x7(Ie,y),8);case 8:return I(yt,G.init(),9);case 9:return Zs(i),I(yt,YA(G),10);case 10:return q=yt.h,Zs(i),Ve=C7(N,Ie,l,c,y,A),qe=Ve.Pg,Ze=Ve.Me,I(yt,q.oa.addManifests([qe]),11);case 11:if(Qe=yt.h,Zs(i),ae=Qe[0],Zs(i),Te)throw Te;return I(yt,S7(i,Ze,ae,qe,A,y,q.oa,Ie,N),12);case 12:return Zs(i),Lt=new fl("manifest",q.path.Ya,q.path.oa,ae),yt.return(QA(Lt,qe));case 3:return Y(yt),I(yt,G.destroy(),13);case 13:if(!P){yt.D(14);break}return I(yt,P.stop(),14);case 14:if(!N){yt.D(16);break}return I(yt,N.destroy(),16);case 16:J(yt,0);break;case 2:if(It=W(yt),ae==null){yt.D(18);break}return I(yt,QO(ae),18);case 18:throw Te||It}})}function S7(i,l,c,p,y,A,P,N,G){var q,ae;return Z(function(Te){switch(Te.g){case 1:if(q=function(Ie,Ne){var Ve,qe,Ze,Qe,Lt,It,yt,Jt;return Z(function(un){if(un.g==1){for(Ve=function(){Zs(i)},qe={},Ze=E(Ie),Qe=Ze.next();!Qe.done;qe={bd:qe.bd,Ab:qe.Ab},Qe=Ze.next())qe.Ab=Qe.value,qe.bd=void 0,Lt=Yz(qe.Ab,A),It=qe.Ab.i,yt=qe.Ab.h,Jt=function(dn){return function(xn){return dn.bd=xn,Promise.resolve()}}(qe),qz(y,qe.Ab.groupId,Lt,It,yt,Jt),Qz(y,qe.Ab.groupId,function(dn){return function(){var xn;return Z(function(hn){if(hn.g==1)return xn=dn.Ab.g,I(hn,A7(c,xn,{data:dn.bd},Ve),2);p=hn.h||p,U(hn)})}}(qe));return I(un,Jz(y),2)}return Ne?(Zs(i),I7(N,p,G,A),I(un,P.updateManifest(c,p),0)):un.D(0)})},ae=!1,!ZA(N)||!ae||JO(N)){Te.D(2);break}return I(Te,q(l.filter(function(Ie){return Ie.h}),!0),3);case 3:Zs(i),l=l.filter(function(Ie){return!Ie.h});case 2:if(ae){Te.D(0);break}return I(Te,q(l,!1),5);case 5:Zs(i),U(Te)}})}function QO(i){var l,c,p,y;return Z(function(A){switch(A.g){case 1:return l=new os,I(A,l.init(),2);case 2:return I(A,YA(l),3);case 3:return c=A.h,p=new fl("manifest",c.path.Ya,c.path.oa,i),I(A,l.destroy(),4);case 4:return y=new vi,I(A,y.remove(p.toString()),0)}})}function A7(i,l,c,p){var y,A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe,Ze,Qe,Lt,It,yt;return Z(function(Jt){switch(Jt.g){case 1:return y=new os,A=HA(l),P=!1,ae=0,w(Jt,2,3),I(Jt,y.init(),5);case 5:return I(Jt,YA(y),6);case 6:return G=Jt.h,I(Jt,G.oa.addSegments([c]),7);case 7:return Te=Jt.h,N=Te[0],p(),I(Jt,_7(),8);case 8:return ae=Jt.h,p(),I(Jt,G.oa.getManifests([i]),9);case 9:for(Ie=Jt.h,p(),q=Ie[0],Ne=!0,Ve=E(q.streams),qe=Ve.next();!qe.done;qe=Ve.next())for(Ze=qe.value,Qe=E(Ze.segments),Lt=Qe.next();!Lt.done;Lt=Qe.next())It=Lt.value,It.pendingSegmentRefId==A&&(It.dataKey=N,It.pendingSegmentRefId=void 0),It.pendingInitSegmentRefId==A&&(It.initSegmentKey=N,It.pendingInitSegmentRefId=void 0),It.pendingSegmentRefId&&(Ne=!1),It.pendingInitSegmentRefId&&(Ne=!1);return q.size+=c.data.byteLength,Ne&&(q.isIncomplete=!1),I(Jt,G.oa.updateManifest(i,q),10);case 10:P=!0,p();case 3:return Y(Jt),I(Jt,y.destroy(),11);case 11:tN.release(ae),J(Jt,4);break;case 2:return yt=W(Jt),I(Jt,QO(i),12);case 12:if(!G||P||!N){Jt.D(13);break}return I(Jt,G.oa.removeSegments([N],function(){}),13);case 13:throw yt;case 4:return Jt.return(q)}})}function x7(i,l){var c,p,y,A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe,Ze,Qe,Lt,It,yt,Jt,un,dn,xn,hn,Mn,Qn,Jn,ur,rr;return Z(function(Rr){switch(Rr.g){case 1:return c={width:1/0,height:1/0},gd(i,l.restrictions,c),I(Rr,ht(i,l.offline.usePersistentLicense),2);case 2:for(p=[],y=l.preferredAudioChannelCount,A=l.preferredDecodingAttributes,P=l.preferredVideoCodecs,N=l.preferredAudioCodecs,fd(i,P,N,y,A),G=E(i.variants),q=G.next();!q.done;q=G.next())ae=q.value,p.push(ql(ae));for(Te=E(i.textStreams),Ie=Te.next();!Ie.done;Ie=Te.next())Ne=Ie.value,p.push(tf(Ne));for(Ve=E(i.imageStreams),qe=Ve.next();!qe.done;qe=Ve.next())Ze=qe.value,p.push(Rp(Ze));return I(Rr,l.offline.trackSelectionCallback(p),3);case 3:for(Qe=Rr.h,Lt=i.presentationTimeline.getDuration(),It=0,yt=E(Qe),Jt=yt.next();!Jt.done;Jt=yt.next())un=Jt.value,dn=un.bandwidth*Lt/8,It+=dn;return w(Rr,4),I(Rr,l.offline.downloadSizeCallback(It),6);case 6:if(xn=Rr.h,!xn)throw new We(2,9,9014);K(Rr,5);break;case 4:throw hn=W(Rr),hn instanceof We?hn:new We(2,9,9015);case 5:for(Mn=new Set,Qn=new Set,Jn=new Set,ur=E(Qe),Jt=ur.next();!Jt.done;Jt=ur.next())rr=Jt.value,rr.type=="variant"&&Mn.add(rr.id),rr.type=="text"&&Qn.add(rr.id),rr.type=="image"&&Jn.add(rr.id);i.variants=i.variants.filter(function(ii){return Mn.has(ii.id)}),i.textStreams=i.textStreams.filter(function(ii){return Qn.has(ii.id)}),i.imageStreams=i.imageStreams.filter(function(ii){return Jn.has(ii.id)}),j7(i),U(Rr)}})}function C7(i,l,c,p,y,A){var P=m7(c,l,p),N=y.offline.progressCallback;Xz(A,function(Ne,Ve){P.size=Ve,N(P,Ne)},function(Ne,Ve){G&&y.offline.usePersistentLicense&&q==Ve&&Vn(i,"cenc",Ne)});var G=ZA(l)&&!JO(l),q=null;G&&(q=K7.get(i.i.keySystem));for(var ae=new v7,Te=E(l.textStreams),Ie=Te.next();!Ie.done;Ie=Te.next())ae.g[Ie.value.id]=52;for(Te=E(l.imageStreams),Ie=Te.next();!Ie.done;Ie=Te.next())E7(ae,Ie.value);for(Ie=E(l.variants),Te=Ie.next();!Te.done;Te=Ie.next())y7(ae,Te.value);return ae=O7(A,ae,l),A=ae.streams,ae=ae.Me,Ie=i.i,Te=y.offline.usePersistentLicense,Ie&&Te&&(Ie.initData=[]),{Pg:{creationTime:Date.now(),originalManifestUri:c,duration:l.presentationTimeline.getDuration(),size:0,expiration:i.Lc(),streams:A,sessionIds:Te?ws(i):[],drmInfo:Ie,appMetadata:p,isIncomplete:!0},Me:ae}}function ZA(i){return i.variants.some(function(l){var c=l.audio&&l.audio.encrypted;return l.video&&l.video.encrypted||c})}function JO(i){return i.variants.some(function(l){return(l.video?l.video.drmInfos:[]).concat(l.audio?l.audio.drmInfos:[]).some(function(c){return c.initData&&c.initData.length})})}function I7(i,l,c,p){if(l.expiration=c.Lc(),c=ws(c),l.sessionIds=p.offline.usePersistentLicense?c:[],ZA(i)&&p.offline.usePersistentLicense&&!c.length)throw new We(2,9,9007)}f.remove=function(i){return ex(this,R7(this,i))};function R7(i,l){var c,p,y,A,P,N;return Z(function(G){switch(G.g){case 1:if(Yv(),c=qA(l),c==null||c.g!="manifest")throw new We(2,9,9004,l);return p=c,y=new os,k(G),I(G,y.init(),4);case 4:return I(G,Vv(y,p.Ya(),p.oa()),5);case 5:return A=G.h,I(G,A.getManifests([p.key()]),6);case 6:return P=G.h,N=P[0],I(G,Promise.all([b7(i,N,y),D7(A,p,N)]),2);case 2:return Y(G),I(G,y.destroy(),8);case 8:J(G,0)}})}function ZO(i,l){for(var c=[],p=E(i.streams),y=p.next();!y.done;y=p.next())y=y.value,l&&y.type=="video"?c.push({contentType:ui(y.mimeType,y.codecs),robustness:i.drmInfo.videoRobustness}):l||y.type!="audio"||c.push({contentType:ui(y.mimeType,y.codecs),robustness:i.drmInfo.audioRobustness});return c}function b7(i,l,c){return Z(function(p){return I(p,B7(i.V,i.m.drm,c,l),0)})}function D7(i,l,c){function p(){}var y=U7(c);return QA(l,c),Promise.all([i.removeSegments(y,p),i.removeManifests([l.key()],p)])}f.eh=function(){return ex(this,P7(this))};function P7(i){var l,c,p,y,A,P,N,G,q,ae;return Z(function(Te){switch(Te.g){case 1:return Yv(),l=i.V,c=i.m.drm,p=new os,y=!1,k(Te),I(Te,p.init(),4);case 4:A=[],n7(p,function(Ie){return A.push(Ie)}),P=E(A),N=P.next();case 5:if(N.done){Te.D(2);break}return G=N.value,I(Te,G.getAll(),8);case 8:return q=Te.h,I(Te,zO(c,l,q),9);case 9:return ae=Te.h,I(Te,G.remove(ae),10);case 10:ae.length!=q.length&&(y=!0),N=P.next(),Te.D(5);break;case 2:return Y(Te),I(Te,p.destroy(),11);case 11:J(Te,3);break;case 3:return Te.return(!y)}})}f.list=function(){return ex(this,L7())};function L7(){var i,l,c;return Z(function(p){switch(p.g){case 1:return Yv(),i=[],l=new os,k(p),I(p,l.init(),4);case 4:return c=Promise.resolve(),t7(l,function(y,A){c=c.then(function(){var P;return Z(function(N){if(N.g==1)return I(N,A.getAllManifests(),2);P=N.h,P.forEach(function(G,q){var ae=QA(new fl("manifest",y.Ya,y.oa,q),G);i.push(ae)}),U(N)})})}),I(p,c,2);case 2:return Y(p),I(p,l.destroy(),6);case 6:J(p,3);break;case 3:return p.return(i)}})}function M7(i,l,c,p){var y,A,P,N,G;return Z(function(q){if(q.g==1)return y=null,A=i.V,P={networkingEngine:A,modifyManifestRequest:function(){},modifySegmentRequest:function(){},filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(ae){y=ae},isLowLatencyMode:function(){return!1},isAutoLowLatencyMode:function(){return!1},enableLowLatencyMode:function(){}},c.configure(p.manifest),Zs(i),I(q,c.start(l,P),2);if(q.g!=3)return N=q.h,Zs(i),G=eN(N),I(q,Promise.all(Pe(G,function(ae){return ae.createSegmentIndex()})),3);if(Zs(i),y)throw y;return q.return(N)})}function w7(i,l,c,p){var y;return Z(function(A){switch(A.g){case 1:return y=new Ge({Wb:i.V,onError:c,wd:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),y.configure(p.drm),I(A,Je(y,l.variants,p.offline.usePersistentLicense),2);case 2:return I(A,Sn(y),3);case 3:return I(A,Kn(y),4);case 4:return A.return(y)}})}function O7(i,l,c){var p=new Map,y=eN(c),A=new Map;y=E(y);for(var P=y.next();!P.done;P=y.next()){P=P.value;var N=N7(i,l,c,P,p);A.set(P.id,N)}for(i=E(c.variants),l=i.next();!l.done;l=i.next())l=l.value,l.audio&&A.get(l.audio.id).variantIds.push(l.id),l.video&&A.get(l.video.id).variantIds.push(l.id);return{streams:Array.from(A.values()),Me:Array.from(p.values())}}function N7(i,l,c,p,y){var A={id:p.id,originalId:p.originalId,primary:p.primary,type:p.type,mimeType:p.mimeType,codecs:p.codecs,frameRate:p.frameRate,pixelAspectRatio:p.pixelAspectRatio,hdr:p.hdr,kind:p.kind,language:p.language,label:p.label,width:p.width||null,height:p.height||null,encrypted:p.encrypted,keyIds:p.keyIds,segments:[],variantIds:[],roles:p.roles,forced:p.forced,channelsCount:p.channelsCount,audioSamplingRate:p.audioSamplingRate,spatialAudio:p.spatialAudio,closedCaptions:p.closedCaptions,tilesLayout:p.tilesLayout};return F7(p,c.presentationTimeline.ub(),function(P){var N=HA(P),G=void 0;if(!y.has(N)){var q=P.endTime-P.startTime;q=XO(l,p.id)*q,q=OO(i.fc,q),y.set(N,new MO(P,q,p.id,!1))}P.g&&(G=HA(P.g),y.has(G)||(q=.5*XO(l,p.id),q=OO(i.fc,q),y.set(G,new MO(P.g,q,p.id,!0)))),A.segments.push({pendingInitSegmentRefId:G,initSegmentKey:G?0:null,startTime:P.startTime,endTime:P.endTime,appendWindowStart:P.appendWindowStart,appendWindowEnd:P.appendWindowEnd,timestampOffset:P.timestampOffset,tilesLayout:P.tilesLayout,pendingSegmentRefId:N,dataKey:0})}),A}function F7(i,l,c){if(l=i.segmentIndex.find(l),l!=null)for(var p=i.segmentIndex.get(l);p;)c(p),p=i.segmentIndex.get(++l)}function Zs(i){if(i.N.g)throw new We(2,9,7001)}function Yv(){if(!JA())throw new We(2,9,9e3)}function ex(i,l){return Z(function(c){return c.g==1?(i.Uc.push(l),k(c),I(c,l,4)):c.g!=2?c.return(c.h):(Y(c),tt(i.Uc,l),J(c,0))})}function k7(i,l){var c=l.promise;return i.Uc.push(c),l.finally(function(){tt(i.Uc,c)})}function U7(i){var l=new Set;i=E(i.streams);for(var c=i.next();!c.done;c=i.next()){c=E(c.value.segments);for(var p=c.next();!p.done;p=c.next())p=p.value,p.initSegmentKey!=null&&l.add(p.initSegmentKey),l.add(p.dataKey)}return Array.from(l)}function B7(i,l,c,p){var y,A,P;return Z(function(N){return N.g==1?p.drmInfo?(y=r7(c),A=p.sessionIds.map(function(G){return{sessionId:G,keySystem:p.drmInfo.keySystem,licenseUri:p.drmInfo.licenseServerUri,serverCertificate:p.drmInfo.serverCertificate,audioCapabilities:ZO(p,!1),videoCapabilities:ZO(p,!0)}}),I(N,zO(l,i,A),2)):N.return():N.g!=3?(P=N.h,I(N,y.remove(P),3)):I(N,y.add(A.filter(function(G){return!P.includes(G.sessionId)})),0)})}function eN(i){for(var l=new Set,c=E(i.textStreams),p=c.next();!p.done;p=c.next())l.add(p.value);for(c=E(i.imageStreams),p=c.next();!p.done;p=c.next())l.add(p.value);for(i=E(i.variants),c=i.next();!c.done;c=i.next())c=c.value,c.audio&&l.add(c.audio),c.video&&l.add(c.video);return l}function j7(i){i.variants.map(function(A){return A.video});var l=new Set(i.variants.map(function(A){return A.audio}));i=i.textStreams;for(var c=E(l),p=c.next();!p.done;p=c.next()){p=E(l);for(var y=p.next();!y.done;y=p.next());}for(l=E(i),c=l.next();!c.done;c=l.next())for(c=E(i),p=c.next();!p.done;p=c.next());}Le("shaka.offline.Storage",vi),vi.deleteAll=function(){var i;return Z(function(l){return l.g==1?(i=new os,k(l),I(l,i7(i),2)):l.g!=5?(Y(l),I(l,i.destroy(),5)):J(l,0)})},vi.prototype.list=vi.prototype.list,vi.prototype.removeEmeSessions=vi.prototype.eh,vi.prototype.remove=vi.prototype.remove,vi.prototype.getStoreInProgress=vi.prototype.Cg,vi.prototype.store=vi.prototype.store,vi.prototype.getNetworkingEngine=vi.prototype.Mc,vi.prototype.getConfiguration=vi.prototype.getConfiguration,vi.prototype.configure=vi.prototype.configure,vi.prototype.destroy=vi.prototype.destroy,vi.support=JA;var tN=new qO,K7=new Map().set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");gA.offline=JA;function Ki(){}function nN(){for(var i=E(Xv),l=i.next();!l.done;l=i.next()){l=l.value;try{l.Tf()}catch(c){Re("Error installing polyfill!",c)}}}function Zi(i,l){for(var c={priority:l||0,Tf:i},p=E(it(Xv)),y=p.next();!y.done;y=p.next()){y=y.value;var A=y.wa;if(y.item.priority<c.priority){Xv.splice(A,0,c);return}}Xv.push(c)}Le("shaka.polyfill",Ki),Ki.register=Zi,Ki.installAll=nN;var Xv=[];function rN(){}function iN(){if(!Object.getOwnPropertyDescriptor(Element.prototype,"ariaHidden"))for(var i=E(["ariaHidden","ariaLabel","ariaPressed","ariaSelected"]),l=i.next();!l.done;l=i.next())G7(l.value)}function G7(i){var l="aria-"+i.toLowerCase().replace(/^aria/,"");Object.defineProperty(Element.prototype,i,{get:function(){return this.getAttribute(l)},set:function(c){c==null||c==null?this.removeAttribute(l):this.setAttribute(l,c)}})}Ki.Aria=rN,rN.install=iN,Zi(iN);function sN(){}function aN(){EF()}Ki.EncryptionScheme=sN,sN.install=aN,Zi(aN,-2);function oN(){}function lN(){if(o.Document){var i=Element.prototype;i.requestFullscreen=i.requestFullscreen||i.mozRequestFullScreen||i.msRequestFullscreen||i.webkitRequestFullscreen,i=Document.prototype,i.exitFullscreen=i.exitFullscreen||i.mozCancelFullScreen||i.msExitFullscreen||i.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",Gd),document.addEventListener("webkitfullscreenerror",Gd),document.addEventListener("mozfullscreenchange",Gd),document.addEventListener("mozfullscreenerror",Gd),document.addEventListener("MSFullscreenChange",Gd),document.addEventListener("MSFullscreenError",Gd)}}function Gd(i){var l=i.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),c=document.createEvent("Event");c.initEvent(l,i.bubbles,i.cancelable),i.target.dispatchEvent(c)}Ki.Fullscreen=oN,oN.install=lN,Zi(lN);function uN(){}function cN(){}Ki.MathRound=uN,uN.install=cN,Zi(cN);function tx(){}function fN(){(zl()||Yl()||pi("PlayStation 5")||!navigator.mediaCapabilities)&&(navigator.mediaCapabilities||(navigator.mediaCapabilities={}),dN=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=W7)}function W7(i){var l,c,p,y,A,P,N,G,q,ae,Te,Ie,Ne,Ve,qe,Ze;return Z(function(Qe){switch(Qe.g){case 1:if(l={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:i},!i)return Qe.return(l);if(i.type=="media-source"){if(!vs()||i.video&&(c=i.video.contentType,p=MediaSource.isTypeSupported(c),!p)||i.audio&&(y=i.audio.contentType,A=MediaSource.isTypeSupported(y),!A))return Qe.return(l)}else if(i.type=="file"){if(i.video&&(P=i.video.contentType,N=Da(P),!N)||i.audio&&(G=i.audio.contentType,q=Da(G),!q))return Qe.return(l)}else return Qe.return(l);return i.keySystemConfiguration?(ae=i.keySystemConfiguration,Te=[],Ie=[],ae.audio&&(Ne={robustness:ae.audio.robustness||"",contentType:i.audio.contentType},Te.push(Ne)),ae.video&&(Ve={robustness:ae.video.robustness||"",contentType:i.video.contentType},Ie.push(Ve)),qe={initDataTypes:[ae.initDataType],distinctiveIdentifier:ae.distinctiveIdentifier,persistentState:ae.persistentState,sessionTypes:ae.sessionTypes},Te.length&&(qe.audioCapabilities=Te),Ie.length&&(qe.videoCapabilities=Ie),w(Qe,3),I(Qe,navigator.requestMediaKeySystemAccess(ae.keySystem,[qe]),5)):(l.supported=!0,Qe.return(Promise.resolve(l)));case 5:Ze=Qe.h,K(Qe,4);break;case 3:W(Qe);case 4:Ze&&(l.supported=!0,l.keySystemAccess=Ze);case 2:return Qe.return(l)}})}Ki.MediaCapabilities=tx,tx.install=fN;var dN=null;tx.originalMcap=dN,Zi(fN,-1);function hN(){}function pN(){var i=ud();o.MediaSource&&(o.cast&&cast.__platform__&&cast.__platform__.canDisplayType?z7():i?(V7(),12>=i?(gN(),H7()):gN()):(pi("Tizen 2")||pi("Tizen 3")||pi("Tizen 4"))&&$7()),o.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&Y7()}function gN(){var i=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(l){for(var c=[],p=0;p<arguments.length;++p)c[p]=arguments[p];return c=i.apply(this,c),c.abort=function(){},c}}function H7(){var i=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(l,c){return i.call(this,l,c-.001)}}function V7(){var i=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(l){return l.split(/ *; */)[0].split("/")[1].toLowerCase()=="mp2t"?!1:i(l)}}function $7(){var i=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(l){return Vi(l)!="opus"&&i(l)}}function z7(){var i=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(l){var c=l.split(/ *; */);return c.shift(),c.some(function(p){return p.startsWith("codecs=")})?cast.__platform__.canDisplayType(l):i(l)}}function Y7(){var i=MediaSource.isTypeSupported;pi("Web0S")||(MediaSource.isTypeSupported=function(l){var c=l.split(/ *; */),p=c.findIndex(function(P){return P.startsWith("codecs=")});if(0>p)return i(l);var y=c[p].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),A=y.findIndex(function(P){return P.startsWith("vp09")});return 0<=A&&(y[A]="vp9",c[p]='codecs="'+y.join(",")+'"',l=c.join("; ")),i(l)})}Ki.MediaSource=hN,hN.install=pN,Zi(pN);function mN(){}function vN(){screen.orientation||o.orientation!=null&&X7()}function X7(){function i(){switch(o.orientation){case-90:l.type="landscape-secondary",l.angle=270;break;case 0:l.type="portrait-primary",l.angle=0;break;case 90:l.type="landscape-primary",l.angle=90;break;case 180:l.type="portrait-secondary",l.angle=180}}var l=new qv;screen.orientation=l,i(),o.addEventListener("orientationchange",function(){i();var c=new De("change");l.dispatchEvent(c)})}Ki.Orientation=mN,mN.install=vN;function qv(){Ce.call(this),this.type="",this.angle=0}D(qv,Ce),qv.prototype.lock=function(i){function l(p){return screen.lockOrientation?screen.lockOrientation(p):screen.mozLockOrientation?screen.mozLockOrientation(p):screen.msLockOrientation?screen.msLockOrientation(p):!1}var c=!1;switch(i){case"natural":c=l("default");break;case"any":c=!0,this.unlock();break;default:c=l(i)}return c?Promise.resolve():(i=Error("screen.orientation.lock() is not available on this device"),i.name="NotSupportedError",i.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(i))},qv.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},Zi(vN);function yN(){}function EN(){o.HTMLVideoElement&&o.WebKitMediaKeys&&(delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Q7,o.MediaKeys=Jv,o.MediaKeySystemAccess=Qv,navigator.requestMediaKeySystemAccess=q7)}function q7(i,l){try{var c=new Qv(i,l);return Promise.resolve(c)}catch(p){return Promise.reject(p)}}function Q7(i){var l=this.mediaKeys;return l&&l!=i&&_N(l,null),delete this.mediaKeys,(this.mediaKeys=i)?_N(i,this):Promise.resolve()}function J7(i){if(i=er(i.initData),Ii(i).getUint32(0,!0)+4!=i.byteLength)throw new RangeError("Malformed FairPlay init data");i=Xn(i.subarray(4),!0),i=hi(i);var l=new Event("encrypted");l.initDataType="skd",l.initData=Hi(i),this.dispatchEvent(l)}Ki.PatchedMediaKeysApple=yN,yN.install=EN;function Qv(i,l){if(this.keySystem=i,i.startsWith("com.apple.fps"))for(var c=E(l),p=c.next();!p.done;p=c.next()){var y=p.value;if(y.persistentState=="required")p=null;else{p={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:y.initDataTypes,sessionTypes:["temporary"],label:y.label};var A=!1,P=!1;if(y.audioCapabilities)for(var N=E(y.audioCapabilities),G=N.next();!G.done;G=N.next())G=G.value,G.contentType&&(A=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,G.contentType.split(";")[0])&&(p.audioCapabilities.push(G),P=!0));if(y.videoCapabilities)for(y=E(y.videoCapabilities),G=y.next();!G.done;G=y.next())N=G.value,N.contentType&&(A=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,N.contentType.split(";")[0])&&(p.videoCapabilities.push(N),P=!0));A||(P=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),p=P?p:null}if(p){this.g=p;return}}throw c=Error("Unsupported keySystem"),c.name="NotSupportedError",c.code=DOMException.NOT_SUPPORTED_ERR,c}Qv.prototype.createMediaKeys=function(){var i=new Jv(this.keySystem);return Promise.resolve(i)},Qv.prototype.getConfiguration=function(){return this.g};function Jv(i){this.g=new WebKitMediaKeys(i),this.h=new _r}Jv.prototype.createSession=function(i){if(i=i||"temporary",i!="temporary")throw new TypeError("Session type "+i+" is unsupported on this platform.");return new nx(this.g)},Jv.prototype.setServerCertificate=function(){return Promise.resolve(!1)};function _N(i,l){if(i.h.Yb(),!l)return Promise.resolve();i.h.o(l,"webkitneedkey",J7);try{return ff(l,HTMLMediaElement.HAVE_METADATA,i.h,function(){l.webkitSetMediaKeys(i.g)}),Promise.resolve()}catch(c){return Promise.reject(c)}}function nx(i){Ce.call(this),this.j=null,this.l=i,this.i=this.g=null,this.h=new _r,this.sessionId="",this.expiration=NaN,this.closed=new Rt,this.keyStatuses=new TN}D(nx,Ce),f=nx.prototype,f.generateRequest=function(i,l){var c=this;this.g=new Rt;try{var p=this.l.createSession("video/mp4",er(l));this.j=p,this.sessionId=p.sessionId||"",this.h.o(this.j,"webkitkeymessage",function(y){c.g&&(c.g.resolve(),c.g=null),y=new Map().set("messageType",c.keyStatuses.g==null?"license-request":"license-renewal").set("message",Hi(y.message)),y=new De("message",y),c.dispatchEvent(y)}),this.h.o(p,"webkitkeyadded",function(){c.i&&(Zv(c,"usable"),c.i.resolve(),c.i=null)}),this.h.o(p,"webkitkeyerror",function(){var y=Error("EME PatchedMediaKeysApple key error");if(y.errorCode=c.j.error,c.g!=null)c.g.reject(y),c.g=null;else if(c.i!=null)c.i.reject(y),c.i=null;else switch(c.j.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:Zv(c,"output-not-allowed");break;default:Zv(c,"internal-error")}}),Zv(this,"status-pending")}catch(y){this.g.reject(y)}return this.g},f.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},f.update=function(i){this.i=new Rt;try{this.j.update(er(i))}catch(l){this.i.reject(l)}return this.i},f.close=function(){try{this.j.close(),this.closed.resolve(),this.h.Yb()}catch(i){this.closed.reject(i)}return this.closed},f.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};function Zv(i,l){var c=i.keyStatuses;c.size=l==null?0:1,c.g=l,c=new De("keystatuseschange"),i.dispatchEvent(c)}function TN(){this.size=0,this.g=void 0}f=TN.prototype,f.forEach=function(i){this.g&&i(this.g,xd.value())},f.get=function(i){if(this.has(i))return this.g},f.has=function(i){var l=xd.value();return!!(this.g&&Wi(i,l))},f.entries=function(){},f.keys=function(){},f.values=function(){},Zi(EN);function SN(){}function AN(){!o.HTMLVideoElement||!o.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,o.MediaKeys=ty,o.MediaKeySystemAccess=ey,navigator.requestMediaKeySystemAccess=Z7,HTMLMediaElement.prototype.setMediaKeys=t9)}function Z7(i,l){try{var c=new ey(i,l);return Promise.resolve(c)}catch(p){return Promise.reject(p)}}function e9(i){if(i.initData){var l=new CustomEvent("encrypted");l.initDataType="cenc",l.initData=Hi(E$(i.initData)),this.dispatchEvent(l)}}Ki.PatchedMediaKeysMs=SN,SN.install=AN;function ey(i,l){this.keySystem=i;for(var c=!1,p=E(l),y=p.next();!y.done;y=p.next()){y=y.value;var A={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:y.initDataTypes,sessionTypes:["temporary"],label:y.label},P=!1;if(y.audioCapabilities)for(var N=E(y.audioCapabilities),G=N.next();!G.done;G=N.next())G=G.value,G.contentType&&(P=!0,MSMediaKeys.isTypeSupported(this.keySystem,G.contentType.split(";")[0])&&(A.audioCapabilities.push(G),c=!0));if(y.videoCapabilities)for(N=E(y.videoCapabilities),G=N.next();!G.done;G=N.next())G=G.value,G.contentType&&(P=!0,MSMediaKeys.isTypeSupported(this.keySystem,G.contentType.split(";")[0])&&(A.videoCapabilities.push(G),c=!0));if(P||(c=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),y.persistentState=="required"&&(c=!1),c){this.g=A;return}}throw c=Error("Unsupported keySystem"),c.name="NotSupportedError",c.code=DOMException.NOT_SUPPORTED_ERR,c}ey.prototype.createMediaKeys=function(){var i=new ty(this.keySystem);return Promise.resolve(i)},ey.prototype.getConfiguration=function(){return this.g};function t9(i){var l=this.mediaKeys;return l&&l!=i&&xN(l,null),delete this.mediaKeys,(this.mediaKeys=i)?xN(i,this):Promise.resolve()}function ty(i){this.g=new MSMediaKeys(i),this.h=new _r}ty.prototype.createSession=function(i){if(i=i||"temporary",i!="temporary")throw new TypeError("Session type "+i+" is unsupported on this platform.");return new rx(this.g)},ty.prototype.setServerCertificate=function(){return Promise.resolve(!1)};function xN(i,l){if(i.h.Yb(),!l)return Promise.resolve();i.h.o(l,"msneedkey",e9);try{return ff(l,HTMLMediaElement.HAVE_METADATA,i.h,function(){l.msSetMediaKeys(i.g)}),Promise.resolve()}catch(c){return Promise.reject(c)}}function rx(i){Ce.call(this),this.j=null,this.l=i,this.i=this.g=null,this.h=new _r,this.sessionId="",this.expiration=NaN,this.closed=new Rt,this.keyStatuses=new CN}D(rx,Ce),f=rx.prototype,f.generateRequest=function(i,l){var c=this;this.g=new Rt;try{this.j=this.l.createSession("video/mp4",er(l),null),this.h.o(this.j,"mskeymessage",function(p){c.g&&(c.g.resolve(),c.g=null),p=new Map().set("messageType",c.keyStatuses.g==null?"license-request":"license-renewal").set("message",Hi(p.message)),p=new De("message",p),c.dispatchEvent(p)}),this.h.o(this.j,"mskeyadded",function(){c.g?(ug(c,"usable"),c.g.resolve(),c.g=null):c.i&&(ug(c,"usable"),c.i.resolve(),c.i=null)}),this.h.o(this.j,"mskeyerror",function(){var p=Error("EME PatchedMediaKeysMs key error");if(p.errorCode=c.j.error,c.g!=null)c.g.reject(p),c.g=null;else if(c.i!=null)c.i.reject(p),c.i=null;else switch(c.j.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:ug(c,"output-not-allowed");break;default:ug(c,"internal-error")}}),ug(this,"status-pending")}catch(p){this.g.reject(p)}return this.g},f.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},f.update=function(i){this.i=new Rt;try{this.j.update(er(i))}catch(l){this.i.reject(l)}return this.i},f.close=function(){try{this.j.close(),this.closed.resolve(),this.h.Yb()}catch(i){this.closed.reject(i)}return this.closed},f.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};function ug(i,l){var c=i.keyStatuses;c.size=l==null?0:1,c.g=l,c=new De("keystatuseschange"),i.dispatchEvent(c)}function CN(){this.size=0,this.g=void 0}f=CN.prototype,f.forEach=function(i){this.g&&i(this.g,xd.value())},f.get=function(i){if(this.has(i))return this.g},f.has=function(i){var l=xd.value();return!!(this.g&&Wi(i,l))},f.entries=function(){},f.keys=function(){},f.values=function(){},Zi(AN);function IN(){}function RN(){!o.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(navigator.requestMediaKeySystemAccess=n9,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=r9,o.MediaKeys=ix,o.MediaKeySystemAccess=sx)}function n9(){return Promise.reject(Error("The key system specified is not supported."))}function r9(i){return i==null?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}Ki.PatchedMediaKeysNop=IN,IN.install=RN;function ix(){throw new TypeError("Illegal constructor.")}ix.prototype.createSession=function(){},ix.prototype.setServerCertificate=function(){};function sx(){throw this.keySystem="",new TypeError("Illegal constructor.")}sx.prototype.getConfiguration=function(){},sx.prototype.createMediaKeys=function(){},Zi(RN,-10);function bN(){}function DN(){if(!(!o.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)cx="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;navigator.requestMediaKeySystemAccess=i9,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=s9,o.MediaKeys=ry,o.MediaKeySystemAccess=ny}}function ax(i){var l=cx;return l?l+i.charAt(0).toUpperCase()+i.slice(1):i}function i9(i,l){try{var c=new ny(i,l);return Promise.resolve(c)}catch(p){return Promise.reject(p)}}function s9(i){var l=this.mediaKeys;return l&&l!=i&&PN(l,null),delete this.mediaKeys,(this.mediaKeys=i)&&PN(i,this),Promise.resolve()}Ki.PatchedMediaKeysWebkit=bN,bN.install=DN;function ny(i,l){this.g=this.keySystem=i;var c=!1;i=="org.w3.clearkey"&&(this.g="webkit-org.w3.clearkey",c=!1);var p=!1,y=document.getElementsByTagName("video");y=y.length?y[0]:document.createElement("video");for(var A=E(l),P=A.next();!P.done;P=A.next()){P=P.value;var N={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:P.initDataTypes,sessionTypes:["temporary"],label:P.label},G=!1;if(P.audioCapabilities)for(var q=E(P.audioCapabilities),ae=q.next();!ae.done;ae=q.next())ae=ae.value,ae.contentType&&(G=!0,y.canPlayType(ae.contentType.split(";")[0],this.g)&&(N.audioCapabilities.push(ae),p=!0));if(P.videoCapabilities)for(q=E(P.videoCapabilities),ae=q.next();!ae.done;ae=q.next())ae=ae.value,ae.contentType&&(G=!0,y.canPlayType(ae.contentType,this.g)&&(N.videoCapabilities.push(ae),p=!0));if(G||(p=y.canPlayType("video/mp4",this.g)||y.canPlayType("video/webm",this.g)),P.persistentState=="required"&&(c?(N.persistentState="required",N.sessionTypes=["persistent-license"]):p=!1),p){this.h=N;return}}throw c="Unsupported keySystem",(i=="org.w3.clearkey"||i=="com.widevine.alpha")&&(c="None of the requested configurations were supported."),c=Error(c),c.name="NotSupportedError",c.code=DOMException.NOT_SUPPORTED_ERR,c}ny.prototype.createMediaKeys=function(){var i=new ry(this.g);return Promise.resolve(i)},ny.prototype.getConfiguration=function(){return this.h};function ry(i){this.l=i,this.g=null,this.h=new _r,this.i=[],this.j=new Map}function PN(i,l){i.g=l,i.h.Yb();var c=cx;l&&(i.h.o(l,c+"needkey",function(p){var y=new CustomEvent("encrypted");y.initDataType="cenc",y.initData=Hi(p.initData),i.g.dispatchEvent(y)}),i.h.o(l,c+"keymessage",function(p){var y=ox(i,p.sessionId);y&&(p=new Map().set("messageType",y.keyStatuses.g==null?"licenserequest":"licenserenewal").set("message",p.message),p=new De("message",p),y.h&&(y.h.resolve(),y.h=null),y.dispatchEvent(p))}),i.h.o(l,c+"keyadded",function(p){(p=ox(i,p.sessionId))&&(iy(p,"usable"),p.g&&p.g.resolve(),p.g=null)}),i.h.o(l,c+"keyerror",function(p){var y=ox(i,p.sessionId);y&&y.handleError(p)}))}ry.prototype.createSession=function(i){if(i=i||"temporary",i!="temporary"&&i!="persistent-license")throw new TypeError("Session type "+i+" is unsupported on this platform.");var l=this.g||document.createElement("video");return l.src||(l.src="about:blank"),i=new lx(l,this.l,i),this.i.push(i),i},ry.prototype.setServerCertificate=function(){return Promise.resolve(!1)};function ox(i,l){var c=i.j.get(l);return c||((c=i.i.shift())?(c.sessionId=l,i.j.set(l,c),c):null)}function lx(i,l,c){Ce.call(this),this.j=i,this.s=!1,this.g=this.h=null,this.i=l,this.l=c,this.sessionId="",this.expiration=NaN,this.closed=new Rt,this.keyStatuses=new MN}D(lx,Ce),f=lx.prototype,f.handleError=function(i){var l=Error("EME v0.1b key error"),c=i.errorCode;c.systemCode=i.systemCode,l.errorCode=c,!i.sessionId&&this.h?(i.systemCode==45&&(l.message="Unsupported session type."),this.h.reject(l),this.h=null):i.sessionId&&this.g?(this.g.reject(l),this.g=null):(l=i.systemCode,i.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?iy(this,"output-restricted"):l==1?iy(this,"expired"):iy(this,"internal-error"))};function LN(i,l,c){if(i.s)return Promise.reject(Error("The session is already initialized."));i.s=!0;try{if(i.l=="persistent-license")if(c)var p=er(hi("LOAD_SESSION|"+c));else{var y=hi("PERSISTENT|");p=Hl(y,l)}else p=er(l)}catch(P){return Promise.reject(P)}i.h=new Rt;var A=ax("generateKeyRequest");try{i.j[A](i.i,p)}catch(P){if(P.name!="InvalidStateError")return i.h=null,Promise.reject(P);new kn(function(){try{i.j[A](i.i,p)}catch(N){i.h.reject(N),i.h=null}}).U(.01)}return i.h}function ux(i,l,c){if(i.g)i.g.then(function(){return ux(i,l,c)}).catch(function(){return ux(i,l,c)});else{if(i.g=l,i.i=="webkit-org.w3.clearkey"){var p=Cn(c),y=JSON.parse(p);y.keys[0].kty!="oct"&&(i.g.reject(Error("Response is not a valid JSON Web Key Set.")),i.g=null),p=Xa(y.keys[0].k),y=Xa(y.keys[0].kid)}else p=er(c),y=null;var A=ax("addKey");try{i.j[A](i.i,p,y,i.sessionId)}catch(P){i.g.reject(P),i.g=null}}}function iy(i,l){var c=i.keyStatuses;c.size=l==null?0:1,c.g=l,c=new De("keystatuseschange"),i.dispatchEvent(c)}f.generateRequest=function(i,l){return LN(this,l,null)},f.load=function(i){return this.l=="persistent-license"?LN(this,null,i):Promise.reject(Error("Not a persistent session."))},f.update=function(i){var l=new Rt;return ux(this,l,i),l},f.close=function(){if(this.l!="persistent-license"){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var i=ax("cancelKeyRequest");try{this.j[i](this.i,this.sessionId)}catch{}}return this.closed.resolve(),this.closed},f.remove=function(){return this.l!="persistent-license"?Promise.reject(Error("Not a persistent session.")):this.close()};function MN(){this.size=0,this.g=void 0}f=MN.prototype,f.forEach=function(i){this.g&&i(this.g,xd.value())},f.get=function(i){if(this.has(i))return this.g},f.has=function(i){var l=xd.value();return!!(this.g&&Wi(i,l))},f.entries=function(){},f.keys=function(){},f.values=function(){};var cx="";Zi(DN);function wN(){}function ON(){if(o.HTMLVideoElement){var i=HTMLVideoElement.prototype;i.requestPictureInPicture&&document.exitPictureInPicture||!i.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,i.requestPictureInPicture=o9,Object.defineProperty(i,"disablePictureInPicture",{get:u9,set:c9,enumerable:!0,configurable:!0}),document.exitPictureInPicture=l9,document.addEventListener("webkitpresentationmodechanged",a9,!0))}}function a9(i){if(i=i.target,i.webkitPresentationMode=="picture-in-picture"){document.pictureInPictureElement=i;var l=new Event("enterpictureinpicture");i.dispatchEvent(l)}else document.pictureInPictureElement==i&&(document.pictureInPictureElement=null),l=new Event("leavepictureinpicture"),i.dispatchEvent(l)}function o9(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function l9(){var i=document.pictureInPictureElement;return i?(i.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function u9(){return this.hasAttribute("disablePictureInPicture")?!0:!this.webkitSupportsPresentationMode("picture-in-picture")}function c9(i){i?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}Ki.PiPWebkit=wN,wN.install=ON,Zi(ON);function NN(){}function FN(){o.crypto&&("randomUUID"in o.crypto||(o.crypto.randomUUID=f9))}function f9(){var i=URL.createObjectURL(new Blob),l=i.toString();return URL.revokeObjectURL(i),l.substr(l.lastIndexOf("/")+1)}Ki.RandomUUID=NN,NN.install=FN,Zi(FN);function kN(){}function UN(){navigator.storage&&navigator.storage.estimate||!navigator.webkitTemporaryStorage||!navigator.webkitTemporaryStorage.queryUsageAndQuota||("storage"in navigator||(navigator.storage={}),navigator.storage.estimate=d9)}function d9(){return new Promise(function(i,l){navigator.webkitTemporaryStorage.queryUsageAndQuota(function(c,p){i({usage:c,quota:p})},l)})}Ki.StorageEstimate=kN,kN.install=UN,Zi(UN);function BN(){}function jN(){if(o.HTMLMediaElement){var i=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var l=i.apply(this);return l&&l.catch(function(){}),l}}}Ki.VideoPlayPromise=BN,BN.install=jN,Zi(jN);function KN(){}function GN(){if(o.HTMLVideoElement){var i=HTMLVideoElement.prototype;!i.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in i&&(i.getVideoPlaybackQuality=h9)}}function h9(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}Ki.VideoPlaybackQuality=KN,KN.install=GN,Zi(GN);function WN(){}function HN(){if(!o.VTTCue&&o.TextTrackCue){var i=null,l=TextTrackCue.length;if(l==3)i=fx;else if(l==6)i=p9;else{try{var c=!!fx(1,2,"")}catch{c=!1}c&&(i=fx)}i&&(o.VTTCue=function(p,y,A){return i(p,y,A)})}}function fx(i,l,c){return new o.TextTrackCue(i,l,c)}function p9(i,l,c){return new o.TextTrackCue(i+"-"+l+"-"+c,i,l,c)}Ki.VTTCue=WN,WN.install=HN,Zi(HN);function rc(){}rc.prototype.parseInit=function(){},rc.prototype.parseMedia=function(i,l){var c=null,p=[],y=Cn(i).split(/\r?\n/);y=E(y);for(var A=y.next();!A.done;A=y.next())if((A=A.value)&&!/^\s+$/.test(A)&&(A=g9.exec(A))){var P=m9.exec(A[1]);P=60*parseInt(P[1],10)+parseFloat(P[2].replace(",",".")),A=new ft(P,l.segmentEnd?l.segmentEnd:P+2,A[2]),c&&(c.endTime=P,p.push(c)),c=A}return c&&p.push(c),p},Le("shaka.text.LrcTextParser",rc),rc.prototype.parseMedia=rc.prototype.parseMedia,rc.prototype.parseInit=rc.prototype.parseInit;var g9=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,m9=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;Hr["application/x-subtitle-lrc"]=function(){return new rc};function fu(){}fu.prototype.parseInit=function(){},fu.prototype.parseMedia=function(i,l){var c=Cn(i),p=[],y=new DOMParser,A=null;if(c=="")return p;try{A=y.parseFromString(c,"text/xml")}catch{throw new We(2,2,2005,"Failed to parse TTML.")}if(A){if(c=A.getElementsByTagName("parsererror")[0])throw new We(2,2,2005,c.textContent);var P=A.getElementsByTagName("tt")[0];if(!P)throw new We(2,2,2005,"TTML does not contain <tt> tag.");if(A=P.getElementsByTagName("body")[0],!A)return[];var N=su(P,cg,"frameRate"),G=su(P,cg,"subFrameRate"),q=su(P,cg,"frameRateMultiplier"),ae=su(P,cg,"tickRate"),Te=su(P,cg,"cellResolution");if(c=P.getAttribute("xml:space")||"default",y=su(P,oy,"extent"),c!="default"&&c!="preserve")throw new We(2,2,2005,"Invalid xml:space value: "+c);c=c=="default",N=new E9(N,G,q,ae),Te=Te&&(Te=/^(\d+) (\d+)$/.exec(Te))?{columns:parseInt(Te[1],10),rows:parseInt(Te[2],10)}:null,G=(G=P.getElementsByTagName("metadata")[0])?_$(G):[],q=Array.from(P.getElementsByTagName("style")),P=Array.from(P.getElementsByTagName("region")),ae=[];for(var Ie=E(P),Ne=Ie.next();!Ne.done;Ne=Ie.next()){var Ve=Ne.value;Ne=new qs;var qe=Ve.getAttribute("xml:id");if(qe){Ne.id=qe;var Ze=null;y&&(Ze=gx.exec(y)||mx.exec(y)),qe=Ze?Number(Ze[1]):null,Ze=Ze?Number(Ze[2]):null;var Qe,Lt;(Qe=sy(Ve,q,"extent"))&&(Qe=(Lt=gx.exec(Qe))||mx.exec(Qe),Qe!=null&&(Ne.width=Number(Qe[1]),Ne.height=Number(Qe[2]),Lt||(qe!=null&&(Ne.width=100*Ne.width/qe),Ze!=null&&(Ne.height=100*Ne.height/Ze)),Ne.widthUnits=Lt||qe!=null?ji:0,Ne.heightUnits=Lt||Ze!=null?ji:0)),(Ve=sy(Ve,q,"origin"))&&(Qe=(Lt=gx.exec(Ve))||mx.exec(Ve),Qe!=null&&(Ne.viewportAnchorX=Number(Qe[1]),Ne.viewportAnchorY=Number(Qe[2]),Lt||(Ze!=null&&(Ne.viewportAnchorY=100*Ne.viewportAnchorY/Ze),qe!=null&&(Ne.viewportAnchorX=100*Ne.viewportAnchorX/qe)),Ne.viewportAnchorUnits=Lt||qe!=null?ji:0))}else Ne=null;Ne&&ae.push(Ne)}if(Yr(A,"p").length)throw new We(2,2,2001,"<p> can only be inside <div> in TTML");for(y=E(Yr(A,"div")),Ie=y.next();!Ie.done;Ie=y.next())if(Yr(Ie.value,"span").length)throw new We(2,2,2001,"<span> can only be inside <p> in TTML");(A=VN(A,l.periodStart,N,G,q,P,ae,c,Te,null,!1))&&p.push(A)}return p};function VN(i,l,c,p,y,A,P,N,G,q,ae){var Te=i.parentNode;if(i.nodeType==Node.COMMENT_NODE)return null;if(i.nodeType==Node.TEXT_NODE){if(!ae)return null;var Ie=document.createElement("span");Ie.textContent=i.textContent}else Ie=i;for(var Ne=null,Ve=E(A9),qe=Ve.next();!qe.done&&!(Ne=ay(Ie,"backgroundImage",p,"#",qe.value)[0]);qe=Ve.next());if(Ve=ae,(i.nodeName=="p"||Ne)&&(ae=!0),N=(Ie.getAttribute("xml:space")||(N?"default":"preserve"))=="default",qe=Array.from(Ie.childNodes).every(function(yt){return yt.nodeType==Node.TEXT_NODE}),i=[],!qe)for(var Ze=E(Ie.childNodes),Qe=Ze.next();!Qe.done;Qe=Ze.next())(Qe=VN(Qe.value,l,c,p,y,A,P,N,G,Ie,ae))&&i.push(Qe);p=q!=null,Ze=/\S/.test(Ie.textContent);var Lt=Ie.hasAttribute("begin")||Ie.hasAttribute("end")||Ie.hasAttribute("dur");if(!(Lt||Ze||Ie.tagName=="br"||i.length!=0||p&&!N))return null;for(Qe=YN(Ie,c),Ze=Qe.start,Qe=Qe.end;Te&&Te.nodeType==Node.ELEMENT_NODE&&Te.tagName!="tt";)Qe=y9(Te,c,Ze,Qe),Ze=Qe.start,Qe=Qe.end,Te=Te.parentNode;if(Ze==null&&(Ze=0),Ze+=l,Qe=Qe==null?1/0:Qe+l,!Lt&&0<i.length)for(Ze=1/0,Qe=0,l=E(i),c=l.next();!c.done;c=l.next())c=c.value,Ze=Math.min(Ze,c.startTime),Qe=Math.max(Qe,c.endTime);if(Ie.tagName=="br")return y=new ft(Ze,Qe,""),y.lineBreak=!0,y;if(l="",qe&&(l=Ie.textContent,N&&(l=l.trim(),l=l.replace(/\s+/g," "))),l=new ft(Ze,Qe,l),l.nestedCues=i,ae||(l.isContainer=!0),G&&(l.cellResolution=G),G=ay(Ie,"region",A,"")[0],Ie.hasAttribute("region")&&G&&G.getAttribute("xml:id")){var It=G.getAttribute("xml:id");l.region=P.filter(function(yt){return yt.id==It})[0]}return P=G,q&&p&&!Ie.getAttribute("region")&&!Ie.getAttribute("style")&&(P=ay(q,"region",A,"")[0]),v9(l,Ie,P,Ne,y,Ve,i.length==0),l}function v9(i,l,c,p,y,A,P){if(A=A||P,ls(l,c,y,"direction",A)=="rtl"&&(i.direction="rtl"),P=ls(l,c,y,"writingMode",A),P=="tb"||P=="tblr"?i.writingMode="vertical-lr":P=="tbrl"?i.writingMode="vertical-rl":P=="rltb"||P=="rl"?i.direction="rtl":P&&(i.direction=Br),(P=ls(l,c,y,"textAlign",!0))?(i.positionAlign=S9[P],i.lineAlign=T9[P],i.textAlign=On[P.toUpperCase()]):i.textAlign="start",(P=ls(l,c,y,"displayAlign",!0))&&(i.displayAlign=Un[P.toUpperCase()]),(P=ls(l,c,y,"color",A))&&(i.color=P),(P=ls(l,c,y,"backgroundColor",A))&&(i.backgroundColor=P),(P=ls(l,c,y,"border",A))&&(i.border=P),(P=ls(l,c,y,"fontFamily",A))&&(i.fontFamily=P),(P=ls(l,c,y,"fontWeight",A))&&P=="bold"&&(i.fontWeight=700),P=ls(l,c,y,"wrapOption",A),i.wrapLine=!(P&&P=="noWrap"),(P=ls(l,c,y,"lineHeight",A))&&P.match(Wd)&&(i.lineHeight=P),(P=ls(l,c,y,"fontSize",A))&&(P.match(Wd)||P.match(_9))&&(i.fontSize=P),(P=ls(l,c,y,"fontStyle",A))&&(i.fontStyle=Ds[P.toUpperCase()]),p){P=p.getAttribute("imageType")||p.getAttribute("imagetype");var N=p.getAttribute("encoding");p=p.textContent.trim(),P=="PNG"&&N=="Base64"&&p&&(i.backgroundImage="data:image/png;base64,"+p)}(p=ls(l,c,y,"textOutline",A))&&(p=p.split(" "),p[0].match(Wd)?i.textStrokeColor=i.color:(i.textStrokeColor=p[0],p.shift()),p[0]&&p[0].match(Wd)?i.textStrokeWidth=p[0]:i.textStrokeColor=""),(p=ls(l,c,y,"letterSpacing",A))&&p.match(Wd)&&(i.letterSpacing=p),(p=ls(l,c,y,"linePadding",A))&&p.match(Wd)&&(i.linePadding=p),(A=ls(l,c,y,"opacity",A))&&(i.opacity=parseFloat(A)),(c=sy(c,y,"textDecoration"))&&$N(i,c),(l=dx(l,y,"textDecoration"))&&$N(i,l)}function $N(i,l){for(var c=E(l.split(" ")),p=c.next();!p.done;p=c.next())switch(p.value){case"underline":i.textDecoration.includes("underline")||i.textDecoration.push("underline");break;case"noUnderline":i.textDecoration.includes("underline")&&tt(i.textDecoration,"underline");break;case"lineThrough":i.textDecoration.includes("lineThrough")||i.textDecoration.push("lineThrough");break;case"noLineThrough":i.textDecoration.includes("lineThrough")&&tt(i.textDecoration,"lineThrough");break;case"overline":i.textDecoration.includes("overline")||i.textDecoration.push("overline");break;case"noOverline":i.textDecoration.includes("overline")&&tt(i.textDecoration,"overline")}}function ls(i,l,c,p,y){return y=y===void 0?!0:y,(i=dx(i,c,p))?i:y?sy(l,c,p):null}function sy(i,l,c){if(!i)return null;var p=su(i,oy,c);return p||zN(i,l,c)}function dx(i,l,c){var p=su(i,oy,c);return p||zN(i,l,c)}function zN(i,l,c){i=ay(i,"style",l,"");for(var p=null,y=0;y<i.length;y++){var A=gf(i[y],"urn:ebu:tt:style",c);A||(A=su(i[y],oy,c)),A||(A=dx(i[y],l,c)),A&&(p=A)}return p}function ay(i,l,c,p,y){var A=[];if(!i||1>c.length)return A;var P=i;for(i=null;P&&!(i=y?gf(P,y,l):P.getAttribute(l))&&(P=P.parentNode,P instanceof Element););if(l=i){for(l=E(l.split(" ")),y=l.next();!y.done;y=l.next())for(y=y.value,i=E(c),P=i.next();!P.done;P=i.next())if(P=P.value,p+P.getAttribute("xml:id")==y){A.push(P);break}}return A}function y9(i,l,c,p){return i=YN(i,l),c==null?c=i.start:i.start!=null&&(c+=i.start),p==null?p=i.end:i.start!=null&&(p+=i.start),{start:c,end:p}}function YN(i,l){var c=hx(i.getAttribute("begin"),l),p=hx(i.getAttribute("end"),l),y=hx(i.getAttribute("dur"),l);return p==null&&y!=null&&(p=c+y),{start:c,end:p}}function hx(i,l){var c=null;if(XN.test(i)){c=XN.exec(i);var p=Number(c[1]),y=Number(c[2]),A=Number(c[3]),P=Number(c[4]);P+=(Number(c[5])||0)/l.h,A+=P/l.frameRate,c=A+60*y+3600*p}else if(qN.test(i))c=px(qN,i);else if(QN.test(i))c=px(QN,i);else if(JN.test(i))c=JN.exec(i),c=Number(c[1])/l.frameRate;else if(ZN.test(i))c=ZN.exec(i),c=Number(c[1])/l.g;else if(eF.test(i))c=px(eF,i);else if(i)throw new We(2,2,2001,"Could not parse cue time range in TTML");return c}function px(i,l){var c=i.exec(l);return c==null||c[0]==""?null:(Number(c[4])||0)/1e3+(Number(c[3])||0)+60*(Number(c[2])||0)+3600*(Number(c[1])||0)}Le("shaka.text.TtmlTextParser",fu),fu.prototype.parseMedia=fu.prototype.parseMedia,fu.prototype.parseInit=fu.prototype.parseInit;function E9(i,l,c,p){this.frameRate=Number(i)||30,this.h=Number(l)||1,this.g=Number(p),this.g==0&&(this.g=i?this.frameRate*this.h:1),c&&(i=/^(\d+) (\d+)$/g.exec(c))&&(this.frameRate*=Number(i[1])/Number(i[2]))}var gx=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,_9=/^(\d{1,2}(?:\.\d+)?|100)%$/,Wd=/^(\d+px|\d+em|\d*\.?\d+c)$/,mx=/^(\d+)px (\d+)px$/,XN=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,qN=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,QN=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,JN=/^(\d*(?:\.\d*)?)f$/,ZN=/^(\d*(?:\.\d*)?)t$/,eF=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,T9={left:li,center:"center",right:"end",start:li,end:"end"},S9={left:"line-left",center:"center",right:"line-right"},cg=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],oy=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],A9=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"];Hr["application/ttml+xml"]=function(){return new fu};function Lo(){this.C=new fu}Lo.prototype.parseInit=function(i){var l=!1;if(new Lr().box("moov",$r).box("trak",$r).box("mdia",$r).box("minf",$r).box("stbl",$r).Z("stsd",Z0).box("stpp",function(c){l=!0,c.parser.stop()}).parse(i),!l)throw new We(2,2,2007)},Lo.prototype.parseMedia=function(i,l){var c=this,p=!1,y=[];if(new Lr().box("mdat",Cd(function(A){p=!0,y=y.concat(c.C.parseMedia(A,l))})).parse(i,!1),!p)throw new We(2,2,2007);return y},Le("shaka.text.Mp4TtmlParser",Lo),Lo.prototype.parseMedia=Lo.prototype.parseMedia,Lo.prototype.parseInit=Lo.prototype.parseInit,Hr['application/mp4; codecs="stpp"']=function(){return new Lo},Hr['application/mp4; codecs="stpp.ttml"']=function(){return new Lo},Hr['application/mp4; codecs="stpp.ttml.im1t"']=function(){return new Lo},Hr['application/mp4; codecs="stpp.TTML.im1t"']=function(){return new Lo};function Mo(){}Mo.prototype.parseInit=function(){},Mo.prototype.parseMedia=function(i,l){var c=Cn(i);c=c.replace(/\r\n|\r(?=[^\n]|$)/gm,`
`);var p=c.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(p[0]))throw new We(2,2,2e3);if(c=l.periodStart,p[0].includes("X-TIMESTAMP-MAP")){var y=p[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),A=p[0].match(/MPEGTS:(\d+)/m);if(y&&A){if(c=vx(new Bd(y[1])),c==null)throw new We(2,2,2e3);for(A=Number(A[1]),y=l.segmentStart;95443.7176888889<=y;)y-=95443.7176888889,A+=8589934592;c=l.periodStart+A/9e4-c}}A=[],y=E(p[0].split(`
`));for(var P=y.next();!P.done;P=y.next())if(P=P.value,/^Region:/.test(P)){P=new Bd(P);var N=new qs;mf(P),jd(P);for(var G=mf(P);G;){var q=N,ae=G;(G=/^id=(.*)$/.exec(ae))?q.id=G[1]:(G=/^width=(\d{1,2}|100)%$/.exec(ae))?q.width=Number(G[1]):(G=/^lines=(\d+)$/.exec(ae))?(q.height=Number(G[1]),q.heightUnits=2):(G=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(ae))?(q.regionAnchorX=Number(G[1]),q.regionAnchorY=Number(G[2])):(G=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(ae))?(q.viewportAnchorX=Number(G[1]),q.viewportAnchorY=Number(G[2])):/^scroll=up$/.exec(ae)&&(q.scroll="up"),jd(P),G=mf(P)}A.push(N)}for(y=new Map,tF(y),P=[],p=E(p.slice(1)),N=p.next();!N.done;N=p.next()){if(N=N.value.split(`
`),(N.length!=1||N[0])&&!/^NOTE($|[ \t])/.test(N[0])&&N[0]=="STYLE"&&N[1].includes("::cue")){q="global",(G=N[1].match(/\((.*)\)/))&&(q=G.pop()),G=N.slice(2,-1),N[1].includes("}")&&(ae=/\{(.*?)\}/.exec(N[1]))&&(G=ae[1].split(";")),ae=new ft(0,0,"");for(var Te=!1,Ie=0;Ie<G.length;Ie++){var Ne=/^\s*([^:]+):\s*(.*)/.exec(G[Ie]);if(Ne){var Ve=Ne[2].trim().replace(";","");switch(Ne[1].trim()){case"background-color":Te=!0,ae.backgroundColor=Ve;break;case"color":Te=!0,ae.color=Ve;break;case"font-family":Te=!0,ae.fontFamily=Ve;break;case"font-size":Te=!0,ae.fontSize=Ve;break;case"font-weight":700<=parseInt(Ve,10)&&(Te=!0,ae.fontWeight=700);break;case"font-style":switch(Ve){case"normal":Te=!0,ae.fontStyle=Aa;break;case"italic":Te=!0,ae.fontStyle="italic";break;case"oblique":Te=!0,ae.fontStyle="oblique"}break;case"opacity":Te=!0,ae.opacity=parseFloat(Ve);break;case"white-space":Te=!0,ae.wrapLine=Ve!="noWrap"}}}Te&&y.set(q,ae)}if(Ie=c,N.length==1&&!N[0]||/^NOTE($|[ \t])/.test(N[0])||N[0]=="STYLE")N=null;else{if(q=null,N[0].includes("-->")||(q=N[0],N.splice(0,1)),G=new Bd(N[0]),ae=vx(G),Ne=nc(G,/[ \t]+--\x3e[ \t]+/g),Te=vx(G),ae==null||Ne==null||Te==null)throw new We(2,2,2001,"Could not parse cue time range in WebVTT");for(ae+=Ie,Te+=Ie,Ie=N.slice(1).join(`
`).trim(),y.has("global")?(N=y.get("global").clone(),N.startTime=ae,N.endTime=Te,N.payload=""):N=new ft(ae,Te,""),nF(Ie,N,y),jd(G),ae=mf(G);ae;)iF(N,ae,A),jd(G),ae=mf(G);q!=null&&(N.id=q)}N&&P.push(N)}return P};function tF(i){for(var l=E(Object.entries(Sa)),c=l.next();!c.done;c=l.next()){var p=E(c.value);c=p.next().value,p=p.next().value;var y=new ft(0,0,"");y.color=p,i.set(c,y)}for(l=E(Object.entries(Zo)),c=l.next();!c.done;c=l.next())p=E(c.value),c=p.next().value,p=p.next().value,y=new ft(0,0,""),y.backgroundColor=p,i.set(c,y)}function nF(i,l,c){c.size===0&&tF(c),i=x9(i);var p=DA("<span>"+i+"</span>","span");if(p){var y=[];if(p=p.childNodes,p.length==1){var A=p[0];if(A.nodeType==Node.TEXT_NODE||A.nodeType==Node.CDATA_SECTION_NODE){l.payload=i;return}}for(i=E(p),p=i.next();!p.done;p=i.next())rF(p.value,l,y,c);l.nestedCues=y}else l.payload=i}function x9(i){for(var l=[],c=-1,p="",y=0;y<i.length;y++)if(i[y]==="/"){var A=i.indexOf(">",y);if(A<=y)return i;A=i.substring(y+1,A);var P=l.pop();if(A&&P){if(P===A)p+="/"+A+">";else{if(!P.startsWith("c.")||A!=="c")return i;p+="/"+P+">"}y+=A.length+1}else return i}else i[y]==="<"?c=y+1:i[y]===">"&&0<c&&(l.push(i.substr(c,y-c)),c=-1),p+=i[y];return p}function ly(i,l){return i&&0<i.length?i:l}function rF(i,l,c,p){var y=l.clone();if(i.nodeType===Node.ELEMENT_NODE&&i.nodeName)for(var A=E(i.nodeName.split(/[ .]+/)),P=A.next();!P.done;P=A.next()){if(P=P.value,p.has(P)){var N=p.get(P);N&&(y.backgroundColor=ly(N.backgroundColor,y.backgroundColor),y.color=ly(N.color,y.color),y.fontFamily=ly(N.fontFamily,y.fontFamily),y.fontSize=ly(N.fontSize,y.fontSize),y.fontWeight=N.fontWeight,y.fontStyle=N.fontStyle,y.opacity=N.opacity,y.wrapLine=N.wrapLine)}switch(P){case"b":y.fontWeight=700;break;case"i":y.fontStyle="italic";break;case"u":y.textDecoration.push("underline")}}if(Fw(i))for(A=!0,p=E(i.textContent.split(`
`)),i=p.next();!i.done;i=p.next())i=i.value,A||(A=l.clone(),A.lineBreak=!0,c.push(A)),0<i.length&&(A=y.clone(),A.payload=i,c.push(A)),A=!1;else for(l=E(i.childNodes),i=l.next();!i.done;i=l.next())rF(i.value,y,c,p)}function iF(i,l,c){var p;(p=/^align:(start|middle|center|end|left|right)$/.exec(l))?(l=p[1],l=="middle"?i.textAlign=yn:i.textAlign=On[l.toUpperCase()]):(p=/^vertical:(lr|rl)$/.exec(l))?i.writingMode=p[1]=="lr"?"vertical-lr":"vertical-rl":(p=/^size:([\d.]+)%$/.exec(l))?i.size=Number(p[1]):(p=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(l))?(i.position=Number(p[1]),p[2]&&(l=p[2],i.positionAlign=l=="line-left"||l=="start"?"line-left":l=="line-right"||l=="end"?"line-right":"center")):(p=/^region:(.*)$/.exec(l))?(l=C9(c,p[1]))&&(i.region=l):(c=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(l))?(i.lineInterpretation=1,i.line=Number(c[1]),c[2]&&(i.lineAlign=Xs[c[2].toUpperCase()])):(c=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(l))&&(i.lineInterpretation=Bi,i.line=Number(c[1]),c[2]&&(i.lineAlign=Xs[c[2].toUpperCase()]))}function C9(i,l){var c=i.filter(function(p){return p.id==l});return c.length?c[0]:null}function vx(i){if(i=nc(i,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g),i==null)return null;var l=Number(i[2]),c=Number(i[3]);return 59<l||59<c?null:Number(i[4])/1e3+c+60*l+3600*(Number(i[1])||0)}Le("shaka.text.VttTextParser",Mo),Mo.prototype.parseMedia=Mo.prototype.parseMedia,Mo.prototype.parseInit=Mo.prototype.parseInit,Hr["text/vtt"]=function(){return new Mo},Hr['text/vtt; codecs="vtt"']=function(){return new Mo},Hr['text/vtt; codecs="wvtt"']=function(){return new Mo};function ic(){this.g=null}ic.prototype.parseInit=function(i){var l=this,c=!1;if(new Lr().box("moov",$r).box("trak",$r).box("mdia",$r).Z("mdhd",function(p){p=OS(p.reader,p.version),l.g=p.timescale}).box("minf",$r).box("stbl",$r).Z("stsd",Z0).box("wvtt",function(){c=!0}).parse(i),!this.g)throw new We(2,2,2008);if(!c)throw new We(2,2,2008)},ic.prototype.parseMedia=function(i,l){if(!this.g)throw new We(2,2,2008);var c=0,p=[],y,A=[],P=!1,N=!1,G=!1,q=null;if(new Lr().box("moof",$r).box("traf",$r).Z("tfdt",function(yt){P=!0,c=wS(yt.reader,yt.version).Xd}).Z("tfhd",function(yt){q=LL(yt.reader,yt.flags).cf}).Z("trun",function(yt){N=!0,p=ML(yt.reader,yt.version,yt.flags).zf}).box("mdat",Cd(function(yt){G=!0,y=yt})).parse(i,!1),!G&&!P&&!N)throw new We(2,2,2008);for(var ae=c,Te=new yr(y,0),Ie=E(p),Ne=Ie.next();!Ne.done;Ne=Ie.next()){Ne=Ne.value;var Ve=Ne.ye||q,qe=Ne.Cd?c+Ne.Cd:ae;ae=qe+(Ve||0);var Ze=0;do{var Qe=Te.T();Ze+=Qe;var Lt=Te.T(),It=null;cL(Lt)=="vttc"?8<Qe&&(It=Te.Lb(Qe-8)):Te.skip(Qe-8),Ve&&It&&(Qe=I9(It,l.periodStart+qe/this.g,l.periodStart+ae/this.g),A.push(Qe))}while(Ne.sampleSize&&Ze<Ne.sampleSize)}return A.filter(bt)};function I9(i,l,c){var p,y,A;return new Lr().box("payl",Cd(function(P){p=Cn(P)})).box("iden",Cd(function(P){y=Cn(P)})).box("sttg",Cd(function(P){A=Cn(P)})).parse(i),p?R9(p,y,A,l,c):null}function R9(i,l,c,p,y){if(p=new ft(p,y,""),nF(i,p,new Map),l&&(p.id=l),c)for(i=new Bd(c),l=mf(i);l;)iF(p,l,[]),jd(i),l=mf(i);return p}Le("shaka.text.Mp4VttParser",ic),ic.prototype.parseMedia=ic.prototype.parseMedia,ic.prototype.parseInit=ic.prototype.parseInit,Hr['application/mp4; codecs="wvtt"']=function(){return new ic};function sc(){}sc.prototype.parseInit=function(){},sc.prototype.parseMedia=function(i){var l=Cn(i).replace(/\r+/g,"");if(l=l.trim(),i=[],l=="")return i;l=E(l.split(`

`));for(var c=l.next();!c.done;c=l.next()){c=c.value.split(`
`);var p=new Bd(c[0]),y=sF(p),A=nc(p,/,/g);if(p=sF(p),y==null||A==null||p==null)throw new We(2,2,2001,"Could not parse cue time range in SubViewer");i.push(new ft(y,p,c.slice(1).join(`
`).trim()))}return i};function sF(i){if(i=nc(i,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g),i==null)return null;var l=Number(i[2]),c=Number(i[3]);return 59<l||59<c?null:Number(i[4])/1e3+c+60*l+3600*(Number(i[1])||0)}Le("shaka.text.SbvTextParser",sc),sc.prototype.parseMedia=sc.prototype.parseMedia,sc.prototype.parseInit=sc.prototype.parseInit,Hr["text/x-subviewer"]=function(){return new sc};function du(){this.C=new Mo}du.prototype.parseInit=function(){},du.prototype.parseMedia=function(i,l){var c=Cn(i);return c=aF(c),c=er(hi(c)),this.C.parseMedia(c,l)};function aF(i){var l=`WEBVTT

`;if(i=="")return l;i=i.replace(/\r+/g,""),i=i.trim(),i=E(i.split(`

`));for(var c=i.next();!c.done;c=i.next())c=c.value.split(/\n/),c[0].match(/\d+/)&&c.shift(),c[0]=c[0].replace(/,/g,"."),l+=c.join(`
`)+`

`;return l}Le("shaka.text.SrtTextParser",du),du.srt2webvtt=aF,du.prototype.parseMedia=du.prototype.parseMedia,du.prototype.parseInit=du.prototype.parseInit,Hr["text/srt"]=function(){return new du};function ac(){}ac.prototype.parseInit=function(){},ac.prototype.parseMedia=function(i){var l="",c="";i=Cn(i).split(/\r?\n\s*\r?\n/),i=E(i);for(var p=i.next();!p.done;p=i.next()){var y=D9.exec(p.value);y&&(p=y[1],y=y[2],p=="V4 Styles"||p=="V4+ Styles"?l=y:p=="Events"&&(c=y))}i=[],p=null,l=E(l.split(/\r?\n/));for(var A=l.next();!A.done;A=l.next())if(y=A.value,!/^\s*;/.test(y)&&(A=uF.exec(y))){if(y=A[1].trim(),A=A[2].trim(),y=="Format")p=A.split(uy);else if(y=="Style"){y=A.split(uy),A={};for(var P=0;P<p.length&&P<y.length;P++)A[p[P]]=y[P];i.push(A)}}for(p=[],l=null,y={},c=E(c.split(/\r?\n/)),A=c.next();!A.done;y={Ud:y.Ud},A=c.next())if(A=A.value,!/^\s*;/.test(A)&&(P=uF.exec(A))){if(A=P[1].trim(),P=P[2].trim(),A=="Format")l=P.split(uy);else if(A=="Dialogue"){P=P.split(uy),A={};for(var N=0;N<l.length&&N<P.length;N++)A[l[N]]=P[N];N=lF(A.Start);var G=lF(A.End);P=new ft(N,G,P.slice(l.length-1).join(",").replace(/\\N/g,`
`).replace(/\{[^}]+\}/g,"")),y.Ud=A.Style,(A=i.find(function(q){return function(ae){return ae.Name==q.Ud}}(y)))&&b9(P,A),p.push(P)}}return p};function b9(i,l){var c=l.Fontname;if(c&&(i.fontFamily=c),(c=l.Fontsize)&&(i.fontSize=c+"px"),(c=l.PrimaryColour)&&(c=oF(c))&&(i.color=c),(c=l.BackColour)&&(c=oF(c))&&(i.backgroundColor=c),l.Bold&&(i.fontWeight=700),l.Italic&&(i.fontStyle="italic"),l.Underline&&i.textDecoration.push("underline"),(c=l.Spacing)&&(i.letterSpacing=c+"px"),c=l.Alignment)switch(parseInt(c,10)){case 1:i.displayAlign=nr,i.textAlign="start";break;case 2:i.displayAlign=nr,i.textAlign=yn;break;case 3:i.displayAlign=nr,i.textAlign="end";break;case 5:i.displayAlign="before",i.textAlign="start";break;case 6:i.displayAlign="before",i.textAlign=yn;break;case 7:i.displayAlign="before",i.textAlign="end";break;case 9:i.displayAlign="center",i.textAlign="start";break;case 10:i.displayAlign="center",i.textAlign=yn;break;case 11:i.displayAlign="center",i.textAlign="end"}(c=l.AlphaLevel)&&(i.opacity=parseFloat(c))}function oF(i){return i=parseInt(i.replace("&H",""),16),0<=i?"rgba("+(i&255)+","+(i>>8&255)+","+(i>>16&255)+","+(i>>24&255^255)/255+")":null}function lF(i){return i=P9.exec(i),3600*(i[1]?parseInt(i[1].replace(":",""),10):0)+60*parseInt(i[2],10)+parseFloat(i[3])}Le("shaka.text.SsaTextParser",ac),ac.prototype.parseMedia=ac.prototype.parseMedia,ac.prototype.parseInit=ac.prototype.parseInit;var D9=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,uF=/^\s*([^:]+):\s*(.*)/,uy=/\s*,\s*/,P9=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;Hr["text/x-ssa"]=function(){return new ac};/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/function cF(){}var fg;function fF(){fg?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(fg=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=L9):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function L9(i,l){var c=this,p;return Z(function(y){return y.g==1?(console.assert(c==navigator,'bad "this" for requestMediaKeySystemAccess'),I(y,fg.call(c,i,l),2)):(p=y.h,yF(p)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=fg,y.return(p)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=dF,y.return(dF.call(c,i,l))))})}function dF(i,l){var c=this,p,y,A,P,N,G,q,ae,Te,Ie;return Z(function(Ne){if(Ne.g==1){for(console.assert(c==navigator,'bad "this" for requestMediaKeySystemAccess'),p=vF(i),y=[],A=E(l),P=A.next();!P.done;P=A.next())N=P.value,G=hF(N.videoCapabilities,p),q=hF(N.audioCapabilities,p),N.videoCapabilities&&N.videoCapabilities.length&&!G.length||N.audioCapabilities&&N.audioCapabilities.length&&!q.length||(ae=Object.assign({},N),ae.videoCapabilities=G,ae.audioCapabilities=q,y.push(ae));if(!y.length)throw Te=Error("Unsupported keySystem or supportedConfigurations."),Te.name="NotSupportedError",Te.code=DOMException.NOT_SUPPORTED_ERR,Te;return I(Ne,fg.call(c,i,y),2)}return Ie=Ne.h,Ne.return(new cy(Ie,p))})}function hF(i,l){return i&&i.filter(function(c){return!c.encryptionScheme||c.encryptionScheme==l})}Le("EmeEncryptionSchemePolyfill",cF),cF.install=fF;function pF(){}var dg;function gF(){dg?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(dg=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=M9):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function M9(i){var l=this,c,p;return Z(function(y){return y.g==1?(console.assert(l==navigator.mediaCapabilities,'bad "this" for decodingInfo'),I(y,dg.call(l,i),2)):(c=y.h,i.keySystemConfiguration?(p=c.keySystemAccess)&&yF(p)?(console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=dg,y.return(c)):(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=mF,y.return(mF.call(l,i))):y.return(c))})}function mF(i){var l=this,c,p,y,A,P,N,G,q,ae;return Z(function(Te){switch(Te.g){case 1:return console.assert(l==navigator.mediaCapabilities,'bad "this" for decodingInfo'),c=null,i.keySystemConfiguration&&(p=i.keySystemConfiguration,y=p.keySystem,A=p.audio&&p.audio.encryptionScheme,P=p.video&&p.video.encryptionScheme,c=vF(y),N={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:i},A&&A!=c||P&&P!=c)?Te.return(N):I(Te,dg.call(l,i),2);case 2:if(G=Te.h,G.keySystemAccess){G.keySystemAccess=new cy(G.keySystemAccess,c),Te.D(3);break}if(!i.keySystemConfiguration){Te.D(3);break}var Ie=i.keySystemConfiguration,Ne=[],Ve=[];return Ie.audio&&Ne.push({robustness:Ie.audio.robustness||"",contentType:i.audio.contentType}),Ie.video&&Ve.push({robustness:Ie.video.robustness||"",contentType:i.video.contentType}),Ie={initDataTypes:Ie.initDataType?[Ie.initDataType]:[],distinctiveIdentifier:Ie.distinctiveIdentifier,persistentState:Ie.persistentState,sessionTypes:Ie.sessionTypes},Ne.length&&(Ie.audioCapabilities=Ne),Ve.length&&(Ie.videoCapabilities=Ve),q=Ie,ae=G,I(Te,navigator.requestMediaKeySystemAccess(i.keySystemConfiguration.keySystem,[q]),5);case 5:ae.keySystemAccess=Te.h;case 3:return Te.return(G)}})}Le("McEncryptionSchemePolyfill",pF),pF.install=gF;function cy(i,l){this.h=i,this.g=l,this.keySystem=i.keySystem}cy.prototype.getConfiguration=function(){var i=this.h.getConfiguration();if(i.videoCapabilities)for(var l=E(i.videoCapabilities),c=l.next();!c.done;c=l.next())c.value.encryptionScheme=this.g;if(i.audioCapabilities)for(l=E(i.audioCapabilities),c=l.next();!c.done;c=l.next())c.value.encryptionScheme=this.g;return i},cy.prototype.createMediaKeys=function(){return this.h.createMediaKeys()};function vF(i){return i.startsWith("com.widevine")||i.startsWith("com.microsoft")||i.startsWith("com.adobe")||i.startsWith("org.w3")?"cenc":i.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",i,"Please contribute!"),null)}function yF(i){i=i.getConfiguration();var l=i.audioCapabilities&&i.audioCapabilities[0];return!!((i=i.videoCapabilities&&i.videoCapabilities[0]||l)&&i.encryptionScheme!==void 0)}function yx(){}function EF(){fF(),gF()}Le("EncryptionSchemePolyfills",yx),yx.install=EF,typeof h<"u"&&h.exports&&(h.exports=yx);/*
 @license
 Copyright 2013 Ali Al Dallal

 Licensed under the MIT license.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.
*/for(var Ef={ach:{u:"Lwo",A:"Acholi"},ady:{u:"Адыгэбзэ",A:"Adyghe"},af:{u:"Afrikaans",A:"Afrikaans"},"af-NA":{u:"Afrikaans (Namibia)",A:"Afrikaans (Namibia)"},"af-ZA":{u:"Afrikaans (South Africa)",A:"Afrikaans (South Africa)"},ak:{u:"Tɕɥi",A:"Akan"},ar:{u:"العربية",A:"Arabic"},"ar-AR":{u:"العربية",A:"Arabic"},"ar-MA":{u:"العربية",A:"Arabic (Morocco)"},"ar-SA":{u:"العربية (السعودية)",A:"Arabic (Saudi Arabia)"},"ay-BO":{u:"Aymar aru",A:"Aymara"},az:{u:"Azərbaycan dili",A:"Azerbaijani"},"az-AZ":{u:"Azərbaycan dili",A:"Azerbaijani"},"be-BY":{u:"Беларуская",A:"Belarusian"},bg:{u:"Български",A:"Bulgarian"},"bg-BG":{u:"Български",A:"Bulgarian"},bn:{u:"বাংলা",A:"Bengali"},"bn-IN":{u:"বাংলা (ভারত)",A:"Bengali (India)"},"bn-BD":{u:"বাংলা(বাংলাদেশ)",A:"Bengali (Bangladesh)"},"bs-BA":{u:"Bosanski",A:"Bosnian"},ca:{u:"Català",A:"Catalan"},"ca-ES":{u:"Català",A:"Catalan"},cak:{u:"Maya Kaqchikel",A:"Kaqchikel"},"ck-US":{u:"ᏣᎳᎩ (tsalagi)",A:"Cherokee"},cs:{u:"Čeština",A:"Czech"},"cs-CZ":{u:"Čeština",A:"Czech"},cy:{u:"Cymraeg",A:"Welsh"},"cy-GB":{u:"Cymraeg",A:"Welsh"},da:{u:"Dansk",A:"Danish"},"da-DK":{u:"Dansk",A:"Danish"},de:{u:"Deutsch",A:"German"},"de-AT":{u:"Deutsch (Österreich)",A:"German (Austria)"},"de-DE":{u:"Deutsch (Deutschland)",A:"German (Germany)"},"de-CH":{u:"Deutsch (Schweiz)",A:"German (Switzerland)"},dsb:{u:"Dolnoserbšćina",A:"Lower Sorbian"},el:{u:"Ελληνικά",A:"Greek"},"el-GR":{u:"Ελληνικά",A:"Greek (Greece)"},en:{u:"English",A:"English"},"en-GB":{u:"English (UK)",A:"English (UK)"},"en-AU":{u:"English (Australia)",A:"English (Australia)"},"en-CA":{u:"English (Canada)",A:"English (Canada)"},"en-IE":{u:"English (Ireland)",A:"English (Ireland)"},"en-IN":{u:"English (India)",A:"English (India)"},"en-PI":{u:"English (Pirate)",A:"English (Pirate)"},"en-UD":{u:"English (Upside Down)",A:"English (Upside Down)"},"en-US":{u:"English (US)",A:"English (US)"},"en-ZA":{u:"English (South Africa)",A:"English (South Africa)"},"en@pirate":{u:"English (Pirate)",A:"English (Pirate)"},eo:{u:"Esperanto",A:"Esperanto"},"eo-EO":{u:"Esperanto",A:"Esperanto"},es:{u:"Español",A:"Spanish"},"es-AR":{u:"Español (Argentine)",A:"Spanish (Argentina)"},"es-419":{u:"Español (Latinoamérica)",A:"Spanish (Latin America)"},"es-CL":{u:"Español (Chile)",A:"Spanish (Chile)"},"es-CO":{u:"Español (Colombia)",A:"Spanish (Colombia)"},"es-EC":{u:"Español (Ecuador)",A:"Spanish (Ecuador)"},"es-ES":{u:"Español (España)",A:"Spanish (Spain)"},"es-LA":{u:"Español (Latinoamérica)",A:"Spanish (Latin America)"},"es-NI":{u:"Español (Nicaragua)",A:"Spanish (Nicaragua)"},"es-MX":{u:"Español (México)",A:"Spanish (Mexico)"},"es-US":{u:"Español (Estados Unidos)",A:"Spanish (United States)"},"es-VE":{u:"Español (Venezuela)",A:"Spanish (Venezuela)"},et:{u:"eesti keel",A:"Estonian"},"et-EE":{u:"Eesti (Estonia)",A:"Estonian (Estonia)"},eu:{u:"Euskara",A:"Basque"},"eu-ES":{u:"Euskara",A:"Basque"},fa:{u:"فارسی",A:"Persian"},"fa-IR":{u:"فارسی",A:"Persian"},"fb-LT":{u:"Leet Speak",A:"Leet"},ff:{u:"Fulah",A:"Fulah"},fi:{u:"Suomi",A:"Finnish"},"fi-FI":{u:"Suomi",A:"Finnish"},"fo-FO":{u:"Føroyskt",A:"Faroese"},fr:{u:"Français",A:"French"},"fr-CA":{u:"Français (Canada)",A:"French (Canada)"},"fr-FR":{u:"Français (France)",A:"French (France)"},"fr-BE":{u:"Français (Belgique)",A:"French (Belgium)"},"fr-CH":{u:"Français (Suisse)",A:"French (Switzerland)"},"fy-NL":{u:"Frysk",A:"Frisian (West)"},ga:{u:"Gaeilge",A:"Irish"},"ga-IE":{u:"Gaeilge (Gaelic)",A:"Irish (Gaelic)"},gl:{u:"Galego",A:"Galician"},"gl-ES":{u:"Galego",A:"Galician"},"gn-PY":{u:"Avañe'ẽ",A:"Guarani"},"gu-IN":{u:"ગુજરાતી",A:"Gujarati"},"gx-GR":{u:"Ἑλληνική ἀρχαία",A:"Classical Greek"},he:{u:"עברית‏",A:"Hebrew"},"he-IL":{u:"עברית‏",A:"Hebrew"},hi:{u:"हिन्दी",A:"Hindi"},"hi-IN":{u:"हिन्दी",A:"Hindi"},hr:{u:"Hrvatski",A:"Croatian"},"hr-HR":{u:"Hrvatski",A:"Croatian"},hsb:{u:"Hornjoserbšćina",A:"Upper Sorbian"},ht:{u:"Kreyòl",A:"Haitian Creole"},hu:{u:"Magyar",A:"Hungarian"},"hu-HU":{u:"Magyar",A:"Hungarian"},"hy-AM":{u:"Հայերեն",A:"Armenian"},id:{u:"Bahasa Indonesia",A:"Indonesian"},"id-ID":{u:"Bahasa Indonesia",A:"Indonesian"},is:{u:"Íslenska",A:"Icelandic"},"is-IS":{u:"Íslenska (Iceland)",A:"Icelandic (Iceland)"},it:{u:"Italiano",A:"Italian"},"it-IT":{u:"Italiano",A:"Italian"},ja:{u:"日本語",A:"Japanese"},"ja-JP":{u:"日本語",A:"Japanese"},"jv-ID":{u:"Basa Jawa",A:"Javanese"},"ka-GE":{u:"ქართული",A:"Georgian"},"kk-KZ":{u:"Қазақша",A:"Kazakh"},km:{u:"ភាសាខ្មែរ",A:"Khmer"},"km-KH":{u:"ភាសាខ្មែរ",A:"Khmer"},kab:{u:"Taqbaylit",A:"Kabyle"},kn:{u:"ಕನ್ನಡ",A:"Kannada"},"kn-IN":{u:"ಕನ್ನಡ (India)",A:"Kannada (India)"},ko:{u:"한국어",A:"Korean"},"ko-KR":{u:"한국어 (韩国)",A:"Korean (Korea)"},ku:{u:"Kurdî",A:"Kurdish"},"ku-TR":{u:"Kurdî",A:"Kurdish"},la:{u:"Latin",A:"Latin"},"la-VA":{u:"Latin",A:"Latin"},lb:{u:"Lëtzebuergesch",A:"Luxembourgish"},"li-NL":{u:"Lèmbörgs",A:"Limburgish"},lt:{u:"Lietuvių",A:"Lithuanian"},"lt-LT":{u:"Lietuvių",A:"Lithuanian"},lv:{u:"Latviešu",A:"Latvian"},"lv-LV":{u:"Latviešu",A:"Latvian"},mai:{u:"मैथिली, মৈথিলী",A:"Maithili"},"mg-MG":{u:"Malagasy",A:"Malagasy"},mk:{u:"Македонски",A:"Macedonian"},"mk-MK":{u:"Македонски (Македонски)",A:"Macedonian (Macedonian)"},ml:{u:"മലയാളം",A:"Malayalam"},"ml-IN":{u:"മലയാളം",A:"Malayalam"},"mn-MN":{u:"Монгол",A:"Mongolian"},mr:{u:"मराठी",A:"Marathi"},"mr-IN":{u:"मराठी",A:"Marathi"},ms:{u:"Bahasa Melayu",A:"Malay"},"ms-MY":{u:"Bahasa Melayu",A:"Malay"},mt:{u:"Malti",A:"Maltese"},"mt-MT":{u:"Malti",A:"Maltese"},my:{u:"ဗမာစကာ",A:"Burmese"},nb:{u:"Norsk (bokmål)",A:"Norwegian (bokmal)"},"nb-NO":{u:"Norsk (bokmål)",A:"Norwegian (bokmal)"},ne:{u:"नेपाली",A:"Nepali"},"ne-NP":{u:"नेपाली",A:"Nepali"},nl:{u:"Nederlands",A:"Dutch"},"nl-BE":{u:"Nederlands (België)",A:"Dutch (Belgium)"},"nl-NL":{u:"Nederlands (Nederland)",A:"Dutch (Netherlands)"},"nn-NO":{u:"Norsk (nynorsk)",A:"Norwegian (nynorsk)"},no:{u:"Norsk",A:"Norwegian"},oc:{u:"Occitan",A:"Occitan"},"or-IN":{u:"ଓଡ଼ିଆ",A:"Oriya"},pa:{u:"ਪੰਜਾਬੀ",A:"Punjabi"},"pa-IN":{u:"ਪੰਜਾਬੀ (ਭਾਰਤ ਨੂੰ)",A:"Punjabi (India)"},pl:{u:"Polski",A:"Polish"},"pl-PL":{u:"Polski",A:"Polish"},"ps-AF":{u:"پښتو",A:"Pashto"},pt:{u:"Português",A:"Portuguese"},"pt-BR":{u:"Português (Brasil)",A:"Portuguese (Brazil)"},"pt-PT":{u:"Português (Portugal)",A:"Portuguese (Portugal)"},"qu-PE":{u:"Qhichwa",A:"Quechua"},"rm-CH":{u:"Rumantsch",A:"Romansh"},ro:{u:"Română",A:"Romanian"},"ro-RO":{u:"Română",A:"Romanian"},ru:{u:"Русский",A:"Russian"},"ru-RU":{u:"Русский",A:"Russian"},"sa-IN":{u:"संस्कृतम्",A:"Sanskrit"},"se-NO":{u:"Davvisámegiella",A:"Northern Sámi"},"si-LK":{u:"පළාත",A:"Sinhala (Sri Lanka)"},sk:{u:"Slovenčina",A:"Slovak"},"sk-SK":{u:"Slovenčina (Slovakia)",A:"Slovak (Slovakia)"},sl:{u:"Slovenščina",A:"Slovenian"},"sl-SI":{u:"Slovenščina",A:"Slovenian"},"so-SO":{u:"Soomaaliga",A:"Somali"},sq:{u:"Shqip",A:"Albanian"},"sq-AL":{u:"Shqip",A:"Albanian"},sr:{u:"Српски",A:"Serbian"},"sr-RS":{u:"Српски (Serbia)",A:"Serbian (Serbia)"},su:{u:"Basa Sunda",A:"Sundanese"},sv:{u:"Svenska",A:"Swedish"},"sv-SE":{u:"Svenska",A:"Swedish"},sw:{u:"Kiswahili",A:"Swahili"},"sw-KE":{u:"Kiswahili",A:"Swahili (Kenya)"},ta:{u:"தமிழ்",A:"Tamil"},"ta-IN":{u:"தமிழ்",A:"Tamil"},te:{u:"తెలుగు",A:"Telugu"},"te-IN":{u:"తెలుగు",A:"Telugu"},tg:{u:"забо́ни тоҷикӣ́",A:"Tajik"},"tg-TJ":{u:"тоҷикӣ",A:"Tajik"},th:{u:"ภาษาไทย",A:"Thai"},"th-TH":{u:"ภาษาไทย (ประเทศไทย)",A:"Thai (Thailand)"},tl:{u:"Filipino",A:"Filipino"},"tl-PH":{u:"Filipino",A:"Filipino"},tlh:{u:"tlhIngan-Hol",A:"Klingon"},tr:{u:"Türkçe",A:"Turkish"},"tr-TR":{u:"Türkçe",A:"Turkish"},"tt-RU":{u:"татарча",A:"Tatar"},uk:{u:"Українська",A:"Ukrainian"},"uk-UA":{u:"Українська",A:"Ukrainian"},ur:{u:"اردو",A:"Urdu"},"ur-PK":{u:"اردو",A:"Urdu"},uz:{u:"O'zbek",A:"Uzbek"},"uz-UZ":{u:"O'zbek",A:"Uzbek"},vi:{u:"Tiếng Việt",A:"Vietnamese"},"vi-VN":{u:"Tiếng Việt",A:"Vietnamese"},"xh-ZA":{u:"isiXhosa",A:"Xhosa"},yi:{u:"ייִדיש",A:"Yiddish"},"yi-DE":{u:"ייִדיש (German)",A:"Yiddish (German)"},zh:{u:"中文",A:"Chinese"},"zh-HANS":{u:"中文简体",A:"Chinese Simplified"},"zh-HANT":{u:"中文繁體",A:"Chinese Traditional"},"zh-CN":{u:"中文（中国）",A:"Chinese Simplified (China)"},"zh-HK":{u:"中文（香港）",A:"Chinese Traditional (Hong Kong)"},"zh-SG":{u:"中文（新加坡）",A:"Chinese Simplified (Singapore)"},"zh-TW":{u:"中文（台灣）",A:"Chinese Traditional (Taiwan)"},"zu-ZA":{u:"isiZulu",A:"Zulu"}},_F=E(Object.keys(Ef)),Ex=_F.next();!Ex.done;Ex=_F.next()){var TF=Ex.value;Ef[TF.toLowerCase()]=Ef[TF]}function zn(i,l){var c=this;this.parent=i,this.controls=l,this.eventManager=new _r,this.localization=this.controls.bb,this.player=this.controls.lc(),this.video=this.controls.Kb(),this.adManager=this.player.od(),this.ad=l.getAd(),this.eventManager.o(this.adManager,"ad-started",function(p){c.ad=p.ad}),this.eventManager.o(this.adManager,"ad-stopped",function(){c.ad=null})}zn.prototype.release=function(){this.eventManager.release(),this.ad=this.adManager=this.video=this.player=this.localization=this.eventManager=this.controls=this.parent=null},Le("shaka.ui.Element",zn),zn.prototype.release=zn.prototype.release;function SF(i){return _x(i,"shaka-back-to-overflow-button")}function _x(i,l){var c=i.getElementsByClassName(l);return c.length?c[0]:null}function hg(i){i&&(i=_x(i,"shaka-chosen-item"))&&i.parentElement.focus()}function Hd(){var i=wn("i");return i.classList.add("material-icons-round"),i.classList.add("shaka-chosen-item"),i.textContent="done",i.ariaHidden="true",i}function Hn(i,l){i&&(l?i.classList.remove("shaka-hidden"):i.classList.add("shaka-hidden"))}function Vd(i,l){var c=Math.floor(i/3600),p=Math.floor(i/60%60),y=Math.floor(i%60);return 10>y&&(y="0"+y),y=p+":"+y,l&&(10>p&&(y="0"+y),y=c+":"+y),y}function fy(i,l){zn.call(this,i,l);var c=this;this.i=wn("div"),this.i.classList.add("shaka-ad-counter"),this.parent.appendChild(this.i),this.h=wn("span"),this.h.classList.add("shaka-ad-counter-span"),this.i.appendChild(this.h),this.g=new kn(function(){var p=Math.round(c.ad.getRemainingTime()),y=c.ad.getDuration();p!=-1&&y!=-1&&(0<p?(p=Vd(y-p,!1)+" / "+Vd(y,!1),1<c.ad.getSequenceLength()?c.h.textContent=p:(y=c.localization.resolve("AD_TIME"),c.h.textContent=y.replace("[AD_TIME]",p))):(c.g.stop(),c.h.textContent=""))}),this.eventManager.o(this.localization,"locale-updated",function(){}),this.eventManager.o(this.localization,"locale-changed",function(){}),this.eventManager.o(this.adManager,"ad-started",function(){c.g.Ga(),c.g.na(.5)}),this.eventManager.o(this.adManager,"ad-stopped",function(){c.g.stop(),c.h.textContent=""}),this.ad&&(this.g.Ga(),this.g.na(.5))}D(fy,zn),fy.prototype.release=function(){this.g.stop(),this.g=null,zn.prototype.release.call(this)},Le("shaka.ui.AdCounter",fy);function Tx(i,l){zn.call(this,i,l);var c=this;this.g=wn("div"),this.g.classList.add("shaka-ad-position"),Hn(this.g,!1),this.parent.appendChild(this.g),this.h=wn("span"),this.h.classList.add("shaka-ad-position-span"),this.g.appendChild(this.h),this.eventManager.o(this.localization,"locale-updated",function(){c.ad&&dy(c)}),this.eventManager.o(this.localization,"locale-changed",function(){c.ad&&dy(c)}),this.eventManager.o(this.adManager,"ad-started",function(){dy(c)}),this.eventManager.o(this.adManager,"ad-stopped",function(){c.h.textContent="",Hn(c.g,!1)}),this.ad&&dy(this)}D(Tx,zn);function dy(i){var l=i.ad.getSequenceLength();if(1<l){var c=i.ad.getPositionInSequence();i.h.textContent=i.localization.resolve("AD_PROGRESS").replace("[AD_ON]",String(c)).replace("[NUM_ADS]",String(l)),Hn(i.g,!0)}}Le("shaka.ui.AdPosition",Tx);function hu(i,l){zn.call(this,i,l);var c=this;this.button=Oi(),this.parent.appendChild(this.button),this.eventManager.o(this.localization,"locale-updated",function(){c.g()}),this.eventManager.o(this.localization,"locale-changed",function(){c.g()}),this.eventManager.o(this.video,"play",function(){c.g(),c.h()}),this.eventManager.o(this.video,"pause",function(){c.g(),c.h()}),this.eventManager.o(this.video,"seeking",function(){c.g(),c.h()}),this.eventManager.o(this.adManager,"ad-paused",function(){c.g(),c.h()}),this.eventManager.o(this.adManager,"ad-resumed",function(){c.g(),c.h()}),this.eventManager.o(this.adManager,"ad-started",function(){c.g(),c.h()}),this.eventManager.o(this.button,"click",function(){c.ad&&c.ad.isLinear()?bF(c.controls):RF(c.controls)}),this.ad&&(this.g(),this.h())}D(hu,zn),hu.prototype.isPaused=function(){if(this.ad&&this.ad.isLinear())var i=this.ad.isPaused();else i=this.controls,i=i.g.paused&&!i.ka;return i},hu.prototype.g=function(){},hu.prototype.h=function(){},Le("shaka.ui.PlayButton",hu);function pg(i,l){hu.call(this,i,l),this.button.classList.add("shaka-play-button"),this.button.classList.add("shaka-no-propagation"),this.h(),this.g()}D(pg,hu),pg.prototype.h=function(){this.isPaused()?this.button.setAttribute("icon","play"):this.button.setAttribute("icon","pause")},pg.prototype.g=function(){var i=this.isPaused()?"PLAY":"PAUSE";this.button.ariaLabel=this.localization.resolve(i)},Le("shaka.ui.BigPlayButton",pg);function gg(i,l){zn.call(this,i,l);var c=this;this.m=this.controls.m,this.h=this.controls.i,this.i=[],this.g=wn("div"),this.g.classList.add("shaka-no-propagation"),this.g.classList.add("shaka-context-menu"),this.g.classList.add("shaka-hidden"),this.h.appendChild(this.g),this.eventManager.o(this.h,"contextmenu",function(p){if(c.g.classList.contains("shaka-hidden")){p.preventDefault();var y=c.h.getBoundingClientRect();c.g.style.left=p.clientX-y.left+"px",c.g.style.top=p.clientY-y.top+"px",Hn(c.g,!0)}else Hn(c.g,!1)}),this.eventManager.o(o,"click",function(){Hn(c.g,!1)}),w9(this)}D(gg,zn),gg.prototype.release=function(){this.h=null;for(var i=E(this.i),l=i.next();!l.done;l=i.next())l.value.release();this.i=[],zn.prototype.release.call(this)};function hy(i,l){AF.set(i,l)}function w9(i){for(var l=E(i.m.contextMenuElements),c=l.next();!c.done;c=l.next()){c=c.value;var p=AF.get(c);p?i.i.push(p.create(i.g,i.controls)):Re("Unrecognized context menu element:",c)}}Le("shaka.ui.ContextMenu",gg),gg.registerElement=hy;var AF=new Map;function bi(i,l,c,p){zn.call(this,i,l);var y=this;this.container=wn("div"),this.container.classList.add("shaka-range-container"),this.container.classList.add.apply(this.container.classList,T(c)),this.g=!1,this.bar=document.createElement("input"),this.l=new kn(function(){y.onChangeEnd(),y.g=!1}),this.bar.classList.add("shaka-range-element"),this.bar.classList.add.apply(this.bar.classList,T(p)),this.bar.type="range",this.bar.step="any",this.bar.min="0",this.bar.max="1",this.bar.value="0",this.container.appendChild(this.bar),this.parent.appendChild(this.container),this.eventManager.o(this.bar,"mousedown",function(){y.controls.Ub()&&(y.g=!0,y.onChangeStart())}),this.eventManager.o(this.bar,"touchstart",function(A){y.controls.Ub()&&(y.g=!0,Sx(y,A),y.onChangeStart())}),this.eventManager.o(this.bar,"input",function(){y.onChange()}),this.eventManager.o(this.bar,"touchmove",function(A){y.g&&(Sx(y,A),y.onChange())}),this.eventManager.o(this.bar,"touchend",function(A){y.g&&(y.g=!1,Sx(y,A),y.onChangeEnd())}),this.eventManager.o(this.bar,"mouseup",function(){y.g&&(y.g=!1,y.onChangeEnd())})}D(bi,zn),f=bi.prototype,f.release=function(){this.l&&(this.l.stop(),this.l=null),zn.prototype.release.call(this)},f.setRange=function(i,l){this.bar.min=i,this.bar.max=l},f.onChangeStart=function(){},f.onChange=function(){},f.onChangeEnd=function(){},f.changeTo=function(i){this.g||(this.g=!0,this.onChangeStart());var l=parseFloat(this.bar.min),c=parseFloat(this.bar.max);this.bar.value=i>c?c:i<l?l:i,this.onChange(),this.l.U(.5)},f.getValue=function(){return parseFloat(this.bar.value)},f.setValue=function(i){this.g||(this.bar.value=i)};function Sx(i,l){l.preventDefault();var c=l.changedTouches[0],p=i.bar.getBoundingClientRect(),y=parseFloat(i.bar.min),A=parseFloat(i.bar.max);c=y+(A-y)/p.width*(c.clientX-p.left),c<y?c=y:c>A&&(c=A),i.bar.value=c}Le("shaka.ui.RangeElement",bi),bi.prototype.setValue=bi.prototype.setValue,bi.prototype.getValue=bi.prototype.getValue,bi.prototype.changeTo=bi.prototype.changeTo,bi.prototype.onChangeEnd=bi.prototype.onChangeEnd,bi.prototype.onChange=bi.prototype.onChange,bi.prototype.onChangeStart=bi.prototype.onChangeStart,bi.prototype.setRange=bi.prototype.setRange;function mg(i,l){bi.call(this,i,l,["shaka-seek-bar-container"],["shaka-seek-bar","shaka-no-propagation","shaka-show-controls-on-mouse-over"]);var c=this;this.j=wn("div"),this.j.classList.add("shaka-ad-markers"),this.container.insertBefore(this.j,this.container.childNodes[0]),this.m=this.controls.m,this.h=new kn(function(){c.video.currentTime=c.getValue()}),this.s=new kn(function(){xF(c)}),this.B=!1,this.i=[],this.eventManager.o(this.localization,"locale-updated",function(){return xx(c)}),this.eventManager.o(this.localization,"locale-changed",function(){return xx(c)}),this.eventManager.o(this.adManager,"ad-started",function(){Ax(c)||Hn(c.container,!1)}),this.eventManager.o(this.adManager,"ad-stopped",function(){Ax(c)&&Hn(c.container,!0)}),this.eventManager.o(this.adManager,"ad-cue-points-changed",function(p){c.i=p.cuepoints,CF(c)}),this.eventManager.o(this.player,"unloading",function(){c.i=[],CF(c)}),this.setValue(this.video.currentTime),this.update(),xx(this),this.ad&&Hn(this.container,!1)}D(mg,bi),f=mg.prototype,f.release=function(){this.h&&(this.h.stop(),this.h=null,this.s.stop(),this.s=null),bi.prototype.release.call(this)},f.onChangeStart=function(){this.B=!this.video.paused,this.controls.He(!0),this.video.pause()},f.onChange=function(){this.video.duration&&(this.update(),this.h.U(.125))},f.onChangeEnd=function(){this.h.Ga(),this.controls.He(!1),this.B&&this.video.play()},f.isShowing=function(){return!this.container.classList.contains("shaka-hidden")},f.update=function(){var i=this.m.seekBarColors,l=this.getValue(),c=this.video.buffered.length,p=c?this.video.buffered.start(0):0,y=c?this.video.buffered.end(c-1):0,A=this.player.Na(),P=A.end-A.start;this.setRange(A.start,A.end),Ax(this)?(Hn(this.container,!0),c==0?this.container.style.background=i.base:(c=(Math.max(p,A.start)-A.start)/P||0,y=(Math.min(y,A.end)-A.start)/P||0,l=(Math.min(Math.max(l,A.start),A.end)-A.start)/P||0,this.container.style.background="linear-gradient("+["to right",(this.m.showUnbufferedStart?i.base:i.played)+" "+100*c+"%",i.played+" "+100*c+"%",i.played+" "+100*l+"%",i.buffered+" "+100*l+"%",i.buffered+" "+100*y+"%",i.base+" "+100*y+"%"].join()+")")):Hn(this.container,!1)};function xF(i){if(i.i.length){for(var l=i.player.Na(),c=l.end-l.start,p=["to right"],y=[],A=i.m.seekBarColors.adBreaks,P=!1,N=E(i.i),G=N.next();!G.done;G=N.next())if(G=G.value,G.start!=-1||G.end||(P=!0),G.start>=l.start&&G.start<l.end&&!(G.end&&G.end>l.end)){var q=(G.start-l.start)/c||0,ae=q+.01;G.end&&(ae=(G.end-l.start)/c||0),y.push({start:q,end:ae})}for(l=E(y),G=l.next();!G.done;G=l.next())c=G.value,p.push("transparent "+100*c.start+"%"),p.push(A+" "+100*c.start+"%"),p.push(A+" "+100*c.end+"%"),p.push("transparent "+100*c.end+"%");P&&(p.push("transparent 99%"),p.push(A+" 99%")),i.j.style.background="linear-gradient("+p.join(",")+")"}else i.j.style.background="transparent"}function CF(i){xF(i);var l=i.player.Na();l=l.end-l.start,i.player.W()&&5<l&&i.s.na(1)}function Ax(i){var l=i.player.Na();return l=l.end-l.start,i.player.W()&&5>l?!1:i.ad==null||!i.ad.isLinear()}function xx(i){i.bar.ariaLabel=i.localization.resolve("SEEK")}Le("shaka.ui.SeekBar",mg);function Cx(){}Cx.prototype.create=function(i,l){return new mg(i,l)},mg.Factory=Cx;function Pn(i,l,c,p){Ce.call(this);var y=this;this.ha=!0,this.m=p,this.B=new zr(c,i,this.m.castReceiverAppId),this.Db=!0,this.g=this.B.Kb(),this.C=c,this.G=this.B.lc(),this.Ua=i,this.j=l,this.ob=this.G.od(),this.s=this.l=null,this.ka=!1,this.I=[],this.nc=[],this.Gb=!1,this.sa=new kn(function(){y.j.style.cursor="none",y.Gb=!1,wo(y)}),this.Ba=new kn(function(){y.i.removeAttribute("shown"),y.L.U(2)}),this.L=new kn(function(){for(var A=E(y.I),P=A.next();!P.done;P=A.next())Hn(P.value,!1)}),this.cb=new kn(function(){y.Ub()&&gy(y)}),this.M=null,this.J=[],this.bb=z9(),this.h=new _r,this.configure(this.m),G9(this),this.Ca=new Set,Ix(this),this.cb.na(.125),this.h.o(this.bb,"locale-changed",function(A){y.ob.setLocale(A.locales[0])})}D(Pn,Ce),f=Pn.prototype,f.destroy=function(){var i=this;return Z(function(l){switch(l.g){case 1:if(document.pictureInPictureElement!=i.C){l.D(2);break}return I(l,document.exitPictureInPicture(),2);case 2:if(i.h&&(i.h.release(),i.h=null),i.sa&&(i.sa.stop(),i.sa=null),i.Ba&&(i.Ba.stop(),i.Ba=null),i.L&&(i.L.stop(),i.L=null),i.cb&&(i.cb.stop(),i.cb=null),IF(i),i.i&&(i.j.removeChild(i.i),i.i=null),!i.B){l.D(4);break}return I(l,i.B.destroy(),5);case 5:i.B=null;case 4:if(!i.Ua){l.D(6);break}return I(l,i.Ua.destroy(),7);case 7:i.Ua=null;case 6:i.G=null,i.C=null,i.g=null,i.bb=null,i.Ca.clear(),Ce.prototype.release.call(i),U(l)}})};function IF(i){for(var l=E(i.J),c=l.next();!c.done;c=l.next())c.value.release();i.J=[]}function es(i,l){Rx.set(i,l)}f.Sf=function(i){this.Db=i,Ix(this)},f.Og=function(){wo(this)},f.configure=function(i){this.m=i,this.B.Xe(i.castReceiverAppId),this.s&&(this.s=null),this.Eb&&(this.Eb=null),this.pb&&(this.pb=null),this.i?(Pd(this.i),IF(this)):(O9(this),K9(this)),this.j.classList.add("shaka-video-container"),this.C.classList.add("shaka-video"),F9(this),this.m.addBigPlayButton&&N9(this),this.m.customContextMenu&&(this.pb=new gg(this.ia,this),this.J.push(this.pb)),this.Aa||U9(this),this.zb=wn("div"),this.zb.classList.add("shaka-server-side-ad-container"),this.i.appendChild(this.zb),B9(this),this.I=Array.from(this.j.getElementsByClassName("shaka-settings-menu")),this.I.push.apply(this.I,T(Array.from(this.j.getElementsByClassName("shaka-overflow-menu")))),j9(this),this.nc=Array.from(this.j.getElementsByClassName("shaka-show-controls-on-mouse-over")),wo(this),i=E(this.j.getElementsByClassName("shaka-no-propagation"));for(var l=i.next();!l.done;l=i.next()){l=l.value;var c=function(p){return p.stopPropagation()};this.h.o(l,"click",c),this.h.o(l,"dblclick",c)}},f.De=function(i){(this.ha=i)?(this.j.setAttribute("shaka-controls","true"),this.C.tabIndex=-1,this.C.controls=!1):this.j.removeAttribute("shaka-controls"),wo(this)},f.Df=function(i){this.C.controls=i,this.C.tabIndex=i?0:-1,i&&this.De(!1)},f.getAd=function(){return this.l},f.eg=function(){return this.B},f.rg=function(){return this.bb},f.Ig=function(){return this.j},f.Kb=function(){return this.g},f.qg=function(){return this.C},f.lc=function(){return this.G},f.pg=function(){return this.Ua},f.jg=function(){return this.i},f.Ag=function(){return this.zb},f.gg=function(){return this.$},f.hg=function(){return this.m},f.Ng=function(){return this.ka},f.He=function(i){this.ka=i},f.Lg=function(){return this.Db},f.jf=function(){return this.s?this.s.getValue():this.g.currentTime},f.Ef=function(i){this.M=i},f.jd=function(){return this.I.some(function(i){return!i.classList.contains("shaka-hidden")})},f.pc=function(){this.L.Ga()},f.Ne=function(){var i=this,l;return Z(function(c){switch(c.g){case 1:if(document.fullscreenElement)return screen.orientation&&screen.orientation.unlock(),I(c,document.exitFullscreen(),0);if(w(c,4),!document.pictureInPictureElement){c.D(6);break}return I(c,document.exitPictureInPicture(),6);case 6:return I(c,i.j.requestFullscreen({navigationUI:"hide"}),8);case 8:if(!i.m.forceLandscapeOnFullscreen||!screen.orientation){c.D(9);break}return w(c,10),I(c,screen.orientation.lock("landscape"),12);case 12:K(c,9,4);break;case 10:W(c,4);case 9:K(c,0);break;case 4:l=W(c),i.dispatchEvent(new De("error",new Map().set("detail",l))),c.D(0)}})},f.Gf=function(){Hn(this.P,!0),Hn(this.$,!0),this.i.setAttribute("ad-active","true")},f.mf=function(){Hn(this.P,!1),Hn(this.$,!1),this.i.removeAttribute("ad-active")};function RF(i){i.ha&&i.g.duration&&(i.G.Ue(),i.g.paused&&!i.ka?i.g.play():i.g.pause())}function bF(i){i.l&&i.l.isPaused()?i.l.play():i.l&&i.l.pause()}function O9(i){i.i=wn("div"),i.i.classList.add("shaka-controls-container"),i.j.appendChild(i.i),i.j.setAttribute("shaka-controls","true"),i.h.o(i.i,"touchstart",function(l){i.g.duration&&(i.Ub()?i.M=Date.now():(vg(i,l),l.preventDefault()))},{passive:!1}),i.h.o(i.i,"click",function(){DF(i)}),i.h.o(i.i,"dblclick",function(){i.m.doubleClickForFullscreen&&document.fullscreenEnabled&&i.Ne()})}function N9(i){var l=wn("div");l.classList.add("shaka-play-button-container"),i.i.appendChild(l),i.Eb=new pg(l,i),i.J.push(i.Eb)}function F9(i){var l=wn("div");l.classList.add("shaka-scrim-container"),i.i.appendChild(l)}function k9(i){i.P=wn("div"),i.P.classList.add("shaka-ad-controls");var l=i.l!=null&&i.l.isLinear();Hn(i.P,l),i.S.appendChild(i.P),l=new Tx(i.P,i),i.J.push(l),l=new fy(i.P,i),i.J.push(l)}function U9(i){i.Aa=wn("div"),i.Aa.classList.add("shaka-spinner-container"),i.j.appendChild(i.Aa);var l=wn("div");l.classList.add("shaka-spinner"),i.Aa.appendChild(l),i=document.createElementNS("http://www.w3.org/2000/svg","svg"),i.classList.add("shaka-spinner-svg"),i.setAttribute("viewBox","0 0 30 30"),l.appendChild(i),l=document.createElementNS("http://www.w3.org/2000/svg","circle"),l.classList.add("shaka-spinner-path"),l.setAttribute("cx","15"),l.setAttribute("cy","15"),l.setAttribute("r","14.5"),l.setAttribute("fill","none"),l.setAttribute("stroke-width","1"),l.setAttribute("stroke-miterlimit","10"),i.appendChild(l)}function B9(i){i.S=wn("div"),i.S.classList.add("shaka-bottom-controls"),i.S.classList.add("shaka-no-propagation"),i.i.appendChild(i.S),i.h.o(i.S,"click",function(y){y.target.closest(".shaka-overflow-button")||i.pc()}),k9(i),i.ia=wn("div"),i.ia.classList.add("shaka-controls-button-panel"),i.ia.classList.add("shaka-show-controls-on-mouse-over"),i.m.enableTooltips&&i.ia.classList.add("shaka-tooltips-on"),i.S.appendChild(i.ia);for(var l={},c=E(i.m.controlPanelElements),p=c.next();!p.done;l={Bc:l.Bc},p=c.next())p=p.value,Rx.get(p)?(p=Rx.get(p).create(i.ia,i),typeof p.release!="function"&&(Ct("shaka.extern.IUIElement","Please update UI elements to have a release() method."),l.Bc=p,l.Bc.release=function(y){return function(){y.Bc.destroy&&y.Bc.destroy()}}(l)),i.J.push(p)):Re("Unrecognized control panel element requested:",p)}function j9(i){if(i.m.addSeekBar)i.s=LF.create(i.S,i),i.J.push(i.s);else{i=E(i.I);for(var l=i.next();!l.done;l=i.next())l.value.classList.add("shaka-low-position")}}function K9(i){i.$=wn("div"),i.$.classList.add("shaka-client-side-ad-container"),Hn(i.$,!1),i.h.o(i.$,"click",function(){DF(i)}),i.j.appendChild(i.$)}function G9(i){i.h.o(i.G,"buffering",function(){i.ha&&Hn(i.Aa,i.G.Rc())}),i.ha&&Hn(i.Aa,i.G.Rc()),i.h.o(o,"keydown",function(l){V9(i,l)}),i.h.o(o,"click",function(){return i.pc()}),i.h.o(i,"submenuopen",function(){i.pc()}),i.h.o(i.g,"play",function(){wo(i)}),i.h.o(i.g,"pause",function(){wo(i)}),i.h.o(i.j,"mousemove",function(l){vg(i,l)}),i.h.o(i.j,"touchmove",function(l){vg(i,l)},{passive:!0}),i.h.o(i.j,"touchend",function(l){vg(i,l)},{passive:!0}),i.h.o(i.j,"mouseleave",function(){i.M||i.sa.Ga()}),i.h.o(i.B,"caststatuschanged",function(){Ix(i)}),i.h.o(i.j,"keydown",function(l){var c=document.activeElement,p=c&&c.classList?c.classList.contains("shaka-volume-bar"):!1,y=c&&c.classList&&c.classList.contains("shaka-seek-bar");if(i.i.contains(c)&&vg(i,l),i.m.enableKeyboardPlaybackControls)switch(l.key){case"ArrowLeft":i.s&&!p&&(l.preventDefault(),py(i,i.s.getValue()-5));break;case"ArrowRight":i.s&&!p&&(l.preventDefault(),py(i,i.s.getValue()+5));break;case"Home":i.s&&py(i,i.G.Na().start);break;case"End":i.s&&py(i,i.G.Na().end);break;case" ":y&&PF(i)}}),i.h.o(i.j,"keyup",function(l){i.Ca.delete(l.key)}),i.h.o(i.ob,"ad-started",function(l){i.l=l.ad,i.Gf()}),i.h.o(i.ob,"ad-stopped",function(){i.l=null,i.mf()}),screen.orientation&&i.h.o(screen.orientation,"change",function(){return Z(function(l){return I(l,W9(i),0)})}),i.h.o(document,"fullscreenchange",function(){i.l&&i.l.resize(i.C.offsetWidth,i.C.offsetHeight)})}function W9(i){return Z(function(l){return i.g&&i.g.readyState!=0&&!i.B.xa()&&i.m.enableFullscreenOnRotation?screen.orientation.type.includes("landscape")&&!document.fullscreenElement?I(l,i.j.requestFullscreen({navigationUI:"hide"}),0):screen.orientation.type.includes("portrait")&&document.fullscreenElement?I(l,document.exitFullscreen(),0):l.D(0):l.return()})}function vg(i,l){l.type=="mousemove"&&(i.i.classList.remove("shaka-keyboard-navigation"),wo(i)),l.type=="touchstart"||l.type=="touchmove"||l.type=="touchend"||l.type=="keyup"?i.M=Date.now():i.M+1e3<Date.now()&&(i.M=null),i.M&&l.type=="mousemove"||(i.j.style.cursor="",i.Gb=!0,i.L.stop(),i.Ub()||(gy(i),wo(i)),i.sa.stop(),l.type!="touchend"&&l.type!="keyup"&&i.M||i.sa.U(3))}function H9(i){return o.matchMedia("hover: hover").matches?i.nc.some(function(l){return l.matches(":hover")}):!1}function wo(i){var l=i.l?i.l.isPaused():!1,c=i.g.paused&&!i.ka,p=i.i.classList.contains("shaka-keyboard-navigation");l||(!i.l||!i.l.isLinear())&&c||i.Gb||p||H9(i)?(gy(i),i.i.setAttribute("shown","true"),i.Ba.stop()):i.Ba.U(i.m.fadeDelay)}function DF(i){i.ha&&(i.jd()?i.L.Ga():i.m.singleClickForPlayAndPause&&PF(i))}function PF(i){i.l&&i.l.isLinear()?bF(i):RF(i)}function Ix(i){var l=i.B.xa();i.dispatchEvent(new De("caststatuschanged",new Map().set("newStatus",l))),l?i.i.setAttribute("casting","true"):i.i.removeAttribute("casting")}f.Ub=function(){return this.ha?this.i.getAttribute("shown")!=null||this.i.getAttribute("casting")!=null:!1};function py(i,l){i.s.changeTo(l),i.Ub()&&gy(i)}function gy(i){if(i.s)if(i.s.setValue(i.g.currentTime),i.s.update(),i.s.isShowing())for(var l=E(i.I),c=l.next();!c.done;c=l.next())c.value.classList.remove("shaka-low-position");else for(l=E(i.I),c=l.next();!c.done;c=l.next())c.value.classList.add("shaka-low-position");i.dispatchEvent(new De("timeandseekrangeupdated"))}function V9(i,l){i.Ca.add(l.key);var c=i.jd();l.key=="Tab"&&(i.i.classList.add("shaka-keyboard-navigation"),wo(i),i.h.o(o,"mousedown",function(){i.h.Ta(o,"mousedown")})),l.key=="Escape"&&i.L.Ga(),c&&i.Ca.has("Tab")&&$9(i,l)}function $9(i,l){var c=i.I.filter(function(A){return!A.classList.contains("shaka-hidden")});if(c.length){var p=c[0];if(p.childNodes.length){for(c=p.firstElementChild;c&&c.classList.contains("shaka-hidden");)c=c.nextElementSibling;for(p=p.lastElementChild;p&&p.classList.contains("shaka-hidden");)p=p.previousElementSibling;var y=document.activeElement;i.Ca.has("Shift")?y==c&&(l.preventDefault(),p.focus()):y==p&&(l.preventDefault(),c.focus())}}}function z9(){var i=new At("en");return i.ma("ar",new Map([["AD_DURATION","مدة الإعلان"],["AD_PROGRESS","الإعلان [AD_ON] من [NUM_ADS]"],["AD_TIME","الإعلان: [AD_TIME]"],["AUTO_QUALITY","تلقائي"],["BACK","رجوع"],["CAPTIONS","الترجمة والشرح"],["CAST","إرسال..."],["ENTER_LOOP_MODE","تكرار الفيديو الحالي"],["ENTER_PICTURE_IN_PICTURE",'الدخول في وضع "نافذة ضمن نافذة"'],["EXIT_FULL_SCREEN","إنهاء وضع ملء الشاشة"],["EXIT_LOOP_MODE","إيقاف تكرار الفيديو الحالي"],["EXIT_PICTURE_IN_PICTURE",'الخروج من وضع "نافذة ضمن نافذة"'],["FAST_FORWARD","تقديم سريع"],["FULL_SCREEN","ملء الشاشة"],["LANGUAGE","اللغة"],["LIVE","مباشر"],["LOOP","تكرار"],["MORE_SETTINGS","مزيد من الإعدادات"],["MULTIPLE_LANGUAGES","لغات متعددة"],["MUTE","كتم الصوت"],["NOT_APPLICABLE","غير سارٍ"],["OFF","إيقاف"],["ON","تشغيل"],["PAUSE","إيقاف مؤقت"],["PICTURE_IN_PICTURE","نافذة ضمن النافذة"],["PLAY","التشغيل"],["PLAYBACK_RATE","سرعة التشغيل"],["RESOLUTION","درجة الدقة"],["REWIND","ترجيع"],["SEEK","البحث بالتمرير"],["SKIP_AD","تخطّي الإعلان"],["SKIP_TO_LIVE","الانتقال إلى بث مباشر"],["UNDETERMINED_LANGUAGE","غير محدد"],["UNMUTE","إعادة الصوت"],["UNRECOGNIZED_LANGUAGE","غير معروف"],["VOLUME","مستوى الصوت"]])),i.ma("de",new Map([["AD_DURATION","Dauer der Werbeanzeige"],["AD_PROGRESS","Werbung [AD_ON] von [NUM_ADS]"],["AD_TIME","Werbeanzeige: [AD_TIME]"],["AUTO_QUALITY","Automatisch"],["BACK","Zurück"],["CAPTIONS","Untertitel"],["CAST","Streamen..."],["ENTER_LOOP_MODE","In Endlosschleife spielen"],["ENTER_PICTURE_IN_PICTURE","Bild-im-Bild-Modus aktivieren"],["EXIT_FULL_SCREEN","Vollbildmodus beenden"],["EXIT_LOOP_MODE","Endlosschleife stoppen"],["EXIT_PICTURE_IN_PICTURE","Bild-im-Bild-Modus beenden"],["FAST_FORWARD","Vorspulen"],["FULL_SCREEN","Vollbildmodus"],["LANGUAGE","Sprache"],["LIVE","Live"],["LOOP","Schleife"],["MORE_SETTINGS","Weitere Einstellungen"],["MULTIPLE_LANGUAGES","Mehrere Sprachen"],["MUTE","Stummschalten"],["NOT_APPLICABLE","Nicht zutreffend"],["OFF","Aus"],["ON","Ein"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Bild im Bild"],["PLAY","Wiedergabe"],["PLAYBACK_RATE","Geschwindigkeit"],["RESOLUTION","Auflösung"],["REWIND","Zurückspulen"],["SEEK","Suche"],["SKIP_AD","Überspringen"],["SKIP_TO_LIVE","Zum Live-Videostream wechseln"],["UNDETERMINED_LANGUAGE","Unbestimmt"],["UNMUTE","Stummschaltung aufheben"],["UNRECOGNIZED_LANGUAGE","Unbekannt"],["VOLUME","Lautstärke"]])),i.ma("en",new Map([["AD_DURATION","Ad duration"],["AD_PROGRESS","Ad [AD_ON] of [NUM_ADS]"],["AD_TIME","Ad: [AD_TIME]"],["AIRPLAY","AirPlay"],["AUTO_QUALITY","Auto"],["BACK","Back"],["CAPTIONS","Captions"],["CAST","Cast..."],["ENTER_LOOP_MODE","Loop the current video"],["ENTER_PICTURE_IN_PICTURE","Enter Picture-in-Picture"],["EXIT_FULL_SCREEN","Exit full screen"],["EXIT_LOOP_MODE","Stop looping the current video"],["EXIT_PICTURE_IN_PICTURE","Exit Picture-in-Picture"],["FAST_FORWARD","Fast-forward"],["FULL_SCREEN","Full screen"],["LANGUAGE","Language"],["LIVE","Live"],["LOOP","Loop"],["MORE_SETTINGS","More settings"],["MULTIPLE_LANGUAGES","Multiple languages"],["MUTE","Mute"],["NOT_APPLICABLE","Not applicable"],["OFF","Off"],["ON","On"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Picture-in-Picture"],["PLAY","Play"],["PLAYBACK_RATE","Playback speed"],["REPLAY","Replay"],["RESOLUTION","Resolution"],["REWIND","Rewind"],["SEEK","Seek"],["SKIP_AD","Skip Ad"],["SKIP_TO_LIVE","Skip ahead to live"],["STATISTICS","Statistics"],["SUBTITLE_FORCED","Forced"],["UNDETERMINED_LANGUAGE","Undetermined"],["UNMUTE","Unmute"],["UNRECOGNIZED_LANGUAGE","Unrecognized"],["VOLUME","Volume"]])),i.ma("en-GB",new Map([["AD_DURATION","Ad duration"],["AD_PROGRESS","Ad [AD_ON] of [NUM_ADS]"],["AD_TIME","Ad: [AD_TIME]"],["AUTO_QUALITY","Auto"],["BACK","Back"],["CAPTIONS","Captions"],["CAST","Cast..."],["ENTER_LOOP_MODE","Loop the current video"],["ENTER_PICTURE_IN_PICTURE","Enter picture-in-picture"],["EXIT_FULL_SCREEN","Exit full screen"],["EXIT_LOOP_MODE","Stop looping the current video"],["EXIT_PICTURE_IN_PICTURE","Exit picture-in-picture"],["FAST_FORWARD","Fast-forward"],["FULL_SCREEN","Full screen"],["LANGUAGE","Language"],["LIVE","Live"],["LOOP","Loop"],["MORE_SETTINGS","More settings"],["MULTIPLE_LANGUAGES","Multiple languages"],["MUTE","Mute"],["NOT_APPLICABLE","Not applicable"],["OFF","Off"],["ON","On"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Picture-in-picture"],["PLAY","Play"],["PLAYBACK_RATE","Playback speed"],["RESOLUTION","Resolution"],["REWIND","Rewind"],["SEEK","Seek"],["SKIP_AD","Skip ad"],["SKIP_TO_LIVE","Skip ahead to live"],["UNDETERMINED_LANGUAGE","Undetermined"],["UNMUTE","Unmute"],["UNRECOGNIZED_LANGUAGE","Unrecognised"],["VOLUME","volume"]])),i.ma("es",new Map([["AD_DURATION","Duración del anuncio"],["AD_PROGRESS","Anuncio [AD_ON] de [NUM_ADS]"],["AD_TIME","Anuncio: [AD_TIME]"],["AUTO_QUALITY","Automático"],["BACK","Atrás"],["CAPTIONS","Subtítulos"],["CAST","Enviar..."],["ENTER_LOOP_MODE","Reproducir en bucle el vídeo actual"],["ENTER_PICTURE_IN_PICTURE","Activar el modo imagen en imagen"],["EXIT_FULL_SCREEN","Salir del modo de pantalla completa"],["EXIT_LOOP_MODE","Dejar de reproducir en bucle el vídeo actual"],["EXIT_PICTURE_IN_PICTURE","Salir del modo imagen en imagen"],["FAST_FORWARD","Avanzar rápidamente"],["FULL_SCREEN","Pantalla completa"],["LANGUAGE","Idioma"],["LIVE","En directo"],["LOOP","Reproducir en bucle"],["MORE_SETTINGS","Más ajustes"],["MULTIPLE_LANGUAGES","Varios idiomas"],["MUTE","Silenciar"],["NOT_APPLICABLE","No aplicable"],["OFF","Desactivado"],["ON","Activado"],["PAUSE","Pausar"],["PICTURE_IN_PICTURE","Imagen en imagen"],["PLAY","Reproducir"],["PLAYBACK_RATE","Velocidad de reproducción"],["RESOLUTION","Resolución"],["REWIND","Rebobinar"],["SEEK","Buscar"],["SKIP_AD","Saltar anuncio"],["SKIP_TO_LIVE","Ir al vídeo en directo"],["SUBTITLE_FORCED","Forzado"],["UNDETERMINED_LANGUAGE","Sin especificar"],["UNMUTE","Activar sonido"],["UNRECOGNIZED_LANGUAGE","No reconocida"],["VOLUME","Volumen"]])),i.ma("es-419",new Map([["AD_DURATION","Duración del anuncio"],["AD_PROGRESS","Anuncio [AD_ON] de [NUM_ADS]"],["AD_TIME","Anuncio: [AD_TIME]"],["AUTO_QUALITY","Automático"],["BACK","Atrás"],["CAPTIONS","Subtítulos"],["CAST","Transmitir..."],["ENTER_LOOP_MODE","Repetir indefinidamente el video actual"],["ENTER_PICTURE_IN_PICTURE","Ingresar al modo de pantalla en pantalla"],["EXIT_FULL_SCREEN","Salir de pantalla completa"],["EXIT_LOOP_MODE","Detener la repetición indefinida del video actual"],["EXIT_PICTURE_IN_PICTURE","Salir del modo de pantalla en pantalla"],["FAST_FORWARD","Avanzar"],["FULL_SCREEN","Pantalla completa"],["LANGUAGE","Idioma"],["LIVE","En directo"],["LOOP","Repetir indefinidamente"],["MORE_SETTINGS","Más opciones de configuración"],["MULTIPLE_LANGUAGES","Varios idiomas"],["MUTE","Silenciar"],["NOT_APPLICABLE","No aplicable"],["OFF","Desactivado"],["ON","Activado"],["PAUSE","Detener"],["PICTURE_IN_PICTURE","Pantalla en pantalla"],["PLAY","Reproducir"],["PLAYBACK_RATE","Velocidad de reproducción"],["RESOLUTION","Resolución"],["REWIND","Retroceder"],["SEEK","Buscar"],["SKIP_AD","Omitir anuncio"],["SKIP_TO_LIVE","Adelantar hasta la transmisión en vivo"],["SUBTITLE_FORCED","Forzado"],["UNDETERMINED_LANGUAGE","Sin especificar"],["UNMUTE","Dejar de silenciar"],["UNRECOGNIZED_LANGUAGE","No reconocida"],["VOLUME","Volumen"]])),i.ma("fr",new Map([["AD_DURATION","Durée de l'annonce"],["AD_PROGRESS","Annonce [AD_ON] sur [NUM_ADS]"],["AD_TIME","Annonce : [AD_TIME]"],["AUTO_QUALITY","Automatique"],["BACK","Retour"],["CAPTIONS","Sous-titres"],["CAST","Caster…"],["ENTER_LOOP_MODE","Lire en boucle la vidéo en cours"],["ENTER_PICTURE_IN_PICTURE","Utiliser le mode Picture-in-Picture"],["EXIT_FULL_SCREEN","Quitter le mode plein écran"],["EXIT_LOOP_MODE","Arrêter la lecture en boucle de la vidéo en cours"],["EXIT_PICTURE_IN_PICTURE","Quitter le mode PIP (Picture-in-picture)"],["FAST_FORWARD","Avance rapide"],["FULL_SCREEN","Plein écran"],["LANGUAGE","Langue"],["LIVE","En direct"],["LOOP","Répéter"],["MORE_SETTINGS","Plus de paramètres"],["MULTIPLE_LANGUAGES","Plusieurs langues"],["MUTE","Couper le son"],["NOT_APPLICABLE","Non applicable"],["OFF","Désactivée"],["ON","Activée"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Picture-in-Picture"],["PLAY","Visionner"],["PLAYBACK_RATE","Vitesse de lecture"],["RESOLUTION","Résolution"],["REWIND","Retour arrière"],["SEEK","Chercher"],["SKIP_AD","Passer l'annonce"],["SKIP_TO_LIVE","Accéder à la partie la plus récente du direct"],["UNDETERMINED_LANGUAGE","Langue indéterminée"],["UNMUTE","Réactiver le son"],["UNRECOGNIZED_LANGUAGE","Non reconnu"],["VOLUME","Volume"]])),i.ma("it",new Map([["AD_DURATION","Durata dell'annuncio"],["AD_PROGRESS","Annuncio [AD_ON] di [NUM_ADS]"],["AD_TIME","Annuncio: [AD_TIME]"],["AUTO_QUALITY","Automatica"],["BACK","Indietro"],["CAPTIONS","Sottotitoli"],["CAST","Trasmetti..."],["ENTER_LOOP_MODE","Riproduci in loop il video corrente"],["ENTER_PICTURE_IN_PICTURE","Attiva Picture in picture"],["EXIT_FULL_SCREEN","Esci da schermo intero"],["EXIT_LOOP_MODE","Interrompi riproduzione in loop del video corrente"],["EXIT_PICTURE_IN_PICTURE","Esci da Picture in picture"],["FAST_FORWARD","Avanti veloce"],["FULL_SCREEN","Schermo intero"],["LANGUAGE","Lingua"],["LIVE","Dal vivo"],["LOOP","Riproduci in loop"],["MORE_SETTINGS","Altre impostazioni"],["MULTIPLE_LANGUAGES","Più lingue"],["MUTE","Disattiva audio"],["NOT_APPLICABLE","Non applicabile"],["OFF","Disattivo"],["ON","Attivo"],["PAUSE","Metti in pausa"],["PICTURE_IN_PICTURE","Picture in picture"],["PLAY","Riproduci"],["PLAYBACK_RATE","Velocità di riproduzione"],["RESOLUTION","Risoluzione"],["REWIND","Riavvolgi"],["SEEK","Cerca"],["SKIP_AD","Salta annuncio"],["SKIP_TO_LIVE","Passa alla trasmissione dal vivo"],["UNDETERMINED_LANGUAGE","Indeterminata"],["UNMUTE","Riattiva audio"],["UNRECOGNIZED_LANGUAGE","Non riconosciuto"],["VOLUME","Volume"]])),i.ma("ja",new Map([["AD_DURATION","広告再生時間"],["AD_PROGRESS","[AD_ON] 番目の広告（全 [NUM_ADS] 個）"],["AD_TIME","広告: [AD_TIME]"],["AUTO_QUALITY","自動"],["BACK","戻る"],["CAPTIONS","字幕"],["CAST","キャスト..."],["ENTER_LOOP_MODE","現在の動画をループ再生"],["ENTER_PICTURE_IN_PICTURE","ピクチャー イン ピクチャーを開始"],["EXIT_FULL_SCREEN","全画面表示を終了"],["EXIT_LOOP_MODE","現在の動画のループ再生を停止"],["EXIT_PICTURE_IN_PICTURE","ピクチャー イン ピクチャーを終了"],["FAST_FORWARD","早送り"],["FULL_SCREEN","全画面表示"],["LANGUAGE","言語"],["LIVE","ライブ"],["LOOP","ループ"],["MORE_SETTINGS","詳細設定"],["MULTIPLE_LANGUAGES","多言語"],["MUTE","ミュート"],["NOT_APPLICABLE","該当なし"],["OFF","オフ"],["ON","オン"],["PAUSE","一時停止"],["PICTURE_IN_PICTURE","ピクチャー イン ピクチャー"],["PLAY","再生"],["PLAYBACK_RATE","再生速度"],["RESOLUTION","解像度"],["REWIND","巻き戻し"],["SEEK","シーク再生"],["SKIP_AD","広告をスキップ"],["SKIP_TO_LIVE","ライブ配信までスキップ"],["UNDETERMINED_LANGUAGE","不明"],["UNMUTE","ミュートを解除"],["UNRECOGNIZED_LANGUAGE","不明"],["VOLUME","音量"]])),i.ma("ko",new Map([["AD_DURATION","광고 기간"],["AD_PROGRESS","광고 [AD_ON]/[NUM_ADS]"],["AD_TIME","광고: [AD_TIME]"],["AUTO_QUALITY","자동"],["BACK","뒤로"],["CAPTIONS","자막"],["CAST","전송..."],["ENTER_LOOP_MODE","현재 동영상 반복 재생"],["ENTER_PICTURE_IN_PICTURE","PIP 모드 시작"],["EXIT_FULL_SCREEN","전체화면 닫기"],["EXIT_LOOP_MODE","현재 동영상 반복 재생 중지"],["EXIT_PICTURE_IN_PICTURE","PIP 모드 종료"],["FAST_FORWARD","빨리 감기"],["FULL_SCREEN","전체화면"],["LANGUAGE","언어"],["LIVE","실시간"],["LOOP","반복 재생"],["MORE_SETTINGS","설정 더보기"],["MULTIPLE_LANGUAGES","여러 언어"],["MUTE","음소거"],["NOT_APPLICABLE","해당 사항 없음"],["OFF","사용 안함"],["ON","사용"],["PAUSE","일시중지"],["PICTURE_IN_PICTURE","PIP 모드"],["PLAY","재생"],["PLAYBACK_RATE","재생 속도"],["RESOLUTION","해상도"],["REWIND","되감기"],["SEEK","찾기"],["SKIP_AD","광고 건너뛰기"],["SKIP_TO_LIVE","라이브 동영상으로 건너뛰기"],["UNDETERMINED_LANGUAGE","미정"],["UNMUTE","음소거 해제"],["UNRECOGNIZED_LANGUAGE","알 수 없음"],["VOLUME","볼륨"]])),i.ma("nl",new Map([["AD_DURATION","Advertentieduur"],["AD_PROGRESS","Advertentie [AD_ON] van [NUM_ADS]"],["AD_TIME","Advertentie: [AD_TIME]"],["AUTO_QUALITY","Automatisch"],["BACK","Terug"],["CAPTIONS","Ondertiteling"],["CAST","Casten..."],["ENTER_LOOP_MODE","De huidige video lussen"],["ENTER_PICTURE_IN_PICTURE","Scherm-in-scherm openen"],["EXIT_FULL_SCREEN","Volledig scherm sluiten"],["EXIT_LOOP_MODE","De huidige video niet meer lussen"],["EXIT_PICTURE_IN_PICTURE","Scherm-in-scherm afsluiten"],["FAST_FORWARD","Vooruitspoelen"],["FULL_SCREEN","Volledig scherm"],["LANGUAGE","Taal"],["LIVE","Live"],["LOOP","Lussen"],["MORE_SETTINGS","Meer instellingen"],["MULTIPLE_LANGUAGES","Meerdere talen"],["MUTE","Dempen"],["NOT_APPLICABLE","Niet van toepassing"],["OFF","Uit"],["ON","Aan"],["PAUSE","Onderbreken"],["PICTURE_IN_PICTURE","Scherm-in-scherm"],["PLAY","Afspelen"],["PLAYBACK_RATE","Afspeelsnelheid"],["RESOLUTION","Resolutie"],["REWIND","Terugspoelen"],["SEEK","Zoeken"],["SKIP_AD","Advertentie overslaan"],["SKIP_TO_LIVE","Doorgaan naar live"],["UNDETERMINED_LANGUAGE","Onbepaald"],["UNMUTE","Dempen opheffen"],["UNRECOGNIZED_LANGUAGE","Onbekend"],["VOLUME","Volume"]])),i.ma("pl",new Map([["AD_DURATION","Czas trwania reklamy"],["AD_PROGRESS","Reklama [AD_ON] z [NUM_ADS]"],["AD_TIME","Reklama: [AD_TIME]"],["AUTO_QUALITY","Automatycznie"],["BACK","Wstecz"],["CAPTIONS","Napisy"],["CAST","Przesyłaj..."],["ENTER_LOOP_MODE","Odtwarzaj bieżący film w pętli"],["ENTER_PICTURE_IN_PICTURE","Włącz tryb obrazu w obrazie"],["EXIT_FULL_SCREEN","Zamknij pełny ekran"],["EXIT_LOOP_MODE","Wyłącz odtwarzanie bieżącego filmu w pętli"],["EXIT_PICTURE_IN_PICTURE","Wyłącz tryb obrazu w obrazie"],["FAST_FORWARD","Przewiń do przodu"],["FULL_SCREEN","Pełny ekran"],["LANGUAGE","Język"],["LIVE","Na żywo"],["LOOP","Odtwarzaj w pętli"],["MORE_SETTINGS","Więcej ustawień"],["MULTIPLE_LANGUAGES","Wiele języków"],["MUTE","Wycisz"],["NOT_APPLICABLE","Nie dotyczy"],["OFF","Wyłączone"],["ON","Włączone"],["PAUSE","Wstrzymaj"],["PICTURE_IN_PICTURE","Obraz w obrazie"],["PLAY","Odtwórz"],["PLAYBACK_RATE","Szybkość odtwarzania"],["RESOLUTION","Rozdzielczość"],["REWIND","Przewiń do tyłu"],["SEEK","Szukaj"],["SKIP_AD","Pomiń reklamę"],["SKIP_TO_LIVE","Przejdź do transmisji na żywo"],["UNDETERMINED_LANGUAGE","Nie określono"],["UNMUTE","Wyłącz wyciszenie"],["UNRECOGNIZED_LANGUAGE","Nierozpoznany"],["VOLUME","Głośność"]])),i.ma("pt-BR",new Map([["AD_DURATION","Duração do anúncio"],["AD_PROGRESS","Anúncio [AD_ON] de [NUM_ADS]"],["AD_TIME","Anúncio: [AD_TIME]"],["AUTO_QUALITY","Automática"],["BACK","Voltar"],["CAPTIONS","Legendas"],["CAST","Transmitir..."],["ENTER_LOOP_MODE","Repetir o vídeo atual"],["ENTER_PICTURE_IN_PICTURE","Entrar no modo picture-in-picture"],["EXIT_FULL_SCREEN","Sair do modo tela cheia"],["EXIT_LOOP_MODE","Parar repetição do vídeo atual"],["EXIT_PICTURE_IN_PICTURE","Sair de picture-in-picture"],["FAST_FORWARD","Avançar"],["FULL_SCREEN","Tela cheia"],["LANGUAGE","Idioma"],["LIVE","Ao vivo"],["LOOP","Repetir"],["MORE_SETTINGS","Mais definições"],["MULTIPLE_LANGUAGES","Vários idiomas"],["MUTE","Desativar som"],["NOT_APPLICABLE","Não relevante"],["OFF","Desativado"],["ON","Ativado"],["PAUSE","Pausar"],["PICTURE_IN_PICTURE","Picture-in-picture"],["PLAY","Reproduzir"],["PLAYBACK_RATE","Velocidade da reprodução"],["RESOLUTION","Resolução"],["REWIND","Retroceder"],["SEEK","Procurar"],["SKIP_AD","Pular anúncio"],["SKIP_TO_LIVE","Pular para transmissão ao vivo"],["UNDETERMINED_LANGUAGE","Indeterminado"],["UNMUTE","Ativar som"],["UNRECOGNIZED_LANGUAGE","Não reconhecido"],["VOLUME","Volume"]])),i.ma("ru",new Map([["AD_DURATION","Продолжительность рекламы"],["AD_PROGRESS","Реклама [AD_ON] из [NUM_ADS]"],["AD_TIME","Реклама: [AD_TIME]"],["AUTO_QUALITY","Авто"],["BACK","Назад"],["CAPTIONS","Субтитры"],["CAST","Транслировать..."],["ENTER_LOOP_MODE","Зациклить текущее видео"],["ENTER_PICTURE_IN_PICTURE",'Перейти в режим "Картинка в картинке"'],["EXIT_FULL_SCREEN","Обычный режим"],["EXIT_LOOP_MODE","Отменить зацикливание текущего видео"],["EXIT_PICTURE_IN_PICTURE",'Выйти из режима "Картинка в картинке"'],["FAST_FORWARD","Перемотка вперед"],["FULL_SCREEN","Полноэкранный режим"],["LANGUAGE","Язык"],["LIVE","Прямой эфир"],["LOOP","Зациклить"],["MORE_SETTINGS","Дополнительные настройки"],["MULTIPLE_LANGUAGES","Несколько языков"],["MUTE","Отключить звук"],["NOT_APPLICABLE","Неприменимо"],["OFF","Выкл."],["ON","Вкл."],["PAUSE","Пауза"],["PICTURE_IN_PICTURE","Картинка в картинке"],["PLAY","Воспроизвести"],["PLAYBACK_RATE","Скорость воспроизведения"],["RESOLUTION","Разрешение"],["REWIND","Перемотать назад"],["SEEK","Перемотка"],["SKIP_AD","Пропустить"],["SKIP_TO_LIVE","Пропустить и перейти к прямой трансляции"],["UNDETERMINED_LANGUAGE","Не указано"],["UNMUTE","Включить звук"],["UNRECOGNIZED_LANGUAGE","Не распознано"],["VOLUME","Громкость"]])),i.ma("th",new Map([["AD_DURATION","ระยะเวลาโฆษณา"],["AD_PROGRESS","โฆษณา [AD_ON] จาก [NUM_ADS] รายการ"],["AD_TIME","โฆษณา: [AD_TIME]"],["AUTO_QUALITY","อัตโนมัติ"],["BACK","กลับ"],["CAPTIONS","คำบรรยาย"],["CAST","แคสต์..."],["ENTER_LOOP_MODE","วนซ้ำวิดีโอปัจจุบัน"],["ENTER_PICTURE_IN_PICTURE","เข้าสู่การแสดงภาพซ้อนภาพ"],["EXIT_FULL_SCREEN","ออกจากการแสดงแบบเต็มหน้าจอ"],["EXIT_LOOP_MODE","หยุดวนซ้ำวิดีโอปัจจุบัน"],["EXIT_PICTURE_IN_PICTURE","ออกจากการแสดงภาพซ้อนภาพ"],["FAST_FORWARD","กรอไปข้างหน้า"],["FULL_SCREEN","เต็มหน้าจอ"],["LANGUAGE","ภาษา"],["LIVE","สด"],["LOOP","ลูป"],["MORE_SETTINGS","การตั้งค่าเพิ่มเติม"],["MULTIPLE_LANGUAGES","หลายภาษา"],["MUTE","ปิดเสียง"],["NOT_APPLICABLE","ไม่เกี่ยวข้อง"],["OFF","ปิด"],["ON","เปิด"],["PAUSE","หยุดชั่วคราว"],["PICTURE_IN_PICTURE","การแสดงภาพซ้อนภาพ"],["PLAY","เล่น"],["PLAYBACK_RATE","ความเร็วในการเล่น"],["RESOLUTION","ความละเอียด"],["REWIND","กรอกลับ"],["SEEK","ค้นหา"],["SKIP_AD","ข้ามโฆษณา"],["SKIP_TO_LIVE","ข้ามไปที่การถ่ายทอดสด"],["UNDETERMINED_LANGUAGE","ไม่กำหนด"],["UNMUTE","เปิดเสียง"],["UNRECOGNIZED_LANGUAGE","ที่ไม่รู้จัก"],["VOLUME","ระดับเสียง"]])),i.ma("tr",new Map([["AD_DURATION","Reklam süresi"],["AD_PROGRESS","[AD_ON]/[NUM_ADS] reklam"],["AD_TIME","Reklam: [AD_TIME]"],["AUTO_QUALITY","Otomatik"],["BACK","Geri"],["CAPTIONS","Altyazılar"],["CAST","Yayınla..."],["ENTER_LOOP_MODE","Mevcut videoyu döngüye al"],["ENTER_PICTURE_IN_PICTURE","Pencere içinde Pencere moduna gir"],["EXIT_FULL_SCREEN","Tam ekrandan çık"],["EXIT_LOOP_MODE","Mevcut videonun döngüsünü durdur"],["EXIT_PICTURE_IN_PICTURE","Pencere İçinde Pencereden Çık"],["FAST_FORWARD","İleri sar"],["FULL_SCREEN","Tam ekran"],["LANGUAGE","Dil"],["LIVE","Canlı"],["LOOP","Döngü"],["MORE_SETTINGS","Daha fazla ayar"],["MULTIPLE_LANGUAGES","Birden çok dil"],["MUTE","Sesi kapat"],["NOT_APPLICABLE","Geçerli değil"],["OFF","Kapalı"],["ON","Açık"],["PAUSE","Duraklat"],["PICTURE_IN_PICTURE","Pencere İçinde Pencere"],["PLAY","Oynat"],["PLAYBACK_RATE","Çalma hızı"],["RESOLUTION","Çözünürlük"],["REWIND","Geri sar"],["SEEK","Ara"],["SKIP_AD","Reklamı Atla"],["SKIP_TO_LIVE","Canlı yayına atla"],["UNDETERMINED_LANGUAGE","Belirsiz"],["UNMUTE","Sesi aç"],["UNRECOGNIZED_LANGUAGE","Tanınmayan"],["VOLUME","Ses"]])),i.ma("zh",new Map([["AD_DURATION","广告持续时间"],["AD_PROGRESS","广告 [AD_ON]/[NUM_ADS]"],["AD_TIME","广告：[AD_TIME]"],["AUTO_QUALITY","自动"],["BACK","返回"],["CAPTIONS","字幕"],["CAST","投射…"],["ENTER_LOOP_MODE","循环播放当前视频"],["ENTER_PICTURE_IN_PICTURE","进入“画中画”模式"],["EXIT_FULL_SCREEN","退出全屏模式"],["EXIT_LOOP_MODE","停止循环播放当前视频"],["EXIT_PICTURE_IN_PICTURE","退出“画中画”模式"],["FAST_FORWARD","快进"],["FULL_SCREEN","全屏"],["LANGUAGE","语言"],["LIVE","直播"],["LOOP","循环播放"],["MORE_SETTINGS","更多设置"],["MULTIPLE_LANGUAGES","多种语言"],["MUTE","静音"],["NOT_APPLICABLE","不适用"],["OFF","关闭"],["ON","开启"],["PAUSE","暂停"],["PICTURE_IN_PICTURE","画中画"],["PLAY","播放"],["PLAYBACK_RATE","播放速度"],["RESOLUTION","分辨率"],["REWIND","快退"],["SEEK","进度"],["SKIP_AD","跳过广告"],["SKIP_TO_LIVE","跳至当前直播"],["UNDETERMINED_LANGUAGE","未确定"],["UNMUTE","取消静音"],["UNRECOGNIZED_LANGUAGE","无法识别"],["VOLUME","音量"]])),i.ma("zh-TW",new Map([["AD_DURATION","廣告長度"],["AD_PROGRESS","廣告 [AD_ON]/[NUM_ADS]"],["AD_TIME","廣告：[AD_TIME]"],["AUTO_QUALITY","自動"],["BACK","返回"],["CAPTIONS","字幕"],["CAST","投放..."],["ENTER_LOOP_MODE","循環播放目前的影片"],["ENTER_PICTURE_IN_PICTURE","進入子母畫面"],["EXIT_FULL_SCREEN","退出全螢幕模式"],["EXIT_LOOP_MODE","停止循環播放目前的影片"],["EXIT_PICTURE_IN_PICTURE","離開子母畫面"],["FAST_FORWARD","快轉"],["FULL_SCREEN","全螢幕"],["LANGUAGE","語言"],["LIVE","直播"],["LOOP","循環播放"],["MORE_SETTINGS","顯示更多設定"],["MULTIPLE_LANGUAGES","多種語言"],["MUTE","靜音"],["NOT_APPLICABLE","不適用"],["OFF","關閉"],["ON","開啟"],["PAUSE","暫停"],["PICTURE_IN_PICTURE","子母畫面"],["PLAY","播放"],["PLAYBACK_RATE","播放速度"],["RESOLUTION","解析度"],["REWIND","倒轉"],["SEEK","搜尋"],["SKIP_AD","略過廣告"],["SKIP_TO_LIVE","跳至当前直播"],["UNDETERMINED_LANGUAGE","不明"],["UNMUTE","取消靜音"],["UNRECOGNIZED_LANGUAGE","無法辨識"],["VOLUME","音量"]])),i.We(navigator.languages||[]),i}Le("shaka.ui.Controls",Pn),Pn.prototype.isOpaque=Pn.prototype.Ub,Pn.prototype.hideAdUI=Pn.prototype.mf,Pn.prototype.showAdUI=Pn.prototype.Gf,Pn.prototype.toggleFullScreen=Pn.prototype.Ne,Pn.prototype.hideSettingsMenus=Pn.prototype.pc,Pn.prototype.anySettingsMenusAreOpen=Pn.prototype.jd,Pn.prototype.setLastTouchEventTime=Pn.prototype.Ef,Pn.prototype.getDisplayTime=Pn.prototype.jf,Pn.prototype.isCastAllowed=Pn.prototype.Lg,Pn.prototype.setSeeking=Pn.prototype.He,Pn.prototype.isSeeking=Pn.prototype.Ng,Pn.prototype.getConfig=Pn.prototype.hg,Pn.prototype.getClientSideAdContainer=Pn.prototype.gg,Pn.prototype.getServerSideAdContainer=Pn.prototype.Ag,Pn.prototype.getControlsContainer=Pn.prototype.jg,Pn.prototype.getLocalPlayer=Pn.prototype.pg,Pn.prototype.getPlayer=Pn.prototype.lc,Pn.prototype.getLocalVideo=Pn.prototype.qg,Pn.prototype.getVideo=Pn.prototype.Kb,Pn.prototype.getVideoContainer=Pn.prototype.Ig,Pn.prototype.getLocalization=Pn.prototype.rg,Pn.prototype.getCastProxy=Pn.prototype.eg,Pn.prototype.getAd=Pn.prototype.getAd,Pn.prototype.setEnabledNativeControls=Pn.prototype.Df,Pn.prototype.setEnabledShakaControls=Pn.prototype.De,Pn.prototype.configure=Pn.prototype.configure,Pn.prototype.loadComplete=Pn.prototype.Og,Pn.prototype.allowCast=Pn.prototype.Sf,Pn.registerSeekBar=function(i){LF=i},Pn.registerElement=es,Pn.prototype.destroy=Pn.prototype.destroy;var Rx=new Map,LF=new Cx;function yg(i,l){zn.call(this,i,l);var c=this;this.m=this.controls.m,this.j=this.controls.i,this.i=[],this.g=Oi(),this.g.classList.add("shaka-overflow-menu-button"),this.g.classList.add("shaka-no-propagation"),this.g.classList.add("material-icons-round"),this.g.classList.add("shaka-tooltip"),this.g.textContent="more_vert",this.parent.appendChild(this.g),this.h=wn("div"),this.h.classList.add("shaka-overflow-menu"),this.h.classList.add("shaka-no-propagation"),this.h.classList.add("shaka-show-controls-on-mouse-over"),this.h.classList.add("shaka-hidden"),this.j.appendChild(this.h),Y9(this),this.eventManager.o(this.localization,"locale-updated",function(){bx(c)}),this.eventManager.o(this.localization,"locale-changed",function(){bx(c)}),this.eventManager.o(this.adManager,"ad-started",function(){c.ad&&c.ad.isLinear()&&Hn(c.g,!1)}),this.eventManager.o(this.adManager,"ad-stopped",function(){Hn(c.g,!0)}),this.eventManager.o(this.controls,"submenuopen",function(){Hn(c.h,!1)}),this.eventManager.o(this.h,"touchstart",function(p){c.controls.Ef(Date.now()),p.stopPropagation()}),this.eventManager.o(this.g,"click",function(){X9(c)}),bx(this),this.ad&&this.ad.isLinear()&&Hn(this.g,!1)}D(yg,zn),yg.prototype.release=function(){this.j=null;for(var i=E(this.i),l=i.next();!l.done;l=i.next())l.value.release();this.i=[],zn.prototype.release.call(this)};function dl(i,l){Dx.set(i,l)}function Y9(i){for(var l=E(i.m.overflowMenuButtons),c=l.next();!c.done;c=l.next())c=c.value,Dx.get(c)?(c=Dx.get(c),i.i.push(c.create(i.h,i.controls))):Re("Unrecognized overflow menu element requested:",c)}function X9(i){if(i.controls.jd())i.controls.pc();else{Hn(i.h,!0),wo(i.controls);var l=function(c){return c.classList.contains("shaka-hidden")==0};Ue(i.h.childNodes,l)&&we(i.h.childNodes,l)[0].focus()}}function bx(i){i.g.ariaLabel=i.localization.resolve("MORE_SETTINGS")}Le("shaka.ui.OverflowMenu",yg),yg.registerElement=dl;function MF(){}MF.prototype.create=function(i,l){return new yg(i,l)},es("overflow_menu",new MF);var Dx=new Map;function Px(i,l){zn.call(this,i,l);var c=this;this.g=Oi(),this.g.classList.add("shaka-airplay-button"),this.g.classList.add("shaka-tooltip"),this.g.ariaPressed="false",this.h=wn("i"),this.h.classList.add("material-icons-round"),this.h.textContent="airplay",this.g.appendChild(this.h),o.WebKitPlaybackTargetAvailabilityEvent||this.g.classList.add("shaka-hidden");var p=wn("label");p.classList.add("shaka-overflow-button-label"),p.classList.add("shaka-overflow-menu-only"),this.j=wn("span"),p.appendChild(this.j),this.i=wn("span"),this.i.classList.add("shaka-current-selection-span"),p.appendChild(this.i),this.g.appendChild(p),this.parent.appendChild(this.g),Lx(this),wF(this),this.eventManager.o(this.localization,"locale-updated",function(){Lx(c)}),this.eventManager.o(this.localization,"locale-changed",function(){Lx(c)}),this.eventManager.o(this.g,"click",function(){c.controls.Kb().webkitShowPlaybackTargetPicker()}),p=this.controls.Kb(),this.eventManager.o(p,"webkitplaybacktargetavailabilitychanged",function(y){var A=c.player.kf()==Ja;Hn(c.g,y.availability=="available"&&A)}),this.eventManager.o(p,"webkitcurrentplaybacktargetiswirelesschanged",function(){wF(c)})}D(Px,zn);function wF(i){var l=i.controls.Kb();i.g.ariaPressed=l&&l.webkitCurrentPlaybackTargetIsWireless?"true":"false"}function Lx(i){i.g.ariaLabel=i.localization.resolve("AIRPLAY"),i.j.textContent=i.localization.resolve("AIRPLAY")}Le("shaka.ui.AirPlayButton",Px);function Mx(){}Mx.prototype.create=function(i,l){return new Px(i,l)},dl("airplay",new Mx),es("airplay",new Mx);function us(i,l,c){this.h=i,this.m=my(this),l.dataset.shakaPlayerContainer="",l.ui=this,this.$d()&&l.classList.add("shaka-mobile"),this.g=new Pn(i,l,c,this.m),this.configure({}),c.controls||i.Ke(l),l.ui=this,c.ui=this}f=us.prototype,f.destroy=function(){var i=this;return Z(function(l){if(l.g==1)return i.g?I(l,i.g.destroy(),2):l.D(2);if(l.g!=4)return i.g=null,i.h?I(l,i.h.destroy(),4):l.D(4);i.h=null,U(l)})},f.$d=function(){return/(?:iPhone|iPad|iPod|Android)/.test(navigator.userAgent)?!0:Yl()&&1<navigator.maxTouchPoints},f.getConfiguration=function(){var i=my(this);return Yp(i,this.m,my(this),{},""),i},f.configure=function(i,l){arguments.length==2&&typeof i=="string"&&(i=pv(i,l)),Yp(this.m,i,my(this),{},""),this.m.castReceiverAppId&&!this.m.overflowMenuButtons.includes("cast")&&this.m.overflowMenuButtons.push("cast"),this.g.configure(this.m),this.g.dispatchEvent(new De("uiupdated"))},f.ig=function(){return this.g},f.oh=function(i){this.g.De(i)};function my(i){var l={controlPanelElements:"play_pause time_and_duration spacer mute volume fullscreen overflow_menu".split(" "),overflowMenuButtons:"captions quality language picture_in_picture cast playback_rate".split(" "),statisticsList:"width height corruptedFrames decodedFrames droppedFrames drmTimeSeconds licenseTime liveLatency loadLatency bufferingTime manifestTimeSeconds estimatedBandwidth streamBandwidth maxSegmentDuration pauseTime playTime completionPercent".split(" "),contextMenuElements:["loop","picture_in_picture","statistics"],playbackRates:[.5,.75,1,1.25,1.5,1.75,2],fastForwardRates:[2,4,8,1],rewindRates:[-1,-2,-4,-8],addSeekBar:!0,addBigPlayButton:!1,customContextMenu:!1,castReceiverAppId:"",clearBufferOnQualityChange:!0,showUnbufferedStart:!1,seekBarColors:{base:"rgba(255, 255, 255, 0.3)",buffered:"rgba(255, 255, 255, 0.54)",played:"rgb(255, 255, 255)",adBreaks:"rgb(255, 204, 0)"},volumeBarColors:{base:"rgba(255, 255, 255, 0.54)",level:"rgb(255, 255, 255)"},trackLabelFormat:Ox,fadeDelay:0,doubleClickForFullscreen:!0,singleClickForPlayAndPause:!0,enableKeyboardPlaybackControls:!0,enableFullscreenOnRotation:!0,forceLandscapeOnFullscreen:!0,enableTooltips:!1};return o.WebKitPlaybackTargetAvailabilityEvent&&l.overflowMenuButtons.push("airplay"),i.$d()&&(l.addBigPlayButton=!0,l.controlPanelElements=l.controlPanelElements.filter(function(c){return c!="play_pause"&&c!="volume"})),l}function OF(){var i,l,c,p,y,A,P,N,G,q,ae,Te,Ie;return Z(function(Ne){switch(Ne.g){case 1:if(nN(),!yM())return wx("shaka-ui-load-failed",FF),Ne.return();if(i=document.querySelectorAll("[data-shaka-player-container]"),l=document.querySelectorAll("[data-shaka-player]"),!l.length&&!i.length){Ne.D(2);break}if(l.length&&!i.length){for(c=E(l),p=c.next();!p.done;p=c.next())y=p.value,y.ui||(A=document.createElement("div"),P=y.parentElement,P.replaceChild(A,y),A.appendChild(y),NF(A,y));Ne.D(2);break}N=E(i),G=N.next();case 4:if(G.done){Ne.D(2);break}if(q=G.value,q.ui){Ne.D(5);break}for(ae=null,Te=E(l),p=Te.next();!p.done;p=Te.next())if(Ie=p.value,Ie.parentElement==q){ae=Ie;break}return ae||(ae=document.createElement("video"),ae.setAttribute("playsinline",""),q.appendChild(ae)),w(Ne,7),I(Ne,NF(q,ae),9);case 9:K(Ne,5);break;case 7:return W(Ne),wx("shaka-ui-load-failed",kF),Ne.return();case 5:G=N.next(),Ne.D(4);break;case 2:wx("shaka-ui-loaded"),U(Ne)}})}function wx(i,l){var c=null;l!=null&&(c={reasonCode:l}),c=new CustomEvent(i,{detail:c}),document.dispatchEvent(c)}function NF(i,l){var c,p,y,A,P,N,G,q;return Z(function(ae){switch(ae.g){case 1:c=new Yt(l),p=new us(c,i,l),y="",i.dataset&&i.dataset.shakaPlayerCastReceiverId?y=i.dataset.shakaPlayerCastReceiverId:l.dataset&&l.dataset.shakaPlayerCastReceiverId&&(y=l.dataset.shakaPlayerCastReceiverId),y.length&&p.configure({castReceiverAppId:y}),l.controls&&p.g.Df(!0),(A=l.getAttribute("src"))&&(P=document.createElement("source"),P.setAttribute("src",A),l.appendChild(P),l.removeAttribute("src")),N=E(l.querySelectorAll("source")),G=N.next();case 2:if(G.done){ae.D(0);break}return q=G.value,w(ae,5),I(ae,p.g.lc().load(q.getAttribute("src")),7);case 7:ae.D(0);break;case 5:W(ae);case 3:G=N.next(),ae.D(2)}})}Le("shaka.ui.Overlay",us),us.prototype.setEnabled=us.prototype.oh,us.prototype.getControls=us.prototype.ig,us.prototype.configure=us.prototype.configure,us.prototype.getConfiguration=us.prototype.getConfiguration,us.prototype.isMobile=us.prototype.$d,us.prototype.destroy=us.prototype.destroy;var Ox=0;us.TrackLabelFormat={LANGUAGE:Ox,ROLE:1,LANGUAGE_ROLE:2,LABEL:3};var FF=0,kF=1;us.FailReasonCode={NO_BROWSER_SUPPORT:FF,PLAYER_FAILED_TO_LOAD:kF},document.readyState=="complete"?Z(function(i){if(i.g==1)return I(i,Promise.resolve(),2);OF(),U(i)}):o.addEventListener("load",OF);function UF(i,l,c,p,y,A,P){function N(It,yt){return It+": "+yt}function G(It){return It.type=="variant"?It.audioRoles?It.audioRoles.join(", "):void 0:It.roles.join(", ")}var q=i.find(function(It){return It.active==1}),ae=SF(l);Pd(l),l.appendChild(ae),ae=new Map;for(var Te=E(i),Ie=Te.next();!Ie.done;Ie=Te.next())Ie=Ie.value,ae.has(Ie.language)||ae.set(Ie.language,new Set),ae.get(Ie.language).add(G(Ie));for(ae=new Set,q=q?N(q.language,G(q)):"",Te={},i=E(i),Ie=i.next();!Ie.done;Te={$a:Te.$a},Ie=i.next()){Te.$a=Ie.value,Ie=Te.$a.language;var Ne=Te.$a.forced,Ve=A.resolve(En.Nf),qe=G(Te.$a),Ze=N(Ie,qe);if(!ae.has(Ze)){ae.add(Ze);var Qe=Oi();Qe.addEventListener("click",function(It){return function(){c(It.$a)}}(Te));var Lt=wn("span");switch(Qe.appendChild(Lt),Lt.textContent=q9(Ie,A),P){case Ox:Ne&&(Lt.textContent+=" ("+Ve+")");break;case 1:qe?Lt.textContent=qe:(Re("Track #"+Te.$a.id+" does not have a role, but the UI is configured to only show role."),Lt.textContent="?"),Ne&&(Lt.textContent+=" ("+Ve+")");break;case 2:qe&&(Lt.textContent+=": "+qe),Ne&&(Lt.textContent+=" ("+Ve+")");break;case 3:Te.$a.label?Lt.textContent=Te.$a.label:(Re("Track #"+Te.$a.id+" does not have a label, but the UI is configured to only show labels."),Lt.textContent="?")}p&&Ze==q&&(Qe.appendChild(Hd()),Lt.classList.add("shaka-chosen-item"),Qe.ariaSelected="true",y.textContent=Lt.textContent),l.appendChild(Qe)}}}function q9(i,l){if(!i&&!l)return"";switch(i){case"mul":return l.resolve("MULTIPLE_LANGUAGES");case"und":return l.resolve("UNDETERMINED_LANGUAGE");case"zxx":return l.resolve("NOT_APPLICABLE")}var c=Tt(i);return i in Ef?Ef[i].u:c in Ef?Ef[c].u+" ("+i+")":l.resolve("UNRECOGNIZED_LANGUAGE")+" ("+i+")"}function hl(i,l,c){zn.call(this,i,l);var p=this;Q9(this,c),J9(this),Z9(this),this.eventManager.o(this.button,"click",function(){p.menu.classList.contains("shaka-hidden")?(p.controls.dispatchEvent(new De("submenuopen")),Hn(p.menu,!0),hg(p.menu)):Hn(p.menu,!1)})}D(hl,zn);function Q9(i,l){i.button=Oi(),i.button.classList.add("shaka-overflow-button"),i.icon=wn("i"),i.icon.classList.add("material-icons-round"),i.icon.textContent=l,i.button.appendChild(i.icon);var c=wn("label");c.classList.add("shaka-overflow-button-label"),c.classList.add("shaka-overflow-menu-only"),i.nameSpan=wn("span"),c.appendChild(i.nameSpan),i.currentSelection=wn("span"),i.currentSelection.classList.add("shaka-current-selection-span"),c.appendChild(i.currentSelection),i.button.appendChild(c),i.parent.appendChild(i.button)}function J9(i){i.menu=wn("div"),i.menu.classList.add("shaka-no-propagation"),i.menu.classList.add("shaka-show-controls-on-mouse-over"),i.menu.classList.add("shaka-settings-menu"),i.menu.classList.add("shaka-hidden"),i.backButton=Oi(),i.backButton.classList.add("shaka-back-to-overflow-button"),i.menu.appendChild(i.backButton),i.eventManager.o(i.backButton,"click",function(){i.controls.pc()});var l=wn("i");l.classList.add("material-icons-round"),l.textContent="close",i.backButton.appendChild(l),i.backSpan=wn("span"),i.backButton.appendChild(i.backSpan),i.controls.i.appendChild(i.menu)}function Z9(i){i.parent.classList.contains("shaka-overflow-menu")&&(i.backButton.firstChild.textContent="arrow_back",i.eventManager.o(i.backButton,"click",function(){Hn(i.parent,!0),i.parent.childNodes[0].focus(),wo(i.controls)}))}Le("shaka.ui.SettingsMenu",hl);function Nx(i,l){hl.call(this,i,l,"language");var c=this;this.button.classList.add("shaka-language-button"),this.button.classList.add("shaka-tooltip-status"),this.menu.classList.add("shaka-audio-languages"),this.eventManager.o(this.localization,"locale-updated",function(){kx(c)}),this.eventManager.o(this.localization,"locale-changed",function(){kx(c)}),this.eventManager.o(this.player,"trackschanged",function(){var p=0<c.player.fb().length;Hn(c.button,p),Fx(c)}),this.eventManager.o(this.player,"variantchanged",function(){Fx(c)}),kx(this),Fx(this)}D(Nx,hl);function Fx(i){var l=i.player.fb();UF(l,i.menu,function(c){i.player.Dd(c.language,c.roles[0])},!0,i.currentSelection,i.localization,i.controls.m.trackLabelFormat),hg(i.menu),i.controls.dispatchEvent(new De("languageselectionupdated")),i.button.setAttribute("shaka-status",i.currentSelection.innerText)}function kx(i){i.backButton.ariaLabel=i.localization.resolve("BACK"),i.button.ariaLabel=i.localization.resolve("LANGUAGE"),i.nameSpan.textContent=i.localization.resolve("LANGUAGE"),i.backSpan.textContent=i.localization.resolve("LANGUAGE")}Le("shaka.ui.AudioLanguageSelection",Nx);function Ux(){}Ux.prototype.create=function(i,l){return new Nx(i,l)},dl("language",new Ux),es("language",new Ux);function Bx(i,l){zn.call(this,i,l);var c=this;this.h=this.controls.B,this.g=Oi(),this.g.classList.add("shaka-cast-button"),this.g.classList.add("shaka-tooltip"),this.g.ariaPressed="false",this.i=wn("i"),this.i.classList.add("material-icons-round"),this.i.textContent="cast",this.g.appendChild(this.i);var p=wn("label");p.classList.add("shaka-overflow-button-label"),p.classList.add("shaka-overflow-menu-only"),this.l=wn("span"),p.appendChild(this.l),this.j=wn("span"),this.j.classList.add("shaka-current-selection-span"),p.appendChild(this.j),this.g.appendChild(p),this.parent.appendChild(this.g),jx(this),BF(this),this.eventManager.o(this.localization,"locale-updated",function(){jx(c)}),this.eventManager.o(this.localization,"locale-changed",function(){jx(c)}),this.eventManager.o(this.g,"click",function(){eY(c)}),this.eventManager.o(this.controls,"caststatuschanged",function(){BF(c)})}D(Bx,zn);function eY(i){var l;Z(function(c){if(c.g==1)return i.h.xa()?(i.h.Hf(),c.D(0)):(w(c,3),i.g.disabled=!0,I(c,i.h.cast(),5));if(c.g!=3)return i.g.disabled=!1,K(c,0);l=W(c),i.g.disabled=!1,l.code!=8004&&i.controls.dispatchEvent(new De("error",new Map().set("detail",l))),U(c)})}function BF(i){var l=i.h.Te()&&i.controls.Db,c=i.h.xa();Hn(i.g,l),i.i.textContent=c?"cast_connected":"cast",l&&(i.g.ariaPressed=c?"true":"false"),jF(i)}function jF(i){i.j.textContent=i.h.xa()?i.h.Bd():i.localization.resolve("OFF")}function jx(i){i.g.ariaLabel=i.localization.resolve("CAST"),i.l.textContent=i.localization.resolve("CAST"),jF(i)}Le("shaka.ui.CastButton",Bx);function Kx(){}Kx.prototype.create=function(i,l){return new Bx(i,l)},dl("cast",new Kx),es("cast",new Kx);function Gx(i,l){zn.call(this,i,l);var c=this;this.g=Oi(),this.g.classList.add("material-icons-round"),this.g.classList.add("shaka-fast-forward-button"),this.g.classList.add("shaka-tooltip-status"),this.g.setAttribute("shaka-status","1x"),this.g.textContent="fast_forward",this.parent.appendChild(this.g),Wx(this),this.h=this.controls.m.fastForwardRates,this.eventManager.o(this.localization,"locale-updated",function(){Wx(c)}),this.eventManager.o(this.localization,"locale-changed",function(){Wx(c)}),this.eventManager.o(this.g,"click",function(){if(c.video.duration){var p=c.h.indexOf(c.player.Jb())+1;p=p!=c.h.length?c.h[p]:c.h[0],c.player.Pe(p),c.g.setAttribute("shaka-status",p+"x")}})}D(Gx,zn);function Wx(i){i.g.ariaLabel=i.localization.resolve("FAST_FORWARD")}Le("shaka.ui.FastForwardButton",Gx);function KF(){}KF.prototype.create=function(i,l){return new Gx(i,l)},es("fast_forward",new KF);function Hx(i,l){zn.call(this,i,l);var c=this;this.g=Oi(),this.g.classList.add("shaka-fullscreen-button"),this.g.classList.add("material-icons-round"),this.g.classList.add("shaka-tooltip"),document.fullscreenEnabled||this.g.classList.add("shaka-hidden"),this.g.textContent="fullscreen",this.parent.appendChild(this.g),vy(this),this.eventManager.o(this.localization,"locale-updated",function(){vy(c)}),this.eventManager.o(this.localization,"locale-changed",function(){vy(c)}),this.eventManager.o(this.g,"click",function(){return Z(function(p){return I(p,c.controls.Ne(),0)})}),this.eventManager.o(document,"fullscreenchange",function(){c.g.textContent=document.fullscreenElement?"fullscreen_exit":"fullscreen",vy(c)})}D(Hx,zn);function vy(i){i.g.ariaLabel=i.localization.resolve(document.fullscreenElement?"EXIT_FULL_SCREEN":"FULL_SCREEN")}Le("shaka.ui.FullscreenButton",Hx);function GF(){}GF.prototype.create=function(i,l){return new Hx(i,l)},es("fullscreen",new GF);function yy(i,l){zn.call(this,i,l);var c=this;this.g=Oi(),this.g.classList.add("shaka-loop-button"),this.g.classList.add("shaka-tooltip"),this.i=wn("i"),this.i.classList.add("material-icons-round"),this.i.textContent="repeat",this.g.appendChild(this.i);var p=wn("label");p.classList.add("shaka-overflow-button-label"),p.classList.add("shaka-overflow-menu-only"),this.j=wn("span"),this.j.textContent=this.localization.resolve("LOOP"),p.appendChild(this.j),this.l=wn("span"),this.l.classList.add("shaka-current-selection-span"),p.appendChild(this.l),this.g.appendChild(p),Ey(this),this.parent.appendChild(this.g),this.eventManager.o(this.localization,"locale-updated",function(){Ey(c)}),this.eventManager.o(this.localization,"locale-changed",function(){Ey(c)}),this.eventManager.o(this.g,"click",function(){c.video.loop=!c.video.loop,c.h.Ga(),c.h.na(1)}),this.s=this.video.loop,this.h=new kn(function(){c.s!=c.video.loop&&(Ey(c),c.s=c.video.loop)}),this.h.na(1)}D(yy,zn),yy.prototype.release=function(){this.h.stop(),this.h=null,zn.prototype.release.call(this)};function Ey(i){i.j.textContent=i.localization.resolve("LOOP"),i.l.textContent=i.localization.resolve(i.video.loop?"ON":"OFF"),i.i.textContent=i.video.loop?"repeat_on":"repeat",i.g.ariaLabel=i.localization.resolve(i.video.loop?"EXIT_LOOP_MODE":"ENTER_LOOP_MODE")}Le("shaka.ui.LoopButton",yy);function _y(){}_y.prototype.create=function(i,l){return new yy(i,l)},dl("loop",new _y),es("loop",new _y),hy("loop",new _y);function Vx(i,l){zn.call(this,i,l);var c=this;this.g=Oi(),this.g.classList.add("shaka-mute-button"),this.g.classList.add("material-icons-round"),this.g.classList.add("shaka-tooltip"),this.parent.appendChild(this.g),_f(this),Eg(this),this.eventManager.o(this.localization,"locale-updated",function(){_f(c)}),this.eventManager.o(this.localization,"locale-changed",function(){_f(c)}),this.eventManager.o(this.g,"click",function(){c.ad&&c.ad.isLinear()?c.ad.setMuted(!c.ad.isMuted()):c.video.muted=!c.video.muted}),this.eventManager.o(this.video,"volumechange",function(){_f(c),Eg(c)}),this.eventManager.o(this.adManager,"ad-volume-changed",function(){_f(c),Eg(c)}),this.eventManager.o(this.adManager,"ad-muted",function(){_f(c),Eg(c)}),this.eventManager.o(this.adManager,"ad-stopped",function(){c.ad=null,_f(c),Eg(c)})}D(Vx,zn);function _f(i){var l=i.ad?i.ad.isMuted()?"UNMUTE":"MUTE":i.video.muted?"UNMUTE":"MUTE";i.g.ariaLabel=i.localization.resolve(l)}function Eg(i){var l=i.ad?i.ad.isMuted()?"volume_off":"volume_up":i.video.muted?"volume_off":"volume_up";i.g.textContent=l}Le("shaka.ui.MuteButton",Vx);function WF(){}WF.prototype.create=function(i,l){return new Vx(i,l)},es("mute",new WF);function $x(i,l){zn.call(this,i,l);var c=this;this.l=this.controls.C,this.g=Oi(),this.g.classList.add("shaka-pip-button"),this.g.classList.add("shaka-tooltip"),this.i=wn("i"),this.i.classList.add("material-icons-round"),this.i.textContent="picture_in_picture_alt",this.g.appendChild(this.i);var p=wn("label");p.classList.add("shaka-overflow-button-label"),p.classList.add("shaka-overflow-menu-only"),this.j=wn("span"),this.j.textContent=this.localization.resolve("PICTURE_IN_PICTURE"),p.appendChild(this.j),this.h=wn("span"),this.h.classList.add("shaka-current-selection-span"),p.appendChild(this.h),this.g.appendChild(p),zx(this),this.parent.appendChild(this.g),document.pictureInPictureEnabled&&!this.video.disablePictureInPicture||Hn(this.g,!1),this.eventManager.o(this.localization,"locale-updated",function(){zx(c)}),this.eventManager.o(this.localization,"locale-changed",function(){zx(c)}),this.eventManager.o(this.g,"click",function(){tY(c)}),this.eventManager.o(this.l,"enterpictureinpicture",function(){c.i.textContent="branding_watermark",c.g.ariaLabel=c.localization.resolve("EXIT_PICTURE_IN_PICTURE"),c.h.textContent=c.localization.resolve("ON")}),this.eventManager.o(this.l,"leavepictureinpicture",function(){c.i.textContent="picture_in_picture_alt",c.g.ariaLabel=c.localization.resolve("ENTER_PICTURE_IN_PICTURE"),c.h.textContent=c.localization.resolve("OFF")}),this.eventManager.o(this.controls,"caststatuschanged",function(y){y.newStatus?document.pictureInPictureEnabled&&!c.video.disablePictureInPicture&&Hn(c.g,!1):document.pictureInPictureEnabled&&!c.video.disablePictureInPicture&&Hn(c.g,!0)}),this.eventManager.o(this.player,"trackschanged",function(){nY(c)})}D($x,zn);function tY(i){var l;Z(function(c){if(c.g==1)return w(c,2),document.pictureInPictureElement?I(c,document.exitPictureInPicture(),5):(document.fullscreenElement&&document.exitFullscreen(),I(c,i.video.requestPictureInPicture(),5));if(c.g!=2)return K(c,0);l=W(c),i.controls.dispatchEvent(new De("error",new Map().set("detail",l))),U(c)})}function zx(i){i.j.textContent=i.localization.resolve("PICTURE_IN_PICTURE"),i.g.ariaLabel=i.localization.resolve(document.pictureInPictureElement?"EXIT_PICTURE_IN_PICTURE":"ENTER_PICTURE_IN_PICTURE"),i.h.textContent=i.localization.resolve(document.pictureInPictureElement?"ON":"OFF")}function nY(i){Z(function(l){return!document.pictureInPictureEnabled||i.video.disablePictureInPicture?(Hn(i.g,!1),l.D(0)):!i.player||!i.player.pf()?(Hn(i.g,!0),l.D(0)):(Hn(i.g,!1),document.pictureInPictureElement?I(l,document.exitPictureInPicture(),0):l.D(0))})}Le("shaka.ui.PipButton",$x);function Ty(){}Ty.prototype.create=function(i,l){return new $x(i,l)},dl("picture_in_picture",new Ty),es("picture_in_picture",new Ty),hy("picture_in_picture",new Ty);function Yx(i,l){hl.call(this,i,l,"slow_motion_video");var c=this;this.button.classList.add("shaka-playbackrate-button"),this.menu.classList.add("shaka-playback-rates"),this.button.classList.add("shaka-tooltip-status"),this.eventManager.o(this.localization,"locale-updated",function(){Xx(c)}),this.eventManager.o(this.localization,"locale-changed",function(){Xx(c)}),this.eventManager.o(this.player,"ratechange",function(){HF(c,c.player.Jb())}),this.g=new Map(this.controls.m.playbackRates.map(function(p){return[p+"x",p]})),Xx(this),rY(this),HF(this,this.player.Jb())}D(Yx,hl);function Xx(i){i.backButton.ariaLabel=i.localization.resolve("BACK"),i.button.ariaLabel=i.localization.resolve("PLAYBACK_RATE"),i.nameSpan.textContent=i.localization.resolve("PLAYBACK_RATE"),i.backSpan.textContent=i.localization.resolve("PLAYBACK_RATE")}function HF(i,l){var c=_x(i.menu,"material-icons-round shaka-chosen-item");if(c){var p=c.parentElement;p.removeAttribute("aria-selected"),p.getElementsByTagName("span")[0].classList.remove("shaka-chosen-item"),p.removeChild(c)}(c=Array.from(i.menu.querySelectorAll("span")).find(function(y){return i.g.get(y.textContent)==l}))&&(p=c.parentElement,p.appendChild(Hd()),p.ariaSelected="true",c.classList.add("shaka-chosen-item")),i.currentSelection.textContent=l+"x",i.button.setAttribute("shaka-status",l+"x")}function rY(i){for(var l={},c=E(i.g.keys()),p=c.next();!p.done;l={Cc:l.Cc},p=c.next()){l.Cc=p.value,p=Oi();var y=wn("span");y.textContent=l.Cc,p.appendChild(y),i.eventManager.o(p,"click",function(A){return function(){i.video.playbackRate=i.g.get(A.Cc),i.video.defaultPlaybackRate=i.g.get(A.Cc)}}(l)),i.menu.appendChild(p)}hg(i.menu)}Le("shaka.ui.PlaybackRateSelection",Yx);function qx(){}qx.prototype.create=function(i,l){return new Yx(i,l)},dl("playback_rate",new qx),es("playback_rate",new qx);function Qx(i,l){zn.call(this,i,l);var c=this;this.g=Oi(),this.g.classList.add("shaka-current-time"),Sy(this,"0:00"),this.parent.appendChild(this.g),this.eventManager.o(this.g,"click",function(){c.player.W()&&(c.video.currentTime=c.player.Na().end)}),this.eventManager.o(this.controls,"timeandseekrangeupdated",function(){var p=c.controls.ka,y=c.controls.jf(),A=c.video.duration,P=c.player.Na(),N=P.end-P.start;c.player.W()?(y=Math.max(0,Math.floor(P.end-y)),A=3600<=N,1<=y||p?(Sy(c,"- "+Vd(y,A)),c.g.disabled=!1):(Sy(c,c.localization.resolve("LIVE")),c.g.disabled=!0)):(p=3600<=A,y=Vd(y,p),A&&(y+=" / "+Vd(A,p)),Sy(c,y),c.g.disabled=!0)}),this.eventManager.o(this.player,"trackschanged",function(){c.player.W()&&(c.g.ariaLabel=c.localization.resolve("SKIP_TO_LIVE"))})}D(Qx,zn);function Sy(i,l){l!=i.g.textContent&&(i.g.textContent=l)}Le("shaka.ui.PresentationTimeTracker",Qx);function VF(){}VF.prototype.create=function(i,l){return new Qx(i,l)},es("time_and_duration",new VF);function Jx(i,l){hl.call(this,i,l,"settings");var c=this;this.button.classList.add("shaka-resolution-button"),this.button.classList.add("shaka-tooltip-status"),this.menu.classList.add("shaka-resolutions"),this.eventManager.o(this.localization,"locale-updated",function(){Zx(c)}),this.eventManager.o(this.localization,"locale-changed",function(){Zx(c)}),this.eventManager.o(this.player,"variantchanged",function(){_g(c)}),this.eventManager.o(this.player,"trackschanged",function(){_g(c)}),this.eventManager.o(this.player,"abrstatuschanged",function(){_g(c)}),_g(this),Zx(this)}D(Jx,hl);function _g(i){var l=i.player.fb();if(l.length&&!l[0].height)Hn(i.menu,!1),Hn(i.button,!1);else{Hn(i.button,!0),l.sort(function(G,q){return q.height-G.height});var c=l.find(function(G){return G.active});c&&(l=l.filter(function(G){return G.language==c.language&&G.channelsCount==c.channelsCount})),l=l.filter(function(G,q){return l.findIndex(function(ae){return ae.height==G.height})==q});var p=SF(i.menu);Pd(i.menu),i.menu.appendChild(p),p=i.player.getConfiguration().abr.enabled;for(var y={},A=E(l),P=A.next();!P.done;y={Fc:y.Fc},P=A.next()){y.Fc=P.value,P=Oi(),P.classList.add("explicit-resolution"),i.eventManager.o(P,"click",function(G){return function(){var q=G.Fc;i.player.configure({abr:{enabled:!1}}),i.player.Be(q,i.controls.m.clearBufferOnQualityChange)}}(y));var N=wn("span");N.textContent=y.Fc.height+"p",P.appendChild(N),p||y.Fc!=c||(P.ariaSelected="true",P.appendChild(Hd()),N.classList.add("shaka-chosen-item"),i.currentSelection.textContent=N.textContent),i.menu.appendChild(P)}y=Oi(),y.classList.add("shaka-enable-abr-button"),i.eventManager.o(y,"click",function(){i.player.configure({abr:{enabled:!0}}),_g(i)}),i.g=wn("span"),i.g.classList.add("shaka-auto-span"),i.g.textContent=i.localization.resolve("AUTO_QUALITY"),y.appendChild(i.g),p&&(y.ariaSelected="true",y.appendChild(Hd()),i.g.classList.add("shaka-chosen-item"),i.currentSelection.textContent=i.localization.resolve("AUTO_QUALITY")),i.button.setAttribute("shaka-status",i.currentSelection.textContent),i.menu.appendChild(y),hg(i.menu),i.controls.dispatchEvent(new De("resolutionselectionupdated"))}}function Zx(i){i.button.ariaLabel=i.localization.resolve("RESOLUTION"),i.backButton.ariaLabel=i.localization.resolve("RESOLUTION"),i.backSpan.textContent=i.localization.resolve("RESOLUTION"),i.nameSpan.textContent=i.localization.resolve("RESOLUTION"),i.g.textContent=i.localization.resolve("AUTO_QUALITY"),i.player.getConfiguration().abr.enabled&&(i.currentSelection.textContent=i.localization.resolve("AUTO_QUALITY"))}Le("shaka.ui.ResolutionSelection",Jx);function eC(){}eC.prototype.create=function(i,l){return new Jx(i,l)},dl("quality",new eC),es("quality",new eC);function tC(i,l){zn.call(this,i,l);var c=this;this.g=Oi(),this.g.classList.add("material-icons-round"),this.g.classList.add("shaka-rewind-button"),this.g.classList.add("shaka-tooltip-status"),this.g.setAttribute("shaka-status",this.localization.resolve("OFF")),this.g.textContent="fast_rewind",this.parent.appendChild(this.g),nC(this),this.h=this.controls.m.rewindRates,this.eventManager.o(this.localization,"locale-updated",function(){nC(c)}),this.eventManager.o(this.localization,"locale-changed",function(){nC(c)}),this.eventManager.o(this.g,"click",function(){if(c.video.duration){var p=c.h.indexOf(c.player.Jb())+1;p=p!=c.h.length?c.h[p]:c.h[0],c.player.Pe(p),c.g.setAttribute("shaka-status",p+"x")}})}D(tC,zn);function nC(i){i.g.ariaLabel=i.localization.resolve("REWIND")}Le("shaka.ui.RewindButton",tC);function $F(){}$F.prototype.create=function(i,l){return new tC(i,l)},es("rewind",new $F);function rC(i,l){zn.call(this,i,l);var c=this;this.j=wn("div"),this.j.classList.add("shaka-skip-ad-container"),this.parent.appendChild(this.j),this.h=wn("div"),this.h.classList.add("shaka-skip-ad-counter"),Hn(this.h,!1),this.j.appendChild(this.h),this.g=Oi(),this.g.classList.add("shaka-skip-ad-button"),this.g.disabled=!0,Hn(this.g,!1),this.g.classList.add("shaka-no-propagation"),this.j.appendChild(this.g),iC(this),this.i=new kn(function(){var p=Math.round(c.ad.getTimeUntilSkippable());0<p?c.h.textContent=p:(c.i.stop(),Hn(c.h,!1))}),this.eventManager.o(this.localization,"locale-updated",function(){iC(c)}),this.eventManager.o(this.localization,"locale-changed",function(){iC(c)}),this.eventManager.o(this.adManager,"ad-started",function(){zF(c)}),this.eventManager.o(this.adManager,"ad-skip-state-changed",function(){c.ad.canSkipNow()&&(c.g.disabled=!1,c.i.stop(),Hn(c.h,!1))}),this.eventManager.o(this.adManager,"ad-stopped",function(){c.i.stop(),c.g.disabled=!0,Hn(c.g,!1),Hn(c.h,!1)}),this.eventManager.o(this.g,"click",function(){c.ad.skip()}),this.ad&&zF(this)}D(rC,zn),rC.prototype.release=function(){this.i.stop(),this.i=null,zn.prototype.release.call(this)};function iC(i){i.g.textContent=i.localization.resolve("SKIP_AD")}function zF(i){i.ad.isSkippable()&&(Hn(i.g,!0),Hn(i.h,!0),i.h.textContent="",i.i.Ga(),i.i.na(.5))}Le("shaka.ui.SkipAdButton",rC);function Tg(i,l){hu.call(this,i,l),this.button.classList.add("shaka-small-play-button"),this.button.classList.add("material-icons-round"),this.button.classList.add("shaka-tooltip"),this.h(),this.g()}D(Tg,hu),Tg.prototype.h=function(){this.button.textContent=this.video.ended?"replay":this.isPaused()?"play_arrow":"pause"},Tg.prototype.g=function(){if(this.video.ended)this.button.ariaLabel=this.localization.resolve("REPLAY");else{var i=this.isPaused()?"PLAY":"PAUSE";this.button.ariaLabel=this.localization.resolve(i)}},Le("shaka.ui.SmallPlayButton",Tg);function YF(){}YF.prototype.create=function(i,l){return new Tg(i,l)},es("play_pause",new YF);function sC(i,l){zn.call(this,i,l);var c=wn("div");c.classList.add("shaka-spacer"),c.ariaHidden="true",this.parent.appendChild(c)}D(sC,zn),Le("shaka.ui.Spacer",sC);function XF(){}XF.prototype.create=function(i,l){return new sC(i,l)},es("spacer",new XF);function Ay(i,l){function c(q){return Vd(N.h[q],!1)+" (m)"}function p(q){return Math.round(N.h[q]/1e3)+" (kbits/s)"}function y(q){return N.h[q].toFixed(2)+" (s)"}function A(q){return N.h[q]+" (frames)"}function P(q){return N.h[q]+" (px)"}zn.call(this,i,l);var N=this;this.i=Oi(),this.i.classList.add("shaka-statistics-button"),this.j=wn("i"),this.j.classList.add("material-icons-round"),this.j.textContent="insert_chart_outlined",this.i.appendChild(this.j);var G=wn("label");G.classList.add("shaka-overflow-button-label"),this.B=wn("span"),G.appendChild(this.B),this.s=wn("span"),this.s.classList.add("shaka-current-selection-span"),G.appendChild(this.s),this.i.appendChild(G),this.parent.appendChild(this.i),this.g=wn("div"),this.g.classList.add("shaka-no-propagation"),this.g.classList.add("shaka-show-controls-on-mouse-over"),this.g.classList.add("shaka-statistics-container"),this.g.classList.add("shaka-hidden"),this.controls.i.appendChild(this.g),this.I=[],this.J=["stateHistory","switchHistory"],this.h=this.player.getStats(),this.C={},this.G={width:P,height:P,completionPercent:function(q){return N.h[q]+" (%)"},bufferingTime:y,drmTimeSeconds:y,licenseTime:y,liveLatency:y,loadLatency:y,manifestTimeSeconds:y,estimatedBandwidth:p,streamBandwidth:p,maxSegmentDuration:c,pauseTime:c,playTime:c,corruptedFrames:A,decodedFrames:A,droppedFrames:A},this.l=new kn(function(){N.h=N.player.getStats();for(var q=E(N.I),ae=q.next();!ae.done;ae=q.next())ae=ae.value,N.C[ae].textContent=N.G[ae](ae)}),xy(this),iY(this),this.eventManager.o(this.localization,"locale-updated",function(){xy(N)}),this.eventManager.o(this.localization,"locale-changed",function(){xy(N)}),this.eventManager.o(this.i,"click",function(){Hn(N.parent,!1),N.g.classList.contains("shaka-hidden")?(N.j.textContent="insert_chart",N.l.na(.1),Hn(N.g,!0)):(N.j.textContent="insert_chart_outlined",N.l.stop(),Hn(N.g,!1)),xy(N)})}D(Ay,zn);function xy(i){i.B.textContent=i.localization.resolve("STATISTICS"),i.i.ariaLabel=i.localization.resolve("STATISTICS"),i.s.textContent=i.localization.resolve(i.g.classList.contains("shaka-hidden")?"OFF":"ON")}function iY(i){for(var l=E(i.controls.m.statisticsList),c=l.next();!c.done;c=l.next())if(c=c.value,c in i.h&&!i.J.includes(c)){var p=i.g,y=p.appendChild,A=i,P=wn("div"),N=wn("label");N.textContent=c+":",P.appendChild(N),N=wn("span"),N.textContent=A.G[c](c),P.appendChild(N),A.C[c]=N,y.call(p,P),i.I.push(c)}else Re("Unrecognized statistic element:",c)}Ay.prototype.release=function(){this.l.stop(),this.l=null,zn.prototype.release.call(this)},Le("shaka.ui.StatisticsButton",Ay);function aC(){}aC.prototype.create=function(i,l){return new Ay(i,l)},dl("statistics",new aC),hy("statistics",new aC);function oC(i,l){hl.call(this,i,l,"closed_caption");var c=this;this.button.classList.add("shaka-caption-button"),this.button.classList.add("shaka-tooltip-status"),this.menu.classList.add("shaka-text-languages"),this.player&&this.player.Vb()?this.button.ariaPressed="true":this.button.ariaPressed="false",sY(this),this.eventManager.o(this.localization,"locale-updated",function(){lC(c),Tf(c)}),this.eventManager.o(this.localization,"locale-changed",function(){lC(c),Tf(c)}),this.eventManager.o(this.player,"texttrackvisibility",function(){qF(c),Tf(c)}),this.eventManager.o(this.player,"textchanged",function(){Tf(c)}),this.eventManager.o(this.player,"trackschanged",function(){QF(c)}),qF(this),lC(this),Tf(this),QF(this)}D(oC,hl);function sY(i){var l=Oi();l.ariaSelected="true",i.menu.appendChild(l),l.appendChild(Hd()),i.g=wn("span"),i.g.classList.add("shaka-auto-span"),l.appendChild(i.g)}function qF(i){i.player.Vb()?(i.icon.textContent="closed_caption_disabled",i.button.ariaPressed="true"):(i.icon.textContent="closed_caption",i.button.ariaPressed="false"),i.controls.dispatchEvent(new De("captionselectionupdated"))}function Tf(i){var l=i.player.vb();UF(l,i.menu,function(c){return aY(i,c)},i.player.Vb(),i.currentSelection,i.localization,i.controls.m.trackLabelFormat),l=Oi(),l.classList.add("shaka-turn-captions-off-button"),i.eventManager.o(l,"click",function(){i.player.Je(!1),Tf(i)}),l.appendChild(i.g),i.menu.appendChild(l),i.player.Vb()||(l.ariaSelected="true",l.appendChild(Hd()),i.g.classList.add("shaka-chosen-item"),i.currentSelection.textContent=i.localization.resolve("OFF")),i.button.setAttribute("shaka-status",i.currentSelection.textContent),hg(i.menu),i.controls.dispatchEvent(new De("captionselectionupdated"))}function aY(i,l){return Z(function(c){return i.player.Ae(l),I(c,i.player.Je(!0),0)})}function lC(i){i.button.ariaLabel=i.localization.resolve("CAPTIONS"),i.backButton.ariaLabel=i.localization.resolve("BACK"),i.nameSpan.textContent=i.localization.resolve("CAPTIONS"),i.backSpan.textContent=i.localization.resolve("CAPTIONS"),i.g.textContent=i.localization.resolve("OFF")}function QF(i){var l=0<i.player.vb().length;Hn(i.button,l),Tf(i)}Le("shaka.ui.TextSelection",oC);function uC(){}uC.prototype.create=function(i,l){return new oC(i,l)},dl("captions",new uC),es("captions",new uC);function Cy(i,l){bi.call(this,i,l,["shaka-volume-bar-container"],["shaka-volume-bar"]);var c=this;this.m=this.controls.m,this.eventManager.o(this.video,"volumechange",function(){return cC(c)}),this.eventManager.o(this.adManager,"ad-volume-changed",function(){return JF(c)}),this.eventManager.o(this.adManager,"ad-muted",function(){return JF(c)}),this.eventManager.o(this.adManager,"ad-stopped",function(){return cC(c)}),this.eventManager.o(this.localization,"locale-updated",function(){return fC(c)}),this.eventManager.o(this.localization,"locale-changed",function(){return fC(c)}),cC(this),fC(this),this.ad&&this.onChange()}D(Cy,bi),Cy.prototype.onChange=function(){this.ad&&this.ad.isLinear()?this.ad.setVolume(this.getValue()):(this.video.volume=this.getValue(),this.video.muted=this.video.volume==0)};function cC(i){i.video.muted?i.setValue(0):i.setValue(i.video.volume),ZF(i)}function JF(i){var l=i.ad.getVolume();i.setValue(l),ZF(i)}function ZF(i){var l=i.m.volumeBarColors,c=["to right"];c.push(l.level+100*i.getValue()+"%"),c.push(l.base+100*i.getValue()+"%"),c.push(l.base+"100%"),i.container.style.background="linear-gradient("+c.join(",")+")"}function fC(i){i.bar.ariaLabel=i.localization.resolve("VOLUME")}Le("shaka.ui.VolumeBar",Cy);function ek(){}ek.prototype.create=function(i,l){return new Cy(i,l)},es("volume",new ek)}).call(t,e,e,void 0);for(var r in t.shaka)n[r]=t.shaka[r]})()})(YR);var Wq=["src","config","chromeless","className"];function Hq(n,e){var t=n.src,r=n.config,o=n.chromeless,u=n.className,h=kq(n,Wq),f=Fo.default.useRef(null),d=Fo.default.useRef(null),m=Fo.default.useState(null),g=yU(m,2),v=g[0],_=g[1],S=Fo.default.useState(null),E=yU(S,2),T=E[0],C=E[1];return Fo.default.useEffect(function(){var R=new YR.Player(d.current);if(_(R),!o){var b=new YR.ui.Overlay(R,f.current,d.current);C(b)}return function(){R.destroy()}},[]),Fo.default.useEffect(function(){v&&r&&v.configure(r)},[v,r]),Fo.default.useEffect(function(){v&&t&&v.load(t)},[v,t]),Fo.default.useImperativeHandle(e,function(){return{get player(){return v},get ui(){return T},get videoElement(){return d.current}}},[v,T]),Fo.default.createElement("div",{ref:f,className:u},Fo.default.createElement("video",zR({ref:d,style:{maxWidth:"100%",width:"100%"}},h)))}var Vq=Fo.default.forwardRef(Hq),$q=Vq,sd=function(){this.init=function(){var e={};this.on=function(t,r){e[t]||(e[t]=[]),e[t]=e[t].concat(r)},this.off=function(t,r){var o;return e[t]?(o=e[t].indexOf(r),e[t]=e[t].slice(),e[t].splice(o,1),o>-1):!1},this.trigger=function(t){var r,o,u,h;if(r=e[t],!!r)if(arguments.length===2)for(u=r.length,o=0;o<u;++o)r[o].call(this,arguments[1]);else{for(h=[],o=arguments.length,o=1;o<arguments.length;++o)h.push(arguments[o]);for(u=r.length,o=0;o<u;++o)r[o].apply(this,h)}},this.dispose=function(){e={}}}};sd.prototype.pipe=function(n){return this.on("data",function(e){n.push(e)}),this.on("done",function(e){n.flush(e)}),this.on("partialdone",function(e){n.partialFlush(e)}),this.on("endedtimeline",function(e){n.endTimeline(e)}),this.on("reset",function(e){n.reset(e)}),n};sd.prototype.push=function(n){this.trigger("data",n)};sd.prototype.flush=function(n){this.trigger("done",n)};sd.prototype.partialFlush=function(n){this.trigger("partialdone",n)};sd.prototype.endTimeline=function(n){this.trigger("endedtimeline",n)};sd.prototype.reset=function(n){this.trigger("reset",n)};var za=sd,XD=9e4,qD,QD,xT,JD,Kj,Gj,Wj;qD=function(e){return e*XD};QD=function(e,t){return e*t};xT=function(e){return e/XD};JD=function(e,t){return e/t};Kj=function(e,t){return qD(JD(e,t))};Gj=function(e,t){return QD(xT(e),t)};Wj=function(e,t,r){return xT(r?e:e-t)};var Wc={ONE_SECOND_IN_TS:XD,secondsToVideoTs:qD,secondsToAudioTs:QD,videoTsToSeconds:xT,audioTsToSeconds:JD,audioTsToVideoTs:Kj,videoTsToAudioTs:Gj,metadataTsToSeconds:Wj},zq=za,Yq=Wc.ONE_SECOND_IN_TS,f_,_U=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];f_=function(e){var t,r=0;f_.prototype.init.call(this),this.skipWarn_=function(o,u){this.trigger("log",{level:"warn",message:"adts skiping bytes "+o+" to "+u+" in frame "+r+" outside syncword"})},this.push=function(o){var u=0,h,f,d,m,g;if(e||(r=0),o.type==="audio"){t&&t.length?(d=t,t=new Uint8Array(d.byteLength+o.data.byteLength),t.set(d),t.set(o.data,d.byteLength)):t=o.data;for(var v;u+7<t.length;){if(t[u]!==255||(t[u+1]&246)!==240){typeof v!="number"&&(v=u),u++;continue}if(typeof v=="number"&&(this.skipWarn_(v,u),v=null),f=(~t[u+1]&1)*2,h=(t[u+3]&3)<<11|t[u+4]<<3|(t[u+5]&224)>>5,m=((t[u+6]&3)+1)*1024,g=m*Yq/_U[(t[u+2]&60)>>>2],t.byteLength-u<h)break;this.trigger("data",{pts:o.pts+r*g,dts:o.dts+r*g,sampleCount:m,audioobjecttype:(t[u+2]>>>6&3)+1,channelcount:(t[u+2]&1)<<2|(t[u+3]&192)>>>6,samplerate:_U[(t[u+2]&60)>>>2],samplingfrequencyindex:(t[u+2]&60)>>>2,samplesize:16,data:t.subarray(u+7+f,u+h)}),r++,u+=h}typeof v=="number"&&(this.skipWarn_(v,u),v=null),t=t.subarray(u)}},this.flush=function(){r=0,this.trigger("done")},this.reset=function(){t=void 0,this.trigger("reset")},this.endTimeline=function(){t=void 0,this.trigger("endedtimeline")}};f_.prototype=new zq;var CT=f_,Hj;Hj=function(e){var t=e.byteLength,r=0,o=0;this.length=function(){return 8*t},this.bitsAvailable=function(){return 8*t+o},this.loadWord=function(){var u=e.byteLength-t,h=new Uint8Array(4),f=Math.min(4,t);if(f===0)throw new Error("no bytes available");h.set(e.subarray(u,u+f)),r=new DataView(h.buffer).getUint32(0),o=f*8,t-=f},this.skipBits=function(u){var h;o>u?(r<<=u,o-=u):(u-=o,h=Math.floor(u/8),u-=h*8,t-=h,this.loadWord(),r<<=u,o-=u)},this.readBits=function(u){var h=Math.min(o,u),f=r>>>32-h;return o-=h,o>0?r<<=h:t>0&&this.loadWord(),h=u-h,h>0?f<<h|this.readBits(h):f},this.skipLeadingZeros=function(){var u;for(u=0;u<o;++u)if(r&2147483648>>>u)return r<<=u,o-=u,u;return this.loadWord(),u+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var u=this.skipLeadingZeros();return this.readBits(u+1)-1},this.readExpGolomb=function(){var u=this.readUnsignedExpGolomb();return 1&u?1+u>>>1:-1*(u>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var Xq=Hj,Vj=za,qq=Xq,d_,$m,$j;$m=function(){var e=0,t,r;$m.prototype.init.call(this),this.push=function(o){var u;r?(u=new Uint8Array(r.byteLength+o.data.byteLength),u.set(r),u.set(o.data,r.byteLength),r=u):r=o.data;for(var h=r.byteLength;e<h-3;e++)if(r[e+2]===1){t=e+5;break}for(;t<h;)switch(r[t]){case 0:if(r[t-1]!==0){t+=2;break}else if(r[t-2]!==0){t++;break}e+3!==t-2&&this.trigger("data",r.subarray(e+3,t-2));do t++;while(r[t]!==1&&t<h);e=t-2,t+=3;break;case 1:if(r[t-1]!==0||r[t-2]!==0){t+=3;break}this.trigger("data",r.subarray(e+3,t-2)),e=t-2,t+=3;break;default:t+=3;break}r=r.subarray(e),t-=e,e=0},this.reset=function(){r=null,e=0,this.trigger("reset")},this.flush=function(){r&&r.byteLength>3&&this.trigger("data",r.subarray(e+3)),r=null,e=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}};$m.prototype=new Vj;$j={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0};d_=function(){var e=new $m,t,r,o,u,h,f,d;d_.prototype.init.call(this),t=this,this.push=function(m){m.type==="video"&&(r=m.trackId,o=m.pts,u=m.dts,e.push(m))},e.on("data",function(m){var g={trackId:r,pts:o,dts:u,data:m,nalUnitTypeCode:m[0]&31};switch(g.nalUnitTypeCode){case 5:g.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:g.nalUnitType="sei_rbsp",g.escapedRBSP=h(m.subarray(1));break;case 7:g.nalUnitType="seq_parameter_set_rbsp",g.escapedRBSP=h(m.subarray(1)),g.config=f(g.escapedRBSP);break;case 8:g.nalUnitType="pic_parameter_set_rbsp";break;case 9:g.nalUnitType="access_unit_delimiter_rbsp";break}t.trigger("data",g)}),e.on("done",function(){t.trigger("done")}),e.on("partialdone",function(){t.trigger("partialdone")}),e.on("reset",function(){t.trigger("reset")}),e.on("endedtimeline",function(){t.trigger("endedtimeline")}),this.flush=function(){e.flush()},this.partialFlush=function(){e.partialFlush()},this.reset=function(){e.reset()},this.endTimeline=function(){e.endTimeline()},d=function(g,v){var _=8,S=8,E,T;for(E=0;E<g;E++)S!==0&&(T=v.readExpGolomb(),S=(_+T+256)%256),_=S===0?_:S},h=function(g){for(var v=g.byteLength,_=[],S=1,E,T;S<v-2;)g[S]===0&&g[S+1]===0&&g[S+2]===3?(_.push(S+2),S+=2):S++;if(_.length===0)return g;E=v-_.length,T=new Uint8Array(E);var C=0;for(S=0;S<E;C++,S++)C===_[0]&&(C++,_.shift()),T[S]=g[C];return T},f=function(g){var v=0,_=0,S=0,E=0,T,C,R,b,F,O,L,D,x,B,M,I=[1,1],U,w;if(T=new qq(g),C=T.readUnsignedByte(),b=T.readUnsignedByte(),R=T.readUnsignedByte(),T.skipUnsignedExpGolomb(),$j[C]&&(F=T.readUnsignedExpGolomb(),F===3&&T.skipBits(1),T.skipUnsignedExpGolomb(),T.skipUnsignedExpGolomb(),T.skipBits(1),T.readBoolean()))for(M=F!==3?8:12,w=0;w<M;w++)T.readBoolean()&&(w<6?d(16,T):d(64,T));if(T.skipUnsignedExpGolomb(),O=T.readUnsignedExpGolomb(),O===0)T.readUnsignedExpGolomb();else if(O===1)for(T.skipBits(1),T.skipExpGolomb(),T.skipExpGolomb(),L=T.readUnsignedExpGolomb(),w=0;w<L;w++)T.skipExpGolomb();if(T.skipUnsignedExpGolomb(),T.skipBits(1),D=T.readUnsignedExpGolomb(),x=T.readUnsignedExpGolomb(),B=T.readBits(1),B===0&&T.skipBits(1),T.skipBits(1),T.readBoolean()&&(v=T.readUnsignedExpGolomb(),_=T.readUnsignedExpGolomb(),S=T.readUnsignedExpGolomb(),E=T.readUnsignedExpGolomb()),T.readBoolean()&&T.readBoolean()){switch(U=T.readUnsignedByte(),U){case 1:I=[1,1];break;case 2:I=[12,11];break;case 3:I=[10,11];break;case 4:I=[16,11];break;case 5:I=[40,33];break;case 6:I=[24,11];break;case 7:I=[20,11];break;case 8:I=[32,11];break;case 9:I=[80,33];break;case 10:I=[18,11];break;case 11:I=[15,11];break;case 12:I=[64,33];break;case 13:I=[160,99];break;case 14:I=[4,3];break;case 15:I=[3,2];break;case 16:I=[2,1];break;case 255:{I=[T.readUnsignedByte()<<8|T.readUnsignedByte(),T.readUnsignedByte()<<8|T.readUnsignedByte()];break}}I&&I[0]/I[1]}return{profileIdc:C,levelIdc:R,profileCompatibility:b,width:(D+1)*16-v*2-_*2,height:(2-B)*(x+1)*16-S*2-E*2,sarRatio:I}}};d_.prototype=new Vj;var ZD={H264Stream:d_,NalByteStream:$m},zj={Adts:CT,h264:ZD},Yj=Math.pow(2,32),Qq=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r;return t.getBigUint64?(r=t.getBigUint64(0),r<Number.MAX_SAFE_INTEGER?Number(r):r):t.getUint32(0)*Yj+t.getUint32(4)},gp={getUint64:Qq,MAX_UINT32:Yj},TU=gp.MAX_UINT32,gr,Xj,qj,XR,Qj,Jj,Zj,e8,qR,t8,n8,r8,i8,s8,a8,o8,l8,u8,c8,f8,d8,QR,cr,JR,h8,p8,SU,AU,g8,m8,v8,y8,ME,E8,_8,T8;(function(){var n;if(cr={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},!(typeof Uint8Array>"u")){for(n in cr)cr.hasOwnProperty(n)&&(cr[n]=[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3)]);JR=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),p8=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),h8=new Uint8Array([0,0,0,1]),SU=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),AU=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),g8={video:SU,audio:AU},y8=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),v8=new Uint8Array([0,0,0,0,0,0,0,0]),ME=new Uint8Array([0,0,0,0,0,0,0,0]),E8=ME,_8=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),T8=ME,m8=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})();gr=function(e){var t=[],r=0,o,u,h;for(o=1;o<arguments.length;o++)t.push(arguments[o]);for(o=t.length;o--;)r+=t[o].byteLength;for(u=new Uint8Array(r+8),h=new DataView(u.buffer,u.byteOffset,u.byteLength),h.setUint32(0,u.byteLength),u.set(e,4),o=0,r=8;o<t.length;o++)u.set(t[o],r),r+=t[o].byteLength;return u};Xj=function(){return gr(cr.dinf,gr(cr.dref,y8))};qj=function(e){return gr(cr.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))};XR=function(){return gr(cr.ftyp,JR,h8,JR,p8)};o8=function(e){return gr(cr.hdlr,g8[e])};Qj=function(e){return gr(cr.mdat,e)};a8=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,e.duration&255,85,196,0,0]);return e.samplerate&&(t[12]=e.samplerate>>>24&255,t[13]=e.samplerate>>>16&255,t[14]=e.samplerate>>>8&255,t[15]=e.samplerate&255),gr(cr.mdhd,t)};s8=function(e){return gr(cr.mdia,a8(e),o8(e.type),Zj(e))};Jj=function(e){return gr(cr.mfhd,new Uint8Array([0,0,0,0,(e&4278190080)>>24,(e&16711680)>>16,(e&65280)>>8,e&255]))};Zj=function(e){return gr(cr.minf,e.type==="video"?gr(cr.vmhd,m8):gr(cr.smhd,v8),Xj(),u8(e))};e8=function(e,t){for(var r=[],o=t.length;o--;)r[o]=f8(t[o]);return gr.apply(null,[cr.moof,Jj(e)].concat(r))};qR=function(e){for(var t=e.length,r=[];t--;)r[t]=r8(e[t]);return gr.apply(null,[cr.moov,n8(4294967295)].concat(r).concat(t8(e)))};t8=function(e){for(var t=e.length,r=[];t--;)r[t]=d8(e[t]);return gr.apply(null,[cr.mvex].concat(r))};n8=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(e&4278190080)>>24,(e&16711680)>>16,(e&65280)>>8,e&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return gr(cr.mvhd,t)};l8=function(e){var t=e.samples||[],r=new Uint8Array(4+t.length),o,u;for(u=0;u<t.length;u++)o=t[u].flags,r[u+4]=o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy;return gr(cr.sdtp,r)};u8=function(e){return gr(cr.stbl,c8(e),gr(cr.stts,T8),gr(cr.stsc,E8),gr(cr.stsz,_8),gr(cr.stco,ME))};(function(){var n,e;c8=function(r){return gr(cr.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),r.type==="video"?n(r):e(r))},n=function(r){var o=r.sps||[],u=r.pps||[],h=[],f=[],d,m;for(d=0;d<o.length;d++)h.push((o[d].byteLength&65280)>>>8),h.push(o[d].byteLength&255),h=h.concat(Array.prototype.slice.call(o[d]));for(d=0;d<u.length;d++)f.push((u[d].byteLength&65280)>>>8),f.push(u[d].byteLength&255),f=f.concat(Array.prototype.slice.call(u[d]));if(m=[cr.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(r.width&65280)>>8,r.width&255,(r.height&65280)>>8,r.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),gr(cr.avcC,new Uint8Array([1,r.profileIdc,r.profileCompatibility,r.levelIdc,255].concat([o.length],h,[u.length],f))),gr(cr.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],r.sarRatio){var g=r.sarRatio[0],v=r.sarRatio[1];m.push(gr(cr.pasp,new Uint8Array([(g&4278190080)>>24,(g&16711680)>>16,(g&65280)>>8,g&255,(v&4278190080)>>24,(v&16711680)>>16,(v&65280)>>8,v&255])))}return gr.apply(null,m)},e=function(r){return gr(cr.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(r.channelcount&65280)>>8,r.channelcount&255,(r.samplesize&65280)>>8,r.samplesize&255,0,0,0,0,(r.samplerate&65280)>>8,r.samplerate&255,0,0]),qj(r))}})();i8=function(e){var t=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(e.id&4278190080)>>24,(e.id&16711680)>>16,(e.id&65280)>>8,e.id&255,0,0,0,0,(e.duration&4278190080)>>24,(e.duration&16711680)>>16,(e.duration&65280)>>8,e.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(e.width&65280)>>8,e.width&255,0,0,(e.height&65280)>>8,e.height&255,0,0]);return gr(cr.tkhd,t)};f8=function(e){var t,r,o,u,h,f,d;return t=gr(cr.tfhd,new Uint8Array([0,0,0,58,(e.id&4278190080)>>24,(e.id&16711680)>>16,(e.id&65280)>>8,e.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),f=Math.floor(e.baseMediaDecodeTime/TU),d=Math.floor(e.baseMediaDecodeTime%TU),r=gr(cr.tfdt,new Uint8Array([1,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255])),h=32+20+8+16+8+8,e.type==="audio"?(o=QR(e,h),gr(cr.traf,t,r,o)):(u=l8(e),o=QR(e,u.length+h),gr(cr.traf,t,r,o,u))};r8=function(e){return e.duration=e.duration||4294967295,gr(cr.trak,i8(e),s8(e))};d8=function(e){var t=new Uint8Array([0,0,0,0,(e.id&4278190080)>>24,(e.id&16711680)>>16,(e.id&65280)>>8,e.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return e.type!=="video"&&(t[t.length-1]=0),gr(cr.trex,t)};(function(){var n,e,t;t=function(o,u){var h=0,f=0,d=0,m=0;return o.length&&(o[0].duration!==void 0&&(h=1),o[0].size!==void 0&&(f=2),o[0].flags!==void 0&&(d=4),o[0].compositionTimeOffset!==void 0&&(m=8)),[0,0,h|f|d|m,1,(o.length&4278190080)>>>24,(o.length&16711680)>>>16,(o.length&65280)>>>8,o.length&255,(u&4278190080)>>>24,(u&16711680)>>>16,(u&65280)>>>8,u&255]},e=function(o,u){var h,f,d,m,g,v;for(m=o.samples||[],u+=8+12+16*m.length,d=t(m,u),f=new Uint8Array(d.length+m.length*16),f.set(d),h=d.length,v=0;v<m.length;v++)g=m[v],f[h++]=(g.duration&4278190080)>>>24,f[h++]=(g.duration&16711680)>>>16,f[h++]=(g.duration&65280)>>>8,f[h++]=g.duration&255,f[h++]=(g.size&4278190080)>>>24,f[h++]=(g.size&16711680)>>>16,f[h++]=(g.size&65280)>>>8,f[h++]=g.size&255,f[h++]=g.flags.isLeading<<2|g.flags.dependsOn,f[h++]=g.flags.isDependedOn<<6|g.flags.hasRedundancy<<4|g.flags.paddingValue<<1|g.flags.isNonSyncSample,f[h++]=g.flags.degradationPriority&240<<8,f[h++]=g.flags.degradationPriority&15,f[h++]=(g.compositionTimeOffset&4278190080)>>>24,f[h++]=(g.compositionTimeOffset&16711680)>>>16,f[h++]=(g.compositionTimeOffset&65280)>>>8,f[h++]=g.compositionTimeOffset&255;return gr(cr.trun,f)},n=function(o,u){var h,f,d,m,g,v;for(m=o.samples||[],u+=8+12+8*m.length,d=t(m,u),h=new Uint8Array(d.length+m.length*8),h.set(d),f=d.length,v=0;v<m.length;v++)g=m[v],h[f++]=(g.duration&4278190080)>>>24,h[f++]=(g.duration&16711680)>>>16,h[f++]=(g.duration&65280)>>>8,h[f++]=g.duration&255,h[f++]=(g.size&4278190080)>>>24,h[f++]=(g.size&16711680)>>>16,h[f++]=(g.size&65280)>>>8,h[f++]=g.size&255;return gr(cr.trun,h)},QR=function(o,u){return o.type==="audio"?n(o,u):e(o,u)}})();var IT={ftyp:XR,mdat:Qj,moof:e8,moov:qR,initSegment:function(e){var t=XR(),r=qR(e),o;return o=new Uint8Array(t.byteLength+r.byteLength),o.set(t),o.set(r,t.byteLength),o}},Jq=function(e){return e>>>0},Zq=function(e){return("00"+e.toString(16)).slice(-2)},RT={toUnsigned:Jq,toHexString:Zq},eQ=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),t+=String.fromCharCode(e[2]),t+=String.fromCharCode(e[3]),t},eP=eQ,tQ=RT.toUnsigned,nQ=eP,rQ=function n(e,t){var r=[],o,u,h,f,d;if(!t.length)return null;for(o=0;o<e.byteLength;)u=tQ(e[o]<<24|e[o+1]<<16|e[o+2]<<8|e[o+3]),h=nQ(e.subarray(o+4,o+8)),f=u>1?o+u:e.byteLength,h===t[0]&&(t.length===1?r.push(e.subarray(o+8,f)):(d=n(e.subarray(o+8,f),t.slice(1)),d.length&&(r=r.concat(d)))),o=f;return r},tP=rQ,iQ=function(e){for(var t=0,r=String.fromCharCode(e[t]),o="";r!=="\0";)o+=r,t++,r=String.fromCharCode(e[t]);return o+=r,o},sQ={uint8ToCString:iQ},Hy=sQ.uint8ToCString,aQ=gp.getUint64,oQ=function(e){var t=4,r=e[0],o,u,h,f,d,m,g,v;if(r===0){o=Hy(e.subarray(t)),t+=o.length,u=Hy(e.subarray(t)),t+=u.length;var _=new DataView(e.buffer);h=_.getUint32(t),t+=4,d=_.getUint32(t),t+=4,m=_.getUint32(t),t+=4,g=_.getUint32(t),t+=4}else if(r===1){var _=new DataView(e.buffer);h=_.getUint32(t),t+=4,f=aQ(e.subarray(t)),t+=8,m=_.getUint32(t),t+=4,g=_.getUint32(t),t+=4,o=Hy(e.subarray(t)),t+=o.length,u=Hy(e.subarray(t)),t+=u.length}v=new Uint8Array(e.subarray(t,e.byteLength));var S={scheme_id_uri:o,value:u,timescale:h||1,presentation_time:f,presentation_time_delta:d,event_duration:m,id:g,message_data:v};return uQ(r,S)?S:void 0},lQ=function(e,t,r,o){return e||e===0?e/t:o+r/t},uQ=function(e,t){var r=t.scheme_id_uri!=="\0",o=e===0&&xU(t.presentation_time_delta)&&r,u=e===1&&xU(t.presentation_time)&&r;return!(e>1)&&o||u},xU=function(e){return e!==void 0||e!==null},cQ={parseEmsgBox:oQ,scaleTime:lQ},fQ=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4)},o=r.flags[2]&1,u=r.flags[2]&2,h=r.flags[2]&8,f=r.flags[2]&16,d=r.flags[2]&32,m=r.flags[0]&65536,g=r.flags[0]&131072,v;return v=8,o&&(v+=4,r.baseDataOffset=t.getUint32(12),v+=4),u&&(r.sampleDescriptionIndex=t.getUint32(v),v+=4),h&&(r.defaultSampleDuration=t.getUint32(v),v+=4),f&&(r.defaultSampleSize=t.getUint32(v),v+=4),d&&(r.defaultSampleFlags=t.getUint32(v)),m&&(r.durationIsEmpty=!0),!o&&g&&(r.baseDataOffsetIsMoof=!0),r},nP=fQ,dQ=function(e){return{isLeading:(e[0]&12)>>>2,dependsOn:e[0]&3,isDependedOn:(e[1]&192)>>>6,hasRedundancy:(e[1]&48)>>>4,paddingValue:(e[1]&14)>>>1,isNonSyncSample:e[1]&1,degradationPriority:e[2]<<8|e[3]}},hQ=dQ,CU=hQ,pQ=function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},r=new DataView(e.buffer,e.byteOffset,e.byteLength),o=t.flags[2]&1,u=t.flags[2]&4,h=t.flags[1]&1,f=t.flags[1]&2,d=t.flags[1]&4,m=t.flags[1]&8,g=r.getUint32(4),v=8,_;for(o&&(t.dataOffset=r.getInt32(v),v+=4),u&&g&&(_={flags:CU(e.subarray(v,v+4))},v+=4,h&&(_.duration=r.getUint32(v),v+=4),f&&(_.size=r.getUint32(v),v+=4),m&&(t.version===1?_.compositionTimeOffset=r.getInt32(v):_.compositionTimeOffset=r.getUint32(v),v+=4),t.samples.push(_),g--);g--;)_={},h&&(_.duration=r.getUint32(v),v+=4),f&&(_.size=r.getUint32(v),v+=4),d&&(_.flags=CU(e.subarray(v,v+4)),v+=4),m&&(t.version===1?_.compositionTimeOffset=r.getInt32(v):_.compositionTimeOffset=r.getUint32(v),v+=4),t.samples.push(_);return t},rP=pQ,gQ=RT.toUnsigned,mQ=gp.getUint64,vQ=function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4))};return t.version===1?t.baseMediaDecodeTime=mQ(e.subarray(4)):t.baseMediaDecodeTime=gQ(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),t},iP=vQ,Qg;typeof window<"u"?Qg=window:typeof ya<"u"?Qg=ya:typeof self<"u"?Qg=self:Qg={};var rt=Qg,yQ=function(e,t,r){if(!e)return-1;for(var o=r;o<e.length;o++)if(e[o]===t)return o;return-1},EQ={typedArrayIndexOf:yQ},Vy=EQ.typedArrayIndexOf,$y={Iso88591:0,Utf16:1,Utf16be:2,Utf8:3},S8=function(e,t,r){var o,u="";for(o=t;o<r;o++)u+="%"+("00"+e[o].toString(16)).slice(-2);return u},Lg=function(e,t,r){return decodeURIComponent(S8(e,t,r))},Mg=function(e,t,r){return unescape(S8(e,t,r))},Jg=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},Zg={APIC:function(e){var t=1,r,o,u="-->";e.data[0]===$y.Utf8&&(r=Vy(e.data,0,t),!(r<0)&&(e.mimeType=Mg(e.data,t,r),t=r+1,e.pictureType=e.data[t],t++,o=Vy(e.data,0,t),!(o<0)&&(e.description=Lg(e.data,t,o),t=o+1,e.mimeType===u?e.url=Mg(e.data,t,e.data.length):e.pictureData=e.data.subarray(t,e.data.length))))},"T*":function(e){e.data[0]===$y.Utf8&&(e.value=Lg(e.data,1,e.data.length).replace(/\0*$/,""),e.values=e.value.split("\0"))},TXXX:function(e){var t;e.data[0]===$y.Utf8&&(t=Vy(e.data,0,1),t!==-1&&(e.description=Lg(e.data,1,t),e.value=Lg(e.data,t+1,e.data.length).replace(/\0*$/,""),e.data=e.value))},"W*":function(e){e.url=Mg(e.data,0,e.data.length).replace(/\0.*$/,"")},WXXX:function(e){var t;e.data[0]===$y.Utf8&&(t=Vy(e.data,0,1),t!==-1&&(e.description=Lg(e.data,1,t),e.url=Mg(e.data,t+1,e.data.length).replace(/\0.*$/,"")))},PRIV:function(e){var t;for(t=0;t<e.data.length;t++)if(e.data[t]===0){e.owner=Mg(e.data,0,t);break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}},_Q=function(e){var t,r,o=10,u=0,h=[];if(!(e.length<10||e[0]!=="I".charCodeAt(0)||e[1]!=="D".charCodeAt(0)||e[2]!=="3".charCodeAt(0))){u=Jg(e.subarray(6,10)),u+=10;var f=e[5]&64;f&&(o+=4,o+=Jg(e.subarray(10,14)),u-=Jg(e.subarray(16,20)));do{if(t=Jg(e.subarray(o+4,o+8)),t<1)break;r=String.fromCharCode(e[o],e[o+1],e[o+2],e[o+3]);var d={id:r,data:e.subarray(o+10,o+t+10)};d.key=d.id,Zg[d.id]?Zg[d.id](d):d.id[0]==="T"?Zg["T*"](d):d.id[0]==="W"&&Zg["W*"](d),h.push(d),o+=10,o+=t}while(o<u);return h}},A8={parseId3Frames:_Q,parseSyncSafeInteger:Jg,frameParsers:Zg},h_=RT.toUnsigned,wg=RT.toHexString,ki=tP,Th=eP,jC=cQ,TQ=nP,SQ=rP,AQ=iP,xQ=gp.getUint64,x8,C8,I8,R8,b8,sP,D8,ZR=rt,CQ=A8.parseId3Frames;x8=function(e){var t={},r=ki(e,["moov","trak"]);return r.reduce(function(o,u){var h,f,d,m,g;return h=ki(u,["tkhd"])[0],!h||(f=h[0],d=f===0?12:20,m=h_(h[d]<<24|h[d+1]<<16|h[d+2]<<8|h[d+3]),g=ki(u,["mdia","mdhd"])[0],!g)?null:(f=g[0],d=f===0?12:20,o[m]=h_(g[d]<<24|g[d+1]<<16|g[d+2]<<8|g[d+3]),o)},t)};C8=function(e,t){var r;r=ki(t,["moof","traf"]);var o=r.reduce(function(u,h){var f=ki(h,["tfhd"])[0],d=h_(f[4]<<24|f[5]<<16|f[6]<<8|f[7]),m=e[d]||9e4,g=ki(h,["tfdt"])[0],v=new DataView(g.buffer,g.byteOffset,g.byteLength),_;g[0]===1?_=xQ(g.subarray(4,12)):_=v.getUint32(4);var S;return typeof _=="bigint"?S=_/ZR.BigInt(m):typeof _=="number"&&!isNaN(_)&&(S=_/m),S<Number.MAX_SAFE_INTEGER&&(S=Number(S)),S<u&&(u=S),u},1/0);return typeof o=="bigint"||isFinite(o)?o:0};I8=function(e,t){var r=ki(t,["moof","traf"]),o=0,u=0,h;if(r&&r.length){var f=ki(r[0],["tfhd"])[0],d=ki(r[0],["trun"])[0],m=ki(r[0],["tfdt"])[0];if(f){var g=TQ(f);h=g.trackId}if(m){var v=AQ(m);o=v.baseMediaDecodeTime}if(d){var _=SQ(d);_.samples&&_.samples.length&&(u=_.samples[0].compositionTimeOffset||0)}}var S=e[h]||9e4;typeof o=="bigint"&&(u=ZR.BigInt(u),S=ZR.BigInt(S));var E=(o+u)/S;return typeof E=="bigint"&&E<Number.MAX_SAFE_INTEGER&&(E=Number(E)),E};R8=function(e){var t=ki(e,["moov","trak"]),r=[];return t.forEach(function(o){var u=ki(o,["mdia","hdlr"]),h=ki(o,["tkhd"]);u.forEach(function(f,d){var m=Th(f.subarray(8,12)),g=h[d],v,_,S;m==="vide"&&(v=new DataView(g.buffer,g.byteOffset,g.byteLength),_=v.getUint8(0),S=_===0?v.getUint32(12):v.getUint32(20),r.push(S))})}),r};sP=function(e){var t=e[0],r=t===0?12:20;return h_(e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3])};b8=function(e){var t=ki(e,["moov","trak"]),r=[];return t.forEach(function(o){var u={},h=ki(o,["tkhd"])[0],f,d;h&&(f=new DataView(h.buffer,h.byteOffset,h.byteLength),d=f.getUint8(0),u.id=d===0?f.getUint32(12):f.getUint32(20));var m=ki(o,["mdia","hdlr"])[0];if(m){var g=Th(m.subarray(8,12));g==="vide"?u.type="video":g==="soun"?u.type="audio":u.type=g}var v=ki(o,["mdia","minf","stbl","stsd"])[0];if(v){var _=v.subarray(8);u.codec=Th(_.subarray(4,8));var S=ki(_,[u.codec])[0],E,T;S&&(/^[asm]vc[1-9]$/i.test(u.codec)?(E=S.subarray(78),T=Th(E.subarray(4,8)),T==="avcC"&&E.length>11?(u.codec+=".",u.codec+=wg(E[9]),u.codec+=wg(E[10]),u.codec+=wg(E[11])):u.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(u.codec)?(E=S.subarray(28),T=Th(E.subarray(4,8)),T==="esds"&&E.length>20&&E[19]!==0?(u.codec+="."+wg(E[19]),u.codec+="."+wg(E[20]>>>2&63).replace(/^0/,"")):u.codec="mp4a.40.2"):u.codec=u.codec.toLowerCase())}var C=ki(o,["mdia","mdhd"])[0];C&&(u.timescale=sP(C)),r.push(u)}),r};D8=function(e,t){t===void 0&&(t=0);var r=ki(e,["emsg"]);return r.map(function(o){var u=jC.parseEmsgBox(new Uint8Array(o)),h=CQ(u.message_data);return{cueTime:jC.scaleTime(u.presentation_time,u.timescale,u.presentation_time_delta,t),duration:jC.scaleTime(u.event_duration,u.timescale),frames:h}})};var IQ={findBox:ki,parseType:Th,timescale:x8,startTime:C8,compositionStartTime:I8,videoTrackIds:R8,tracks:b8,getTimescaleFromMediaHeader:sP,getEmsgID3:D8},RQ=function(e){var t,r,o=[],u=[];for(u.byteLength=0,u.nalCount=0,u.duration=0,o.byteLength=0,t=0;t<e.length;t++)r=e[t],r.nalUnitType==="access_unit_delimiter_rbsp"?(o.length&&(o.duration=r.dts-o.dts,u.byteLength+=o.byteLength,u.nalCount+=o.length,u.duration+=o.duration,u.push(o)),o=[r],o.byteLength=r.data.byteLength,o.pts=r.pts,o.dts=r.dts):(r.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(o.keyFrame=!0),o.duration=r.dts-o.dts,o.byteLength+=r.data.byteLength,o.push(r));return u.length&&(!o.duration||o.duration<=0)&&(o.duration=u[u.length-1].duration),u.byteLength+=o.byteLength,u.nalCount+=o.length,u.duration+=o.duration,u.push(o),u},bQ=function(e){var t,r,o=[],u=[];for(o.byteLength=0,o.nalCount=0,o.duration=0,o.pts=e[0].pts,o.dts=e[0].dts,u.byteLength=0,u.nalCount=0,u.duration=0,u.pts=e[0].pts,u.dts=e[0].dts,t=0;t<e.length;t++)r=e[t],r.keyFrame?(o.length&&(u.push(o),u.byteLength+=o.byteLength,u.nalCount+=o.nalCount,u.duration+=o.duration),o=[r],o.nalCount=r.length,o.byteLength=r.byteLength,o.pts=r.pts,o.dts=r.dts,o.duration=r.duration):(o.duration+=r.duration,o.nalCount+=r.length,o.byteLength+=r.byteLength,o.push(r));return u.length&&o.duration<=0&&(o.duration=u[u.length-1].duration),u.byteLength+=o.byteLength,u.nalCount+=o.nalCount,u.duration+=o.duration,u.push(o),u},DQ=function(e){var t;return!e[0][0].keyFrame&&e.length>1&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},PQ=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},P8=function(e,t){var r=PQ();return r.dataOffset=t,r.compositionTimeOffset=e.pts-e.dts,r.duration=e.duration,r.size=4*e.length,r.size+=e.byteLength,e.keyFrame&&(r.flags.dependsOn=2,r.flags.isNonSyncSample=0),r},LQ=function(e,t){var r,o,u,h,f,d=t||0,m=[];for(r=0;r<e.length;r++)for(h=e[r],o=0;o<h.length;o++)f=h[o],u=P8(f,d),d+=u.size,m.push(u);return m},MQ=function(e){var t,r,o,u,h,f,d=0,m=e.byteLength,g=e.nalCount,v=m+4*g,_=new Uint8Array(v),S=new DataView(_.buffer);for(t=0;t<e.length;t++)for(u=e[t],r=0;r<u.length;r++)for(h=u[r],o=0;o<h.length;o++)f=h[o],S.setUint32(d,f.data.byteLength),d+=4,_.set(f.data,d),d+=f.data.byteLength;return _},wQ=function(e,t){var r,o=t||0,u=[];return r=P8(e,o),u.push(r),u},OQ=function(e){var t,r,o=0,u=e.byteLength,h=e.length,f=u+4*h,d=new Uint8Array(f),m=new DataView(d.buffer);for(t=0;t<e.length;t++)r=e[t],m.setUint32(o,r.data.byteLength),o+=4,d.set(r.data,o),o+=r.data.byteLength;return d},L8={groupNalsIntoFrames:RQ,groupFramesIntoGops:bQ,extendFirstKeyFrame:DQ,generateSampleTable:LQ,concatenateNalData:MQ,generateSampleTableForFrame:wQ,concatenateNalDataForFrame:OQ},lc=[33,16,5,32,164,27],KC=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Nr=function(e){for(var t=[];e--;)t.push(0);return t},NQ=function(e){return Object.keys(e).reduce(function(t,r){return t[r]=new Uint8Array(e[r].reduce(function(o,u){return o.concat(u)},[])),t},{})},GC,FQ=function(){if(!GC){var n={96e3:[lc,[227,64],Nr(154),[56]],88200:[lc,[231],Nr(170),[56]],64e3:[lc,[248,192],Nr(240),[56]],48e3:[lc,[255,192],Nr(268),[55,148,128],Nr(54),[112]],44100:[lc,[255,192],Nr(268),[55,163,128],Nr(84),[112]],32e3:[lc,[255,192],Nr(268),[55,234],Nr(226),[112]],24e3:[lc,[255,192],Nr(268),[55,255,128],Nr(268),[111,112],Nr(126),[224]],16e3:[lc,[255,192],Nr(268),[55,255,128],Nr(268),[111,255],Nr(269),[223,108],Nr(195),[1,192]],12e3:[KC,Nr(268),[3,127,248],Nr(268),[6,255,240],Nr(268),[13,255,224],Nr(268),[27,253,128],Nr(259),[56]],11025:[KC,Nr(268),[3,127,248],Nr(268),[6,255,240],Nr(268),[13,255,224],Nr(268),[27,255,192],Nr(268),[55,175,128],Nr(108),[112]],8e3:[KC,Nr(268),[3,121,16],Nr(47),[7]]};GC=NQ(n)}return GC},kQ=FQ,zy=Wc,UQ=function(e){var t,r,o=0;for(t=0;t<e.length;t++)r=e[t],o+=r.data.byteLength;return o},BQ=function(e,t,r,o){var u,h=0,f=0,d=0,m=0,g,v,_;if(t.length&&(u=zy.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate),h=Math.ceil(zy.ONE_SECOND_IN_TS/(e.samplerate/1024)),r&&o&&(f=u-Math.max(r,o),d=Math.floor(f/h),m=d*h),!(d<1||m>zy.ONE_SECOND_IN_TS/2))){for(g=kQ()[e.samplerate],g||(g=t[0].data),v=0;v<d;v++)_=t[0],t.splice(0,0,{data:g,dts:_.dts-h,pts:_.pts-h});return e.baseMediaDecodeTime-=Math.floor(zy.videoTsToAudioTs(m,e.samplerate)),m}},jQ=function(e,t,r){return t.minSegmentDts>=r?e:(t.minSegmentDts=1/0,e.filter(function(o){return o.dts>=r?(t.minSegmentDts=Math.min(t.minSegmentDts,o.dts),t.minSegmentPts=t.minSegmentDts,!0):!1}))},KQ=function(e){var t,r,o=[];for(t=0;t<e.length;t++)r=e[t],o.push({size:r.data.byteLength,duration:1024});return o},GQ=function(e){var t,r,o=0,u=new Uint8Array(UQ(e));for(t=0;t<e.length;t++)r=e[t],u.set(r.data,o),o+=r.data.byteLength;return u},M8={prefixWithSilence:BQ,trimAdtsFramesByEarliestDts:jQ,generateSampleTable:KQ,concatenateFrameData:GQ},WQ=Wc.ONE_SECOND_IN_TS,HQ=function(e,t){typeof t.pts=="number"&&(e.timelineStartInfo.pts===void 0&&(e.timelineStartInfo.pts=t.pts),e.minSegmentPts===void 0?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),e.maxSegmentPts===void 0?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),typeof t.dts=="number"&&(e.timelineStartInfo.dts===void 0&&(e.timelineStartInfo.dts=t.dts),e.minSegmentDts===void 0?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),e.maxSegmentDts===void 0?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))},VQ=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},$Q=function(e,t){var r,o,u=e.minSegmentDts;return t||(u-=e.timelineStartInfo.dts),r=e.timelineStartInfo.baseMediaDecodeTime,r+=u,r=Math.max(0,r),e.type==="audio"&&(o=e.samplerate/WQ,r*=o,r=Math.floor(r)),r},bT={clearDtsInfo:VQ,calculateTrackBaseMediaDecodeTime:$Q,collectDtsInfo:HQ},w8=4,zQ=128,YQ=function(e){for(var t=0,r={payloadType:-1,payloadSize:0},o=0,u=0;t<e.byteLength&&e[t]!==zQ;){for(;e[t]===255;)o+=255,t++;for(o+=e[t++];e[t]===255;)u+=255,t++;if(u+=e[t++],!r.payload&&o===w8){var h=String.fromCharCode(e[t+3],e[t+4],e[t+5],e[t+6]);if(h==="GA94"){r.payloadType=o,r.payloadSize=u,r.payload=e.subarray(t,t+u);break}else r.payload=void 0}t+=u,o=0,u=0}return r},XQ=function(e){return e.payload[0]!==181||(e.payload[1]<<8|e.payload[2])!==49||String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])!=="GA94"||e.payload[7]!==3?null:e.payload.subarray(8,e.payload.length-1)},qQ=function(e,t){var r=[],o,u,h,f;if(!(t[0]&64))return r;for(u=t[0]&31,o=0;o<u;o++)h=o*3,f={type:t[h+2]&3,pts:e},t[h+2]&4&&(f.ccData=t[h+3]<<8|t[h+4],r.push(f));return r},QQ=function(e){for(var t=e.byteLength,r=[],o=1,u,h;o<t-2;)e[o]===0&&e[o+1]===0&&e[o+2]===3?(r.push(o+2),o+=2):o++;if(r.length===0)return e;u=t-r.length,h=new Uint8Array(u);var f=0;for(o=0;o<u;f++,o++)f===r[0]&&(f++,r.shift()),h[o]=e[f];return h},O8={parseSei:YQ,parseUserData:XQ,parseCaptionPackets:qQ,discardEmulationPreventionBytes:QQ,USER_DATA_REGISTERED_ITU_T_T35:w8},aP=za,Yy=O8,Ya=function n(e){e=e||{},n.prototype.init.call(this),this.parse708captions_=typeof e.parse708captions=="boolean"?e.parse708captions:!0,this.captionPackets_=[],this.ccStreams_=[new Si(0,0),new Si(0,1),new Si(1,0),new Si(1,1)],this.parse708captions_&&(this.cc708Stream_=new ei({captionServices:e.captionServices})),this.reset(),this.ccStreams_.forEach(function(t){t.on("data",this.trigger.bind(this,"data")),t.on("partialdone",this.trigger.bind(this,"partialdone")),t.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};Ya.prototype=new aP;Ya.prototype.push=function(n){var e,t,r;if(n.nalUnitType==="sei_rbsp"&&(e=Yy.parseSei(n.escapedRBSP),!!e.payload&&e.payloadType===Yy.USER_DATA_REGISTERED_ITU_T_T35&&(t=Yy.parseUserData(e),!!t))){if(n.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(n.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}r=Yy.parseCaptionPackets(n.pts,t),this.captionPackets_=this.captionPackets_.concat(r),this.latestDts_!==n.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=n.dts}};Ya.prototype.flushCCStreams=function(n){this.ccStreams_.forEach(function(e){return n==="flush"?e.flush():e.partialFlush()},this)};Ya.prototype.flushStream=function(n){if(!this.captionPackets_.length){this.flushCCStreams(n);return}this.captionPackets_.forEach(function(e,t){e.presortIndex=t}),this.captionPackets_.sort(function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts}),this.captionPackets_.forEach(function(e){e.type<2?this.dispatchCea608Packet(e):this.dispatchCea708Packet(e)},this),this.captionPackets_.length=0,this.flushCCStreams(n)};Ya.prototype.flush=function(){return this.flushStream("flush")};Ya.prototype.partialFlush=function(){return this.flushStream("partialFlush")};Ya.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(n){n.reset()})};Ya.prototype.dispatchCea608Packet=function(n){this.setsTextOrXDSActive(n)?this.activeCea608Channel_[n.type]=null:this.setsChannel1Active(n)?this.activeCea608Channel_[n.type]=0:this.setsChannel2Active(n)&&(this.activeCea608Channel_[n.type]=1),this.activeCea608Channel_[n.type]!==null&&this.ccStreams_[(n.type<<1)+this.activeCea608Channel_[n.type]].push(n)};Ya.prototype.setsChannel1Active=function(n){return(n.ccData&30720)===4096};Ya.prototype.setsChannel2Active=function(n){return(n.ccData&30720)===6144};Ya.prototype.setsTextOrXDSActive=function(n){return(n.ccData&28928)===256||(n.ccData&30974)===4138||(n.ccData&30974)===6186};Ya.prototype.dispatchCea708Packet=function(n){this.parse708captions_&&this.cc708Stream_.push(n)};var JQ={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},ZQ=function(e){var t=JQ[e]||e;return e&4096&&e===t?"":String.fromCharCode(t)},p_=function(e){return 32<=e&&e<=127||160<=e&&e<=255},Ku=function(e){this.windowNum=e,this.reset()};Ku.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0};Ku.prototype.getText=function(){return this.rows.join(`
`)};Ku.prototype.clearText=function(){this.rows=[""],this.rowIdx=0};Ku.prototype.newLine=function(n){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(n),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--};Ku.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1};Ku.prototype.addText=function(n){this.rows[this.rowIdx]+=n};Ku.prototype.backspace=function(){if(!this.isEmpty()){var n=this.rows[this.rowIdx];this.rows[this.rowIdx]=n.substr(0,n.length-1)}};var DT=function(e,t,r){this.serviceNum=e,this.text="",this.currentWindow=new Ku(-1),this.windows=[],this.stream=r,typeof t=="string"&&this.createTextDecoder(t)};DT.prototype.init=function(n,e){this.startPts=n;for(var t=0;t<8;t++)this.windows[t]=new Ku(t),typeof e=="function"&&(this.windows[t].beforeRowOverflow=e)};DT.prototype.setCurrentWindow=function(n){this.currentWindow=this.windows[n]};DT.prototype.createTextDecoder=function(n){if(typeof TextDecoder>"u")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(n)}catch(e){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+n+" encoding. "+e})}};var ei=function n(e){e=e||{},n.prototype.init.call(this);var t=this,r=e.captionServices||{},o={},u;Object.keys(r).forEach(function(h){u=r[h],/^SERVICE/.test(h)&&(o[h]=u.encoding)}),this.serviceEncodings=o,this.current708Packet=null,this.services={},this.push=function(h){h.type===3?(t.new708Packet(),t.add708Bytes(h)):(t.current708Packet===null&&t.new708Packet(),t.add708Bytes(h))}};ei.prototype=new aP;ei.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}};ei.prototype.add708Bytes=function(n){var e=n.ccData,t=e>>>8,r=e&255;this.current708Packet.ptsVals.push(n.pts),this.current708Packet.data.push(t),this.current708Packet.data.push(r)};ei.prototype.push708Packet=function(){var n=this.current708Packet,e=n.data,t=null,r=null,o=0,u=e[o++];for(n.seq=u>>6,n.sizeCode=u&63;o<e.length;o++)u=e[o++],t=u>>5,r=u&31,t===7&&r>0&&(u=e[o++],t=u),this.pushServiceBlock(t,o,r),r>0&&(o+=r-1)};ei.prototype.pushServiceBlock=function(n,e,t){var r,o=e,u=this.current708Packet.data,h=this.services[n];for(h||(h=this.initService(n,o));o<e+t&&o<u.length;o++)r=u[o],p_(r)?o=this.handleText(o,h):r===24?o=this.multiByteCharacter(o,h):r===16?o=this.extendedCommands(o,h):128<=r&&r<=135?o=this.setCurrentWindow(o,h):152<=r&&r<=159?o=this.defineWindow(o,h):r===136?o=this.clearWindows(o,h):r===140?o=this.deleteWindows(o,h):r===137?o=this.displayWindows(o,h):r===138?o=this.hideWindows(o,h):r===139?o=this.toggleWindows(o,h):r===151?o=this.setWindowAttributes(o,h):r===144?o=this.setPenAttributes(o,h):r===145?o=this.setPenColor(o,h):r===146?o=this.setPenLocation(o,h):r===143?h=this.reset(o,h):r===8?h.currentWindow.backspace():r===12?h.currentWindow.clearText():r===13?h.currentWindow.pendingNewLine=!0:r===14?h.currentWindow.clearText():r===141&&o++};ei.prototype.extendedCommands=function(n,e){var t=this.current708Packet.data,r=t[++n];return p_(r)&&(n=this.handleText(n,e,{isExtended:!0})),n};ei.prototype.getPts=function(n){return this.current708Packet.ptsVals[Math.floor(n/2)]};ei.prototype.initService=function(n,e){var r="SERVICE"+n,t=this,r,o;return r in this.serviceEncodings&&(o=this.serviceEncodings[r]),this.services[n]=new DT(n,o,t),this.services[n].init(this.getPts(e),function(u){t.flushDisplayed(u,t.services[n])}),this.services[n]};ei.prototype.handleText=function(n,e,t){var r=t&&t.isExtended,o=t&&t.isMultiByte,u=this.current708Packet.data,h=r?4096:0,f=u[n],d=u[n+1],m=e.currentWindow,g,v;return e.textDecoder_&&!r?(o?(v=[f,d],n++):v=[f],g=e.textDecoder_.decode(new Uint8Array(v))):g=ZQ(h|f),m.pendingNewLine&&!m.isEmpty()&&m.newLine(this.getPts(n)),m.pendingNewLine=!1,m.addText(g),n};ei.prototype.multiByteCharacter=function(n,e){var t=this.current708Packet.data,r=t[n+1],o=t[n+2];return p_(r)&&p_(o)&&(n=this.handleText(++n,e,{isMultiByte:!0})),n};ei.prototype.setCurrentWindow=function(n,e){var t=this.current708Packet.data,r=t[n],o=r&7;return e.setCurrentWindow(o),n};ei.prototype.defineWindow=function(n,e){var t=this.current708Packet.data,r=t[n],o=r&7;e.setCurrentWindow(o);var u=e.currentWindow;return r=t[++n],u.visible=(r&32)>>5,u.rowLock=(r&16)>>4,u.columnLock=(r&8)>>3,u.priority=r&7,r=t[++n],u.relativePositioning=(r&128)>>7,u.anchorVertical=r&127,r=t[++n],u.anchorHorizontal=r,r=t[++n],u.anchorPoint=(r&240)>>4,u.rowCount=r&15,r=t[++n],u.columnCount=r&63,r=t[++n],u.windowStyle=(r&56)>>3,u.penStyle=r&7,u.virtualRowCount=u.rowCount+1,n};ei.prototype.setWindowAttributes=function(n,e){var t=this.current708Packet.data,r=t[n],o=e.currentWindow.winAttr;return r=t[++n],o.fillOpacity=(r&192)>>6,o.fillRed=(r&48)>>4,o.fillGreen=(r&12)>>2,o.fillBlue=r&3,r=t[++n],o.borderType=(r&192)>>6,o.borderRed=(r&48)>>4,o.borderGreen=(r&12)>>2,o.borderBlue=r&3,r=t[++n],o.borderType+=(r&128)>>5,o.wordWrap=(r&64)>>6,o.printDirection=(r&48)>>4,o.scrollDirection=(r&12)>>2,o.justify=r&3,r=t[++n],o.effectSpeed=(r&240)>>4,o.effectDirection=(r&12)>>2,o.displayEffect=r&3,n};ei.prototype.flushDisplayed=function(n,e){for(var t=[],r=0;r<8;r++)e.windows[r].visible&&!e.windows[r].isEmpty()&&t.push(e.windows[r].getText());e.endPts=n,e.text=t.join(`

`),this.pushCaption(e),e.startPts=n};ei.prototype.pushCaption=function(n){n.text!==""&&(this.trigger("data",{startPts:n.startPts,endPts:n.endPts,text:n.text,stream:"cc708_"+n.serviceNum}),n.text="",n.startPts=n.endPts)};ei.prototype.displayWindows=function(n,e){var t=this.current708Packet.data,r=t[++n],o=this.getPts(n);this.flushDisplayed(o,e);for(var u=0;u<8;u++)r&1<<u&&(e.windows[u].visible=1);return n};ei.prototype.hideWindows=function(n,e){var t=this.current708Packet.data,r=t[++n],o=this.getPts(n);this.flushDisplayed(o,e);for(var u=0;u<8;u++)r&1<<u&&(e.windows[u].visible=0);return n};ei.prototype.toggleWindows=function(n,e){var t=this.current708Packet.data,r=t[++n],o=this.getPts(n);this.flushDisplayed(o,e);for(var u=0;u<8;u++)r&1<<u&&(e.windows[u].visible^=1);return n};ei.prototype.clearWindows=function(n,e){var t=this.current708Packet.data,r=t[++n],o=this.getPts(n);this.flushDisplayed(o,e);for(var u=0;u<8;u++)r&1<<u&&e.windows[u].clearText();return n};ei.prototype.deleteWindows=function(n,e){var t=this.current708Packet.data,r=t[++n],o=this.getPts(n);this.flushDisplayed(o,e);for(var u=0;u<8;u++)r&1<<u&&e.windows[u].reset();return n};ei.prototype.setPenAttributes=function(n,e){var t=this.current708Packet.data,r=t[n],o=e.currentWindow.penAttr;return r=t[++n],o.textTag=(r&240)>>4,o.offset=(r&12)>>2,o.penSize=r&3,r=t[++n],o.italics=(r&128)>>7,o.underline=(r&64)>>6,o.edgeType=(r&56)>>3,o.fontStyle=r&7,n};ei.prototype.setPenColor=function(n,e){var t=this.current708Packet.data,r=t[n],o=e.currentWindow.penColor;return r=t[++n],o.fgOpacity=(r&192)>>6,o.fgRed=(r&48)>>4,o.fgGreen=(r&12)>>2,o.fgBlue=r&3,r=t[++n],o.bgOpacity=(r&192)>>6,o.bgRed=(r&48)>>4,o.bgGreen=(r&12)>>2,o.bgBlue=r&3,r=t[++n],o.edgeRed=(r&48)>>4,o.edgeGreen=(r&12)>>2,o.edgeBlue=r&3,n};ei.prototype.setPenLocation=function(n,e){var t=this.current708Packet.data,r=t[n],o=e.currentWindow.penLoc;return e.currentWindow.pendingNewLine=!0,r=t[++n],o.row=r&15,r=t[++n],o.column=r&63,n};ei.prototype.reset=function(n,e){var t=this.getPts(n);return this.flushDisplayed(t,e),this.initService(e.serviceNum,n)};var eJ={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Xy=function(e){return e===null?"":(e=eJ[e]||e,String.fromCharCode(e))},PT=14,tJ=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],jf=function(){for(var e=[],t=PT+1;t--;)e.push("");return e},Si=function n(e,t){n.prototype.init.call(this),this.field_=e||0,this.dataChannel_=t||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(r){var o,u,h,f,d;if(o=r.ccData&32639,o===this.lastControlCode_){this.lastControlCode_=null;return}if((o&61440)===4096?this.lastControlCode_=o:o!==this.PADDING_&&(this.lastControlCode_=null),h=o>>>8,f=o&255,o!==this.PADDING_)if(o===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(o===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(r.pts),this.flushDisplayed(r.pts),u=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=u,this.startPts_=r.pts;else if(o===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(r.pts);else if(o===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(r.pts);else if(o===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(r.pts);else if(o===this.CARRIAGE_RETURN_)this.clearFormatting(r.pts),this.flushDisplayed(r.pts),this.shiftRowsUp_(),this.startPts_=r.pts;else if(o===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(o===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(r.pts),this.displayed_=jf();else if(o===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=jf();else if(o===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(r.pts),this.displayed_=jf()),this.mode_="paintOn",this.startPts_=r.pts;else if(this.isSpecialCharacter(h,f))h=(h&3)<<8,d=Xy(h|f),this[this.mode_](r.pts,d),this.column_++;else if(this.isExtCharacter(h,f))this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),h=(h&3)<<8,d=Xy(h|f),this[this.mode_](r.pts,d),this.column_++;else if(this.isMidRowCode(h,f))this.clearFormatting(r.pts),this[this.mode_](r.pts," "),this.column_++,(f&14)===14&&this.addFormatting(r.pts,["i"]),(f&1)===1&&this.addFormatting(r.pts,["u"]);else if(this.isOffsetControlCode(h,f))this.column_+=f&3;else if(this.isPAC(h,f)){var m=tJ.indexOf(o&7968);this.mode_==="rollUp"&&(m-this.rollUpRows_+1<0&&(m=this.rollUpRows_-1),this.setRollUp(r.pts,m)),m!==this.row_&&(this.clearFormatting(r.pts),this.row_=m),f&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(r.pts,["u"]),(o&16)===16&&(this.column_=((o&14)>>1)*4),this.isColorPAC(f)&&(f&14)===14&&this.addFormatting(r.pts,["i"])}else this.isNormalChar(h)&&(f===0&&(f=null),d=Xy(h),d+=Xy(f),this[this.mode_](r.pts,d),this.column_+=d.length)}};Si.prototype=new aP;Si.prototype.flushDisplayed=function(n){var e=this.displayed_.map(function(t,r){try{return t.trim()}catch{return this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+r+"."}),""}},this).join(`
`).replace(/^\n+|\n+$/g,"");e.length&&this.trigger("data",{startPts:this.startPts_,endPts:n,text:e,stream:this.name_})};Si.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=jf(),this.nonDisplayed_=jf(),this.lastControlCode_=null,this.column_=0,this.row_=PT,this.rollUpRows_=2,this.formatting_=[]};Si.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46};Si.prototype.isSpecialCharacter=function(n,e){return n===this.EXT_&&e>=48&&e<=63};Si.prototype.isExtCharacter=function(n,e){return(n===this.EXT_+1||n===this.EXT_+2)&&e>=32&&e<=63};Si.prototype.isMidRowCode=function(n,e){return n===this.EXT_&&e>=32&&e<=47};Si.prototype.isOffsetControlCode=function(n,e){return n===this.OFFSET_&&e>=33&&e<=35};Si.prototype.isPAC=function(n,e){return n>=this.BASE_&&n<this.BASE_+8&&e>=64&&e<=127};Si.prototype.isColorPAC=function(n){return n>=64&&n<=79||n>=96&&n<=127};Si.prototype.isNormalChar=function(n){return n>=32&&n<=127};Si.prototype.setRollUp=function(n,e){if(this.mode_!=="rollUp"&&(this.row_=PT,this.mode_="rollUp",this.flushDisplayed(n),this.nonDisplayed_=jf(),this.displayed_=jf()),e!==void 0&&e!==this.row_)for(var t=0;t<this.rollUpRows_;t++)this.displayed_[e-t]=this.displayed_[this.row_-t],this.displayed_[this.row_-t]="";e===void 0&&(e=this.row_),this.topRow_=e-this.rollUpRows_+1};Si.prototype.addFormatting=function(n,e){this.formatting_=this.formatting_.concat(e);var t=e.reduce(function(r,o){return r+"<"+o+">"},"");this[this.mode_](n,t)};Si.prototype.clearFormatting=function(n){if(this.formatting_.length){var e=this.formatting_.reverse().reduce(function(t,r){return t+"</"+r+">"},"");this.formatting_=[],this[this.mode_](n,e)}};Si.prototype.popOn=function(n,e){var t=this.nonDisplayed_[this.row_];t+=e,this.nonDisplayed_[this.row_]=t};Si.prototype.rollUp=function(n,e){var t=this.displayed_[this.row_];t+=e,this.displayed_[this.row_]=t};Si.prototype.shiftRowsUp_=function(){var n;for(n=0;n<this.topRow_;n++)this.displayed_[n]="";for(n=this.row_+1;n<PT+1;n++)this.displayed_[n]="";for(n=this.topRow_;n<this.row_;n++)this.displayed_[n]=this.displayed_[n+1];this.displayed_[this.row_]=""};Si.prototype.paintOn=function(n,e){var t=this.displayed_[this.row_];t+=e,this.displayed_[this.row_]=t};var N8={CaptionStream:Ya,Cea608Stream:Si,Cea708Stream:ei},LT={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},nJ=za,rJ=8589934592,iJ=4294967296,IU="shared",eb=function(e,t){var r=1;for(e>t&&(r=-1);Math.abs(t-e)>iJ;)e+=r*rJ;return e},F8=function n(e){var t,r;n.prototype.init.call(this),this.type_=e||IU,this.push=function(o){this.type_!==IU&&o.type!==this.type_||(r===void 0&&(r=o.dts),o.dts=eb(o.dts,r),o.pts=eb(o.pts,r),t=o.dts,this.trigger("data",o))},this.flush=function(){r=t,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){r=void 0,t=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};F8.prototype=new nJ;var k8={TimestampRolloverStream:F8,handleRollover:eb},sJ=za,aJ=LT,uc=A8,g_;g_=function(e){var t={descriptor:e&&e.descriptor},r=0,o=[],u=0,h;if(g_.prototype.init.call(this),this.dispatchType=aJ.METADATA_STREAM_TYPE.toString(16),t.descriptor)for(h=0;h<t.descriptor.length;h++)this.dispatchType+=("00"+t.descriptor[h].toString(16)).slice(-2);this.push=function(f){var d,m,g,v,_,S;if(f.type==="timed-metadata"){if(f.dataAlignmentIndicator&&(u=0,o.length=0),o.length===0&&(f.data.length<10||f.data[0]!=="I".charCodeAt(0)||f.data[1]!=="D".charCodeAt(0)||f.data[2]!=="3".charCodeAt(0))){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}if(o.push(f),u+=f.data.byteLength,o.length===1&&(r=uc.parseSyncSafeInteger(f.data.subarray(6,10)),r+=10),!(u<r)){for(d={data:new Uint8Array(r),frames:[],pts:o[0].pts,dts:o[0].dts},_=0;_<r;)d.data.set(o[0].data.subarray(0,r-_),_),_+=o[0].data.byteLength,u-=o[0].data.byteLength,o.shift();m=10,d.data[5]&64&&(m+=4,m+=uc.parseSyncSafeInteger(d.data.subarray(10,14)),r-=uc.parseSyncSafeInteger(d.data.subarray(16,20)));do{if(g=uc.parseSyncSafeInteger(d.data.subarray(m+4,m+8)),g<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if(S=String.fromCharCode(d.data[m],d.data[m+1],d.data[m+2],d.data[m+3]),v={id:S,data:d.data.subarray(m+10,m+g+10)},v.key=v.id,uc.frameParsers[v.id]?uc.frameParsers[v.id](v):v.id[0]==="T"?uc.frameParsers["T*"](v):v.id[0]==="W"&&uc.frameParsers["W*"](v),v.owner==="com.apple.streaming.transportStreamTimestamp"){var E=v.data,T=(E[3]&1)<<30|E[4]<<22|E[5]<<14|E[6]<<6|E[7]>>>2;T*=4,T+=E[7]&3,v.timeStamp=T,d.pts===void 0&&d.dts===void 0&&(d.pts=v.timeStamp,d.dts=v.timeStamp),this.trigger("timestamp",v)}d.frames.push(v),m+=10,m+=g}while(m<r);this.trigger("data",d)}}}};g_.prototype=new sJ;var oJ=g_,oP=za,WC=N8,Wo=LT,lJ=k8.TimestampRolloverStream,m_,zm,v_,lh=188,HC=71;m_=function(){var e=new Uint8Array(lh),t=0;m_.prototype.init.call(this),this.push=function(r){var o=0,u=lh,h;for(t?(h=new Uint8Array(r.byteLength+t),h.set(e.subarray(0,t)),h.set(r,t),t=0):h=r;u<h.byteLength;){if(h[o]===HC&&h[u]===HC){this.trigger("data",h.subarray(o,u)),o+=lh,u+=lh;continue}o++,u++}o<h.byteLength&&(e.set(h.subarray(o),0),t=h.byteLength-o)},this.flush=function(){t===lh&&e[0]===HC&&(this.trigger("data",e),t=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){t=0,this.trigger("reset")}};m_.prototype=new oP;zm=function(){var e,t,r,o;zm.prototype.init.call(this),o=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,e=function(h,f){var d=0;f.payloadUnitStartIndicator&&(d+=h[d]+1),f.type==="pat"?t(h.subarray(d),f):r(h.subarray(d),f)},t=function(h,f){f.section_number=h[7],f.last_section_number=h[8],o.pmtPid=(h[10]&31)<<8|h[11],f.pmtPid=o.pmtPid},r=function(h,f){var d,m,g,v;if(h[5]&1){for(o.programMapTable={video:null,audio:null,"timed-metadata":{}},d=(h[1]&15)<<8|h[2],m=3+d-4,g=(h[10]&15)<<8|h[11],v=12+g;v<m;){var _=h[v],S=(h[v+1]&31)<<8|h[v+2];_===Wo.H264_STREAM_TYPE&&o.programMapTable.video===null?o.programMapTable.video=S:_===Wo.ADTS_STREAM_TYPE&&o.programMapTable.audio===null?o.programMapTable.audio=S:_===Wo.METADATA_STREAM_TYPE&&(o.programMapTable["timed-metadata"][S]=_),v+=((h[v+3]&15)<<8|h[v+4])+5}f.programMapTable=o.programMapTable}},this.push=function(u){var h={},f=4;if(h.payloadUnitStartIndicator=!!(u[1]&64),h.pid=u[1]&31,h.pid<<=8,h.pid|=u[2],(u[3]&48)>>>4>1&&(f+=u[f]+1),h.pid===0)h.type="pat",e(u.subarray(f),h),this.trigger("data",h);else if(h.pid===this.pmtPid)for(h.type="pmt",e(u.subarray(f),h),this.trigger("data",h);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([u,f,h]):this.processPes_(u,f,h)},this.processPes_=function(u,h,f){f.pid===this.programMapTable.video?f.streamType=Wo.H264_STREAM_TYPE:f.pid===this.programMapTable.audio?f.streamType=Wo.ADTS_STREAM_TYPE:f.streamType=this.programMapTable["timed-metadata"][f.pid],f.type="pes",f.data=u.subarray(h),this.trigger("data",f)}};zm.prototype=new oP;zm.STREAM_TYPES={h264:27,adts:15};v_=function(){var e=this,t=!1,r={data:[],size:0},o={data:[],size:0},u={data:[],size:0},h,f=function(g,v){var _,S=g[0]<<16|g[1]<<8|g[2];v.data=new Uint8Array,S===1&&(v.packetLength=6+(g[4]<<8|g[5]),v.dataAlignmentIndicator=(g[6]&4)!==0,_=g[7],_&192&&(v.pts=(g[9]&14)<<27|(g[10]&255)<<20|(g[11]&254)<<12|(g[12]&255)<<5|(g[13]&254)>>>3,v.pts*=4,v.pts+=(g[13]&6)>>>1,v.dts=v.pts,_&64&&(v.dts=(g[14]&14)<<27|(g[15]&255)<<20|(g[16]&254)<<12|(g[17]&255)<<5|(g[18]&254)>>>3,v.dts*=4,v.dts+=(g[18]&6)>>>1)),v.data=g.subarray(9+g[8]))},d=function(g,v,_){var S=new Uint8Array(g.size),E={type:v},T=0,C=0,R=!1,b;if(!(!g.data.length||g.size<9)){for(E.trackId=g.data[0].pid,T=0;T<g.data.length;T++)b=g.data[T],S.set(b.data,C),C+=b.data.byteLength;f(S,E),R=v==="video"||E.packetLength<=g.size,(_||R)&&(g.size=0,g.data.length=0),R&&e.trigger("data",E)}};v_.prototype.init.call(this),this.push=function(m){({pat:function(){},pes:function(){var v,_;switch(m.streamType){case Wo.H264_STREAM_TYPE:v=r,_="video";break;case Wo.ADTS_STREAM_TYPE:v=o,_="audio";break;case Wo.METADATA_STREAM_TYPE:v=u,_="timed-metadata";break;default:return}m.payloadUnitStartIndicator&&d(v,_,!0),v.data.push(m),v.size+=m.data.byteLength},pmt:function(){var v={type:"metadata",tracks:[]};h=m.programMapTable,h.video!==null&&v.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+h.video,codec:"avc",type:"video"}),h.audio!==null&&v.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+h.audio,codec:"adts",type:"audio"}),t=!0,e.trigger("data",v)}})[m.type]()},this.reset=function(){r.size=0,r.data.length=0,o.size=0,o.data.length=0,this.trigger("reset")},this.flushStreams_=function(){d(r,"video"),d(o,"audio"),d(u,"timed-metadata")},this.flush=function(){if(!t&&h){var m={type:"metadata",tracks:[]};h.video!==null&&m.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+h.video,codec:"avc",type:"video"}),h.audio!==null&&m.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+h.audio,codec:"adts",type:"audio"}),e.trigger("data",m)}t=!1,this.flushStreams_(),this.trigger("done")}};v_.prototype=new oP;var U8={PAT_PID:0,MP2T_PACKET_LENGTH:lh,TransportPacketStream:m_,TransportParseStream:zm,ElementaryStream:v_,TimestampRolloverStream:lJ,CaptionStream:WC.CaptionStream,Cea608Stream:WC.Cea608Stream,Cea708Stream:WC.Cea708Stream,MetadataStream:oJ};for(var VC in Wo)Wo.hasOwnProperty(VC)&&(U8[VC]=Wo[VC]);var MT=U8,uJ=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],B8=function(e,t){var r=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9],o=e[t+5],u=(o&16)>>4;return r=r>=0?r:0,u?r+20:r+10},cJ=function n(e,t){return e.length-t<10||e[t]!=="I".charCodeAt(0)||e[t+1]!=="D".charCodeAt(0)||e[t+2]!=="3".charCodeAt(0)?t:(t+=B8(e,t),n(e,t))},fJ=function(e){var t=cJ(e,0);return e.length>=t+2&&(e[t]&255)===255&&(e[t+1]&240)===240&&(e[t+1]&22)===16},RU=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},dJ=function(e,t,r){var o,u="";for(o=t;o<r;o++)u+="%"+("00"+e[o].toString(16)).slice(-2);return u},hJ=function(e,t,r){return unescape(dJ(e,t,r))},pJ=function(e,t){var r=(e[t+5]&224)>>5,o=e[t+4]<<3,u=e[t+3]&3<<11;return u|o|r},gJ=function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":e[t]&!0&&(e[t+1]&240)===240?"audio":null},mJ=function(e){for(var t=0;t+5<e.length;){if(e[t]!==255||(e[t+1]&246)!==240){t++;continue}return uJ[(e[t+2]&60)>>>2]}return null},vJ=function(e){var t,r,o,u;t=10,e[5]&64&&(t+=4,t+=RU(e.subarray(10,14)));do{if(r=RU(e.subarray(t+4,t+8)),r<1)return null;if(u=String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3]),u==="PRIV"){o=e.subarray(t+10,t+r+10);for(var h=0;h<o.byteLength;h++)if(o[h]===0){var f=hJ(o,0,h);if(f==="com.apple.streaming.transportStreamTimestamp"){var d=o.subarray(h+1),m=(d[3]&1)<<30|d[4]<<22|d[5]<<14|d[6]<<6|d[7]>>>2;return m*=4,m+=d[7]&3,m}break}}t+=10,t+=r}while(t<e.byteLength);return null},wT={isLikelyAacData:fJ,parseId3TagSize:B8,parseAdtsSize:pJ,parseType:gJ,parseSampleRate:mJ,parseAacTimestamp:vJ},yJ=za,bU=wT,y_;y_=function(){var e=new Uint8Array,t=0;y_.prototype.init.call(this),this.setTimestamp=function(r){t=r},this.push=function(r){var o=0,u=0,h,f,d,m;for(e.length?(m=e.length,e=new Uint8Array(r.byteLength+m),e.set(e.subarray(0,m)),e.set(r,m)):e=r;e.length-u>=3;){if(e[u]==="I".charCodeAt(0)&&e[u+1]==="D".charCodeAt(0)&&e[u+2]==="3".charCodeAt(0)){if(e.length-u<10||(o=bU.parseId3TagSize(e,u),u+o>e.length))break;f={type:"timed-metadata",data:e.subarray(u,u+o)},this.trigger("data",f),u+=o;continue}else if((e[u]&255)===255&&(e[u+1]&240)===240){if(e.length-u<7||(o=bU.parseAdtsSize(e,u),u+o>e.length))break;d={type:"audio",data:e.subarray(u,u+o),pts:t,dts:t},this.trigger("data",d),u+=o;continue}u++}h=e.length-u,h>0?e=e.subarray(u):e=new Uint8Array},this.reset=function(){e=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){e=new Uint8Array,this.trigger("endedtimeline")}};y_.prototype=new yJ;var j8=y_,EJ=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],K8=EJ,_J=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],G8=_J,OT=za,Ym=IT,Og=L8,qy=M8,Ho=bT,gu=MT,wE=Wc,DU=CT,TJ=ZD.H264Stream,SJ=j8,AJ=wT.isLikelyAacData,xJ=Wc.ONE_SECOND_IN_TS,lP=K8,uP=G8,Xm,Xh,E_,Jf,CJ=function(e,t){t.stream=e,this.trigger("log",t)},PU=function(e,t){for(var r=Object.keys(t),o=0;o<r.length;o++){var u=r[o];u==="headOfPipeline"||!t[u].on||t[u].on("log",CJ.bind(e,u))}},LU=function(e,t){var r;if(e.length!==t.length)return!1;for(r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},cP=function(e,t,r,o,u,h){var f=r-t,d=o-t,m=u-r;return{start:{dts:e,pts:e+f},end:{dts:e+d,pts:e+m},prependedContentDuration:h,baseMediaDecodeTime:e}};Xh=function(e,t){var r=[],o,u=0,h=0,f=1/0;t=t||{},o=t.firstSequenceNumber||0,Xh.prototype.init.call(this),this.push=function(d){Ho.collectDtsInfo(e,d),e&&lP.forEach(function(m){e[m]=d[m]}),r.push(d)},this.setEarliestDts=function(d){u=d},this.setVideoBaseMediaDecodeTime=function(d){f=d},this.setAudioAppendStart=function(d){h=d},this.flush=function(){var d,m,g,v,_,S,E;if(r.length===0){this.trigger("done","AudioSegmentStream");return}d=qy.trimAdtsFramesByEarliestDts(r,e,u),e.baseMediaDecodeTime=Ho.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps),E=qy.prefixWithSilence(e,d,h,f),e.samples=qy.generateSampleTable(d),g=Ym.mdat(qy.concatenateFrameData(d)),r=[],m=Ym.moof(o,[e]),v=new Uint8Array(m.byteLength+g.byteLength),o++,v.set(m),v.set(g,m.byteLength),Ho.clearDtsInfo(e),_=Math.ceil(xJ*1024/e.samplerate),d.length&&(S=d.length*_,this.trigger("segmentTimingInfo",cP(wE.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate),d[0].dts,d[0].pts,d[0].dts+S,d[0].pts+S,E||0)),this.trigger("timingInfo",{start:d[0].pts,end:d[0].pts+S})),this.trigger("data",{track:e,boxes:v}),this.trigger("done","AudioSegmentStream")},this.reset=function(){Ho.clearDtsInfo(e),r=[],this.trigger("reset")}};Xh.prototype=new OT;Xm=function(e,t){var r,o=[],u=[],h,f;t=t||{},r=t.firstSequenceNumber||0,Xm.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(d){Ho.collectDtsInfo(e,d),d.nalUnitType==="seq_parameter_set_rbsp"&&!h&&(h=d.config,e.sps=[d.data],uP.forEach(function(m){e[m]=h[m]},this)),d.nalUnitType==="pic_parameter_set_rbsp"&&!f&&(f=d.data,e.pps=[d.data]),o.push(d)},this.flush=function(){for(var d,m,g,v,_,S,E=0,T,C;o.length&&o[0].nalUnitType!=="access_unit_delimiter_rbsp";)o.shift();if(o.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(d=Og.groupNalsIntoFrames(o),g=Og.groupFramesIntoGops(d),g[0][0].keyFrame||(m=this.getGopForFusion_(o[0],e),m?(E=m.duration,g.unshift(m),g.byteLength+=m.byteLength,g.nalCount+=m.nalCount,g.pts=m.pts,g.dts=m.dts,g.duration+=m.duration):g=Og.extendFirstKeyFrame(g)),u.length){var R;if(t.alignGopsAtEnd?R=this.alignGopsAtEnd_(g):R=this.alignGopsAtStart_(g),!R){this.gopCache_.unshift({gop:g.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),o=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}Ho.clearDtsInfo(e),g=R}Ho.collectDtsInfo(e,g),e.samples=Og.generateSampleTable(g),_=Ym.mdat(Og.concatenateNalData(g)),e.baseMediaDecodeTime=Ho.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps),this.trigger("processedGopsInfo",g.map(function(b){return{pts:b.pts,dts:b.dts,byteLength:b.byteLength}})),T=g[0],C=g[g.length-1],this.trigger("segmentTimingInfo",cP(e.baseMediaDecodeTime,T.dts,T.pts,C.dts+C.duration,C.pts+C.duration,E)),this.trigger("timingInfo",{start:g[0].pts,end:g[g.length-1].pts+g[g.length-1].duration}),this.gopCache_.unshift({gop:g.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),o=[],this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),v=Ym.moof(r,[e]),S=new Uint8Array(v.byteLength+_.byteLength),r++,S.set(v),S.set(_,v.byteLength),this.trigger("data",{track:e,boxes:S}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),o=[],this.gopCache_.length=0,u.length=0,this.trigger("reset")},this.resetStream_=function(){Ho.clearDtsInfo(e),h=void 0,f=void 0},this.getGopForFusion_=function(d){var m=45e3,g=1e4,v=1/0,_,S,E,T,C;for(C=0;C<this.gopCache_.length;C++)T=this.gopCache_[C],E=T.gop,!(!(e.pps&&LU(e.pps[0],T.pps[0]))||!(e.sps&&LU(e.sps[0],T.sps[0])))&&(E.dts<e.timelineStartInfo.dts||(_=d.dts-E.dts-E.duration,_>=-g&&_<=m&&(!S||v>_)&&(S=T,v=_)));return S?S.gop:null},this.alignGopsAtStart_=function(d){var m,g,v,_,S,E,T,C;for(S=d.byteLength,E=d.nalCount,T=d.duration,m=g=0;m<u.length&&g<d.length&&(v=u[m],_=d[g],v.pts!==_.pts);){if(_.pts>v.pts){m++;continue}g++,S-=_.byteLength,E-=_.nalCount,T-=_.duration}return g===0?d:g===d.length?null:(C=d.slice(g),C.byteLength=S,C.duration=T,C.nalCount=E,C.pts=C[0].pts,C.dts=C[0].dts,C)},this.alignGopsAtEnd_=function(d){var m,g,v,_,S,E;for(m=u.length-1,g=d.length-1,S=null,E=!1;m>=0&&g>=0;){if(v=u[m],_=d[g],v.pts===_.pts){E=!0;break}if(v.pts>_.pts){m--;continue}m===u.length-1&&(S=g),g--}if(!E&&S===null)return null;var T;if(E?T=g:T=S,T===0)return d;var C=d.slice(T),R=C.reduce(function(b,F){return b.byteLength+=F.byteLength,b.duration+=F.duration,b.nalCount+=F.nalCount,b},{byteLength:0,duration:0,nalCount:0});return C.byteLength=R.byteLength,C.duration=R.duration,C.nalCount=R.nalCount,C.pts=C[0].pts,C.dts=C[0].dts,C},this.alignGopsWith=function(d){u=d}};Xm.prototype=new OT;Jf=function(e,t){this.numberOfTracks=0,this.metadataStream=t,e=e||{},typeof e.remux<"u"?this.remuxTracks=!!e.remux:this.remuxTracks=!0,typeof e.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=e.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Jf.prototype.init.call(this),this.push=function(r){if(r.text)return this.pendingCaptions.push(r);if(r.frames)return this.pendingMetadata.push(r);this.pendingTracks.push(r.track),this.pendingBytes+=r.boxes.byteLength,r.track.type==="video"&&(this.videoTrack=r.track,this.pendingBoxes.push(r.boxes)),r.track.type==="audio"&&(this.audioTrack=r.track,this.pendingBoxes.unshift(r.boxes))}};Jf.prototype=new OT;Jf.prototype.flush=function(n){var e=0,t={captions:[],captionStreams:{},metadata:[],info:{}},r,o,u,h=0,f;if(this.pendingTracks.length<this.numberOfTracks){if(n!=="VideoSegmentStream"&&n!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?(h=this.videoTrack.timelineStartInfo.pts,uP.forEach(function(d){t.info[d]=this.videoTrack[d]},this)):this.audioTrack&&(h=this.audioTrack.timelineStartInfo.pts,lP.forEach(function(d){t.info[d]=this.audioTrack[d]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?t.type=this.pendingTracks[0].type:t.type="combined",this.emittedTracks+=this.pendingTracks.length,u=Ym.initSegment(this.pendingTracks),t.initSegment=new Uint8Array(u.byteLength),t.initSegment.set(u),t.data=new Uint8Array(this.pendingBytes),f=0;f<this.pendingBoxes.length;f++)t.data.set(this.pendingBoxes[f],e),e+=this.pendingBoxes[f].byteLength;for(f=0;f<this.pendingCaptions.length;f++)r=this.pendingCaptions[f],r.startTime=wE.metadataTsToSeconds(r.startPts,h,this.keepOriginalTimestamps),r.endTime=wE.metadataTsToSeconds(r.endPts,h,this.keepOriginalTimestamps),t.captionStreams[r.stream]=!0,t.captions.push(r);for(f=0;f<this.pendingMetadata.length;f++)o=this.pendingMetadata[f],o.cueTime=wE.metadataTsToSeconds(o.pts,h,this.keepOriginalTimestamps),t.metadata.push(o);for(t.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",t),f=0;f<t.captions.length;f++)r=t.captions[f],this.trigger("caption",r);for(f=0;f<t.metadata.length;f++)o=t.metadata[f],this.trigger("id3Frame",o)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)};Jf.prototype.setRemux=function(n){this.remuxTracks=n};E_=function(e){var t=this,r=!0,o,u;E_.prototype.init.call(this),e=e||{},this.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var h={};this.transmuxPipeline_=h,h.type="aac",h.metadataStream=new gu.MetadataStream,h.aacStream=new SJ,h.audioTimestampRolloverStream=new gu.TimestampRolloverStream("audio"),h.timedMetadataTimestampRolloverStream=new gu.TimestampRolloverStream("timed-metadata"),h.adtsStream=new DU,h.coalesceStream=new Jf(e,h.metadataStream),h.headOfPipeline=h.aacStream,h.aacStream.pipe(h.audioTimestampRolloverStream).pipe(h.adtsStream),h.aacStream.pipe(h.timedMetadataTimestampRolloverStream).pipe(h.metadataStream).pipe(h.coalesceStream),h.metadataStream.on("timestamp",function(f){h.aacStream.setTimestamp(f.timeStamp)}),h.aacStream.on("data",function(f){f.type!=="timed-metadata"&&f.type!=="audio"||h.audioSegmentStream||(u=u||{timelineStartInfo:{baseMediaDecodeTime:t.baseMediaDecodeTime},codec:"adts",type:"audio"},h.coalesceStream.numberOfTracks++,h.audioSegmentStream=new Xh(u,e),h.audioSegmentStream.on("log",t.getLogTrigger_("audioSegmentStream")),h.audioSegmentStream.on("timingInfo",t.trigger.bind(t,"audioTimingInfo")),h.adtsStream.pipe(h.audioSegmentStream).pipe(h.coalesceStream),t.trigger("trackinfo",{hasAudio:!!u,hasVideo:!!o}))}),h.coalesceStream.on("data",this.trigger.bind(this,"data")),h.coalesceStream.on("done",this.trigger.bind(this,"done")),PU(this,h)},this.setupTsPipeline=function(){var h={};this.transmuxPipeline_=h,h.type="ts",h.metadataStream=new gu.MetadataStream,h.packetStream=new gu.TransportPacketStream,h.parseStream=new gu.TransportParseStream,h.elementaryStream=new gu.ElementaryStream,h.timestampRolloverStream=new gu.TimestampRolloverStream,h.adtsStream=new DU,h.h264Stream=new TJ,h.captionStream=new gu.CaptionStream(e),h.coalesceStream=new Jf(e,h.metadataStream),h.headOfPipeline=h.packetStream,h.packetStream.pipe(h.parseStream).pipe(h.elementaryStream).pipe(h.timestampRolloverStream),h.timestampRolloverStream.pipe(h.h264Stream),h.timestampRolloverStream.pipe(h.adtsStream),h.timestampRolloverStream.pipe(h.metadataStream).pipe(h.coalesceStream),h.h264Stream.pipe(h.captionStream).pipe(h.coalesceStream),h.elementaryStream.on("data",function(f){var d;if(f.type==="metadata"){for(d=f.tracks.length;d--;)!o&&f.tracks[d].type==="video"?(o=f.tracks[d],o.timelineStartInfo.baseMediaDecodeTime=t.baseMediaDecodeTime):!u&&f.tracks[d].type==="audio"&&(u=f.tracks[d],u.timelineStartInfo.baseMediaDecodeTime=t.baseMediaDecodeTime);o&&!h.videoSegmentStream&&(h.coalesceStream.numberOfTracks++,h.videoSegmentStream=new Xm(o,e),h.videoSegmentStream.on("log",t.getLogTrigger_("videoSegmentStream")),h.videoSegmentStream.on("timelineStartInfo",function(m){u&&!e.keepOriginalTimestamps&&(u.timelineStartInfo=m,h.audioSegmentStream.setEarliestDts(m.dts-t.baseMediaDecodeTime))}),h.videoSegmentStream.on("processedGopsInfo",t.trigger.bind(t,"gopInfo")),h.videoSegmentStream.on("segmentTimingInfo",t.trigger.bind(t,"videoSegmentTimingInfo")),h.videoSegmentStream.on("baseMediaDecodeTime",function(m){u&&h.audioSegmentStream.setVideoBaseMediaDecodeTime(m)}),h.videoSegmentStream.on("timingInfo",t.trigger.bind(t,"videoTimingInfo")),h.h264Stream.pipe(h.videoSegmentStream).pipe(h.coalesceStream)),u&&!h.audioSegmentStream&&(h.coalesceStream.numberOfTracks++,h.audioSegmentStream=new Xh(u,e),h.audioSegmentStream.on("log",t.getLogTrigger_("audioSegmentStream")),h.audioSegmentStream.on("timingInfo",t.trigger.bind(t,"audioTimingInfo")),h.audioSegmentStream.on("segmentTimingInfo",t.trigger.bind(t,"audioSegmentTimingInfo")),h.adtsStream.pipe(h.audioSegmentStream).pipe(h.coalesceStream)),t.trigger("trackinfo",{hasAudio:!!u,hasVideo:!!o})}}),h.coalesceStream.on("data",this.trigger.bind(this,"data")),h.coalesceStream.on("id3Frame",function(f){f.dispatchType=h.metadataStream.dispatchType,t.trigger("id3Frame",f)}),h.coalesceStream.on("caption",this.trigger.bind(this,"caption")),h.coalesceStream.on("done",this.trigger.bind(this,"done")),PU(this,h)},this.setBaseMediaDecodeTime=function(h){var f=this.transmuxPipeline_;e.keepOriginalTimestamps||(this.baseMediaDecodeTime=h),u&&(u.timelineStartInfo.dts=void 0,u.timelineStartInfo.pts=void 0,Ho.clearDtsInfo(u),f.audioTimestampRolloverStream&&f.audioTimestampRolloverStream.discontinuity()),o&&(f.videoSegmentStream&&(f.videoSegmentStream.gopCache_=[]),o.timelineStartInfo.dts=void 0,o.timelineStartInfo.pts=void 0,Ho.clearDtsInfo(o),f.captionStream.reset()),f.timestampRolloverStream&&f.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(h){u&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(h)},this.setRemux=function(h){var f=this.transmuxPipeline_;e.remux=h,f&&f.coalesceStream&&f.coalesceStream.setRemux(h)},this.alignGopsWith=function(h){o&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(h)},this.getLogTrigger_=function(h){var f=this;return function(d){d.stream=h,f.trigger("log",d)}},this.push=function(h){if(r){var f=AJ(h);f&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!f&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),r=!1}this.transmuxPipeline_.headOfPipeline.push(h)},this.flush=function(){r=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}};E_.prototype=new OT;var $C={Transmuxer:E_,VideoSegmentStream:Xm,AudioSegmentStream:Xh,AUDIO_PROPERTIES:lP,VIDEO_PROPERTIES:uP,generateSegmentTimingInfo:cP},IJ=O8.discardEmulationPreventionBytes,RJ=N8.CaptionStream,Ng=tP,bJ=iP,DJ=rP,PJ=nP,MU=rt,LJ=function(e,t){for(var r=e,o=0;o<t.length;o++){var u=t[o];if(r<u.size)return u;r-=u.size}return null},MJ=function(e,t,r){var o=new DataView(e.buffer,e.byteOffset,e.byteLength),u={logs:[],seiNals:[]},h,f,d,m;for(f=0;f+4<e.length;f+=d)if(d=o.getUint32(f),f+=4,!(d<=0))switch(e[f]&31){case 6:var g=e.subarray(f+1,f+1+d),v=LJ(f,t);if(h={nalUnitType:"sei_rbsp",size:d,data:g,escapedRBSP:IJ(g),trackId:r},v)h.pts=v.pts,h.dts=v.dts,m=v;else if(m)h.pts=m.pts,h.dts=m.dts;else{u.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+f+" for trackId "+r+". See mux.js#223."});break}u.seiNals.push(h);break}return u},wJ=function(e,t,r){var o=t,u=r.defaultSampleDuration||0,h=r.defaultSampleSize||0,f=r.trackId,d=[];return e.forEach(function(m){var g=DJ(m),v=g.samples;v.forEach(function(_){_.duration===void 0&&(_.duration=u),_.size===void 0&&(_.size=h),_.trackId=f,_.dts=o,_.compositionTimeOffset===void 0&&(_.compositionTimeOffset=0),typeof o=="bigint"?(_.pts=o+MU.BigInt(_.compositionTimeOffset),o+=MU.BigInt(_.duration)):(_.pts=o+_.compositionTimeOffset,o+=_.duration)}),d=d.concat(v)}),d},OJ=function(e,t){var r=Ng(e,["moof","traf"]),o=Ng(e,["mdat"]),u={},h=[];return o.forEach(function(f,d){var m=r[d];h.push({mdat:f,traf:m})}),h.forEach(function(f){var d=f.mdat,m=f.traf,g=Ng(m,["tfhd"]),v=PJ(g[0]),_=v.trackId,S=Ng(m,["tfdt"]),E=S.length>0?bJ(S[0]).baseMediaDecodeTime:0,T=Ng(m,["trun"]),C,R;t===_&&T.length>0&&(C=wJ(T,E,v),R=MJ(d,C,_),u[_]||(u[_]={seiNals:[],logs:[]}),u[_].seiNals=u[_].seiNals.concat(R.seiNals),u[_].logs=u[_].logs.concat(R.logs))}),u},NJ=function(e,t,r){var o;if(t===null)return null;o=OJ(e,t);var u=o[t]||{};return{seiNals:u.seiNals,logs:u.logs,timescale:r}},FJ=function(){var e=!1,t,r,o,u,h,f;this.isInitialized=function(){return e},this.init=function(d){t=new RJ,e=!0,f=d?d.isPartial:!1,t.on("data",function(m){m.startTime=m.startPts/u,m.endTime=m.endPts/u,h.captions.push(m),h.captionStreams[m.stream]=!0}),t.on("log",function(m){h.logs.push(m)})},this.isNewInit=function(d,m){return d&&d.length===0||m&&typeof m=="object"&&Object.keys(m).length===0?!1:o!==d[0]||u!==m[o]},this.parse=function(d,m,g){var v;if(this.isInitialized()){if(!m||!g)return null;if(this.isNewInit(m,g))o=m[0],u=g[o];else if(o===null||!u)return r.push(d),null}else return null;for(;r.length>0;){var _=r.shift();this.parse(_,m,g)}return v=NJ(d,o,u),v&&v.logs&&(h.logs=h.logs.concat(v.logs)),v===null||!v.seiNals?h.logs.length?{logs:h.logs,captions:[],captionStreams:[]}:null:(this.pushNals(v.seiNals),this.flushStream(),h)},this.pushNals=function(d){if(!this.isInitialized()||!d||d.length===0)return null;d.forEach(function(m){t.push(m)})},this.flushStream=function(){if(!this.isInitialized())return null;f?t.partialFlush():t.flush()},this.clearParsedCaptions=function(){h.captions=[],h.captionStreams={},h.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;t.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){r=[],o=null,u=null,h?this.clearParsedCaptions():h={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},kJ=FJ,UJ={generator:IT,probe:IQ,Transmuxer:$C.Transmuxer,AudioSegmentStream:$C.AudioSegmentStream,VideoSegmentStream:$C.VideoSegmentStream,CaptionParser:kJ},Mr;Mr=function(e,t){var r=0,o=16384,u=function(v,_){var S,E=v.position+_;E<v.bytes.byteLength||(S=new Uint8Array(E*2),S.set(v.bytes.subarray(0,v.position),0),v.bytes=S,v.view=new DataView(v.bytes.buffer))},h=Mr.widthBytes||new Uint8Array(5),f=Mr.heightBytes||new Uint8Array(6),d=Mr.videocodecidBytes||new Uint8Array(12),m;if(!Mr.widthBytes){for(m=0;m<5;m++)h[m]="width".charCodeAt(m);for(m=0;m<6;m++)f[m]="height".charCodeAt(m);for(m=0;m<12;m++)d[m]="videocodecid".charCodeAt(m);Mr.widthBytes=h,Mr.heightBytes=f,Mr.videocodecidBytes=d}switch(this.keyFrame=!1,e){case Mr.VIDEO_TAG:this.length=16,o*=6;break;case Mr.AUDIO_TAG:this.length=13,this.keyFrame=!0;break;case Mr.METADATA_TAG:this.length=29,this.keyFrame=!0;break;default:throw new Error("Unknown FLV tag type")}this.bytes=new Uint8Array(o),this.view=new DataView(this.bytes.buffer),this.bytes[0]=e,this.position=this.length,this.keyFrame=t,this.pts=0,this.dts=0,this.writeBytes=function(g,v,_){var S=v||0,E;_=_||g.byteLength,E=S+_,u(this,_),this.bytes.set(g.subarray(S,E),this.position),this.position+=_,this.length=Math.max(this.length,this.position)},this.writeByte=function(g){u(this,1),this.bytes[this.position]=g,this.position++,this.length=Math.max(this.length,this.position)},this.writeShort=function(g){u(this,2),this.view.setUint16(this.position,g),this.position+=2,this.length=Math.max(this.length,this.position)},this.negIndex=function(g){return this.bytes[this.length-g]},this.nalUnitSize=function(){return r===0?0:this.length-(r+4)},this.startNalUnit=function(){if(r>0)throw new Error("Attempted to create new NAL wihout closing the old one");r=this.length,this.length+=4,this.position=this.length},this.endNalUnit=function(g){var v,_;this.length===r+4?this.length-=4:r>0&&(v=r+4,_=this.length-v,this.position=r,this.view.setUint32(this.position,_),this.position=this.length,g&&g.push(this.bytes.subarray(v,v+_))),r=0},this.writeMetaDataDouble=function(g,v){var _;if(u(this,2+g.length+9),this.view.setUint16(this.position,g.length),this.position+=2,g==="width")this.bytes.set(h,this.position),this.position+=5;else if(g==="height")this.bytes.set(f,this.position),this.position+=6;else if(g==="videocodecid")this.bytes.set(d,this.position),this.position+=12;else for(_=0;_<g.length;_++)this.bytes[this.position]=g.charCodeAt(_),this.position++;this.position++,this.view.setFloat64(this.position,v),this.position+=8,this.length=Math.max(this.length,this.position),++r},this.writeMetaDataBoolean=function(g,v){var _;for(u(this,2),this.view.setUint16(this.position,g.length),this.position+=2,_=0;_<g.length;_++)u(this,1),this.bytes[this.position]=g.charCodeAt(_),this.position++;u(this,2),this.view.setUint8(this.position,1),this.position++,this.view.setUint8(this.position,v?1:0),this.position++,this.length=Math.max(this.length,this.position),++r},this.finalize=function(){var g,v;switch(this.bytes[0]){case Mr.VIDEO_TAG:this.bytes[11]=(this.keyFrame||t?16:32)|7,this.bytes[12]=t?0:1,g=this.pts-this.dts,this.bytes[13]=(g&16711680)>>>16,this.bytes[14]=(g&65280)>>>8,this.bytes[15]=(g&255)>>>0;break;case Mr.AUDIO_TAG:this.bytes[11]=175,this.bytes[12]=t?0:1;break;case Mr.METADATA_TAG:this.position=11,this.view.setUint8(this.position,2),this.position++,this.view.setUint16(this.position,10),this.position+=2,this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position),this.position+=10,this.bytes[this.position]=8,this.position++,this.view.setUint32(this.position,r),this.position=this.length,this.bytes.set([0,0,9],this.position),this.position+=3,this.length=this.position;break}return v=this.length-11,this.bytes[1]=(v&16711680)>>>16,this.bytes[2]=(v&65280)>>>8,this.bytes[3]=(v&255)>>>0,this.bytes[4]=(this.dts&16711680)>>>16,this.bytes[5]=(this.dts&65280)>>>8,this.bytes[6]=(this.dts&255)>>>0,this.bytes[7]=(this.dts&4278190080)>>>24,this.bytes[8]=0,this.bytes[9]=0,this.bytes[10]=0,u(this,4),this.view.setUint32(this.length,this.length),this.length+=4,this.position+=4,this.bytes=this.bytes.subarray(0,this.length),this.frameTime=Mr.frameTime(this.bytes),this}};Mr.AUDIO_TAG=8;Mr.VIDEO_TAG=9;Mr.METADATA_TAG=18;Mr.isAudioFrame=function(n){return Mr.AUDIO_TAG===n[0]};Mr.isVideoFrame=function(n){return Mr.VIDEO_TAG===n[0]};Mr.isMetaData=function(n){return Mr.METADATA_TAG===n[0]};Mr.isKeyFrame=function(n){return Mr.isVideoFrame(n)?n[11]===23:!!(Mr.isAudioFrame(n)||Mr.isMetaData(n))};Mr.frameTime=function(n){var e=n[4]<<16;return e|=n[5]<<8,e|=n[6]<<0,e|=n[7]<<24,e};var fP=Mr,BJ=za,dP=function n(e){this.numberOfTracks=0,this.metadataStream=e.metadataStream,this.videoTags=[],this.audioTags=[],this.videoTrack=null,this.audioTrack=null,this.pendingCaptions=[],this.pendingMetadata=[],this.pendingTracks=0,this.processedTracks=0,n.prototype.init.call(this),this.push=function(t){if(t.text)return this.pendingCaptions.push(t);if(t.frames)return this.pendingMetadata.push(t);t.track.type==="video"&&(this.videoTrack=t.track,this.videoTags=t.tags,this.pendingTracks++),t.track.type==="audio"&&(this.audioTrack=t.track,this.audioTags=t.tags,this.pendingTracks++)}};dP.prototype=new BJ;dP.prototype.flush=function(n){var e,t,r,o,u={tags:{},captions:[],captionStreams:{},metadata:[]};if(this.pendingTracks<this.numberOfTracks){if(n!=="VideoSegmentStream"&&n!=="AudioSegmentStream")return;if(this.pendingTracks===0&&(this.processedTracks++,this.processedTracks<this.numberOfTracks))return}if(this.processedTracks+=this.pendingTracks,this.pendingTracks=0,!(this.processedTracks<this.numberOfTracks)){for(this.videoTrack?o=this.videoTrack.timelineStartInfo.pts:this.audioTrack&&(o=this.audioTrack.timelineStartInfo.pts),u.tags.videoTags=this.videoTags,u.tags.audioTags=this.audioTags,r=0;r<this.pendingCaptions.length;r++)t=this.pendingCaptions[r],t.startTime=t.startPts-o,t.startTime/=9e4,t.endTime=t.endPts-o,t.endTime/=9e4,u.captionStreams[t.stream]=!0,u.captions.push(t);for(r=0;r<this.pendingMetadata.length;r++)e=this.pendingMetadata[r],e.cueTime=e.pts-o,e.cueTime/=9e4,u.metadata.push(e);u.metadata.dispatchType=this.metadataStream.dispatchType,this.videoTrack=null,this.audioTrack=null,this.videoTags=[],this.audioTags=[],this.pendingCaptions.length=0,this.pendingMetadata.length=0,this.pendingTracks=0,this.processedTracks=0,this.trigger("data",u),this.trigger("done")}};var jJ=dP,KJ=function(){var e=this;this.list=[],this.push=function(t){this.list.push({bytes:t.bytes,dts:t.dts,pts:t.pts,keyFrame:t.keyFrame,metaDataTag:t.metaDataTag})},Object.defineProperty(this,"length",{get:function(){return e.list.length}})},GJ=KJ,hP=za,oo=fP,cc=MT,WJ=CT,HJ=ZD.H264Stream,VJ=jJ,W8=GJ,__,T_,S_,pP,H8,V8;pP=function(e,t){typeof t.pts=="number"&&(e.timelineStartInfo.pts===void 0?e.timelineStartInfo.pts=t.pts:e.timelineStartInfo.pts=Math.min(e.timelineStartInfo.pts,t.pts)),typeof t.dts=="number"&&(e.timelineStartInfo.dts===void 0?e.timelineStartInfo.dts=t.dts:e.timelineStartInfo.dts=Math.min(e.timelineStartInfo.dts,t.dts))};H8=function(e,t){var r=new oo(oo.METADATA_TAG);return r.dts=t,r.pts=t,r.writeMetaDataDouble("videocodecid",7),r.writeMetaDataDouble("width",e.width),r.writeMetaDataDouble("height",e.height),r};V8=function(e,t){var r,o=new oo(oo.VIDEO_TAG,!0);for(o.dts=t,o.pts=t,o.writeByte(1),o.writeByte(e.profileIdc),o.writeByte(e.profileCompatibility),o.writeByte(e.levelIdc),o.writeByte(255),o.writeByte(225),o.writeShort(e.sps[0].length),o.writeBytes(e.sps[0]),o.writeByte(e.pps.length),r=0;r<e.pps.length;++r)o.writeShort(e.pps[r].length),o.writeBytes(e.pps[r]);return o};S_=function(e){var t=[],r=[],o;S_.prototype.init.call(this),this.push=function(u){pP(e,u),e&&(e.audioobjecttype=u.audioobjecttype,e.channelcount=u.channelcount,e.samplerate=u.samplerate,e.samplingfrequencyindex=u.samplingfrequencyindex,e.samplesize=u.samplesize,e.extraData=e.audioobjecttype<<11|e.samplingfrequencyindex<<7|e.channelcount<<3),u.pts=Math.round(u.pts/90),u.dts=Math.round(u.dts/90),t.push(u)},this.flush=function(){var u,h,f,d=new W8;if(t.length===0){this.trigger("done","AudioSegmentStream");return}for(f=-1/0;t.length;)u=t.shift(),r.length&&u.pts>=r[0]&&(f=r.shift(),this.writeMetaDataTags(d,f)),(e.extraData!==o||u.pts-f>=1e3)&&(this.writeMetaDataTags(d,u.pts),o=e.extraData,f=u.pts),h=new oo(oo.AUDIO_TAG),h.pts=u.pts,h.dts=u.dts,h.writeBytes(u.data),d.push(h.finalize());r.length=0,o=null,this.trigger("data",{track:e,tags:d.list}),this.trigger("done","AudioSegmentStream")},this.writeMetaDataTags=function(u,h){var f;f=new oo(oo.METADATA_TAG),f.pts=h,f.dts=h,f.writeMetaDataDouble("audiocodecid",10),f.writeMetaDataBoolean("stereo",e.channelcount===2),f.writeMetaDataDouble("audiosamplerate",e.samplerate),f.writeMetaDataDouble("audiosamplesize",16),u.push(f.finalize()),f=new oo(oo.AUDIO_TAG,!0),f.pts=h,f.dts=h,f.view.setUint16(f.position,e.extraData),f.position+=2,f.length=Math.max(f.length,f.position),u.push(f.finalize())},this.onVideoKeyFrame=function(u){r.push(u)}};S_.prototype=new hP;T_=function(e){var t=[],r,o;T_.prototype.init.call(this),this.finishFrame=function(u,h){if(h){if(r&&e&&e.newMetadata&&(h.keyFrame||u.length===0)){var f=H8(r,h.dts).finalize(),d=V8(e,h.dts).finalize();f.metaDataTag=d.metaDataTag=!0,u.push(f),u.push(d),e.newMetadata=!1,this.trigger("keyframe",h.dts)}h.endNalUnit(),u.push(h.finalize()),o=null}},this.push=function(u){pP(e,u),u.pts=Math.round(u.pts/90),u.dts=Math.round(u.dts/90),t.push(u)},this.flush=function(){for(var u,h=new W8;t.length&&t[0].nalUnitType!=="access_unit_delimiter_rbsp";)t.shift();if(t.length===0){this.trigger("done","VideoSegmentStream");return}for(;t.length;)u=t.shift(),u.nalUnitType==="seq_parameter_set_rbsp"?(e.newMetadata=!0,r=u.config,e.width=r.width,e.height=r.height,e.sps=[u.data],e.profileIdc=r.profileIdc,e.levelIdc=r.levelIdc,e.profileCompatibility=r.profileCompatibility,o.endNalUnit()):u.nalUnitType==="pic_parameter_set_rbsp"?(e.newMetadata=!0,e.pps=[u.data],o.endNalUnit()):u.nalUnitType==="access_unit_delimiter_rbsp"?(o&&this.finishFrame(h,o),o=new oo(oo.VIDEO_TAG),o.pts=u.pts,o.dts=u.dts):(u.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(o.keyFrame=!0),o.endNalUnit()),o.startNalUnit(),o.writeBytes(u.data);o&&this.finishFrame(h,o),this.trigger("data",{track:e,tags:h.list}),this.trigger("done","VideoSegmentStream")}};T_.prototype=new hP;__=function(e){var t=this,r,o,u,h,f,d,m,g,v,_,S,E;__.prototype.init.call(this),e=e||{},this.metadataStream=new cc.MetadataStream,e.metadataStream=this.metadataStream,r=new cc.TransportPacketStream,o=new cc.TransportParseStream,u=new cc.ElementaryStream,h=new cc.TimestampRolloverStream("video"),f=new cc.TimestampRolloverStream("audio"),d=new cc.TimestampRolloverStream("timed-metadata"),m=new WJ,g=new HJ,E=new VJ(e),r.pipe(o).pipe(u),u.pipe(h).pipe(g),u.pipe(f).pipe(m),u.pipe(d).pipe(this.metadataStream).pipe(E),S=new cc.CaptionStream(e),g.pipe(S).pipe(E),u.on("data",function(T){var C,R,b;if(T.type==="metadata"){for(C=T.tracks.length;C--;)T.tracks[C].type==="video"?R=T.tracks[C]:T.tracks[C].type==="audio"&&(b=T.tracks[C]);R&&!v&&(E.numberOfTracks++,v=new T_(R),g.pipe(v).pipe(E)),b&&!_&&(E.numberOfTracks++,_=new S_(b),m.pipe(_).pipe(E),v&&v.on("keyframe",_.onVideoKeyFrame))}}),this.push=function(T){r.push(T)},this.flush=function(){r.flush()},this.resetCaptions=function(){S.reset()},E.on("data",function(T){t.trigger("data",T)}),E.on("done",function(){t.trigger("done")})};__.prototype=new hP;var $J=__,wU=fP,zJ=function(e,t,r){var o=new Uint8Array(9),u=new DataView(o.buffer),h,f,d;return e=e||0,t=t===void 0?!0:t,r=r===void 0?!0:r,u.setUint8(0,70),u.setUint8(1,76),u.setUint8(2,86),u.setUint8(3,1),u.setUint8(4,(t?4:0)|(r?1:0)),u.setUint32(5,o.byteLength),e<=0?(f=new Uint8Array(o.byteLength+4),f.set(o),f.set([0,0,0,0],o.byteLength),f):(h=new wU(wU.METADATA_TAG),h.pts=h.dts=0,h.writeMetaDataDouble("duration",e),d=h.finalize().length,f=new Uint8Array(o.byteLength+d),f.set(o),f.set(u.byteLength,d),f)},YJ=zJ,XJ={tag:fP,Transmuxer:$J,getFlvHeader:YJ},tb={},qJ={get exports(){return tb},set exports(n){tb=n}};(function(n){n.exports=MT})(qJ);var QJ=za,zC=IT,Qy=M8,Jy=bT,JJ=Wc.ONE_SECOND_IN_TS,ZJ=K8,$8=function n(e,t){var r=[],o=0,u=0,h=0,f=1/0,d=null,m=null;t=t||{},n.prototype.init.call(this),this.push=function(g){Jy.collectDtsInfo(e,g),e&&ZJ.forEach(function(v){e[v]=g[v]}),r.push(g)},this.setEarliestDts=function(g){u=g},this.setVideoBaseMediaDecodeTime=function(g){f=g},this.setAudioAppendStart=function(g){h=g},this.processFrames_=function(){var g,v,_,S,E;r.length!==0&&(g=Qy.trimAdtsFramesByEarliestDts(r,e,u),g.length!==0&&(e.baseMediaDecodeTime=Jy.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps),Qy.prefixWithSilence(e,g,h,f),e.samples=Qy.generateSampleTable(g),_=zC.mdat(Qy.concatenateFrameData(g)),r=[],v=zC.moof(o,[e]),o++,e.initSegment=zC.initSegment([e]),S=new Uint8Array(v.byteLength+_.byteLength),S.set(v),S.set(_,v.byteLength),Jy.clearDtsInfo(e),d===null&&(m=d=g[0].pts),m+=g.length*(JJ*1024/e.samplerate),E={start:d},this.trigger("timingInfo",E),this.trigger("data",{track:e,boxes:S})))},this.flush=function(){this.processFrames_(),this.trigger("timingInfo",{start:d,end:m}),this.resetTiming_(),this.trigger("done","AudioSegmentStream")},this.partialFlush=function(){this.processFrames_(),this.trigger("partialdone","AudioSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","AudioSegmentStream")},this.resetTiming_=function(){Jy.clearDtsInfo(e),d=null,m=null},this.reset=function(){this.resetTiming_(),r=[],this.trigger("reset")}};$8.prototype=new QJ;var eZ=$8,tZ=za,YC=IT,Zy=bT,Fg=L8,nZ=G8,z8=function n(e,t){var r=0,o=[],u=[],h,f,d=null,m=null,g,v=!0;t=t||{},n.prototype.init.call(this),this.push=function(_){Zy.collectDtsInfo(e,_),typeof e.timelineStartInfo.dts>"u"&&(e.timelineStartInfo.dts=_.dts),_.nalUnitType==="seq_parameter_set_rbsp"&&!h&&(h=_.config,e.sps=[_.data],nZ.forEach(function(S){e[S]=h[S]},this)),_.nalUnitType==="pic_parameter_set_rbsp"&&!f&&(f=_.data,e.pps=[_.data]),o.push(_)},this.processNals_=function(_){var S;for(o=u.concat(o);o.length&&o[0].nalUnitType!=="access_unit_delimiter_rbsp";)o.shift();if(o.length!==0){var E=Fg.groupNalsIntoFrames(o);if(E.length){if(u=E[E.length-1],_&&(E.pop(),E.duration-=u.duration,E.nalCount-=u.length,E.byteLength-=u.byteLength),!E.length){o=[];return}if(this.trigger("timelineStartInfo",e.timelineStartInfo),v){if(g=Fg.groupFramesIntoGops(E),!g[0][0].keyFrame){if(g=Fg.extendFirstKeyFrame(g),!g[0][0].keyFrame){o=[].concat.apply([],E).concat(u),u=[];return}E=[].concat.apply([],g),E.duration=g.duration}v=!1}for(d===null&&(d=E[0].pts,m=d),m+=E.duration,this.trigger("timingInfo",{start:d,end:m}),S=0;S<E.length;S++){var T=E[S];e.samples=Fg.generateSampleTableForFrame(T);var C=YC.mdat(Fg.concatenateNalDataForFrame(T));Zy.clearDtsInfo(e),Zy.collectDtsInfo(e,T),e.baseMediaDecodeTime=Zy.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps);var R=YC.moof(r,[e]);r++,e.initSegment=YC.initSegment([e]);var b=new Uint8Array(R.byteLength+C.byteLength);b.set(R),b.set(C,R.byteLength),this.trigger("data",{track:e,boxes:b,sequence:r,videoFrameDts:T.dts,videoFramePts:T.pts})}o=[]}}},this.resetTimingAndConfig_=function(){h=void 0,f=void 0,d=null,m=null},this.partialFlush=function(){this.processNals_(!0),this.trigger("partialdone","VideoSegmentStream")},this.flush=function(){this.processNals_(!1),this.resetTimingAndConfig_(),this.trigger("done","VideoSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","VideoSegmentStream")},this.reset=function(){this.resetTimingAndConfig_(),u=[],o=[],v=!0,this.trigger("reset")}};z8.prototype=new tZ;var rZ=z8,Y8=za,Su=MT,OU=zj,X8=eZ,iZ=rZ,NU=bT,sZ=wT.isLikelyAacData,aZ=CT,oZ=j8,nb=Wc,q8=function(e){return e.prototype=new Y8,e.prototype.init.call(e),e},lZ=function(e){var t={type:"ts",tracks:{audio:null,video:null},packet:new Su.TransportPacketStream,parse:new Su.TransportParseStream,elementary:new Su.ElementaryStream,timestampRollover:new Su.TimestampRolloverStream,adts:new OU.Adts,h264:new OU.h264.H264Stream,captionStream:new Su.CaptionStream(e),metadataStream:new Su.MetadataStream};return t.headOfPipeline=t.packet,t.packet.pipe(t.parse).pipe(t.elementary).pipe(t.timestampRollover),t.timestampRollover.pipe(t.h264),t.h264.pipe(t.captionStream),t.timestampRollover.pipe(t.metadataStream),t.timestampRollover.pipe(t.adts),t.elementary.on("data",function(r){if(r.type==="metadata"){for(var o=0;o<r.tracks.length;o++)t.tracks[r.tracks[o].type]||(t.tracks[r.tracks[o].type]=r.tracks[o],t.tracks[r.tracks[o].type].timelineStartInfo.baseMediaDecodeTime=e.baseMediaDecodeTime);t.tracks.video&&!t.videoSegmentStream&&(t.videoSegmentStream=new iZ(t.tracks.video,e),t.videoSegmentStream.on("timelineStartInfo",function(u){t.tracks.audio&&!e.keepOriginalTimestamps&&t.audioSegmentStream.setEarliestDts(u.dts-e.baseMediaDecodeTime)}),t.videoSegmentStream.on("timingInfo",t.trigger.bind(t,"videoTimingInfo")),t.videoSegmentStream.on("data",function(u){t.trigger("data",{type:"video",data:u})}),t.videoSegmentStream.on("done",t.trigger.bind(t,"done")),t.videoSegmentStream.on("partialdone",t.trigger.bind(t,"partialdone")),t.videoSegmentStream.on("endedtimeline",t.trigger.bind(t,"endedtimeline")),t.h264.pipe(t.videoSegmentStream)),t.tracks.audio&&!t.audioSegmentStream&&(t.audioSegmentStream=new X8(t.tracks.audio,e),t.audioSegmentStream.on("data",function(u){t.trigger("data",{type:"audio",data:u})}),t.audioSegmentStream.on("done",t.trigger.bind(t,"done")),t.audioSegmentStream.on("partialdone",t.trigger.bind(t,"partialdone")),t.audioSegmentStream.on("endedtimeline",t.trigger.bind(t,"endedtimeline")),t.audioSegmentStream.on("timingInfo",t.trigger.bind(t,"audioTimingInfo")),t.adts.pipe(t.audioSegmentStream)),t.trigger("trackinfo",{hasAudio:!!t.tracks.audio,hasVideo:!!t.tracks.video})}}),t.captionStream.on("data",function(r){var o;t.tracks.video?o=t.tracks.video.timelineStartInfo.pts||0:o=0,r.startTime=nb.metadataTsToSeconds(r.startPts,o,e.keepOriginalTimestamps),r.endTime=nb.metadataTsToSeconds(r.endPts,o,e.keepOriginalTimestamps),t.trigger("caption",r)}),t=q8(t),t.metadataStream.on("data",t.trigger.bind(t,"id3Frame")),t},uZ=function(e){var t={type:"aac",tracks:{audio:null},metadataStream:new Su.MetadataStream,aacStream:new oZ,audioRollover:new Su.TimestampRolloverStream("audio"),timedMetadataRollover:new Su.TimestampRolloverStream("timed-metadata"),adtsStream:new aZ(!0)};return t.headOfPipeline=t.aacStream,t.aacStream.pipe(t.audioRollover).pipe(t.adtsStream),t.aacStream.pipe(t.timedMetadataRollover).pipe(t.metadataStream),t.metadataStream.on("timestamp",function(r){t.aacStream.setTimestamp(r.timeStamp)}),t.aacStream.on("data",function(r){r.type!=="timed-metadata"&&r.type!=="audio"||t.audioSegmentStream||(t.tracks.audio=t.tracks.audio||{timelineStartInfo:{baseMediaDecodeTime:e.baseMediaDecodeTime},codec:"adts",type:"audio"},t.audioSegmentStream=new X8(t.tracks.audio,e),t.audioSegmentStream.on("data",function(o){t.trigger("data",{type:"audio",data:o})}),t.audioSegmentStream.on("partialdone",t.trigger.bind(t,"partialdone")),t.audioSegmentStream.on("done",t.trigger.bind(t,"done")),t.audioSegmentStream.on("endedtimeline",t.trigger.bind(t,"endedtimeline")),t.audioSegmentStream.on("timingInfo",t.trigger.bind(t,"audioTimingInfo")),t.adtsStream.pipe(t.audioSegmentStream),t.trigger("trackinfo",{hasAudio:!!t.tracks.audio,hasVideo:!!t.tracks.video}))}),t=q8(t),t.metadataStream.on("data",t.trigger.bind(t,"id3Frame")),t},FU=function(e,t){e.on("data",t.trigger.bind(t,"data")),e.on("done",t.trigger.bind(t,"done")),e.on("partialdone",t.trigger.bind(t,"partialdone")),e.on("endedtimeline",t.trigger.bind(t,"endedtimeline")),e.on("audioTimingInfo",t.trigger.bind(t,"audioTimingInfo")),e.on("videoTimingInfo",t.trigger.bind(t,"videoTimingInfo")),e.on("trackinfo",t.trigger.bind(t,"trackinfo")),e.on("id3Frame",function(r){r.dispatchType=e.metadataStream.dispatchType,r.cueTime=nb.videoTsToSeconds(r.pts),t.trigger("id3Frame",r)}),e.on("caption",function(r){t.trigger("caption",r)})},Q8=function n(e){var t=null,r=!0;e=e||{},n.prototype.init.call(this),e.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.push=function(o){if(r){var u=sZ(o);u&&(!t||t.type!=="aac")?(t=uZ(e),FU(t,this)):!u&&(!t||t.type!=="ts")&&(t=lZ(e),FU(t,this)),r=!1}t.headOfPipeline.push(o)},this.flush=function(){t&&(r=!0,t.headOfPipeline.flush())},this.partialFlush=function(){t&&t.headOfPipeline.partialFlush()},this.endTimeline=function(){t&&t.headOfPipeline.endTimeline()},this.reset=function(){t&&t.headOfPipeline.reset()},this.setBaseMediaDecodeTime=function(o){e.keepOriginalTimestamps||(e.baseMediaDecodeTime=o),t&&(t.tracks.audio&&(t.tracks.audio.timelineStartInfo.dts=void 0,t.tracks.audio.timelineStartInfo.pts=void 0,NU.clearDtsInfo(t.tracks.audio),t.audioRollover&&t.audioRollover.discontinuity()),t.tracks.video&&(t.videoSegmentStream&&(t.videoSegmentStream.gopCache_=[]),t.tracks.video.timelineStartInfo.dts=void 0,t.tracks.video.timelineStartInfo.pts=void 0,NU.clearDtsInfo(t.tracks.video)),t.timestampRollover&&t.timestampRollover.discontinuity())},this.setRemux=function(o){e.remux=o,t&&t.coalesceStream&&t.coalesceStream.setRemux(o)},this.setAudioAppendStart=function(o){!t||!t.tracks.audio||!t.audioSegmentStream||t.audioSegmentStream.setAudioAppendStart(o)},this.alignGopsWith=function(o){}};Q8.prototype=new Y8;var cZ=Q8,fZ={Transmuxer:cZ},XC,kU;function dZ(){if(kU)return XC;kU=1;var n=gp.getUint64,e=function(r){var o=new DataView(r.buffer,r.byteOffset,r.byteLength),u={version:r[0],flags:new Uint8Array(r.subarray(1,4)),references:[],referenceId:o.getUint32(4),timescale:o.getUint32(8)},h=12;u.version===0?(u.earliestPresentationTime=o.getUint32(h),u.firstOffset=o.getUint32(h+4),h+=8):(u.earliestPresentationTime=n(r.subarray(h)),u.firstOffset=n(r.subarray(h+8)),h+=16),h+=2;var f=o.getUint16(h);for(h+=2;f>0;h+=12,f--)u.references.push({referenceType:(r[h]&128)>>>7,referencedSize:o.getUint32(h)&2147483647,subsegmentDuration:o.getUint32(h+4),startsWithSap:!!(r[h+8]&128),sapType:(r[h+8]&112)>>>4,sapDeltaTime:o.getUint32(h+8)&268435455});return u};return XC=e,XC}var hZ=gp,UU=hZ.getUint64,_s,rb,eo=function(e){return new Date(e*1e3-20828448e5)},gm=eP,pZ=tP,gZ=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r=[],o,u;for(o=0;o+4<e.length;o+=u){if(u=t.getUint32(o),o+=4,u<=0){r.push("<span style='color:red;'>MALFORMED DATA</span>");continue}switch(e[o]&31){case 1:r.push("slice_layer_without_partitioning_rbsp");break;case 5:r.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:r.push("sei_rbsp");break;case 7:r.push("seq_parameter_set_rbsp");break;case 8:r.push("pic_parameter_set_rbsp");break;case 9:r.push("access_unit_delimiter_rbsp");break;default:r.push("UNKNOWN NAL - "+e[o]&31);break}}return r},mc={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:_s(e.subarray(78,e.byteLength))}},avcC:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:e[4]&3,sps:[],pps:[]},o=e[5]&31,u,h,f,d;for(f=6,d=0;d<o;d++)h=t.getUint16(f),f+=2,r.sps.push(new Uint8Array(e.subarray(f,f+h))),f+=h;for(u=e[f],f++,d=0;d<u;d++)h=t.getUint16(f),f+=2,r.pps.push(new Uint8Array(e.subarray(f,f+h))),f+=h;return r},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},edts:function(e){return{boxes:_s(e)}},elst:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),edits:[]},o=t.getUint32(4),u;for(u=8;o;o--)r.version===0?(r.edits.push({segmentDuration:t.getUint32(u),mediaTime:t.getInt32(u+4),mediaRate:t.getUint16(u+8)+t.getUint16(u+10)/(256*256)}),u+=12):(r.edits.push({segmentDuration:UU(e.subarray(u)),mediaTime:UU(e.subarray(u+8)),mediaRate:t.getUint16(u+16)+t.getUint16(u+18)/(256*256)}),u+=20);return r},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:e[8]&31,decoderConfig:{objectProfileIndication:e[11],streamType:e[12]>>>2&63,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:e[26]>>>3&31,samplingFrequencyIndex:(e[26]&7)<<1|e[27]>>>7&1,channelConfiguration:e[27]>>>3&15}}}},ftyp:function(e){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={majorBrand:gm(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},o=8;o<e.byteLength;)r.compatibleBrands.push(gm(e.subarray(o,o+4))),o+=4;return r},dinf:function(e){return{boxes:_s(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:_s(e.subarray(8))}},hdlr:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:gm(e.subarray(8,12)),name:""},o=8;for(o=24;o<e.byteLength;o++){if(e[o]===0){o++;break}r.name+=String.fromCharCode(e[o])}return r.name=decodeURIComponent(escape(r.name)),r},mdat:function(e){return{byteLength:e.byteLength,nals:gZ(e)}},mdhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r=4,o,u={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};return u.version===1?(r+=4,u.creationTime=eo(t.getUint32(r)),r+=8,u.modificationTime=eo(t.getUint32(r)),r+=4,u.timescale=t.getUint32(r),r+=8,u.duration=t.getUint32(r)):(u.creationTime=eo(t.getUint32(r)),r+=4,u.modificationTime=eo(t.getUint32(r)),r+=4,u.timescale=t.getUint32(r),r+=4,u.duration=t.getUint32(r)),r+=4,o=t.getUint16(r),u.language+=String.fromCharCode((o>>10)+96),u.language+=String.fromCharCode(((o&992)>>5)+96),u.language+=String.fromCharCode((o&31)+96),u},mdia:function(e){return{boxes:_s(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:_s(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return e.byteLength>28&&(r.streamDescriptor=_s(e.subarray(28))[0]),r},moof:function(e){return{boxes:_s(e)}},moov:function(e){return{boxes:_s(e)}},mvex:function(e){return{boxes:_s(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r=4,o={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return o.version===1?(r+=4,o.creationTime=eo(t.getUint32(r)),r+=8,o.modificationTime=eo(t.getUint32(r)),r+=4,o.timescale=t.getUint32(r),r+=8,o.duration=t.getUint32(r)):(o.creationTime=eo(t.getUint32(r)),r+=4,o.modificationTime=eo(t.getUint32(r)),r+=4,o.timescale=t.getUint32(r),r+=4,o.duration=t.getUint32(r)),r+=4,o.rate=t.getUint16(r)+t.getUint16(r+2)/16,r+=4,o.volume=t.getUint8(r)+t.getUint8(r+1)/8,r+=2,r+=2,r+=2*4,o.matrix=new Uint32Array(e.subarray(r,r+9*4)),r+=9*4,r+=6*4,o.nextTrackId=t.getUint32(r),o},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},r;for(r=4;r<e.byteLength;r++)t.samples.push({dependsOn:(e[r]&48)>>4,isDependedOn:(e[r]&12)>>2,hasRedundancy:e[r]&3});return t},sidx:dZ(),smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:_s(e)}},ctts:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),compositionOffsets:[]},o=t.getUint32(4),u;for(u=8;o;u+=8,o--)r.compositionOffsets.push({sampleCount:t.getUint32(u),sampleOffset:t[r.version===0?"getUint32":"getInt32"](u+4)});return r},stss:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),syncSamples:[]},o=t.getUint32(4),u;for(u=8;o;u+=4,o--)r.syncSamples.push(t.getUint32(u));return r},stco:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},o=t.getUint32(4),u;for(u=8;o;u+=4,o--)r.chunkOffsets.push(t.getUint32(u));return r},stsc:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r=t.getUint32(4),o={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]},u;for(u=8;r;u+=12,r--)o.sampleToChunks.push({firstChunk:t.getUint32(u),samplesPerChunk:t.getUint32(u+4),sampleDescriptionIndex:t.getUint32(u+8)});return o},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:_s(e.subarray(8))}},stsz:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:t.getUint32(4),entries:[]},o;for(o=12;o<e.byteLength;o+=4)r.entries.push(t.getUint32(o));return r},stts:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},o=t.getUint32(4),u;for(u=8;o;u+=8,o--)r.timeToSamples.push({sampleCount:t.getUint32(u),sampleDelta:t.getUint32(u+4)});return r},styp:function(e){return mc.ftyp(e)},tfdt:iP,tfhd:nP,tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r=4,o={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return o.version===1?(r+=4,o.creationTime=eo(t.getUint32(r)),r+=8,o.modificationTime=eo(t.getUint32(r)),r+=4,o.trackId=t.getUint32(r),r+=4,r+=8,o.duration=t.getUint32(r)):(o.creationTime=eo(t.getUint32(r)),r+=4,o.modificationTime=eo(t.getUint32(r)),r+=4,o.trackId=t.getUint32(r),r+=4,r+=4,o.duration=t.getUint32(r)),r+=4,r+=2*4,o.layer=t.getUint16(r),r+=2,o.alternateGroup=t.getUint16(r),r+=2,o.volume=t.getUint8(r)+t.getUint8(r+1)/8,r+=2,r+=2,o.matrix=new Uint32Array(e.subarray(r,r+9*4)),r+=9*4,o.width=t.getUint16(r)+t.getUint16(r+2)/65536,r+=4,o.height=t.getUint16(r)+t.getUint16(r+2)/65536,o},traf:function(e){return{boxes:_s(e)}},trak:function(e){return{boxes:_s(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:e[20]&3,sampleIsDependedOn:(e[21]&192)>>6,sampleHasRedundancy:(e[21]&48)>>4,samplePaddingValue:(e[21]&14)>>1,sampleIsDifferenceSample:!!(e[21]&1),sampleDegradationPriority:t.getUint16(22)}},trun:rP,"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}};_s=function(e){for(var t=0,r=[],o,u,h,f,d,m=new ArrayBuffer(e.length),g=new Uint8Array(m),v=0;v<e.length;++v)g[v]=e[v];for(o=new DataView(m);t<e.byteLength;)u=o.getUint32(t),h=gm(e.subarray(t+4,t+8)),f=u>1?t+u:e.byteLength,d=(mc[h]||function(_){return{data:_}})(e.subarray(t+8,f)),d.size=u,d.type=h,r.push(d),t=f;return r};rb=function(e,t){var r;return t=t||0,r=new Array(t*2+1).join(" "),e.map(function(o,u){return r+o.type+`
`+Object.keys(o).filter(function(h){return h!=="type"&&h!=="boxes"}).map(function(h){var f=r+"  "+h+": ",d=o[h];if(d instanceof Uint8Array||d instanceof Uint32Array){var m=Array.prototype.slice.call(new Uint8Array(d.buffer,d.byteOffset,d.byteLength)).map(function(g){return" "+("00"+g.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return m?m.length===1?f+"<"+m.join("").slice(1)+">":f+`<
`+m.map(function(g){return r+"  "+g}).join(`
`)+`
`+r+"  >":f+"<>"}return f+JSON.stringify(d,null,2).split(`
`).map(function(g,v){return v===0?g:r+"  "+g}).join(`
`)}).join(`
`)+(o.boxes?`
`+rb(o.boxes,t+1):"")}).join(`
`)};var mZ={inspect:_s,textify:rb,parseType:gm,findBox:pZ,parseTraf:mc.traf,parseTfdt:mc.tfdt,parseHdlr:mc.hdlr,parseTfhd:mc.tfhd,parseTrun:mc.trun,parseSidx:mc.sidx},vZ={8:"audio",9:"video",18:"metadata"},yZ=function(e){return"0x"+("00"+e.toString(16)).slice(-2).toUpperCase()},ib=function(e){for(var t=[],r;e.byteLength>0;)r=0,t.push(yZ(e[r++])),e=e.subarray(r);return t.join(" ")},EZ=function(e,t){var r=["AVC Sequence Header","AVC NALU","AVC End-of-Sequence"],o=e[1]&parseInt("01111111",2)<<16|e[2]<<8|e[3];return t=t||{},t.avcPacketType=r[e[0]],t.CompositionTime=e[1]&parseInt("10000000",2)?-o:o,e[0]===1?t.nalUnitTypeRaw=ib(e.subarray(4,100)):t.data=ib(e.subarray(4)),t},_Z=function(e,t){var r=["Unknown","Keyframe (for AVC, a seekable frame)","Inter frame (for AVC, a nonseekable frame)","Disposable inter frame (H.263 only)","Generated keyframe (reserved for server use only)","Video info/command frame"],o=e[0]&parseInt("00001111",2);return t=t||{},t.frameType=r[(e[0]&parseInt("11110000",2))>>>4],t.codecID=o,o===7?EZ(e.subarray(1),t):t},TZ=function(e,t){var r=["AAC Sequence Header","AAC Raw"];return t=t||{},t.aacPacketType=r[e[0]],t.data=ib(e.subarray(1)),t},SZ=function(e,t){var r=["Linear PCM, platform endian","ADPCM","MP3","Linear PCM, little endian","Nellymoser 16-kHz mono","Nellymoser 8-kHz mono","Nellymoser","G.711 A-law logarithmic PCM","G.711 mu-law logarithmic PCM","reserved","AAC","Speex","MP3 8-Khz","Device-specific sound"],o=["5.5-kHz","11-kHz","22-kHz","44-kHz"],u=(e[0]&parseInt("11110000",2))>>>4;return t=t||{},t.soundFormat=r[u],t.soundRate=o[(e[0]&parseInt("00001100",2))>>>2],t.soundSize=(e[0]&parseInt("00000010",2))>>>1?"16-bit":"8-bit",t.soundType=e[0]&parseInt("00000001",2)?"Stereo":"Mono",u===10?TZ(e.subarray(1),t):t},AZ=function(e){return{tagType:vZ[e[0]],dataSize:e[1]<<16|e[2]<<8|e[3],timestamp:e[7]<<24|e[4]<<16|e[5]<<8|e[6],streamID:e[8]<<16|e[9]<<8|e[10]}},J8=function(e){var t=AZ(e);switch(e[0]){case 8:SZ(e.subarray(11),t);break;case 9:_Z(e.subarray(11),t);break}return t},xZ=function(e){var t=9,r,o=[],u;for(t+=4;t<e.byteLength;)r=e[t+1]<<16,r|=e[t+2]<<8,r|=e[t+3],r+=11,u=e.subarray(t,t+r),o.push(J8(u)),t+=r+4;return o},CZ=function(e){return JSON.stringify(e,null,2)},IZ={inspectTag:J8,inspect:xZ,textify:CZ},qC=LT,Z8=function(e){var t=e[1]&31;return t<<=8,t|=e[2],t},NT=function(e){return!!(e[1]&64)},FT=function(e){var t=0;return(e[3]&48)>>>4>1&&(t+=e[4]+1),t},RZ=function(e,t){var r=Z8(e);return r===0?"pat":r===t?"pmt":t?"pes":null},bZ=function(e){var t=NT(e),r=4+FT(e);return t&&(r+=e[r]+1),(e[r+10]&31)<<8|e[r+11]},DZ=function(e){var t={},r=NT(e),o=4+FT(e);if(r&&(o+=e[o]+1),!!(e[o+5]&1)){var u,h,f;u=(e[o+1]&15)<<8|e[o+2],h=3+u-4,f=(e[o+10]&15)<<8|e[o+11];for(var d=12+f;d<h;){var m=o+d;t[(e[m+1]&31)<<8|e[m+2]]=e[m],d+=((e[m+3]&15)<<8|e[m+4])+5}return t}},PZ=function(e,t){var r=Z8(e),o=t[r];switch(o){case qC.H264_STREAM_TYPE:return"video";case qC.ADTS_STREAM_TYPE:return"audio";case qC.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},LZ=function(e){var t=NT(e);if(!t)return null;var r=4+FT(e);if(r>=e.byteLength)return null;var o=null,u;return u=e[r+7],u&192&&(o={},o.pts=(e[r+9]&14)<<27|(e[r+10]&255)<<20|(e[r+11]&254)<<12|(e[r+12]&255)<<5|(e[r+13]&254)>>>3,o.pts*=4,o.pts+=(e[r+13]&6)>>>1,o.dts=o.pts,u&64&&(o.dts=(e[r+14]&14)<<27|(e[r+15]&255)<<20|(e[r+16]&254)<<12|(e[r+17]&255)<<5|(e[r+18]&254)>>>3,o.dts*=4,o.dts+=(e[r+18]&6)>>>1)),o},QC=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},MZ=function(e){for(var t=4+FT(e),r=e.subarray(t),o=0,u=0,h=!1,f;u<r.byteLength-3;u++)if(r[u+2]===1){o=u+5;break}for(;o<r.byteLength;)switch(r[o]){case 0:if(r[o-1]!==0){o+=2;break}else if(r[o-2]!==0){o++;break}u+3!==o-2&&(f=QC(r[u+3]&31),f==="slice_layer_without_partitioning_rbsp_idr"&&(h=!0));do o++;while(r[o]!==1&&o<r.length);u=o-2,o+=3;break;case 1:if(r[o-1]!==0||r[o-2]!==0){o+=3;break}f=QC(r[u+3]&31),f==="slice_layer_without_partitioning_rbsp_idr"&&(h=!0),u=o-2,o+=3;break;default:o+=3;break}return r=r.subarray(u),o-=u,u=0,r&&r.byteLength>3&&(f=QC(r[u+3]&31),f==="slice_layer_without_partitioning_rbsp_idr"&&(h=!0)),h},wZ={parseType:RZ,parsePat:bZ,parsePmt:DZ,parsePayloadUnitStartIndicator:NT,parsePesType:PZ,parsePesTime:LZ,videoPacketContainsKeyFrame:MZ},BU=LT,zd=k8.handleRollover,Fr={};Fr.ts=wZ;Fr.aac=wT;var Rf=Wc.ONE_SECOND_IN_TS,ks=188,Sl=71,OZ=function(e,t){for(var r=0,o=ks,u,h;o<e.byteLength;){if(e[r]===Sl&&e[o]===Sl){switch(u=e.subarray(r,o),h=Fr.ts.parseType(u,t.pid),h){case"pat":t.pid=Fr.ts.parsePat(u);break;case"pmt":var f=Fr.ts.parsePmt(u);t.table=t.table||{},Object.keys(f).forEach(function(d){t.table[d]=f[d]});break}r+=ks,o+=ks;continue}r++,o++}},e6=function(e,t,r){for(var o=0,u=ks,h,f,d,m,g,v=!1;u<=e.byteLength;){if(e[o]===Sl&&(e[u]===Sl||u===e.byteLength)){switch(h=e.subarray(o,u),f=Fr.ts.parseType(h,t.pid),f){case"pes":d=Fr.ts.parsePesType(h,t.table),m=Fr.ts.parsePayloadUnitStartIndicator(h),d==="audio"&&m&&(g=Fr.ts.parsePesTime(h),g&&(g.type="audio",r.audio.push(g),v=!0));break}if(v)break;o+=ks,u+=ks;continue}o++,u++}for(u=e.byteLength,o=u-ks,v=!1;o>=0;){if(e[o]===Sl&&(e[u]===Sl||u===e.byteLength)){switch(h=e.subarray(o,u),f=Fr.ts.parseType(h,t.pid),f){case"pes":d=Fr.ts.parsePesType(h,t.table),m=Fr.ts.parsePayloadUnitStartIndicator(h),d==="audio"&&m&&(g=Fr.ts.parsePesTime(h),g&&(g.type="audio",r.audio.push(g),v=!0));break}if(v)break;o-=ks,u-=ks;continue}o--,u--}},NZ=function(e,t,r){for(var o=0,u=ks,h,f,d,m,g,v,_,S,E=!1,T={data:[],size:0};u<e.byteLength;){if(e[o]===Sl&&e[u]===Sl){switch(h=e.subarray(o,u),f=Fr.ts.parseType(h,t.pid),f){case"pes":if(d=Fr.ts.parsePesType(h,t.table),m=Fr.ts.parsePayloadUnitStartIndicator(h),d==="video"&&(m&&!E&&(g=Fr.ts.parsePesTime(h),g&&(g.type="video",r.video.push(g),E=!0)),!r.firstKeyFrame)){if(m&&T.size!==0){for(v=new Uint8Array(T.size),_=0;T.data.length;)S=T.data.shift(),v.set(S,_),_+=S.byteLength;if(Fr.ts.videoPacketContainsKeyFrame(v)){var C=Fr.ts.parsePesTime(v);C?(r.firstKeyFrame=C,r.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}T.size=0}T.data.push(h),T.size+=h.byteLength}break}if(E&&r.firstKeyFrame)break;o+=ks,u+=ks;continue}o++,u++}for(u=e.byteLength,o=u-ks,E=!1;o>=0;){if(e[o]===Sl&&e[u]===Sl){switch(h=e.subarray(o,u),f=Fr.ts.parseType(h,t.pid),f){case"pes":d=Fr.ts.parsePesType(h,t.table),m=Fr.ts.parsePayloadUnitStartIndicator(h),d==="video"&&m&&(g=Fr.ts.parsePesTime(h),g&&(g.type="video",r.video.push(g),E=!0));break}if(E)break;o-=ks,u-=ks;continue}o--,u--}},FZ=function(e,t){if(e.audio&&e.audio.length){var r=t;(typeof r>"u"||isNaN(r))&&(r=e.audio[0].dts),e.audio.forEach(function(h){h.dts=zd(h.dts,r),h.pts=zd(h.pts,r),h.dtsTime=h.dts/Rf,h.ptsTime=h.pts/Rf})}if(e.video&&e.video.length){var o=t;if((typeof o>"u"||isNaN(o))&&(o=e.video[0].dts),e.video.forEach(function(h){h.dts=zd(h.dts,o),h.pts=zd(h.pts,o),h.dtsTime=h.dts/Rf,h.ptsTime=h.pts/Rf}),e.firstKeyFrame){var u=e.firstKeyFrame;u.dts=zd(u.dts,o),u.pts=zd(u.pts,o),u.dtsTime=u.dts/Rf,u.ptsTime=u.pts/Rf}}},kZ=function(e){for(var t=!1,r=0,o=null,u=null,h=0,f=0,d;e.length-f>=3;){var m=Fr.aac.parseType(e,f);switch(m){case"timed-metadata":if(e.length-f<10){t=!0;break}if(h=Fr.aac.parseId3TagSize(e,f),h>e.length){t=!0;break}u===null&&(d=e.subarray(f,f+h),u=Fr.aac.parseAacTimestamp(d)),f+=h;break;case"audio":if(e.length-f<7){t=!0;break}if(h=Fr.aac.parseAdtsSize(e,f),h>e.length){t=!0;break}o===null&&(d=e.subarray(f,f+h),o=Fr.aac.parseSampleRate(d)),r++,f+=h;break;default:f++;break}if(t)return null}if(o===null||u===null)return null;var g=Rf/o,v={audio:[{type:"audio",dts:u,pts:u},{type:"audio",dts:u+r*1024*g,pts:u+r*1024*g}]};return v},UZ=function(e){var t={pid:null,table:null},r={};OZ(e,t);for(var o in t.table)if(t.table.hasOwnProperty(o)){var u=t.table[o];switch(u){case BU.H264_STREAM_TYPE:r.video=[],NZ(e,t,r),r.video.length===0&&delete r.video;break;case BU.ADTS_STREAM_TYPE:r.audio=[],e6(e,t,r),r.audio.length===0&&delete r.audio;break}}return r},BZ=function(e,t){var r=Fr.aac.isLikelyAacData(e),o;return r?o=kZ(e):o=UZ(e),!o||!o.audio&&!o.video?null:(FZ(o,t),o)},jZ={inspect:BZ,parseAudioPes_:e6},kT={codecs:zj,mp4:UJ,flv:XJ,mp2t:tb,partial:fZ};kT.mp4.tools=mZ;kT.flv.tools=IZ;kT.mp2t.tools=jZ;var KZ=kT;function GZ(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,o,u,h,f=[],d=!0,m=!1;try{if(u=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;d=!1}else for(;!(d=(r=u.call(t)).done)&&(f.push(r.value),f.length!==e);d=!0);}catch(g){m=!0,o=g}finally{try{if(!d&&t.return!=null&&(h=t.return(),Object(h)!==h))return}finally{if(m)throw o}}return f}}function jU(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,r)}return t}function KU(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?jU(Object(t),!0).forEach(function(r){WZ(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):jU(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function WZ(n,e,t){return e=YZ(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gP(n,e){return HZ(n)||GZ(n,e)||VZ(n,e)||$Z()}function HZ(n){if(Array.isArray(n))return n}function VZ(n,e){if(n){if(typeof n=="string")return GU(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return GU(n,e)}}function GU(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function $Z(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zZ(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function YZ(n){var e=zZ(n,"string");return typeof e=="symbol"?e:String(e)}const Ar={number:"number",boolean:"boolean",token:"token",string:"string"},qm={br:Ar.number,bl:Ar.number,bs:Ar.boolean,cid:Ar.string,d:Ar.number,dl:Ar.number,mtp:Ar.number,nor:Ar.string,nrr:Ar.string,ot:Ar.token,pr:Ar.number,rtp:Ar.number,sf:Ar.token,sid:Ar.string,st:Ar.token,su:Ar.boolean,tb:Ar.number,v:Ar.number},oi={noCMCDRequest:"no-CMCD-request",unknownKey:"unknown-key",invalidValue:"invalid-value",wrongTypeValue:"wrong-type-value",incorrectFormat:"incorrect-format",parameterEncoding:"parameter-encoding",missingKey:"missing-key",invalidHeader:"invalid-header",invalidJson:"invalid-json",duplicateKey:"duplicate-key",duplicatedHeader:"duplicated-header",noHeader:"no-header",emptyHeader:"empty-header",unnecessaryKey:"unnecessary-key",wrongCustomType:"wrong-custom-type",invalidCustomKey:"invalid-custom-key",unknownSpecificKey:"unknown-specific-key",wrongCustomHeader:"wrong-custom-header",queryMalformed:"query-malformed",noAmpersandBetweenRequests:"no-ampersand-between-requests:"},XZ={noCMCDRequest:"No CMCD request found",unknownKey:"Key is not part of reserved keys",invalidValue:"Value does not meet requirements",wrongTypeValue:"Value type is incorrect",incorrectFormat:"Format is incorrect",parameterEncoding:"Parameter is not encoded",missingKey:"Key is missing",invalidHeader:"Header is not valid",invalidJson:"Json format is not valid",duplicateKey:"Key/Keys are not unique",duplicatedHeader:"Header is duplicated",noHeader:"There is no CMCD headers.",emptyHeader:"There is a header with no content",unnecessaryKey:"This key must not be sent with the current value",wrongCustomType:"The type does not mach with CMCD types",invalidCustomKey:"Custom key names MUST carry a hyphenated prefix",unknownSpecificKey:"The key does not mach with CMCD keys",wrongCustomHeader:"The header does not mach with CMCD headers",queryMalformed:"The query is malformed",noAmpersandBetweenRequests:"Ampersand required between two or more requests"},JC={"CMCD-Object":["br","d","ot","tb"],"CMCD-Request":["bl","dl","mtp","nor","nrr","su"],"CMCD-Session":["cid","pr","sf","sid","st","v"],"CMCD-Status":["bs","rtp"]},Fl={noAlphabeticalOrder:"no-alphabetical-order",valuePr:"pr-value",valueV:"v-value",noSidReceived:"no-sid-received",blWithWrongOtValue:"bl-with-wrong-ot-value",noReverseDnsCustomKey:"customkey-without-reversedns",specificKeysNotSent:"specific-keys-not-sent"},qZ={noAlphabeticalOrder:"Keys are not arranged alphabetically",valuePr:"Should only be sent if not equal to 1.00",valueV:"Client should omit this field if the version is 1",noSidReceived:"No sid received from CMCD message",blWithWrongOtValue:"bl key should only be sent with an object type of a, v or av",noReverseDnsCustomKey:"Customkey without Reverse DNS, could be: com.example-customkeyname",specificKeysNotSent:"A specific/custom key was set but not sent"},t6=(n,e)=>Object.keys(n).find(t=>n[t]===e),Ai=(n,e,t,r)=>{if(!Object.values(oi).includes(n))return-1;const o=t6(oi,n);return r===void 0?{type:n,key:e,value:t,description:XZ[o]}:{type:n,key:e,value:t,description:r}},WU=n=>n.indexOf('"')===0&&n.lastIndexOf('"')===n.length-1,QZ=(n,e,t,r)=>{if(r[n]===Ar.string&&!WU(e)||r[n]===Ar.token&&WU(e)){const o=`Incorrect format for key: ${n}`;return t.push(Ai(oi.incorrectFormat,n,e,o)),!1}return!0},JZ=(n,e,t,r)=>{if(r[n]===Ar.boolean&&e==="true"||typeof e>"u"&&r[n]!==Ar.boolean||(typeof e===Ar.number||typeof e===Ar.string&&e!=="false")&&r[n]===Ar.boolean){const o="If the value is TRUE, the = and the value must be omitted";return t.push(Ai(oi.incorrectFormat,n,e,o)),!1}return!0},ZZ=(n,e,t,r)=>{if(r[n]===Ar.number&&!Number(e)){const o=`The value for the key "${n}" must be a number`;return t.push(Ai(oi.incorrectFormat,n,e,o)),!1}return!0},eee=(n,e,t)=>{if(n.split("=").length>2||n.split("=").length===1&&t[n]!==Ar.boolean){const r="key-value pair not separated by =.";return e.push(Ai(oi.incorrectFormat,n,void 0,r)),!1}return!0},tee=(n,e,t)=>{if(e.includes(n)){const r=`The key '${n}' is repeated.`;return t.push(Ai(oi.duplicateKey,n,void 0,r)),!0}return!1},nee=(n,e)=>n.includes("CMCD=")?!0:(e.push(Ai(oi.noCMCDRequest)),!1),ree=(n,e)=>{let t=!1;try{decodeURI(n)===n&&(e.push(Ai(oi.parameterEncoding)),t=!0)}catch{e.push(Ai(oi.queryMalformed)),t=!0}return t},iee=(n,e)=>n[0].length>0&&n[0][n[0].length-1]!=="&"?(e.push(Ai(oi.noAmpersandBetweenRequests)),!1):!0,see=(n,e)=>n.length>1?(e.push(Ai(oi.incorrectFormat)),!0):!1,aee=(n,e,t,r,o)=>{if(!nee(n,e)||ree(n,e))return!1;const u=n.split("?").pop(),h=decodeURIComponent(u).split("CMCD=");if(!iee(h,e)||(h.shift(),see(h,e)))return!1;const f=decodeURIComponent(u).split("CMCD=")[1].split("&")[0].split(","),d=[];let m=!0;return f.forEach(g=>{if(eee(g,e,o)){var v;const _=g.split("="),S=gP(_,2),E=S[0],T=S[1];if(r!=null&&r.specificKey&&!((v=r.specificKey)!==null&&v!==void 0&&v.includes(E)))return;tee(E,d,e)&&(m=!1),(!QZ(E,T,e,o)||!JZ(E,T,e,o)||!ZZ(E,T,e,o))&&(m=!1),d.push(E)}else m=!1}),m},Nc=(n,e,t)=>{if(!Object.values(Fl).includes(n))return-1;const r=t6(Fl,n);return{type:n,key:e,value:t,description:qZ[r]}},oee=(n,e)=>{JSON.stringify(n)!==JSON.stringify(n.sort())&&e.push(Nc(Fl.noAlphabeticalOrder))},HU=(n,e,t)=>{if(t.length>64){const r=`Invalid value for key '${e}'. Maximum length is 64 characters.`;n.push(Ai(oi.invalidValue,e,t,r))}},lee=(n,e,t)=>{if(decodeURIComponent(t)===t&&encodeURIComponent(t)!==t){const r=`The key: '${e}' with its value: ${t} must be URLencoded.`;return n.push(Ai(oi.parameterEncoding,e,t,r)),!1}return!0},uee=(n,e,t)=>{if(!/^(\d*-\d*)$/.test(t)&&!/^\d*-$/.test(t)&&!/^-\d*$/.test(t)){const r="Invalid Nrr format";n.push(Ai(oi.incorrectFormat,e,t,r))}},mP=(n,e,t,r)=>{if(!r.includes(t)){const o=`${e} value does not meet the necessary requirements. Must be one of the following values: ${r}.`;n.push(Ai(oi.invalidValue,e,t,o))}},eE=(n,e,t,r,o)=>{if(t%r!==0){const u=`'${e}' value is not rounded to the nearest ${r}${o}.`;n.push(Ai(oi.invalidValue,e,t,u))}},cee=(n,e,t,r)=>{if(t===r){const o=`The '${e}' key should not be sent if the value is ${r}`;n.push(Ai(oi.unnecessaryKey,e,t,o))}},fee=(n,e,t,r)=>{if(!(e in r)){const o=`The key '${e}' is not reserved.`;n.push(Ai(oi.unknownKey,e,t,o))}},dee=(n,e,t)=>{if(qm[e]===Ar.number&&t<0){const r=`The '${e}' value must be greater than 0.`;n.push(Ai(oi.invalidValue,e,t,r))}},hee=(n,e,t,r)=>{(!("ot"in n)||!["a","v","av"].includes(n.ot))&&e.push(Nc(Fl.blWithWrongOtValue,t,r))},pee=(n,e,t)=>{if(typeof t!==qm[e]&&qm[e]===Ar.token&&typeof t!==Ar.string){const r=`'${e}' type is incorrect.`;n.push(Ai(oi.wrongTypeValue,e,t,r))}},gee=(n,e,t)=>{mP(n,e,t,["m","a","v","av","i","c","tt","k","o"])},mee=(n,e,t)=>{mP(n,e,t,["d","h","s","o"])},vee=(n,e,t)=>{mP(n,e,t,["v","l"])},yee=(n,e,t,r)=>{t==="pr"&&r===1&&e.push(Nc(Fl.valuePr,t,r))},Eee=(n,e,t,r)=>{t==="v"&&n.v===1&&e.push(Nc(Fl.valueV,t,r))},_ee=(n,e)=>{"sid"in n||e.push(Nc(Fl.noSidReceived))},Tee=(n,e,t,r,o,u)=>{u===!0&&_ee(n,t);const h=Object.keys(n);r!=null&&r.specificKey&&u&&r.specificKey.forEach(f=>{h.includes(f)||t.push(Nc(Fl.specificKeysNotSent,f))}),r!=null&&r.customKey&&u&&r.customKey.forEach(f=>{h.includes(f.key)||t.push(Nc(Fl.specificKeysNotSent,f.key))}),Object.keys(n).forEach(f=>{var d;if(r!=null&&r.specificKey&&!((d=r.specificKey)!==null&&d!==void 0&&d.includes(f)))return;const m=n[f];switch(fee(e,f,m,o),pee(e,f,m),dee(e,f,m),f){case"bl":eE(e,f,m,100,"ms"),u===!0&&hee(n,t,f,m);break;case"cid":HU(e,f,m);break;case"dl":eE(e,f,m,100,"ms");break;case"mtp":eE(e,f,m,100,"kbps");break;case"nor":lee(e,f,m);break;case"nrr":uee(e,f,m);break;case"ot":gee(e,f,m);break;case"rtp":eE(e,f,m,100,"kbps");break;case"sf":mee(e,f,m);break;case"sid":HU(e,f,m);break;case"st":vee(e,f,m);break;case"su":cee(e,f,m,!1);break;case"pr":u&&yee(n,t,f,m);break;case"v":u&&Eee(n,t,f,m);break}})},See=(n,e)=>{const t=decodeURIComponent(n).split("CMCD=")[1].split("&")[0].split(","),r={};return t.forEach(o=>{const u=o.split("="),h=gP(u,2),f=h[0],d=h[1];e[f]===Ar.number?r[f]=parseFloat(d):e[f]===Ar.boolean?r[f]=d!=="false":r[f]=d.replaceAll('"',"")}),r},Aee=(n,e,t,r=!0)=>{if(!n)return[!0,qm,JC];const o=n.customKey,u=n.specificKey;let h=!1;const f=KU({},qm),d=KU({},JC);if(o){const m=Object.values(Ar);o.forEach(g=>{/^[a-zA-Z0-9.]+-[a-zA-Z0-9]+$/.test(g.key)||(e.push(Ai(oi.invalidCustomKey,g.key)),h=!0),m.includes(g.type)||(e.push(Ai(oi.wrongCustomType,g.key,g.type)),h=!0),!/^([a-zA-Z0-9]+\.[a-zA-Z0-9]+)+$/.test(g.key.split("-")[0])&&r===!0&&t.push(Nc(Fl.noReverseDnsCustomKey)),g.headerType&&!(g.headerType in JC)&&(e.push(Ai(oi.invalidHeader,g.key,g.type)),h=!0),h||(f[g.key]=g.type,g.headerType&&d[g.headerType].push(g.key))})}if(u){const m=Object.keys(f);u.forEach(g=>{m.includes(g)||e.push(Ai(oi.unknownSpecificKey,g))})}return e.length===0?[!0,f,d]:[!1,f,d]},ZC=(n,e,t,r)=>({valid:n.length===0,errors:n,warnings:e,parsedData:r,rawData:t}),Kf=(n,e,t=!0)=>{const r=[],o=n,u=[],h=Aee(e,r,u,t),f=gP(h,2),d=f[0],m=f[1];if(!d||!aee(n,r,u,e,m))return ZC(r,u,o);const v=See(n,m);return t===!0&&oee(Object.keys(v),u),Tee(v,r,u,e,m,t),ZC(r,u,o,v)};function xee({dispatchReqList:n,manifestURI:e}){window.muxjs=KZ;const t=Ot.useRef(null),r=Ot.useRef(!0),[o,u]=Ot.useState(!1);return Ot.useEffect(()=>{if(r.current){r.current=!1;return}const{player:h,ui:f,videoElement:d}=t.current;h.configure({cmcd:{contentId:"testContentId",enabled:!0,sessionId:"testSessionId",useHeaders:!1}});const m=h.getNetworkingEngine();o||(u(!0),m.registerRequestFilter((v,_)=>{const S=[...new Set(_.uris)];for(const E of S)n({type:"saveQuery",payload:{url:E,result:Kf(E)}})}));async function g(){try{await h.load(e)}catch(v){console.log(v)}d.play()}g()},[e]),ln($q,{ref:t})}const Cee={},Iee=Object.freeze(Object.defineProperty({__proto__:null,default:Cee},Symbol.toStringTag,{value:"Module"})),Ree=M4(Iee);var VU=typeof ya<"u"?ya:typeof window<"u"?window:{},bee=Ree,em;typeof document<"u"?em=document:(em=VU["__GLOBAL_DOCUMENT_CACHE@4"],em||(em=VU["__GLOBAL_DOCUMENT_CACHE@4"]=bee));var mn=em,qn={},Dee={get exports(){return qn},set exports(n){qn=n}};(function(n,e){function t(d){if(d&&typeof d=="object"){var m=d.which||d.keyCode||d.charCode;m&&(d=m)}if(typeof d=="number")return h[d];var g=String(d),v=r[g.toLowerCase()];if(v)return v;var v=o[g.toLowerCase()];if(v)return v;if(g.length===1)return g.charCodeAt(0)}t.isEventKey=function(m,g){if(m&&typeof m=="object"){var v=m.which||m.keyCode||m.charCode;if(v==null)return!1;if(typeof g=="string"){var _=r[g.toLowerCase()];if(_)return _===v;var _=o[g.toLowerCase()];if(_)return _===v}else if(typeof g=="number")return g===v;return!1}},e=n.exports=t;var r=e.code=e.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},o=e.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};/*!
 * Programatically add the following
 */for(u=97;u<123;u++)r[String.fromCharCode(u)]=u-32;for(var u=48;u<58;u++)r[u-48]=u;for(u=1;u<13;u++)r["f"+u]=u+111;for(u=0;u<10;u++)r["numpad "+u]=u+96;var h=e.names=e.title={};for(u in r)h[r[u]]=u;for(var f in o)r[f]=o[f]})(Dee,qn);var Pee=Lee;function Lee(n,e){var t,r=null;try{t=JSON.parse(n,e)}catch(o){r=o}return[r,t]}var Qm={},Mee={get exports(){return Qm},set exports(n){Qm=n}};function qo(){return qo=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},qo.apply(this,arguments)}const wee=Object.freeze(Object.defineProperty({__proto__:null,default:qo},Symbol.toStringTag,{value:"Module"})),Oee=M4(wee);var Nee=kee,Fee=Object.prototype.toString;function kee(n){if(!n)return!1;var e=Fee.call(n);return e==="[object Function]"||typeof n=="function"&&e!=="[object RegExp]"||typeof window<"u"&&(n===window.setTimeout||n===window.alert||n===window.confirm||n===window.prompt)}var Uee=rt,Bee=function(e,t){return t===void 0&&(t=!1),function(r,o,u){if(r){e(r);return}if(o.statusCode>=400&&o.statusCode<=599){var h=u;if(t)if(Uee.TextDecoder){var f=jee(o.headers&&o.headers["content-type"]);try{h=new TextDecoder(f).decode(u)}catch{}}else h=String.fromCharCode.apply(null,new Uint8Array(u));e({cause:h});return}e(null,u)}};function jee(n){return n===void 0&&(n=""),n.toLowerCase().split(";").reduce(function(e,t){var r=t.split("="),o=r[0],u=r[1];return o.trim()==="charset"?u.trim():e},"utf-8")}var Kee=Bee,n6=rt,Gee=Oee,Wee=Nee;bl.httpHandler=Kee;/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Björklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var Hee=function(e){var t={};return e&&e.trim().split(`
`).forEach(function(r){var o=r.indexOf(":"),u=r.slice(0,o).trim().toLowerCase(),h=r.slice(o+1).trim();typeof t[u]>"u"?t[u]=h:Array.isArray(t[u])?t[u].push(h):t[u]=[t[u],h]}),t};Mee.exports=bl;Qm.default=bl;bl.XMLHttpRequest=n6.XMLHttpRequest||Yee;bl.XDomainRequest="withCredentials"in new bl.XMLHttpRequest?bl.XMLHttpRequest:n6.XDomainRequest;Vee(["get","put","post","patch","head","delete"],function(n){bl[n==="delete"?"del":n]=function(e,t,r){return t=r6(e,t,r),t.method=n.toUpperCase(),i6(t)}});function Vee(n,e){for(var t=0;t<n.length;t++)e(n[t])}function $ee(n){for(var e in n)if(n.hasOwnProperty(e))return!1;return!0}function r6(n,e,t){var r=n;return Wee(e)?(t=e,typeof n=="string"&&(r={uri:n})):r=Gee({},e,{uri:n}),r.callback=t,r}function bl(n,e,t){return e=r6(n,e,t),i6(e)}function i6(n){if(typeof n.callback>"u")throw new Error("callback argument missing");var e=!1,t=function(F,O,L){e||(e=!0,n.callback(F,O,L))};function r(){f.readyState===4&&setTimeout(h,0)}function o(){var b=void 0;if(f.response?b=f.response:b=f.responseText||zee(f),T)try{b=JSON.parse(b)}catch{}return b}function u(b){return clearTimeout(C),b instanceof Error||(b=new Error(""+(b||"Unknown XMLHttpRequest Error"))),b.statusCode=0,t(b,R)}function h(){if(!m){var b;clearTimeout(C),n.useXDR&&f.status===void 0?b=200:b=f.status===1223?204:f.status;var F=R,O=null;return b!==0?(F={body:o(),statusCode:b,method:v,headers:{},url:g,rawRequest:f},f.getAllResponseHeaders&&(F.headers=Hee(f.getAllResponseHeaders()))):O=new Error("Internal XMLHttpRequest Error"),t(O,F,F.body)}}var f=n.xhr||null;f||(n.cors||n.useXDR?f=new bl.XDomainRequest:f=new bl.XMLHttpRequest);var d,m,g=f.url=n.uri||n.url,v=f.method=n.method||"GET",_=n.body||n.data,S=f.headers=n.headers||{},E=!!n.sync,T=!1,C,R={body:void 0,headers:{},statusCode:0,method:v,url:g,rawRequest:f};if("json"in n&&n.json!==!1&&(T=!0,S.accept||S.Accept||(S.Accept="application/json"),v!=="GET"&&v!=="HEAD"&&(S["content-type"]||S["Content-Type"]||(S["Content-Type"]="application/json"),_=JSON.stringify(n.json===!0?_:n.json))),f.onreadystatechange=r,f.onload=h,f.onerror=u,f.onprogress=function(){},f.onabort=function(){m=!0},f.ontimeout=u,f.open(v,g,!E,n.username,n.password),E||(f.withCredentials=!!n.withCredentials),!E&&n.timeout>0&&(C=setTimeout(function(){if(!m){m=!0,f.abort("timeout");var b=new Error("XMLHttpRequest timeout");b.code="ETIMEDOUT",u(b)}},n.timeout)),f.setRequestHeader)for(d in S)S.hasOwnProperty(d)&&f.setRequestHeader(d,S[d]);else if(n.headers&&!$ee(n.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in n&&(f.responseType=n.responseType),"beforeSend"in n&&typeof n.beforeSend=="function"&&n.beforeSend(f),f.send(_||null),f}function zee(n){try{if(n.responseType==="document")return n.responseXML;var e=n.responseXML&&n.responseXML.documentElement.nodeName==="parsererror";if(n.responseType===""&&!e)return n.responseXML}catch{}return null}function Yee(){}var A_={},Xee={get exports(){return A_},set exports(n){A_=n}},$U=mn,vP=Object.create||function(){function n(){}return function(e){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return n.prototype=e,new n}}();function Ba(n,e){this.name="ParsingError",this.code=n.code,this.message=e||n.message}Ba.prototype=vP(Error.prototype);Ba.prototype.constructor=Ba;Ba.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function yP(n){function e(r,o,u,h){return(r|0)*3600+(o|0)*60+(u|0)+(h|0)/1e3}var t=n.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return t?t[3]?e(t[1],t[2],t[3].replace(":",""),t[4]):t[1]>59?e(t[1],t[2],0,t[4]):e(0,t[1],t[2],t[4]):null}function mm(){this.values=vP(null)}mm.prototype={set:function(n,e){!this.get(n)&&e!==""&&(this.values[n]=e)},get:function(n,e,t){return t?this.has(n)?this.values[n]:e[t]:this.has(n)?this.values[n]:e},has:function(n){return n in this.values},alt:function(n,e,t){for(var r=0;r<t.length;++r)if(e===t[r]){this.set(n,e);break}},integer:function(n,e){/^-?\d+$/.test(e)&&this.set(n,parseInt(e,10))},percent:function(n,e){return e.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(e=parseFloat(e),e>=0&&e<=100)?(this.set(n,e),!0):!1}};function tm(n,e,t,r){var o=r?n.split(r):[n];for(var u in o)if(typeof o[u]=="string"){var h=o[u].split(t);if(h.length===2){var f=h[0].trim(),d=h[1].trim();e(f,d)}}}function qee(n,e,t){var r=n;function o(){var f=yP(n);if(f===null)throw new Ba(Ba.Errors.BadTimeStamp,"Malformed timestamp: "+r);return n=n.replace(/^[^\sa-zA-Z-]+/,""),f}function u(f,d){var m=new mm;tm(f,function(g,v){switch(g){case"region":for(var _=t.length-1;_>=0;_--)if(t[_].id===v){m.set(g,t[_].region);break}break;case"vertical":m.alt(g,v,["rl","lr"]);break;case"line":var S=v.split(","),E=S[0];m.integer(g,E),m.percent(g,E)&&m.set("snapToLines",!1),m.alt(g,E,["auto"]),S.length===2&&m.alt("lineAlign",S[1],["start","center","end"]);break;case"position":S=v.split(","),m.percent(g,S[0]),S.length===2&&m.alt("positionAlign",S[1],["start","center","end"]);break;case"size":m.percent(g,v);break;case"align":m.alt(g,v,["start","center","end","left","right"]);break}},/:/,/\s/),d.region=m.get("region",null),d.vertical=m.get("vertical","");try{d.line=m.get("line","auto")}catch{}d.lineAlign=m.get("lineAlign","start"),d.snapToLines=m.get("snapToLines",!0),d.size=m.get("size",100);try{d.align=m.get("align","center")}catch{d.align=m.get("align","middle")}try{d.position=m.get("position","auto")}catch{d.position=m.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},d.align)}d.positionAlign=m.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},d.align)}function h(){n=n.replace(/^\s+/,"")}if(h(),e.startTime=o(),h(),n.substr(0,3)!=="-->")throw new Ba(Ba.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+r);n=n.substr(3),h(),e.endTime=o(),h(),u(n,e)}var eI=$U.createElement&&$U.createElement("textarea"),Qee={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},zU={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},Jee={v:"title",lang:"lang"},YU={rt:"ruby"};function s6(n,e){function t(){if(!e)return null;function E(C){return e=e.substr(C.length),C}var T=e.match(/^([^<]*)(<[^>]*>?)?/);return E(T[1]?T[1]:T[2])}function r(E){return eI.innerHTML=E,E=eI.textContent,eI.textContent="",E}function o(E,T){return!YU[T.localName]||YU[T.localName]===E.localName}function u(E,T){var C=Qee[E];if(!C)return null;var R=n.document.createElement(C),b=Jee[E];return b&&T&&(R[b]=T.trim()),R}for(var h=n.document.createElement("div"),f=h,d,m=[];(d=t())!==null;){if(d[0]==="<"){if(d[1]==="/"){m.length&&m[m.length-1]===d.substr(2).replace(">","")&&(m.pop(),f=f.parentNode);continue}var g=yP(d.substr(1,d.length-2)),v;if(g){v=n.document.createProcessingInstruction("timestamp",g),f.appendChild(v);continue}var _=d.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!_||(v=u(_[1],_[3]),!v)||!o(f,v))continue;if(_[2]){var S=_[2].split(".");S.forEach(function(E){var T=/^bg_/.test(E),C=T?E.slice(3):E;if(zU.hasOwnProperty(C)){var R=T?"background-color":"color",b=zU[C];v.style[R]=b}}),v.className=S.join(" ")}m.push(_[1]),f.appendChild(v),f=v;continue}f.appendChild(n.document.createTextNode(r(d)))}return h}var XU=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function Zee(n){for(var e=0;e<XU.length;e++){var t=XU[e];if(n>=t[0]&&n<=t[1])return!0}return!1}function ete(n){var e=[],t="",r;if(!n||!n.childNodes)return"ltr";function o(f,d){for(var m=d.childNodes.length-1;m>=0;m--)f.push(d.childNodes[m])}function u(f){if(!f||!f.length)return null;var d=f.pop(),m=d.textContent||d.innerText;if(m){var g=m.match(/^.*(\n|\r)/);return g?(f.length=0,g[0]):m}if(d.tagName==="ruby")return u(f);if(d.childNodes)return o(f,d),u(f)}for(o(e,n);t=u(e);)for(var h=0;h<t.length;h++)if(r=t.charCodeAt(h),Zee(r))return"rtl";return"ltr"}function tte(n){if(typeof n.line=="number"&&(n.snapToLines||n.line>=0&&n.line<=100))return n.line;if(!n.track||!n.track.textTrackList||!n.track.textTrackList.mediaElement)return-1;for(var e=n.track,t=e.textTrackList,r=0,o=0;o<t.length&&t[o]!==e;o++)t[o].mode==="showing"&&r++;return++r*-1}function UT(){}UT.prototype.applyStyles=function(n,e){e=e||this.div;for(var t in n)n.hasOwnProperty(t)&&(e.style[t]=n[t])};UT.prototype.formatStyle=function(n,e){return n===0?0:n+e};function x_(n,e,t){UT.call(this),this.cue=e,this.cueDiv=s6(n,e.text);var r={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:e.vertical===""?"horizontal-tb":e.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(r,this.cueDiv),this.div=n.document.createElement("div"),r={direction:ete(this.cueDiv),writingMode:e.vertical===""?"horizontal-tb":e.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:e.align==="middle"?"center":e.align,font:t.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(r),this.div.appendChild(this.cueDiv);var o=0;switch(e.positionAlign){case"start":o=e.position;break;case"center":o=e.position-e.size/2;break;case"end":o=e.position-e.size;break}e.vertical===""?this.applyStyles({left:this.formatStyle(o,"%"),width:this.formatStyle(e.size,"%")}):this.applyStyles({top:this.formatStyle(o,"%"),height:this.formatStyle(e.size,"%")}),this.move=function(u){this.applyStyles({top:this.formatStyle(u.top,"px"),bottom:this.formatStyle(u.bottom,"px"),left:this.formatStyle(u.left,"px"),right:this.formatStyle(u.right,"px"),height:this.formatStyle(u.height,"px"),width:this.formatStyle(u.width,"px")})}}x_.prototype=vP(UT.prototype);x_.prototype.constructor=x_;function js(n){var e,t,r,o;if(n.div){t=n.div.offsetHeight,r=n.div.offsetWidth,o=n.div.offsetTop;var u=(u=n.div.childNodes)&&(u=u[0])&&u.getClientRects&&u.getClientRects();n=n.div.getBoundingClientRect(),e=u?Math.max(u[0]&&u[0].height||0,n.height/u.length):0}this.left=n.left,this.right=n.right,this.top=n.top||o,this.height=n.height||t,this.bottom=n.bottom||o+(n.height||t),this.width=n.width||r,this.lineHeight=e!==void 0?e:n.lineHeight}js.prototype.move=function(n,e){switch(e=e!==void 0?e:this.lineHeight,n){case"+x":this.left+=e,this.right+=e;break;case"-x":this.left-=e,this.right-=e;break;case"+y":this.top+=e,this.bottom+=e;break;case"-y":this.top-=e,this.bottom-=e;break}};js.prototype.overlaps=function(n){return this.left<n.right&&this.right>n.left&&this.top<n.bottom&&this.bottom>n.top};js.prototype.overlapsAny=function(n){for(var e=0;e<n.length;e++)if(this.overlaps(n[e]))return!0;return!1};js.prototype.within=function(n){return this.top>=n.top&&this.bottom<=n.bottom&&this.left>=n.left&&this.right<=n.right};js.prototype.overlapsOppositeAxis=function(n,e){switch(e){case"+x":return this.left<n.left;case"-x":return this.right>n.right;case"+y":return this.top<n.top;case"-y":return this.bottom>n.bottom}};js.prototype.intersectPercentage=function(n){var e=Math.max(0,Math.min(this.right,n.right)-Math.max(this.left,n.left)),t=Math.max(0,Math.min(this.bottom,n.bottom)-Math.max(this.top,n.top)),r=e*t;return r/(this.height*this.width)};js.prototype.toCSSCompatValues=function(n){return{top:this.top-n.top,bottom:n.bottom-this.bottom,left:this.left-n.left,right:n.right-this.right,height:this.height,width:this.width}};js.getSimpleBoxPosition=function(n){var e=n.div?n.div.offsetHeight:n.tagName?n.offsetHeight:0,t=n.div?n.div.offsetWidth:n.tagName?n.offsetWidth:0,r=n.div?n.div.offsetTop:n.tagName?n.offsetTop:0;n=n.div?n.div.getBoundingClientRect():n.tagName?n.getBoundingClientRect():n;var o={left:n.left,right:n.right,top:n.top||r,height:n.height||e,bottom:n.bottom||r+(n.height||e),width:n.width||t};return o};function nte(n,e,t,r){function o(C,R){for(var b,F=new js(C),O=1,L=0;L<R.length;L++){for(;C.overlapsOppositeAxis(t,R[L])||C.within(t)&&C.overlapsAny(r);)C.move(R[L]);if(C.within(t))return C;var D=C.intersectPercentage(t);O>D&&(b=new js(C),O=D),C=new js(F)}return b||F}var u=new js(e),h=e.cue,f=tte(h),d=[];if(h.snapToLines){var m;switch(h.vertical){case"":d=["+y","-y"],m="height";break;case"rl":d=["+x","-x"],m="width";break;case"lr":d=["-x","+x"],m="width";break}var g=u.lineHeight,v=g*Math.round(f),_=t[m]+g,S=d[0];Math.abs(v)>_&&(v=v<0?-1:1,v*=Math.ceil(_/g)*g),f<0&&(v+=h.vertical===""?t.height:t.width,d=d.reverse()),u.move(S,v)}else{var E=u.lineHeight/t.height*100;switch(h.lineAlign){case"center":f-=E/2;break;case"end":f-=E;break}switch(h.vertical){case"":e.applyStyles({top:e.formatStyle(f,"%")});break;case"rl":e.applyStyles({left:e.formatStyle(f,"%")});break;case"lr":e.applyStyles({right:e.formatStyle(f,"%")});break}d=["+y","-x","+x","-y"],u=new js(e)}var T=o(u,d);e.move(T.toCSSCompatValues(t))}function mp(){}mp.StringDecoder=function(){return{decode:function(n){if(!n)return"";if(typeof n!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(n))}}};mp.convertCueToDOMTree=function(n,e){return!n||!e?null:s6(n,e)};var rte=.05,ite="sans-serif",ste="1.5%";mp.processCues=function(n,e,t){if(!n||!e||!t)return null;for(;t.firstChild;)t.removeChild(t.firstChild);var r=n.document.createElement("div");r.style.position="absolute",r.style.left="0",r.style.right="0",r.style.top="0",r.style.bottom="0",r.style.margin=ste,t.appendChild(r);function o(g){for(var v=0;v<g.length;v++)if(g[v].hasBeenReset||!g[v].displayState)return!0;return!1}if(!o(e)){for(var u=0;u<e.length;u++)r.appendChild(e[u].displayState);return}var h=[],f=js.getSimpleBoxPosition(r),d=Math.round(f.height*rte*100)/100,m={font:d+"px "+ite};(function(){for(var g,v,_=0;_<e.length;_++)v=e[_],g=new x_(n,v,m),r.appendChild(g.div),nte(n,g,f,h),v.displayState=g.div,h.push(js.getSimpleBoxPosition(g))})()};mp.Parser=function(n,e,t){t||(t=e,e={}),e||(e={}),this.window=n,this.vttjs=e,this.state="INITIAL",this.buffer="",this.decoder=t||new TextDecoder("utf8"),this.regionList=[]};mp.Parser.prototype={reportOrThrowError:function(n){if(n instanceof Ba)this.onparsingerror&&this.onparsingerror(n);else throw n},parse:function(n){var e=this;n&&(e.buffer+=e.decoder.decode(n,{stream:!0}));function t(){for(var g=e.buffer,v=0;v<g.length&&g[v]!=="\r"&&g[v]!==`
`;)++v;var _=g.substr(0,v);return g[v]==="\r"&&++v,g[v]===`
`&&++v,e.buffer=g.substr(v),_}function r(g){var v=new mm;if(tm(g,function(S,E){switch(S){case"id":v.set(S,E);break;case"width":v.percent(S,E);break;case"lines":v.integer(S,E);break;case"regionanchor":case"viewportanchor":var T=E.split(",");if(T.length!==2)break;var C=new mm;if(C.percent("x",T[0]),C.percent("y",T[1]),!C.has("x")||!C.has("y"))break;v.set(S+"X",C.get("x")),v.set(S+"Y",C.get("y"));break;case"scroll":v.alt(S,E,["up"]);break}},/=/,/\s/),v.has("id")){var _=new(e.vttjs.VTTRegion||e.window.VTTRegion);_.width=v.get("width",100),_.lines=v.get("lines",3),_.regionAnchorX=v.get("regionanchorX",0),_.regionAnchorY=v.get("regionanchorY",100),_.viewportAnchorX=v.get("viewportanchorX",0),_.viewportAnchorY=v.get("viewportanchorY",100),_.scroll=v.get("scroll",""),e.onregion&&e.onregion(_),e.regionList.push({id:v.get("id"),region:_})}}function o(g){var v=new mm;tm(g,function(_,S){switch(_){case"MPEGT":v.integer(_+"S",S);break;case"LOCA":v.set(_+"L",yP(S));break}},/[^\d]:/,/,/),e.ontimestampmap&&e.ontimestampmap({MPEGTS:v.get("MPEGTS"),LOCAL:v.get("LOCAL")})}function u(g){g.match(/X-TIMESTAMP-MAP/)?tm(g,function(v,_){switch(v){case"X-TIMESTAMP-MAP":o(_);break}},/=/):tm(g,function(v,_){switch(v){case"Region":r(_);break}},/:/)}try{var h;if(e.state==="INITIAL"){if(!/\r\n|\n/.test(e.buffer))return this;h=t();var f=h.match(/^WEBVTT([ \t].*)?$/);if(!f||!f[0])throw new Ba(Ba.Errors.BadSignature);e.state="HEADER"}for(var d=!1;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(d?d=!1:h=t(),e.state){case"HEADER":/:/.test(h)?u(h):h||(e.state="ID");continue;case"NOTE":h||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(h)){e.state="NOTE";break}if(!h)continue;e.cue=new(e.vttjs.VTTCue||e.window.VTTCue)(0,0,"");try{e.cue.align="center"}catch{e.cue.align="middle"}if(e.state="CUE",h.indexOf("-->")===-1){e.cue.id=h;continue}case"CUE":try{qee(h,e.cue,e.regionList)}catch(g){e.reportOrThrowError(g),e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":var m=h.indexOf("-->")!==-1;if(!h||m&&(d=!0)){e.oncue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}e.cue.text&&(e.cue.text+=`
`),e.cue.text+=h.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":h||(e.state="ID");continue}}}catch(g){e.reportOrThrowError(g),e.state==="CUETEXT"&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state=e.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var n=this;try{if(n.buffer+=n.decoder.decode(),(n.cue||n.state==="HEADER")&&(n.buffer+=`

`,n.parse()),n.state==="INITIAL")throw new Ba(Ba.Errors.BadSignature)}catch(e){n.reportOrThrowError(e)}return n.onflush&&n.onflush(),this}};var ate=mp,ote="auto",lte={"":1,lr:1,rl:1},ute={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function cte(n){if(typeof n!="string")return!1;var e=lte[n.toLowerCase()];return e?n.toLowerCase():!1}function tI(n){if(typeof n!="string")return!1;var e=ute[n.toLowerCase()];return e?n.toLowerCase():!1}function a6(n,e,t){this.hasBeenReset=!1;var r="",o=!1,u=n,h=e,f=t,d=null,m="",g=!0,v="auto",_="start",S="auto",E="auto",T=100,C="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return r},set:function(R){r=""+R}},pauseOnExit:{enumerable:!0,get:function(){return o},set:function(R){o=!!R}},startTime:{enumerable:!0,get:function(){return u},set:function(R){if(typeof R!="number")throw new TypeError("Start time must be set to a number.");u=R,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return h},set:function(R){if(typeof R!="number")throw new TypeError("End time must be set to a number.");h=R,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return f},set:function(R){f=""+R,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return d},set:function(R){d=R,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return m},set:function(R){var b=cte(R);if(b===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");m=b,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return g},set:function(R){g=!!R,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return v},set:function(R){if(typeof R!="number"&&R!==ote)throw new SyntaxError("Line: an invalid number or illegal string was specified.");v=R,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return _},set:function(R){var b=tI(R);b?(_=b,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return S},set:function(R){if(R<0||R>100)throw new Error("Position must be between 0 and 100.");S=R,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return E},set:function(R){var b=tI(R);b?(E=b,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return T},set:function(R){if(R<0||R>100)throw new Error("Size must be between 0 and 100.");T=R,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return C},set:function(R){var b=tI(R);if(!b)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");C=b,this.hasBeenReset=!0}}}),this.displayState=void 0}a6.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var fte=a6,dte={"":!0,up:!0};function hte(n){if(typeof n!="string")return!1;var e=dte[n.toLowerCase()];return e?n.toLowerCase():!1}function kg(n){return typeof n=="number"&&n>=0&&n<=100}function pte(){var n=100,e=3,t=0,r=100,o=0,u=100,h="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return n},set:function(f){if(!kg(f))throw new Error("Width must be between 0 and 100.");n=f}},lines:{enumerable:!0,get:function(){return e},set:function(f){if(typeof f!="number")throw new TypeError("Lines must be set to a number.");e=f}},regionAnchorY:{enumerable:!0,get:function(){return r},set:function(f){if(!kg(f))throw new Error("RegionAnchorX must be between 0 and 100.");r=f}},regionAnchorX:{enumerable:!0,get:function(){return t},set:function(f){if(!kg(f))throw new Error("RegionAnchorY must be between 0 and 100.");t=f}},viewportAnchorY:{enumerable:!0,get:function(){return u},set:function(f){if(!kg(f))throw new Error("ViewportAnchorY must be between 0 and 100.");u=f}},viewportAnchorX:{enumerable:!0,get:function(){return o},set:function(f){if(!kg(f))throw new Error("ViewportAnchorX must be between 0 and 100.");o=f}},scroll:{enumerable:!0,get:function(){return h},set:function(f){var d=hte(f);d===!1?console.warn("Scroll: an invalid or illegal string was specified."):h=d}}})}var gte=pte,Ou=rt,ad=Xee.exports={WebVTT:ate,VTTCue:fte,VTTRegion:gte};Ou.vttjs=ad;Ou.WebVTT=ad.WebVTT;var mte=ad.VTTCue,vte=ad.VTTRegion,yte=Ou.VTTCue,Ete=Ou.VTTRegion;ad.shim=function(){Ou.VTTCue=mte,Ou.VTTRegion=vte};ad.restore=function(){Ou.VTTCue=yte,Ou.VTTRegion=Ete};Ou.VTTCue||ad.shim();var sb={},_te={get exports(){return sb},set exports(n){sb=n}};(function(n,e){(function(t){var r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,o=/^(?=([^\/?#]*))\1([^]*)$/,u=/(?:\/|^)\.(?=\/)/g,h=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,f={buildAbsoluteURL:function(d,m,g){if(g=g||{},d=d.trim(),m=m.trim(),!m){if(!g.alwaysNormalize)return d;var v=f.parseURL(d);if(!v)throw new Error("Error trying to parse base URL.");return v.path=f.normalizePath(v.path),f.buildURLFromParts(v)}var _=f.parseURL(m);if(!_)throw new Error("Error trying to parse relative URL.");if(_.scheme)return g.alwaysNormalize?(_.path=f.normalizePath(_.path),f.buildURLFromParts(_)):m;var S=f.parseURL(d);if(!S)throw new Error("Error trying to parse base URL.");if(!S.netLoc&&S.path&&S.path[0]!=="/"){var E=o.exec(S.path);S.netLoc=E[1],S.path=E[2]}S.netLoc&&!S.path&&(S.path="/");var T={scheme:S.scheme,netLoc:_.netLoc,path:null,params:_.params,query:_.query,fragment:_.fragment};if(!_.netLoc&&(T.netLoc=S.netLoc,_.path[0]!=="/"))if(!_.path)T.path=S.path,_.params||(T.params=S.params,_.query||(T.query=S.query));else{var C=S.path,R=C.substring(0,C.lastIndexOf("/")+1)+_.path;T.path=f.normalizePath(R)}return T.path===null&&(T.path=g.alwaysNormalize?f.normalizePath(_.path):_.path),f.buildURLFromParts(T)},parseURL:function(d){var m=r.exec(d);return m?{scheme:m[1]||"",netLoc:m[2]||"",path:m[3]||"",params:m[4]||"",query:m[5]||"",fragment:m[6]||""}:null},normalizePath:function(d){for(d=d.split("").reverse().join("").replace(u,"");d.length!==(d=d.replace(h,"")).length;);return d.split("").reverse().join("")},buildURLFromParts:function(d){return d.scheme+d.netLoc+d.path+d.params+d.query+d.fragment}};n.exports=f})()})(_te);const C_=sb;var qU="http://example.com",Tte=function(e,t){if(/^[a-z]+:/i.test(t))return t;/^data:/.test(e)&&(e=rt.location&&rt.location.href||"");var r=typeof rt.URL=="function",o=/^\/\//.test(e),u=!rt.location&&!/\/\//i.test(e);if(r?e=new rt.URL(e,rt.location||qU):/\/\//i.test(e)||(e=C_.buildAbsoluteURL(rt.location&&rt.location.href||"",e)),r){var h=new URL(t,e);return u?h.href.slice(qU.length):o?h.href.slice(h.protocol.length):h.href}return C_.buildAbsoluteURL(e,t)},EP=function(){function n(){this.listeners={}}var e=n.prototype;return e.on=function(r,o){this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push(o)},e.off=function(r,o){if(!this.listeners[r])return!1;var u=this.listeners[r].indexOf(o);return this.listeners[r]=this.listeners[r].slice(0),this.listeners[r].splice(u,1),u>-1},e.trigger=function(r){var o=this.listeners[r];if(o)if(arguments.length===2)for(var u=o.length,h=0;h<u;++h)o[h].call(this,arguments[1]);else for(var f=Array.prototype.slice.call(arguments,1),d=o.length,m=0;m<d;++m)o[m].apply(this,f)},e.dispose=function(){this.listeners={}},e.pipe=function(r){this.on("data",function(o){r.push(o)})},n}(),Ste=function(e){return rt.atob?rt.atob(e):Buffer.from(e,"base64").toString("binary")};function Ate(n){for(var e=Ste(n),t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}/*! @name m3u8-parser @version 6.0.0 @license Apache-2.0 */class xte extends EP{constructor(){super(),this.buffer=""}push(e){let t;for(this.buffer+=e,t=this.buffer.indexOf(`
`);t>-1;t=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)}}const Cte=String.fromCharCode(9),nI=function(n){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(n||""),t={};return e[1]&&(t.length=parseInt(e[1],10)),e[2]&&(t.offset=parseInt(e[2],10)),t},Ite=function(){const n="[^=]*",e='"[^"]*"|[^,]*',t="(?:"+n+")=(?:"+e+")";return new RegExp("(?:^|,)("+t+")")},No=function(n){const e={};if(!n)return e;const t=n.split(Ite());let r=t.length,o;for(;r--;)t[r]!==""&&(o=/([^=]*)=(.*)/.exec(t[r]).slice(1),o[0]=o[0].replace(/^\s+|\s+$/g,""),o[1]=o[1].replace(/^\s+|\s+$/g,""),o[1]=o[1].replace(/^['"](.*)['"]$/g,"$1"),e[o[0]]=o[1]);return e};class Rte extends EP{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(e){let t,r;if(e=e.trim(),e.length===0)return;if(e[0]!=="#"){this.trigger("data",{type:"uri",uri:e});return}this.tagMappers.reduce((u,h)=>{const f=h(e);return f===e?u:u.concat([f])},[e]).forEach(u=>{for(let h=0;h<this.customParsers.length;h++)if(this.customParsers[h].call(this,u))return;if(u.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:u.slice(1)});return}if(u=u.replace("\r",""),t=/^#EXTM3U/.exec(u),t){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(t=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(u),t){r={type:"tag",tagType:"inf"},t[1]&&(r.duration=parseFloat(t[1])),t[2]&&(r.title=t[2]),this.trigger("data",r);return}if(t=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(u),t){r={type:"tag",tagType:"targetduration"},t[1]&&(r.duration=parseInt(t[1],10)),this.trigger("data",r);return}if(t=/^#EXT-X-VERSION:([0-9.]*)?/.exec(u),t){r={type:"tag",tagType:"version"},t[1]&&(r.version=parseInt(t[1],10)),this.trigger("data",r);return}if(t=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(u),t){r={type:"tag",tagType:"media-sequence"},t[1]&&(r.number=parseInt(t[1],10)),this.trigger("data",r);return}if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(u),t){r={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(r.number=parseInt(t[1],10)),this.trigger("data",r);return}if(t=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(u),t){r={type:"tag",tagType:"playlist-type"},t[1]&&(r.playlistType=t[1]),this.trigger("data",r);return}if(t=/^#EXT-X-BYTERANGE:(.*)?$/.exec(u),t){r=qo(nI(t[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",r);return}if(t=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(u),t){r={type:"tag",tagType:"allow-cache"},t[1]&&(r.allowed=!/NO/.test(t[1])),this.trigger("data",r);return}if(t=/^#EXT-X-MAP:(.*)$/.exec(u),t){if(r={type:"tag",tagType:"map"},t[1]){const h=No(t[1]);h.URI&&(r.uri=h.URI),h.BYTERANGE&&(r.byterange=nI(h.BYTERANGE))}this.trigger("data",r);return}if(t=/^#EXT-X-STREAM-INF:(.*)$/.exec(u),t){if(r={type:"tag",tagType:"stream-inf"},t[1]){if(r.attributes=No(t[1]),r.attributes.RESOLUTION){const h=r.attributes.RESOLUTION.split("x"),f={};h[0]&&(f.width=parseInt(h[0],10)),h[1]&&(f.height=parseInt(h[1],10)),r.attributes.RESOLUTION=f}r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes["FRAME-RATE"]&&(r.attributes["FRAME-RATE"]=parseFloat(r.attributes["FRAME-RATE"])),r.attributes["PROGRAM-ID"]&&(r.attributes["PROGRAM-ID"]=parseInt(r.attributes["PROGRAM-ID"],10))}this.trigger("data",r);return}if(t=/^#EXT-X-MEDIA:(.*)$/.exec(u),t){r={type:"tag",tagType:"media"},t[1]&&(r.attributes=No(t[1])),this.trigger("data",r);return}if(t=/^#EXT-X-ENDLIST/.exec(u),t){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(t=/^#EXT-X-DISCONTINUITY/.exec(u),t){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(t=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(u),t){r={type:"tag",tagType:"program-date-time"},t[1]&&(r.dateTimeString=t[1],r.dateTimeObject=new Date(t[1])),this.trigger("data",r);return}if(t=/^#EXT-X-KEY:(.*)$/.exec(u),t){r={type:"tag",tagType:"key"},t[1]&&(r.attributes=No(t[1]),r.attributes.IV&&(r.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(r.attributes.IV=r.attributes.IV.substring(2)),r.attributes.IV=r.attributes.IV.match(/.{8}/g),r.attributes.IV[0]=parseInt(r.attributes.IV[0],16),r.attributes.IV[1]=parseInt(r.attributes.IV[1],16),r.attributes.IV[2]=parseInt(r.attributes.IV[2],16),r.attributes.IV[3]=parseInt(r.attributes.IV[3],16),r.attributes.IV=new Uint32Array(r.attributes.IV))),this.trigger("data",r);return}if(t=/^#EXT-X-START:(.*)$/.exec(u),t){r={type:"tag",tagType:"start"},t[1]&&(r.attributes=No(t[1]),r.attributes["TIME-OFFSET"]=parseFloat(r.attributes["TIME-OFFSET"]),r.attributes.PRECISE=/YES/.test(r.attributes.PRECISE)),this.trigger("data",r);return}if(t=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(u),t){r={type:"tag",tagType:"cue-out-cont"},t[1]?r.data=t[1]:r.data="",this.trigger("data",r);return}if(t=/^#EXT-X-CUE-OUT:(.*)?$/.exec(u),t){r={type:"tag",tagType:"cue-out"},t[1]?r.data=t[1]:r.data="",this.trigger("data",r);return}if(t=/^#EXT-X-CUE-IN:(.*)?$/.exec(u),t){r={type:"tag",tagType:"cue-in"},t[1]?r.data=t[1]:r.data="",this.trigger("data",r);return}if(t=/^#EXT-X-SKIP:(.*)$/.exec(u),t&&t[1]){r={type:"tag",tagType:"skip"},r.attributes=No(t[1]),r.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(r.attributes["SKIPPED-SEGMENTS"]=parseInt(r.attributes["SKIPPED-SEGMENTS"],10)),r.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(r.attributes["RECENTLY-REMOVED-DATERANGES"]=r.attributes["RECENTLY-REMOVED-DATERANGES"].split(Cte)),this.trigger("data",r);return}if(t=/^#EXT-X-PART:(.*)$/.exec(u),t&&t[1]){r={type:"tag",tagType:"part"},r.attributes=No(t[1]),["DURATION"].forEach(function(h){r.attributes.hasOwnProperty(h)&&(r.attributes[h]=parseFloat(r.attributes[h]))}),["INDEPENDENT","GAP"].forEach(function(h){r.attributes.hasOwnProperty(h)&&(r.attributes[h]=/YES/.test(r.attributes[h]))}),r.attributes.hasOwnProperty("BYTERANGE")&&(r.attributes.byterange=nI(r.attributes.BYTERANGE)),this.trigger("data",r);return}if(t=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(u),t&&t[1]){r={type:"tag",tagType:"server-control"},r.attributes=No(t[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(h){r.attributes.hasOwnProperty(h)&&(r.attributes[h]=parseFloat(r.attributes[h]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(h){r.attributes.hasOwnProperty(h)&&(r.attributes[h]=/YES/.test(r.attributes[h]))}),this.trigger("data",r);return}if(t=/^#EXT-X-PART-INF:(.*)$/.exec(u),t&&t[1]){r={type:"tag",tagType:"part-inf"},r.attributes=No(t[1]),["PART-TARGET"].forEach(function(h){r.attributes.hasOwnProperty(h)&&(r.attributes[h]=parseFloat(r.attributes[h]))}),this.trigger("data",r);return}if(t=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(u),t&&t[1]){r={type:"tag",tagType:"preload-hint"},r.attributes=No(t[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(h){if(r.attributes.hasOwnProperty(h)){r.attributes[h]=parseInt(r.attributes[h],10);const f=h==="BYTERANGE-LENGTH"?"length":"offset";r.attributes.byterange=r.attributes.byterange||{},r.attributes.byterange[f]=r.attributes[h],delete r.attributes[h]}}),this.trigger("data",r);return}if(t=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(u),t&&t[1]){r={type:"tag",tagType:"rendition-report"},r.attributes=No(t[1]),["LAST-MSN","LAST-PART"].forEach(function(h){r.attributes.hasOwnProperty(h)&&(r.attributes[h]=parseInt(r.attributes[h],10))}),this.trigger("data",r);return}this.trigger("data",{type:"tag",data:u.slice(4)})})}addParser({expression:e,customType:t,dataParser:r,segment:o}){typeof r!="function"&&(r=u=>u),this.customParsers.push(u=>{if(e.exec(u))return this.trigger("data",{type:"custom",data:r(u),customType:t,segment:o}),!0})}addTagMapper({expression:e,map:t}){const r=o=>e.test(o)?t(o):o;this.tagMappers.push(r)}}const bte=n=>n.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()),Yd=function(n){const e={};return Object.keys(n).forEach(function(t){e[bte(t)]=n[t]}),e},rI=function(n){const{serverControl:e,targetDuration:t,partTargetDuration:r}=n;if(!e)return;const o="#EXT-X-SERVER-CONTROL",u="holdBack",h="partHoldBack",f=t&&t*3,d=r&&r*2;t&&!e.hasOwnProperty(u)&&(e[u]=f,this.trigger("info",{message:`${o} defaulting HOLD-BACK to targetDuration * 3 (${f}).`})),f&&e[u]<f&&(this.trigger("warn",{message:`${o} clamping HOLD-BACK (${e[u]}) to targetDuration * 3 (${f})`}),e[u]=f),r&&!e.hasOwnProperty(h)&&(e[h]=r*3,this.trigger("info",{message:`${o} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[h]}).`})),r&&e[h]<d&&(this.trigger("warn",{message:`${o} clamping PART-HOLD-BACK (${e[h]}) to partTargetDuration * 2 (${d}).`}),e[h]=d)};class Dte extends EP{constructor(){super(),this.lineStream=new xte,this.parseStream=new Rte,this.lineStream.pipe(this.parseStream);const e=this,t=[];let r={},o,u,h=!1;const f=function(){},d={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},m="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let g=0;this.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};let v=0,_=0;this.on("end",()=>{r.uri||!r.parts&&!r.preloadHints||(!r.map&&o&&(r.map=o),!r.key&&u&&(r.key=u),!r.timeline&&typeof g=="number"&&(r.timeline=g),this.manifest.preloadSegment=r)}),this.parseStream.on("data",function(S){let E,T;({tag(){({version(){S.version&&(this.manifest.version=S.version)},"allow-cache"(){this.manifest.allowCache=S.allowed,"allowed"in S||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const C={};"length"in S&&(r.byterange=C,C.length=S.length,"offset"in S||(S.offset=v)),"offset"in S&&(r.byterange=C,C.offset=S.offset),v=C.offset+C.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),S.duration>0&&(r.duration=S.duration),S.duration===0&&(r.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=t},key(){if(!S.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(S.attributes.METHOD==="NONE"){u=null;return}if(!S.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(S.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:S.attributes};return}if(S.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:S.attributes.URI};return}if(S.attributes.KEYFORMAT===m){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(S.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(S.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),S.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(S.attributes.KEYID&&S.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:S.attributes.KEYFORMAT,keyId:S.attributes.KEYID.substring(2)},pssh:Ate(S.attributes.URI.split(",")[1])};return}S.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),u={method:S.attributes.METHOD||"AES-128",uri:S.attributes.URI},typeof S.attributes.IV<"u"&&(u.iv=S.attributes.IV)},"media-sequence"(){if(!isFinite(S.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+S.number});return}this.manifest.mediaSequence=S.number},"discontinuity-sequence"(){if(!isFinite(S.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+S.number});return}this.manifest.discontinuitySequence=S.number,g=S.number},"playlist-type"(){if(!/VOD|EVENT/.test(S.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+S.playlist});return}this.manifest.playlistType=S.playlistType},map(){o={},S.uri&&(o.uri=S.uri),S.byterange&&(o.byterange=S.byterange),u&&(o.key=u)},"stream-inf"(){if(this.manifest.playlists=t,this.manifest.mediaGroups=this.manifest.mediaGroups||d,!S.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}r.attributes||(r.attributes={}),qo(r.attributes,S.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||d,!(S.attributes&&S.attributes.TYPE&&S.attributes["GROUP-ID"]&&S.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const C=this.manifest.mediaGroups[S.attributes.TYPE];C[S.attributes["GROUP-ID"]]=C[S.attributes["GROUP-ID"]]||{},E=C[S.attributes["GROUP-ID"]],T={default:/yes/i.test(S.attributes.DEFAULT)},T.default?T.autoselect=!0:T.autoselect=/yes/i.test(S.attributes.AUTOSELECT),S.attributes.LANGUAGE&&(T.language=S.attributes.LANGUAGE),S.attributes.URI&&(T.uri=S.attributes.URI),S.attributes["INSTREAM-ID"]&&(T.instreamId=S.attributes["INSTREAM-ID"]),S.attributes.CHARACTERISTICS&&(T.characteristics=S.attributes.CHARACTERISTICS),S.attributes.FORCED&&(T.forced=/yes/i.test(S.attributes.FORCED)),E[S.attributes.NAME]=T},discontinuity(){g+=1,r.discontinuity=!0,this.manifest.discontinuityStarts.push(t.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=S.dateTimeString,this.manifest.dateTimeObject=S.dateTimeObject),r.dateTimeString=S.dateTimeString,r.dateTimeObject=S.dateTimeObject},targetduration(){if(!isFinite(S.duration)||S.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+S.duration});return}this.manifest.targetDuration=S.duration,rI.call(this,this.manifest)},start(){if(!S.attributes||isNaN(S.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:S.attributes["TIME-OFFSET"],precise:S.attributes.PRECISE}},"cue-out"(){r.cueOut=S.data},"cue-out-cont"(){r.cueOutCont=S.data},"cue-in"(){r.cueIn=S.data},skip(){this.manifest.skip=Yd(S.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",S.attributes,["SKIPPED-SEGMENTS"])},part(){h=!0;const C=this.manifest.segments.length,R=Yd(S.attributes);r.parts=r.parts||[],r.parts.push(R),R.byterange&&(R.byterange.hasOwnProperty("offset")||(R.byterange.offset=_),_=R.byterange.offset+R.byterange.length);const b=r.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${b} for segment #${C}`,S.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((F,O)=>{F.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${O} lacks required attribute(s): LAST-PART`})})},"server-control"(){const C=this.manifest.serverControl=Yd(S.attributes);C.hasOwnProperty("canBlockReload")||(C.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),rI.call(this,this.manifest),C.canSkipDateranges&&!C.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const C=this.manifest.segments.length,R=Yd(S.attributes),b=R.type&&R.type==="PART";r.preloadHints=r.preloadHints||[],r.preloadHints.push(R),R.byterange&&(R.byterange.hasOwnProperty("offset")||(R.byterange.offset=b?_:0,b&&(_=R.byterange.offset+R.byterange.length)));const F=r.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${F} for segment #${C}`,S.attributes,["TYPE","URI"]),!!R.type)for(let O=0;O<r.preloadHints.length-1;O++){const L=r.preloadHints[O];L.type&&L.type===R.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${F} for segment #${C} has the same TYPE ${R.type} as preload hint #${O}`})}},"rendition-report"(){const C=Yd(S.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(C);const R=this.manifest.renditionReports.length-1,b=["LAST-MSN","URI"];h&&b.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${R}`,S.attributes,b)},"part-inf"(){this.manifest.partInf=Yd(S.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",S.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),rI.call(this,this.manifest)}}[S.tagType]||f).call(e)},uri(){r.uri=S.uri,t.push(r),this.manifest.targetDuration&&!("duration"in r)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),r.duration=this.manifest.targetDuration),u&&(r.key=u),r.timeline=g,o&&(r.map=o),_=0,r={}},comment(){},custom(){S.segment?(r.custom=r.custom||{},r.custom[S.customType]=S.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[S.customType]=S.data)}})[S.type].call(e)})}warnOnMissingAttributes_(e,t,r){const o=[];r.forEach(function(u){t.hasOwnProperty(u)||o.push(u)}),o.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${o.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push(`
`),this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}var Gf={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},Pte=["video","audio","text"],QU=["Video","Audio","Text"],o6=function(e){return e&&e.replace(/avc1\.(\d+)\.(\d+)/i,function(t,r,o){var u=("00"+Number(r).toString(16)).slice(-2),h=("00"+Number(o).toString(16)).slice(-2);return"avc1."+u+"00"+h})},vl=function(e){e===void 0&&(e="");var t=e.split(","),r=[];return t.forEach(function(o){o=o.trim();var u;Pte.forEach(function(h){var f=Gf[h].exec(o.toLowerCase());if(!(!f||f.length<=1)){u=h;var d=o.substring(0,f[1].length),m=o.replace(d,"");r.push({type:d,details:m,mediaType:h})}}),u||r.push({type:o,details:"",mediaType:"unknown"})}),r},Lte=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var r=e.mediaGroups.AUDIO[t];if(!r)return null;for(var o in r){var u=r[o];if(u.default&&u.playlists)return vl(u.playlists[0].attributes.CODECS)}return null},l6=function(e){return e===void 0&&(e=""),Gf.audio.test(e.trim().toLowerCase())},Mte=function(e){return e===void 0&&(e=""),Gf.text.test(e.trim().toLowerCase())},Jm=function(e){if(!(!e||typeof e!="string")){var t=e.toLowerCase().split(",").map(function(u){return o6(u.trim())}),r="video";t.length===1&&l6(t[0])?r="audio":t.length===1&&Mte(t[0])&&(r="application");var o="mp4";return t.every(function(u){return Gf.mp4.test(u)})?o="mp4":t.every(function(u){return Gf.webm.test(u)})?o="webm":t.every(function(u){return Gf.ogg.test(u)})&&(o="ogg"),r+"/"+o+';codecs="'+e+'"'}},OE=function(e){return e===void 0&&(e=""),rt.MediaSource&&rt.MediaSource.isTypeSupported&&rt.MediaSource.isTypeSupported(Jm(e))||!1},iI=function(e){return e===void 0&&(e=""),e.toLowerCase().split(",").every(function(t){t=t.trim();for(var r=0;r<QU.length;r++){var o=QU[r];if(Gf["muxer"+o].test(t))return!0}return!1})},JU="mp4a.40.2",wte="avc1.4d400d",Ote=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,Nte=/^application\/dash\+xml/i,u6=function(e){return Ote.test(e)?"hls":Nte.test(e)?"dash":e==="application/vnd.videojs.vhs+json"?"vhs-json":null},Fte=function(e){return e.toString(2).length},kte=function(e){return Math.ceil(Fte(e)/8)},c6=function(e){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},Ute=function(e){return c6(e)},Gn=function(e){return e instanceof Uint8Array?e:(!Array.isArray(e)&&!Ute(e)&&!(e instanceof ArrayBuffer)&&(typeof e!="number"||typeof e=="number"&&e!==e?e=0:e=[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0))},ps=rt.BigInt||Number,ab=[ps("0x1"),ps("0x100"),ps("0x10000"),ps("0x1000000"),ps("0x100000000"),ps("0x10000000000"),ps("0x1000000000000"),ps("0x100000000000000"),ps("0x10000000000000000")];(function(){var n=new Uint16Array([65484]),e=new Uint8Array(n.buffer,n.byteOffset,n.byteLength);return e[0]===255?"big":e[0]===204?"little":"unknown"})();var Bte=function(e,t){var r=t===void 0?{}:t,o=r.signed,u=o===void 0?!1:o,h=r.le,f=h===void 0?!1:h;e=Gn(e);var d=f?"reduce":"reduceRight",m=e[d]?e[d]:Array.prototype[d],g=m.call(e,function(_,S,E){var T=f?E:Math.abs(E+1-e.length);return _+ps(S)*ab[T]},ps(0));if(u){var v=ab[e.length]/ps(2)-ps(1);g=ps(g),g>v&&(g-=v,g-=v,g-=ps(2))}return Number(g)},jte=function(e,t){var r=t===void 0?{}:t,o=r.le,u=o===void 0?!1:o;(typeof e!="bigint"&&typeof e!="number"||typeof e=="number"&&e!==e)&&(e=0),e=ps(e);for(var h=kte(e),f=new Uint8Array(new ArrayBuffer(h)),d=0;d<h;d++){var m=u?d:Math.abs(d+1-f.length);f[m]=Number(e/ab[d]&ps(255)),e<0&&(f[m]=Math.abs(~f[m]),f[m]-=d===0?1:2)}return f},f6=function(e,t){if(typeof e!="string"&&e&&typeof e.toString=="function"&&(e=e.toString()),typeof e!="string")return new Uint8Array;t||(e=unescape(encodeURIComponent(e)));for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);return r},Kte=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t=t.filter(function(f){return f&&(f.byteLength||f.length)&&typeof f!="string"}),t.length<=1)return Gn(t[0]);var o=t.reduce(function(f,d,m){return f+(d.byteLength||d.length)},0),u=new Uint8Array(o),h=0;return t.forEach(function(f){f=Gn(f),u.set(f,h),h+=f.byteLength}),u},ci=function(e,t,r){var o=r===void 0?{}:r,u=o.offset,h=u===void 0?0:u,f=o.mask,d=f===void 0?[]:f;e=Gn(e),t=Gn(t);var m=t.every?t.every:Array.prototype.every;return t.length&&e.length-h>=t.length&&m.call(t,function(g,v){var _=d[v]?d[v]&e[h+v]:e[h+v];return g===_})},ZU="http://example.com",_P=function(e,t){if(/^[a-z]+:/i.test(t))return t;/^data:/.test(e)&&(e=rt.location&&rt.location.href||"");var r=typeof rt.URL=="function",o=/^\/\//.test(e),u=!rt.location&&!/\/\//i.test(e);if(r?e=new rt.URL(e,rt.location||ZU):/\/\//i.test(e)||(e=C_.buildAbsoluteURL(rt.location&&rt.location.href||"",e)),r){var h=new URL(t,e);return u?h.href.slice(ZU.length):o?h.href.slice(h.protocol.length):h.href}return C_.buildAbsoluteURL(e,t)},Gte=function(e,t,r){t.forEach(function(o){for(var u in e.mediaGroups[o])for(var h in e.mediaGroups[o][u]){var f=e.mediaGroups[o][u][h];r(f,o,u,h)}})},Wte=function(e){return rt.atob?rt.atob(e):Buffer.from(e,"base64").toString("binary")};function Hte(n){for(var e=Wte(n),t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}var Hc={},Gu={};function Vte(n,e,t){if(t===void 0&&(t=Array.prototype),n&&typeof t.find=="function")return t.find.call(n,e);for(var r=0;r<n.length;r++)if(Object.prototype.hasOwnProperty.call(n,r)){var o=n[r];if(e.call(void 0,o,r,n))return o}}function TP(n,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(n):n}function $te(n,e){if(n===null||typeof n!="object")throw new TypeError("target is not an object");for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n}var d6=TP({HTML:"text/html",isHTML:function(n){return n===d6.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),h6=TP({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(n){return n===h6.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});Gu.assign=$te;Gu.find=Vte;Gu.freeze=TP;Gu.MIME_TYPE=d6;Gu.NAMESPACE=h6;var p6=Gu,Dl=p6.find,Zm=p6.NAMESPACE;function zte(n){return n!==""}function Yte(n){return n?n.split(/[\t\n\f\r ]+/).filter(zte):[]}function Xte(n,e){return n.hasOwnProperty(e)||(n[e]=!0),n}function e2(n){if(!n)return[];var e=Yte(n);return Object.keys(e.reduce(Xte,{}))}function qte(n){return function(e){return n&&n.indexOf(e)!==-1}}function y0(n,e){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}function _a(n,e){var t=n.prototype;if(!(t instanceof e)){let o=function(){};var r=o;o.prototype=e.prototype,o=new o,y0(t,o),n.prototype=t=o}t.constructor!=n&&(typeof n!="function"&&console.error("unknown Class:"+n),t.constructor=n)}var Ta={},Yo=Ta.ELEMENT_NODE=1,qh=Ta.ATTRIBUTE_NODE=2,I_=Ta.TEXT_NODE=3,g6=Ta.CDATA_SECTION_NODE=4,m6=Ta.ENTITY_REFERENCE_NODE=5,Qte=Ta.ENTITY_NODE=6,v6=Ta.PROCESSING_INSTRUCTION_NODE=7,y6=Ta.COMMENT_NODE=8,E6=Ta.DOCUMENT_NODE=9,_6=Ta.DOCUMENT_TYPE_NODE=10,Nu=Ta.DOCUMENT_FRAGMENT_NODE=11,Jte=Ta.NOTATION_NODE=12,Rs={},as={};Rs.INDEX_SIZE_ERR=(as[1]="Index size error",1);Rs.DOMSTRING_SIZE_ERR=(as[2]="DOMString size error",2);var la=Rs.HIERARCHY_REQUEST_ERR=(as[3]="Hierarchy request error",3);Rs.WRONG_DOCUMENT_ERR=(as[4]="Wrong document",4);Rs.INVALID_CHARACTER_ERR=(as[5]="Invalid character",5);Rs.NO_DATA_ALLOWED_ERR=(as[6]="No data allowed",6);Rs.NO_MODIFICATION_ALLOWED_ERR=(as[7]="No modification allowed",7);var T6=Rs.NOT_FOUND_ERR=(as[8]="Not found",8);Rs.NOT_SUPPORTED_ERR=(as[9]="Not supported",9);var t2=Rs.INUSE_ATTRIBUTE_ERR=(as[10]="Attribute in use",10);Rs.INVALID_STATE_ERR=(as[11]="Invalid state",11);Rs.SYNTAX_ERR=(as[12]="Syntax error",12);Rs.INVALID_MODIFICATION_ERR=(as[13]="Invalid modification",13);Rs.NAMESPACE_ERR=(as[14]="Invalid namespace",14);Rs.INVALID_ACCESS_ERR=(as[15]="Invalid access",15);function Ui(n,e){if(e instanceof Error)var t=e;else t=this,Error.call(this,as[n]),this.message=as[n],Error.captureStackTrace&&Error.captureStackTrace(this,Ui);return t.code=n,e&&(this.message=this.message+": "+e),t}Ui.prototype=Error.prototype;y0(Rs,Ui);function bu(){}bu.prototype={length:0,item:function(n){return this[n]||null},toString:function(n,e){for(var t=[],r=0;r<this.length;r++)Sh(this[r],t,n,e);return t.join("")},filter:function(n){return Array.prototype.filter.call(this,n)},indexOf:function(n){return Array.prototype.indexOf.call(this,n)}};function Qh(n,e){this._node=n,this._refresh=e,SP(this)}function SP(n){var e=n._node._inc||n._node.ownerDocument._inc;if(n._inc!=e){var t=n._refresh(n._node);w6(n,"length",t.length),y0(t,n),n._inc=e}}Qh.prototype.item=function(n){return SP(this),this[n]};_a(Qh,bu);function R_(){}function S6(n,e){for(var t=n.length;t--;)if(n[t]===e)return t}function n2(n,e,t,r){if(r?e[S6(e,r)]=t:e[e.length++]=t,n){t.ownerElement=n;var o=n.ownerDocument;o&&(r&&C6(o,n,r),Zte(o,n,t))}}function r2(n,e,t){var r=S6(e,t);if(r>=0){for(var o=e.length-1;r<o;)e[r]=e[++r];if(e.length=o,n){var u=n.ownerDocument;u&&(C6(u,n,t),t.ownerElement=null)}}else throw new Ui(T6,new Error(n.tagName+"@"+t))}R_.prototype={length:0,item:bu.prototype.item,getNamedItem:function(n){for(var e=this.length;e--;){var t=this[e];if(t.nodeName==n)return t}},setNamedItem:function(n){var e=n.ownerElement;if(e&&e!=this._ownerElement)throw new Ui(t2);var t=this.getNamedItem(n.nodeName);return n2(this._ownerElement,this,n,t),t},setNamedItemNS:function(n){var e=n.ownerElement,t;if(e&&e!=this._ownerElement)throw new Ui(t2);return t=this.getNamedItemNS(n.namespaceURI,n.localName),n2(this._ownerElement,this,n,t),t},removeNamedItem:function(n){var e=this.getNamedItem(n);return r2(this._ownerElement,this,e),e},removeNamedItemNS:function(n,e){var t=this.getNamedItemNS(n,e);return r2(this._ownerElement,this,t),t},getNamedItemNS:function(n,e){for(var t=this.length;t--;){var r=this[t];if(r.localName==e&&r.namespaceURI==n)return r}return null}};function A6(){}A6.prototype={hasFeature:function(n,e){return!0},createDocument:function(n,e,t){var r=new E0;if(r.implementation=this,r.childNodes=new bu,r.doctype=t||null,t&&r.appendChild(t),e){var o=r.createElementNS(n,e);r.appendChild(o)}return r},createDocumentType:function(n,e,t){var r=new BT;return r.name=n,r.nodeName=n,r.publicId=e||"",r.systemId=t||"",r}};function Ur(){}Ur.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(n,e){return b_(this,n,e)},replaceChild:function(n,e){b_(this,n,e,R6),e&&this.removeChild(e)},removeChild:function(n){return I6(this,n)},appendChild:function(n){return this.insertBefore(n,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(n){return ob(this.ownerDocument||this,this,n)},normalize:function(){for(var n=this.firstChild;n;){var e=n.nextSibling;e&&e.nodeType==I_&&n.nodeType==I_?(this.removeChild(e),n.appendData(e.data)):(n.normalize(),n=e)}},isSupported:function(n,e){return this.ownerDocument.implementation.hasFeature(n,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(n){for(var e=this;e;){var t=e._nsMap;if(t){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&t[r]===n)return r}e=e.nodeType==qh?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(n){for(var e=this;e;){var t=e._nsMap;if(t&&Object.prototype.hasOwnProperty.call(t,n))return t[n];e=e.nodeType==qh?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(n){var e=this.lookupPrefix(n);return e==null}};function x6(n){return n=="<"&&"&lt;"||n==">"&&"&gt;"||n=="&"&&"&amp;"||n=='"'&&"&quot;"||"&#"+n.charCodeAt()+";"}y0(Ta,Ur);y0(Ta,Ur.prototype);function e0(n,e){if(e(n))return!0;if(n=n.firstChild)do if(e0(n,e))return!0;while(n=n.nextSibling)}function E0(){this.ownerDocument=this}function Zte(n,e,t){n&&n._inc++;var r=t.namespaceURI;r===Zm.XMLNS&&(e._nsMap[t.prefix?t.localName:""]=t.value)}function C6(n,e,t,r){n&&n._inc++;var o=t.namespaceURI;o===Zm.XMLNS&&delete e._nsMap[t.prefix?t.localName:""]}function AP(n,e,t){if(n&&n._inc){n._inc++;var r=e.childNodes;if(t)r[r.length++]=t;else{for(var o=e.firstChild,u=0;o;)r[u++]=o,o=o.nextSibling;r.length=u,delete r[r.length]}}}function I6(n,e){var t=e.previousSibling,r=e.nextSibling;return t?t.nextSibling=r:n.firstChild=r,r?r.previousSibling=t:n.lastChild=t,e.parentNode=null,e.previousSibling=null,e.nextSibling=null,AP(n.ownerDocument,n),e}function ene(n){return n&&(n.nodeType===Ur.DOCUMENT_NODE||n.nodeType===Ur.DOCUMENT_FRAGMENT_NODE||n.nodeType===Ur.ELEMENT_NODE)}function tne(n){return n&&(Pl(n)||xP(n)||Fu(n)||n.nodeType===Ur.DOCUMENT_FRAGMENT_NODE||n.nodeType===Ur.COMMENT_NODE||n.nodeType===Ur.PROCESSING_INSTRUCTION_NODE)}function Fu(n){return n&&n.nodeType===Ur.DOCUMENT_TYPE_NODE}function Pl(n){return n&&n.nodeType===Ur.ELEMENT_NODE}function xP(n){return n&&n.nodeType===Ur.TEXT_NODE}function i2(n,e){var t=n.childNodes||[];if(Dl(t,Pl)||Fu(e))return!1;var r=Dl(t,Fu);return!(e&&r&&t.indexOf(r)>t.indexOf(e))}function s2(n,e){var t=n.childNodes||[];function r(u){return Pl(u)&&u!==e}if(Dl(t,r))return!1;var o=Dl(t,Fu);return!(e&&o&&t.indexOf(o)>t.indexOf(e))}function nne(n,e,t){if(!ene(n))throw new Ui(la,"Unexpected parent node type "+n.nodeType);if(t&&t.parentNode!==n)throw new Ui(T6,"child not in parent");if(!tne(e)||Fu(e)&&n.nodeType!==Ur.DOCUMENT_NODE)throw new Ui(la,"Unexpected node type "+e.nodeType+" for parent node type "+n.nodeType)}function rne(n,e,t){var r=n.childNodes||[],o=e.childNodes||[];if(e.nodeType===Ur.DOCUMENT_FRAGMENT_NODE){var u=o.filter(Pl);if(u.length>1||Dl(o,xP))throw new Ui(la,"More than one element or text in fragment");if(u.length===1&&!i2(n,t))throw new Ui(la,"Element in fragment can not be inserted before doctype")}if(Pl(e)&&!i2(n,t))throw new Ui(la,"Only one element can be added and only after doctype");if(Fu(e)){if(Dl(r,Fu))throw new Ui(la,"Only one doctype is allowed");var h=Dl(r,Pl);if(t&&r.indexOf(h)<r.indexOf(t))throw new Ui(la,"Doctype can only be inserted before an element");if(!t&&h)throw new Ui(la,"Doctype can not be appended since element is present")}}function R6(n,e,t){var r=n.childNodes||[],o=e.childNodes||[];if(e.nodeType===Ur.DOCUMENT_FRAGMENT_NODE){var u=o.filter(Pl);if(u.length>1||Dl(o,xP))throw new Ui(la,"More than one element or text in fragment");if(u.length===1&&!s2(n,t))throw new Ui(la,"Element in fragment can not be inserted before doctype")}if(Pl(e)&&!s2(n,t))throw new Ui(la,"Only one element can be added and only after doctype");if(Fu(e)){let d=function(m){return Fu(m)&&m!==t};var f=d;if(Dl(r,d))throw new Ui(la,"Only one doctype is allowed");var h=Dl(r,Pl);if(t&&r.indexOf(h)<r.indexOf(t))throw new Ui(la,"Doctype can only be inserted before an element")}}function b_(n,e,t,r){nne(n,e,t),n.nodeType===Ur.DOCUMENT_NODE&&(r||rne)(n,e,t);var o=e.parentNode;if(o&&o.removeChild(e),e.nodeType===Nu){var u=e.firstChild;if(u==null)return e;var h=e.lastChild}else u=h=e;var f=t?t.previousSibling:n.lastChild;u.previousSibling=f,h.nextSibling=t,f?f.nextSibling=u:n.firstChild=u,t==null?n.lastChild=h:t.previousSibling=h;do u.parentNode=n;while(u!==h&&(u=u.nextSibling));return AP(n.ownerDocument||n,n),e.nodeType==Nu&&(e.firstChild=e.lastChild=null),e}function ine(n,e){return e.parentNode&&e.parentNode.removeChild(e),e.parentNode=n,e.previousSibling=n.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:n.firstChild=e,n.lastChild=e,AP(n.ownerDocument,n,e),e}E0.prototype={nodeName:"#document",nodeType:E6,doctype:null,documentElement:null,_inc:1,insertBefore:function(n,e){if(n.nodeType==Nu){for(var t=n.firstChild;t;){var r=t.nextSibling;this.insertBefore(t,e),t=r}return n}return b_(this,n,e),n.ownerDocument=this,this.documentElement===null&&n.nodeType===Yo&&(this.documentElement=n),n},removeChild:function(n){return this.documentElement==n&&(this.documentElement=null),I6(this,n)},replaceChild:function(n,e){b_(this,n,e,R6),n.ownerDocument=this,e&&this.removeChild(e),Pl(n)&&(this.documentElement=n)},importNode:function(n,e){return M6(this,n,e)},getElementById:function(n){var e=null;return e0(this.documentElement,function(t){if(t.nodeType==Yo&&t.getAttribute("id")==n)return e=t,!0}),e},getElementsByClassName:function(n){var e=e2(n);return new Qh(this,function(t){var r=[];return e.length>0&&e0(t.documentElement,function(o){if(o!==t&&o.nodeType===Yo){var u=o.getAttribute("class");if(u){var h=n===u;if(!h){var f=e2(u);h=e.every(qte(f))}h&&r.push(o)}}}),r})},createElement:function(n){var e=new Zf;e.ownerDocument=this,e.nodeName=n,e.tagName=n,e.localName=n,e.childNodes=new bu;var t=e.attributes=new R_;return t._ownerElement=e,e},createDocumentFragment:function(){var n=new jT;return n.ownerDocument=this,n.childNodes=new bu,n},createTextNode:function(n){var e=new CP;return e.ownerDocument=this,e.appendData(n),e},createComment:function(n){var e=new IP;return e.ownerDocument=this,e.appendData(n),e},createCDATASection:function(n){var e=new RP;return e.ownerDocument=this,e.appendData(n),e},createProcessingInstruction:function(n,e){var t=new DP;return t.ownerDocument=this,t.tagName=t.target=n,t.nodeValue=t.data=e,t},createAttribute:function(n){var e=new D_;return e.ownerDocument=this,e.name=n,e.nodeName=n,e.localName=n,e.specified=!0,e},createEntityReference:function(n){var e=new bP;return e.ownerDocument=this,e.nodeName=n,e},createElementNS:function(n,e){var t=new Zf,r=e.split(":"),o=t.attributes=new R_;return t.childNodes=new bu,t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.namespaceURI=n,r.length==2?(t.prefix=r[0],t.localName=r[1]):t.localName=e,o._ownerElement=t,t},createAttributeNS:function(n,e){var t=new D_,r=e.split(":");return t.ownerDocument=this,t.nodeName=e,t.name=e,t.namespaceURI=n,t.specified=!0,r.length==2?(t.prefix=r[0],t.localName=r[1]):t.localName=e,t}};_a(E0,Ur);function Zf(){this._nsMap={}}Zf.prototype={nodeType:Yo,hasAttribute:function(n){return this.getAttributeNode(n)!=null},getAttribute:function(n){var e=this.getAttributeNode(n);return e&&e.value||""},getAttributeNode:function(n){return this.attributes.getNamedItem(n)},setAttribute:function(n,e){var t=this.ownerDocument.createAttribute(n);t.value=t.nodeValue=""+e,this.setAttributeNode(t)},removeAttribute:function(n){var e=this.getAttributeNode(n);e&&this.removeAttributeNode(e)},appendChild:function(n){return n.nodeType===Nu?this.insertBefore(n,null):ine(this,n)},setAttributeNode:function(n){return this.attributes.setNamedItem(n)},setAttributeNodeNS:function(n){return this.attributes.setNamedItemNS(n)},removeAttributeNode:function(n){return this.attributes.removeNamedItem(n.nodeName)},removeAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);t&&this.removeAttributeNode(t)},hasAttributeNS:function(n,e){return this.getAttributeNodeNS(n,e)!=null},getAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);return t&&t.value||""},setAttributeNS:function(n,e,t){var r=this.ownerDocument.createAttributeNS(n,e);r.value=r.nodeValue=""+t,this.setAttributeNode(r)},getAttributeNodeNS:function(n,e){return this.attributes.getNamedItemNS(n,e)},getElementsByTagName:function(n){return new Qh(this,function(e){var t=[];return e0(e,function(r){r!==e&&r.nodeType==Yo&&(n==="*"||r.tagName==n)&&t.push(r)}),t})},getElementsByTagNameNS:function(n,e){return new Qh(this,function(t){var r=[];return e0(t,function(o){o!==t&&o.nodeType===Yo&&(n==="*"||o.namespaceURI===n)&&(e==="*"||o.localName==e)&&r.push(o)}),r})}};E0.prototype.getElementsByTagName=Zf.prototype.getElementsByTagName;E0.prototype.getElementsByTagNameNS=Zf.prototype.getElementsByTagNameNS;_a(Zf,Ur);function D_(){}D_.prototype.nodeType=qh;_a(D_,Ur);function _0(){}_0.prototype={data:"",substringData:function(n,e){return this.data.substring(n,n+e)},appendData:function(n){n=this.data+n,this.nodeValue=this.data=n,this.length=n.length},insertData:function(n,e){this.replaceData(n,0,e)},appendChild:function(n){throw new Error(as[la])},deleteData:function(n,e){this.replaceData(n,e,"")},replaceData:function(n,e,t){var r=this.data.substring(0,n),o=this.data.substring(n+e);t=r+t+o,this.nodeValue=this.data=t,this.length=t.length}};_a(_0,Ur);function CP(){}CP.prototype={nodeName:"#text",nodeType:I_,splitText:function(n){var e=this.data,t=e.substring(n);e=e.substring(0,n),this.data=this.nodeValue=e,this.length=e.length;var r=this.ownerDocument.createTextNode(t);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}};_a(CP,_0);function IP(){}IP.prototype={nodeName:"#comment",nodeType:y6};_a(IP,_0);function RP(){}RP.prototype={nodeName:"#cdata-section",nodeType:g6};_a(RP,_0);function BT(){}BT.prototype.nodeType=_6;_a(BT,Ur);function b6(){}b6.prototype.nodeType=Jte;_a(b6,Ur);function D6(){}D6.prototype.nodeType=Qte;_a(D6,Ur);function bP(){}bP.prototype.nodeType=m6;_a(bP,Ur);function jT(){}jT.prototype.nodeName="#document-fragment";jT.prototype.nodeType=Nu;_a(jT,Ur);function DP(){}DP.prototype.nodeType=v6;_a(DP,Ur);function P6(){}P6.prototype.serializeToString=function(n,e,t){return L6.call(n,e,t)};Ur.prototype.toString=L6;function L6(n,e){var t=[],r=this.nodeType==9&&this.documentElement||this,o=r.prefix,u=r.namespaceURI;if(u&&o==null){var o=r.lookupPrefix(u);if(o==null)var h=[{namespace:u,prefix:null}]}return Sh(this,t,n,e,h),t.join("")}function a2(n,e,t){var r=n.prefix||"",o=n.namespaceURI;if(!o||r==="xml"&&o===Zm.XML||o===Zm.XMLNS)return!1;for(var u=t.length;u--;){var h=t[u];if(h.prefix===r)return h.namespace!==o}return!0}function sI(n,e,t){n.push(" ",e,'="',t.replace(/[<>&"\t\n\r]/g,x6),'"')}function Sh(n,e,t,r,o){if(o||(o=[]),r)if(n=r(n),n){if(typeof n=="string"){e.push(n);return}}else return;switch(n.nodeType){case Yo:var u=n.attributes,h=u.length,R=n.firstChild,f=n.tagName;t=Zm.isHTML(n.namespaceURI)||t;var d=f;if(!t&&!n.prefix&&n.namespaceURI){for(var m,g=0;g<u.length;g++)if(u.item(g).name==="xmlns"){m=u.item(g).value;break}if(!m)for(var v=o.length-1;v>=0;v--){var _=o[v];if(_.prefix===""&&_.namespace===n.namespaceURI){m=_.namespace;break}}if(m!==n.namespaceURI)for(var v=o.length-1;v>=0;v--){var _=o[v];if(_.namespace===n.namespaceURI){_.prefix&&(d=_.prefix+":"+f);break}}}e.push("<",d);for(var S=0;S<h;S++){var E=u.item(S);E.prefix=="xmlns"?o.push({prefix:E.localName,namespace:E.value}):E.nodeName=="xmlns"&&o.push({prefix:"",namespace:E.value})}for(var S=0;S<h;S++){var E=u.item(S);if(a2(E,t,o)){var T=E.prefix||"",C=E.namespaceURI;sI(e,T?"xmlns:"+T:"xmlns",C),o.push({prefix:T,namespace:C})}Sh(E,e,t,r,o)}if(f===d&&a2(n,t,o)){var T=n.prefix||"",C=n.namespaceURI;sI(e,T?"xmlns:"+T:"xmlns",C),o.push({prefix:T,namespace:C})}if(R||t&&!/^(?:meta|link|img|br|hr|input)$/i.test(f)){if(e.push(">"),t&&/^script$/i.test(f))for(;R;)R.data?e.push(R.data):Sh(R,e,t,r,o.slice()),R=R.nextSibling;else for(;R;)Sh(R,e,t,r,o.slice()),R=R.nextSibling;e.push("</",d,">")}else e.push("/>");return;case E6:case Nu:for(var R=n.firstChild;R;)Sh(R,e,t,r,o.slice()),R=R.nextSibling;return;case qh:return sI(e,n.name,n.value);case I_:return e.push(n.data.replace(/[<&>]/g,x6));case g6:return e.push("<![CDATA[",n.data,"]]>");case y6:return e.push("<!--",n.data,"-->");case _6:var b=n.publicId,F=n.systemId;if(e.push("<!DOCTYPE ",n.name),b)e.push(" PUBLIC ",b),F&&F!="."&&e.push(" ",F),e.push(">");else if(F&&F!=".")e.push(" SYSTEM ",F,">");else{var O=n.internalSubset;O&&e.push(" [",O,"]"),e.push(">")}return;case v6:return e.push("<?",n.target," ",n.data,"?>");case m6:return e.push("&",n.nodeName,";");default:e.push("??",n.nodeName)}}function M6(n,e,t){var r;switch(e.nodeType){case Yo:r=e.cloneNode(!1),r.ownerDocument=n;case Nu:break;case qh:t=!0;break}if(r||(r=e.cloneNode(!1)),r.ownerDocument=n,r.parentNode=null,t)for(var o=e.firstChild;o;)r.appendChild(M6(n,o,t)),o=o.nextSibling;return r}function ob(n,e,t){var r=new e.constructor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var u=e[o];typeof u!="object"&&u!=r[o]&&(r[o]=u)}switch(e.childNodes&&(r.childNodes=new bu),r.ownerDocument=n,r.nodeType){case Yo:var h=e.attributes,f=r.attributes=new R_,d=h.length;f._ownerElement=r;for(var m=0;m<d;m++)r.setAttributeNode(ob(n,h.item(m),!0));break;case qh:t=!0}if(t)for(var g=e.firstChild;g;)r.appendChild(ob(n,g,t)),g=g.nextSibling;return r}function w6(n,e,t){n[e]=t}try{if(Object.defineProperty){let n=function(t){switch(t.nodeType){case Yo:case Nu:var r=[];for(t=t.firstChild;t;)t.nodeType!==7&&t.nodeType!==8&&r.push(n(t)),t=t.nextSibling;return r.join("");default:return t.nodeValue}};var qW=n;Object.defineProperty(Qh.prototype,"length",{get:function(){return SP(this),this.$$length}}),Object.defineProperty(Ur.prototype,"textContent",{get:function(){return n(this)},set:function(t){switch(this.nodeType){case Yo:case Nu:for(;this.firstChild;)this.removeChild(this.firstChild);(t||String(t))&&this.appendChild(this.ownerDocument.createTextNode(t));break;default:this.data=t,this.value=t,this.nodeValue=t}}}),w6=function(t,r,o){t["$$"+r]=o}}}catch{}Hc.DocumentType=BT;Hc.DOMException=Ui;Hc.DOMImplementation=A6;Hc.Element=Zf;Hc.Node=Ur;Hc.NodeList=bu;Hc.XMLSerializer=P6;var KT={},O6={};(function(n){var e=Gu.freeze;n.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),n.HTML_ENTITIES=e({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",times:"×",divide:"÷",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",euro:"€",trade:"™",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦"}),n.entityMap=n.HTML_ENTITIES})(O6);var PP={},t0=Gu.NAMESPACE,lb=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,o2=new RegExp("[\\-\\.0-9"+lb.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),l2=new RegExp("^"+lb.source+o2.source+"*(?::"+lb.source+o2.source+"*)?$"),Ug=0,fc=1,Xd=2,Bg=3,qd=4,Qd=5,jg=6,tE=7;function Jh(n,e){this.message=n,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,Jh)}Jh.prototype=new Error;Jh.prototype.name=Jh.name;function N6(){}N6.prototype={parse:function(n,e,t){var r=this.domBuilder;r.startDocument(),F6(e,e={}),sne(n,e,t,r,this.errorHandler),r.endDocument()}};function sne(n,e,t,r,o){function u(Y){if(Y>65535){Y-=65536;var J=55296+(Y>>10),ee=56320+(Y&1023);return String.fromCharCode(J,ee)}else return String.fromCharCode(Y)}function h(Y){var J=Y.slice(1,-1);return Object.hasOwnProperty.call(t,J)?t[J]:J.charAt(0)==="#"?u(parseInt(J.substr(1).replace("x","0x"))):(o.error("entity not found:"+Y),Y)}function f(Y){if(Y>T){var J=n.substring(T,Y).replace(/&#?\w+;/g,h);_&&d(T),r.characters(J,0,Y-T),T=Y}}function d(Y,J){for(;Y>=g&&(J=v.exec(n));)m=J.index,g=m+J[0].length,_.lineNumber++;_.columnNumber=Y-m+1}for(var m=0,g=0,v=/.*(?:\r\n?|\n)|.*$/g,_=r.locator,S=[{currentNSMap:e}],E={},T=0;;){try{var C=n.indexOf("<",T);if(C<0){if(!n.substr(T).match(/^\s*$/)){var R=r.doc,b=R.createTextNode(n.substr(T));R.appendChild(b),r.currentElement=b}return}switch(C>T&&f(C),n.charAt(C+1)){case"/":var U=n.indexOf(">",C+3),F=n.substring(C+2,U).replace(/[ \t\n\r]+$/g,""),O=S.pop();U<0?(F=n.substring(C+2).replace(/[\s<].*/,""),o.error("end tag name: "+F+" is not complete:"+O.tagName),U=C+1+F.length):F.match(/\s</)&&(F=F.replace(/[\s<].*/,""),o.error("end tag name: "+F+" maybe not complete"),U=C+1+F.length);var L=O.localNSMap,D=O.tagName==F,x=D||O.tagName&&O.tagName.toLowerCase()==F.toLowerCase();if(x){if(r.endElement(O.uri,O.localName,F),L)for(var B in L)Object.prototype.hasOwnProperty.call(L,B)&&r.endPrefixMapping(B);D||o.fatalError("end tag name: "+F+" is not match the current start tagName:"+O.tagName)}else S.push(O);U++;break;case"?":_&&d(C),U=cne(n,C,r);break;case"!":_&&d(C),U=une(n,C,r,o);break;default:_&&d(C);var M=new k6,I=S[S.length-1].currentNSMap,U=ane(n,C,M,I,h,o),w=M.length;if(!M.closed&&lne(n,U,M.tagName,E)&&(M.closed=!0,t.nbsp||o.warning("unclosed xml attribute")),_&&w){for(var k=u2(_,{}),K=0;K<w;K++){var W=M[K];d(W.offset),W.locator=u2(_,{})}r.locator=k,c2(M,r,I)&&S.push(M),r.locator=_}else c2(M,r,I)&&S.push(M);t0.isHTML(M.uri)&&!M.closed?U=one(n,U,M.tagName,h,r):U++}}catch(Y){if(Y instanceof Jh)throw Y;o.error("element parse error: "+Y),U=-1}U>T?T=U:f(Math.max(C,T)+1)}}function u2(n,e){return e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber,e}function ane(n,e,t,r,o,u){function h(_,S,E){t.attributeNames.hasOwnProperty(_)&&u.fatalError("Attribute "+_+" redefined"),t.addValue(_,S.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,o),E)}for(var f,d,m=++e,g=Ug;;){var v=n.charAt(m);switch(v){case"=":if(g===fc)f=n.slice(e,m),g=Bg;else if(g===Xd)g=Bg;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(g===Bg||g===fc)if(g===fc&&(u.warning('attribute value must after "="'),f=n.slice(e,m)),e=m+1,m=n.indexOf(v,e),m>0)d=n.slice(e,m),h(f,d,e-1),g=Qd;else throw new Error("attribute value no end '"+v+"' match");else if(g==qd)d=n.slice(e,m),h(f,d,e),u.warning('attribute "'+f+'" missed start quot('+v+")!!"),e=m+1,g=Qd;else throw new Error('attribute value must after "="');break;case"/":switch(g){case Ug:t.setTagName(n.slice(e,m));case Qd:case jg:case tE:g=tE,t.closed=!0;case qd:case fc:break;case Xd:t.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return u.error("unexpected end of input"),g==Ug&&t.setTagName(n.slice(e,m)),m;case">":switch(g){case Ug:t.setTagName(n.slice(e,m));case Qd:case jg:case tE:break;case qd:case fc:d=n.slice(e,m),d.slice(-1)==="/"&&(t.closed=!0,d=d.slice(0,-1));case Xd:g===Xd&&(d=f),g==qd?(u.warning('attribute "'+d+'" missed quot(")!'),h(f,d,e)):((!t0.isHTML(r[""])||!d.match(/^(?:disabled|checked|selected)$/i))&&u.warning('attribute "'+d+'" missed value!! "'+d+'" instead!!'),h(d,d,e));break;case Bg:throw new Error("attribute value missed!!")}return m;case"":v=" ";default:if(v<=" ")switch(g){case Ug:t.setTagName(n.slice(e,m)),g=jg;break;case fc:f=n.slice(e,m),g=Xd;break;case qd:var d=n.slice(e,m);u.warning('attribute "'+d+'" missed quot(")!!'),h(f,d,e);case Qd:g=jg;break}else switch(g){case Xd:t.tagName,(!t0.isHTML(r[""])||!f.match(/^(?:disabled|checked|selected)$/i))&&u.warning('attribute "'+f+'" missed value!! "'+f+'" instead2!!'),h(f,f,e),e=m,g=fc;break;case Qd:u.warning('attribute space is required"'+f+'"!!');case jg:g=fc,e=m;break;case Bg:g=qd,e=m;break;case tE:throw new Error("elements closed character '/' and '>' must be connected to")}}m++}}function c2(n,e,t){for(var r=n.tagName,o=null,v=n.length;v--;){var u=n[v],h=u.qName,f=u.value,_=h.indexOf(":");if(_>0)var d=u.prefix=h.slice(0,_),m=h.slice(_+1),g=d==="xmlns"&&m;else m=h,d=null,g=h==="xmlns"&&"";u.localName=m,g!==!1&&(o==null&&(o={},F6(t,t={})),t[g]=o[g]=f,u.uri=t0.XMLNS,e.startPrefixMapping(g,f))}for(var v=n.length;v--;){u=n[v];var d=u.prefix;d&&(d==="xml"&&(u.uri=t0.XML),d!=="xmlns"&&(u.uri=t[d||""]))}var _=r.indexOf(":");_>0?(d=n.prefix=r.slice(0,_),m=n.localName=r.slice(_+1)):(d=null,m=n.localName=r);var S=n.uri=t[d||""];if(e.startElement(S,m,r,n),n.closed){if(e.endElement(S,m,r),o)for(d in o)Object.prototype.hasOwnProperty.call(o,d)&&e.endPrefixMapping(d)}else return n.currentNSMap=t,n.localNSMap=o,!0}function one(n,e,t,r,o){if(/^(?:script|textarea)$/i.test(t)){var u=n.indexOf("</"+t+">",e),h=n.substring(e+1,u);if(/[&<]/.test(h))return/^script$/i.test(t)?(o.characters(h,0,h.length),u):(h=h.replace(/&#?\w+;/g,r),o.characters(h,0,h.length),u)}return e+1}function lne(n,e,t,r){var o=r[t];return o==null&&(o=n.lastIndexOf("</"+t+">"),o<e&&(o=n.lastIndexOf("</"+t)),r[t]=o),o<e}function F6(n,e){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}function une(n,e,t,r){var o=n.charAt(e+2);switch(o){case"-":if(n.charAt(e+3)==="-"){var u=n.indexOf("-->",e+4);return u>e?(t.comment(n,e+4,u-e-4),u+3):(r.error("Unclosed comment"),-1)}else return-1;default:if(n.substr(e+3,6)=="CDATA["){var u=n.indexOf("]]>",e+9);return t.startCDATA(),t.characters(n,e+9,u-e-9),t.endCDATA(),u+3}var h=fne(n,e),f=h.length;if(f>1&&/!doctype/i.test(h[0][0])){var d=h[1][0],m=!1,g=!1;f>3&&(/^public$/i.test(h[2][0])?(m=h[3][0],g=f>4&&h[4][0]):/^system$/i.test(h[2][0])&&(g=h[3][0]));var v=h[f-1];return t.startDTD(d,m,g),t.endDTD(),v.index+v[0].length}}return-1}function cne(n,e,t){var r=n.indexOf("?>",e);if(r){var o=n.substring(e,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return o?(o[0].length,t.processingInstruction(o[1],o[2]),r+2):-1}return-1}function k6(){this.attributeNames={}}k6.prototype={setTagName:function(n){if(!l2.test(n))throw new Error("invalid tagName:"+n);this.tagName=n},addValue:function(n,e,t){if(!l2.test(n))throw new Error("invalid attribute:"+n);this.attributeNames[n]=this.length,this[this.length++]={qName:n,value:e,offset:t}},length:0,getLocalName:function(n){return this[n].localName},getLocator:function(n){return this[n].locator},getQName:function(n){return this[n].qName},getURI:function(n){return this[n].uri},getValue:function(n){return this[n].value}};function fne(n,e){var t,r=[],o=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(o.lastIndex=e,o.exec(n);t=o.exec(n);)if(r.push(t),t[1])return r}PP.XMLReader=N6;PP.ParseError=Jh;var dne=Gu,hne=Hc,f2=O6,U6=PP,pne=hne.DOMImplementation,d2=dne.NAMESPACE,gne=U6.ParseError,mne=U6.XMLReader;function B6(n){return n.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function j6(n){this.options=n||{locator:{}}}j6.prototype.parseFromString=function(n,e){var t=this.options,r=new mne,o=t.domBuilder||new T0,u=t.errorHandler,h=t.locator,f=t.xmlns||{},d=/\/x?html?$/.test(e),m=d?f2.HTML_ENTITIES:f2.XML_ENTITIES;h&&o.setDocumentLocator(h),r.errorHandler=vne(u,o,h),r.domBuilder=t.domBuilder||o,d&&(f[""]=d2.HTML),f.xml=f.xml||d2.XML;var g=t.normalizeLineEndings||B6;return n&&typeof n=="string"?r.parse(g(n),f,m):r.errorHandler.error("invalid doc source"),o.doc};function vne(n,e,t){if(!n){if(e instanceof T0)return e;n=e}var r={},o=n instanceof Function;t=t||{};function u(h){var f=n[h];!f&&o&&(f=n.length==2?function(d){n(h,d)}:n),r[h]=f&&function(d){f("[xmldom "+h+"]	"+d+ub(t))}||function(){}}return u("warning"),u("error"),u("fatalError"),r}function T0(){this.cdata=!1}function Jd(n,e){e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber}T0.prototype={startDocument:function(){this.doc=new pne().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(n,e,t,r){var o=this.doc,u=o.createElementNS(n,t||e),h=r.length;nE(this,u),this.currentElement=u,this.locator&&Jd(this.locator,u);for(var f=0;f<h;f++){var n=r.getURI(f),d=r.getValue(f),t=r.getQName(f),m=o.createAttributeNS(n,t);this.locator&&Jd(r.getLocator(f),m),m.value=m.nodeValue=d,u.setAttributeNode(m)}},endElement:function(n,e,t){var r=this.currentElement;r.tagName,this.currentElement=r.parentNode},startPrefixMapping:function(n,e){},endPrefixMapping:function(n){},processingInstruction:function(n,e){var t=this.doc.createProcessingInstruction(n,e);this.locator&&Jd(this.locator,t),nE(this,t)},ignorableWhitespace:function(n,e,t){},characters:function(n,e,t){if(n=h2.apply(this,arguments),n){if(this.cdata)var r=this.doc.createCDATASection(n);else var r=this.doc.createTextNode(n);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(n)&&this.doc.appendChild(r),this.locator&&Jd(this.locator,r)}},skippedEntity:function(n){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(n){(this.locator=n)&&(n.lineNumber=0)},comment:function(n,e,t){n=h2.apply(this,arguments);var r=this.doc.createComment(n);this.locator&&Jd(this.locator,r),nE(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(n,e,t){var r=this.doc.implementation;if(r&&r.createDocumentType){var o=r.createDocumentType(n,e,t);this.locator&&Jd(this.locator,o),nE(this,o),this.doc.doctype=o}},warning:function(n){console.warn("[xmldom warning]	"+n,ub(this.locator))},error:function(n){console.error("[xmldom error]	"+n,ub(this.locator))},fatalError:function(n){throw new gne(n,this.locator)}};function ub(n){if(n)return`
@`+(n.systemId||"")+"#[line:"+n.lineNumber+",col:"+n.columnNumber+"]"}function h2(n,e,t){return typeof n=="string"?n.substr(e,t):n.length>=e+t||e?new java.lang.String(n,e,t)+"":n}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(n){T0.prototype[n]=function(){return null}});function nE(n,e){n.currentElement?n.currentElement.appendChild(e):n.doc.appendChild(e)}KT.__DOMHandler=T0;KT.normalizeLineEndings=B6;KT.DOMParser=j6;var yne=KT.DOMParser;/*! @name mpd-parser @version 1.1.1 @license Apache-2.0 */const p2=n=>!!n&&typeof n=="object",As=(...n)=>n.reduce((e,t)=>(typeof t!="object"||Object.keys(t).forEach(r=>{Array.isArray(e[r])&&Array.isArray(t[r])?e[r]=e[r].concat(t[r]):p2(e[r])&&p2(t[r])?e[r]=As(e[r],t[r]):e[r]=t[r]}),e),{}),K6=n=>Object.keys(n).map(e=>n[e]),Ene=(n,e)=>{const t=[];for(let r=n;r<e;r++)t.push(r);return t},Zh=n=>n.reduce((e,t)=>e.concat(t),[]),G6=n=>{if(!n.length)return[];const e=[];for(let t=0;t<n.length;t++)e.push(n[t]);return e},_ne=(n,e)=>n.reduce((t,r,o)=>(r[e]&&t.push(o),t),[]),Tne=(n,e)=>K6(n.reduce((t,r)=>(r.forEach(o=>{t[e(o)]=o}),t),{}));var ep={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};const n0=({baseUrl:n="",source:e="",range:t="",indexRange:r=""})=>{const o={uri:e,resolvedUri:_P(n||"",e)};if(t||r){const h=(t||r).split("-");let f=rt.BigInt?rt.BigInt(h[0]):parseInt(h[0],10),d=rt.BigInt?rt.BigInt(h[1]):parseInt(h[1],10);f<Number.MAX_SAFE_INTEGER&&typeof f=="bigint"&&(f=Number(f)),d<Number.MAX_SAFE_INTEGER&&typeof d=="bigint"&&(d=Number(d));let m;typeof d=="bigint"||typeof f=="bigint"?m=rt.BigInt(d)-rt.BigInt(f)+rt.BigInt(1):m=d-f+1,typeof m=="bigint"&&m<Number.MAX_SAFE_INTEGER&&(m=Number(m)),o.byterange={length:m,offset:f}}return o},Sne=n=>{let e;return typeof n.offset=="bigint"||typeof n.length=="bigint"?e=rt.BigInt(n.offset)+rt.BigInt(n.length)-rt.BigInt(1):e=n.offset+n.length-1,`${n.offset}-${e}`},g2=n=>(n&&typeof n!="number"&&(n=parseInt(n,10)),isNaN(n)?null:n),Ane={static(n){const{duration:e,timescale:t=1,sourceDuration:r,periodDuration:o}=n,u=g2(n.endNumber),h=e/t;return typeof u=="number"?{start:0,end:u}:typeof o=="number"?{start:0,end:o/h}:{start:0,end:r/h}},dynamic(n){const{NOW:e,clientOffset:t,availabilityStartTime:r,timescale:o=1,duration:u,periodStart:h=0,minimumUpdatePeriod:f=0,timeShiftBufferDepth:d=1/0}=n,m=g2(n.endNumber),g=(e+t)/1e3,v=r+h,S=g+f-v,E=Math.ceil(S*o/u),T=Math.floor((g-v-d)*o/u),C=Math.floor((g-v)*o/u);return{start:Math.max(0,T),end:typeof m=="number"?m:Math.min(E,C)}}},xne=n=>e=>{const{duration:t,timescale:r=1,periodStart:o,startNumber:u=1}=n;return{number:u+e,duration:t/r,timeline:o,time:e*t}},LP=n=>{const{type:e,duration:t,timescale:r=1,periodDuration:o,sourceDuration:u}=n,{start:h,end:f}=Ane[e](n),d=Ene(h,f).map(xne(n));if(e==="static"){const m=d.length-1,g=typeof o=="number"?o:u;d[m].duration=g-t/r*m}return d},W6=n=>{const{baseUrl:e,initialization:t={},sourceDuration:r,indexRange:o="",periodStart:u,presentationTime:h,number:f=0,duration:d}=n;if(!e)throw new Error(ep.NO_BASE_URL);const m=n0({baseUrl:e,source:t.sourceURL,range:t.range}),g=n0({baseUrl:e,source:e,indexRange:o});if(g.map=m,d){const v=LP(n);v.length&&(g.duration=v[0].duration,g.timeline=v[0].timeline)}else r&&(g.duration=r,g.timeline=u);return g.presentationTime=h||u,g.number=f,[g]},MP=(n,e,t)=>{const r=n.sidx.map?n.sidx.map:null,o=n.sidx.duration,u=n.timeline||0,h=n.sidx.byterange,f=h.offset+h.length,d=e.timescale,m=e.references.filter(C=>C.referenceType!==1),g=[],v=n.endList?"static":"dynamic",_=n.sidx.timeline;let S=_,E=n.mediaSequence||0,T;typeof e.firstOffset=="bigint"?T=rt.BigInt(f)+e.firstOffset:T=f+e.firstOffset;for(let C=0;C<m.length;C++){const R=e.references[C],b=R.referencedSize,F=R.subsegmentDuration;let O;typeof T=="bigint"?O=T+rt.BigInt(b)-rt.BigInt(1):O=T+b-1;const L=`${T}-${O}`,x=W6({baseUrl:t,timescale:d,timeline:u,periodStart:_,presentationTime:S,number:E,duration:F,sourceDuration:o,indexRange:L,type:v})[0];r&&(x.map=r),g.push(x),typeof T=="bigint"?T+=rt.BigInt(b):T+=b,S+=F/d,E++}return n.segments=g,n},Cne=["AUDIO","SUBTITLES"],Ine=1/60,H6=n=>Tne(n,({timeline:e})=>e).sort((e,t)=>e.timeline>t.timeline?1:-1),Rne=(n,e)=>{for(let t=0;t<n.length;t++)if(n[t].attributes.NAME===e)return n[t];return null},m2=n=>{let e=[];return Gte(n,Cne,(t,r,o,u)=>{e=e.concat(t.playlists||[])}),e},v2=({playlist:n,mediaSequence:e})=>{n.mediaSequence=e,n.segments.forEach((t,r)=>{t.number=n.mediaSequence+r})},bne=({oldPlaylists:n,newPlaylists:e,timelineStarts:t})=>{e.forEach(r=>{r.discontinuitySequence=t.findIndex(function({timeline:d}){return d===r.timeline});const o=Rne(n,r.attributes.NAME);if(!o||r.sidx)return;const u=r.segments[0],h=o.segments.findIndex(function(d){return Math.abs(d.presentationTime-u.presentationTime)<Ine});if(h===-1){v2({playlist:r,mediaSequence:o.mediaSequence+o.segments.length}),r.segments[0].discontinuity=!0,r.discontinuityStarts.unshift(0),(!o.segments.length&&r.timeline>o.timeline||o.segments.length&&r.timeline>o.segments[o.segments.length-1].timeline)&&r.discontinuitySequence--;return}o.segments[h].discontinuity&&!u.discontinuity&&(u.discontinuity=!0,r.discontinuityStarts.unshift(0),r.discontinuitySequence--),v2({playlist:r,mediaSequence:o.segments[h].number})})},Dne=({oldManifest:n,newManifest:e})=>{const t=n.playlists.concat(m2(n)),r=e.playlists.concat(m2(e));return e.timelineStarts=H6([n.timelineStarts,e.timelineStarts]),bne({oldPlaylists:t,newPlaylists:r,timelineStarts:e.timelineStarts}),e},GT=n=>n&&n.uri+"-"+Sne(n.byterange),aI=n=>K6(n.reduce((t,r)=>{const o=r.attributes.id+(r.attributes.lang||"");return t[o]?(r.segments&&(r.segments[0]&&(r.segments[0].discontinuity=!0),t[o].segments.push(...r.segments)),r.attributes.contentProtection&&(t[o].attributes.contentProtection=r.attributes.contentProtection)):(t[o]=r,t[o].attributes.timelineStarts=[]),t[o].attributes.timelineStarts.push({start:r.attributes.periodStart,timeline:r.attributes.periodStart}),t},{})).map(t=>(t.discontinuityStarts=_ne(t.segments||[],"discontinuity"),t)),wP=(n,e)=>{const t=GT(n.sidx),r=t&&e[t]&&e[t].sidx;return r&&MP(n,r,n.sidx.resolvedUri),n},Pne=(n,e={})=>{if(!Object.keys(e).length)return n;for(const t in n)n[t]=wP(n[t],e);return n},Lne=({attributes:n,segments:e,sidx:t,mediaSequence:r,discontinuitySequence:o,discontinuityStarts:u},h)=>{const f={attributes:{NAME:n.id,BANDWIDTH:n.bandwidth,CODECS:n.codecs,["PROGRAM-ID"]:1},uri:"",endList:n.type==="static",timeline:n.periodStart,resolvedUri:"",targetDuration:n.duration,discontinuitySequence:o,discontinuityStarts:u,timelineStarts:n.timelineStarts,mediaSequence:r,segments:e};return n.contentProtection&&(f.contentProtection=n.contentProtection),t&&(f.sidx=t),h&&(f.attributes.AUDIO="audio",f.attributes.SUBTITLES="subs"),f},Mne=({attributes:n,segments:e,mediaSequence:t,discontinuityStarts:r,discontinuitySequence:o})=>{typeof e>"u"&&(e=[{uri:n.baseUrl,timeline:n.periodStart,resolvedUri:n.baseUrl||"",duration:n.sourceDuration,number:0}],n.duration=n.sourceDuration);const u={NAME:n.id,BANDWIDTH:n.bandwidth,["PROGRAM-ID"]:1};return n.codecs&&(u.CODECS=n.codecs),{attributes:u,uri:"",endList:n.type==="static",timeline:n.periodStart,resolvedUri:n.baseUrl||"",targetDuration:n.duration,timelineStarts:n.timelineStarts,discontinuityStarts:r,discontinuitySequence:o,mediaSequence:t,segments:e}},wne=(n,e={},t=!1)=>{let r;const o=n.reduce((u,h)=>{const f=h.attributes.role&&h.attributes.role.value||"",d=h.attributes.lang||"";let m=h.attributes.label||"main";if(d&&!h.attributes.label){const v=f?` (${f})`:"";m=`${h.attributes.lang}${v}`}u[m]||(u[m]={language:d,autoselect:!0,default:f==="main",playlists:[],uri:""});const g=wP(Lne(h,t),e);return u[m].playlists.push(g),typeof r>"u"&&f==="main"&&(r=h,r.default=!0),u},{});if(!r){const u=Object.keys(o)[0];o[u].default=!0}return o},One=(n,e={})=>n.reduce((t,r)=>{const o=r.attributes.label||r.attributes.lang||"text";return t[o]||(t[o]={language:o,default:!1,autoselect:!1,playlists:[],uri:""}),t[o].playlists.push(wP(Mne(r),e)),t},{}),Nne=n=>n.reduce((e,t)=>(t&&t.forEach(r=>{const{channel:o,language:u}=r;e[u]={autoselect:!1,default:!1,instreamId:o,language:u},r.hasOwnProperty("aspectRatio")&&(e[u].aspectRatio=r.aspectRatio),r.hasOwnProperty("easyReader")&&(e[u].easyReader=r.easyReader),r.hasOwnProperty("3D")&&(e[u]["3D"]=r["3D"])}),e),{}),Fne=({attributes:n,segments:e,sidx:t,discontinuityStarts:r})=>{const o={attributes:{NAME:n.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:n.width,height:n.height},CODECS:n.codecs,BANDWIDTH:n.bandwidth,["PROGRAM-ID"]:1},uri:"",endList:n.type==="static",timeline:n.periodStart,resolvedUri:"",targetDuration:n.duration,discontinuityStarts:r,timelineStarts:n.timelineStarts,segments:e};return n.frameRate&&(o.attributes["FRAME-RATE"]=n.frameRate),n.contentProtection&&(o.contentProtection=n.contentProtection),t&&(o.sidx=t),o},kne=({attributes:n})=>n.mimeType==="video/mp4"||n.mimeType==="video/webm"||n.contentType==="video",Une=({attributes:n})=>n.mimeType==="audio/mp4"||n.mimeType==="audio/webm"||n.contentType==="audio",Bne=({attributes:n})=>n.mimeType==="text/vtt"||n.contentType==="text",jne=(n,e)=>{n.forEach(t=>{t.mediaSequence=0,t.discontinuitySequence=e.findIndex(function({timeline:r}){return r===t.timeline}),t.segments&&t.segments.forEach((r,o)=>{r.number=o})})},y2=n=>n?Object.keys(n).reduce((e,t)=>{const r=n[t];return e.concat(r.playlists)},[]):[],Kne=({dashPlaylists:n,locations:e,sidxMapping:t={},previousManifest:r,eventStream:o})=>{if(!n.length)return{};const{sourceDuration:u,type:h,suggestedPresentationDelay:f,minimumUpdatePeriod:d}=n[0].attributes,m=aI(n.filter(kne)).map(Fne),g=aI(n.filter(Une)),v=aI(n.filter(Bne)),_=n.map(F=>F.attributes.captionServices).filter(Boolean),S={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},["CLOSED-CAPTIONS"]:{},SUBTITLES:{}},uri:"",duration:u,playlists:Pne(m,t)};d>=0&&(S.minimumUpdatePeriod=d*1e3),e&&(S.locations=e),h==="dynamic"&&(S.suggestedPresentationDelay=f),o&&o.length>0&&(S.eventStream=o);const E=S.playlists.length===0,T=g.length?wne(g,t,E):null,C=v.length?One(v,t):null,R=m.concat(y2(T),y2(C)),b=R.map(({timelineStarts:F})=>F);return S.timelineStarts=H6(b),jne(R,S.timelineStarts),T&&(S.mediaGroups.AUDIO.audio=T),C&&(S.mediaGroups.SUBTITLES.subs=C),_.length&&(S.mediaGroups["CLOSED-CAPTIONS"].cc=Nne(_)),r?Dne({oldManifest:r,newManifest:S}):S},Gne=(n,e,t)=>{const{NOW:r,clientOffset:o,availabilityStartTime:u,timescale:h=1,periodStart:f=0,minimumUpdatePeriod:d=0}=n,m=(r+o)/1e3,g=u+f,_=m+d-g;return Math.ceil((_*h-e)/t)},V6=(n,e)=>{const{type:t,minimumUpdatePeriod:r=0,media:o="",sourceDuration:u,timescale:h=1,startNumber:f=1,periodStart:d}=n,m=[];let g=-1;for(let v=0;v<e.length;v++){const _=e[v],S=_.d,E=_.r||0,T=_.t||0;g<0&&(g=T),T&&T>g&&(g=T);let C;if(E<0){const F=v+1;F===e.length?t==="dynamic"&&r>0&&o.indexOf("$Number$")>0?C=Gne(n,g,S):C=(u*h-g)/S:C=(e[F].t-g)/S}else C=E+1;const R=f+m.length+C;let b=f+m.length;for(;b<R;)m.push({number:b,duration:S/h,time:g,timeline:d}),g+=S,b++}return m},Wne=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,Hne=n=>(e,t,r,o)=>{if(e==="$$")return"$";if(typeof n[t]>"u")return e;const u=""+n[t];return t==="RepresentationID"||(r?o=parseInt(o,10):o=1,u.length>=o)?u:`${new Array(o-u.length+1).join("0")}${u}`},E2=(n,e)=>n.replace(Wne,Hne(e)),Vne=(n,e)=>!n.duration&&!e?[{number:n.startNumber||1,duration:n.sourceDuration,time:0,timeline:n.periodStart}]:n.duration?LP(n):V6(n,e),$ne=(n,e)=>{const t={RepresentationID:n.id,Bandwidth:n.bandwidth||0},{initialization:r={sourceURL:"",range:""}}=n,o=n0({baseUrl:n.baseUrl,source:E2(r.sourceURL,t),range:r.range});return Vne(n,e).map(h=>{t.Number=h.number,t.Time=h.time;const f=E2(n.media||"",t),d=n.timescale||1,m=n.presentationTimeOffset||0,g=n.periodStart+(h.time-m)/d;return{uri:f,timeline:h.timeline,duration:h.duration,resolvedUri:_P(n.baseUrl||"",f),map:o,number:h.number,presentationTime:g}})},zne=(n,e)=>{const{baseUrl:t,initialization:r={}}=n,o=n0({baseUrl:t,source:r.sourceURL,range:r.range}),u=n0({baseUrl:t,source:e.media,range:e.mediaRange});return u.map=o,u},Yne=(n,e)=>{const{duration:t,segmentUrls:r=[],periodStart:o}=n;if(!t&&!e||t&&e)throw new Error(ep.SEGMENT_TIME_UNSPECIFIED);const u=r.map(d=>zne(n,d));let h;return t&&(h=LP(n)),e&&(h=V6(n,e)),h.map((d,m)=>{if(u[m]){const g=u[m],v=n.timescale||1,_=n.presentationTimeOffset||0;return g.timeline=d.timeline,g.duration=d.duration,g.number=d.number,g.presentationTime=o+(d.time-_)/v,g}}).filter(d=>d)},Xne=({attributes:n,segmentInfo:e})=>{let t,r;e.template?(r=$ne,t=As(n,e.template)):e.base?(r=W6,t=As(n,e.base)):e.list&&(r=Yne,t=As(n,e.list));const o={attributes:n};if(!r)return o;const u=r(t,e.segmentTimeline);if(t.duration){const{duration:h,timescale:f=1}=t;t.duration=h/f}else u.length?t.duration=u.reduce((h,f)=>Math.max(h,Math.ceil(f.duration)),0):t.duration=0;return o.attributes=t,o.segments=u,e.base&&t.indexRange&&(o.sidx=u[0],o.segments=[]),o},qne=n=>n.map(Xne),_i=(n,e)=>G6(n.childNodes).filter(({tagName:t})=>t===e),WT=n=>n.textContent.trim(),Qne=n=>parseFloat(n.split("/").reduce((e,t)=>e/t)),Zd=n=>{const f=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(n);if(!f)return 0;const[d,m,g,v,_,S]=f.slice(1);return parseFloat(d||0)*31536e3+parseFloat(m||0)*2592e3+parseFloat(g||0)*86400+parseFloat(v||0)*3600+parseFloat(_||0)*60+parseFloat(S||0)},Jne=n=>(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(n)&&(n+="Z"),Date.parse(n)),_2={mediaPresentationDuration(n){return Zd(n)},availabilityStartTime(n){return Jne(n)/1e3},minimumUpdatePeriod(n){return Zd(n)},suggestedPresentationDelay(n){return Zd(n)},type(n){return n},timeShiftBufferDepth(n){return Zd(n)},start(n){return Zd(n)},width(n){return parseInt(n,10)},height(n){return parseInt(n,10)},bandwidth(n){return parseInt(n,10)},frameRate(n){return Qne(n)},startNumber(n){return parseInt(n,10)},timescale(n){return parseInt(n,10)},presentationTimeOffset(n){return parseInt(n,10)},duration(n){const e=parseInt(n,10);return isNaN(e)?Zd(n):e},d(n){return parseInt(n,10)},t(n){return parseInt(n,10)},r(n){return parseInt(n,10)},presentationTime(n){return parseInt(n,10)},DEFAULT(n){return n}},rs=n=>n&&n.attributes?G6(n.attributes).reduce((e,t)=>{const r=_2[t.name]||_2.DEFAULT;return e[t.name]=r(t.value),e},{}):{},Zne={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},HT=(n,e)=>e.length?Zh(n.map(function(t){return e.map(function(r){return _P(t,WT(r))})})):n,OP=n=>{const e=_i(n,"SegmentTemplate")[0],t=_i(n,"SegmentList")[0],r=t&&_i(t,"SegmentURL").map(v=>As({tag:"SegmentURL"},rs(v))),o=_i(n,"SegmentBase")[0],u=t||e,h=u&&_i(u,"SegmentTimeline")[0],f=t||o||e,d=f&&_i(f,"Initialization")[0],m=e&&rs(e);m&&d?m.initialization=d&&rs(d):m&&m.initialization&&(m.initialization={sourceURL:m.initialization});const g={template:m,segmentTimeline:h&&_i(h,"S").map(v=>rs(v)),list:t&&As(rs(t),{segmentUrls:r,initialization:rs(d)}),base:o&&As(rs(o),{initialization:rs(d)})};return Object.keys(g).forEach(v=>{g[v]||delete g[v]}),g},ere=(n,e,t)=>r=>{const o=_i(r,"BaseURL"),u=HT(e,o),h=As(n,rs(r)),f=OP(r);return u.map(d=>({segmentInfo:As(t,f),attributes:As(h,{baseUrl:d})}))},tre=n=>n.reduce((e,t)=>{const r=rs(t);r.schemeIdUri&&(r.schemeIdUri=r.schemeIdUri.toLowerCase());const o=Zne[r.schemeIdUri];if(o){e[o]={attributes:r};const u=_i(t,"cenc:pssh")[0];if(u){const h=WT(u);e[o].pssh=h&&Hte(h)}}return e},{}),nre=n=>{if(n.schemeIdUri==="urn:scte:dash:cc:cea-608:2015")return(typeof n.value!="string"?[]:n.value.split(";")).map(t=>{let r,o;return o=t,/^CC\d=/.test(t)?[r,o]=t.split("="):/^CC\d$/.test(t)&&(r=t),{channel:r,language:o}});if(n.schemeIdUri==="urn:scte:dash:cc:cea-708:2015")return(typeof n.value!="string"?[]:n.value.split(";")).map(t=>{const r={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(t)){const[o,u=""]=t.split("=");r.channel=o,r.language=t,u.split(",").forEach(h=>{const[f,d]=h.split(":");f==="lang"?r.language=d:f==="er"?r.easyReader=Number(d):f==="war"?r.aspectRatio=Number(d):f==="3D"&&(r["3D"]=Number(d))})}else r.language=t;return r.channel&&(r.channel="SERVICE"+r.channel),r})},rre=n=>Zh(_i(n.node,"EventStream").map(e=>{const t=rs(e),r=t.schemeIdUri;return _i(e,"Event").map(o=>{const u=rs(o),h=u.presentationTime||0,f=t.timescale||1,d=u.duration||0,m=h/f+n.attributes.start;return{schemeIdUri:r,value:t.value,id:u.id,start:m,end:m+d/f,messageData:WT(o)||u.messageData,contentEncoding:t.contentEncoding,presentationTimeOffset:t.presentationTimeOffset||0}})})),ire=(n,e,t)=>r=>{const o=rs(r),u=HT(e,_i(r,"BaseURL")),h=_i(r,"Role")[0],f={role:rs(h)};let d=As(n,o,f);const m=_i(r,"Accessibility")[0],g=nre(rs(m));g&&(d=As(d,{captionServices:g}));const v=_i(r,"Label")[0];if(v&&v.childNodes.length){const C=v.childNodes[0].nodeValue.trim();d=As(d,{label:C})}const _=tre(_i(r,"ContentProtection"));Object.keys(_).length&&(d=As(d,{contentProtection:_}));const S=OP(r),E=_i(r,"Representation"),T=As(t,S);return Zh(E.map(ere(d,u,T)))},sre=(n,e)=>(t,r)=>{const o=HT(e,_i(t.node,"BaseURL")),u=As(n,{periodStart:t.attributes.start});typeof t.attributes.duration=="number"&&(u.periodDuration=t.attributes.duration);const h=_i(t.node,"AdaptationSet"),f=OP(t.node);return Zh(h.map(ire(u,o,f)))},are=({attributes:n,priorPeriodAttributes:e,mpdType:t})=>typeof n.start=="number"?n.start:e&&typeof e.start=="number"&&typeof e.duration=="number"?e.start+e.duration:!e&&t==="static"?0:null,ore=(n,e={})=>{const{manifestUri:t="",NOW:r=Date.now(),clientOffset:o=0}=e,u=_i(n,"Period");if(!u.length)throw new Error(ep.INVALID_NUMBER_OF_PERIOD);const h=_i(n,"Location"),f=rs(n),d=HT([t],_i(n,"BaseURL"));f.type=f.type||"static",f.sourceDuration=f.mediaPresentationDuration||0,f.NOW=r,f.clientOffset=o,h.length&&(f.locations=h.map(WT));const m=[];return u.forEach((g,v)=>{const _=rs(g),S=m[v-1];_.start=are({attributes:_,priorPeriodAttributes:S?S.attributes:null,mpdType:f.type}),m.push({node:g,attributes:_})}),{locations:f.locations,representationInfo:Zh(m.map(sre(f,d))),eventStream:Zh(m.map(rre))}},$6=n=>{if(n==="")throw new Error(ep.DASH_EMPTY_MANIFEST);const e=new yne;let t,r;try{t=e.parseFromString(n,"application/xml"),r=t&&t.documentElement.tagName==="MPD"?t.documentElement:null}catch{}if(!r||r&&r.getElementsByTagName("parsererror").length>0)throw new Error(ep.DASH_INVALID_XML);return r},lre=n=>{const e=_i(n,"UTCTiming")[0];if(!e)return null;const t=rs(e);switch(t.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":t.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":t.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":t.method="DIRECT",t.value=Date.parse(t.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(ep.UNSUPPORTED_UTC_TIMING_SCHEME)}return t},ure=(n,e={})=>{const t=ore($6(n),e),r=qne(t.representationInfo);return Kne({dashPlaylists:r,locations:t.locations,sidxMapping:e.sidxMapping,previousManifest:e.previousManifest,eventStream:t.eventStream})},cre=n=>lre($6(n));var z6=Math.pow(2,32),fre=function(n){var e=new DataView(n.buffer,n.byteOffset,n.byteLength),t;return e.getBigUint64?(t=e.getBigUint64(0),t<Number.MAX_SAFE_INTEGER?Number(t):t):e.getUint32(0)*z6+e.getUint32(4)},dre={getUint64:fre,MAX_UINT32:z6},T2=dre.getUint64,hre=function(n){var e=new DataView(n.buffer,n.byteOffset,n.byteLength),t={version:n[0],flags:new Uint8Array(n.subarray(1,4)),references:[],referenceId:e.getUint32(4),timescale:e.getUint32(8)},r=12;t.version===0?(t.earliestPresentationTime=e.getUint32(r),t.firstOffset=e.getUint32(r+4),r+=8):(t.earliestPresentationTime=T2(n.subarray(r)),t.firstOffset=T2(n.subarray(r+8)),r+=16),r+=2;var o=e.getUint16(r);for(r+=2;o>0;r+=12,o--)t.references.push({referenceType:(n[r]&128)>>>7,referencedSize:e.getUint32(r)&2147483647,subsegmentDuration:e.getUint32(r+4),startsWithSap:!!(n[r+8]&128),sapType:(n[r+8]&112)>>>4,sapDeltaTime:e.getUint32(r+8)&268435455});return t},pre=hre,gre=Gn([73,68,51]),mre=function(e,t){t===void 0&&(t=0),e=Gn(e);var r=e[t+5],o=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9],u=(r&16)>>4;return u?o+20:o+10},nm=function n(e,t){return t===void 0&&(t=0),e=Gn(e),e.length-t<10||!ci(e,gre,{offset:t})?t:(t+=mre(e,t),n(e,t))},S2=function(e){return typeof e=="string"?f6(e):e},vre=function(e){return Array.isArray(e)?e.map(function(t){return S2(t)}):[S2(e)]},yre=function n(e,t,r){r===void 0&&(r=!1),t=vre(t),e=Gn(e);var o=[];if(!t.length)return o;for(var u=0;u<e.length;){var h=(e[u]<<24|e[u+1]<<16|e[u+2]<<8|e[u+3])>>>0,f=e.subarray(u+4,u+8);if(h===0)break;var d=u+h;if(d>e.length){if(r)break;d=e.length}var m=e.subarray(u+8,d);ci(f,t[0])&&(t.length===1?o.push(m):o.push.apply(o,n(m,t.slice(1),r))),u=d}return o},rE={EBML:Gn([26,69,223,163]),DocType:Gn([66,130]),Segment:Gn([24,83,128,103]),SegmentInfo:Gn([21,73,169,102]),Tracks:Gn([22,84,174,107]),Track:Gn([174]),TrackNumber:Gn([215]),DefaultDuration:Gn([35,227,131]),TrackEntry:Gn([174]),TrackType:Gn([131]),FlagDefault:Gn([136]),CodecID:Gn([134]),CodecPrivate:Gn([99,162]),VideoTrack:Gn([224]),AudioTrack:Gn([225]),Cluster:Gn([31,67,182,117]),Timestamp:Gn([231]),TimestampScale:Gn([42,215,177]),BlockGroup:Gn([160]),BlockDuration:Gn([155]),Block:Gn([161]),SimpleBlock:Gn([163])},cb=[128,64,32,16,8,4,2,1],Ere=function(e){for(var t=1,r=0;r<cb.length&&!(e&cb[r]);r++)t++;return t},P_=function(e,t,r,o){r===void 0&&(r=!0),o===void 0&&(o=!1);var u=Ere(e[t]),h=e.subarray(t,t+u);return r&&(h=Array.prototype.slice.call(e,t,t+u),h[0]^=cb[u-1]),{length:u,value:Bte(h,{signed:o}),bytes:h}},A2=function n(e){return typeof e=="string"?e.match(/.{1,2}/g).map(function(t){return n(t)}):typeof e=="number"?jte(e):e},_re=function(e){return Array.isArray(e)?e.map(function(t){return A2(t)}):[A2(e)]},Tre=function n(e,t,r){if(r>=t.length)return t.length;var o=P_(t,r,!1);if(ci(e.bytes,o.bytes))return r;var u=P_(t,r+o.length);return n(e,t,r+u.length+u.value+o.length)},x2=function n(e,t){t=_re(t),e=Gn(e);var r=[];if(!t.length)return r;for(var o=0;o<e.length;){var u=P_(e,o,!1),h=P_(e,o+u.length),f=o+u.length+h.length;h.value===127&&(h.value=Tre(u,e,f),h.value!==e.length&&(h.value-=f));var d=f+h.value>e.length?e.length:f+h.value,m=e.subarray(f,d);ci(t[0],u.bytes)&&(t.length===1?r.push(m):r=r.concat(n(m,t.slice(1))));var g=u.length+h.length+m.length;o+=g}return r},Sre=Gn([0,0,0,1]),Are=Gn([0,0,1]),xre=Gn([0,0,3]),Cre=function(e){for(var t=[],r=1;r<e.length-2;)ci(e.subarray(r,r+3),xre)&&(t.push(r+2),r++),r++;if(t.length===0)return e;var o=e.length-t.length,u=new Uint8Array(o),h=0;for(r=0;r<o;h++,r++)h===t[0]&&(h++,t.shift()),u[r]=e[h];return u},Y6=function(e,t,r,o){o===void 0&&(o=1/0),e=Gn(e),r=[].concat(r);for(var u=0,h,f=0;u<e.length&&(f<o||h);){var d=void 0;if(ci(e.subarray(u),Sre)?d=4:ci(e.subarray(u),Are)&&(d=3),!d){u++;continue}if(f++,h)return Cre(e.subarray(h,u));var m=void 0;t==="h264"?m=e[u+d]&31:t==="h265"&&(m=e[u+d]>>1&63),r.indexOf(m)!==-1&&(h=u+d),u+=d+(t==="h264"?1:2)}return e.subarray(0,0)},Ire=function(e,t,r){return Y6(e,"h264",t,r)},Rre=function(e,t,r){return Y6(e,"h265",t,r)},Ns={webm:Gn([119,101,98,109]),matroska:Gn([109,97,116,114,111,115,107,97]),flac:Gn([102,76,97,67]),ogg:Gn([79,103,103,83]),ac3:Gn([11,119]),riff:Gn([82,73,70,70]),avi:Gn([65,86,73]),wav:Gn([87,65,86,69]),"3gp":Gn([102,116,121,112,51,103]),mp4:Gn([102,116,121,112]),fmp4:Gn([115,116,121,112]),mov:Gn([102,116,121,112,113,116]),moov:Gn([109,111,111,118]),moof:Gn([109,111,111,102])},tp={aac:function(e){var t=nm(e);return ci(e,[255,16],{offset:t,mask:[255,22]})},mp3:function(e){var t=nm(e);return ci(e,[255,2],{offset:t,mask:[255,6]})},webm:function(e){var t=x2(e,[rE.EBML,rE.DocType])[0];return ci(t,Ns.webm)},mkv:function(e){var t=x2(e,[rE.EBML,rE.DocType])[0];return ci(t,Ns.matroska)},mp4:function(e){if(tp["3gp"](e)||tp.mov(e))return!1;if(ci(e,Ns.mp4,{offset:4})||ci(e,Ns.fmp4,{offset:4})||ci(e,Ns.moof,{offset:4})||ci(e,Ns.moov,{offset:4}))return!0},mov:function(e){return ci(e,Ns.mov,{offset:4})},"3gp":function(e){return ci(e,Ns["3gp"],{offset:4})},ac3:function(e){var t=nm(e);return ci(e,Ns.ac3,{offset:t})},ts:function(e){if(e.length<189&&e.length>=1)return e[0]===71;for(var t=0;t+188<e.length&&t<188;){if(e[t]===71&&e[t+188]===71)return!0;t+=1}return!1},flac:function(e){var t=nm(e);return ci(e,Ns.flac,{offset:t})},ogg:function(e){return ci(e,Ns.ogg)},avi:function(e){return ci(e,Ns.riff)&&ci(e,Ns.avi,{offset:8})},wav:function(e){return ci(e,Ns.riff)&&ci(e,Ns.wav,{offset:8})},h264:function(e){return Ire(e,7,3).length},h265:function(e){return Rre(e,[32,33],3).length}},fb=Object.keys(tp).filter(function(n){return n!=="ts"&&n!=="h264"&&n!=="h265"}).concat(["ts","h264","h265"]);fb.forEach(function(n){var e=tp[n];tp[n]=function(t){return e(Gn(t))}});var bre=tp,NP=function(e){e=Gn(e);for(var t=0;t<fb.length;t++){var r=fb[t];if(bre[r](e))return r}return""},Dre=function(e){return yre(e,["moof"]).length>0},FP=9e4,kP,UP,VT,BP,X6,q6,Q6;kP=function(n){return n*FP};UP=function(n,e){return n*e};VT=function(n){return n/FP};BP=function(n,e){return n/e};X6=function(n,e){return kP(BP(n,e))};q6=function(n,e){return UP(VT(n),e)};Q6=function(n,e,t){return VT(t?n:n-e)};var L_={ONE_SECOND_IN_TS:FP,secondsToVideoTs:kP,secondsToAudioTs:UP,videoTsToSeconds:VT,audioTsToSeconds:BP,audioTsToVideoTs:X6,videoTsToAudioTs:q6,metadataTsToSeconds:Q6};/**
 * @license
 * Video.js 8.3.0 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */var J6="8.3.0";const Au={},Fc=function(n,e){return Au[n]=Au[n]||[],e&&(Au[n]=Au[n].concat(e)),Au[n]},Pre=function(n,e){Fc(n,e)},Z6=function(n,e){const t=Fc(n).indexOf(e);return t<=-1?!1:(Au[n]=Au[n].slice(),Au[n].splice(t,1),!0)},Lre=function(n,e){Fc(n,[].concat(e).map(t=>{const r=(...o)=>(Z6(n,r),t(...o));return r}))},M_={prefixed:!0},NE=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],C2=NE[0];let rm;for(let n=0;n<NE.length;n++)if(NE[n][1]in mn){rm=NE[n];break}if(rm){for(let n=0;n<rm.length;n++)M_[C2[n]]=rm[n];M_.prefixed=rm[0]!==C2[0]}let aa=[];const Mre=(n,e)=>(t,r,o)=>{const u=e.levels[r],h=new RegExp(`^(${u})$`);if(t!=="log"&&o.unshift(t.toUpperCase()+":"),o.unshift(n+":"),aa){aa.push([].concat(o));const d=aa.length-1e3;aa.splice(0,d>0?d:0)}if(!rt.console)return;let f=rt.console[t];!f&&t==="debug"&&(f=rt.console.info||rt.console.log),!(!f||!u||!h.test(t))&&f[Array.isArray(o)?"apply":"call"](rt.console,o)};function eK(n){let e="info",t;const r=function(...o){t("log",e,o)};return t=Mre(n,r),r.createLogger=o=>eK(n+": "+o),r.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:e},r.level=o=>{if(typeof o=="string"){if(!r.levels.hasOwnProperty(o))throw new Error(`"${o}" in not a valid log level`);e=o}return e},r.history=()=>aa?[].concat(aa):[],r.history.filter=o=>(aa||[]).filter(u=>new RegExp(`.*${o}.*`).test(u[0])),r.history.clear=()=>{aa&&(aa.length=0)},r.history.disable=()=>{aa!==null&&(aa.length=0,aa=null)},r.history.enable=()=>{aa===null&&(aa=[])},r.error=(...o)=>t("error",e,o),r.warn=(...o)=>t("warn",e,o),r.debug=(...o)=>t("debug",e,o),r}const Er=eK("VIDEOJS"),tK=Er.createLogger,wre=Object.prototype.toString,nK=function(n){return kl(n)?Object.keys(n):[]};function Nh(n,e){nK(n).forEach(t=>e(n[t],t))}function rK(n,e,t=0){return nK(n).reduce((r,o)=>e(r,n[o],o),t)}function kl(n){return!!n&&typeof n=="object"}function np(n){return kl(n)&&wre.call(n)==="[object Object]"&&n.constructor===Object}function Xr(...n){const e={};return n.forEach(t=>{t&&Nh(t,(r,o)=>{if(!np(r)){e[o]=r;return}np(e[o])||(e[o]={}),e[o]=Xr(e[o],r)})}),e}function $T(n,e,t,r=!0){const o=h=>Object.defineProperty(n,e,{value:h,enumerable:!0,writable:!0}),u={configurable:!0,enumerable:!0,get(){const h=t();return o(h),h}};return r&&(u.set=o),Object.defineProperty(n,e,u)}var Ore=Object.freeze({__proto__:null,each:Nh,reduce:rK,isObject:kl,isPlain:np,merge:Xr,defineLazyProperty:$T});let jP=!1,iK=null,Ul=!1,sK,aK=!1,Fh=!1,kh=!1,Bl=!1,KP=null,zT=null,oK=null,w_=!1,YT=!1,O_=!1,XT=!1;const r0=Boolean(vp()&&("ontouchstart"in rt||rt.navigator.maxTouchPoints||rt.DocumentTouch&&rt.document instanceof rt.DocumentTouch)),eh=rt.navigator&&rt.navigator.userAgentData;eh&&(Ul=eh.platform==="Android",Fh=Boolean(eh.brands.find(n=>n.brand==="Microsoft Edge")),kh=Boolean(eh.brands.find(n=>n.brand==="Chromium")),Bl=!Fh&&kh,KP=zT=(eh.brands.find(n=>n.brand==="Chromium")||{}).version||null,YT=eh.platform==="Windows");if(!kh){const n=rt.navigator&&rt.navigator.userAgent||"";jP=/iPod/i.test(n),iK=function(){const e=n.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null}(),Ul=/Android/i.test(n),sK=function(){const e=n.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;const t=e[1]&&parseFloat(e[1]),r=e[2]&&parseFloat(e[2]);return t&&r?parseFloat(e[1]+"."+e[2]):t||null}(),aK=/Firefox/i.test(n),Fh=/Edg/i.test(n),kh=/Chrome/i.test(n)||/CriOS/i.test(n),Bl=!Fh&&kh,KP=zT=function(){const e=n.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),oK=function(){const e=/MSIE\s(\d+)\.\d/.exec(n);let t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(n)&&/rv:11.0/.test(n)&&(t=11),t}(),w_=/Safari/i.test(n)&&!Bl&&!Ul&&!Fh,YT=/Windows/i.test(n),O_=/iPad/i.test(n)||w_&&r0&&!/iPhone/i.test(n),XT=/iPhone/i.test(n)&&!O_}const $s=XT||O_||jP,qT=(w_||$s)&&!Bl;var Nre=Object.freeze({__proto__:null,get IS_IPOD(){return jP},get IOS_VERSION(){return iK},get IS_ANDROID(){return Ul},get ANDROID_VERSION(){return sK},get IS_FIREFOX(){return aK},get IS_EDGE(){return Fh},get IS_CHROMIUM(){return kh},get IS_CHROME(){return Bl},get CHROMIUM_VERSION(){return KP},get CHROME_VERSION(){return zT},get IE_VERSION(){return oK},get IS_SAFARI(){return w_},get IS_WINDOWS(){return YT},get IS_IPAD(){return O_},get IS_IPHONE(){return XT},TOUCH_ENABLED:r0,IS_IOS:$s,IS_ANY_SAFARI:qT});function I2(n){return typeof n=="string"&&Boolean(n.trim())}function Fre(n){if(n.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function vp(){return mn===rt.document}function yp(n){return kl(n)&&n.nodeType===1}function lK(){try{return rt.parent!==rt.self}catch{return!0}}function uK(n){return function(e,t){if(!I2(e))return mn[n](null);I2(t)&&(t=mn.querySelector(t));const r=yp(t)?t:mn;return r[n]&&r[n](e)}}function dr(n="div",e={},t={},r){const o=mn.createElement(n);return Object.getOwnPropertyNames(e).forEach(function(u){const h=e[u];u==="textContent"?Vc(o,h):(o[u]!==h||u==="tabIndex")&&(o[u]=h)}),Object.getOwnPropertyNames(t).forEach(function(u){o.setAttribute(u,t[u])}),r&&GP(o,r),o}function Vc(n,e){return typeof n.textContent>"u"?n.innerText=e:n.textContent=e,n}function db(n,e){e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)}function vm(n,e){return Fre(e),n.classList.contains(e)}function Wf(n,...e){return n.classList.add(...e.reduce((t,r)=>t.concat(r.split(/\s+/)),[])),n}function QT(n,...e){return n?(n.classList.remove(...e.reduce((t,r)=>t.concat(r.split(/\s+/)),[])),n):(Er.warn("removeClass was called with an element that doesn't exist"),null)}function cK(n,e,t){return typeof t=="function"&&(t=t(n,e)),typeof t!="boolean"&&(t=void 0),e.split(/\s+/).forEach(r=>n.classList.toggle(r,t)),n}function fK(n,e){Object.getOwnPropertyNames(e).forEach(function(t){const r=e[t];r===null||typeof r>"u"||r===!1?n.removeAttribute(t):n.setAttribute(t,r===!0?"":r)})}function vc(n){const e={},t=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(n&&n.attributes&&n.attributes.length>0){const r=n.attributes;for(let o=r.length-1;o>=0;o--){const u=r[o].name;let h=r[o].value;(typeof n[u]=="boolean"||t.indexOf(","+u+",")!==-1)&&(h=h!==null),e[u]=h}}return e}function dK(n,e){return n.getAttribute(e)}function rp(n,e,t){n.setAttribute(e,t)}function JT(n,e){n.removeAttribute(e)}function hK(){mn.body.focus(),mn.onselectstart=function(){return!1}}function pK(){mn.onselectstart=function(){return!0}}function ip(n){if(n&&n.getBoundingClientRect&&n.parentNode){const e=n.getBoundingClientRect(),t={};return["bottom","height","left","right","top","width"].forEach(r=>{e[r]!==void 0&&(t[r]=e[r])}),t.height||(t.height=parseFloat(sp(n,"height"))),t.width||(t.width=parseFloat(sp(n,"width"))),t}}function i0(n){if(!n||n&&!n.offsetParent)return{left:0,top:0,width:0,height:0};const e=n.offsetWidth,t=n.offsetHeight;let r=0,o=0;for(;n.offsetParent&&n!==mn[M_.fullscreenElement];)r+=n.offsetLeft,o+=n.offsetTop,n=n.offsetParent;return{left:r,top:o,width:e,height:t}}function ZT(n,e){const t={x:0,y:0};if($s){let g=n;for(;g&&g.nodeName.toLowerCase()!=="html";){const v=sp(g,"transform");if(/^matrix/.test(v)){const _=v.slice(7,-1).split(/,\s/).map(Number);t.x+=_[4],t.y+=_[5]}else if(/^matrix3d/.test(v)){const _=v.slice(9,-1).split(/,\s/).map(Number);t.x+=_[12],t.y+=_[13]}g=g.parentNode}}const r={},o=i0(e.target),u=i0(n),h=u.width,f=u.height;let d=e.offsetY-(u.top-o.top),m=e.offsetX-(u.left-o.left);return e.changedTouches&&(m=e.changedTouches[0].pageX-u.left,d=e.changedTouches[0].pageY+u.top,$s&&(m-=t.x,d-=t.y)),r.y=1-Math.max(0,Math.min(1,d/f)),r.x=Math.max(0,Math.min(1,m/h)),r}function gK(n){return kl(n)&&n.nodeType===3}function eS(n){for(;n.firstChild;)n.removeChild(n.firstChild);return n}function mK(n){return typeof n=="function"&&(n=n()),(Array.isArray(n)?n:[n]).map(e=>{if(typeof e=="function"&&(e=e()),yp(e)||gK(e))return e;if(typeof e=="string"&&/\S/.test(e))return mn.createTextNode(e)}).filter(e=>e)}function GP(n,e){return mK(e).forEach(t=>n.appendChild(t)),n}function vK(n,e){return GP(eS(n),e)}function s0(n){return n.button===void 0&&n.buttons===void 0||n.button===0&&n.buttons===void 0||n.type==="mouseup"&&n.button===0&&n.buttons===0?!0:!(n.button!==0||n.buttons!==1)}const kc=uK("querySelector"),yK=uK("querySelectorAll");function sp(n,e){if(!n||!e)return"";if(typeof rt.getComputedStyle=="function"){let t;try{t=rt.getComputedStyle(n)}catch{return""}return t?t.getPropertyValue(e)||t[e]:""}return""}var EK=Object.freeze({__proto__:null,isReal:vp,isEl:yp,isInFrame:lK,createEl:dr,textContent:Vc,prependTo:db,hasClass:vm,addClass:Wf,removeClass:QT,toggleClass:cK,setAttributes:fK,getAttributes:vc,getAttribute:dK,setAttribute:rp,removeAttribute:JT,blockTextSelection:hK,unblockTextSelection:pK,getBoundingClientRect:ip,findPosition:i0,getPointerPosition:ZT,isTextNode:gK,emptyEl:eS,normalizeContent:mK,appendContent:GP,insertContent:vK,isSingleLeftClick:s0,$:kc,$$:yK,computedStyle:sp});let _K=!1,hb;const kre=function(){if(hb.options.autoSetup===!1)return;const n=Array.prototype.slice.call(mn.getElementsByTagName("video")),e=Array.prototype.slice.call(mn.getElementsByTagName("audio")),t=Array.prototype.slice.call(mn.getElementsByTagName("video-js")),r=n.concat(e,t);if(r&&r.length>0)for(let o=0,u=r.length;o<u;o++){const h=r[o];if(h&&h.getAttribute)h.player===void 0&&h.getAttribute("data-setup")!==null&&hb(h);else{pb(1);break}}else _K||pb(1)};function pb(n,e){vp()&&(e&&(hb=e),rt.setTimeout(kre,n))}function gb(){_K=!0,rt.removeEventListener("load",gb)}vp()&&(mn.readyState==="complete"?gb():rt.addEventListener("load",gb));const TK=function(n){const e=mn.createElement("style");return e.className=n,e},SK=function(n,e){n.styleSheet?n.styleSheet.cssText=e:n.textContent=e};var Ks=new WeakMap;const Ure=3;let Bre=Ure;function jl(){return Bre++}function R2(n,e){if(!Ks.has(n))return;const t=Ks.get(n);t.handlers[e].length===0&&(delete t.handlers[e],n.removeEventListener?n.removeEventListener(e,t.dispatcher,!1):n.detachEvent&&n.detachEvent("on"+e,t.dispatcher)),Object.getOwnPropertyNames(t.handlers).length<=0&&(delete t.handlers,delete t.dispatcher,delete t.disabled),Object.getOwnPropertyNames(t).length===0&&Ks.delete(n)}function WP(n,e,t,r){t.forEach(function(o){n(e,o,r)})}function tS(n){if(n.fixed_)return n;function e(){return!0}function t(){return!1}if(!n||!n.isPropagationStopped||!n.isImmediatePropagationStopped){const r=n||rt.event;n={};for(const o in r)o!=="layerX"&&o!=="layerY"&&o!=="keyLocation"&&o!=="webkitMovementX"&&o!=="webkitMovementY"&&o!=="path"&&(o==="returnValue"&&r.preventDefault||(n[o]=r[o]));if(n.target||(n.target=n.srcElement||mn),n.relatedTarget||(n.relatedTarget=n.fromElement===n.target?n.toElement:n.fromElement),n.preventDefault=function(){r.preventDefault&&r.preventDefault(),n.returnValue=!1,r.returnValue=!1,n.defaultPrevented=!0},n.defaultPrevented=!1,n.stopPropagation=function(){r.stopPropagation&&r.stopPropagation(),n.cancelBubble=!0,r.cancelBubble=!0,n.isPropagationStopped=e},n.isPropagationStopped=t,n.stopImmediatePropagation=function(){r.stopImmediatePropagation&&r.stopImmediatePropagation(),n.isImmediatePropagationStopped=e,n.stopPropagation()},n.isImmediatePropagationStopped=t,n.clientX!==null&&n.clientX!==void 0){const o=mn.documentElement,u=mn.body;n.pageX=n.clientX+(o&&o.scrollLeft||u&&u.scrollLeft||0)-(o&&o.clientLeft||u&&u.clientLeft||0),n.pageY=n.clientY+(o&&o.scrollTop||u&&u.scrollTop||0)-(o&&o.clientTop||u&&u.clientTop||0)}n.which=n.charCode||n.keyCode,n.button!==null&&n.button!==void 0&&(n.button=n.button&1?0:n.button&4?1:n.button&2?2:0)}return n.fixed_=!0,n}let iE;const jre=function(){if(typeof iE!="boolean"){iE=!1;try{const n=Object.defineProperty({},"passive",{get(){iE=!0}});rt.addEventListener("test",null,n),rt.removeEventListener("test",null,n)}catch{}}return iE},Kre=["touchstart","touchmove"];function Ha(n,e,t){if(Array.isArray(e))return WP(Ha,n,e,t);Ks.has(n)||Ks.set(n,{});const r=Ks.get(n);if(r.handlers||(r.handlers={}),r.handlers[e]||(r.handlers[e]=[]),t.guid||(t.guid=jl()),r.handlers[e].push(t),r.dispatcher||(r.disabled=!1,r.dispatcher=function(o,u){if(r.disabled)return;o=tS(o);const h=r.handlers[o.type];if(h){const f=h.slice(0);for(let d=0,m=f.length;d<m&&!o.isImmediatePropagationStopped();d++)try{f[d].call(n,o,u)}catch(g){Er.error(g)}}}),r.handlers[e].length===1)if(n.addEventListener){let o=!1;jre()&&Kre.indexOf(e)>-1&&(o={passive:!0}),n.addEventListener(e,r.dispatcher,o)}else n.attachEvent&&n.attachEvent("on"+e,r.dispatcher)}function Cs(n,e,t){if(!Ks.has(n))return;const r=Ks.get(n);if(!r.handlers)return;if(Array.isArray(e))return WP(Cs,n,e,t);const o=function(h,f){r.handlers[f]=[],R2(h,f)};if(e===void 0){for(const h in r.handlers)Object.prototype.hasOwnProperty.call(r.handlers||{},h)&&o(n,h);return}const u=r.handlers[e];if(u){if(!t){o(n,e);return}if(t.guid)for(let h=0;h<u.length;h++)u[h].guid===t.guid&&u.splice(h--,1);R2(n,e)}}function Ep(n,e,t){const r=Ks.has(n)?Ks.get(n):{},o=n.parentNode||n.ownerDocument;if(typeof e=="string"?e={type:e,target:n}:e.target||(e.target=n),e=tS(e),r.dispatcher&&r.dispatcher.call(n,e,t),o&&!e.isPropagationStopped()&&e.bubbles===!0)Ep.call(null,o,e,t);else if(!o&&!e.defaultPrevented&&e.target&&e.target[e.type]){Ks.has(e.target)||Ks.set(e.target,{});const u=Ks.get(e.target);e.target[e.type]&&(u.disabled=!0,typeof e.target[e.type]=="function"&&e.target[e.type](),u.disabled=!1)}return!e.defaultPrevented}function nS(n,e,t){if(Array.isArray(e))return WP(nS,n,e,t);const r=function(){Cs(n,e,r),t.apply(this,arguments)};r.guid=t.guid=t.guid||jl(),Ha(n,e,r)}function HP(n,e,t){const r=function(){Cs(n,e,r),t.apply(this,arguments)};r.guid=t.guid=t.guid||jl(),Ha(n,e,r)}var Gre=Object.freeze({__proto__:null,fixEvent:tS,on:Ha,off:Cs,trigger:Ep,one:nS,any:HP});const po=30,Qr=function(n,e,t){e.guid||(e.guid=jl());const r=e.bind(n);return r.guid=t?t+"_"+e.guid:e.guid,r},Kl=function(n,e){let t=rt.performance.now();return function(...o){const u=rt.performance.now();u-t>=e&&(n(...o),t=u)}},AK=function(n,e,t,r=rt){let o;const u=()=>{r.clearTimeout(o),o=null},h=function(){const f=this,d=arguments;let m=function(){o=null,m=null,t||n.apply(f,d)};!o&&t&&n.apply(f,d),r.clearTimeout(o),o=r.setTimeout(m,e)};return h.cancel=u,h};var Wre=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:po,bind_:Qr,throttle:Kl,debounce:AK});let Kg;class go{on(e,t){const r=this.addEventListener;this.addEventListener=()=>{},Ha(this,e,t),this.addEventListener=r}off(e,t){Cs(this,e,t)}one(e,t){const r=this.addEventListener;this.addEventListener=()=>{},nS(this,e,t),this.addEventListener=r}any(e,t){const r=this.addEventListener;this.addEventListener=()=>{},HP(this,e,t),this.addEventListener=r}trigger(e){const t=e.type||e;typeof e=="string"&&(e={type:t}),e=tS(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),Ep(this,e)}queueTrigger(e){Kg||(Kg=new Map);const t=e.type||e;let r=Kg.get(this);r||(r=new Map,Kg.set(this,r));const o=r.get(t);r.delete(t),rt.clearTimeout(o);const u=rt.setTimeout(()=>{r.delete(t),r.size===0&&(r=null,Kg.delete(this)),this.trigger(e)},0);r.set(t,u)}}go.prototype.allowedEvents_={};go.prototype.addEventListener=go.prototype.on;go.prototype.removeEventListener=go.prototype.off;go.prototype.dispatchEvent=go.prototype.trigger;const rS=n=>typeof n.name=="function"?n.name():typeof n.name=="string"?n.name:n.name_?n.name_:n.constructor&&n.constructor.name?n.constructor.name:typeof n,Du=n=>n instanceof go||!!n.eventBusEl_&&["on","one","off","trigger"].every(e=>typeof n[e]=="function"),Hre=(n,e)=>{Du(n)?e():(n.eventedCallbacks||(n.eventedCallbacks=[]),n.eventedCallbacks.push(e))},mb=n=>typeof n=="string"&&/\S/.test(n)||Array.isArray(n)&&!!n.length,N_=(n,e,t)=>{if(!n||!n.nodeName&&!Du(n))throw new Error(`Invalid target for ${rS(e)}#${t}; must be a DOM node or evented object.`)},xK=(n,e,t)=>{if(!mb(n))throw new Error(`Invalid event type for ${rS(e)}#${t}; must be a non-empty string or array.`)},CK=(n,e,t)=>{if(typeof n!="function")throw new Error(`Invalid listener for ${rS(e)}#${t}; must be a function.`)},oI=(n,e,t)=>{const r=e.length<3||e[0]===n||e[0]===n.eventBusEl_;let o,u,h;return r?(o=n.eventBusEl_,e.length>=3&&e.shift(),[u,h]=e):[o,u,h]=e,N_(o,n,t),xK(u,n,t),CK(h,n,t),h=Qr(n,h),{isTargetingSelf:r,target:o,type:u,listener:h}},Af=(n,e,t,r)=>{N_(n,n,e),n.nodeName?Gre[e](n,t,r):n[e](t,r)},Vre={on(...n){const{isTargetingSelf:e,target:t,type:r,listener:o}=oI(this,n,"on");if(Af(t,"on",r,o),!e){const u=()=>this.off(t,r,o);u.guid=o.guid;const h=()=>this.off("dispose",u);h.guid=o.guid,Af(this,"on","dispose",u),Af(t,"on","dispose",h)}},one(...n){const{isTargetingSelf:e,target:t,type:r,listener:o}=oI(this,n,"one");if(e)Af(t,"one",r,o);else{const u=(...h)=>{this.off(t,r,u),o.apply(null,h)};u.guid=o.guid,Af(t,"one",r,u)}},any(...n){const{isTargetingSelf:e,target:t,type:r,listener:o}=oI(this,n,"any");if(e)Af(t,"any",r,o);else{const u=(...h)=>{this.off(t,r,u),o.apply(null,h)};u.guid=o.guid,Af(t,"any",r,u)}},off(n,e,t){if(!n||mb(n))Cs(this.eventBusEl_,n,e);else{const r=n,o=e;N_(r,this,"off"),xK(o,this,"off"),CK(t,this,"off"),t=Qr(this,t),this.off("dispose",t),r.nodeName?(Cs(r,o,t),Cs(r,"dispose",t)):Du(r)&&(r.off(o,t),r.off("dispose",t))}},trigger(n,e){N_(this.eventBusEl_,this,"trigger");const t=n&&typeof n!="string"?n.type:n;if(!mb(t))throw new Error(`Invalid event type for ${rS(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`);return Ep(this.eventBusEl_,n,e)}};function VP(n,e={}){const{eventBusKey:t}=e;if(t){if(!n[t].nodeName)throw new Error(`The eventBusKey "${t}" does not refer to an element.`);n.eventBusEl_=n[t]}else n.eventBusEl_=dr("span",{className:"vjs-event-bus"});return Object.assign(n,Vre),n.eventedCallbacks&&n.eventedCallbacks.forEach(r=>{r()}),n.on("dispose",()=>{n.off(),[n,n.el_,n.eventBusEl_].forEach(function(r){r&&Ks.has(r)&&Ks.delete(r)}),rt.setTimeout(()=>{n.eventBusEl_=null},0)}),n}const $re={state:{},setState(n){typeof n=="function"&&(n=n());let e;return Nh(n,(t,r)=>{this.state[r]!==t&&(e=e||{},e[r]={from:this.state[r],to:t}),this.state[r]=t}),e&&Du(this)&&this.trigger({changes:e,type:"statechanged"}),e}};function IK(n,e){return Object.assign(n,$re),n.state=Object.assign({},n.state,e),typeof n.handleStateChanged=="function"&&Du(n)&&n.on("statechanged",n.handleStateChanged),n}const ym=function(n){return typeof n!="string"?n:n.replace(/./,e=>e.toLowerCase())},Pi=function(n){return typeof n!="string"?n:n.replace(/./,e=>e.toUpperCase())},RK=function(n,e){return Pi(n)===Pi(e)};var zre=Object.freeze({__proto__:null,toLowerCase:ym,toTitleCase:Pi,titleCaseEquals:RK});class qt{constructor(e,t,r){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=Xr({},this.options_),t=this.options_=Xr(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){const o=e&&e.id&&e.id()||"no_player";this.id_=`${o}_component_${jl()}`}this.name_=t.name||null,t.el?this.el_=t.el:t.createEl!==!1&&(this.el_=this.createEl()),t.className&&this.el_&&t.className.split(" ").forEach(o=>this.addClass(o)),["on","off","one","any","trigger"].forEach(o=>{this[o]=void 0}),t.evented!==!1&&(VP(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),IK(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,this.clearingTimersOnDispose_=!1,t.initChildren!==!1&&this.initChildren(),this.ready(r),t.reportTouchActivity!==!1&&this.enableTouchActivity()}on(e,t){}off(e,t){}one(e,t){}any(e,t){}trigger(e){}dispose(e={}){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let t=this.children_.length-1;t>=0;t--)this.children_[t].dispose&&this.children_[t].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(e.restoreEl?this.el_.parentNode.replaceChild(e.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return Boolean(this.isDisposed_)}player(){return this.player_}options(e){return e?(this.options_=Xr(this.options_,e),this.options_):this.options_}el(){return this.el_}createEl(e,t,r){return dr(e,t,r)}localize(e,t,r=e){const o=this.player_.language&&this.player_.language(),u=this.player_.languages&&this.player_.languages(),h=u&&u[o],f=o&&o.split("-")[0],d=u&&u[f];let m=r;return h&&h[e]?m=h[e]:d&&d[e]&&(m=d[e]),t&&(m=m.replace(/\{(\d+)\}/g,function(g,v){const _=t[v-1];let S=_;return typeof _>"u"&&(S=g),S})),m}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(e){return this.childIndex_[e]}getChild(e){if(e)return this.childNameIndex_[e]}getDescendant(...e){e=e.reduce((r,o)=>r.concat(o),[]);let t=this;for(let r=0;r<e.length;r++)if(t=t.getChild(e[r]),!t||!t.getChild)return;return t}addChild(e,t={},r=this.children_.length){let o,u;if(typeof e=="string"){u=Pi(e);const h=t.componentClass||u;t.name=u;const f=qt.getComponent(h);if(!f)throw new Error(`Component ${h} does not exist`);if(typeof f!="function")return null;o=new f(this.player_||this,t)}else o=e;if(o.parentComponent_&&o.parentComponent_.removeChild(o),this.children_.splice(r,0,o),o.parentComponent_=this,typeof o.id=="function"&&(this.childIndex_[o.id()]=o),u=u||o.name&&Pi(o.name()),u&&(this.childNameIndex_[u]=o,this.childNameIndex_[ym(u)]=o),typeof o.el=="function"&&o.el()){let h=null;this.children_[r+1]&&(this.children_[r+1].el_?h=this.children_[r+1].el_:yp(this.children_[r+1])&&(h=this.children_[r+1])),this.contentEl().insertBefore(o.el(),h)}return o}removeChild(e){if(typeof e=="string"&&(e=this.getChild(e)),!e||!this.children_)return;let t=!1;for(let o=this.children_.length-1;o>=0;o--)if(this.children_[o]===e){t=!0,this.children_.splice(o,1);break}if(!t)return;e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[Pi(e.name())]=null,this.childNameIndex_[ym(e.name())]=null;const r=e.el();r&&r.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}initChildren(){const e=this.options_.children;if(e){const t=this.options_,r=h=>{const f=h.name;let d=h.opts;if(t[f]!==void 0&&(d=t[f]),d===!1)return;d===!0&&(d={}),d.playerOptions=this.options_.playerOptions;const m=this.addChild(f,d);m&&(this[f]=m)};let o;const u=qt.getComponent("Tech");Array.isArray(e)?o=e:o=Object.keys(e),o.concat(Object.keys(this.options_).filter(function(h){return!o.some(function(f){return typeof f=="string"?h===f:h===f.name})})).map(h=>{let f,d;return typeof h=="string"?(f=h,d=e[f]||this.options_[f]||{}):(f=h.name,d=h),{name:f,opts:d}}).filter(h=>{const f=qt.getComponent(h.opts.componentClass||Pi(h.name));return f&&!u.isTech(f)}).forEach(r)}}buildCSSClass(){return""}ready(e,t=!1){if(e){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(e);return}t?e.call(this):this.setTimeout(e,1)}}triggerReady(){this.isReady_=!0,this.setTimeout(function(){const e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(t){t.call(this)},this),this.trigger("ready")},1)}$(e,t){return kc(e,t||this.contentEl())}$$(e,t){return yK(e,t||this.contentEl())}hasClass(e){return vm(this.el_,e)}addClass(...e){Wf(this.el_,...e)}removeClass(...e){QT(this.el_,...e)}toggleClass(e,t){cK(this.el_,e,t)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(e){return dK(this.el_,e)}setAttribute(e,t){rp(this.el_,e,t)}removeAttribute(e){JT(this.el_,e)}width(e,t){return this.dimension("width",e,t)}height(e,t){return this.dimension("height",e,t)}dimensions(e,t){this.width(e,!0),this.height(t)}dimension(e,t,r){if(t!==void 0){(t===null||t!==t)&&(t=0),(""+t).indexOf("%")!==-1||(""+t).indexOf("px")!==-1?this.el_.style[e]=t:t==="auto"?this.el_.style[e]="":this.el_.style[e]=t+"px",r||this.trigger("componentresize");return}if(!this.el_)return 0;const o=this.el_.style[e],u=o.indexOf("px");return parseInt(u!==-1?o.slice(0,u):this.el_["offset"+Pi(e)],10)}currentDimension(e){let t=0;if(e!=="width"&&e!=="height")throw new Error("currentDimension only accepts width or height value");if(t=sp(this.el_,e),t=parseFloat(t),t===0||isNaN(t)){const r=`offset${Pi(e)}`;t=this.el_[r]}return t}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(e){this.player_&&(qn.isEventKey(e,"Tab")||e.stopPropagation(),this.player_.handleKeyDown(e))}handleKeyPress(e){this.handleKeyDown(e)}emitTapEvents(){let e=0,t=null;const r=10,o=200;let u;this.on("touchstart",function(f){f.touches.length===1&&(t={pageX:f.touches[0].pageX,pageY:f.touches[0].pageY},e=rt.performance.now(),u=!0)}),this.on("touchmove",function(f){if(f.touches.length>1)u=!1;else if(t){const d=f.touches[0].pageX-t.pageX,m=f.touches[0].pageY-t.pageY;Math.sqrt(d*d+m*m)>r&&(u=!1)}});const h=function(){u=!1};this.on("touchleave",h),this.on("touchcancel",h),this.on("touchend",function(f){t=null,u===!0&&rt.performance.now()-e<o&&(f.preventDefault(),this.trigger("tap"))})}enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity)return;const e=Qr(this.player(),this.player().reportUserActivity);let t;this.on("touchstart",function(){e(),this.clearInterval(t),t=this.setInterval(e,250)});const r=function(o){e(),this.clearInterval(t)};this.on("touchmove",e),this.on("touchend",r),this.on("touchcancel",r)}setTimeout(e,t){var r;return e=Qr(this,e),this.clearTimersOnDispose_(),r=rt.setTimeout(()=>{this.setTimeoutIds_.has(r)&&this.setTimeoutIds_.delete(r),e()},t),this.setTimeoutIds_.add(r),r}clearTimeout(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),rt.clearTimeout(e)),e}setInterval(e,t){e=Qr(this,e),this.clearTimersOnDispose_();const r=rt.setInterval(e,t);return this.setIntervalIds_.add(r),r}clearInterval(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),rt.clearInterval(e)),e}requestAnimationFrame(e){this.clearTimersOnDispose_();var t;return e=Qr(this,e),t=rt.requestAnimationFrame(()=>{this.rafIds_.has(t)&&this.rafIds_.delete(t),e()}),this.rafIds_.add(t),t}requestNamedAnimationFrame(e,t){if(this.namedRafs_.has(e))return;this.clearTimersOnDispose_(),t=Qr(this,t);const r=this.requestAnimationFrame(()=>{t(),this.namedRafs_.has(e)&&this.namedRafs_.delete(e)});return this.namedRafs_.set(e,r),e}cancelNamedAnimationFrame(e){this.namedRafs_.has(e)&&(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))}cancelAnimationFrame(e){return this.rafIds_.has(e)&&(this.rafIds_.delete(e),rt.cancelAnimationFrame(e)),e}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(([e,t])=>{this[e].forEach((r,o)=>this[t](o))}),this.clearingTimersOnDispose_=!1}))}static registerComponent(e,t){if(typeof e!="string"||!e)throw new Error(`Illegal component name, "${e}"; must be a non-empty string.`);const r=qt.getComponent("Tech"),o=r&&r.isTech(t),u=qt===t||qt.prototype.isPrototypeOf(t.prototype);if(o||!u){let f;throw o?f="techs must be registered using Tech.registerTech()":f="must be a Component subclass",new Error(`Illegal component, "${e}"; ${f}.`)}e=Pi(e),qt.components_||(qt.components_={});const h=qt.getComponent("Player");if(e==="Player"&&h&&h.players){const f=h.players,d=Object.keys(f);if(f&&d.length>0&&d.map(m=>f[m]).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return qt.components_[e]=t,qt.components_[ym(e)]=t,t}static getComponent(e){if(!(!e||!qt.components_))return qt.components_[e]}}qt.registerComponent("Component",qt);function Yre(n,e,t){if(typeof e!="number"||e<0||e>t)throw new Error(`Failed to execute '${n}' on 'TimeRanges': The index provided (${e}) is non-numeric or out of bounds (0-${t}).`)}function b2(n,e,t,r){return Yre(n,r,t.length-1),t[r][e]}function lI(n){let e;return n===void 0||n.length===0?e={length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:e={length:n.length,start:b2.bind(null,"start",0,n),end:b2.bind(null,"end",1,n)},rt.Symbol&&rt.Symbol.iterator&&(e[rt.Symbol.iterator]=()=>(n||[]).values()),e}function Ll(n,e){return Array.isArray(n)?lI(n):n===void 0||e===void 0?lI():lI([[n,e]])}const bK=function(n,e){n=n<0?0:n;let t=Math.floor(n%60),r=Math.floor(n/60%60),o=Math.floor(n/3600);const u=Math.floor(e/60%60),h=Math.floor(e/3600);return(isNaN(n)||n===1/0)&&(o=r=t="-"),o=o>0||h>0?o+":":"",r=((o||u>=10)&&r<10?"0"+r:r)+":",t=t<10?"0"+t:t,o+r+t};let $P=bK;function DK(n){$P=n}function PK(){$P=bK}function ed(n,e=n){return $P(n,e)}var Xre=Object.freeze({__proto__:null,createTimeRanges:Ll,createTimeRange:Ll,setFormatTime:DK,resetFormatTime:PK,formatTime:ed});function LK(n,e){let t=0,r,o;if(!e)return 0;(!n||!n.length)&&(n=Ll(0,0));for(let u=0;u<n.length;u++)r=n.start(u),o=n.end(u),o>e&&(o=e),t+=o-r;return t/e}function Gs(n){if(n instanceof Gs)return n;typeof n=="number"?this.code=n:typeof n=="string"?this.message=n:kl(n)&&(typeof n.code=="number"&&(this.code=n.code),Object.assign(this,n)),this.message||(this.message=Gs.defaultMessages[this.code]||"")}Gs.prototype.code=0;Gs.prototype.message="";Gs.prototype.status=null;Gs.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];Gs.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(let n=0;n<Gs.errorTypes.length;n++)Gs[Gs.errorTypes[n]]=n,Gs.prototype[Gs.errorTypes[n]]=n;function Em(n){return n!=null&&typeof n.then=="function"}function Al(n){Em(n)&&n.then(null,e=>{})}const vb=function(n){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((t,r,o)=>(n[r]&&(t[r]=n[r]),t),{cues:n.cues&&Array.prototype.map.call(n.cues,function(t){return{startTime:t.startTime,endTime:t.endTime,text:t.text,id:t.id}})})},qre=function(n){const e=n.$$("track"),t=Array.prototype.map.call(e,o=>o.track);return Array.prototype.map.call(e,function(o){const u=vb(o.track);return o.src&&(u.src=o.src),u}).concat(Array.prototype.filter.call(n.textTracks(),function(o){return t.indexOf(o)===-1}).map(vb))},Qre=function(n,e){return n.forEach(function(t){const r=e.addRemoteTextTrack(t).track;!t.src&&t.cues&&t.cues.forEach(o=>r.addCue(o))}),e.textTracks()};var D2={textTracksToJson:qre,jsonToTextTracks:Qre,trackToJson_:vb};const uI="vjs-modal-dialog";class _p extends qt{constructor(e,t){super(e,t),this.handleKeyDown_=r=>this.handleKeyDown(r),this.close_=r=>this.close(r),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=dr("div",{className:`${uI}-content`},{role:"document"}),this.descEl_=dr("p",{className:`${uI}-description vjs-control-text`,id:this.el().getAttribute("aria-describedby")}),Vc(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":`${this.id()}_description`,"aria-hidden":"true","aria-label":this.label(),role:"dialog"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return`${uI} vjs-hidden ${super.buildCSSClass()}`}label(){return this.localize(this.options_.label||"Modal Window")}description(){let e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e}open(){if(!this.opened_){const e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}}opened(e){return typeof e=="boolean"&&this[e?"open":"close"](),this.opened_}close(){if(!this.opened_)return;const e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}closeable(e){if(typeof e=="boolean"){const t=this.closeable_=!!e;let r=this.getChild("closeButton");if(t&&!r){const o=this.contentEl_;this.contentEl_=this.el_,r=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=o,this.on(r,"close",this.close_)}!t&&r&&(this.off(r,"close",this.close_),this.removeChild(r),r.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(e){const t=this.contentEl(),r=t.parentNode,o=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,r.removeChild(t),this.empty(),vK(t,e),this.trigger("modalfill"),o?r.insertBefore(t,o):r.appendChild(t);const u=this.getChild("closeButton");u&&r.appendChild(u.el_)}empty(){this.trigger("beforemodalempty"),eS(this.contentEl()),this.trigger("modalempty")}content(e){return typeof e<"u"&&(this.content_=e),this.content_}conditionalFocus_(){const e=mn.activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,(t.contains(e)||t===e)&&(this.previouslyActiveEl_=e,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(e){if(e.stopPropagation(),qn.isEventKey(e,"Escape")&&this.closeable()){e.preventDefault(),this.close();return}if(!qn.isEventKey(e,"Tab"))return;const t=this.focusableEls_(),r=this.el_.querySelector(":focus");let o;for(let u=0;u<t.length;u++)if(r===t[u]){o=u;break}mn.activeElement===this.el_&&(o=0),e.shiftKey&&o===0?(t[t.length-1].focus(),e.preventDefault()):!e.shiftKey&&o===t.length-1&&(t[0].focus(),e.preventDefault())}focusableEls_(){const e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,t=>(t instanceof rt.HTMLAnchorElement||t instanceof rt.HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof rt.HTMLInputElement||t instanceof rt.HTMLSelectElement||t instanceof rt.HTMLTextAreaElement||t instanceof rt.HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof rt.HTMLIFrameElement||t instanceof rt.HTMLObjectElement||t instanceof rt.HTMLEmbedElement||t.hasAttribute("tabindex")&&t.getAttribute("tabindex")!==-1||t.hasAttribute("contenteditable"))}}_p.prototype.options_={pauseOnOpen:!0,temporary:!0};qt.registerComponent("ModalDialog",_p);class ap extends go{constructor(e=[]){super(),this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let t=0;t<e.length;t++)this.addTrack(e[t])}addTrack(e){const t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get(){return this.tracks_[t]}}),this.tracks_.indexOf(e)===-1&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this})),e.labelchange_=()=>{this.trigger({track:e,type:"labelchange",target:this})},Du(e)&&e.addEventListener("labelchange",e.labelchange_)}removeTrack(e){let t;for(let r=0,o=this.length;r<o;r++)if(this[r]===e){t=this[r],t.off&&t.off(),this.tracks_.splice(r,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})}getTrackById(e){let t=null;for(let r=0,o=this.length;r<o;r++){const u=this[r];if(u.id===e){t=u;break}}return t}}ap.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(const n in ap.prototype.allowedEvents_)ap.prototype["on"+n]=null;const cI=function(n,e){for(let t=0;t<n.length;t++)!Object.keys(n[t]).length||e.id===n[t].id||(n[t].enabled=!1)};class Jre extends ap{constructor(e=[]){for(let t=e.length-1;t>=0;t--)if(e[t].enabled){cI(e,e[t]);break}super(e),this.changing_=!1}addTrack(e){e.enabled&&cI(this,e),super.addTrack(e),e.addEventListener&&(e.enabledChange_=()=>{this.changing_||(this.changing_=!0,cI(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)}}const fI=function(n,e){for(let t=0;t<n.length;t++)!Object.keys(n[t]).length||e.id===n[t].id||(n[t].selected=!1)};class Zre extends ap{constructor(e=[]){for(let t=e.length-1;t>=0;t--)if(e[t].selected){fI(e,e[t]);break}super(e),this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let t=0;t<this.length;t++)if(this[t].selected)return t;return-1},set(){}})}addTrack(e){e.selected&&fI(this,e),super.addTrack(e),e.addEventListener&&(e.selectedChange_=()=>{this.changing_||(this.changing_=!0,fI(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)}}class MK extends ap{addTrack(e){super.addTrack(e),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),e.addEventListener("modechange",this.queueChange_),["metadata","chapters"].indexOf(e.kind)===-1&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(e){super.removeTrack(e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))}}class eie{constructor(e=[]){this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let t=0,r=e.length;t<r;t++)this.addTrackElement_(e[t])}addTrackElement_(e){const t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get(){return this.trackElements_[t]}}),this.trackElements_.indexOf(e)===-1&&this.trackElements_.push(e)}getTrackElementByTrack_(e){let t;for(let r=0,o=this.trackElements_.length;r<o;r++)if(e===this.trackElements_[r].track){t=this.trackElements_[r];break}return t}removeTrackElement_(e){for(let t=0,r=this.trackElements_.length;t<r;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&typeof this.trackElements_[t].track.off=="function"&&this.trackElements_[t].track.off(),typeof this.trackElements_[t].off=="function"&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}}}class F_{constructor(e){F_.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(e){const t=this.length||0;let r=0;const o=e.length;this.cues_=e,this.length_=e.length;const u=function(h){""+h in this||Object.defineProperty(this,""+h,{get(){return this.cues_[h]}})};if(t<o)for(r=t;r<o;r++)u.call(this,r)}getCueById(e){let t=null;for(let r=0,o=this.length;r<o;r++){const u=this[r];if(u.id===e){t=u;break}}return t}}const tie={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},nie={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},rie={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},P2={disabled:"disabled",hidden:"hidden",showing:"showing"};class zP extends go{constructor(e={}){super();const t={id:e.id||"vjs_track_"+jl(),kind:e.kind||"",language:e.language||""};let r=e.label||"";for(const o in t)Object.defineProperty(this,o,{get(){return t[o]},set(){}});Object.defineProperty(this,"label",{get(){return r},set(o){o!==r&&(r=o,this.trigger("labelchange"))}})}}const YP=function(n){const e=["protocol","hostname","port","pathname","search","hash","host"],t=mn.createElement("a");t.href=n;const r={};for(let o=0;o<e.length;o++)r[e[o]]=t[e[o]];return r.protocol==="http:"&&(r.host=r.host.replace(/:80$/,"")),r.protocol==="https:"&&(r.host=r.host.replace(/:443$/,"")),r.protocol||(r.protocol=rt.location.protocol),r.host||(r.host=rt.location.host),r},wK=function(n){if(!n.match(/^https?:\/\//)){const e=mn.createElement("a");e.href=n,n=e.href}return n},XP=function(n){if(typeof n=="string"){const t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(n);if(t)return t.pop().toLowerCase()}return""},iS=function(n,e=rt.location){const t=YP(n);return(t.protocol===":"?e.protocol:t.protocol)+t.host!==e.protocol+e.host};var iie=Object.freeze({__proto__:null,parseUrl:YP,getAbsoluteURL:wK,getFileExtension:XP,isCrossOrigin:iS});const L2=function(n,e){const t=new rt.WebVTT.Parser(rt,rt.vttjs,rt.WebVTT.StringDecoder()),r=[];t.oncue=function(o){e.addCue(o)},t.onparsingerror=function(o){r.push(o)},t.onflush=function(){e.trigger({type:"loadeddata",target:e})},t.parse(n),r.length>0&&(rt.console&&rt.console.groupCollapsed&&rt.console.groupCollapsed(`Text Track parsing errors for ${e.src}`),r.forEach(o=>Er.error(o)),rt.console&&rt.console.groupEnd&&rt.console.groupEnd()),t.flush()},M2=function(n,e){const t={uri:n},r=iS(n);r&&(t.cors=r);const o=e.tech_.crossOrigin()==="use-credentials";o&&(t.withCredentials=o),Qm(t,Qr(this,function(u,h,f){if(u)return Er.error(u,h);e.loaded_=!0,typeof rt.WebVTT!="function"?e.tech_&&e.tech_.any(["vttjsloaded","vttjserror"],d=>{if(d.type==="vttjserror"){Er.error(`vttjs failed to load, stopping trying to process ${e.src}`);return}return L2(f,e)}):L2(f,e)}))};class S0 extends zP{constructor(e={}){if(!e.tech)throw new Error("A tech was not provided.");const t=Xr(e,{kind:rie[e.kind]||"subtitles",language:e.language||e.srclang||""});let r=P2[t.mode]||"disabled";const o=t.default;(t.kind==="metadata"||t.kind==="chapters")&&(r="hidden"),super(t),this.tech_=t.tech,this.cues_=[],this.activeCues_=[],this.preload_=this.tech_.preloadTextTracks!==!1;const u=new F_(this.cues_),h=new F_(this.activeCues_);let f=!1;this.timeupdateHandler=Qr(this,function(m={}){if(!this.tech_.isDisposed()){if(!this.tech_.isReady_){m.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler));return}this.activeCues=this.activeCues,f&&(this.trigger("cuechange"),f=!1),m.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))}});const d=()=>{this.stopTracking()};this.tech_.one("dispose",d),r!=="disabled"&&this.startTracking(),Object.defineProperties(this,{default:{get(){return o},set(){}},mode:{get(){return r},set(m){P2[m]&&r!==m&&(r=m,!this.preload_&&r!=="disabled"&&this.cues.length===0&&M2(this.src,this),this.stopTracking(),r!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?u:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(this.cues.length===0)return h;const m=this.tech_.currentTime(),g=[];for(let v=0,_=this.cues.length;v<_;v++){const S=this.cues[v];S.startTime<=m&&S.endTime>=m&&g.push(S)}if(f=!1,g.length!==this.activeCues_.length)f=!0;else for(let v=0;v<g.length;v++)this.activeCues_.indexOf(g[v])===-1&&(f=!0);return this.activeCues_=g,h.setCues_(this.activeCues_),h},set(){}}}),t.src?(this.src=t.src,this.preload_||(this.loaded_=!0),(this.preload_||t.kind!=="subtitles"&&t.kind!=="captions")&&M2(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(e){let t=e;if(rt.vttjs&&!(e instanceof rt.vttjs.VTTCue)){t=new rt.vttjs.VTTCue(e.startTime,e.endTime,e.text);for(const o in e)o in t||(t[o]=e[o]);t.id=e.id,t.originalCue_=e}const r=this.tech_.textTracks();for(let o=0;o<r.length;o++)r[o]!==this&&r[o].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)}removeCue(e){let t=this.cues_.length;for(;t--;){const r=this.cues_[t];if(r===e||r.originalCue_&&r.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}}}S0.prototype.allowedEvents_={cuechange:"cuechange"};class OK extends zP{constructor(e={}){const t=Xr(e,{kind:nie[e.kind]||""});super(t);let r=!1;Object.defineProperty(this,"enabled",{get(){return r},set(o){typeof o!="boolean"||o===r||(r=o,this.trigger("enabledchange"))}}),t.enabled&&(this.enabled=t.enabled),this.loaded_=!0}}class NK extends zP{constructor(e={}){const t=Xr(e,{kind:tie[e.kind]||""});super(t);let r=!1;Object.defineProperty(this,"selected",{get(){return r},set(o){typeof o!="boolean"||o===r||(r=o,this.trigger("selectedchange"))}}),t.selected&&(this.selected=t.selected)}}class ku extends go{constructor(e={}){super();let t;const r=new S0(e);this.kind=r.kind,this.src=r.src,this.srclang=r.language,this.label=r.label,this.default=r.default,Object.defineProperties(this,{readyState:{get(){return t}},track:{get(){return r}}}),t=ku.NONE,r.addEventListener("loadeddata",()=>{t=ku.LOADED,this.trigger({type:"load",target:this})})}}ku.prototype.allowedEvents_={load:"load"};ku.NONE=0;ku.LOADING=1;ku.LOADED=2;ku.ERROR=3;const co={audio:{ListClass:Jre,TrackClass:OK,capitalName:"Audio"},video:{ListClass:Zre,TrackClass:NK,capitalName:"Video"},text:{ListClass:MK,TrackClass:S0,capitalName:"Text"}};Object.keys(co).forEach(function(n){co[n].getterName=`${n}Tracks`,co[n].privateName=`${n}Tracks_`});const op={remoteText:{ListClass:MK,TrackClass:S0,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:eie,TrackClass:ku,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},Us=Object.assign({},co,op);op.names=Object.keys(op);co.names=Object.keys(co);Us.names=[].concat(op.names).concat(co.names);function sie(n,e,t,r,o={}){const u=n.textTracks();o.kind=e,t&&(o.label=t),r&&(o.language=r),o.tech=n;const h=new Us.text.TrackClass(o);return u.addTrack(h),h}class ir extends qt{constructor(e={},t=function(){}){e.reportTouchActivity=!1,super(null,e,t),this.onDurationChange_=r=>this.onDurationChange(r),this.trackProgress_=r=>this.trackProgress(r),this.trackCurrentTime_=r=>this.trackCurrentTime(r),this.stopTrackingCurrentTime_=r=>this.stopTrackingCurrentTime(r),this.disposeSourceHandler_=r=>this.disposeSourceHandler(r),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",function(){this.hasStarted_=!0}),this.on("loadstart",function(){this.hasStarted_=!1}),Us.names.forEach(r=>{const o=Us[r];e&&e[o.getterName]&&(this[o.privateName]=e[o.getterName])}),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(r=>{e[`native${r}Tracks`]===!1&&(this[`featuresNative${r}Tracks`]=!1)}),e.nativeCaptions===!1||e.nativeTextTracks===!1?this.featuresNativeTextTracks=!1:(e.nativeCaptions===!0||e.nativeTextTracks===!0)&&(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=e.preloadTextTracks!==!1,this.autoRemoteTextTracks_=new Us.text.ListClass,this.initTrackListeners(),e.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(e){this.isReady_||this.one("ready",()=>this.setTimeout(()=>this.triggerSourceset(e),1)),this.trigger({src:e,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Qr(this,function(){const t=this.bufferedPercent();this.bufferedPercent_!==t&&this.trigger("progress"),this.bufferedPercent_=t,t===1&&this.stopTrackingProgress()}),500)}onDurationChange(e){this.duration_=this.duration()}buffered(){return Ll(0,0)}bufferedPercent(){return LK(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(co.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(e){e=[].concat(e),e.forEach(t=>{const r=this[`${t}Tracks`]()||[];let o=r.length;for(;o--;){const u=r[o];t==="text"&&this.removeRemoteTextTrack(u),r.removeTrack(u)}})}cleanupAutoTextTracks(){const e=this.autoRemoteTextTracks_||[];let t=e.length;for(;t--;){const r=e[t];this.removeRemoteTextTrack(r)}}reset(){}crossOrigin(){}setCrossOrigin(){}error(e){return e!==void 0&&(this.error_=new Gs(e),this.trigger("error")),this.error_}played(){return this.hasStarted_?Ll(0,0):Ll()}play(){}setScrubbing(e){}scrubbing(){}setCurrentTime(e){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){co.names.forEach(e=>{const t=co[e],r=()=>{this.trigger(`${e}trackchange`)},o=this[t.getterName]();o.addEventListener("removetrack",r),o.addEventListener("addtrack",r),this.on("dispose",()=>{o.removeEventListener("removetrack",r),o.removeEventListener("addtrack",r)})})}addWebVttScript_(){if(!rt.WebVTT)if(mn.body.contains(this.el())){if(!this.options_["vtt.js"]&&np(A_)&&Object.keys(A_).length>0){this.trigger("vttjsloaded");return}const e=mn.createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",e.onload=()=>{this.trigger("vttjsloaded")},e.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",()=>{e.onload=null,e.onerror=null}),rt.WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const e=this.textTracks(),t=this.remoteTextTracks(),r=f=>e.addTrack(f.track),o=f=>e.removeTrack(f.track);t.on("addtrack",r),t.on("removetrack",o),this.addWebVttScript_();const u=()=>this.trigger("texttrackchange"),h=()=>{u();for(let f=0;f<e.length;f++){const d=e[f];d.removeEventListener("cuechange",u),d.mode==="showing"&&d.addEventListener("cuechange",u)}};h(),e.addEventListener("change",h),e.addEventListener("addtrack",h),e.addEventListener("removetrack",h),this.on("dispose",function(){t.off("addtrack",r),t.off("removetrack",o),e.removeEventListener("change",h),e.removeEventListener("addtrack",h),e.removeEventListener("removetrack",h);for(let f=0;f<e.length;f++)e[f].removeEventListener("cuechange",u)})}addTextTrack(e,t,r){if(!e)throw new Error("TextTrack kind is required but was not provided");return sie(this,e,t,r)}createRemoteTextTrack(e){const t=Xr(e,{tech:this});return new op.remoteTextEl.TrackClass(t)}addRemoteTextTrack(e={},t){const r=this.createRemoteTextTrack(e);return typeof t!="boolean"&&(t=!1),this.remoteTextTrackEls().addTrackElement_(r),this.remoteTextTracks().addTrack(r.track),t===!1&&this.ready(()=>this.autoRemoteTextTracks_.addTrack(r.track)),r}removeRemoteTextTrack(e){const t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(e){const t=jl();return!this.isReady_||this.paused()?(this.queuedHanders_.add(t),this.one("playing",()=>{this.queuedHanders_.has(t)&&(this.queuedHanders_.delete(t),e())})):this.requestNamedAnimationFrame(t,e),t}cancelVideoFrameCallback(e){this.queuedHanders_.has(e)?this.queuedHanders_.delete(e):this.cancelNamedAnimationFrame(e)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(e){}overrideNativeVideoTracks(e){}canPlayType(e){return""}static canPlayType(e){return""}static canPlaySource(e,t){return ir.canPlayType(e.type)}static isTech(e){return e.prototype instanceof ir||e instanceof ir||e===ir}static registerTech(e,t){if(ir.techs_||(ir.techs_={}),!ir.isTech(t))throw new Error(`Tech ${e} must be a Tech`);if(!ir.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!ir.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Pi(e),ir.techs_[e]=t,ir.techs_[ym(e)]=t,e!=="Tech"&&ir.defaultTechOrder_.push(e),t}static getTech(e){if(e){if(ir.techs_&&ir.techs_[e])return ir.techs_[e];if(e=Pi(e),rt&&rt.videojs&&rt.videojs[e])return Er.warn(`The ${e} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),rt.videojs[e]}}}Us.names.forEach(function(n){const e=Us[n];ir.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}});ir.prototype.featuresVolumeControl=!0;ir.prototype.featuresMuteControl=!0;ir.prototype.featuresFullscreenResize=!1;ir.prototype.featuresPlaybackRate=!1;ir.prototype.featuresProgressEvents=!1;ir.prototype.featuresSourceset=!1;ir.prototype.featuresTimeupdateEvents=!1;ir.prototype.featuresNativeTextTracks=!1;ir.prototype.featuresVideoFrameCallback=!1;ir.withSourceHandlers=function(n){n.registerSourceHandler=function(t,r){let o=n.sourceHandlers;o||(o=n.sourceHandlers=[]),r===void 0&&(r=o.length),o.splice(r,0,t)},n.canPlayType=function(t){const r=n.sourceHandlers||[];let o;for(let u=0;u<r.length;u++)if(o=r[u].canPlayType(t),o)return o;return""},n.selectSourceHandler=function(t,r){const o=n.sourceHandlers||[];let u;for(let h=0;h<o.length;h++)if(u=o[h].canHandleSource(t,r),u)return o[h];return null},n.canPlaySource=function(t,r){const o=n.selectSourceHandler(t,r);return o?o.canHandleSource(t,r):""},["seekable","seeking","duration"].forEach(function(t){const r=this[t];typeof r=="function"&&(this[t]=function(){return this.sourceHandler_&&this.sourceHandler_[t]?this.sourceHandler_[t].apply(this.sourceHandler_,arguments):r.apply(this,arguments)})},n.prototype),n.prototype.setSource=function(t){let r=n.selectSourceHandler(t,this.options_);r||(n.nativeSourceHandler?r=n.nativeSourceHandler:Er.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),r!==n.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=r.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},n.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}};qt.registerComponent("Tech",ir);ir.registerTech("Tech",ir);ir.defaultTechOrder_=[];const Hf={},yb={},k_={};function aie(n,e){Hf[n]=Hf[n]||[],Hf[n].push(e)}function oie(n,e,t){n.setTimeout(()=>bf(e,Hf[e.type],t,n),1)}function lie(n,e){n.forEach(t=>t.setTech&&t.setTech(e))}function uie(n,e,t){return n.reduceRight(qP(t),e[t]())}function cie(n,e,t,r){return e[t](n.reduce(qP(t),r))}function w2(n,e,t,r=null){const o="call"+Pi(t),u=n.reduce(qP(o),r),h=u===k_,f=h?null:e[t](u);return hie(n,t,f,h),f}const fie={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},die={setCurrentTime:1,setMuted:1,setVolume:1},O2={play:1,pause:1};function qP(n){return(e,t)=>e===k_?k_:t[n]?t[n](e):e}function hie(n,e,t,r){for(let o=n.length-1;o>=0;o--){const u=n[o];u[e]&&u[e](r,t)}}function pie(n){yb[n.id()]=null}function gie(n,e){const t=yb[n.id()];let r=null;if(t==null)return r=e(n),yb[n.id()]=[[e,r]],r;for(let o=0;o<t.length;o++){const[u,h]=t[o];u===e&&(r=h)}return r===null&&(r=e(n),t.push([e,r])),r}function bf(n={},e=[],t,r,o=[],u=!1){const[h,...f]=e;if(typeof h=="string")bf(n,Hf[h],t,r,o,u);else if(h){const d=gie(r,h);if(!d.setSource)return o.push(d),bf(n,f,t,r,o,u);d.setSource(Object.assign({},n),function(m,g){if(m)return bf(n,f,t,r,o,u);o.push(d),bf(g,n.type===g.type?f:Hf[g.type],t,r,o,u)})}else f.length?bf(n,f,t,r,o,u):u?t(n,o):bf(n,Hf["*"],t,r,o,!0)}const mie={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},U_=function(n=""){const e=XP(n);return mie[e.toLowerCase()]||""},vie=(n,e)=>{if(!e)return"";if(n.cache_.source.src===e&&n.cache_.source.type)return n.cache_.source.type;const t=n.cache_.sources.filter(o=>o.src===e);if(t.length)return t[0].type;const r=n.$$("source");for(let o=0;o<r.length;o++){const u=r[o];if(u.type&&u.src&&u.src===e)return u.type}return U_(e)},FK=function(n){if(Array.isArray(n)){let e=[];n.forEach(function(t){t=FK(t),Array.isArray(t)?e=e.concat(t):kl(t)&&e.push(t)}),n=e}else typeof n=="string"&&n.trim()?n=[N2({src:n})]:kl(n)&&typeof n.src=="string"&&n.src&&n.src.trim()?n=[N2(n)]:n=[];return n};function N2(n){if(!n.type){const e=U_(n.src);e&&(n.type=e)}return n}class yie extends qt{constructor(e,t,r){const o=Xr({createEl:!1},t);if(super(e,o,r),!t.playerOptions.sources||t.playerOptions.sources.length===0)for(let u=0,h=t.playerOptions.techOrder;u<h.length;u++){const f=Pi(h[u]);let d=ir.getTech(f);if(f||(d=qt.getComponent(f)),d&&d.isSupported()){e.loadTech_(f);break}}else e.src(t.playerOptions.sources)}}qt.registerComponent("MediaLoader",yie);class sS extends qt{constructor(e,t){super(e,t),this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=r=>this.handleMouseOver(r),this.handleMouseOut_=r=>this.handleMouseOut(r),this.handleClick_=r=>this.handleClick(r),this.handleKeyDown_=r=>this.handleKeyDown(r),this.emitTapEvents(),this.enable()}createEl(e="div",t={},r={}){t=Object.assign({className:this.buildCSSClass(),tabIndex:0},t),e==="button"&&Er.error(`Creating a ClickableComponent with an HTML element of ${e} is not supported; use a Button instead.`),r=Object.assign({role:"button"},r),this.tabIndex_=t.tabIndex;const o=dr(e,t,r);return o.appendChild(dr("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(o),o}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(e){return this.controlTextEl_=dr("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_}controlText(e,t=this.el()){if(e===void 0)return this.controlText_||"Need Text";const r=this.localize(e);this.controlText_=e,Vc(this.controlTextEl_,r),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&t.setAttribute("title",r)}buildCSSClass(){return`vjs-control vjs-button ${super.buildCSSClass()}`}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_<"u"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_<"u"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(e){qn.isEventKey(e,"Space")||qn.isEventKey(e,"Enter")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}qt.registerComponent("ClickableComponent",sS);class Eb extends sS{constructor(e,t){super(e,t),this.update(),this.update_=r=>this.update(r),e.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return dr("div",{className:"vjs-poster"})}crossOrigin(e){if(typeof e>"u")return this.$("img")?this.$("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.$("img")&&(this.$("img").crossOrigin=e)}update(e){const t=this.player().poster();this.setSrc(t),t?this.show():this.hide()}setSrc(e){if(!e){this.el_.textContent="";return}this.$("img")||this.el_.appendChild(dr("picture",{className:"vjs-poster",tabIndex:-1},{},dr("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))),this.$("img").src=e}handleClick(e){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?Al(this.player_.play()):this.player_.pause())}}Eb.prototype.crossorigin=Eb.prototype.crossOrigin;qt.registerComponent("PosterImage",Eb);const to="#222",F2="#ccc",Eie={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function dI(n,e){let t;if(n.length===4)t=n[1]+n[1]+n[2]+n[2]+n[3]+n[3];else if(n.length===7)t=n.slice(1);else throw new Error("Invalid color code provided, "+n+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(t.slice(0,2),16)+","+parseInt(t.slice(2,4),16)+","+parseInt(t.slice(4,6),16)+","+e+")"}function hI(n,e,t){try{n.style[e]=t}catch{return}}class _ie extends qt{constructor(e,t,r){super(e,t,r);const o=u=>this.updateDisplay(u);e.on("loadstart",u=>this.toggleDisplay(u)),e.on("texttrackchange",o),e.on("loadedmetadata",u=>this.preselectTrack(u)),e.ready(Qr(this,function(){if(e.tech_&&e.tech_.featuresNativeTextTracks){this.hide();return}e.on("fullscreenchange",o),e.on("playerresize",o);const u=rt.screen.orientation||rt,h=rt.screen.orientation?"change":"orientationchange";u.addEventListener(h,o),e.on("dispose",()=>u.removeEventListener(h,o));const f=this.options_.playerOptions.tracks||[];for(let d=0;d<f.length;d++)this.player_.addRemoteTextTrack(f[d],!0);this.preselectTrack()}))}preselectTrack(){const e={captions:1,subtitles:1},t=this.player_.textTracks(),r=this.player_.cache_.selectedLanguage;let o,u,h;for(let f=0;f<t.length;f++){const d=t[f];r&&r.enabled&&r.language&&r.language===d.language&&d.kind in e?d.kind===r.kind?h=d:h||(h=d):r&&!r.enabled?(h=null,o=null,u=null):d.default&&(d.kind==="descriptions"&&!o?o=d:d.kind in e&&!u&&(u=d))}h?h.mode="showing":u?u.mode="showing":o&&(o.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){typeof rt.WebVTT=="function"&&rt.WebVTT.processCues(rt,[],this.el_)}updateDisplay(){const e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){const h=[];for(let f=0;f<e.length;++f){const d=e[f];d.mode==="showing"&&h.push(d)}this.updateForTrack(h);return}let r=null,o=null,u=e.length;for(;u--;){const h=e[u];h.mode==="showing"&&(h.kind==="descriptions"?r=h:o=h)}o?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(o)):r&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(r))}updateDisplayState(e){const t=this.player_.textTrackSettings.getValues(),r=e.activeCues;let o=r.length;for(;o--;){const u=r[o];if(!u)continue;const h=u.displayState;if(t.color&&(h.firstChild.style.color=t.color),t.textOpacity&&hI(h.firstChild,"color",dI(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(h.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&hI(h.firstChild,"backgroundColor",dI(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?hI(h,"backgroundColor",dI(t.windowColor,t.windowOpacity)):h.style.backgroundColor=t.windowColor),t.edgeStyle&&(t.edgeStyle==="dropshadow"?h.firstChild.style.textShadow=`2px 2px 3px ${to}, 2px 2px 4px ${to}, 2px 2px 5px ${to}`:t.edgeStyle==="raised"?h.firstChild.style.textShadow=`1px 1px ${to}, 2px 2px ${to}, 3px 3px ${to}`:t.edgeStyle==="depressed"?h.firstChild.style.textShadow=`1px 1px ${F2}, 0 1px ${F2}, -1px -1px ${to}, 0 -1px ${to}`:t.edgeStyle==="uniform"&&(h.firstChild.style.textShadow=`0 0 4px ${to}, 0 0 4px ${to}, 0 0 4px ${to}, 0 0 4px ${to}`)),t.fontPercent&&t.fontPercent!==1){const f=rt.parseFloat(h.style.fontSize);h.style.fontSize=f*t.fontPercent+"px",h.style.height="auto",h.style.top="auto"}t.fontFamily&&t.fontFamily!=="default"&&(t.fontFamily==="small-caps"?h.firstChild.style.fontVariant="small-caps":h.firstChild.style.fontFamily=Eie[t.fontFamily])}}updateForTrack(e){if(Array.isArray(e)||(e=[e]),typeof rt.WebVTT!="function"||e.every(r=>!r.activeCues))return;const t=[];for(let r=0;r<e.length;++r){const o=e[r];for(let u=0;u<o.activeCues.length;++u)t.push(o.activeCues[u])}rt.WebVTT.processCues(rt,t,this.el_);for(let r=0;r<e.length;++r){const o=e[r];for(let u=0;u<o.activeCues.length;++u){const h=o.activeCues[u].displayState;Wf(h,"vjs-text-track-cue","vjs-text-track-cue-"+(o.language?o.language:r)),o.language&&rp(h,"lang",o.language)}this.player_.textTrackSettings&&this.updateDisplayState(o)}}}qt.registerComponent("TextTrackDisplay",_ie);class Tie extends qt{createEl(){const e=this.player_.isAudio(),t=this.localize(e?"Audio Player":"Video Player"),r=dr("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[t])}),o=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return o.appendChild(r),o}handleLanguagechange(){this.$(".vjs-control-text").textContent=this.localize("{1} is loading.",[this.player_.isAudio()?"Audio Player":"Video Player"])}}qt.registerComponent("LoadingSpinner",Tie);let Ga=class extends sS{createEl(e,t={},r={}){e="button",t=Object.assign({className:this.buildCSSClass()},t),r=Object.assign({type:"button"},r);const o=dr(e,t,r);return o.appendChild(dr("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(o),o}addChild(e,t={}){const r=this.constructor.name;return Er.warn(`Adding an actionable (user controllable) child to a Button (${r}) is not supported; use a ClickableComponent instead.`),qt.prototype.addChild.call(this,e,t)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(e){if(qn.isEventKey(e,"Space")||qn.isEventKey(e,"Enter")){e.stopPropagation();return}super.handleKeyDown(e)}};qt.registerComponent("Button",Ga);class kK extends Ga{constructor(e,t){super(e,t),this.mouseused_=!1,this.on("mousedown",r=>this.handleMouseDown(r))}buildCSSClass(){return"vjs-big-play-button"}handleClick(e){const t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY){Al(t),this.player_.tech(!0)&&this.player_.tech(!0).focus();return}const r=this.player_.getChild("controlBar"),o=r&&r.getChild("playToggle");if(!o){this.player_.tech(!0).focus();return}const u=()=>o.focus();Em(t)?t.then(u,()=>{}):this.setTimeout(u,1)}handleKeyDown(e){this.mouseused_=!1,super.handleKeyDown(e)}handleMouseDown(e){this.mouseused_=!0}}kK.prototype.controlText_="Play Video";qt.registerComponent("BigPlayButton",kK);let Sie=class extends Ga{constructor(e,t){super(e,t),this.controlText(t&&t.controlText||this.localize("Close"))}buildCSSClass(){return`vjs-close-button ${super.buildCSSClass()}`}handleClick(e){this.trigger({type:"close",bubbles:!1})}handleKeyDown(e){qn.isEventKey(e,"Esc")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}};qt.registerComponent("CloseButton",Sie);class UK extends Ga{constructor(e,t={}){super(e,t),t.replay=t.replay===void 0||t.replay,this.on(e,"play",r=>this.handlePlay(r)),this.on(e,"pause",r=>this.handlePause(r)),t.replay&&this.on(e,"ended",r=>this.handleEnded(r))}buildCSSClass(){return`vjs-play-control ${super.buildCSSClass()}`}handleClick(e){this.player_.paused()?Al(this.player_.play()):this.player_.pause()}handleSeeked(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)}handlePlay(e){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")}handlePause(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")}handleEnded(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",t=>this.handleSeeked(t))}}UK.prototype.controlText_="Play";qt.registerComponent("PlayToggle",UK);class Tp extends qt{constructor(e,t){super(e,t),this.on(e,["timeupdate","ended"],r=>this.updateContent(r)),this.updateTextNode_()}createEl(){const e=this.buildCSSClass(),t=super.createEl("div",{className:`${e} vjs-time-control vjs-control`}),r=dr("span",{className:"vjs-control-text",textContent:`${this.localize(this.labelText_)} `},{role:"presentation"});return t.appendChild(r),this.contentEl_=dr("span",{className:`${e}-display`},{role:"presentation"}),t.appendChild(this.contentEl_),t}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}updateTextNode_(e=0){e=ed(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",()=>{if(!this.contentEl_)return;let t=this.textNode_;t&&this.contentEl_.firstChild!==t&&(t=null,Er.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=mn.createTextNode(this.formattedTime_),this.textNode_&&(t?this.contentEl_.replaceChild(this.textNode_,t):this.contentEl_.appendChild(this.textNode_))}))}updateContent(e){}}Tp.prototype.labelText_="Time";Tp.prototype.controlText_="Time";qt.registerComponent("TimeDisplay",Tp);class QP extends Tp{buildCSSClass(){return"vjs-current-time"}updateContent(e){let t;this.player_.ended()?t=this.player_.duration():t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(t)}}QP.prototype.labelText_="Current Time";QP.prototype.controlText_="Current Time";qt.registerComponent("CurrentTimeDisplay",QP);class JP extends Tp{constructor(e,t){super(e,t);const r=o=>this.updateContent(o);this.on(e,"durationchange",r),this.on(e,"loadstart",r),this.on(e,"loadedmetadata",r)}buildCSSClass(){return"vjs-duration"}updateContent(e){const t=this.player_.duration();this.updateTextNode_(t)}}JP.prototype.labelText_="Duration";JP.prototype.controlText_="Duration";qt.registerComponent("DurationDisplay",JP);class Aie extends qt{createEl(){const e=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),t=super.createEl("div"),r=super.createEl("span",{textContent:"/"});return t.appendChild(r),e.appendChild(t),e}}qt.registerComponent("TimeDivider",Aie);class ZP extends Tp{constructor(e,t){super(e,t),this.on(e,"durationchange",r=>this.updateContent(r))}buildCSSClass(){return"vjs-remaining-time"}createEl(){const e=super.createEl();return this.options_.displayNegative!==!1&&e.insertBefore(dr("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e}updateContent(e){if(typeof this.player_.duration()!="number")return;let t;this.player_.ended()?t=0:this.player_.remainingTimeDisplay?t=this.player_.remainingTimeDisplay():t=this.player_.remainingTime(),this.updateTextNode_(t)}}ZP.prototype.labelText_="Remaining Time";ZP.prototype.controlText_="Remaining Time";qt.registerComponent("RemainingTimeDisplay",ZP);class xie extends qt{constructor(e,t){super(e,t),this.updateShowing(),this.on(this.player(),"durationchange",r=>this.updateShowing(r))}createEl(){const e=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=dr("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(dr("span",{className:"vjs-control-text",textContent:`${this.localize("Stream Type")} `})),this.contentEl_.appendChild(mn.createTextNode(this.localize("LIVE"))),e.appendChild(this.contentEl_),e}dispose(){this.contentEl_=null,super.dispose()}updateShowing(e){this.player().duration()===1/0?this.show():this.hide()}}qt.registerComponent("LiveDisplay",xie);class BK extends Ga{constructor(e,t){super(e,t),this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=r=>this.updateLiveEdgeStatus(r),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){const e=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=dr("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}}BK.prototype.controlText_="Seek to live, currently playing live";qt.registerComponent("SeekToLive",BK);function A0(n,e,t){return n=Number(n),Math.min(t,Math.max(e,isNaN(n)?e:n))}var Cie=Object.freeze({__proto__:null,clamp:A0});class e1 extends qt{constructor(e,t){super(e,t),this.handleMouseDown_=r=>this.handleMouseDown(r),this.handleMouseUp_=r=>this.handleMouseUp(r),this.handleKeyDown_=r=>this.handleKeyDown(r),this.handleClick_=r=>this.handleClick(r),this.handleMouseMove_=r=>this.handleMouseMove(r),this.update_=r=>this.update(r),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){if(!this.enabled())return;const e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}createEl(e,t={},r={}){return t.className=t.className+" vjs-slider",t=Object.assign({tabIndex:0},t),r=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},r),super.createEl(e,t,r)}handleMouseDown(e){const t=this.bar.el_.ownerDocument;e.type==="mousedown"&&e.preventDefault(),e.type==="touchstart"&&!Bl&&e.preventDefault(),hK(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove_),this.on(t,"mouseup",this.handleMouseUp_),this.on(t,"touchmove",this.handleMouseMove_),this.on(t,"touchend",this.handleMouseUp_),this.handleMouseMove(e,!0)}handleMouseMove(e){}handleMouseUp(e){const t=this.bar.el_.ownerDocument;pK(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(t,"mousemove",this.handleMouseMove_),this.off(t,"mouseup",this.handleMouseUp_),this.off(t,"touchmove",this.handleMouseMove_),this.off(t,"touchend",this.handleMouseUp_),this.update()}update(){if(!this.el_||!this.bar)return;const e=this.getProgress();return e===this.progress_||(this.progress_=e,this.requestNamedAnimationFrame("Slider#update",()=>{const t=this.vertical()?"height":"width";this.bar.el().style[t]=(e*100).toFixed(2)+"%"})),e}getProgress(){return Number(A0(this.getPercent(),0,1).toFixed(4))}calculateDistance(e){const t=ZT(this.el_,e);return this.vertical()?t.y:t.x}handleKeyDown(e){qn.isEventKey(e,"Left")||qn.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepBack()):qn.isEventKey(e,"Right")||qn.isEventKey(e,"Up")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):super.handleKeyDown(e)}handleClick(e){e.stopPropagation(),e.preventDefault()}vertical(e){if(e===void 0)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}qt.registerComponent("Slider",e1);const pI=(n,e)=>A0(n/e*100,0,100).toFixed(2)+"%";class Iie extends qt{constructor(e,t){super(e,t),this.partEls_=[],this.on(e,"progress",r=>this.update(r))}createEl(){const e=super.createEl("div",{className:"vjs-load-progress"}),t=dr("span",{className:"vjs-control-text"}),r=dr("span",{textContent:this.localize("Loaded")}),o=mn.createTextNode(": ");return this.percentageEl_=dr("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),e.appendChild(t),t.appendChild(r),t.appendChild(o),t.appendChild(this.percentageEl_),e}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(e){this.requestNamedAnimationFrame("LoadProgressBar#update",()=>{const t=this.player_.liveTracker,r=this.player_.buffered(),o=t&&t.isLive()?t.seekableEnd():this.player_.duration(),u=this.player_.bufferedEnd(),h=this.partEls_,f=pI(u,o);this.percent_!==f&&(this.el_.style.width=f,Vc(this.percentageEl_,f),this.percent_=f);for(let d=0;d<r.length;d++){const m=r.start(d),g=r.end(d);let v=h[d];v||(v=this.el_.appendChild(dr()),h[d]=v),!(v.dataset.start===m&&v.dataset.end===g)&&(v.dataset.start=m,v.dataset.end=g,v.style.left=pI(m,u),v.style.width=pI(g-m,u))}for(let d=h.length;d>r.length;d--)this.el_.removeChild(h[d-1]);h.length=r.length})}}qt.registerComponent("LoadProgressBar",Iie);class Rie extends qt{constructor(e,t){super(e,t),this.update=Kl(Qr(this,this.update),po)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(e,t,r){const o=i0(this.el_),u=ip(this.player_.el()),h=e.width*t;if(!u||!o)return;const f=e.left-u.left+h,d=e.width-h+(u.right-e.right);let m=o.width/2;f<m?m+=m-f:d<m&&(m=d),m<0?m=0:m>o.width&&(m=o.width),m=Math.round(m),this.el_.style.right=`-${m}px`,this.write(r)}write(e){Vc(this.el_,e)}updateTime(e,t,r,o){this.requestNamedAnimationFrame("TimeTooltip#updateTime",()=>{let u;const h=this.player_.duration();if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){const f=this.player_.liveTracker.liveWindow(),d=f-t*f;u=(d<1?"":"-")+ed(d,f)}else u=ed(r,h);this.update(e,t,u),o&&o()})}}qt.registerComponent("TimeTooltip",Rie);class t1 extends qt{constructor(e,t){super(e,t),this.update=Kl(Qr(this,this.update),po)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(e,t){const r=this.getChild("timeTooltip");if(!r)return;const o=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();r.updateTime(e,t,o)}}t1.prototype.options_={children:[]};!$s&&!Ul&&t1.prototype.options_.children.push("timeTooltip");qt.registerComponent("PlayProgressBar",t1);class jK extends qt{constructor(e,t){super(e,t),this.update=Kl(Qr(this,this.update),po)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,t){const r=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,r,()=>{this.el_.style.left=`${e.width*t}px`})}}jK.prototype.options_={children:["timeTooltip"]};qt.registerComponent("MouseTimeDisplay",jK);const sE=5,k2=12;class n1 extends e1{constructor(e,t){super(e,t),this.setEventHandlers_()}setEventHandlers_(){this.update_=Qr(this,this.update),this.update=Kl(this.update_,po),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=e=>this.enableInterval_(e),this.disableIntervalHandler_=e=>this.disableInterval_(e),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in mn&&"visibilityState"in mn&&this.on(mn,"visibilitychange",this.toggleVisibility_)}toggleVisibility_(e){mn.visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,po))}disableInterval_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&e.type!=="ended"||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(e){if(mn.visibilityState==="hidden")return;const t=super.update();return this.requestNamedAnimationFrame("SeekBar#update",()=>{const r=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),o=this.player_.liveTracker;let u=this.player_.duration();o&&o.isLive()&&(u=this.player_.liveTracker.liveCurrentTime()),this.percent_!==t&&(this.el_.setAttribute("aria-valuenow",(t*100).toFixed(2)),this.percent_=t),(this.currentTime_!==r||this.duration_!==u)&&(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[ed(r,u),ed(u,u)],"{1} of {2}")),this.currentTime_=r,this.duration_=u),this.bar&&this.bar.update(ip(this.el()),this.getProgress())}),t}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}getPercent(){const e=this.getCurrentTime_();let t;const r=this.player_.liveTracker;return r&&r.isLive()?(t=(e-r.seekableStart())/r.liveWindow(),r.atLiveEdge()&&(t=1)):t=e/this.player_.duration(),t}handleMouseDown(e){s0(e)&&(e.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),super.handleMouseDown(e))}handleMouseMove(e,t=!1){if(!s0(e))return;!t&&!this.player_.scrubbing()&&this.player_.scrubbing(!0);let r;const o=this.calculateDistance(e),u=this.player_.liveTracker;if(!u||!u.isLive())r=o*this.player_.duration(),r===this.player_.duration()&&(r=r-.1);else{if(o>=.99){u.seekToLiveEdge();return}const h=u.seekableStart(),f=u.liveCurrentTime();if(r=h+o*u.liveWindow(),r>=f&&(r=f),r<=h&&(r=h+.1),r===1/0)return}this.userSeek_(r)}enable(){super.enable();const e=this.getChild("mouseTimeDisplay");e&&e.show()}disable(){super.disable();const e=this.getChild("mouseTimeDisplay");e&&e.hide()}handleMouseUp(e){super.handleMouseUp(e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?Al(this.player_.play()):this.update_()}stepForward(){this.userSeek_(this.player_.currentTime()+sE)}stepBack(){this.userSeek_(this.player_.currentTime()-sE)}handleAction(e){this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(e){const t=this.player_.liveTracker;if(qn.isEventKey(e,"Space")||qn.isEventKey(e,"Enter"))e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if(qn.isEventKey(e,"Home"))e.preventDefault(),e.stopPropagation(),this.userSeek_(0);else if(qn.isEventKey(e,"End"))e.preventDefault(),e.stopPropagation(),t&&t.isLive()?this.userSeek_(t.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(qn(e))){e.preventDefault(),e.stopPropagation();const r=(qn.codes[qn(e)]-qn.codes[0])*10/100;t&&t.isLive()?this.userSeek_(t.seekableStart()+t.liveWindow()*r):this.userSeek_(this.player_.duration()*r)}else qn.isEventKey(e,"PgDn")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()-sE*k2)):qn.isEventKey(e,"PgUp")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()+sE*k2)):super.handleKeyDown(e)}dispose(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in mn&&"visibilityState"in mn&&this.off(mn,"visibilitychange",this.toggleVisibility_),super.dispose()}}n1.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"};!$s&&!Ul&&n1.prototype.options_.children.splice(1,0,"mouseTimeDisplay");qt.registerComponent("SeekBar",n1);class KK extends qt{constructor(e,t){super(e,t),this.handleMouseMove=Kl(Qr(this,this.handleMouseMove),po),this.throttledHandleMouseSeek=Kl(Qr(this,this.handleMouseSeek),po),this.handleMouseUpHandler_=r=>this.handleMouseUp(r),this.handleMouseDownHandler_=r=>this.handleMouseDown(r),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(e){const t=this.getChild("seekBar");if(!t)return;const r=t.getChild("playProgressBar"),o=t.getChild("mouseTimeDisplay");if(!r&&!o)return;const u=t.el(),h=i0(u);let f=ZT(u,e).x;f=A0(f,0,1),o&&o.update(h,f),r&&r.update(h,t.getProgress())}handleMouseSeek(e){const t=this.getChild("seekBar");t&&t.handleMouseMove(e)}enabled(){return this.enabled_}disable(){if(this.children().forEach(e=>e.disable&&e.disable()),!!this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){const e=this.getChild("seekBar");this.player_.scrubbing(!1),e.videoWasPlaying&&Al(this.player_.play())}}enable(){this.children().forEach(e=>e.enable&&e.enable()),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){const e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUpHandler_),this.off(e,"touchend",this.handleMouseUpHandler_)}handleMouseDown(e){const t=this.el_.ownerDocument,r=this.getChild("seekBar");r&&r.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const t=this.getChild("seekBar");t&&t.handleMouseUp(e),this.removeListenersAddedOnMousedownAndTouchstart()}}KK.prototype.options_={children:["seekBar"]};qt.registerComponent("ProgressControl",KK);class GK extends Ga{constructor(e,t){super(e,t),this.on(e,["enterpictureinpicture","leavepictureinpicture"],r=>this.handlePictureInPictureChange(r)),this.on(e,["disablepictureinpicturechanged","loadedmetadata"],r=>this.handlePictureInPictureEnabledChange(r)),this.on(e,["loadedmetadata","audioonlymodechange","audiopostermodechange"],()=>{e.currentType().substring(0,5)==="audio"||e.audioPosterMode()||e.audioOnlyMode()?(e.isInPictureInPicture()&&e.exitPictureInPicture(),this.hide()):this.show()}),this.disable()}buildCSSClass(){return`vjs-picture-in-picture-control ${super.buildCSSClass()}`}handlePictureInPictureEnabledChange(){mn.pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1||this.player_.options_.enableDocumentPictureInPicture&&"documentPictureInPicture"in rt?this.enable():this.disable()}handlePictureInPictureChange(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture"),this.handlePictureInPictureEnabledChange()}handleClick(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}}GK.prototype.controlText_="Picture-in-Picture";qt.registerComponent("PictureInPictureToggle",GK);class WK extends Ga{constructor(e,t){super(e,t),this.on(e,"fullscreenchange",r=>this.handleFullscreenChange(r)),mn[e.fsApi_.fullscreenEnabled]===!1&&this.disable()}buildCSSClass(){return`vjs-fullscreen-control ${super.buildCSSClass()}`}handleFullscreenChange(e){this.player_.isFullscreen()?this.controlText("Exit Fullscreen"):this.controlText("Fullscreen")}handleClick(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}WK.prototype.controlText_="Fullscreen";qt.registerComponent("FullscreenToggle",WK);const bie=function(n,e){e.tech_&&!e.tech_.featuresVolumeControl&&n.addClass("vjs-hidden"),n.on(e,"loadstart",function(){e.tech_.featuresVolumeControl?n.removeClass("vjs-hidden"):n.addClass("vjs-hidden")})};class Die extends qt{createEl(){const e=super.createEl("div",{className:"vjs-volume-level"});return e.appendChild(super.createEl("span",{className:"vjs-control-text"})),e}}qt.registerComponent("VolumeLevel",Die);class Pie extends qt{constructor(e,t){super(e,t),this.update=Kl(Qr(this,this.update),po)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(e,t,r,o){if(!r){const u=ip(this.el_),h=ip(this.player_.el()),f=e.width*t;if(!h||!u)return;const d=e.left-h.left+f,m=e.width-f+(h.right-e.right);let g=u.width/2;d<g?g+=g-d:m<g&&(g=m),g<0?g=0:g>u.width&&(g=u.width),this.el_.style.right=`-${g}px`}this.write(`${o}%`)}write(e){Vc(this.el_,e)}updateVolume(e,t,r,o,u){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",()=>{this.update(e,t,r,o.toFixed(0)),u&&u()})}}qt.registerComponent("VolumeLevelTooltip",Pie);class HK extends qt{constructor(e,t){super(e,t),this.update=Kl(Qr(this,this.update),po)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,t,r){const o=100*t;this.getChild("volumeLevelTooltip").updateVolume(e,t,r,o,()=>{r?this.el_.style.bottom=`${e.height*t}px`:this.el_.style.left=`${e.width*t}px`})}}HK.prototype.options_={children:["volumeLevelTooltip"]};qt.registerComponent("MouseVolumeLevelDisplay",HK);class aS extends e1{constructor(e,t){super(e,t),this.on("slideractive",r=>this.updateLastVolume_(r)),this.on(e,"volumechange",r=>this.updateARIAAttributes(r)),e.ready(()=>this.updateARIAAttributes())}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(e){s0(e)&&super.handleMouseDown(e)}handleMouseMove(e){const t=this.getChild("mouseVolumeLevelDisplay");if(t){const r=this.el(),o=ip(r),u=this.vertical();let h=ZT(r,e);h=u?h.y:h.x,h=A0(h,0,1),t.update(o,h,u)}s0(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(e){const t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")}volumeAsPercentage_(){return Math.round(this.player_.volume()*100)}updateLastVolume_(){const e=this.player_.volume();this.one("sliderinactive",()=>{this.player_.volume()===0&&this.player_.lastVolume_(e)})}}aS.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};!$s&&!Ul&&aS.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay");aS.prototype.playerEvent="volumechange";qt.registerComponent("VolumeBar",aS);class VK extends qt{constructor(e,t={}){t.vertical=t.vertical||!1,(typeof t.volumeBar>"u"||np(t.volumeBar))&&(t.volumeBar=t.volumeBar||{},t.volumeBar.vertical=t.vertical),super(e,t),bie(this,e),this.throttledHandleMouseMove=Kl(Qr(this,this.handleMouseMove),po),this.handleMouseUpHandler_=r=>this.handleMouseUp(r),this.on("mousedown",r=>this.handleMouseDown(r)),this.on("touchstart",r=>this.handleMouseDown(r)),this.on("mousemove",r=>this.handleMouseMove(r)),this.on(this.volumeBar,["focus","slideractive"],()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")}),this.on(this.volumeBar,["blur","sliderinactive"],()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")})}createEl(){let e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),super.createEl("div",{className:`vjs-volume-control vjs-control ${e}`})}handleMouseDown(e){const t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUpHandler_),this.off(t,"touchend",this.handleMouseUpHandler_)}handleMouseMove(e){this.volumeBar.handleMouseMove(e)}}VK.prototype.options_={children:["volumeBar"]};qt.registerComponent("VolumeControl",VK);const Lie=function(n,e){e.tech_&&!e.tech_.featuresMuteControl&&n.addClass("vjs-hidden"),n.on(e,"loadstart",function(){e.tech_.featuresMuteControl?n.removeClass("vjs-hidden"):n.addClass("vjs-hidden")})};class $K extends Ga{constructor(e,t){super(e,t),Lie(this,e),this.on(e,["loadstart","volumechange"],r=>this.update(r))}buildCSSClass(){return`vjs-mute-control ${super.buildCSSClass()}`}handleClick(e){const t=this.player_.volume(),r=this.player_.lastVolume_();if(t===0){const o=r<.1?.1:r;this.player_.volume(o),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())}update(e){this.updateIcon_(),this.updateControlText_()}updateIcon_(){const e=this.player_.volume();let t=3;$s&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),e===0||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2),QT(this.el_,[0,1,2,3].reduce((r,o)=>r+`${o?" ":""}vjs-vol-${o}`,"")),Wf(this.el_,`vjs-vol-${t}`)}updateControlText_(){const t=this.player_.muted()||this.player_.volume()===0?"Unmute":"Mute";this.controlText()!==t&&this.controlText(t)}}$K.prototype.controlText_="Mute";qt.registerComponent("MuteToggle",$K);class zK extends qt{constructor(e,t={}){typeof t.inline<"u"?t.inline=t.inline:t.inline=!0,(typeof t.volumeControl>"u"||np(t.volumeControl))&&(t.volumeControl=t.volumeControl||{},t.volumeControl.vertical=!t.inline),super(e,t),this.handleKeyPressHandler_=r=>this.handleKeyPress(r),this.on(e,["loadstart"],r=>this.volumePanelState_(r)),this.on(this.muteToggle,"keyup",r=>this.handleKeyPress(r)),this.on(this.volumeControl,"keyup",r=>this.handleVolumeControlKeyUp(r)),this.on("keydown",r=>this.handleKeyPress(r)),this.on("mouseover",r=>this.handleMouseOver(r)),this.on("mouseout",r=>this.handleMouseOut(r)),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),super.createEl("div",{className:`vjs-volume-panel vjs-control ${e}`})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(e){qn.isEventKey(e,"Esc")&&this.muteToggle.focus()}handleMouseOver(e){this.addClass("vjs-hover"),Ha(mn,"keyup",this.handleKeyPressHandler_)}handleMouseOut(e){this.removeClass("vjs-hover"),Cs(mn,"keyup",this.handleKeyPressHandler_)}handleKeyPress(e){qn.isEventKey(e,"Esc")&&this.handleMouseOut()}}zK.prototype.options_={children:["muteToggle","volumeControl"]};qt.registerComponent("VolumePanel",zK);class Mie extends Ga{constructor(e,t){super(e,t),this.validOptions=[5,10,30],this.skipTime=this.getSkipForwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime])),this.show()):this.hide()}getSkipForwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.forward}buildCSSClass(){return`vjs-skip-forward-${this.getSkipForwardTime()} ${super.buildCSSClass()}`}handleClick(e){const t=this.player_.currentTime(),r=this.player_.liveTracker,o=r&&r.isLive()?r.seekableEnd():this.player_.duration();let u;t+this.skipTime<=o?u=t+this.skipTime:u=o,this.player_.currentTime(u)}handleLanguagechange(){this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime]))}}qt.registerComponent("SkipForward",Mie);class YK extends Ga{constructor(e,t){super(e,t),this.validOptions=[5,10,30],this.skipTime=this.getSkipBackwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime])),this.show()):this.hide()}getSkipBackwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.backward}buildCSSClass(){return`vjs-skip-backward-${this.getSkipBackwardTime()} ${super.buildCSSClass()}`}handleClick(e){const t=this.player_.currentTime(),r=this.player_.liveTracker,o=r&&r.isLive()&&r.seekableStart();let u;o&&t-this.skipTime<=o?u=o:t>=this.skipTime?u=t-this.skipTime:u=0,this.player_.currentTime(u)}handleLanguagechange(){this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime]))}}YK.prototype.controlText_="Skip Backward";qt.registerComponent("SkipBackward",YK);class XK extends qt{constructor(e,t){super(e,t),t&&(this.menuButton_=t.menuButton),this.focusedChild_=-1,this.on("keydown",r=>this.handleKeyDown(r)),this.boundHandleBlur_=r=>this.handleBlur(r),this.boundHandleTapClick_=r=>this.handleTapClick(r)}addEventListenerForItem(e){e instanceof qt&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(e){e instanceof qt&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))}removeChild(e){typeof e=="string"&&(e=this.getChild(e)),this.removeEventListenerForItem(e),super.removeChild(e)}addItem(e){const t=this.addChild(e);t&&this.addEventListenerForItem(t)}createEl(){const e=this.options_.contentElType||"ul";this.contentEl_=dr(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");const t=super.createEl("div",{append:this.contentEl_,className:"vjs-menu"});return t.appendChild(this.contentEl_),Ha(t,"click",function(r){r.preventDefault(),r.stopImmediatePropagation()}),t}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(e){const t=e.relatedTarget||mn.activeElement;if(!this.children().some(r=>r.el()===t)){const r=this.menuButton_;r&&r.buttonPressed_&&t!==r.el().firstChild&&r.unpressButton()}}handleTapClick(e){if(this.menuButton_){this.menuButton_.unpressButton();const t=this.children();if(!Array.isArray(t))return;const r=t.filter(o=>o.el()===e.target)[0];if(!r)return;r.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}}handleKeyDown(e){qn.isEventKey(e,"Left")||qn.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(qn.isEventKey(e,"Right")||qn.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())}stepForward(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_+1),this.focus(e)}stepBack(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_-1),this.focus(e)}focus(e=0){const t=this.children().slice();t.length&&t[0].hasClass("vjs-menu-title")&&t.shift(),t.length>0&&(e<0?e=0:e>=t.length&&(e=t.length-1),this.focusedChild_=e,t[e].el_.focus())}}qt.registerComponent("Menu",XK);class r1 extends qt{constructor(e,t={}){super(e,t),this.menuButton_=new Ga(e,t),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true");const r=Ga.prototype.buildCSSClass();this.menuButton_.el_.className=this.buildCSSClass()+" "+r,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0;const o=u=>this.handleClick(u);this.handleMenuKeyUp_=u=>this.handleMenuKeyUp(u),this.on(this.menuButton_,"tap",o),this.on(this.menuButton_,"click",o),this.on(this.menuButton_,"keydown",u=>this.handleKeyDown(u)),this.on(this.menuButton_,"mouseenter",()=>{this.addClass("vjs-hover"),this.menu.show(),Ha(mn,"keyup",this.handleMenuKeyUp_)}),this.on("mouseleave",u=>this.handleMouseLeave(u)),this.on("keydown",u=>this.handleSubmenuKeyDown(u))}update(){const e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){const e=new XK(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){const t=dr("li",{className:"vjs-menu-title",textContent:Pi(this.options_.title),tabIndex:-1}),r=new qt(this.player_,{el:t});e.addItem(r)}if(this.items=this.createItems(),this.items)for(let t=0;t<this.items.length;t++)e.addItem(this.items[t]);return e}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}buildWrapperCSSClass(){let e="vjs-menu-button";this.options_.inline===!0?e+="-inline":e+="-popup";const t=Ga.prototype.buildCSSClass();return`vjs-menu-button ${e} ${t} ${super.buildCSSClass()}`}buildCSSClass(){let e="vjs-menu-button";return this.options_.inline===!0?e+="-inline":e+="-popup",`vjs-menu-button ${e} ${super.buildCSSClass()}`}controlText(e,t=this.menuButton_.el()){return this.menuButton_.controlText(e,t)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(e){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(e){this.removeClass("vjs-hover"),Cs(mn,"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(e){qn.isEventKey(e,"Esc")||qn.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),qn.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(qn.isEventKey(e,"Up")||qn.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))}handleMenuKeyUp(e){(qn.isEventKey(e,"Esc")||qn.isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")}handleSubmenuKeyPress(e){this.handleSubmenuKeyDown(e)}handleSubmenuKeyDown(e){(qn.isEventKey(e,"Esc")||qn.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),qn.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))}pressButton(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),$s&&lK())return;this.menu.focus()}}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}qt.registerComponent("MenuButton",r1);class i1 extends r1{constructor(e,t){const r=t.tracks;if(super(e,t),this.items.length<=1&&this.hide(),!r)return;const o=Qr(this,this.update);r.addEventListener("removetrack",o),r.addEventListener("addtrack",o),r.addEventListener("labelchange",o),this.player_.on("ready",o),this.player_.on("dispose",function(){r.removeEventListener("removetrack",o),r.removeEventListener("addtrack",o),r.removeEventListener("labelchange",o)})}}qt.registerComponent("TrackButton",i1);const wie=["Tab","Esc","Up","Down","Right","Left"];class x0 extends sS{constructor(e,t){super(e,t),this.selectable=t.selectable,this.isSelected_=t.selected||!1,this.multiSelectable=t.multiSelectable,this.selected(this.isSelected_),this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(e,t,r){this.nonIconControl=!0;const o=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},t),r);return o.replaceChild(dr("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)}),o.querySelector(".vjs-icon-placeholder")),o}handleKeyDown(e){wie.some(t=>qn.isEventKey(e,t))||super.handleKeyDown(e)}handleClick(e){this.selected(!0)}selected(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}qt.registerComponent("MenuItem",x0);class C0 extends x0{constructor(e,t){const r=t.track,o=e.textTracks();t.label=r.label||r.language||"Unknown",t.selected=r.mode==="showing",super(e,t),this.track=r,this.kinds=(t.kinds||[t.kind||this.track.kind]).filter(Boolean);const u=(...f)=>{this.handleTracksChange.apply(this,f)},h=(...f)=>{this.handleSelectedLanguageChange.apply(this,f)};if(e.on(["loadstart","texttrackchange"],u),o.addEventListener("change",u),o.addEventListener("selectedlanguagechange",h),this.on("dispose",function(){e.off(["loadstart","texttrackchange"],u),o.removeEventListener("change",u),o.removeEventListener("selectedlanguagechange",h)}),o.onchange===void 0){let f;this.on(["tap","click"],function(){if(typeof rt.Event!="object")try{f=new rt.Event("change")}catch{}f||(f=mn.createEvent("Event"),f.initEvent("change",!0,!0)),o.dispatchEvent(f)})}this.handleTracksChange()}handleClick(e){const t=this.track,r=this.player_.textTracks();if(super.handleClick(e),!!r)for(let o=0;o<r.length;o++){const u=r[o];this.kinds.indexOf(u.kind)!==-1&&(u===t?u.mode!=="showing"&&(u.mode="showing"):u.mode!=="disabled"&&(u.mode="disabled"))}}handleTracksChange(e){const t=this.track.mode==="showing";t!==this.isSelected_&&this.selected(t)}handleSelectedLanguageChange(e){if(this.track.mode==="showing"){const t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}}dispose(){this.track=null,super.dispose()}}qt.registerComponent("TextTrackMenuItem",C0);class qK extends C0{constructor(e,t){t.track={player:e,kind:t.kind,kinds:t.kinds,default:!1,mode:"disabled"},t.kinds||(t.kinds=[t.kind]),t.label?t.track.label=t.label:t.track.label=t.kinds.join(" and ")+" off",t.selectable=!0,t.multiSelectable=!1,super(e,t)}handleTracksChange(e){const t=this.player().textTracks();let r=!0;for(let o=0,u=t.length;o<u;o++){const h=t[o];if(this.options_.kinds.indexOf(h.kind)>-1&&h.mode==="showing"){r=!1;break}}r!==this.isSelected_&&this.selected(r)}handleSelectedLanguageChange(e){const t=this.player().textTracks();let r=!0;for(let o=0,u=t.length;o<u;o++){const h=t[o];if(["captions","descriptions","subtitles"].indexOf(h.kind)>-1&&h.mode==="showing"){r=!1;break}}r&&(this.player_.cache_.selectedLanguage={enabled:!1})}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.label),super.handleLanguagechange()}}qt.registerComponent("OffTextTrackMenuItem",qK);class Sp extends i1{constructor(e,t={}){t.tracks=e.textTracks(),super(e,t)}createItems(e=[],t=C0){let r;this.label_&&(r=`${this.label_} off`),e.push(new qK(this.player_,{kinds:this.kinds_,kind:this.kind_,label:r})),this.hideThreshold_+=1;const o=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let u=0;u<o.length;u++){const h=o[u];if(this.kinds_.indexOf(h.kind)>-1){const f=new t(this.player_,{track:h,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});f.addClass(`vjs-${h.kind}-menu-item`),e.push(f)}}return e}}qt.registerComponent("TextTrackButton",Sp);class QK extends x0{constructor(e,t){const r=t.track,o=t.cue,u=e.currentTime();t.selectable=!0,t.multiSelectable=!1,t.label=o.text,t.selected=o.startTime<=u&&u<o.endTime,super(e,t),this.track=r,this.cue=o}handleClick(e){super.handleClick(),this.player_.currentTime(this.cue.startTime)}}qt.registerComponent("ChaptersTrackMenuItem",QK);class s1 extends Sp{constructor(e,t,r){super(e,t,r),this.selectCurrentItem_=()=>{this.items.forEach(o=>{o.selected(this.track_.activeCues[0]===o.cue)})}}buildCSSClass(){return`vjs-chapters-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-chapters-button ${super.buildWrapperCSSClass()}`}update(e){if(e&&e.track&&e.track.kind!=="chapters")return;const t=this.findChaptersTrack();t!==this.track_?(this.setTrack(t),super.update()):(!this.items||t&&t.cues&&t.cues.length!==this.items.length)&&super.update()}setTrack(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){const t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";const t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}}findChaptersTrack(){const e=this.player_.textTracks()||[];for(let t=e.length-1;t>=0;t--){const r=e[t];if(r.kind===this.kind_)return r}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(Pi(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){const e=[];if(!this.track_)return e;const t=this.track_.cues;if(!t)return e;for(let r=0,o=t.length;r<o;r++){const u=t[r],h=new QK(this.player_,{track:this.track_,cue:u});e.push(h)}return e}}s1.prototype.kind_="chapters";s1.prototype.controlText_="Chapters";qt.registerComponent("ChaptersButton",s1);class a1 extends Sp{constructor(e,t,r){super(e,t,r);const o=e.textTracks(),u=Qr(this,this.handleTracksChange);o.addEventListener("change",u),this.on("dispose",function(){o.removeEventListener("change",u)})}handleTracksChange(e){const t=this.player().textTracks();let r=!1;for(let o=0,u=t.length;o<u;o++){const h=t[o];if(h.kind!==this.kind_&&h.mode==="showing"){r=!0;break}}r?this.disable():this.enable()}buildCSSClass(){return`vjs-descriptions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-descriptions-button ${super.buildWrapperCSSClass()}`}}a1.prototype.kind_="descriptions";a1.prototype.controlText_="Descriptions";qt.registerComponent("DescriptionsButton",a1);class o1 extends Sp{constructor(e,t,r){super(e,t,r)}buildCSSClass(){return`vjs-subtitles-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subtitles-button ${super.buildWrapperCSSClass()}`}}o1.prototype.kind_="subtitles";o1.prototype.controlText_="Subtitles";qt.registerComponent("SubtitlesButton",o1);class l1 extends C0{constructor(e,t){t.track={player:e,kind:t.kind,label:t.kind+" settings",selectable:!1,default:!1,mode:"disabled"},t.selectable=!1,t.name="CaptionSettingsMenuItem",super(e,t),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+t.kind+" settings dialog")}handleClick(e){this.player().getChild("textTrackSettings").open()}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.kind+" settings"),super.handleLanguagechange()}}qt.registerComponent("CaptionSettingsMenuItem",l1);class u1 extends Sp{constructor(e,t,r){super(e,t,r)}buildCSSClass(){return`vjs-captions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-captions-button ${super.buildWrapperCSSClass()}`}createItems(){const e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new l1(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(e)}}u1.prototype.kind_="captions";u1.prototype.controlText_="Captions";qt.registerComponent("CaptionsButton",u1);class JK extends C0{createEl(e,t,r){const o=super.createEl(e,t,r),u=o.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="captions"&&(u.appendChild(dr("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),u.appendChild(dr("span",{className:"vjs-control-text",textContent:` ${this.localize("Captions")}`}))),o}}qt.registerComponent("SubsCapsMenuItem",JK);class c1 extends Sp{constructor(e,t={}){super(e,t),this.label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)>-1&&(this.label_="captions"),this.menuButton_.controlText(Pi(this.label_))}buildCSSClass(){return`vjs-subs-caps-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subs-caps-button ${super.buildWrapperCSSClass()}`}createItems(){let e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new l1(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=super.createItems(e,JK),e}}c1.prototype.kinds_=["captions","subtitles"];c1.prototype.controlText_="Subtitles";qt.registerComponent("SubsCapsButton",c1);class ZK extends x0{constructor(e,t){const r=t.track,o=e.audioTracks();t.label=r.label||r.language||"Unknown",t.selected=r.enabled,super(e,t),this.track=r,this.addClass(`vjs-${r.kind}-menu-item`);const u=(...h)=>{this.handleTracksChange.apply(this,h)};o.addEventListener("change",u),this.on("dispose",()=>{o.removeEventListener("change",u)})}createEl(e,t,r){const o=super.createEl(e,t,r),u=o.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="main-desc"&&(u.appendChild(dr("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),u.appendChild(dr("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),o}handleClick(e){if(super.handleClick(e),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){const t=this.player_.audioTracks();for(let r=0;r<t.length;r++){const o=t[r];o!==this.track&&(o.enabled=o===this.track)}}}handleTracksChange(e){this.selected(this.track.enabled)}}qt.registerComponent("AudioTrackMenuItem",ZK);class eG extends i1{constructor(e,t={}){t.tracks=e.audioTracks(),super(e,t)}buildCSSClass(){return`vjs-audio-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-audio-button ${super.buildWrapperCSSClass()}`}createItems(e=[]){this.hideThreshold_=1;const t=this.player_.audioTracks();for(let r=0;r<t.length;r++){const o=t[r];e.push(new ZK(this.player_,{track:o,selectable:!0,multiSelectable:!1}))}return e}}eG.prototype.controlText_="Audio Track";qt.registerComponent("AudioTrackButton",eG);class f1 extends x0{constructor(e,t){const r=t.rate,o=parseFloat(r,10);t.label=r,t.selected=o===e.playbackRate(),t.selectable=!0,t.multiSelectable=!1,super(e,t),this.label=r,this.rate=o,this.on(e,"ratechange",u=>this.update(u))}handleClick(e){super.handleClick(),this.player().playbackRate(this.rate)}update(e){this.selected(this.player().playbackRate()===this.rate)}}f1.prototype.contentElType="button";qt.registerComponent("PlaybackRateMenuItem",f1);class tG extends r1{constructor(e,t){super(e,t),this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(e,"loadstart",r=>this.updateVisibility(r)),this.on(e,"ratechange",r=>this.updateLabel(r)),this.on(e,"playbackrateschange",r=>this.handlePlaybackRateschange(r))}createEl(){const e=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=dr("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),e.appendChild(this.labelEl_),e}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return`vjs-playback-rate ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-playback-rate ${super.buildWrapperCSSClass()}`}createItems(){const e=this.playbackRates(),t=[];for(let r=e.length-1;r>=0;r--)t.push(new f1(this.player(),{rate:e[r]+"x"}));return t}handlePlaybackRateschange(e){this.update()}playbackRates(){const e=this.player();return e.playbackRates&&e.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0}updateVisibility(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(e){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}tG.prototype.controlText_="Playback Rate";qt.registerComponent("PlaybackRateMenuButton",tG);class nG extends qt{buildCSSClass(){return`vjs-spacer ${super.buildCSSClass()}`}createEl(e="div",t={},r={}){return t.className||(t.className=this.buildCSSClass()),super.createEl(e,t,r)}}qt.registerComponent("Spacer",nG);class Oie extends nG{buildCSSClass(){return`vjs-custom-control-spacer ${super.buildCSSClass()}`}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:" "})}}qt.registerComponent("CustomControlSpacer",Oie);class B_ extends qt{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}}B_.prototype.options_={children:["playToggle","skipBackward","skipForward","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]};"exitPictureInPicture"in mn&&B_.prototype.options_.children.splice(B_.prototype.options_.children.length-1,0,"pictureInPictureToggle");qt.registerComponent("ControlBar",B_);class rG extends _p{constructor(e,t){super(e,t),this.on(e,"error",r=>this.open(r))}buildCSSClass(){return`vjs-error-display ${super.buildCSSClass()}`}content(){const e=this.player().error();return e?this.localize(e.message):""}}rG.prototype.options_=Object.assign({},_p.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0});qt.registerComponent("ErrorDisplay",rG);const gI="vjs-text-track-settings",U2=["#000","Black"],B2=["#00F","Blue"],j2=["#0FF","Cyan"],K2=["#0F0","Green"],G2=["#F0F","Magenta"],W2=["#F00","Red"],H2=["#FFF","White"],V2=["#FF0","Yellow"],mI=["1","Opaque"],vI=["0.5","Semi-Transparent"],$2=["0","Transparent"],Mf={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[U2,H2,W2,K2,B2,V2,G2,j2]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Opacity",options:[mI,vI,$2]},color:{selector:".vjs-text-color > select",id:"captions-foreground-color-%s",label:"Color",options:[H2,U2,W2,K2,B2,V2,G2,j2]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:n=>n==="1.00"?null:Number(n)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Opacity",options:[mI,vI]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Opacity",options:[$2,vI,mI]}};Mf.windowColor.options=Mf.backgroundColor.options;function iG(n,e){if(e&&(n=e(n)),n&&n!=="none")return n}function Nie(n,e){const t=n.options[n.options.selectedIndex].value;return iG(t,e)}function Fie(n,e,t){if(e){for(let r=0;r<n.options.length;r++)if(iG(n.options[r].value,t)===e){n.selectedIndex=r;break}}}class kie extends _p{constructor(e,t){t.temporary=!1,super(e,t),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.endDialog=dr("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),t.persistTextTrackSettings===void 0&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.on(this.$(".vjs-done-button"),"click",()=>{this.saveSettings(),this.close()}),this.on(this.$(".vjs-default-button"),"click",()=>{this.setDefaults(),this.updateDisplay()}),Nh(Mf,r=>{this.on(this.$(r.selector),"change",this.updateDisplay)}),this.options_.persistTextTrackSettings&&this.restoreSettings()}dispose(){this.endDialog=null,super.dispose()}createElSelect_(e,t="",r="label"){const o=Mf[e],u=o.id.replace("%s",this.id_),h=[t,u].join(" ").trim();return[`<${r} id="${u}" class="${r==="label"?"vjs-label":""}">`,this.localize(o.label),`</${r}>`,`<select aria-labelledby="${h}">`].concat(o.options.map(f=>{const d=u+"-"+f[1].replace(/\W+/g,"");return[`<option id="${d}" value="${f[0]}" `,`aria-labelledby="${h} ${d}">`,this.localize(f[1]),"</option>"].join("")})).concat("</select>").join("")}createElFgColor_(){const e=`captions-text-legend-${this.id_}`;return['<fieldset class="vjs-fg vjs-track-setting">',`<legend id="${e}">`,this.localize("Text"),"</legend>",'<span class="vjs-text-color">',this.createElSelect_("color",e),"</span>",'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")}createElBgColor_(){const e=`captions-background-${this.id_}`;return['<fieldset class="vjs-bg vjs-track-setting">',`<legend id="${e}">`,this.localize("Text Background"),"</legend>",'<span class="vjs-bg-color">',this.createElSelect_("backgroundColor",e),"</span>",'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")}createElWinColor_(){const e=`captions-window-${this.id_}`;return['<fieldset class="vjs-window vjs-track-setting">',`<legend id="${e}">`,this.localize("Caption Area Background"),"</legend>",'<span class="vjs-window-color">',this.createElSelect_("windowColor",e),"</span>",'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")}createElColors_(){return dr("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})}createElFont_(){return dr("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})}createElControls_(){const e=this.localize("restore all settings to the default values");return dr("div",{className:"vjs-track-settings-controls",innerHTML:[`<button type="button" class="vjs-default-button" title="${e}">`,this.localize("Reset"),`<span class="vjs-control-text"> ${e}</span>`,"</button>",`<button type="button" class="vjs-done-button">${this.localize("Done")}</button>`].join("")})}content(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return rK(Mf,(e,t,r)=>{const o=Nie(this.$(t.selector),t.parser);return o!==void 0&&(e[r]=o),e},{})}setValues(e){Nh(Mf,(t,r)=>{Fie(this.$(t.selector),e[r],t.parser)})}setDefaults(){Nh(Mf,e=>{const t=e.hasOwnProperty("default")?e.default:0;this.$(e.selector).selectedIndex=t})}restoreSettings(){let e;try{e=JSON.parse(rt.localStorage.getItem(gI))}catch(t){Er.warn(t)}e&&this.setValues(e)}saveSettings(){if(!this.options_.persistTextTrackSettings)return;const e=this.getValues();try{Object.keys(e).length?rt.localStorage.setItem(gI,JSON.stringify(e)):rt.localStorage.removeItem(gI)}catch(t){Er.warn(t)}}updateDisplay(){const e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()}conditionalBlur_(){this.previouslyActiveEl_=null;const e=this.player_.controlBar,t=e&&e.subsCapsButton,r=e&&e.captionsButton;t?t.focus():r&&r.focus()}handleLanguagechange(){this.fill()}}qt.registerComponent("TextTrackSettings",kie);class Uie extends qt{constructor(e,t){let r=t.ResizeObserver||rt.ResizeObserver;t.ResizeObserver===null&&(r=!1);const o=Xr({createEl:!r,reportTouchActivity:!1},t);super(e,o),this.ResizeObserver=t.ResizeObserver||rt.ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=AK(()=>{this.resizeHandler()},100,!1,this),r?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(e.el())):(this.loadListener_=()=>{if(!this.el_||!this.el_.contentWindow)return;const u=this.debouncedHandler_;let h=this.unloadListener_=function(){Cs(this,"resize",u),Cs(this,"unload",h),h=null};Ha(this.el_.contentWindow,"unload",h),Ha(this.el_.contentWindow,"resize",u)},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}}qt.registerComponent("ResizeManager",Uie);const Bie={trackingThreshold:20,liveTolerance:15};class jie extends qt{constructor(e,t){const r=Xr(Bie,t,{createEl:!1});super(e,r),this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=o=>this.handlePlay(o),this.handleFirstTimeupdate_=o=>this.handleFirstTimeupdate(o),this.handleSeeked_=o=>this.handleSeeked(o),this.seekToLiveEdge_=o=>this.seekToLiveEdge(o),this.reset_(),this.on(this.player_,"durationchange",o=>this.handleDurationchange(o)),this.on(this.player_,"canplay",()=>this.toggleTracking())}trackLive_(){const e=this.player_.seekable();if(!e||!e.length)return;const t=Number(rt.performance.now().toFixed(4)),r=this.lastTime_===-1?0:(t-this.lastTime_)/1e3;this.lastTime_=t,this.pastSeekEnd_=this.pastSeekEnd()+r;const o=this.liveCurrentTime(),u=this.player_.currentTime();let h=this.player_.paused()||this.seekedBehindLive_||Math.abs(o-u)>this.options_.liveTolerance;(!this.timeupdateSeen_||o===1/0)&&(h=!1),h!==this.behindLiveEdge_&&(this.behindLiveEdge_=h,this.trigger("liveedgechange"))}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,po),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){const e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&e>2,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){const e=this.player_.seekable(),t=[];let r=e?e.length:0;for(;r--;)t.push(e.end(r));return t.length?t.sort()[t.length-1]:1/0}seekableStart(){const e=this.player_.seekable(),t=[];let r=e?e.length:0;for(;r--;)t.push(e.start(r));return t.length?t.sort()[0]:0}liveWindow(){const e=this.liveCurrentTime();return e===1/0?0:e-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){const e=this.seekableEnd();return this.lastSeekEnd_!==-1&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return typeof this.trackingInterval_=="number"}seekToLiveEdge(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}}qt.registerComponent("LiveTracker",jie);class Kie extends qt{constructor(e,t){super(e,t),this.on("statechanged",r=>this.updateDom_()),this.updateDom_()}createEl(){return this.els={title:dr("div",{className:"vjs-title-bar-title",id:`vjs-title-bar-title-${jl()}`}),description:dr("div",{className:"vjs-title-bar-description",id:`vjs-title-bar-description-${jl()}`})},dr("div",{className:"vjs-title-bar"},{},Object.values(this.els))}updateDom_(){const e=this.player_.tech_,t=e&&e.el_,r={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach(o=>{const u=this.state[o],h=this.els[o],f=r[o];eS(h),u&&Vc(h,u),t&&(t.removeAttribute(f),u&&t.setAttribute(f,h.id))}),this.state.title||this.state.description?this.show():this.hide()}update(e){this.setState(e)}dispose(){const e=this.player_.tech_,t=e&&e.el_;t&&(t.removeAttribute("aria-labelledby"),t.removeAttribute("aria-describedby")),super.dispose(),this.els=null}}qt.registerComponent("TitleBar",Kie);const _b=n=>{const e=n.el();if(e.hasAttribute("src"))return n.triggerSourceset(e.src),!0;const t=n.$$("source"),r=[];let o="";if(!t.length)return!1;for(let u=0;u<t.length;u++){const h=t[u].src;h&&r.indexOf(h)===-1&&r.push(h)}return r.length?(r.length===1&&(o=r[0]),n.triggerSourceset(o),!0):!1},Gie=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(n){const e=mn.createElement(this.nodeName.toLowerCase());e.innerHTML=n;const t=mn.createDocumentFragment();for(;e.childNodes.length;)t.appendChild(e.childNodes[0]);return this.innerText="",rt.Element.prototype.appendChild.call(this,t),this.innerHTML}}),sG=(n,e)=>{let t={};for(let r=0;r<n.length&&(t=Object.getOwnPropertyDescriptor(n[r],e),!(t&&t.set&&t.get));r++);return t.enumerable=!0,t.configurable=!0,t},Wie=n=>sG([n.el(),rt.HTMLMediaElement.prototype,rt.Element.prototype,Gie],"innerHTML"),z2=function(n){const e=n.el();if(e.resetSourceWatch_)return;const t={},r=Wie(n),o=u=>(...h)=>{const f=u.apply(e,h);return _b(n),f};["append","appendChild","insertAdjacentHTML"].forEach(u=>{e[u]&&(t[u]=e[u],e[u]=o(t[u]))}),Object.defineProperty(e,"innerHTML",Xr(r,{set:o(r.set)})),e.resetSourceWatch_=()=>{e.resetSourceWatch_=null,Object.keys(t).forEach(u=>{e[u]=t[u]}),Object.defineProperty(e,"innerHTML",r)},n.one("sourceset",e.resetSourceWatch_)},Hie=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?wK(rt.Element.prototype.getAttribute.call(this,"src")):""},set(n){return rt.Element.prototype.setAttribute.call(this,"src",n),n}}),Vie=n=>sG([n.el(),rt.HTMLMediaElement.prototype,Hie],"src"),$ie=function(n){if(!n.featuresSourceset)return;const e=n.el();if(e.resetSourceset_)return;const t=Vie(n),r=e.setAttribute,o=e.load;Object.defineProperty(e,"src",Xr(t,{set:u=>{const h=t.set.call(e,u);return n.triggerSourceset(e.src),h}})),e.setAttribute=(u,h)=>{const f=r.call(e,u,h);return/src/i.test(u)&&n.triggerSourceset(e.src),f},e.load=()=>{const u=o.call(e);return _b(n)||(n.triggerSourceset(""),z2(n)),u},e.currentSrc?n.triggerSourceset(e.currentSrc):_b(n)||z2(n),e.resetSourceset_=()=>{e.resetSourceset_=null,e.load=o,e.setAttribute=r,Object.defineProperty(e,"src",t),e.resetSourceWatch_&&e.resetSourceWatch_()}};class An extends ir{constructor(e,t){super(e,t);const r=e.source;let o=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&this.el_.tagName==="VIDEO",r&&(this.el_.currentSrc!==r.src||e.tag&&e.tag.initNetworkState_===3)?this.setSource(r):this.handleLateInit_(this.el_),e.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){const u=this.el_.childNodes;let h=u.length;const f=[];for(;h--;){const d=u[h];d.nodeName.toLowerCase()==="track"&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(d),this.remoteTextTracks().addTrack(d.track),this.textTracks().addTrack(d.track),!o&&!this.el_.hasAttribute("crossorigin")&&iS(d.src)&&(o=!0)):f.push(d))}for(let d=0;d<f.length;d++)this.el_.removeChild(f[d])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&o&&Er.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),this.restoreMetadataTracksInIOSNativePlayer_(),(r0||XT)&&e.nativeControlsForTouch===!0&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),An.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){$ie(this)}restoreMetadataTracksInIOSNativePlayer_(){const e=this.textTracks();let t;const r=()=>{t=[];for(let u=0;u<e.length;u++){const h=e[u];h.kind==="metadata"&&t.push({track:h,storedMode:h.mode})}};r(),e.addEventListener("change",r),this.on("dispose",()=>e.removeEventListener("change",r));const o=()=>{for(let u=0;u<t.length;u++){const h=t[u];h.track.mode==="disabled"&&h.track.mode!==h.storedMode&&(h.track.mode=h.storedMode)}e.removeEventListener("change",o)};this.on("webkitbeginfullscreen",()=>{e.removeEventListener("change",r),e.removeEventListener("change",o),e.addEventListener("change",o)}),this.on("webkitendfullscreen",()=>{e.removeEventListener("change",r),e.addEventListener("change",r),e.removeEventListener("change",o)})}overrideNative_(e,t){if(t!==this[`featuresNative${e}Tracks`])return;const r=e.toLowerCase();this[`${r}TracksListeners_`]&&Object.keys(this[`${r}TracksListeners_`]).forEach(o=>{this.el()[`${r}Tracks`].removeEventListener(o,this[`${r}TracksListeners_`][o])}),this[`featuresNative${e}Tracks`]=!t,this[`${r}TracksListeners_`]=null,this.proxyNativeTracksForType_(r)}overrideNativeAudioTracks(e){this.overrideNative_("Audio",e)}overrideNativeVideoTracks(e){this.overrideNative_("Video",e)}proxyNativeTracksForType_(e){const t=co[e],r=this.el()[t.getterName],o=this[t.getterName]();if(!this[`featuresNative${t.capitalName}Tracks`]||!r||!r.addEventListener)return;const u={change:f=>{const d={type:"change",target:o,currentTarget:o,srcElement:o};o.trigger(d),e==="text"&&this[op.remoteText.getterName]().trigger(d)},addtrack(f){o.addTrack(f.track)},removetrack(f){o.removeTrack(f.track)}},h=function(){const f=[];for(let d=0;d<o.length;d++){let m=!1;for(let g=0;g<r.length;g++)if(r[g]===o[d]){m=!0;break}m||f.push(o[d])}for(;f.length;)o.removeTrack(f.shift())};this[t.getterName+"Listeners_"]=u,Object.keys(u).forEach(f=>{const d=u[f];r.addEventListener(f,d),this.on("dispose",m=>r.removeEventListener(f,d))}),this.on("loadstart",h),this.on("dispose",f=>this.off("loadstart",h))}proxyNativeTracks_(){co.names.forEach(e=>{this.proxyNativeTracksForType_(e)})}createEl(){let e=this.options_.tag;if(!e||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(e){const r=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(r,e),An.disposeMediaElement(e),e=r}else{e=mn.createElement("video");const r=this.options_.tag&&vc(this.options_.tag),o=Xr({},r);(!r0||this.options_.nativeControlsForTouch!==!0)&&delete o.controls,fK(e,Object.assign(o,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}typeof this.options_.preload<"u"&&rp(e,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);const t=["loop","muted","playsinline","autoplay"];for(let r=0;r<t.length;r++){const o=t[r],u=this.options_[o];typeof u<"u"&&(u?rp(e,o,o):JT(e,o),e[o]=u)}return e}handleLateInit_(e){if(e.networkState===0||e.networkState===3)return;if(e.readyState===0){let r=!1;const o=function(){r=!0};this.on("loadstart",o);const u=function(){r||this.trigger("loadstart")};this.on("loadedmetadata",u),this.ready(function(){this.off("loadstart",o),this.off("loadedmetadata",u),r||this.trigger("loadstart")});return}const t=["loadstart"];t.push("loadedmetadata"),e.readyState>=2&&t.push("loadeddata"),e.readyState>=3&&t.push("canplay"),e.readyState>=4&&t.push("canplaythrough"),this.ready(function(){t.forEach(function(r){this.trigger(r)},this)})}setScrubbing(e){this.isScrubbing_=e}scrubbing(){return this.isScrubbing_}setCurrentTime(e){try{this.isScrubbing_&&this.el_.fastSeek&&qT?this.el_.fastSeek(e):this.el_.currentTime=e}catch(t){Er(t,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===1/0&&Ul&&Bl&&this.el_.currentTime===0){const e=()=>{this.el_.currentTime>0&&(this.el_.duration===1/0&&this.trigger("durationchange"),this.off("timeupdate",e))};return this.on("timeupdate",e),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if(!("webkitDisplayingFullscreen"in this.el_))return;const e=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},t=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",t),this.on("dispose",()=>{this.off("webkitbeginfullscreen",t),this.off("webkitendfullscreen",e)})}supportsFullScreen(){return typeof this.el_.webkitEnterFullScreen=="function"}enterFullScreen(){const e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)Al(this.el_.play()),this.setTimeout(function(){e.pause();try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}},0);else try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}}exitFullScreen(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(e){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(e):super.requestVideoFrameCallback(e)}cancelVideoFrameCallback(e){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(e):super.cancelVideoFrameCallback(e)}src(e){if(e===void 0)return this.el_.src;this.setSrc(e)}reset(){An.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(e){this.el_.controls=!!e}addTextTrack(e,t,r){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,r):super.addTextTrack(e,t,r)}createRemoteTextTrack(e){if(!this.featuresNativeTextTracks)return super.createRemoteTextTrack(e);const t=mn.createElement("track");return e.kind&&(t.kind=e.kind),e.label&&(t.label=e.label),(e.language||e.srclang)&&(t.srclang=e.language||e.srclang),e.default&&(t.default=e.default),e.id&&(t.id=e.id),e.src&&(t.src=e.src),t}addRemoteTextTrack(e,t){const r=super.addRemoteTextTrack(e,t);return this.featuresNativeTextTracks&&this.el().appendChild(r),r}removeRemoteTextTrack(e){if(super.removeRemoteTextTrack(e),this.featuresNativeTextTracks){const t=this.$$("track");let r=t.length;for(;r--;)(e===t[r]||e===t[r].track)&&this.el().removeChild(t[r])}}getVideoPlaybackQuality(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();const e={};return typeof this.el().webkitDroppedFrameCount<"u"&&typeof this.el().webkitDecodedFrameCount<"u"&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),rt.performance&&(e.creationTime=rt.performance.now()),e}}$T(An,"TEST_VID",function(){if(!vp())return;const n=mn.createElement("video"),e=mn.createElement("track");return e.kind="captions",e.srclang="en",e.label="English",n.appendChild(e),n});An.isSupported=function(){try{An.TEST_VID.volume=.5}catch{return!1}return!!(An.TEST_VID&&An.TEST_VID.canPlayType)};An.canPlayType=function(n){return An.TEST_VID.canPlayType(n)};An.canPlaySource=function(n,e){return An.canPlayType(n.type)};An.canControlVolume=function(){try{const n=An.TEST_VID.volume;An.TEST_VID.volume=n/2+.1;const e=n!==An.TEST_VID.volume;return e&&$s?(rt.setTimeout(()=>{An&&An.prototype&&(An.prototype.featuresVolumeControl=n!==An.TEST_VID.volume)}),!1):e}catch{return!1}};An.canMuteVolume=function(){try{const n=An.TEST_VID.muted;return An.TEST_VID.muted=!n,An.TEST_VID.muted?rp(An.TEST_VID,"muted","muted"):JT(An.TEST_VID,"muted","muted"),n!==An.TEST_VID.muted}catch{return!1}};An.canControlPlaybackRate=function(){if(Ul&&Bl&&zT<58)return!1;try{const n=An.TEST_VID.playbackRate;return An.TEST_VID.playbackRate=n/2+.1,n!==An.TEST_VID.playbackRate}catch{return!1}};An.canOverrideAttributes=function(){try{const n=()=>{};Object.defineProperty(mn.createElement("video"),"src",{get:n,set:n}),Object.defineProperty(mn.createElement("audio"),"src",{get:n,set:n}),Object.defineProperty(mn.createElement("video"),"innerHTML",{get:n,set:n}),Object.defineProperty(mn.createElement("audio"),"innerHTML",{get:n,set:n})}catch{return!1}return!0};An.supportsNativeTextTracks=function(){return qT||$s&&Bl};An.supportsNativeVideoTracks=function(){return!!(An.TEST_VID&&An.TEST_VID.videoTracks)};An.supportsNativeAudioTracks=function(){return!!(An.TEST_VID&&An.TEST_VID.audioTracks)};An.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function([n,e]){$T(An.prototype,n,()=>An[e](),!0)});An.prototype.featuresVolumeControl=An.canControlVolume();An.prototype.movingMediaElementInDOM=!$s;An.prototype.featuresFullscreenResize=!0;An.prototype.featuresProgressEvents=!0;An.prototype.featuresTimeupdateEvents=!0;An.prototype.featuresVideoFrameCallback=!!(An.TEST_VID&&An.TEST_VID.requestVideoFrameCallback);An.disposeMediaElement=function(n){if(n){for(n.parentNode&&n.parentNode.removeChild(n);n.hasChildNodes();)n.removeChild(n.firstChild);n.removeAttribute("src"),typeof n.load=="function"&&function(){try{n.load()}catch{}}()}};An.resetMediaElement=function(n){if(!n)return;const e=n.querySelectorAll("source");let t=e.length;for(;t--;)n.removeChild(e[t]);n.removeAttribute("src"),typeof n.load=="function"&&function(){try{n.load()}catch{}}()};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(n){An.prototype[n]=function(){return this.el_[n]||this.el_.hasAttribute(n)}});["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(n){An.prototype["set"+Pi(n)]=function(e){this.el_[n]=e,e?this.el_.setAttribute(n,n):this.el_.removeAttribute(n)}});["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(n){An.prototype[n]=function(){return this.el_[n]}});["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(n){An.prototype["set"+Pi(n)]=function(e){this.el_[n]=e}});["pause","load","play"].forEach(function(n){An.prototype[n]=function(){return this.el_[n]()}});ir.withSourceHandlers(An);An.nativeSourceHandler={};An.nativeSourceHandler.canPlayType=function(n){try{return An.TEST_VID.canPlayType(n)}catch{return""}};An.nativeSourceHandler.canHandleSource=function(n,e){if(n.type)return An.nativeSourceHandler.canPlayType(n.type);if(n.src){const t=XP(n.src);return An.nativeSourceHandler.canPlayType(`video/${t}`)}return""};An.nativeSourceHandler.handleSource=function(n,e,t){e.setSrc(n.src)};An.nativeSourceHandler.dispose=function(){};An.registerSourceHandler(An.nativeSourceHandler);ir.registerTech("Html5",An);const aG=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],yI={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Tb=["tiny","xsmall","small","medium","large","xlarge","huge"],FE={};Tb.forEach(n=>{const e=n.charAt(0)==="x"?`x-${n.substring(1)}`:n;FE[n]=`vjs-layout-${e}`});const zie={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0};class Jr extends qt{constructor(e,t,r){if(e.id=e.id||t.id||`vjs_video_${jl()}`,t=Object.assign(Jr.getTagSettings(e),t),t.initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language){const h=e.closest("[lang]");h&&(t.language=h.getAttribute("lang"))}if(super(null,t,r),this.boundDocumentFullscreenChange_=h=>this.documentFullscreenChange_(h),this.boundFullWindowOnEscKey_=h=>this.fullWindowOnEscKey(h),this.boundUpdateStyleEl_=h=>this.updateStyleEl_(h),this.boundApplyInitTime_=h=>this.applyInitTime_(h),this.boundUpdateCurrentBreakpoint_=h=>this.updateCurrentBreakpoint_(h),this.boundHandleTechClick_=h=>this.handleTechClick_(h),this.boundHandleTechDoubleClick_=h=>this.handleTechDoubleClick_(h),this.boundHandleTechTouchStart_=h=>this.handleTechTouchStart_(h),this.boundHandleTechTouchMove_=h=>this.handleTechTouchMove_(h),this.boundHandleTechTouchEnd_=h=>this.handleTechTouchEnd_(h),this.boundHandleTechTap_=h=>this.handleTechTap_(h),this.isFullscreen_=!1,this.log=tK(this.id_),this.fsApi_=M_,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=e,this.tagAttributes=e&&vc(e),this.language(this.options_.language),t.languages){const h={};Object.getOwnPropertyNames(t.languages).forEach(function(f){h[f.toLowerCase()]=t.languages[f]}),this.languages_=h}else this.languages_=Jr.prototype.options_.languages;this.resetCache_(),this.poster_=t.poster||"",this.controls_=!!t.controls,e.controls=!1,e.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],e.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),t.plugins&&Object.keys(t.plugins).forEach(h=>{if(typeof this[h]!="function")throw new Error(`plugin "${h}" does not exist`)}),this.scrubbing_=!1,this.el_=this.createEl(),VP(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(Ha(mn,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);const o=Xr(this.options_);t.plugins&&Object.keys(t.plugins).forEach(h=>{this[h](t.plugins[h])}),t.debug&&this.debug(!0),this.options_.playerOptions=o,this.middleware_=[],this.playbackRates(t.playbackRates),this.initChildren(),this.isAudio(e.nodeName.toLowerCase()==="audio"),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),r0&&this.addClass("vjs-touch-enabled"),$s||this.addClass("vjs-workinghover"),Jr.players[this.id_]=this;const u=J6.split(".")[0];this.addClass(`vjs-v${u}`),this.userActive(!0),this.reportUserActivity(),this.one("play",h=>this.listenForUserActivity_(h)),this.on("keydown",h=>this.handleKeyDown(h)),this.on("languagechange",h=>this.handleLanguagechange(h)),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)})}dispose(){this.trigger("dispose"),this.off("dispose"),Cs(mn,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),Cs(mn,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),Jr.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),pie(this),Us.names.forEach(e=>{const t=Us[e],r=this[t.getterName]();r&&r.off&&r.off()}),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let e=this.tag,t,r=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player");const o=this.tag.tagName.toLowerCase()==="video-js";r?t=this.el_=e.parentNode:o||(t=this.el_=super.createEl("div"));const u=vc(e);if(o){for(t=this.el_=e,e=this.tag=mn.createElement("video");t.children.length;)e.appendChild(t.firstChild);vm(t,"video-js")||Wf(t,"video-js"),t.appendChild(e),r=this.playerElIngest_=t,Object.keys(t).forEach(f=>{try{e[f]=t[f]}catch{}})}if(e.setAttribute("tabindex","-1"),u.tabindex="-1",Bl&&YT&&(e.setAttribute("role","application"),u.role="application"),e.removeAttribute("width"),e.removeAttribute("height"),"width"in u&&delete u.width,"height"in u&&delete u.height,Object.getOwnPropertyNames(u).forEach(function(f){o&&f==="class"||t.setAttribute(f,u[f]),o&&e.setAttribute(f,u[f])}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=t.player=this,this.addClass("vjs-paused"),rt.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=TK("vjs-styles-dimensions");const f=kc(".vjs-styles-defaults"),d=kc("head");d.insertBefore(this.styleEl_,f?f.nextSibling:d.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);const h=e.getElementsByTagName("a");for(let f=0;f<h.length;f++){const d=h.item(f);Wf(d,"vjs-hidden"),d.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!r&&e.parentNode.insertBefore(t,e),db(e,t),this.children_.unshift(e),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=t,t}crossOrigin(e){if(typeof e>"u")return this.techGet_("crossOrigin");if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){Er.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.techCall_("setCrossOrigin",e),this.posterImage&&this.posterImage.crossOrigin(e)}width(e){return this.dimension("width",e)}height(e){return this.dimension("height",e)}dimension(e,t){const r=e+"_";if(t===void 0)return this[r]||0;if(t===""||t==="auto"){this[r]=void 0,this.updateStyleEl_();return}const o=parseFloat(t);if(isNaN(o)){Er.error(`Improper value "${t}" supplied for for ${e}`);return}this[r]=o,this.updateStyleEl_()}fluid(e){if(e===void 0)return!!this.fluid_;this.fluid_=!!e,Du(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),Hre(this,()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(e){if(e===void 0)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(e){if(e===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(rt.VIDEOJS_NO_DYNAMIC_STYLE===!0){const f=typeof this.width_=="number"?this.width_:this.options_.width,d=typeof this.height_=="number"?this.height_:this.options_.height,m=this.tech_&&this.tech_.el();m&&(f>=0&&(m.width=f),d>=0&&(m.height=d));return}let e,t,r,o;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?r=this.aspectRatio_:this.videoWidth()>0?r=this.videoWidth()+":"+this.videoHeight():r="16:9";const u=r.split(":"),h=u[1]/u[0];this.width_!==void 0?e=this.width_:this.height_!==void 0?e=this.height_/h:e=this.videoWidth()||300,this.height_!==void 0?t=this.height_:t=e*h,/^[^a-zA-Z]/.test(this.id())?o="dimensions-"+this.id():o=this.id()+"-dimensions",this.addClass(o),SK(this.styleEl_,`
      .${o} {
        width: ${e}px;
        height: ${t}px;
      }

      .${o}.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: ${h*100}%;
      }
    `)}loadTech_(e,t){this.tech_&&this.unloadTech_();const r=Pi(e),o=e.charAt(0).toLowerCase()+e.slice(1);r!=="Html5"&&this.tag&&(ir.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=r,this.isReady_=!1;let u=this.autoplay();(typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay)&&(u=!1);const h={source:t,autoplay:u,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:`${this.id()}_${o}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};Us.names.forEach(d=>{const m=Us[d];h[m.getterName]=this[m.privateName]}),Object.assign(h,this.options_[r]),Object.assign(h,this.options_[o]),Object.assign(h,this.options_[e.toLowerCase()]),this.tag&&(h.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(h.startTime=this.cache_.currentTime);const f=ir.getTech(e);if(!f)throw new Error(`No Tech named '${r}' exists! '${r}' should be registered using videojs.registerTech()'`);this.tech_=new f(h),this.tech_.ready(Qr(this,this.handleTechReady_),!0),D2.jsonToTextTracks(this.textTracksJson_||[],this.tech_),aG.forEach(d=>{this.on(this.tech_,d,m=>this[`handleTech${Pi(d)}_`](m))}),Object.keys(yI).forEach(d=>{this.on(this.tech_,d,m=>{if(this.tech_.playbackRate()===0&&this.tech_.seeking()){this.queuedCallbacks_.push({callback:this[`handleTech${yI[d]}_`].bind(this),event:m});return}this[`handleTech${yI[d]}_`](m)})}),this.on(this.tech_,"loadstart",d=>this.handleTechLoadStart_(d)),this.on(this.tech_,"sourceset",d=>this.handleTechSourceset_(d)),this.on(this.tech_,"waiting",d=>this.handleTechWaiting_(d)),this.on(this.tech_,"ended",d=>this.handleTechEnded_(d)),this.on(this.tech_,"seeking",d=>this.handleTechSeeking_(d)),this.on(this.tech_,"play",d=>this.handleTechPlay_(d)),this.on(this.tech_,"pause",d=>this.handleTechPause_(d)),this.on(this.tech_,"durationchange",d=>this.handleTechDurationChange_(d)),this.on(this.tech_,"fullscreenchange",(d,m)=>this.handleTechFullscreenChange_(d,m)),this.on(this.tech_,"fullscreenerror",(d,m)=>this.handleTechFullscreenError_(d,m)),this.on(this.tech_,"enterpictureinpicture",d=>this.handleTechEnterPictureInPicture_(d)),this.on(this.tech_,"leavepictureinpicture",d=>this.handleTechLeavePictureInPicture_(d)),this.on(this.tech_,"error",d=>this.handleTechError_(d)),this.on(this.tech_,"posterchange",d=>this.handleTechPosterChange_(d)),this.on(this.tech_,"textdata",d=>this.handleTechTextData_(d)),this.on(this.tech_,"ratechange",d=>this.handleTechRateChange_(d)),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(r!=="Html5"||!this.tag)&&db(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){Us.names.forEach(e=>{const t=Us[e];this[t.privateName]=this[t.getterName]()}),this.textTracksJson_=D2.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(e){return e===void 0&&Er.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):this.trigger("loadstart"),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(e){if(!this.tech_||typeof e!="string")return;const t=()=>{const o=this.muted();this.muted(!0);const u=()=>{this.muted(o)};this.playTerminatedQueue_.push(u);const h=this.play();if(Em(h))return h.catch(f=>{throw u(),new Error(`Rejection at manualAutoplay. Restoring muted value. ${f||""}`)})};let r;if(e==="any"&&!this.muted()?(r=this.play(),Em(r)&&(r=r.catch(t))):e==="muted"&&!this.muted()?r=t():r=this.play(),!!Em(r))return r.then(()=>{this.trigger({type:"autoplay-success",autoplay:e})}).catch(()=>{this.trigger({type:"autoplay-failure",autoplay:e})})}updateSourceCaches_(e=""){let t=e,r="";typeof t!="string"&&(t=e.src,r=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!r&&(r=vie(this,t)),this.cache_.source=Xr({},e,{src:t,type:r});const o=this.cache_.sources.filter(d=>d.src&&d.src===t),u=[],h=this.$$("source"),f=[];for(let d=0;d<h.length;d++){const m=vc(h[d]);u.push(m),m.src&&m.src===t&&f.push(m.src)}f.length&&!o.length?this.cache_.sources=u:o.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t}handleTechSourceset_(e){if(!this.changingSrc_){let t=u=>this.updateSourceCaches_(u);const r=this.currentSource().src,o=e.src;r&&!/^blob:/.test(r)&&/^blob:/.test(o)&&(!this.lastSource_||this.lastSource_.tech!==o&&this.lastSource_.player!==r)&&(t=()=>{}),t(o),e.src||this.tech_.any(["sourceset","loadstart"],u=>{if(u.type==="sourceset")return;const h=this.techGet("currentSrc");this.lastSource_.tech=h,this.updateSourceCaches_(h)})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})}hasStarted(e){if(e===void 0)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(e=>e.callback(e.event)),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");const e=this.currentTime(),t=()=>{e!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",t))};this.on("timeupdate",t)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(e){this.controls_&&(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.click===void 0||this.options_.userActions.click!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,e):this.paused()?Al(this.play()):this.pause())}handleTechDoubleClick_(e){if(!this.controls_)return;Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),r=>r.contains(e.target))||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(e){e.cancelable&&e.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(e){const t=e.target.player;if(t&&t!==this)return;const r=this.el();let o=mn[this.fsApi_.fullscreenElement]===r;!o&&r.matches?o=r.matches(":"+this.fsApi_.fullscreen):!o&&r.msMatchesSelector&&(o=r.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(o)}handleTechFullscreenChange_(e,t){t&&(t.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",()=>{this.removeClass("vjs-ios-native-fs")})),this.isFullscreen(t.isFullscreen))}handleTechFullscreenError_(e,t){this.trigger("fullscreenerror",t)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(e){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(e){this.isInPictureInPicture(!1)}handleTechError_(){const e=this.tech_.error();this.error(e)}handleTechTextData_(){let e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(e,t){this.ready(function(){if(e in die)return cie(this.middleware_,this.tech_,e,t);if(e in O2)return w2(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(r){throw Er(r),r}},!0)}techGet_(e){if(!(!this.tech_||!this.tech_.isReady_)){if(e in fie)return uie(this.middleware_,this.tech_,e);if(e in O2)return w2(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(t){throw this.tech_[e]===void 0?(Er(`Video.js: ${e} method not defined for ${this.techName_} playback technology.`,t),t):t.name==="TypeError"?(Er(`Video.js: ${e} unavailable on ${this.techName_} playback technology element.`,t),this.tech_.isReady_=!1,t):(Er(t),t)}}}play(){return new Promise(e=>{this.play_(e)})}play_(e=Al){this.playCallbacks_.push(e);const t=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc())),r=Boolean(qT||$s);if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!t){this.waitToPlay_=h=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!t&&r&&this.load();return}const o=this.techGet_("play");r&&this.hasClass("vjs-ended")&&this.resetProgressBar_(),o===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(o)}runPlayTerminatedQueue_(){const e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(t){t()})}runPlayCallbacks_(e){const t=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],t.forEach(function(r){r(e)})}pause(){this.techCall_("pause")}paused(){return this.techGet_("paused")!==!1}played(){return this.techGet_("played")||Ll(0,0)}scrubbing(e){if(typeof e>"u")return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(e){if(typeof e<"u"){if(e<0&&(e=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=e,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",e),this.cache_.initTime=0;return}return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(e){if(e===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;e=parseFloat(e),e<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let e=this.techGet_("buffered");return(!e||!e.length)&&(e=Ll(0,0)),e}bufferedPercent(){return LK(this.buffered(),this.duration())}bufferedEnd(){const e=this.buffered(),t=this.duration();let r=e.end(e.length-1);return r>t&&(r=t),r}volume(e){let t;if(e!==void 0){t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),t>0&&this.lastVolume_(t);return}return t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t}muted(e){if(e!==void 0){this.techCall_("setMuted",e);return}return this.techGet_("muted")||!1}defaultMuted(e){return e!==void 0?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1}lastVolume_(e){if(e!==void 0&&e!==0){this.cache_.lastVolume=e;return}return this.cache_.lastVolume}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(e){if(e!==void 0){const t=this.isFullscreen_;this.isFullscreen_=Boolean(e),this.isFullscreen_!==t&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_}requestFullscreen(e){this.isInPictureInPicture()&&this.exitPictureInPicture();const t=this;return new Promise((r,o)=>{function u(){t.off("fullscreenerror",f),t.off("fullscreenchange",h)}function h(){u(),r()}function f(m,g){u(),o(g)}t.one("fullscreenchange",h),t.one("fullscreenerror",f);const d=t.requestFullscreenHelper_(e);d&&(d.then(u,u),d.then(r,o))})}requestFullscreenHelper_(e){let t;if(this.fsApi_.prefixed||(t=this.options_.fullscreen&&this.options_.fullscreen.options||{},e!==void 0&&(t=e)),this.fsApi_.requestFullscreen){const r=this.el_[this.fsApi_.requestFullscreen](t);return r&&r.then(()=>this.isFullscreen(!0),()=>this.isFullscreen(!1)),r}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const e=this;return new Promise((t,r)=>{function o(){e.off("fullscreenerror",h),e.off("fullscreenchange",u)}function u(){o(),t()}function h(d,m){o(),r(m)}e.one("fullscreenchange",u),e.one("fullscreenerror",h);const f=e.exitFullscreenHelper_();f&&(f.then(o,o),f.then(t,r))})}exitFullscreenHelper_(){if(this.fsApi_.requestFullscreen){const e=mn[this.fsApi_.exitFullscreen]();return e&&Al(e.then(()=>this.isFullscreen(!1))),e}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=mn.documentElement.style.overflow,Ha(mn,"keydown",this.boundFullWindowOnEscKey_),mn.documentElement.style.overflow="hidden",Wf(mn.body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(e){qn.isEventKey(e,"Esc")&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,Cs(mn,"keydown",this.boundFullWindowOnEscKey_),mn.documentElement.style.overflow=this.docOrigOverflow,QT(mn.body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(e){if(e===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(e){if(e!==void 0){this.isInPictureInPicture_=!!e,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_}requestPictureInPicture(){if(this.options_.enableDocumentPictureInPicture&&rt.documentPictureInPicture){const e=mn.createElement(this.el().tagName);return e.classList=this.el().classList,e.classList.add("vjs-pip-container"),this.posterImage&&e.appendChild(this.posterImage.el().cloneNode(!0)),this.titleBar&&e.appendChild(this.titleBar.el().cloneNode(!0)),e.appendChild(dr("p",{className:"vjs-pip-text"},{},this.localize("Playing in picture-in-picture"))),rt.documentPictureInPicture.requestWindow({initialAspectRatio:this.videoWidth()/this.videoHeight(),copyStyleSheets:!0}).then(t=>(this.el_.parentNode.insertBefore(e,this.el_),t.document.body.append(this.el_),t.document.body.classList.add("vjs-pip-window"),this.player_.isInPictureInPicture(!0),this.player_.trigger("enterpictureinpicture"),t.addEventListener("unload",r=>{const o=r.target.querySelector(".video-js");e.replaceWith(o),this.player_.isInPictureInPicture(!1),this.player_.trigger("leavepictureinpicture")}),t))}return"pictureInPictureEnabled"in mn&&this.disablePictureInPicture()===!1?this.techGet_("requestPictureInPicture"):Promise.reject("No PiP mode is available")}exitPictureInPicture(){if(rt.documentPictureInPicture&&rt.documentPictureInPicture.window)return rt.documentPictureInPicture.window.close(),Promise.resolve();if("pictureInPictureEnabled"in mn)return mn.exitPictureInPicture()}handleKeyDown(e){const{userActions:t}=this.options_;!t||!t.hotkeys||(o=>{const u=o.tagName.toLowerCase();if(o.isContentEditable)return!0;const h=["button","checkbox","hidden","radio","reset","submit"];return u==="input"?h.indexOf(o.type)===-1:["textarea"].indexOf(u)!==-1})(this.el_.ownerDocument.activeElement)||(typeof t.hotkeys=="function"?t.hotkeys.call(this,e):this.handleHotkeys(e))}handleHotkeys(e){const t=this.options_.userActions?this.options_.userActions.hotkeys:{},{fullscreenKey:r=h=>qn.isEventKey(h,"f"),muteKey:o=h=>qn.isEventKey(h,"m"),playPauseKey:u=h=>qn.isEventKey(h,"k")||qn.isEventKey(h,"Space")}=t;if(r.call(this,e)){e.preventDefault(),e.stopPropagation();const h=qt.getComponent("FullscreenToggle");mn[this.fsApi_.fullscreenEnabled]!==!1&&h.prototype.handleClick.call(this,e)}else o.call(this,e)?(e.preventDefault(),e.stopPropagation(),qt.getComponent("MuteToggle").prototype.handleClick.call(this,e)):u.call(this,e)&&(e.preventDefault(),e.stopPropagation(),qt.getComponent("PlayToggle").prototype.handleClick.call(this,e))}canPlayType(e){let t;for(let r=0,o=this.options_.techOrder;r<o.length;r++){const u=o[r];let h=ir.getTech(u);if(h||(h=qt.getComponent(u)),!h){Er.error(`The "${u}" tech is undefined. Skipped browser support check for that tech.`);continue}if(h.isSupported()&&(t=h.canPlayType(e),t))return t}return""}selectSource(e){const t=this.options_.techOrder.map(f=>[f,ir.getTech(f)]).filter(([f,d])=>d?d.isSupported():(Er.error(`The "${f}" tech is undefined. Skipped browser support check for that tech.`),!1)),r=function(f,d,m){let g;return f.some(v=>d.some(_=>{if(g=m(v,_),g)return!0})),g};let o;const u=f=>(d,m)=>f(m,d),h=([f,d],m)=>{if(d.canPlaySource(m,this.options_[f.toLowerCase()]))return{source:m,tech:f}};return this.options_.sourceOrder?o=r(e,t,u(h)):o=r(t,e,h),o||!1}handleSrc_(e,t){if(typeof e>"u")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const r=FK(e);if(!r.length){this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0);return}if(this.changingSrc_=!0,t||(this.cache_.sources=r),this.updateSourceCaches_(r[0]),oie(this,r[0],(o,u)=>{if(this.middleware_=u,t||(this.cache_.sources=r),this.updateSourceCaches_(o),this.src_(o)){if(r.length>1)return this.handleSrc_(r.slice(1));this.changingSrc_=!1,this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),this.triggerReady();return}lie(u,this.tech_)}),r.length>1){const o=()=>{this.error(null),this.handleSrc_(r.slice(1),!0)},u=()=>{this.off("error",o)};this.one("error",o),this.one("playing",u),this.resetRetryOnError_=()=>{this.off("error",o),this.off("playing",u)}}}src(e){return this.handleSrc_(e,!1)}src_(e){const t=this.selectSource([e]);return t?RK(t.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(t.tech,t.source),this.tech_.ready(()=>{this.changingSrc_=!1}),!1):!0}load(){this.techCall_("load")}reset(){if(this.paused())this.doReset_();else{const e=this.play();Al(e.then(()=>this.doReset_()))}}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),Du(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);const{currentTimeDisplay:e,durationDisplay:t,progressControl:r,remainingTimeDisplay:o}=this.controlBar||{},{seekBar:u}=r||{};e&&e.updateContent(),t&&t.updateContent(),o&&o.updateContent(),u&&(u.update(),u.loadProgressBar&&u.loadProgressBar.update())}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){const e=this.currentSource(),t=[];return Object.keys(e).length!==0&&t.push(e),this.cache_.sources||t}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(e){if(e!==void 0){this.techCall_("setPreload",e),this.options_.preload=e;return}return this.techGet_("preload")}autoplay(e){if(e===void 0)return this.options_.autoplay||!1;let t;typeof e=="string"&&/(any|play|muted)/.test(e)||e===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=e,this.manualAutoplay_(typeof e=="string"?e:"play"),t=!1):e?this.options_.autoplay=!0:this.options_.autoplay=!1,t=typeof t>"u"?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)}playsinline(e){return e!==void 0?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")}loop(e){if(e!==void 0){this.techCall_("setLoop",e),this.options_.loop=e;return}return this.techGet_("loop")}poster(e){if(e===void 0)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){const e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}}controls(e){if(e===void 0)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(e){if(e===void 0)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(e){if(e===void 0)return this.error_||null;if(Fc("beforeerror").forEach(t=>{const r=t(this,e);if(!(kl(r)&&!Array.isArray(r)||typeof r=="string"||typeof r=="number"||r===null)){this.log.error("please return a value that MediaError expects in beforeerror hooks");return}e=r}),this.options_.suppressNotSupportedError&&e&&e.code===4){const t=function(){this.error(e)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),this.one("loadstart",function(){this.off(["click","touchstart"],t)});return}if(e===null){this.error_=e,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new Gs(e),this.addClass("vjs-error"),Er.error(`(CODE:${this.error_.code} ${Gs.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),Fc("error").forEach(t=>t(this,this.error_))}reportUserActivity(e){this.userActivity_=!0}userActive(e){if(e===void 0)return this.userActive_;if(e=!!e,e!==this.userActive_){if(this.userActive_=e,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(t){t.stopPropagation(),t.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}}listenForUserActivity_(){let e,t,r;const o=Qr(this,this.reportUserActivity),u=function(g){(g.screenX!==t||g.screenY!==r)&&(t=g.screenX,r=g.screenY,o())},h=function(){o(),this.clearInterval(e),e=this.setInterval(o,250)},f=function(g){o(),this.clearInterval(e)};this.on("mousedown",h),this.on("mousemove",u),this.on("mouseup",f),this.on("mouseleave",f);const d=this.getChild("controlBar");d&&!$s&&!Ul&&(d.on("mouseenter",function(g){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),d.on("mouseleave",function(g){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",o),this.on("keyup",o);let m;this.setInterval(function(){if(!this.userActivity_)return;this.userActivity_=!1,this.userActive(!0),this.clearTimeout(m);const g=this.options_.inactivityTimeout;g<=0||(m=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},g))},250)}playbackRate(e){if(e!==void 0){this.techCall_("setPlaybackRate",e);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1}defaultPlaybackRate(e){return e!==void 0?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(e){if(e!==void 0){this.isAudio_=!!e;return}return!!this.isAudio_}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");const e=this.children(),t=this.getChild("ControlBar"),r=t&&t.currentHeight();e.forEach(o=>{o!==t&&o.el_&&!o.hasClass("vjs-hidden")&&(o.hide(),this.audioOnlyCache_.hiddenChildren.push(o))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.height(r),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.audioOnlyCache_.hiddenChildren.forEach(e=>e.show()),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(e){if(typeof e!="boolean"||e===this.audioOnlyMode_)return this.audioOnlyMode_;if(this.audioOnlyMode_=e,e){const t=[];return this.isInPictureInPicture()&&t.push(this.exitPictureInPicture()),this.isFullscreen()&&t.push(this.exitFullscreen()),this.audioPosterMode()&&t.push(this.audioPosterMode(!1)),Promise.all(t).then(()=>this.enableAudioOnlyUI_())}return Promise.resolve().then(()=>this.disableAudioOnlyUI_())}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(e){return typeof e!="boolean"||e===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=e,e?this.audioOnlyMode()?this.audioOnlyMode(!1).then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.disablePosterModeUI_()}))}addTextTrack(e,t,r){if(this.tech_)return this.tech_.addTextTrack(e,t,r)}addRemoteTextTrack(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)}removeRemoteTextTrack(e={}){let{track:t}=e;if(t||(t=e),this.tech_)return this.tech_.removeRemoteTextTrack(t)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(e){if(e===void 0)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),Du(this)&&this.trigger("languagechange"))}languages(){return Xr(Jr.prototype.options_.languages,this.languages_)}toJSON(){const e=Xr(this.options_),t=e.tracks;e.tracks=[];for(let r=0;r<t.length;r++){let o=t[r];o=Xr(o),o.player=void 0,e.tracks[r]=o}return e}createModal(e,t){t=t||{},t.content=e||"";const r=new _p(this,t);return this.addChild(r),r.on("dispose",()=>{this.removeChild(r)}),r.open(),r}updateCurrentBreakpoint_(){if(!this.responsive())return;const e=this.currentBreakpoint(),t=this.currentWidth();for(let r=0;r<Tb.length;r++){const o=Tb[r],u=this.breakpoints_[o];if(t<=u){if(e===o)return;e&&this.removeClass(FE[e]),this.addClass(FE[o]),this.breakpoint_=o;break}}}removeCurrentBreakpoint_(){const e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)}breakpoints(e){return e===void 0?Object.assign(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=Object.assign({},zie,e),this.updateCurrentBreakpoint_(),Object.assign(this.breakpoints_))}responsive(e){if(e===void 0)return this.responsive_;e=Boolean(e);const t=this.responsive_;if(e!==t)return this.responsive_=e,e?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return FE[this.breakpoint_]||""}loadMedia(e,t){if(!e||typeof e!="object")return;this.reset(),this.cache_.media=Xr(e);const{artist:r,artwork:o,description:u,poster:h,src:f,textTracks:d,title:m}=this.cache_.media;!o&&h&&(this.cache_.media.artwork=[{src:h,type:U_(h)}]),f&&this.src(f),h&&this.poster(h),Array.isArray(d)&&d.forEach(g=>this.addRemoteTextTrack(g,!1)),this.titleBar&&this.titleBar.update({title:m,description:u||r||""}),this.ready(t)}getMedia(){if(!this.cache_.media){const e=this.poster(),t=this.currentSources(),r=Array.prototype.map.call(this.remoteTextTracks(),u=>({kind:u.kind,label:u.label,language:u.language,src:u.src})),o={src:t,textTracks:r};return e&&(o.poster=e,o.artwork=[{src:o.poster,type:U_(o.poster)}]),o}return Xr(this.cache_.media)}static getTagSettings(e){const t={sources:[],tracks:[]},r=vc(e),o=r["data-setup"];if(vm(e,"vjs-fill")&&(r.fill=!0),vm(e,"vjs-fluid")&&(r.fluid=!0),o!==null){const[u,h]=Pee(o||"{}");u&&Er.error(u),Object.assign(r,h)}if(Object.assign(t,r),e.hasChildNodes()){const u=e.childNodes;for(let h=0,f=u.length;h<f;h++){const d=u[h],m=d.nodeName.toLowerCase();m==="source"?t.sources.push(vc(d)):m==="track"&&t.tracks.push(vc(d))}}return t}debug(e){if(e===void 0)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(e){if(e===void 0)return this.cache_.playbackRates;Array.isArray(e)&&e.every(t=>typeof t=="number")&&(this.cache_.playbackRates=e,this.trigger("playbackrateschange"))}}Us.names.forEach(function(n){const e=Us[n];Jr.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}});Jr.prototype.crossorigin=Jr.prototype.crossOrigin;Jr.players={};const Gg=rt.navigator;Jr.prototype.options_={techOrder:ir.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:Gg&&(Gg.languages&&Gg.languages[0]||Gg.userLanguage||Gg.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1};["ended","seeking","seekable","networkState","readyState"].forEach(function(n){Jr.prototype[n]=function(){return this.techGet_(n)}});aG.forEach(function(n){Jr.prototype[`handleTech${Pi(n)}_`]=function(){return this.trigger(n)}});qt.registerComponent("Player",Jr);const j_="plugin",Uh="activePlugins_",Ah={},K_=n=>Ah.hasOwnProperty(n),kE=n=>K_(n)?Ah[n]:void 0,oG=(n,e)=>{n[Uh]=n[Uh]||{},n[Uh][e]=!0},G_=(n,e,t)=>{const r=(t?"before":"")+"pluginsetup";n.trigger(r,e),n.trigger(r+":"+e.name,e)},Yie=function(n,e){const t=function(){G_(this,{name:n,plugin:e,instance:null},!0);const r=e.apply(this,arguments);return oG(this,n),G_(this,{name:n,plugin:e,instance:r}),r};return Object.keys(e).forEach(function(r){t[r]=e[r]}),t},Y2=(n,e)=>(e.prototype.name=n,function(...t){G_(this,{name:n,plugin:e,instance:null},!0);const r=new e(this,...t);return this[n]=()=>r,G_(this,r.getEventHash()),r});class ga{constructor(e){if(this.constructor===ga)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),VP(this),delete this.trigger,IK(this,this.constructor.defaultState),oG(e,this.name),this.dispose=this.dispose.bind(this),e.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(e={}){return e.name=this.name,e.plugin=this.constructor,e.instance=this,e}trigger(e,t={}){return Ep(this.eventBusEl_,e,this.getEventHash(t))}handleStateChanged(e){}dispose(){const{name:e,player:t}=this;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t[Uh][e]=!1,this.player=this.state=null,t[e]=Y2(e,Ah[e])}static isBasic(e){const t=typeof e=="string"?kE(e):e;return typeof t=="function"&&!ga.prototype.isPrototypeOf(t.prototype)}static registerPlugin(e,t){if(typeof e!="string")throw new Error(`Illegal plugin name, "${e}", must be a string, was ${typeof e}.`);if(K_(e))Er.warn(`A plugin named "${e}" already exists. You may want to avoid re-registering plugins!`);else if(Jr.prototype.hasOwnProperty(e))throw new Error(`Illegal plugin name, "${e}", cannot share a name with an existing player method!`);if(typeof t!="function")throw new Error(`Illegal plugin for "${e}", must be a function, was ${typeof t}.`);return Ah[e]=t,e!==j_&&(ga.isBasic(t)?Jr.prototype[e]=Yie(e,t):Jr.prototype[e]=Y2(e,t)),t}static deregisterPlugin(e){if(e===j_)throw new Error("Cannot de-register base plugin.");K_(e)&&(delete Ah[e],delete Jr.prototype[e])}static getPlugins(e=Object.keys(Ah)){let t;return e.forEach(r=>{const o=kE(r);o&&(t=t||{},t[r]=o)}),t}static getPluginVersion(e){const t=kE(e);return t&&t.VERSION||""}}ga.getPlugin=kE;ga.BASE_PLUGIN_NAME=j_;ga.registerPlugin(j_,ga);Jr.prototype.usingPlugin=function(n){return!!this[Uh]&&this[Uh][n]===!0};Jr.prototype.hasPlugin=function(n){return!!K_(n)};function Xie(n,e){let t=!1;return function(...r){return t||Er.warn(n),t=!0,e.apply(this,r)}}function Qo(n,e,t,r){return Xie(`${e} is deprecated and will be removed in ${n}.0; please use ${t} instead.`,r)}const lG=n=>n.indexOf("#")===0?n.slice(1):n;function jt(n,e,t){let r=jt.getPlayer(n);if(r)return e&&Er.warn(`Player "${n}" is already initialised. Options will not be applied.`),t&&r.ready(t),r;const o=typeof n=="string"?kc("#"+lG(n)):n;if(!yp(o))throw new TypeError("The element or ID supplied is not valid. (videojs)");(!o.ownerDocument.defaultView||!o.ownerDocument.body.contains(o))&&Er.warn("The element supplied is not included in the DOM"),e=e||{},e.restoreEl===!0&&(e.restoreEl=(o.parentNode&&o.parentNode.hasAttribute("data-vjs-player")?o.parentNode:o).cloneNode(!0)),Fc("beforesetup").forEach(h=>{const f=h(o,Xr(e));if(!kl(f)||Array.isArray(f)){Er.error("please return an object in beforesetup hooks");return}e=Xr(e,f)});const u=qt.getComponent("Player");return r=new u(o,e,t),Fc("setup").forEach(h=>h(r)),r}jt.hooks_=Au;jt.hooks=Fc;jt.hook=Pre;jt.hookOnce=Lre;jt.removeHook=Z6;if(rt.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&vp()){let n=kc(".vjs-styles-defaults");if(!n){n=TK("vjs-styles-defaults");const e=kc("head");e&&e.insertBefore(n,e.firstChild),SK(n,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)}}pb(1,jt);jt.VERSION=J6;jt.options=Jr.prototype.options_;jt.getPlayers=()=>Jr.players;jt.getPlayer=n=>{const e=Jr.players;let t;if(typeof n=="string"){const r=lG(n),o=e[r];if(o)return o;t=kc("#"+r)}else t=n;if(yp(t)){const{player:r,playerId:o}=t;if(r||e[o])return r||e[o]}};jt.getAllPlayers=()=>Object.keys(Jr.players).map(n=>Jr.players[n]).filter(Boolean);jt.players=Jr.players;jt.getComponent=qt.getComponent;jt.registerComponent=(n,e)=>{ir.isTech(e)&&Er.warn(`The ${n} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),qt.registerComponent.call(qt,n,e)};jt.getTech=ir.getTech;jt.registerTech=ir.registerTech;jt.use=aie;Object.defineProperty(jt,"middleware",{value:{},writeable:!1,enumerable:!0});Object.defineProperty(jt.middleware,"TERMINATOR",{value:k_,writeable:!1,enumerable:!0});jt.browser=Nre;jt.obj=Ore;jt.mergeOptions=Qo(9,"videojs.mergeOptions","videojs.obj.merge",Xr);jt.defineLazyProperty=Qo(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",$T);jt.bind=Qo(9,"videojs.bind","native Function.prototype.bind",Qr);jt.registerPlugin=ga.registerPlugin;jt.deregisterPlugin=ga.deregisterPlugin;jt.plugin=(n,e)=>(Er.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),ga.registerPlugin(n,e));jt.getPlugins=ga.getPlugins;jt.getPlugin=ga.getPlugin;jt.getPluginVersion=ga.getPluginVersion;jt.addLanguage=function(n,e){return n=(""+n).toLowerCase(),jt.options.languages=Xr(jt.options.languages,{[n]:e}),jt.options.languages[n]};jt.log=Er;jt.createLogger=tK;jt.time=Xre;jt.createTimeRange=Qo(9,"videojs.createTimeRange","videojs.time.createTimeRanges",Ll);jt.createTimeRanges=Qo(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",Ll);jt.formatTime=Qo(9,"videojs.formatTime","videojs.time.formatTime",ed);jt.setFormatTime=Qo(9,"videojs.setFormatTime","videojs.time.setFormatTime",DK);jt.resetFormatTime=Qo(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",PK);jt.parseUrl=Qo(9,"videojs.parseUrl","videojs.url.parseUrl",YP);jt.isCrossOrigin=Qo(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",iS);jt.EventTarget=go;jt.any=HP;jt.on=Ha;jt.one=nS;jt.off=Cs;jt.trigger=Ep;jt.xhr=Qm;jt.TextTrack=S0;jt.AudioTrack=OK;jt.VideoTrack=NK;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(n=>{jt[n]=function(){return Er.warn(`videojs.${n}() is deprecated; use videojs.dom.${n}() instead`),EK[n].apply(null,arguments)}});jt.computedStyle=Qo(9,"videojs.computedStyle","videojs.dom.computedStyle",sp);jt.dom=EK;jt.fn=Wre;jt.num=Cie;jt.str=zre;jt.url=iie;/*! @name videojs-contrib-quality-levels @version 3.0.0 @license Apache-2.0 */class qie{constructor(e){let t=this;return t.id=e.id,t.label=t.id,t.width=e.width,t.height=e.height,t.bitrate=e.bandwidth,t.frameRate=e.frameRate,t.enabled_=e.enabled,Object.defineProperty(t,"enabled",{get(){return t.enabled_()},set(r){t.enabled_(r)}}),t}}class W_ extends jt.EventTarget{constructor(){super();let e=this;return e.levels_=[],e.selectedIndex_=-1,Object.defineProperty(e,"selectedIndex",{get(){return e.selectedIndex_}}),Object.defineProperty(e,"length",{get(){return e.levels_.length}}),e}addQualityLevel(e){let t=this.getQualityLevelById(e.id);if(t)return t;const r=this.levels_.length;return t=new qie(e),""+r in this||Object.defineProperty(this,r,{get(){return this.levels_[r]}}),this.levels_.push(t),this.trigger({qualityLevel:t,type:"addqualitylevel"}),t}removeQualityLevel(e){let t=null;for(let r=0,o=this.length;r<o;r++)if(this[r]===e){t=this.levels_.splice(r,1)[0],this.selectedIndex_===r?this.selectedIndex_=-1:this.selectedIndex_>r&&this.selectedIndex_--;break}return t&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),t}getQualityLevelById(e){for(let t=0,r=this.length;t<r;t++){const o=this[t];if(o.id===e)return o}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}W_.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const n in W_.prototype.allowedEvents_)W_.prototype["on"+n]=null;var uG="3.0.0";const Qie=jt.registerPlugin||jt.plugin,Jie=function(n,e){const t=n.qualityLevels,r=new W_,o=function(){r.dispose(),n.qualityLevels=t,n.off("dispose",o)};return n.on("dispose",o),n.qualityLevels=()=>r,n.qualityLevels.VERSION=uG,r},cG=function(n){return Jie(this,jt.mergeOptions({},n))};Qie("qualityLevels",cG);cG.VERSION=uG;/*! @name @videojs/http-streaming @version 3.0.2 @license Apache-2.0 */const Ko=Tte,H_=(n,e)=>e&&e.responseURL&&n!==e.responseURL?e.responseURL:n,Jo=n=>jt.log.debug?jt.log.debug.bind(jt,"VHS:",`${n} >`):function(){};function Zr(...n){const e=jt.obj||jt;return(e.merge||e.mergeOptions).apply(e,n)}function xs(...n){const e=jt.time||jt;return(e.createTimeRanges||e.createTimeRanges).apply(e,n)}const Uc=1/30,xl=Uc*3,fG=function(n,e){const t=[];let r;if(n&&n.length)for(r=0;r<n.length;r++)e(n.start(r),n.end(r))&&t.push([n.start(r),n.end(r)]);return xs(t)},xh=function(n,e){return fG(n,function(t,r){return t-xl<=e&&r+xl>=e})},aE=function(n,e){return fG(n,function(t){return t-Uc>=e})},Zie=function(n){if(n.length<2)return xs();const e=[];for(let t=1;t<n.length;t++){const r=n.end(t-1),o=n.start(t);e.push([r,o])}return xs(e)},ese=function(n,e){let t=null,r=null,o=0;const u=[],h=[];if(!n||!n.length||!e||!e.length)return xs();let f=n.length;for(;f--;)u.push({time:n.start(f),type:"start"}),u.push({time:n.end(f),type:"end"});for(f=e.length;f--;)u.push({time:e.start(f),type:"start"}),u.push({time:e.end(f),type:"end"});for(u.sort(function(d,m){return d.time-m.time}),f=0;f<u.length;f++)u[f].type==="start"?(o++,o===2&&(t=u[f].time)):u[f].type==="end"&&(o--,o===1&&(r=u[f].time)),t!==null&&r!==null&&(h.push([t,r]),t=null,r=null);return xs(h)},dG=n=>{const e=[];if(!n||!n.length)return"";for(let t=0;t<n.length;t++)e.push(n.start(t)+" => "+n.end(t));return e.join(", ")},tse=function(n,e,t=1){return((n.length?n.end(n.length-1):0)-e)/t},kf=n=>{const e=[];for(let t=0;t<n.length;t++)e.push({start:n.start(t),end:n.end(t)});return e},nse=function(n,e){if(n===e)return!1;if(!n&&e||!e&&n||n.length!==e.length)return!0;for(let t=0;t<n.length;t++)if(n.start(t)!==e.start(t)||n.end(t)!==e.end(t))return!0;return!1},X2=function(n){if(!(!n||!n.length||!n.end))return n.end(n.length-1)},d1=function(n,e){let t=0;if(!n||!n.length)return t;for(let r=0;r<n.length;r++){const o=n.start(r),u=n.end(r);if(!(e>u)){if(e>o&&e<=u){t+=u-e;continue}t+=u-o}}return t},h1=(n,e)=>{if(!e.preload)return e.duration;let t=0;return(e.parts||[]).forEach(function(r){t+=r.duration}),(e.preloadHints||[]).forEach(function(r){r.type==="PART"&&(t+=n.partTargetDuration)}),t},Sb=n=>(n.segments||[]).reduce((e,t,r)=>(t.parts?t.parts.forEach(function(o,u){e.push({duration:o.duration,segmentIndex:r,partIndex:u,part:o,segment:t})}):e.push({duration:t.duration,segmentIndex:r,partIndex:null,segment:t,part:null}),e),[]),hG=n=>{const e=n.segments&&n.segments.length&&n.segments[n.segments.length-1];return e&&e.parts||[]},pG=({preloadSegment:n})=>{if(!n)return;const{parts:e,preloadHints:t}=n;let r=(t||[]).reduce((o,u)=>o+(u.type==="PART"?1:0),0);return r+=e&&e.length?e.length:0,r},gG=(n,e)=>{if(e.endList)return 0;if(n&&n.suggestedPresentationDelay)return n.suggestedPresentationDelay;const t=hG(e).length>0;return t&&e.serverControl&&e.serverControl.partHoldBack?e.serverControl.partHoldBack:t&&e.partTargetDuration?e.partTargetDuration*3:e.serverControl&&e.serverControl.holdBack?e.serverControl.holdBack:e.targetDuration?e.targetDuration*3:0},rse=function(n,e){let t=0,r=e-n.mediaSequence,o=n.segments[r];if(o){if(typeof o.start<"u")return{result:o.start,precise:!0};if(typeof o.end<"u")return{result:o.end-o.duration,precise:!0}}for(;r--;){if(o=n.segments[r],typeof o.end<"u")return{result:t+o.end,precise:!0};if(t+=h1(n,o),typeof o.start<"u")return{result:t+o.start,precise:!0}}return{result:t,precise:!1}},ise=function(n,e){let t=0,r,o=e-n.mediaSequence;for(;o<n.segments.length;o++){if(r=n.segments[o],typeof r.start<"u")return{result:r.start-t,precise:!0};if(t+=h1(n,r),typeof r.end<"u")return{result:r.end-t,precise:!0}}return{result:-1,precise:!1}},mG=function(n,e,t){if(typeof e>"u"&&(e=n.mediaSequence+n.segments.length),e<n.mediaSequence)return 0;const r=rse(n,e);if(r.precise)return r.result;const o=ise(n,e);return o.precise?o.result:r.result+t},vG=function(n,e,t){if(!n)return 0;if(typeof t!="number"&&(t=0),typeof e>"u"){if(n.totalDuration)return n.totalDuration;if(!n.endList)return rt.Infinity}return mG(n,e,t)},_m=function({defaultDuration:n,durationList:e,startIndex:t,endIndex:r}){let o=0;if(t>r&&([t,r]=[r,t]),t<0){for(let u=t;u<Math.min(0,r);u++)o+=n;t=0}for(let u=t;u<r;u++)o+=e[u].duration;return o},yG=function(n,e,t,r){if(!n||!n.segments)return null;if(n.endList)return vG(n);if(e===null)return null;e=e||0;let o=mG(n,n.mediaSequence+n.segments.length,e);return t&&(r=typeof r=="number"?r:gG(null,n),o-=r),Math.max(0,o)},sse=function(n,e,t){const o=e||0,u=yG(n,e,!0,t);return u===null?xs():xs(o,u)},ase=function({playlist:n,currentTime:e,startingSegmentIndex:t,startingPartIndex:r,startTime:o,exactManifestTimings:u}){let h=e-o;const f=Sb(n);let d=0;for(let m=0;m<f.length;m++){const g=f[m];if(t===g.segmentIndex&&!(typeof r=="number"&&typeof g.partIndex=="number"&&r!==g.partIndex)){d=m;break}}if(h<0){if(d>0)for(let m=d-1;m>=0;m--){const g=f[m];if(h+=g.duration,u){if(h<0)continue}else if(h+Uc<=0)continue;return{partIndex:g.partIndex,segmentIndex:g.segmentIndex,startTime:o-_m({defaultDuration:n.targetDuration,durationList:f,startIndex:d,endIndex:m})}}return{partIndex:f[0]&&f[0].partIndex||null,segmentIndex:f[0]&&f[0].segmentIndex||0,startTime:e}}if(d<0){for(let m=d;m<0;m++)if(h-=n.targetDuration,h<0)return{partIndex:f[0]&&f[0].partIndex||null,segmentIndex:f[0]&&f[0].segmentIndex||0,startTime:e};d=0}for(let m=d;m<f.length;m++){const g=f[m];if(h-=g.duration,u){if(h>0)continue}else if(h-Uc>=0)continue;return{partIndex:g.partIndex,segmentIndex:g.segmentIndex,startTime:o+_m({defaultDuration:n.targetDuration,durationList:f,startIndex:d,endIndex:m})}}return{segmentIndex:f[f.length-1].segmentIndex,partIndex:f[f.length-1].partIndex,startTime:e}},EG=function(n){return n.excludeUntil&&n.excludeUntil>Date.now()},p1=function(n){return n.excludeUntil&&n.excludeUntil===1/0},oS=function(n){const e=EG(n);return!n.disabled&&!e},ose=function(n){return n.disabled},lse=function(n){for(let e=0;e<n.segments.length;e++)if(n.segments[e].key)return!0;return!1},_G=function(n,e){return e.attributes&&e.attributes[n]},use=function(n,e,t,r=0){return _G("BANDWIDTH",t)?(n*t.attributes.BANDWIDTH-r*8)/e:NaN},Ab=(n,e)=>{if(n.playlists.length===1)return!0;const t=e.attributes.BANDWIDTH||Number.MAX_VALUE;return n.playlists.filter(r=>oS(r)?(r.attributes.BANDWIDTH||0)<t:!1).length===0},g1=(n,e)=>!n&&!e||!n&&e||n&&!e?!1:!!(n===e||n.id&&e.id&&n.id===e.id||n.resolvedUri&&e.resolvedUri&&n.resolvedUri===e.resolvedUri||n.uri&&e.uri&&n.uri===e.uri),q2=function(n,e){const t=n&&n.mediaGroups&&n.mediaGroups.AUDIO||{};let r=!1;for(const o in t){for(const u in t[o])if(r=e(t[o][u]),r)break;if(r)break}return!!r},I0=n=>{if(!n||!n.playlists||!n.playlists.length)return q2(n,t=>t.playlists&&t.playlists.length||t.uri);for(let e=0;e<n.playlists.length;e++){const t=n.playlists[e],r=t.attributes&&t.attributes.CODECS;if(!(r&&r.split(",").every(u=>l6(u))||q2(n,u=>g1(t,u))))return!1}return!0};var ca={liveEdgeDelay:gG,duration:vG,seekable:sse,getMediaInfoForTime:ase,isEnabled:oS,isDisabled:ose,isExcluded:EG,isIncompatible:p1,playlistEnd:yG,isAes:lse,hasAttribute:_G,estimateSegmentRequestTime:use,isLowestEnabledRendition:Ab,isAudioOnly:I0,playlistMatch:g1,segmentDurationWithParts:h1};const{log:TG}=jt,m1=(n,e)=>`${n}-${e}`,cse=(n,e,t)=>`placeholder-uri-${n}-${e}-${t}`,fse=({onwarn:n,oninfo:e,manifestString:t,customTagParsers:r=[],customTagMappers:o=[],llhls:u})=>{const h=new Dte;n&&h.on("warn",n),e&&h.on("info",e),r.forEach(m=>h.addParser(m)),o.forEach(m=>h.addTagMapper(m)),h.push(t),h.end();const f=h.manifest;if(u||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(m){f.hasOwnProperty(m)&&delete f[m]}),f.segments&&f.segments.forEach(function(m){["parts","preloadHints"].forEach(function(g){m.hasOwnProperty(g)&&delete m[g]})})),!f.targetDuration){let m=10;f.segments&&f.segments.length&&(m=f.segments.reduce((g,v)=>Math.max(g,v.duration),0)),n&&n(`manifest has no targetDuration defaulting to ${m}`),f.targetDuration=m}const d=hG(f);if(d.length&&!f.partTargetDuration){const m=d.reduce((g,v)=>Math.max(g,v.duration),0);n&&(n(`manifest has no partTargetDuration defaulting to ${m}`),TG.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),f.partTargetDuration=m}return f},Ap=(n,e)=>{n.mediaGroups&&["AUDIO","SUBTITLES"].forEach(t=>{if(n.mediaGroups[t])for(const r in n.mediaGroups[t])for(const o in n.mediaGroups[t][r]){const u=n.mediaGroups[t][r][o];e(u,t,r,o)}})},SG=({playlist:n,uri:e,id:t})=>{n.id=t,n.playlistErrors_=0,e&&(n.uri=e),n.attributes=n.attributes||{}},dse=n=>{let e=n.playlists.length;for(;e--;){const t=n.playlists[e];SG({playlist:t,id:m1(e,t.uri)}),t.resolvedUri=Ko(n.uri,t.uri),n.playlists[t.id]=t,n.playlists[t.uri]=t,t.attributes.BANDWIDTH||TG.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}},hse=n=>{Ap(n,e=>{e.uri&&(e.resolvedUri=Ko(n.uri,e.uri))})},pse=(n,e)=>{const t=m1(0,e),r={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:rt.location.href,resolvedUri:rt.location.href,playlists:[{uri:e,id:t,resolvedUri:e,attributes:{}}]};return r.playlists[t]=r.playlists[0],r.playlists[e]=r.playlists[0],r},AG=(n,e,t=cse)=>{n.uri=e;for(let o=0;o<n.playlists.length;o++)if(!n.playlists[o].uri){const u=`placeholder-uri-${o}`;n.playlists[o].uri=u}const r=I0(n);Ap(n,(o,u,h,f)=>{if(!o.playlists||!o.playlists.length){if(r&&u==="AUDIO"&&!o.uri)for(let d=0;d<n.playlists.length;d++){const m=n.playlists[d];if(m.attributes&&m.attributes.AUDIO&&m.attributes.AUDIO===h)return}o.playlists=[qo({},o)]}o.playlists.forEach(function(d,m){const g=t(u,h,f,d),v=m1(m,g);d.uri?d.resolvedUri=d.resolvedUri||Ko(n.uri,d.uri):(d.uri=m===0?g:v,d.resolvedUri=d.uri),d.id=d.id||v,d.attributes=d.attributes||{},n.playlists[d.id]=d,n.playlists[d.uri]=d})}),dse(n),hse(n)},{EventTarget:gse}=jt,mse=(n,e)=>{if(e.endList||!e.serverControl)return n;const t={};if(e.serverControl.canBlockReload){const{preloadSegment:r}=e;let o=e.mediaSequence+e.segments.length;if(r){const u=r.parts||[],h=pG(e)-1;h>-1&&h!==u.length-1&&(t._HLS_part=h),(h>-1||u.length)&&o--}t._HLS_msn=o}if(e.serverControl&&e.serverControl.canSkipUntil&&(t._HLS_skip=e.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(t).length){const r=new rt.URL(n);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(o){t.hasOwnProperty(o)&&r.searchParams.set(o,t[o])}),n=r.toString()}return n},vse=(n,e)=>{if(!n)return e;const t=Zr(n,e);if(n.preloadHints&&!e.preloadHints&&delete t.preloadHints,n.parts&&!e.parts)delete t.parts;else if(n.parts&&e.parts)for(let r=0;r<e.parts.length;r++)n.parts&&n.parts[r]&&(t.parts[r]=Zr(n.parts[r],e.parts[r]));return!n.skipped&&e.skipped&&(t.skipped=!1),n.preload&&!e.preload&&(t.preload=!1),t},yse=(n,e,t)=>{const r=n.slice(),o=e.slice();t=t||0;const u=[];let h;for(let f=0;f<o.length;f++){const d=r[f+t],m=o[f];d?(h=d.map||h,u.push(vse(d,m))):(h&&!m.map&&(m.map=h),u.push(m))}return u},xG=(n,e)=>{!n.resolvedUri&&n.uri&&(n.resolvedUri=Ko(e,n.uri)),n.key&&!n.key.resolvedUri&&(n.key.resolvedUri=Ko(e,n.key.uri)),n.map&&!n.map.resolvedUri&&(n.map.resolvedUri=Ko(e,n.map.uri)),n.map&&n.map.key&&!n.map.key.resolvedUri&&(n.map.key.resolvedUri=Ko(e,n.map.key.uri)),n.parts&&n.parts.length&&n.parts.forEach(t=>{t.resolvedUri||(t.resolvedUri=Ko(e,t.uri))}),n.preloadHints&&n.preloadHints.length&&n.preloadHints.forEach(t=>{t.resolvedUri||(t.resolvedUri=Ko(e,t.uri))})},CG=function(n){const e=n.segments||[],t=n.preloadSegment;if(t&&t.parts&&t.parts.length){if(t.preloadHints){for(let r=0;r<t.preloadHints.length;r++)if(t.preloadHints[r].type==="MAP")return e}t.duration=n.targetDuration,t.preload=!0,e.push(t)}return e},IG=(n,e)=>n===e||n.segments&&e.segments&&n.segments.length===e.segments.length&&n.endList===e.endList&&n.mediaSequence===e.mediaSequence&&n.preloadSegment===e.preloadSegment,xb=(n,e,t=IG)=>{const r=Zr(n,{}),o=r.playlists[e.id];if(!o||t(o,e))return null;e.segments=CG(e);const u=Zr(o,e);if(u.preloadSegment&&!e.preloadSegment&&delete u.preloadSegment,o.segments){if(e.skip){e.segments=e.segments||[];for(let h=0;h<e.skip.skippedSegments;h++)e.segments.unshift({skipped:!0})}u.segments=yse(o.segments,e.segments,e.mediaSequence-o.mediaSequence)}u.segments.forEach(h=>{xG(h,u.resolvedUri)});for(let h=0;h<r.playlists.length;h++)r.playlists[h].id===e.id&&(r.playlists[h]=u);return r.playlists[e.id]=u,r.playlists[e.uri]=u,Ap(n,(h,f,d,m)=>{if(h.playlists)for(let g=0;g<h.playlists.length;g++)e.id===h.playlists[g].id&&(h.playlists[g]=u)}),r},Cb=(n,e)=>{const t=n.segments||[],r=t[t.length-1],o=r&&r.parts&&r.parts[r.parts.length-1],u=o&&o.duration||r&&r.duration;return e&&u?u*1e3:(n.partTargetDuration||n.targetDuration||10)*500};let Ch=class extends gse{constructor(e,t,r={}){if(super(),!e)throw new Error("A non-empty playlist URL or object is required");this.logger_=Jo("PlaylistLoader");const{withCredentials:o=!1}=r;this.src=e,this.vhs_=t,this.withCredentials=o;const u=t.options_;this.customTagParsers=u&&u.customTagParsers||[],this.customTagMappers=u&&u.customTagMappers||[],this.llhls=u&&u.llhls,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_)}handleMediaupdatetimeout_(){if(this.state!=="HAVE_METADATA")return;const e=this.media();let t=Ko(this.main.uri,e.uri);this.llhls&&(t=mse(t,e)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:t,withCredentials:this.withCredentials},(r,o)=>{if(this.request){if(r)return this.playlistRequestError(this.request,this.media(),"HAVE_METADATA");this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})}})}playlistRequestError(e,t,r){const{uri:o,id:u}=t;this.request=null,r&&(this.state=r),this.error={playlist:this.main.playlists[u],status:e.status,message:`HLS playlist request error at URL: ${o}.`,responseText:e.responseText,code:e.status>=500?4:2},this.trigger("error")}parseManifest_({url:e,manifestString:t}){return fse({onwarn:({message:r})=>this.logger_(`m3u8-parser warn for ${e}: ${r}`),oninfo:({message:r})=>this.logger_(`m3u8-parser info for ${e}: ${r}`),manifestString:t,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls})}haveMetadata({playlistString:e,playlistObject:t,url:r,id:o}){this.request=null,this.state="HAVE_METADATA";const u=t||this.parseManifest_({url:r,manifestString:e});u.lastRequest=Date.now(),SG({playlist:u,uri:r,id:o});const h=xb(this.main,u);this.targetDuration=u.partTargetDuration||u.targetDuration,this.pendingMedia_=null,h?(this.main=h,this.media_=this.main.playlists[o]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(Cb(this.media(),!!h)),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),rt.clearTimeout(this.mediaUpdateTimeout),rt.clearTimeout(this.finalRenditionTimeout),this.off()}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e,t){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof e=="string"){if(!this.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.main.playlists[e]}if(rt.clearTimeout(this.finalRenditionTimeout),t){const h=(e.partTargetDuration||e.targetDuration)/2*1e3||5e3;this.finalRenditionTimeout=rt.setTimeout(this.media.bind(this,e,!1),h);return}const r=this.state,o=!this.media_||e.id!==this.media_.id,u=this.main.playlists[e.id];if(u&&u.endList||e.endList&&e.segments.length){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,o&&(this.trigger("mediachanging"),r==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange"));return}if(this.updateMediaUpdateTimeout_(Cb(e,!0)),!!o){if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=e,this.request=this.vhs_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials},(h,f)=>{if(this.request){if(e.lastRequest=Date.now(),e.resolvedUri=H_(e.resolvedUri,f),h)return this.playlistRequestError(this.request,e,r);this.haveMetadata({playlistString:f.responseText,url:e.uri,id:e.id}),r==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}})}}pause(){this.mediaUpdateTimeout&&(rt.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}load(e){this.mediaUpdateTimeout&&(rt.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);const t=this.media();if(e){const r=t?(t.partTargetDuration||t.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=rt.setTimeout(()=>{this.mediaUpdateTimeout=null,this.load()},r);return}if(!this.started){this.start();return}t&&!t.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")}updateMediaUpdateTimeout_(e){this.mediaUpdateTimeout&&(rt.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),!(!this.media()||this.media().endList)&&(this.mediaUpdateTimeout=rt.setTimeout(()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(e)},e))}start(){if(this.started=!0,typeof this.src=="object"){this.src.uri||(this.src.uri=rt.location.href),this.src.resolvedUri=this.src.uri,setTimeout(()=>{this.setupInitialPlaylist(this.src)},0);return}this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},(e,t)=>{if(!this.request)return;if(this.request=null,e)return this.error={status:t.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:t.responseText,code:2},this.state==="HAVE_NOTHING"&&(this.started=!1),this.trigger("error");this.src=H_(this.src,t);const r=this.parseManifest_({manifestString:t.responseText,url:this.src});this.setupInitialPlaylist(r)})}srcUri(){return typeof this.src=="string"?this.src:this.src.uri}setupInitialPlaylist(e){if(this.state="HAVE_MAIN_MANIFEST",e.playlists){this.main=e,AG(this.main,this.srcUri()),e.playlists.forEach(r=>{r.segments=CG(r),r.segments.forEach(o=>{xG(o,r.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0]);return}const t=this.srcUri()||rt.location.href;this.main=pse(e,t),this.haveMetadata({playlistObject:e,url:t,id:this.main.playlists[0].id}),this.trigger("loadedmetadata")}};const{xhr:Ese}=jt,Ib=function(n,e,t,r){const o=n.responseType==="arraybuffer"?n.response:n.responseText;!e&&o&&(n.responseTime=Date.now(),n.roundTripTime=n.responseTime-n.requestTime,n.bytesReceived=o.byteLength||o.length,n.bandwidth||(n.bandwidth=Math.floor(n.bytesReceived/n.roundTripTime*8*1e3))),t.headers&&(n.responseHeaders=t.headers),e&&e.code==="ETIMEDOUT"&&(n.timedout=!0),!e&&!n.aborted&&t.statusCode!==200&&t.statusCode!==206&&t.statusCode!==0&&(e=new Error("XHR Failed with a response of: "+(n&&(o||n.responseText)))),r(e,n)},RG=function(){const n=function e(t,r){t=Zr({timeout:45e3},t);const o=e.beforeRequest||jt.Vhs.xhr.beforeRequest;if(o&&typeof o=="function"){const d=o(t);d&&(t=d)}const h=(jt.Vhs.xhr.original===!0?Ese:jt.Vhs.xhr)(t,function(d,m){return Ib(h,d,m,r)}),f=h.abort;return h.abort=function(){return h.aborted=!0,f.apply(h,arguments)},h.uri=t.uri,h.requestTime=Date.now(),h};return n.original=!0,n},_se=function(n){let e;const t=n.offset;return typeof n.offset=="bigint"||typeof n.length=="bigint"?e=rt.BigInt(n.offset)+rt.BigInt(n.length)-rt.BigInt(1):e=n.offset+n.length-1,"bytes="+t+"-"+e},Rb=function(n){const e={};return n.byterange&&(e.Range=_se(n.byterange)),e},Tse=function(n,e){return n.start(e)+"-"+n.end(e)},Sse=function(n,e){const t=n.toString(16);return"00".substring(0,2-t.length)+t+(e%2?" ":"")},Ase=function(n){return n>=32&&n<126?String.fromCharCode(n):"."},bG=function(n){const e={};return Object.keys(n).forEach(t=>{const r=n[t];c6(r)?e[t]={bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}:e[t]=r}),e},V_=function(n){const e=n.byterange||{length:1/0,offset:0};return[e.length,e.offset,n.resolvedUri].join(",")},DG=function(n){return n.resolvedUri},PG=n=>{const e=Array.prototype.slice.call(n),t=16;let r="",o,u;for(let h=0;h<e.length/t;h++)o=e.slice(h*t,h*t+t).map(Sse).join(""),u=e.slice(h*t,h*t+t).map(Ase).join(""),r+=o+" "+u+`
`;return r},xse=({bytes:n})=>PG(n),Cse=n=>{let e="",t;for(t=0;t<n.length;t++)e+=Tse(n,t)+" ";return e};var Ise=Object.freeze({__proto__:null,createTransferableMessage:bG,initSegmentId:V_,segmentKeyId:DG,hexDump:PG,tagDump:xse,textRanges:Cse});const LG=.25,Rse=(n,e)=>{if(!e.dateTimeObject)return null;const t=e.videoTimingInfo.transmuxerPrependedSeconds,o=e.videoTimingInfo.transmuxedPresentationStart+t,u=n-o;return new Date(e.dateTimeObject.getTime()+u*1e3)},bse=n=>n.transmuxedPresentationEnd-n.transmuxedPresentationStart-n.transmuxerPrependedSeconds,Dse=(n,e)=>{let t;try{t=new Date(n)}catch{return null}if(!e||!e.segments||e.segments.length===0)return null;let r=e.segments[0];if(t<r.dateTimeObject)return null;for(let d=0;d<e.segments.length-1;d++){r=e.segments[d];const m=e.segments[d+1].dateTimeObject;if(t<m)break}const o=e.segments[e.segments.length-1],u=o.dateTimeObject,h=o.videoTimingInfo?bse(o.videoTimingInfo):o.duration+o.duration*LG,f=new Date(u.getTime()+h*1e3);return t>f?null:(t>u&&(r=o),{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:ca.duration(e,e.mediaSequence+e.segments.indexOf(r)),type:r.videoTimingInfo?"accurate":"estimate"})},Pse=(n,e)=>{if(!e||!e.segments||e.segments.length===0)return null;let t=0,r;for(let u=0;u<e.segments.length&&(r=e.segments[u],t=r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationEnd:t+r.duration,!(n<=t));u++);const o=e.segments[e.segments.length-1];if(o.videoTimingInfo&&o.videoTimingInfo.transmuxedPresentationEnd<n)return null;if(n>t){if(n>t+o.duration*LG)return null;r=o}return{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:t-r.duration,type:r.videoTimingInfo?"accurate":"estimate"}},Lse=(n,e)=>{let t,r;try{t=new Date(n),r=new Date(e)}catch{}const o=t.getTime();return(r.getTime()-o)/1e3},Mse=n=>{if(!n.segments||n.segments.length===0)return!1;for(let e=0;e<n.segments.length;e++)if(!n.segments[e].dateTimeObject)return!1;return!0},wse=({playlist:n,time:e=void 0,callback:t})=>{if(!t)throw new Error("getProgramTime: callback must be provided");if(!n||e===void 0)return t({message:"getProgramTime: playlist and time must be provided"});const r=Pse(e,n);if(!r)return t({message:"valid programTime was not found"});if(r.type==="estimate")return t({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:r.estimatedStart});const o={mediaSeconds:e},u=Rse(e,r.segment);return u&&(o.programDateTime=u.toISOString()),t(null,o)},MG=({programTime:n,playlist:e,retryCount:t=2,seekTo:r,pauseAfterSeek:o=!0,tech:u,callback:h})=>{if(!h)throw new Error("seekToProgramTime: callback must be provided");if(typeof n>"u"||!e||!r)return h({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!e.endList&&!u.hasStarted_)return h({message:"player must be playing a live stream to start buffering"});if(!Mse(e))return h({message:"programDateTime tags must be provided in the manifest "+e.resolvedUri});const f=Dse(n,e);if(!f)return h({message:`${n} was not found in the stream`});const d=f.segment,m=Lse(d.dateTimeObject,n);if(f.type==="estimate"){if(t===0)return h({message:`${n} is not buffered yet. Try again`});r(f.estimatedStart+m),u.one("seeked",()=>{MG({programTime:n,playlist:e,retryCount:t-1,seekTo:r,pauseAfterSeek:o,tech:u,callback:h})});return}const g=d.start+m,v=()=>h(null,u.currentTime());u.one("seeked",v),o&&u.pause(),r(g)},EI=(n,e)=>{if(n.readyState===4)return e()},Ose=(n,e,t)=>{let r=[],o,u=!1;const h=function(g,v,_,S){return v.abort(),u=!0,t(g,v,_,S)},f=function(g,v){if(u)return;if(g)return h(g,v,"",r);const _=v.responseText.substring(r&&r.byteLength||0,v.responseText.length);if(r=Kte(r,f6(_,!0)),o=o||nm(r),r.length<10||o&&r.length<o+2)return EI(v,()=>h(g,v,"",r));const S=NP(r);return S==="ts"&&r.length<188?EI(v,()=>h(g,v,"",r)):!S&&r.length<376?EI(v,()=>h(g,v,"",r)):h(null,v,S,r)},m=e({uri:n,beforeSend(g){g.overrideMimeType("text/plain; charset=x-user-defined"),g.addEventListener("progress",function({total:v,loaded:_}){return Ib(g,null,{statusCode:g.status},f)})}},function(g,v){return Ib(m,g,v,f)});return m},{EventTarget:Nse}=jt,Q2=function(n,e){if(!IG(n,e)||n.sidx&&e.sidx&&(n.sidx.offset!==e.sidx.offset||n.sidx.length!==e.sidx.length))return!1;if(!n.sidx&&e.sidx||n.sidx&&!e.sidx||n.segments&&!e.segments||!n.segments&&e.segments)return!1;if(!n.segments&&!e.segments)return!0;for(let t=0;t<n.segments.length;t++){const r=n.segments[t],o=e.segments[t];if(r.uri!==o.uri)return!1;if(!r.byterange&&!o.byterange)continue;const u=r.byterange,h=o.byterange;if(u&&!h||!u&&h||u.offset!==h.offset||u.length!==h.length)return!1}return!0},Fse=(n,e,t,r)=>{const o=r.attributes.NAME||t;return`placeholder-uri-${n}-${e}-${o}`},kse=({mainXml:n,srcUrl:e,clientOffset:t,sidxMapping:r,previousManifest:o})=>{const u=ure(n,{manifestUri:e,clientOffset:t,sidxMapping:r,previousManifest:o});return AG(u,e,Fse),u},Use=(n,e)=>{Ap(n,(t,r,o,u)=>{u in e.mediaGroups[r][o]||delete n.mediaGroups[r][o][u]})},Bse=(n,e,t)=>{let r=!0,o=Zr(n,{duration:e.duration,minimumUpdatePeriod:e.minimumUpdatePeriod,timelineStarts:e.timelineStarts});for(let u=0;u<e.playlists.length;u++){const h=e.playlists[u];if(h.sidx){const d=GT(h.sidx);t&&t[d]&&t[d].sidx&&MP(h,t[d].sidx,h.sidx.resolvedUri)}const f=xb(o,h,Q2);f&&(o=f,r=!1)}return Ap(e,(u,h,f,d)=>{if(u.playlists&&u.playlists.length){const m=u.playlists[0].id,g=xb(o,u.playlists[0],Q2);g&&(o=g,d in o.mediaGroups[h][f]||(o.mediaGroups[h][f][d]=u),o.mediaGroups[h][f][d].playlists[0]=o.playlists[m],r=!1)}}),Use(o,e),e.minimumUpdatePeriod!==n.minimumUpdatePeriod&&(r=!1),r?null:o},jse=(n,e)=>(Boolean(!n.map&&!e.map)||Boolean(n.map&&e.map&&n.map.byterange.offset===e.map.byterange.offset&&n.map.byterange.length===e.map.byterange.length))&&n.uri===e.uri&&n.byterange.offset===e.byterange.offset&&n.byterange.length===e.byterange.length,J2=(n,e)=>{const t={};for(const r in n){const u=n[r].sidx;if(u){const h=GT(u);if(!e[h])break;const f=e[h].sidxInfo;jse(f,u)&&(t[h]=e[h])}}return t},Kse=(n,e)=>{let r=J2(n.playlists,e);return Ap(n,(o,u,h,f)=>{if(o.playlists&&o.playlists.length){const d=o.playlists;r=Zr(r,J2(d,e))}}),r};class bb extends Nse{constructor(e,t,r={},o){super(),this.mainPlaylistLoader_=o||this,o||(this.isMain_=!0);const{withCredentials:u=!1}=r;if(this.vhs_=t,this.withCredentials=u,!e)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",()=>{this.refreshXml_()}),this.on("mediaupdatetimeout",()=>{this.refreshMedia_(this.media().id)}),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=Jo("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=e,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=e}requestErrored_(e,t,r){if(!this.request)return!0;if(this.request=null,e)return this.error=typeof e=="object"&&!(e instanceof Error)?e:{status:t.status,message:"DASH request error at URL: "+t.uri,response:t.response,code:2},r&&(this.state=r),this.trigger("error"),!0}addSidxSegments_(e,t,r){const o=e.sidx&&GT(e.sidx);if(!e.sidx||!o||this.mainPlaylistLoader_.sidxMapping_[o]){this.mediaRequest_=rt.setTimeout(()=>r(!1),0);return}const u=H_(e.sidx.resolvedUri),h=(f,d)=>{if(this.requestErrored_(f,d,t))return;const m=this.mainPlaylistLoader_.sidxMapping_;let g;try{g=pre(Gn(d.response).subarray(8))}catch(v){this.requestErrored_(v,d,t);return}return m[o]={sidxInfo:e.sidx,sidx:g},MP(e,g,e.sidx.resolvedUri),r(!0)};this.request=Ose(u,this.vhs_.xhr,(f,d,m,g)=>{if(f)return h(f,d);if(!m||m!=="mp4")return h({status:d.status,message:`Unsupported ${m||"unknown"} container type for sidx segment at URL: ${u}`,response:"",playlist:e,internal:!0,playlistExclusionDuration:1/0,code:2},d);const{offset:v,length:_}=e.sidx.byterange;if(g.length>=_+v)return h(f,{response:g.subarray(v,v+_),status:d.status,uri:d.uri});this.request=this.vhs_.xhr({uri:u,responseType:"arraybuffer",headers:Rb({byterange:e.sidx.byterange})},h)})}dispose(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},rt.clearTimeout(this.minimumUpdatePeriodTimeout_),rt.clearTimeout(this.mediaRequest_),rt.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);const t=this.state;if(typeof e=="string"){if(!this.mainPlaylistLoader_.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.mainPlaylistLoader_.main.playlists[e]}const r=!this.media_||e.id!==this.media_.id;if(r&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList){this.state="HAVE_METADATA",this.media_=e,r&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}r&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(e,t,o=>{this.haveMetadata({startingState:t,playlist:e})}))}haveMetadata({startingState:e,playlist:t}){this.state="HAVE_METADATA",this.loadedPlaylists_[t.id]=t,this.mediaRequest_=null,this.refreshMedia_(t.id),e==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),rt.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(rt.clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)}load(e){rt.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;const t=this.media();if(e){const r=t?t.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=rt.setTimeout(()=>this.load(),r);return}if(!this.started){this.start();return}t&&!t.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist")}start(){if(this.started=!0,!this.isMain_){this.mediaRequest_=rt.setTimeout(()=>this.haveMain_(),0);return}this.requestMain_((e,t)=>{this.haveMain_(),!this.hasPendingRequest()&&!this.media_&&this.media(this.mainPlaylistLoader_.main.playlists[0])})}requestMain_(e){this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},(t,r)=>{if(this.requestErrored_(t,r)){this.state==="HAVE_NOTHING"&&(this.started=!1);return}const o=r.responseText!==this.mainPlaylistLoader_.mainXml_;if(this.mainPlaylistLoader_.mainXml_=r.responseText,r.responseHeaders&&r.responseHeaders.date?this.mainLoaded_=Date.parse(r.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=H_(this.mainPlaylistLoader_.srcUrl,r),o){this.handleMain_(),this.syncClientServerClock_(()=>e(r,o));return}return e(r,o)})}syncClientServerClock_(e){const t=cre(this.mainPlaylistLoader_.mainXml_);if(t===null)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();if(t.method==="DIRECT")return this.mainPlaylistLoader_.clientOffset_=t.value-Date.now(),e();this.request=this.vhs_.xhr({uri:Ko(this.mainPlaylistLoader_.srcUrl,t.value),method:t.method,withCredentials:this.withCredentials},(r,o)=>{if(!this.request)return;if(r)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();let u;t.method==="HEAD"?!o.responseHeaders||!o.responseHeaders.date?u=this.mainLoaded_:u=Date.parse(o.responseHeaders.date):u=Date.parse(o.responseText),this.mainPlaylistLoader_.clientOffset_=u-Date.now(),e()})}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){this.mediaRequest_=null;const e=this.mainPlaylistLoader_.main;let t=kse({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:e});e&&(t=Bse(e,t,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=t||e;const r=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];return r&&r!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=r),(!e||t&&t.minimumUpdatePeriod!==e.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),Boolean(t)}updateMinimumUpdatePeriodTimeout_(){const e=this.mainPlaylistLoader_;e.createMupOnMedia_&&(e.off("loadedmetadata",e.createMupOnMedia_),e.createMupOnMedia_=null),e.minimumUpdatePeriodTimeout_&&(rt.clearTimeout(e.minimumUpdatePeriodTimeout_),e.minimumUpdatePeriodTimeout_=null);let t=e.main&&e.main.minimumUpdatePeriod;if(t===0&&(e.media()?t=e.media().targetDuration*1e3:(e.createMupOnMedia_=e.updateMinimumUpdatePeriodTimeout_,e.one("loadedmetadata",e.createMupOnMedia_))),typeof t!="number"||t<=0){t<0&&this.logger_(`found invalid minimumUpdatePeriod of ${t}, not setting a timeout`);return}this.createMUPTimeout_(t)}createMUPTimeout_(e){const t=this.mainPlaylistLoader_;t.minimumUpdatePeriodTimeout_=rt.setTimeout(()=>{t.minimumUpdatePeriodTimeout_=null,t.trigger("minimumUpdatePeriod"),t.createMUPTimeout_(e)},e)}refreshXml_(){this.requestMain_((e,t)=>{t&&(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=Kse(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,r=>{this.refreshMedia_(this.media().id)}))})}refreshMedia_(e){if(!e)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const t=this.mainPlaylistLoader_.main.playlists,r=!this.media_||this.media_!==t[e];if(r?this.media_=t[e]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const o=()=>{this.media().endList||(this.mediaUpdateTimeout=rt.setTimeout(()=>{this.trigger("mediaupdatetimeout"),o()},Cb(this.media(),Boolean(r))))};o()}this.trigger("loadedplaylist")}}var is={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};const Gse=n=>{const e=new Uint8Array(new ArrayBuffer(n.length));for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e.buffer},wG=function(n){return n.on=n.addEventListener,n.off=n.removeEventListener,n},Wse=function(n){try{return URL.createObjectURL(new Blob([n],{type:"application/javascript"}))}catch{const t=new BlobBuilder;return t.append(n),URL.createObjectURL(t.getBlob())}},OG=function(n){return function(){const e=Wse(n),t=wG(new Worker(e));t.objURL=e;const r=t.terminate;return t.on=t.addEventListener,t.off=t.removeEventListener,t.terminate=function(){return URL.revokeObjectURL(e),r.call(this)},t}},NG=function(n){return`var browserWorkerPolyFill = ${wG.toString()};
browserWorkerPolyFill(self);
`+n},FG=function(n){return n.toString().replace(/^function.+?{/,"").slice(0,-1)},Hse=NG(FG(function(){var n=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=function(){this.init=function(){var H={};this.on=function(te,ce){H[te]||(H[te]=[]),H[te]=H[te].concat(ce)},this.off=function(te,ce){var le;return H[te]?(le=H[te].indexOf(ce),H[te]=H[te].slice(),H[te].splice(le,1),le>-1):!1},this.trigger=function(te){var ce,le,ye,be;if(ce=H[te],!!ce)if(arguments.length===2)for(ye=ce.length,le=0;le<ye;++le)ce[le].call(this,arguments[1]);else{for(be=[],le=arguments.length,le=1;le<arguments.length;++le)be.push(arguments[le]);for(ye=ce.length,le=0;le<ye;++le)ce[le].apply(this,be)}},this.dispose=function(){H={}}}};e.prototype.pipe=function(H){return this.on("data",function(te){H.push(te)}),this.on("done",function(te){H.flush(te)}),this.on("partialdone",function(te){H.partialFlush(te)}),this.on("endedtimeline",function(te){H.endTimeline(te)}),this.on("reset",function(te){H.reset(te)}),H},e.prototype.push=function(H){this.trigger("data",H)},e.prototype.flush=function(H){this.trigger("done",H)},e.prototype.partialFlush=function(H){this.trigger("partialdone",H)},e.prototype.endTimeline=function(H){this.trigger("endedtimeline",H)},e.prototype.reset=function(H){this.trigger("reset",H)};var t=e,r=Math.pow(2,32),o=function(H){var te=new DataView(H.buffer,H.byteOffset,H.byteLength),ce;return te.getBigUint64?(ce=te.getBigUint64(0),ce<Number.MAX_SAFE_INTEGER?Number(ce):ce):te.getUint32(0)*r+te.getUint32(4)},u={getUint64:o,MAX_UINT32:r},h=u.MAX_UINT32,f,d,m,g,v,_,S,E,T,C,R,b,F,O,L,D,x,B,M,I,U,w,k,K,W,Y,J,ee,ue,ie,Q,se,ve,_e,Z,Ee;(function(){var H;if(k={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},!(typeof Uint8Array>"u")){for(H in k)k.hasOwnProperty(H)&&(k[H]=[H.charCodeAt(0),H.charCodeAt(1),H.charCodeAt(2),H.charCodeAt(3)]);K=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),Y=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),W=new Uint8Array([0,0,0,1]),J=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),ee=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),ue={video:J,audio:ee},se=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Q=new Uint8Array([0,0,0,0,0,0,0,0]),ve=new Uint8Array([0,0,0,0,0,0,0,0]),_e=ve,Z=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Ee=ve,ie=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),f=function(H){var te=[],ce=0,le,ye,be;for(le=1;le<arguments.length;le++)te.push(arguments[le]);for(le=te.length;le--;)ce+=te[le].byteLength;for(ye=new Uint8Array(ce+8),be=new DataView(ye.buffer,ye.byteOffset,ye.byteLength),be.setUint32(0,ye.byteLength),ye.set(H,4),le=0,ce=8;le<te.length;le++)ye.set(te[le],ce),ce+=te[le].byteLength;return ye},d=function(){return f(k.dinf,f(k.dref,se))},m=function(H){return f(k.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,H.audioobjecttype<<3|H.samplingfrequencyindex>>>1,H.samplingfrequencyindex<<7|H.channelcount<<3,6,1,2]))},g=function(){return f(k.ftyp,K,W,K,Y)},D=function(H){return f(k.hdlr,ue[H])},v=function(H){return f(k.mdat,H)},L=function(H){var te=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,H.duration>>>24&255,H.duration>>>16&255,H.duration>>>8&255,H.duration&255,85,196,0,0]);return H.samplerate&&(te[12]=H.samplerate>>>24&255,te[13]=H.samplerate>>>16&255,te[14]=H.samplerate>>>8&255,te[15]=H.samplerate&255),f(k.mdhd,te)},O=function(H){return f(k.mdia,L(H),D(H.type),S(H))},_=function(H){return f(k.mfhd,new Uint8Array([0,0,0,0,(H&4278190080)>>24,(H&16711680)>>16,(H&65280)>>8,H&255]))},S=function(H){return f(k.minf,H.type==="video"?f(k.vmhd,ie):f(k.smhd,Q),d(),B(H))},E=function(H,te){for(var ce=[],le=te.length;le--;)ce[le]=I(te[le]);return f.apply(null,[k.moof,_(H)].concat(ce))},T=function(H){for(var te=H.length,ce=[];te--;)ce[te]=b(H[te]);return f.apply(null,[k.moov,R(4294967295)].concat(ce).concat(C(H)))},C=function(H){for(var te=H.length,ce=[];te--;)ce[te]=U(H[te]);return f.apply(null,[k.mvex].concat(ce))},R=function(H){var te=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(H&4278190080)>>24,(H&16711680)>>16,(H&65280)>>8,H&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return f(k.mvhd,te)},x=function(H){var te=H.samples||[],ce=new Uint8Array(4+te.length),le,ye;for(ye=0;ye<te.length;ye++)le=te[ye].flags,ce[ye+4]=le.dependsOn<<4|le.isDependedOn<<2|le.hasRedundancy;return f(k.sdtp,ce)},B=function(H){return f(k.stbl,M(H),f(k.stts,Ee),f(k.stsc,_e),f(k.stsz,Z),f(k.stco,ve))},function(){var H,te;M=function(ce){return f(k.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),ce.type==="video"?H(ce):te(ce))},H=function(ce){var le=ce.sps||[],ye=ce.pps||[],be=[],Ge=[],Xe,Je;for(Xe=0;Xe<le.length;Xe++)be.push((le[Xe].byteLength&65280)>>>8),be.push(le[Xe].byteLength&255),be=be.concat(Array.prototype.slice.call(le[Xe]));for(Xe=0;Xe<ye.length;Xe++)Ge.push((ye[Xe].byteLength&65280)>>>8),Ge.push(ye[Xe].byteLength&255),Ge=Ge.concat(Array.prototype.slice.call(ye[Xe]));if(Je=[k.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(ce.width&65280)>>8,ce.width&255,(ce.height&65280)>>8,ce.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),f(k.avcC,new Uint8Array([1,ce.profileIdc,ce.profileCompatibility,ce.levelIdc,255].concat([le.length],be,[ye.length],Ge))),f(k.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],ce.sarRatio){var ot=ce.sarRatio[0],_t=ce.sarRatio[1];Je.push(f(k.pasp,new Uint8Array([(ot&4278190080)>>24,(ot&16711680)>>16,(ot&65280)>>8,ot&255,(_t&4278190080)>>24,(_t&16711680)>>16,(_t&65280)>>8,_t&255])))}return f.apply(null,Je)},te=function(ce){return f(k.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(ce.channelcount&65280)>>8,ce.channelcount&255,(ce.samplesize&65280)>>8,ce.samplesize&255,0,0,0,0,(ce.samplerate&65280)>>8,ce.samplerate&255,0,0]),m(ce))}}(),F=function(H){var te=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(H.id&4278190080)>>24,(H.id&16711680)>>16,(H.id&65280)>>8,H.id&255,0,0,0,0,(H.duration&4278190080)>>24,(H.duration&16711680)>>16,(H.duration&65280)>>8,H.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(H.width&65280)>>8,H.width&255,0,0,(H.height&65280)>>8,H.height&255,0,0]);return f(k.tkhd,te)},I=function(H){var te,ce,le,ye,be,Ge,Xe;return te=f(k.tfhd,new Uint8Array([0,0,0,58,(H.id&4278190080)>>24,(H.id&16711680)>>16,(H.id&65280)>>8,H.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),Ge=Math.floor(H.baseMediaDecodeTime/h),Xe=Math.floor(H.baseMediaDecodeTime%h),ce=f(k.tfdt,new Uint8Array([1,0,0,0,Ge>>>24&255,Ge>>>16&255,Ge>>>8&255,Ge&255,Xe>>>24&255,Xe>>>16&255,Xe>>>8&255,Xe&255])),be=32+20+8+16+8+8,H.type==="audio"?(le=w(H,be),f(k.traf,te,ce,le)):(ye=x(H),le=w(H,ye.length+be),f(k.traf,te,ce,le,ye))},b=function(H){return H.duration=H.duration||4294967295,f(k.trak,F(H),O(H))},U=function(H){var te=new Uint8Array([0,0,0,0,(H.id&4278190080)>>24,(H.id&16711680)>>16,(H.id&65280)>>8,H.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return H.type!=="video"&&(te[te.length-1]=0),f(k.trex,te)},function(){var H,te,ce;ce=function(le,ye){var be=0,Ge=0,Xe=0,Je=0;return le.length&&(le[0].duration!==void 0&&(be=1),le[0].size!==void 0&&(Ge=2),le[0].flags!==void 0&&(Xe=4),le[0].compositionTimeOffset!==void 0&&(Je=8)),[0,0,be|Ge|Xe|Je,1,(le.length&4278190080)>>>24,(le.length&16711680)>>>16,(le.length&65280)>>>8,le.length&255,(ye&4278190080)>>>24,(ye&16711680)>>>16,(ye&65280)>>>8,ye&255]},te=function(le,ye){var be,Ge,Xe,Je,ot,_t;for(Je=le.samples||[],ye+=8+12+16*Je.length,Xe=ce(Je,ye),Ge=new Uint8Array(Xe.length+Je.length*16),Ge.set(Xe),be=Xe.length,_t=0;_t<Je.length;_t++)ot=Je[_t],Ge[be++]=(ot.duration&4278190080)>>>24,Ge[be++]=(ot.duration&16711680)>>>16,Ge[be++]=(ot.duration&65280)>>>8,Ge[be++]=ot.duration&255,Ge[be++]=(ot.size&4278190080)>>>24,Ge[be++]=(ot.size&16711680)>>>16,Ge[be++]=(ot.size&65280)>>>8,Ge[be++]=ot.size&255,Ge[be++]=ot.flags.isLeading<<2|ot.flags.dependsOn,Ge[be++]=ot.flags.isDependedOn<<6|ot.flags.hasRedundancy<<4|ot.flags.paddingValue<<1|ot.flags.isNonSyncSample,Ge[be++]=ot.flags.degradationPriority&240<<8,Ge[be++]=ot.flags.degradationPriority&15,Ge[be++]=(ot.compositionTimeOffset&4278190080)>>>24,Ge[be++]=(ot.compositionTimeOffset&16711680)>>>16,Ge[be++]=(ot.compositionTimeOffset&65280)>>>8,Ge[be++]=ot.compositionTimeOffset&255;return f(k.trun,Ge)},H=function(le,ye){var be,Ge,Xe,Je,ot,_t;for(Je=le.samples||[],ye+=8+12+8*Je.length,Xe=ce(Je,ye),be=new Uint8Array(Xe.length+Je.length*8),be.set(Xe),Ge=Xe.length,_t=0;_t<Je.length;_t++)ot=Je[_t],be[Ge++]=(ot.duration&4278190080)>>>24,be[Ge++]=(ot.duration&16711680)>>>16,be[Ge++]=(ot.duration&65280)>>>8,be[Ge++]=ot.duration&255,be[Ge++]=(ot.size&4278190080)>>>24,be[Ge++]=(ot.size&16711680)>>>16,be[Ge++]=(ot.size&65280)>>>8,be[Ge++]=ot.size&255;return f(k.trun,be)},w=function(le,ye){return le.type==="audio"?H(le,ye):te(le,ye)}}();var Se={ftyp:g,mdat:v,moof:E,moov:T,initSegment:function(H){var te=g(),ce=T(H),le;return le=new Uint8Array(te.byteLength+ce.byteLength),le.set(te),le.set(ce,te.byteLength),le}},Me=function(H){var te,ce,le=[],ye=[];for(ye.byteLength=0,ye.nalCount=0,ye.duration=0,le.byteLength=0,te=0;te<H.length;te++)ce=H[te],ce.nalUnitType==="access_unit_delimiter_rbsp"?(le.length&&(le.duration=ce.dts-le.dts,ye.byteLength+=le.byteLength,ye.nalCount+=le.length,ye.duration+=le.duration,ye.push(le)),le=[ce],le.byteLength=ce.data.byteLength,le.pts=ce.pts,le.dts=ce.dts):(ce.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(le.keyFrame=!0),le.duration=ce.dts-le.dts,le.byteLength+=ce.data.byteLength,le.push(ce));return ye.length&&(!le.duration||le.duration<=0)&&(le.duration=ye[ye.length-1].duration),ye.byteLength+=le.byteLength,ye.nalCount+=le.length,ye.duration+=le.duration,ye.push(le),ye},de=function(H){var te,ce,le=[],ye=[];for(le.byteLength=0,le.nalCount=0,le.duration=0,le.pts=H[0].pts,le.dts=H[0].dts,ye.byteLength=0,ye.nalCount=0,ye.duration=0,ye.pts=H[0].pts,ye.dts=H[0].dts,te=0;te<H.length;te++)ce=H[te],ce.keyFrame?(le.length&&(ye.push(le),ye.byteLength+=le.byteLength,ye.nalCount+=le.nalCount,ye.duration+=le.duration),le=[ce],le.nalCount=ce.length,le.byteLength=ce.byteLength,le.pts=ce.pts,le.dts=ce.dts,le.duration=ce.duration):(le.duration+=ce.duration,le.nalCount+=ce.length,le.byteLength+=ce.byteLength,le.push(ce));return ye.length&&le.duration<=0&&(le.duration=ye[ye.length-1].duration),ye.byteLength+=le.byteLength,ye.nalCount+=le.nalCount,ye.duration+=le.duration,ye.push(le),ye},xe=function(H){var te;return!H[0][0].keyFrame&&H.length>1&&(te=H.shift(),H.byteLength-=te.byteLength,H.nalCount-=te.nalCount,H[0][0].dts=te.dts,H[0][0].pts=te.pts,H[0][0].duration+=te.duration),H},Fe=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},Le=function(H,te){var ce=Fe();return ce.dataOffset=te,ce.compositionTimeOffset=H.pts-H.dts,ce.duration=H.duration,ce.size=4*H.length,ce.size+=H.byteLength,H.keyFrame&&(ce.flags.dependsOn=2,ce.flags.isNonSyncSample=0),ce},De=function(H,te){var ce,le,ye,be,Ge,Xe=te||0,Je=[];for(ce=0;ce<H.length;ce++)for(be=H[ce],le=0;le<be.length;le++)Ge=be[le],ye=Le(Ge,Xe),Xe+=ye.size,Je.push(ye);return Je},Ae=function(H){var te,ce,le,ye,be,Ge,Xe=0,Je=H.byteLength,ot=H.nalCount,_t=Je+4*ot,Bt=new Uint8Array(_t),Sn=new DataView(Bt.buffer);for(te=0;te<H.length;te++)for(ye=H[te],ce=0;ce<ye.length;ce++)for(be=ye[ce],le=0;le<be.length;le++)Ge=be[le],Sn.setUint32(Xe,Ge.data.byteLength),Xe+=4,Bt.set(Ge.data,Xe),Xe+=Ge.data.byteLength;return Bt},ge=function(H,te){var ce,le=te||0,ye=[];return ce=Le(H,le),ye.push(ce),ye},pe=function(H){var te,ce,le=0,ye=H.byteLength,be=H.length,Ge=ye+4*be,Xe=new Uint8Array(Ge),Je=new DataView(Xe.buffer);for(te=0;te<H.length;te++)ce=H[te],Je.setUint32(le,ce.data.byteLength),le+=4,Xe.set(ce.data,le),le+=ce.data.byteLength;return Xe},Re={groupNalsIntoFrames:Me,groupFramesIntoGops:de,extendFirstKeyFrame:xe,generateSampleTable:De,concatenateNalData:Ae,generateSampleTableForFrame:ge,concatenateNalDataForFrame:pe},me=[33,16,5,32,164,27],V=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],j=function(H){for(var te=[];H--;)te.push(0);return te},$=function(H){return Object.keys(H).reduce(function(te,ce){return te[ce]=new Uint8Array(H[ce].reduce(function(le,ye){return le.concat(ye)},[])),te},{})},re,oe=function(){if(!re){var H={96e3:[me,[227,64],j(154),[56]],88200:[me,[231],j(170),[56]],64e3:[me,[248,192],j(240),[56]],48e3:[me,[255,192],j(268),[55,148,128],j(54),[112]],44100:[me,[255,192],j(268),[55,163,128],j(84),[112]],32e3:[me,[255,192],j(268),[55,234],j(226),[112]],24e3:[me,[255,192],j(268),[55,255,128],j(268),[111,112],j(126),[224]],16e3:[me,[255,192],j(268),[55,255,128],j(268),[111,255],j(269),[223,108],j(195),[1,192]],12e3:[V,j(268),[3,127,248],j(268),[6,255,240],j(268),[13,255,224],j(268),[27,253,128],j(259),[56]],11025:[V,j(268),[3,127,248],j(268),[6,255,240],j(268),[13,255,224],j(268),[27,255,192],j(268),[55,175,128],j(108),[112]],8e3:[V,j(268),[3,121,16],j(47),[7]]};re=$(H)}return re},X=9e4,z,ne,fe,Ce,Pe,he,Ue;z=function(H){return H*X},ne=function(H,te){return H*te},fe=function(H){return H/X},Ce=function(H,te){return H/te},Pe=function(H,te){return z(Ce(H,te))},he=function(H,te){return ne(fe(H),te)},Ue=function(H,te,ce){return fe(ce?H:H-te)};var we={ONE_SECOND_IN_TS:X,secondsToVideoTs:z,secondsToAudioTs:ne,videoTsToSeconds:fe,audioTsToSeconds:Ce,audioTsToVideoTs:Pe,videoTsToAudioTs:he,metadataTsToSeconds:Ue},$e=oe,it=we,mt=function(H){var te,ce,le=0;for(te=0;te<H.length;te++)ce=H[te],le+=ce.data.byteLength;return le},pt=function(H,te,ce,le){var ye,be=0,Ge=0,Xe=0,Je=0,ot,_t,Bt;if(te.length&&(ye=it.audioTsToVideoTs(H.baseMediaDecodeTime,H.samplerate),be=Math.ceil(it.ONE_SECOND_IN_TS/(H.samplerate/1024)),ce&&le&&(Ge=ye-Math.max(ce,le),Xe=Math.floor(Ge/be),Je=Xe*be),!(Xe<1||Je>it.ONE_SECOND_IN_TS/2))){for(ot=$e()[H.samplerate],ot||(ot=te[0].data),_t=0;_t<Xe;_t++)Bt=te[0],te.splice(0,0,{data:ot,dts:Bt.dts-be,pts:Bt.pts-be});return H.baseMediaDecodeTime-=Math.floor(it.videoTsToAudioTs(Je,H.samplerate)),Je}},Pt=function(H,te,ce){return te.minSegmentDts>=ce?H:(te.minSegmentDts=1/0,H.filter(function(le){return le.dts>=ce?(te.minSegmentDts=Math.min(te.minSegmentDts,le.dts),te.minSegmentPts=te.minSegmentDts,!0):!1}))},lt=function(H){var te,ce,le=[];for(te=0;te<H.length;te++)ce=H[te],le.push({size:ce.data.byteLength,duration:1024});return le},Ye=function(H){var te,ce,le=0,ye=new Uint8Array(mt(H));for(te=0;te<H.length;te++)ce=H[te],ye.set(ce.data,le),le+=ce.data.byteLength;return ye},st={prefixWithSilence:pt,trimAdtsFramesByEarliestDts:Pt,generateSampleTable:lt,concatenateFrameData:Ye},Nt=we.ONE_SECOND_IN_TS,Wt=function(H,te){typeof te.pts=="number"&&(H.timelineStartInfo.pts===void 0&&(H.timelineStartInfo.pts=te.pts),H.minSegmentPts===void 0?H.minSegmentPts=te.pts:H.minSegmentPts=Math.min(H.minSegmentPts,te.pts),H.maxSegmentPts===void 0?H.maxSegmentPts=te.pts:H.maxSegmentPts=Math.max(H.maxSegmentPts,te.pts)),typeof te.dts=="number"&&(H.timelineStartInfo.dts===void 0&&(H.timelineStartInfo.dts=te.dts),H.minSegmentDts===void 0?H.minSegmentDts=te.dts:H.minSegmentDts=Math.min(H.minSegmentDts,te.dts),H.maxSegmentDts===void 0?H.maxSegmentDts=te.dts:H.maxSegmentDts=Math.max(H.maxSegmentDts,te.dts))},Ht=function(H){delete H.minSegmentDts,delete H.maxSegmentDts,delete H.minSegmentPts,delete H.maxSegmentPts},nt=function(H,te){var ce,le,ye=H.minSegmentDts;return te||(ye-=H.timelineStartInfo.dts),ce=H.timelineStartInfo.baseMediaDecodeTime,ce+=ye,ce=Math.max(0,ce),H.type==="audio"&&(le=H.samplerate/Nt,ce*=le,ce=Math.floor(ce)),ce},Et={clearDtsInfo:Ht,calculateTrackBaseMediaDecodeTime:nt,collectDtsInfo:Wt},St=4,Ut=128,Vt=function(H){for(var te=0,ce={payloadType:-1,payloadSize:0},le=0,ye=0;te<H.byteLength&&H[te]!==Ut;){for(;H[te]===255;)le+=255,te++;for(le+=H[te++];H[te]===255;)ye+=255,te++;if(ye+=H[te++],!ce.payload&&le===St){var be=String.fromCharCode(H[te+3],H[te+4],H[te+5],H[te+6]);if(be==="GA94"){ce.payloadType=le,ce.payloadSize=ye,ce.payload=H.subarray(te,te+ye);break}else ce.payload=void 0}te+=ye,le=0,ye=0}return ce},Zt=function(H){return H.payload[0]!==181||(H.payload[1]<<8|H.payload[2])!==49||String.fromCharCode(H.payload[3],H.payload[4],H.payload[5],H.payload[6])!=="GA94"||H.payload[7]!==3?null:H.payload.subarray(8,H.payload.length-1)},We=function(H,te){var ce=[],le,ye,be,Ge;if(!(te[0]&64))return ce;for(ye=te[0]&31,le=0;le<ye;le++)be=le*3,Ge={type:te[be+2]&3,pts:H},te[be+2]&4&&(Ge.ccData=te[be+3]<<8|te[be+4],ce.push(Ge));return ce},In=function(H){for(var te=H.byteLength,ce=[],le=1,ye,be;le<te-2;)H[le]===0&&H[le+1]===0&&H[le+2]===3?(ce.push(le+2),le+=2):le++;if(ce.length===0)return H;ye=te-ce.length,be=new Uint8Array(ye);var Ge=0;for(le=0;le<ye;Ge++,le++)Ge===ce[0]&&(Ge++,ce.shift()),be[le]=H[Ge];return be},Ct={parseSei:Vt,parseUserData:Zt,parseCaptionPackets:We,discardEmulationPreventionBytes:In,USER_DATA_REGISTERED_ITU_T_T35:St},je=t,Oe=Ct,ze=function(H){H=H||{},ze.prototype.init.call(this),this.parse708captions_=typeof H.parse708captions=="boolean"?H.parse708captions:!0,this.captionPackets_=[],this.ccStreams_=[new Gt(0,0),new Gt(0,1),new Gt(1,0),new Gt(1,1)],this.parse708captions_&&(this.cc708Stream_=new Kt({captionServices:H.captionServices})),this.reset(),this.ccStreams_.forEach(function(te){te.on("data",this.trigger.bind(this,"data")),te.on("partialdone",this.trigger.bind(this,"partialdone")),te.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};ze.prototype=new je,ze.prototype.push=function(H){var te,ce,le;if(H.nalUnitType==="sei_rbsp"&&(te=Oe.parseSei(H.escapedRBSP),!!te.payload&&te.payloadType===Oe.USER_DATA_REGISTERED_ITU_T_T35&&(ce=Oe.parseUserData(te),!!ce))){if(H.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(H.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}le=Oe.parseCaptionPackets(H.pts,ce),this.captionPackets_=this.captionPackets_.concat(le),this.latestDts_!==H.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=H.dts}},ze.prototype.flushCCStreams=function(H){this.ccStreams_.forEach(function(te){return H==="flush"?te.flush():te.partialFlush()},this)},ze.prototype.flushStream=function(H){if(!this.captionPackets_.length){this.flushCCStreams(H);return}this.captionPackets_.forEach(function(te,ce){te.presortIndex=ce}),this.captionPackets_.sort(function(te,ce){return te.pts===ce.pts?te.presortIndex-ce.presortIndex:te.pts-ce.pts}),this.captionPackets_.forEach(function(te){te.type<2?this.dispatchCea608Packet(te):this.dispatchCea708Packet(te)},this),this.captionPackets_.length=0,this.flushCCStreams(H)},ze.prototype.flush=function(){return this.flushStream("flush")},ze.prototype.partialFlush=function(){return this.flushStream("partialFlush")},ze.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(H){H.reset()})},ze.prototype.dispatchCea608Packet=function(H){this.setsTextOrXDSActive(H)?this.activeCea608Channel_[H.type]=null:this.setsChannel1Active(H)?this.activeCea608Channel_[H.type]=0:this.setsChannel2Active(H)&&(this.activeCea608Channel_[H.type]=1),this.activeCea608Channel_[H.type]!==null&&this.ccStreams_[(H.type<<1)+this.activeCea608Channel_[H.type]].push(H)},ze.prototype.setsChannel1Active=function(H){return(H.ccData&30720)===4096},ze.prototype.setsChannel2Active=function(H){return(H.ccData&30720)===6144},ze.prototype.setsTextOrXDSActive=function(H){return(H.ccData&28928)===256||(H.ccData&30974)===4138||(H.ccData&30974)===6186},ze.prototype.dispatchCea708Packet=function(H){this.parse708captions_&&this.cc708Stream_.push(H)};var ct={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},dt=function(H){var te=ct[H]||H;return H&4096&&H===te?"":String.fromCharCode(te)},bt=function(H){return 32<=H&&H<=127||160<=H&&H<=255},Ft=function(H){this.windowNum=H,this.reset()};Ft.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Ft.prototype.getText=function(){return this.rows.join(`
`)},Ft.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Ft.prototype.newLine=function(H){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(H),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Ft.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1},Ft.prototype.addText=function(H){this.rows[this.rowIdx]+=H},Ft.prototype.backspace=function(){if(!this.isEmpty()){var H=this.rows[this.rowIdx];this.rows[this.rowIdx]=H.substr(0,H.length-1)}};var Dt=function(H,te,ce){this.serviceNum=H,this.text="",this.currentWindow=new Ft(-1),this.windows=[],this.stream=ce,typeof te=="string"&&this.createTextDecoder(te)};Dt.prototype.init=function(H,te){this.startPts=H;for(var ce=0;ce<8;ce++)this.windows[ce]=new Ft(ce),typeof te=="function"&&(this.windows[ce].beforeRowOverflow=te)},Dt.prototype.setCurrentWindow=function(H){this.currentWindow=this.windows[H]},Dt.prototype.createTextDecoder=function(H){if(typeof TextDecoder>"u")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(H)}catch(te){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+H+" encoding. "+te})}};var Kt=function(H){H=H||{},Kt.prototype.init.call(this);var te=this,ce=H.captionServices||{},le={},ye;Object.keys(ce).forEach(be=>{ye=ce[be],/^SERVICE/.test(be)&&(le[be]=ye.encoding)}),this.serviceEncodings=le,this.current708Packet=null,this.services={},this.push=function(be){be.type===3?(te.new708Packet(),te.add708Bytes(be)):(te.current708Packet===null&&te.new708Packet(),te.add708Bytes(be))}};Kt.prototype=new je,Kt.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},Kt.prototype.add708Bytes=function(H){var te=H.ccData,ce=te>>>8,le=te&255;this.current708Packet.ptsVals.push(H.pts),this.current708Packet.data.push(ce),this.current708Packet.data.push(le)},Kt.prototype.push708Packet=function(){var H=this.current708Packet,te=H.data,ce=null,le=null,ye=0,be=te[ye++];for(H.seq=be>>6,H.sizeCode=be&63;ye<te.length;ye++)be=te[ye++],ce=be>>5,le=be&31,ce===7&&le>0&&(be=te[ye++],ce=be),this.pushServiceBlock(ce,ye,le),le>0&&(ye+=le-1)},Kt.prototype.pushServiceBlock=function(H,te,ce){var le,ye=te,be=this.current708Packet.data,Ge=this.services[H];for(Ge||(Ge=this.initService(H,ye));ye<te+ce&&ye<be.length;ye++)le=be[ye],bt(le)?ye=this.handleText(ye,Ge):le===24?ye=this.multiByteCharacter(ye,Ge):le===16?ye=this.extendedCommands(ye,Ge):128<=le&&le<=135?ye=this.setCurrentWindow(ye,Ge):152<=le&&le<=159?ye=this.defineWindow(ye,Ge):le===136?ye=this.clearWindows(ye,Ge):le===140?ye=this.deleteWindows(ye,Ge):le===137?ye=this.displayWindows(ye,Ge):le===138?ye=this.hideWindows(ye,Ge):le===139?ye=this.toggleWindows(ye,Ge):le===151?ye=this.setWindowAttributes(ye,Ge):le===144?ye=this.setPenAttributes(ye,Ge):le===145?ye=this.setPenColor(ye,Ge):le===146?ye=this.setPenLocation(ye,Ge):le===143?Ge=this.reset(ye,Ge):le===8?Ge.currentWindow.backspace():le===12?Ge.currentWindow.clearText():le===13?Ge.currentWindow.pendingNewLine=!0:le===14?Ge.currentWindow.clearText():le===141&&ye++},Kt.prototype.extendedCommands=function(H,te){var ce=this.current708Packet.data,le=ce[++H];return bt(le)&&(H=this.handleText(H,te,{isExtended:!0})),H},Kt.prototype.getPts=function(H){return this.current708Packet.ptsVals[Math.floor(H/2)]},Kt.prototype.initService=function(H,te){var le="SERVICE"+H,ce=this,le,ye;return le in this.serviceEncodings&&(ye=this.serviceEncodings[le]),this.services[H]=new Dt(H,ye,ce),this.services[H].init(this.getPts(te),function(be){ce.flushDisplayed(be,ce.services[H])}),this.services[H]},Kt.prototype.handleText=function(H,te,ce){var le=ce&&ce.isExtended,ye=ce&&ce.isMultiByte,be=this.current708Packet.data,Ge=le?4096:0,Xe=be[H],Je=be[H+1],ot=te.currentWindow,_t,Bt;return te.textDecoder_&&!le?(ye?(Bt=[Xe,Je],H++):Bt=[Xe],_t=te.textDecoder_.decode(new Uint8Array(Bt))):_t=dt(Ge|Xe),ot.pendingNewLine&&!ot.isEmpty()&&ot.newLine(this.getPts(H)),ot.pendingNewLine=!1,ot.addText(_t),H},Kt.prototype.multiByteCharacter=function(H,te){var ce=this.current708Packet.data,le=ce[H+1],ye=ce[H+2];return bt(le)&&bt(ye)&&(H=this.handleText(++H,te,{isMultiByte:!0})),H},Kt.prototype.setCurrentWindow=function(H,te){var ce=this.current708Packet.data,le=ce[H],ye=le&7;return te.setCurrentWindow(ye),H},Kt.prototype.defineWindow=function(H,te){var ce=this.current708Packet.data,le=ce[H],ye=le&7;te.setCurrentWindow(ye);var be=te.currentWindow;return le=ce[++H],be.visible=(le&32)>>5,be.rowLock=(le&16)>>4,be.columnLock=(le&8)>>3,be.priority=le&7,le=ce[++H],be.relativePositioning=(le&128)>>7,be.anchorVertical=le&127,le=ce[++H],be.anchorHorizontal=le,le=ce[++H],be.anchorPoint=(le&240)>>4,be.rowCount=le&15,le=ce[++H],be.columnCount=le&63,le=ce[++H],be.windowStyle=(le&56)>>3,be.penStyle=le&7,be.virtualRowCount=be.rowCount+1,H},Kt.prototype.setWindowAttributes=function(H,te){var ce=this.current708Packet.data,le=ce[H],ye=te.currentWindow.winAttr;return le=ce[++H],ye.fillOpacity=(le&192)>>6,ye.fillRed=(le&48)>>4,ye.fillGreen=(le&12)>>2,ye.fillBlue=le&3,le=ce[++H],ye.borderType=(le&192)>>6,ye.borderRed=(le&48)>>4,ye.borderGreen=(le&12)>>2,ye.borderBlue=le&3,le=ce[++H],ye.borderType+=(le&128)>>5,ye.wordWrap=(le&64)>>6,ye.printDirection=(le&48)>>4,ye.scrollDirection=(le&12)>>2,ye.justify=le&3,le=ce[++H],ye.effectSpeed=(le&240)>>4,ye.effectDirection=(le&12)>>2,ye.displayEffect=le&3,H},Kt.prototype.flushDisplayed=function(H,te){for(var ce=[],le=0;le<8;le++)te.windows[le].visible&&!te.windows[le].isEmpty()&&ce.push(te.windows[le].getText());te.endPts=H,te.text=ce.join(`

`),this.pushCaption(te),te.startPts=H},Kt.prototype.pushCaption=function(H){H.text!==""&&(this.trigger("data",{startPts:H.startPts,endPts:H.endPts,text:H.text,stream:"cc708_"+H.serviceNum}),H.text="",H.startPts=H.endPts)},Kt.prototype.displayWindows=function(H,te){var ce=this.current708Packet.data,le=ce[++H],ye=this.getPts(H);this.flushDisplayed(ye,te);for(var be=0;be<8;be++)le&1<<be&&(te.windows[be].visible=1);return H},Kt.prototype.hideWindows=function(H,te){var ce=this.current708Packet.data,le=ce[++H],ye=this.getPts(H);this.flushDisplayed(ye,te);for(var be=0;be<8;be++)le&1<<be&&(te.windows[be].visible=0);return H},Kt.prototype.toggleWindows=function(H,te){var ce=this.current708Packet.data,le=ce[++H],ye=this.getPts(H);this.flushDisplayed(ye,te);for(var be=0;be<8;be++)le&1<<be&&(te.windows[be].visible^=1);return H},Kt.prototype.clearWindows=function(H,te){var ce=this.current708Packet.data,le=ce[++H],ye=this.getPts(H);this.flushDisplayed(ye,te);for(var be=0;be<8;be++)le&1<<be&&te.windows[be].clearText();return H},Kt.prototype.deleteWindows=function(H,te){var ce=this.current708Packet.data,le=ce[++H],ye=this.getPts(H);this.flushDisplayed(ye,te);for(var be=0;be<8;be++)le&1<<be&&te.windows[be].reset();return H},Kt.prototype.setPenAttributes=function(H,te){var ce=this.current708Packet.data,le=ce[H],ye=te.currentWindow.penAttr;return le=ce[++H],ye.textTag=(le&240)>>4,ye.offset=(le&12)>>2,ye.penSize=le&3,le=ce[++H],ye.italics=(le&128)>>7,ye.underline=(le&64)>>6,ye.edgeType=(le&56)>>3,ye.fontStyle=le&7,H},Kt.prototype.setPenColor=function(H,te){var ce=this.current708Packet.data,le=ce[H],ye=te.currentWindow.penColor;return le=ce[++H],ye.fgOpacity=(le&192)>>6,ye.fgRed=(le&48)>>4,ye.fgGreen=(le&12)>>2,ye.fgBlue=le&3,le=ce[++H],ye.bgOpacity=(le&192)>>6,ye.bgRed=(le&48)>>4,ye.bgGreen=(le&12)>>2,ye.bgBlue=le&3,le=ce[++H],ye.edgeRed=(le&48)>>4,ye.edgeGreen=(le&12)>>2,ye.edgeBlue=le&3,H},Kt.prototype.setPenLocation=function(H,te){var ce=this.current708Packet.data,le=ce[H],ye=te.currentWindow.penLoc;return te.currentWindow.pendingNewLine=!0,le=ce[++H],ye.row=le&15,le=ce[++H],ye.column=le&63,H},Kt.prototype.reset=function(H,te){var ce=this.getPts(H);return this.flushDisplayed(ce,te),this.initService(te.serviceNum,H)};var on={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Tn=function(H){return H===null?"":(H=on[H]||H,String.fromCharCode(H))},Ke=14,ut=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],wt=function(){for(var H=[],te=Ke+1;te--;)H.push("");return H},Gt=function(H,te){Gt.prototype.init.call(this),this.field_=H||0,this.dataChannel_=te||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(ce){var le,ye,be,Ge,Xe;if(le=ce.ccData&32639,le===this.lastControlCode_){this.lastControlCode_=null;return}if((le&61440)===4096?this.lastControlCode_=le:le!==this.PADDING_&&(this.lastControlCode_=null),be=le>>>8,Ge=le&255,le!==this.PADDING_)if(le===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(le===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(ce.pts),this.flushDisplayed(ce.pts),ye=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=ye,this.startPts_=ce.pts;else if(le===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(ce.pts);else if(le===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(ce.pts);else if(le===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(ce.pts);else if(le===this.CARRIAGE_RETURN_)this.clearFormatting(ce.pts),this.flushDisplayed(ce.pts),this.shiftRowsUp_(),this.startPts_=ce.pts;else if(le===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(le===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(ce.pts),this.displayed_=wt();else if(le===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=wt();else if(le===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(ce.pts),this.displayed_=wt()),this.mode_="paintOn",this.startPts_=ce.pts;else if(this.isSpecialCharacter(be,Ge))be=(be&3)<<8,Xe=Tn(be|Ge),this[this.mode_](ce.pts,Xe),this.column_++;else if(this.isExtCharacter(be,Ge))this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),be=(be&3)<<8,Xe=Tn(be|Ge),this[this.mode_](ce.pts,Xe),this.column_++;else if(this.isMidRowCode(be,Ge))this.clearFormatting(ce.pts),this[this.mode_](ce.pts," "),this.column_++,(Ge&14)===14&&this.addFormatting(ce.pts,["i"]),(Ge&1)===1&&this.addFormatting(ce.pts,["u"]);else if(this.isOffsetControlCode(be,Ge))this.column_+=Ge&3;else if(this.isPAC(be,Ge)){var Je=ut.indexOf(le&7968);this.mode_==="rollUp"&&(Je-this.rollUpRows_+1<0&&(Je=this.rollUpRows_-1),this.setRollUp(ce.pts,Je)),Je!==this.row_&&(this.clearFormatting(ce.pts),this.row_=Je),Ge&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(ce.pts,["u"]),(le&16)===16&&(this.column_=((le&14)>>1)*4),this.isColorPAC(Ge)&&(Ge&14)===14&&this.addFormatting(ce.pts,["i"])}else this.isNormalChar(be)&&(Ge===0&&(Ge=null),Xe=Tn(be),Xe+=Tn(Ge),this[this.mode_](ce.pts,Xe),this.column_+=Xe.length)}};Gt.prototype=new je,Gt.prototype.flushDisplayed=function(H){var te=this.displayed_.map(function(ce,le){try{return ce.trim()}catch{return this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+le+"."}),""}},this).join(`
`).replace(/^\n+|\n+$/g,"");te.length&&this.trigger("data",{startPts:this.startPts_,endPts:H,text:te,stream:this.name_})},Gt.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=wt(),this.nonDisplayed_=wt(),this.lastControlCode_=null,this.column_=0,this.row_=Ke,this.rollUpRows_=2,this.formatting_=[]},Gt.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},Gt.prototype.isSpecialCharacter=function(H,te){return H===this.EXT_&&te>=48&&te<=63},Gt.prototype.isExtCharacter=function(H,te){return(H===this.EXT_+1||H===this.EXT_+2)&&te>=32&&te<=63},Gt.prototype.isMidRowCode=function(H,te){return H===this.EXT_&&te>=32&&te<=47},Gt.prototype.isOffsetControlCode=function(H,te){return H===this.OFFSET_&&te>=33&&te<=35},Gt.prototype.isPAC=function(H,te){return H>=this.BASE_&&H<this.BASE_+8&&te>=64&&te<=127},Gt.prototype.isColorPAC=function(H){return H>=64&&H<=79||H>=96&&H<=127},Gt.prototype.isNormalChar=function(H){return H>=32&&H<=127},Gt.prototype.setRollUp=function(H,te){if(this.mode_!=="rollUp"&&(this.row_=Ke,this.mode_="rollUp",this.flushDisplayed(H),this.nonDisplayed_=wt(),this.displayed_=wt()),te!==void 0&&te!==this.row_)for(var ce=0;ce<this.rollUpRows_;ce++)this.displayed_[te-ce]=this.displayed_[this.row_-ce],this.displayed_[this.row_-ce]="";te===void 0&&(te=this.row_),this.topRow_=te-this.rollUpRows_+1},Gt.prototype.addFormatting=function(H,te){this.formatting_=this.formatting_.concat(te);var ce=te.reduce(function(le,ye){return le+"<"+ye+">"},"");this[this.mode_](H,ce)},Gt.prototype.clearFormatting=function(H){if(this.formatting_.length){var te=this.formatting_.reverse().reduce(function(ce,le){return ce+"</"+le+">"},"");this.formatting_=[],this[this.mode_](H,te)}},Gt.prototype.popOn=function(H,te){var ce=this.nonDisplayed_[this.row_];ce+=te,this.nonDisplayed_[this.row_]=ce},Gt.prototype.rollUp=function(H,te){var ce=this.displayed_[this.row_];ce+=te,this.displayed_[this.row_]=ce},Gt.prototype.shiftRowsUp_=function(){var H;for(H=0;H<this.topRow_;H++)this.displayed_[H]="";for(H=this.row_+1;H<Ke+1;H++)this.displayed_[H]="";for(H=this.topRow_;H<this.row_;H++)this.displayed_[H]=this.displayed_[H+1];this.displayed_[this.row_]=""},Gt.prototype.paintOn=function(H,te){var ce=this.displayed_[this.row_];ce+=te,this.displayed_[this.row_]=ce};var Qt={CaptionStream:ze,Cea608Stream:Gt,Cea708Stream:Kt},sn={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Dn=t,pn=8589934592,sr=4294967296,Be="shared",Tt=function(H,te){var ce=1;for(H>te&&(ce=-1);Math.abs(te-H)>sr;)H+=ce*pn;return H},Xt=function(H){var te,ce;Xt.prototype.init.call(this),this.type_=H||Be,this.push=function(le){this.type_!==Be&&le.type!==this.type_||(ce===void 0&&(ce=le.dts),le.dts=Tt(le.dts,ce),le.pts=Tt(le.pts,ce),te=le.dts,this.trigger("data",le))},this.flush=function(){ce=te,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){ce=void 0,te=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};Xt.prototype=new Dn;var et={TimestampRolloverStream:Xt,handleRollover:Tt},gt=(H,te,ce)=>{if(!H)return-1;for(var le=ce;le<H.length;le++)if(H[le]===te)return le;return-1},At={typedArrayIndexOf:gt},en=At.typedArrayIndexOf,Nn={Iso88591:0,Utf16:1,Utf16be:2,Utf8:3},_n=function(H,te,ce){var le,ye="";for(le=te;le<ce;le++)ye+="%"+("00"+H[le].toString(16)).slice(-2);return ye},En=function(H,te,ce){return decodeURIComponent(_n(H,te,ce))},mr=function(H,te,ce){return unescape(_n(H,te,ce))},jn=function(H){return H[0]<<21|H[1]<<14|H[2]<<7|H[3]},Mt={APIC:function(H){var te=1,ce,le,ye="-->";H.data[0]===Nn.Utf8&&(ce=en(H.data,0,te),!(ce<0)&&(H.mimeType=mr(H.data,te,ce),te=ce+1,H.pictureType=H.data[te],te++,le=en(H.data,0,te),!(le<0)&&(H.description=En(H.data,te,le),te=le+1,H.mimeType===ye?H.url=mr(H.data,te,H.data.length):H.pictureData=H.data.subarray(te,H.data.length))))},"T*":function(H){H.data[0]===Nn.Utf8&&(H.value=En(H.data,1,H.data.length).replace(/\0*$/,""),H.values=H.value.split("\0"))},TXXX:function(H){var te;H.data[0]===Nn.Utf8&&(te=en(H.data,0,1),te!==-1&&(H.description=En(H.data,1,te),H.value=En(H.data,te+1,H.data.length).replace(/\0*$/,""),H.data=H.value))},"W*":function(H){H.url=mr(H.data,0,H.data.length).replace(/\0.*$/,"")},WXXX:function(H){var te;H.data[0]===Nn.Utf8&&(te=en(H.data,0,1),te!==-1&&(H.description=En(H.data,1,te),H.url=mr(H.data,te+1,H.data.length).replace(/\0.*$/,"")))},PRIV:function(H){var te;for(te=0;te<H.data.length;te++)if(H.data[te]===0){H.owner=mr(H.data,0,te);break}H.privateData=H.data.subarray(te+1),H.data=H.privateData}},gn=function(H){var te,ce,le=10,ye=0,be=[];if(!(H.length<10||H[0]!=="I".charCodeAt(0)||H[1]!=="D".charCodeAt(0)||H[2]!=="3".charCodeAt(0))){ye=jn(H.subarray(6,10)),ye+=10;var Ge=H[5]&64;Ge&&(le+=4,le+=jn(H.subarray(10,14)),ye-=jn(H.subarray(16,20)));do{if(te=jn(H.subarray(le+4,le+8)),te<1)break;ce=String.fromCharCode(H[le],H[le+1],H[le+2],H[le+3]);var Xe={id:ce,data:H.subarray(le+10,le+te+10)};Xe.key=Xe.id,Mt[Xe.id]?Mt[Xe.id](Xe):Xe.id[0]==="T"?Mt["T*"](Xe):Xe.id[0]==="W"&&Mt["W*"](Xe),be.push(Xe),le+=10,le+=te}while(le<ye);return be}},cn={parseId3Frames:gn,parseSyncSafeInteger:jn,frameParsers:Mt},tt=t,vt=sn,He=cn,ft;ft=function(H){var te={descriptor:H&&H.descriptor},ce=0,le=[],ye=0,be;if(ft.prototype.init.call(this),this.dispatchType=vt.METADATA_STREAM_TYPE.toString(16),te.descriptor)for(be=0;be<te.descriptor.length;be++)this.dispatchType+=("00"+te.descriptor[be].toString(16)).slice(-2);this.push=function(Ge){var Xe,Je,ot,_t,Bt,Sn;if(Ge.type==="timed-metadata"){if(Ge.dataAlignmentIndicator&&(ye=0,le.length=0),le.length===0&&(Ge.data.length<10||Ge.data[0]!=="I".charCodeAt(0)||Ge.data[1]!=="D".charCodeAt(0)||Ge.data[2]!=="3".charCodeAt(0))){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}if(le.push(Ge),ye+=Ge.data.byteLength,le.length===1&&(ce=He.parseSyncSafeInteger(Ge.data.subarray(6,10)),ce+=10),!(ye<ce)){for(Xe={data:new Uint8Array(ce),frames:[],pts:le[0].pts,dts:le[0].dts},Bt=0;Bt<ce;)Xe.data.set(le[0].data.subarray(0,ce-Bt),Bt),Bt+=le[0].data.byteLength,ye-=le[0].data.byteLength,le.shift();Je=10,Xe.data[5]&64&&(Je+=4,Je+=He.parseSyncSafeInteger(Xe.data.subarray(10,14)),ce-=He.parseSyncSafeInteger(Xe.data.subarray(16,20)));do{if(ot=He.parseSyncSafeInteger(Xe.data.subarray(Je+4,Je+8)),ot<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if(Sn=String.fromCharCode(Xe.data[Je],Xe.data[Je+1],Xe.data[Je+2],Xe.data[Je+3]),_t={id:Sn,data:Xe.data.subarray(Je+10,Je+ot+10)},_t.key=_t.id,He.frameParsers[_t.id]?He.frameParsers[_t.id](_t):_t.id[0]==="T"?He.frameParsers["T*"](_t):_t.id[0]==="W"&&He.frameParsers["W*"](_t),_t.owner==="com.apple.streaming.transportStreamTimestamp"){var tn=_t.data,Kn=(tn[3]&1)<<30|tn[4]<<22|tn[5]<<14|tn[6]<<6|tn[7]>>>2;Kn*=4,Kn+=tn[7]&3,_t.timeStamp=Kn,Xe.pts===void 0&&Xe.dts===void 0&&(Xe.pts=_t.timeStamp,Xe.dts=_t.timeStamp),this.trigger("timestamp",_t)}Xe.frames.push(_t),Je+=10,Je+=ot}while(Je<ce);this.trigger("data",Xe)}}}},ft.prototype=new tt;var $t=ft,vn=t,yn=Qt,On=sn,nr=et.TimestampRolloverStream,Un,Br,Mi,Bi=188,li=71;Un=function(){var H=new Uint8Array(Bi),te=0;Un.prototype.init.call(this),this.push=function(ce){var le=0,ye=Bi,be;for(te?(be=new Uint8Array(ce.byteLength+te),be.set(H.subarray(0,te)),be.set(ce,te),te=0):be=ce;ye<be.byteLength;){if(be[le]===li&&be[ye]===li){this.trigger("data",be.subarray(le,ye)),le+=Bi,ye+=Bi;continue}le++,ye++}le<be.byteLength&&(H.set(be.subarray(le),0),te=be.byteLength-le)},this.flush=function(){te===Bi&&H[0]===li&&(this.trigger("data",H),te=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){te=0,this.trigger("reset")}},Un.prototype=new vn,Br=function(){var H,te,ce,le;Br.prototype.init.call(this),le=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,H=function(ye,be){var Ge=0;be.payloadUnitStartIndicator&&(Ge+=ye[Ge]+1),be.type==="pat"?te(ye.subarray(Ge),be):ce(ye.subarray(Ge),be)},te=function(ye,be){be.section_number=ye[7],be.last_section_number=ye[8],le.pmtPid=(ye[10]&31)<<8|ye[11],be.pmtPid=le.pmtPid},ce=function(ye,be){var Ge,Xe,Je,ot;if(ye[5]&1){for(le.programMapTable={video:null,audio:null,"timed-metadata":{}},Ge=(ye[1]&15)<<8|ye[2],Xe=3+Ge-4,Je=(ye[10]&15)<<8|ye[11],ot=12+Je;ot<Xe;){var _t=ye[ot],Bt=(ye[ot+1]&31)<<8|ye[ot+2];_t===On.H264_STREAM_TYPE&&le.programMapTable.video===null?le.programMapTable.video=Bt:_t===On.ADTS_STREAM_TYPE&&le.programMapTable.audio===null?le.programMapTable.audio=Bt:_t===On.METADATA_STREAM_TYPE&&(le.programMapTable["timed-metadata"][Bt]=_t),ot+=((ye[ot+3]&15)<<8|ye[ot+4])+5}be.programMapTable=le.programMapTable}},this.push=function(ye){var be={},Ge=4;if(be.payloadUnitStartIndicator=!!(ye[1]&64),be.pid=ye[1]&31,be.pid<<=8,be.pid|=ye[2],(ye[3]&48)>>>4>1&&(Ge+=ye[Ge]+1),be.pid===0)be.type="pat",H(ye.subarray(Ge),be),this.trigger("data",be);else if(be.pid===this.pmtPid)for(be.type="pmt",H(ye.subarray(Ge),be),this.trigger("data",be);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([ye,Ge,be]):this.processPes_(ye,Ge,be)},this.processPes_=function(ye,be,Ge){Ge.pid===this.programMapTable.video?Ge.streamType=On.H264_STREAM_TYPE:Ge.pid===this.programMapTable.audio?Ge.streamType=On.ADTS_STREAM_TYPE:Ge.streamType=this.programMapTable["timed-metadata"][Ge.pid],Ge.type="pes",Ge.data=ye.subarray(be),this.trigger("data",Ge)}},Br.prototype=new vn,Br.STREAM_TYPES={h264:27,adts:15},Mi=function(){var H=this,te=!1,ce={data:[],size:0},le={data:[],size:0},ye={data:[],size:0},be,Ge=function(Je,ot){var _t;const Bt=Je[0]<<16|Je[1]<<8|Je[2];ot.data=new Uint8Array,Bt===1&&(ot.packetLength=6+(Je[4]<<8|Je[5]),ot.dataAlignmentIndicator=(Je[6]&4)!==0,_t=Je[7],_t&192&&(ot.pts=(Je[9]&14)<<27|(Je[10]&255)<<20|(Je[11]&254)<<12|(Je[12]&255)<<5|(Je[13]&254)>>>3,ot.pts*=4,ot.pts+=(Je[13]&6)>>>1,ot.dts=ot.pts,_t&64&&(ot.dts=(Je[14]&14)<<27|(Je[15]&255)<<20|(Je[16]&254)<<12|(Je[17]&255)<<5|(Je[18]&254)>>>3,ot.dts*=4,ot.dts+=(Je[18]&6)>>>1)),ot.data=Je.subarray(9+Je[8]))},Xe=function(Je,ot,_t){var Bt=new Uint8Array(Je.size),Sn={type:ot},tn=0,Kn=0,Vn=!1,Ri;if(!(!Je.data.length||Je.size<9)){for(Sn.trackId=Je.data[0].pid,tn=0;tn<Je.data.length;tn++)Ri=Je.data[tn],Bt.set(Ri.data,Kn),Kn+=Ri.data.byteLength;Ge(Bt,Sn),Vn=ot==="video"||Sn.packetLength<=Je.size,(_t||Vn)&&(Je.size=0,Je.data.length=0),Vn&&H.trigger("data",Sn)}};Mi.prototype.init.call(this),this.push=function(Je){({pat:function(){},pes:function(){var ot,_t;switch(Je.streamType){case On.H264_STREAM_TYPE:ot=ce,_t="video";break;case On.ADTS_STREAM_TYPE:ot=le,_t="audio";break;case On.METADATA_STREAM_TYPE:ot=ye,_t="timed-metadata";break;default:return}Je.payloadUnitStartIndicator&&Xe(ot,_t,!0),ot.data.push(Je),ot.size+=Je.data.byteLength},pmt:function(){var ot={type:"metadata",tracks:[]};be=Je.programMapTable,be.video!==null&&ot.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+be.video,codec:"avc",type:"video"}),be.audio!==null&&ot.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+be.audio,codec:"adts",type:"audio"}),te=!0,H.trigger("data",ot)}})[Je.type]()},this.reset=function(){ce.size=0,ce.data.length=0,le.size=0,le.data.length=0,this.trigger("reset")},this.flushStreams_=function(){Xe(ce,"video"),Xe(le,"audio"),Xe(ye,"timed-metadata")},this.flush=function(){if(!te&&be){var Je={type:"metadata",tracks:[]};be.video!==null&&Je.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+be.video,codec:"avc",type:"video"}),be.audio!==null&&Je.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+be.audio,codec:"adts",type:"audio"}),H.trigger("data",Je)}te=!1,this.flushStreams_(),this.trigger("done")}},Mi.prototype=new vn;var Xs={PAT_PID:0,MP2T_PACKET_LENGTH:Bi,TransportPacketStream:Un,TransportParseStream:Br,ElementaryStream:Mi,TimestampRolloverStream:nr,CaptionStream:yn.CaptionStream,Cea608Stream:yn.Cea608Stream,Cea708Stream:yn.Cea708Stream,MetadataStream:$t};for(var Sa in On)On.hasOwnProperty(Sa)&&(Xs[Sa]=On[Sa]);var Zo=Xs,bs=t,Aa=we.ONE_SECOND_IN_TS,Ds,qs=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];Ds=function(H){var te,ce=0;Ds.prototype.init.call(this),this.skipWarn_=function(le,ye){this.trigger("log",{level:"warn",message:`adts skiping bytes ${le} to ${ye} in frame ${ce} outside syncword`})},this.push=function(le){var ye=0,be,Ge,Xe,Je,ot;if(H||(ce=0),le.type==="audio"){te&&te.length?(Xe=te,te=new Uint8Array(Xe.byteLength+le.data.byteLength),te.set(Xe),te.set(le.data,Xe.byteLength)):te=le.data;for(var _t;ye+7<te.length;){if(te[ye]!==255||(te[ye+1]&246)!==240){typeof _t!="number"&&(_t=ye),ye++;continue}if(typeof _t=="number"&&(this.skipWarn_(_t,ye),_t=null),Ge=(~te[ye+1]&1)*2,be=(te[ye+3]&3)<<11|te[ye+4]<<3|(te[ye+5]&224)>>5,Je=((te[ye+6]&3)+1)*1024,ot=Je*Aa/qs[(te[ye+2]&60)>>>2],te.byteLength-ye<be)break;this.trigger("data",{pts:le.pts+ce*ot,dts:le.dts+ce*ot,sampleCount:Je,audioobjecttype:(te[ye+2]>>>6&3)+1,channelcount:(te[ye+2]&1)<<2|(te[ye+3]&192)>>>6,samplerate:qs[(te[ye+2]&60)>>>2],samplingfrequencyindex:(te[ye+2]&60)>>>2,samplesize:16,data:te.subarray(ye+7+Ge,ye+be)}),ce++,ye+=be}typeof _t=="number"&&(this.skipWarn_(_t,ye),_t=null),te=te.subarray(ye)}},this.flush=function(){ce=0,this.trigger("done")},this.reset=function(){te=void 0,this.trigger("reset")},this.endTimeline=function(){te=void 0,this.trigger("endedtimeline")}},Ds.prototype=new bs;var ji=Ds,Gl;Gl=function(H){var te=H.byteLength,ce=0,le=0;this.length=function(){return 8*te},this.bitsAvailable=function(){return 8*te+le},this.loadWord=function(){var ye=H.byteLength-te,be=new Uint8Array(4),Ge=Math.min(4,te);if(Ge===0)throw new Error("no bytes available");be.set(H.subarray(ye,ye+Ge)),ce=new DataView(be.buffer).getUint32(0),le=Ge*8,te-=Ge},this.skipBits=function(ye){var be;le>ye?(ce<<=ye,le-=ye):(ye-=le,be=Math.floor(ye/8),ye-=be*8,te-=be,this.loadWord(),ce<<=ye,le-=ye)},this.readBits=function(ye){var be=Math.min(le,ye),Ge=ce>>>32-be;return le-=be,le>0?ce<<=be:te>0&&this.loadWord(),be=ye-be,be>0?Ge<<be|this.readBits(be):Ge},this.skipLeadingZeros=function(){var ye;for(ye=0;ye<le;++ye)if(ce&2147483648>>>ye)return ce<<=ye,le-=ye,ye;return this.loadWord(),ye+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var ye=this.skipLeadingZeros();return this.readBits(ye+1)-1},this.readExpGolomb=function(){var ye=this.readUnsignedExpGolomb();return 1&ye?1+ye>>>1:-1*(ye>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var Eo=Gl,Wi=t,el=Eo,Hi,er,Ii;er=function(){var H=0,te,ce;er.prototype.init.call(this),this.push=function(le){var ye;ce?(ye=new Uint8Array(ce.byteLength+le.data.byteLength),ye.set(ce),ye.set(le.data,ce.byteLength),ce=ye):ce=le.data;for(var be=ce.byteLength;H<be-3;H++)if(ce[H+2]===1){te=H+5;break}for(;te<be;)switch(ce[te]){case 0:if(ce[te-1]!==0){te+=2;break}else if(ce[te-2]!==0){te++;break}H+3!==te-2&&this.trigger("data",ce.subarray(H+3,te-2));do te++;while(ce[te]!==1&&te<be);H=te-2,te+=3;break;case 1:if(ce[te-1]!==0||ce[te-2]!==0){te+=3;break}this.trigger("data",ce.subarray(H+3,te-2)),H=te-2,te+=3;break;default:te+=3;break}ce=ce.subarray(H),te-=H,H=0},this.reset=function(){ce=null,H=0,this.trigger("reset")},this.flush=function(){ce&&ce.byteLength>3&&this.trigger("data",ce.subarray(H+3)),ce=null,H=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},er.prototype=new Wi,Ii={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},Hi=function(){var H=new er,te,ce,le,ye,be,Ge,Xe;Hi.prototype.init.call(this),te=this,this.push=function(Je){Je.type==="video"&&(ce=Je.trackId,le=Je.pts,ye=Je.dts,H.push(Je))},H.on("data",function(Je){var ot={trackId:ce,pts:le,dts:ye,data:Je,nalUnitTypeCode:Je[0]&31};switch(ot.nalUnitTypeCode){case 5:ot.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:ot.nalUnitType="sei_rbsp",ot.escapedRBSP=be(Je.subarray(1));break;case 7:ot.nalUnitType="seq_parameter_set_rbsp",ot.escapedRBSP=be(Je.subarray(1)),ot.config=Ge(ot.escapedRBSP);break;case 8:ot.nalUnitType="pic_parameter_set_rbsp";break;case 9:ot.nalUnitType="access_unit_delimiter_rbsp";break}te.trigger("data",ot)}),H.on("done",function(){te.trigger("done")}),H.on("partialdone",function(){te.trigger("partialdone")}),H.on("reset",function(){te.trigger("reset")}),H.on("endedtimeline",function(){te.trigger("endedtimeline")}),this.flush=function(){H.flush()},this.partialFlush=function(){H.partialFlush()},this.reset=function(){H.reset()},this.endTimeline=function(){H.endTimeline()},Xe=function(Je,ot){var _t=8,Bt=8,Sn,tn;for(Sn=0;Sn<Je;Sn++)Bt!==0&&(tn=ot.readExpGolomb(),Bt=(_t+tn+256)%256),_t=Bt===0?_t:Bt},be=function(Je){for(var ot=Je.byteLength,_t=[],Bt=1,Sn,tn;Bt<ot-2;)Je[Bt]===0&&Je[Bt+1]===0&&Je[Bt+2]===3?(_t.push(Bt+2),Bt+=2):Bt++;if(_t.length===0)return Je;Sn=ot-_t.length,tn=new Uint8Array(Sn);var Kn=0;for(Bt=0;Bt<Sn;Kn++,Bt++)Kn===_t[0]&&(Kn++,_t.shift()),tn[Bt]=Je[Kn];return tn},Ge=function(Je){var ot=0,_t=0,Bt=0,Sn=0,tn,Kn,Vn,Ri,ws,ll,z0,Y0,X0,Sd,q0,gi=[1,1],Ad,eu;if(tn=new el(Je),Kn=tn.readUnsignedByte(),Ri=tn.readUnsignedByte(),Vn=tn.readUnsignedByte(),tn.skipUnsignedExpGolomb(),Ii[Kn]&&(ws=tn.readUnsignedExpGolomb(),ws===3&&tn.skipBits(1),tn.skipUnsignedExpGolomb(),tn.skipUnsignedExpGolomb(),tn.skipBits(1),tn.readBoolean()))for(q0=ws!==3?8:12,eu=0;eu<q0;eu++)tn.readBoolean()&&(eu<6?Xe(16,tn):Xe(64,tn));if(tn.skipUnsignedExpGolomb(),ll=tn.readUnsignedExpGolomb(),ll===0)tn.readUnsignedExpGolomb();else if(ll===1)for(tn.skipBits(1),tn.skipExpGolomb(),tn.skipExpGolomb(),z0=tn.readUnsignedExpGolomb(),eu=0;eu<z0;eu++)tn.skipExpGolomb();if(tn.skipUnsignedExpGolomb(),tn.skipBits(1),Y0=tn.readUnsignedExpGolomb(),X0=tn.readUnsignedExpGolomb(),Sd=tn.readBits(1),Sd===0&&tn.skipBits(1),tn.skipBits(1),tn.readBoolean()&&(ot=tn.readUnsignedExpGolomb(),_t=tn.readUnsignedExpGolomb(),Bt=tn.readUnsignedExpGolomb(),Sn=tn.readUnsignedExpGolomb()),tn.readBoolean()&&tn.readBoolean()){switch(Ad=tn.readUnsignedByte(),Ad){case 1:gi=[1,1];break;case 2:gi=[12,11];break;case 3:gi=[10,11];break;case 4:gi=[16,11];break;case 5:gi=[40,33];break;case 6:gi=[24,11];break;case 7:gi=[20,11];break;case 8:gi=[32,11];break;case 9:gi=[80,33];break;case 10:gi=[18,11];break;case 11:gi=[15,11];break;case 12:gi=[64,33];break;case 13:gi=[160,99];break;case 14:gi=[4,3];break;case 15:gi=[3,2];break;case 16:gi=[2,1];break;case 255:{gi=[tn.readUnsignedByte()<<8|tn.readUnsignedByte(),tn.readUnsignedByte()<<8|tn.readUnsignedByte()];break}}gi&&gi[0]/gi[1]}return{profileIdc:Kn,levelIdc:Vn,profileCompatibility:Ri,width:(Y0+1)*16-ot*2-_t*2,height:(2-Sd)*(X0+1)*16-Bt*2-Sn*2,sarRatio:gi}}},Hi.prototype=new Wi;var _o={H264Stream:Hi,NalByteStream:er},To=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],xa=function(H,te){var ce=H[te+6]<<21|H[te+7]<<14|H[te+8]<<7|H[te+9],le=H[te+5],ye=(le&16)>>4;return ce=ce>=0?ce:0,ye?ce+20:ce+10},at=function(H,te){return H.length-te<10||H[te]!=="I".charCodeAt(0)||H[te+1]!=="D".charCodeAt(0)||H[te+2]!=="3".charCodeAt(0)?te:(te+=xa(H,te),at(H,te))},Rt=function(H){var te=at(H,0);return H.length>=te+2&&(H[te]&255)===255&&(H[te+1]&240)===240&&(H[te+1]&22)===16},an=function(H){return H[0]<<21|H[1]<<14|H[2]<<7|H[3]},Rn=function(H,te,ce){var le,ye="";for(le=te;le<ce;le++)ye+="%"+("00"+H[le].toString(16)).slice(-2);return ye},Cn=function(H,te,ce){return unescape(Rn(H,te,ce))},Xn=function(H,te){var ce=(H[te+5]&224)>>5,le=H[te+4]<<3,ye=H[te+3]&3<<11;return ye|le|ce},ar=function(H,te){return H[te]==="I".charCodeAt(0)&&H[te+1]==="D".charCodeAt(0)&&H[te+2]==="3".charCodeAt(0)?"timed-metadata":H[te]&!0&&(H[te+1]&240)===240?"audio":null},hi=function(H){for(var te=0;te+5<H.length;){if(H[te]!==255||(H[te+1]&246)!==240){te++;continue}return To[(H[te+2]&60)>>>2]}return null},ti=function(H){var te,ce,le,ye;te=10,H[5]&64&&(te+=4,te+=an(H.subarray(10,14)));do{if(ce=an(H.subarray(te+4,te+8)),ce<1)return null;if(ye=String.fromCharCode(H[te],H[te+1],H[te+2],H[te+3]),ye==="PRIV"){le=H.subarray(te+10,te+ce+10);for(var be=0;be<le.byteLength;be++)if(le[be]===0){var Ge=Cn(le,0,be);if(Ge==="com.apple.streaming.transportStreamTimestamp"){var Xe=le.subarray(be+1),Je=(Xe[3]&1)<<30|Xe[4]<<22|Xe[5]<<14|Xe[6]<<6|Xe[7]>>>2;return Je*=4,Je+=Xe[7]&3,Je}break}}te+=10,te+=ce}while(te<H.byteLength);return null},qi={isLikelyAacData:Rt,parseId3TagSize:xa,parseAdtsSize:Xn,parseType:ar,parseSampleRate:hi,parseAacTimestamp:ti},Kr=t,Ca=qi,Ia;Ia=function(){var H=new Uint8Array,te=0;Ia.prototype.init.call(this),this.setTimestamp=function(ce){te=ce},this.push=function(ce){var le=0,ye=0,be,Ge,Xe,Je;for(H.length?(Je=H.length,H=new Uint8Array(ce.byteLength+Je),H.set(H.subarray(0,Je)),H.set(ce,Je)):H=ce;H.length-ye>=3;){if(H[ye]==="I".charCodeAt(0)&&H[ye+1]==="D".charCodeAt(0)&&H[ye+2]==="3".charCodeAt(0)){if(H.length-ye<10||(le=Ca.parseId3TagSize(H,ye),ye+le>H.length))break;Ge={type:"timed-metadata",data:H.subarray(ye,ye+le)},this.trigger("data",Ge),ye+=le;continue}else if((H[ye]&255)===255&&(H[ye+1]&240)===240){if(H.length-ye<7||(le=Ca.parseAdtsSize(H,ye),ye+le>H.length))break;Xe={type:"audio",data:H.subarray(ye,ye+le),pts:te,dts:te},this.trigger("data",Xe),ye+=le;continue}ye++}be=H.length-ye,be>0?H=H.subarray(ye):H=new Uint8Array},this.reset=function(){H=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){H=new Uint8Array,this.trigger("endedtimeline")}},Ia.prototype=new Kr;var Xa=Ia,zc=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Wl=zc,Hl=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],Yc=Hl,Vl=t,tl=Se,Ra=Re,Hu=st,ui=Et,Qi=Zo,Vi=we,ld=ji,ba=_o.H264Stream,$l=Xa,xp=qi.isLikelyAacData,Cp=we.ONE_SECOND_IN_TS,Vu=Wl,Xc=Yc,nl,So,Hr,Ps,kn=function(H,te){te.stream=H,this.trigger("log",te)},vs=function(H,te){for(var ce=Object.keys(te),le=0;le<ce.length;le++){var ye=ce[le];ye==="headOfPipeline"||!te[ye].on||te[ye].on("log",kn.bind(H,ye))}},Da=function(H,te){var ce;if(H.length!==te.length)return!1;for(ce=0;ce<H.length;ce++)if(H[ce]!==te[ce])return!1;return!0},Pa=function(H,te,ce,le,ye,be){var Ge=ce-te,Xe=le-te,Je=ye-ce;return{start:{dts:H,pts:H+Ge},end:{dts:H+Xe,pts:H+Je},prependedContentDuration:be,baseMediaDecodeTime:H}};So=function(H,te){var ce=[],le,ye=0,be=0,Ge=1/0;te=te||{},le=te.firstSequenceNumber||0,So.prototype.init.call(this),this.push=function(Xe){ui.collectDtsInfo(H,Xe),H&&Vu.forEach(function(Je){H[Je]=Xe[Je]}),ce.push(Xe)},this.setEarliestDts=function(Xe){ye=Xe},this.setVideoBaseMediaDecodeTime=function(Xe){Ge=Xe},this.setAudioAppendStart=function(Xe){be=Xe},this.flush=function(){var Xe,Je,ot,_t,Bt,Sn,tn;if(ce.length===0){this.trigger("done","AudioSegmentStream");return}Xe=Hu.trimAdtsFramesByEarliestDts(ce,H,ye),H.baseMediaDecodeTime=ui.calculateTrackBaseMediaDecodeTime(H,te.keepOriginalTimestamps),tn=Hu.prefixWithSilence(H,Xe,be,Ge),H.samples=Hu.generateSampleTable(Xe),ot=tl.mdat(Hu.concatenateFrameData(Xe)),ce=[],Je=tl.moof(le,[H]),_t=new Uint8Array(Je.byteLength+ot.byteLength),le++,_t.set(Je),_t.set(ot,Je.byteLength),ui.clearDtsInfo(H),Bt=Math.ceil(Cp*1024/H.samplerate),Xe.length&&(Sn=Xe.length*Bt,this.trigger("segmentTimingInfo",Pa(Vi.audioTsToVideoTs(H.baseMediaDecodeTime,H.samplerate),Xe[0].dts,Xe[0].pts,Xe[0].dts+Sn,Xe[0].pts+Sn,tn||0)),this.trigger("timingInfo",{start:Xe[0].pts,end:Xe[0].pts+Sn})),this.trigger("data",{track:H,boxes:_t}),this.trigger("done","AudioSegmentStream")},this.reset=function(){ui.clearDtsInfo(H),ce=[],this.trigger("reset")}},So.prototype=new Vl,nl=function(H,te){var ce,le=[],ye=[],be,Ge;te=te||{},ce=te.firstSequenceNumber||0,nl.prototype.init.call(this),delete H.minPTS,this.gopCache_=[],this.push=function(Xe){ui.collectDtsInfo(H,Xe),Xe.nalUnitType==="seq_parameter_set_rbsp"&&!be&&(be=Xe.config,H.sps=[Xe.data],Xc.forEach(function(Je){H[Je]=be[Je]},this)),Xe.nalUnitType==="pic_parameter_set_rbsp"&&!Ge&&(Ge=Xe.data,H.pps=[Xe.data]),le.push(Xe)},this.flush=function(){for(var Xe,Je,ot,_t,Bt,Sn,tn=0,Kn,Vn;le.length&&le[0].nalUnitType!=="access_unit_delimiter_rbsp";)le.shift();if(le.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(Xe=Ra.groupNalsIntoFrames(le),ot=Ra.groupFramesIntoGops(Xe),ot[0][0].keyFrame||(Je=this.getGopForFusion_(le[0],H),Je?(tn=Je.duration,ot.unshift(Je),ot.byteLength+=Je.byteLength,ot.nalCount+=Je.nalCount,ot.pts=Je.pts,ot.dts=Je.dts,ot.duration+=Je.duration):ot=Ra.extendFirstKeyFrame(ot)),ye.length){var Ri;if(te.alignGopsAtEnd?Ri=this.alignGopsAtEnd_(ot):Ri=this.alignGopsAtStart_(ot),!Ri){this.gopCache_.unshift({gop:ot.pop(),pps:H.pps,sps:H.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),le=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}ui.clearDtsInfo(H),ot=Ri}ui.collectDtsInfo(H,ot),H.samples=Ra.generateSampleTable(ot),Bt=tl.mdat(Ra.concatenateNalData(ot)),H.baseMediaDecodeTime=ui.calculateTrackBaseMediaDecodeTime(H,te.keepOriginalTimestamps),this.trigger("processedGopsInfo",ot.map(function(ws){return{pts:ws.pts,dts:ws.dts,byteLength:ws.byteLength}})),Kn=ot[0],Vn=ot[ot.length-1],this.trigger("segmentTimingInfo",Pa(H.baseMediaDecodeTime,Kn.dts,Kn.pts,Vn.dts+Vn.duration,Vn.pts+Vn.duration,tn)),this.trigger("timingInfo",{start:ot[0].pts,end:ot[ot.length-1].pts+ot[ot.length-1].duration}),this.gopCache_.unshift({gop:ot.pop(),pps:H.pps,sps:H.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),le=[],this.trigger("baseMediaDecodeTime",H.baseMediaDecodeTime),this.trigger("timelineStartInfo",H.timelineStartInfo),_t=tl.moof(ce,[H]),Sn=new Uint8Array(_t.byteLength+Bt.byteLength),ce++,Sn.set(_t),Sn.set(Bt,_t.byteLength),this.trigger("data",{track:H,boxes:Sn}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),le=[],this.gopCache_.length=0,ye.length=0,this.trigger("reset")},this.resetStream_=function(){ui.clearDtsInfo(H),be=void 0,Ge=void 0},this.getGopForFusion_=function(Xe){var Je=45e3,ot=1e4,_t=1/0,Bt,Sn,tn,Kn,Vn;for(Vn=0;Vn<this.gopCache_.length;Vn++)Kn=this.gopCache_[Vn],tn=Kn.gop,!(!(H.pps&&Da(H.pps[0],Kn.pps[0]))||!(H.sps&&Da(H.sps[0],Kn.sps[0])))&&(tn.dts<H.timelineStartInfo.dts||(Bt=Xe.dts-tn.dts-tn.duration,Bt>=-ot&&Bt<=Je&&(!Sn||_t>Bt)&&(Sn=Kn,_t=Bt)));return Sn?Sn.gop:null},this.alignGopsAtStart_=function(Xe){var Je,ot,_t,Bt,Sn,tn,Kn,Vn;for(Sn=Xe.byteLength,tn=Xe.nalCount,Kn=Xe.duration,Je=ot=0;Je<ye.length&&ot<Xe.length&&(_t=ye[Je],Bt=Xe[ot],_t.pts!==Bt.pts);){if(Bt.pts>_t.pts){Je++;continue}ot++,Sn-=Bt.byteLength,tn-=Bt.nalCount,Kn-=Bt.duration}return ot===0?Xe:ot===Xe.length?null:(Vn=Xe.slice(ot),Vn.byteLength=Sn,Vn.duration=Kn,Vn.nalCount=tn,Vn.pts=Vn[0].pts,Vn.dts=Vn[0].dts,Vn)},this.alignGopsAtEnd_=function(Xe){var Je,ot,_t,Bt,Sn,tn;for(Je=ye.length-1,ot=Xe.length-1,Sn=null,tn=!1;Je>=0&&ot>=0;){if(_t=ye[Je],Bt=Xe[ot],_t.pts===Bt.pts){tn=!0;break}if(_t.pts>Bt.pts){Je--;continue}Je===ye.length-1&&(Sn=ot),ot--}if(!tn&&Sn===null)return null;var Kn;if(tn?Kn=ot:Kn=Sn,Kn===0)return Xe;var Vn=Xe.slice(Kn),Ri=Vn.reduce(function(ws,ll){return ws.byteLength+=ll.byteLength,ws.duration+=ll.duration,ws.nalCount+=ll.nalCount,ws},{byteLength:0,duration:0,nalCount:0});return Vn.byteLength=Ri.byteLength,Vn.duration=Ri.duration,Vn.nalCount=Ri.nalCount,Vn.pts=Vn[0].pts,Vn.dts=Vn[0].dts,Vn},this.alignGopsWith=function(Xe){ye=Xe}},nl.prototype=new Vl,Ps=function(H,te){this.numberOfTracks=0,this.metadataStream=te,H=H||{},typeof H.remux<"u"?this.remuxTracks=!!H.remux:this.remuxTracks=!0,typeof H.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=H.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Ps.prototype.init.call(this),this.push=function(ce){if(ce.text)return this.pendingCaptions.push(ce);if(ce.frames)return this.pendingMetadata.push(ce);this.pendingTracks.push(ce.track),this.pendingBytes+=ce.boxes.byteLength,ce.track.type==="video"&&(this.videoTrack=ce.track,this.pendingBoxes.push(ce.boxes)),ce.track.type==="audio"&&(this.audioTrack=ce.track,this.pendingBoxes.unshift(ce.boxes))}},Ps.prototype=new Vl,Ps.prototype.flush=function(H){var te=0,ce={captions:[],captionStreams:{},metadata:[],info:{}},le,ye,be,Ge=0,Xe;if(this.pendingTracks.length<this.numberOfTracks){if(H!=="VideoSegmentStream"&&H!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?(Ge=this.videoTrack.timelineStartInfo.pts,Xc.forEach(function(Je){ce.info[Je]=this.videoTrack[Je]},this)):this.audioTrack&&(Ge=this.audioTrack.timelineStartInfo.pts,Vu.forEach(function(Je){ce.info[Je]=this.audioTrack[Je]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?ce.type=this.pendingTracks[0].type:ce.type="combined",this.emittedTracks+=this.pendingTracks.length,be=tl.initSegment(this.pendingTracks),ce.initSegment=new Uint8Array(be.byteLength),ce.initSegment.set(be),ce.data=new Uint8Array(this.pendingBytes),Xe=0;Xe<this.pendingBoxes.length;Xe++)ce.data.set(this.pendingBoxes[Xe],te),te+=this.pendingBoxes[Xe].byteLength;for(Xe=0;Xe<this.pendingCaptions.length;Xe++)le=this.pendingCaptions[Xe],le.startTime=Vi.metadataTsToSeconds(le.startPts,Ge,this.keepOriginalTimestamps),le.endTime=Vi.metadataTsToSeconds(le.endPts,Ge,this.keepOriginalTimestamps),ce.captionStreams[le.stream]=!0,ce.captions.push(le);for(Xe=0;Xe<this.pendingMetadata.length;Xe++)ye=this.pendingMetadata[Xe],ye.cueTime=Vi.metadataTsToSeconds(ye.pts,Ge,this.keepOriginalTimestamps),ce.metadata.push(ye);for(ce.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",ce),Xe=0;Xe<ce.captions.length;Xe++)le=ce.captions[Xe],this.trigger("caption",le);for(Xe=0;Xe<ce.metadata.length;Xe++)ye=ce.metadata[Xe],this.trigger("id3Frame",ye)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},Ps.prototype.setRemux=function(H){this.remuxTracks=H},Hr=function(H){var te=this,ce=!0,le,ye;Hr.prototype.init.call(this),H=H||{},this.baseMediaDecodeTime=H.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var be={};this.transmuxPipeline_=be,be.type="aac",be.metadataStream=new Qi.MetadataStream,be.aacStream=new $l,be.audioTimestampRolloverStream=new Qi.TimestampRolloverStream("audio"),be.timedMetadataTimestampRolloverStream=new Qi.TimestampRolloverStream("timed-metadata"),be.adtsStream=new ld,be.coalesceStream=new Ps(H,be.metadataStream),be.headOfPipeline=be.aacStream,be.aacStream.pipe(be.audioTimestampRolloverStream).pipe(be.adtsStream),be.aacStream.pipe(be.timedMetadataTimestampRolloverStream).pipe(be.metadataStream).pipe(be.coalesceStream),be.metadataStream.on("timestamp",function(Ge){be.aacStream.setTimestamp(Ge.timeStamp)}),be.aacStream.on("data",function(Ge){Ge.type!=="timed-metadata"&&Ge.type!=="audio"||be.audioSegmentStream||(ye=ye||{timelineStartInfo:{baseMediaDecodeTime:te.baseMediaDecodeTime},codec:"adts",type:"audio"},be.coalesceStream.numberOfTracks++,be.audioSegmentStream=new So(ye,H),be.audioSegmentStream.on("log",te.getLogTrigger_("audioSegmentStream")),be.audioSegmentStream.on("timingInfo",te.trigger.bind(te,"audioTimingInfo")),be.adtsStream.pipe(be.audioSegmentStream).pipe(be.coalesceStream),te.trigger("trackinfo",{hasAudio:!!ye,hasVideo:!!le}))}),be.coalesceStream.on("data",this.trigger.bind(this,"data")),be.coalesceStream.on("done",this.trigger.bind(this,"done")),vs(this,be)},this.setupTsPipeline=function(){var be={};this.transmuxPipeline_=be,be.type="ts",be.metadataStream=new Qi.MetadataStream,be.packetStream=new Qi.TransportPacketStream,be.parseStream=new Qi.TransportParseStream,be.elementaryStream=new Qi.ElementaryStream,be.timestampRolloverStream=new Qi.TimestampRolloverStream,be.adtsStream=new ld,be.h264Stream=new ba,be.captionStream=new Qi.CaptionStream(H),be.coalesceStream=new Ps(H,be.metadataStream),be.headOfPipeline=be.packetStream,be.packetStream.pipe(be.parseStream).pipe(be.elementaryStream).pipe(be.timestampRolloverStream),be.timestampRolloverStream.pipe(be.h264Stream),be.timestampRolloverStream.pipe(be.adtsStream),be.timestampRolloverStream.pipe(be.metadataStream).pipe(be.coalesceStream),be.h264Stream.pipe(be.captionStream).pipe(be.coalesceStream),be.elementaryStream.on("data",function(Ge){var Xe;if(Ge.type==="metadata"){for(Xe=Ge.tracks.length;Xe--;)!le&&Ge.tracks[Xe].type==="video"?(le=Ge.tracks[Xe],le.timelineStartInfo.baseMediaDecodeTime=te.baseMediaDecodeTime):!ye&&Ge.tracks[Xe].type==="audio"&&(ye=Ge.tracks[Xe],ye.timelineStartInfo.baseMediaDecodeTime=te.baseMediaDecodeTime);le&&!be.videoSegmentStream&&(be.coalesceStream.numberOfTracks++,be.videoSegmentStream=new nl(le,H),be.videoSegmentStream.on("log",te.getLogTrigger_("videoSegmentStream")),be.videoSegmentStream.on("timelineStartInfo",function(Je){ye&&!H.keepOriginalTimestamps&&(ye.timelineStartInfo=Je,be.audioSegmentStream.setEarliestDts(Je.dts-te.baseMediaDecodeTime))}),be.videoSegmentStream.on("processedGopsInfo",te.trigger.bind(te,"gopInfo")),be.videoSegmentStream.on("segmentTimingInfo",te.trigger.bind(te,"videoSegmentTimingInfo")),be.videoSegmentStream.on("baseMediaDecodeTime",function(Je){ye&&be.audioSegmentStream.setVideoBaseMediaDecodeTime(Je)}),be.videoSegmentStream.on("timingInfo",te.trigger.bind(te,"videoTimingInfo")),be.h264Stream.pipe(be.videoSegmentStream).pipe(be.coalesceStream)),ye&&!be.audioSegmentStream&&(be.coalesceStream.numberOfTracks++,be.audioSegmentStream=new So(ye,H),be.audioSegmentStream.on("log",te.getLogTrigger_("audioSegmentStream")),be.audioSegmentStream.on("timingInfo",te.trigger.bind(te,"audioTimingInfo")),be.audioSegmentStream.on("segmentTimingInfo",te.trigger.bind(te,"audioSegmentTimingInfo")),be.adtsStream.pipe(be.audioSegmentStream).pipe(be.coalesceStream)),te.trigger("trackinfo",{hasAudio:!!ye,hasVideo:!!le})}}),be.coalesceStream.on("data",this.trigger.bind(this,"data")),be.coalesceStream.on("id3Frame",function(Ge){Ge.dispatchType=be.metadataStream.dispatchType,te.trigger("id3Frame",Ge)}),be.coalesceStream.on("caption",this.trigger.bind(this,"caption")),be.coalesceStream.on("done",this.trigger.bind(this,"done")),vs(this,be)},this.setBaseMediaDecodeTime=function(be){var Ge=this.transmuxPipeline_;H.keepOriginalTimestamps||(this.baseMediaDecodeTime=be),ye&&(ye.timelineStartInfo.dts=void 0,ye.timelineStartInfo.pts=void 0,ui.clearDtsInfo(ye),Ge.audioTimestampRolloverStream&&Ge.audioTimestampRolloverStream.discontinuity()),le&&(Ge.videoSegmentStream&&(Ge.videoSegmentStream.gopCache_=[]),le.timelineStartInfo.dts=void 0,le.timelineStartInfo.pts=void 0,ui.clearDtsInfo(le),Ge.captionStream.reset()),Ge.timestampRolloverStream&&Ge.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(be){ye&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(be)},this.setRemux=function(be){var Ge=this.transmuxPipeline_;H.remux=be,Ge&&Ge.coalesceStream&&Ge.coalesceStream.setRemux(be)},this.alignGopsWith=function(be){le&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(be)},this.getLogTrigger_=function(be){var Ge=this;return function(Xe){Xe.stream=be,Ge.trigger("log",Xe)}},this.push=function(be){if(ce){var Ge=xp(be);Ge&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!Ge&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),ce=!1}this.transmuxPipeline_.headOfPipeline.push(be)},this.flush=function(){ce=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},Hr.prototype=new Vl;var zl={Transmuxer:Hr,VideoSegmentStream:nl,AudioSegmentStream:So,AUDIO_PROPERTIES:Vu,VIDEO_PROPERTIES:Xc,generateSegmentTimingInfo:Pa},Yl=function(H){return H>>>0},ud=function(H){return("00"+H.toString(16)).slice(-2)},pi={toUnsigned:Yl,toHexString:ud},cd=function(H){var te="";return te+=String.fromCharCode(H[0]),te+=String.fromCharCode(H[1]),te+=String.fromCharCode(H[2]),te+=String.fromCharCode(H[3]),te},Ao=cd,rl=pi.toUnsigned,fd=Ao,dd=function(H,te){var ce=[],le,ye,be,Ge,Xe;if(!te.length)return null;for(le=0;le<H.byteLength;)ye=rl(H[le]<<24|H[le+1]<<16|H[le+2]<<8|H[le+3]),be=fd(H.subarray(le+4,le+8)),Ge=ye>1?le+ye:H.byteLength,be===te[0]&&(te.length===1?ce.push(H.subarray(le+8,Ge)):(Xe=dd(H.subarray(le+8,Ge),te.slice(1)),Xe.length&&(ce=ce.concat(Xe)))),le=Ge;return ce},qc=dd,Ip=pi.toUnsigned,Qc=u.getUint64,Jc=function(H){var te={version:H[0],flags:new Uint8Array(H.subarray(1,4))};return te.version===1?te.baseMediaDecodeTime=Qc(H.subarray(4)):te.baseMediaDecodeTime=Ip(H[4]<<24|H[5]<<16|H[6]<<8|H[7]),te},hd=Jc,pd=function(H){return{isLeading:(H[0]&12)>>>2,dependsOn:H[0]&3,isDependedOn:(H[1]&192)>>>6,hasRedundancy:(H[1]&48)>>>4,paddingValue:(H[1]&14)>>>1,isNonSyncSample:H[1]&1,degradationPriority:H[2]<<8|H[3]}},gd=pd,Xl=gd,Zc=function(H){var te={version:H[0],flags:new Uint8Array(H.subarray(1,4)),samples:[]},ce=new DataView(H.buffer,H.byteOffset,H.byteLength),le=te.flags[2]&1,ye=te.flags[2]&4,be=te.flags[1]&1,Ge=te.flags[1]&2,Xe=te.flags[1]&4,Je=te.flags[1]&8,ot=ce.getUint32(4),_t=8,Bt;for(le&&(te.dataOffset=ce.getInt32(_t),_t+=4),ye&&ot&&(Bt={flags:Xl(H.subarray(_t,_t+4))},_t+=4,be&&(Bt.duration=ce.getUint32(_t),_t+=4),Ge&&(Bt.size=ce.getUint32(_t),_t+=4),Je&&(te.version===1?Bt.compositionTimeOffset=ce.getInt32(_t):Bt.compositionTimeOffset=ce.getUint32(_t),_t+=4),te.samples.push(Bt),ot--);ot--;)Bt={},be&&(Bt.duration=ce.getUint32(_t),_t+=4),Ge&&(Bt.size=ce.getUint32(_t),_t+=4),Xe&&(Bt.flags=Xl(H.subarray(_t,_t+4)),_t+=4),Je&&(te.version===1?Bt.compositionTimeOffset=ce.getInt32(_t):Bt.compositionTimeOffset=ce.getUint32(_t),_t+=4),te.samples.push(Bt);return te},ht=Zc,nn=function(H){var te=new DataView(H.buffer,H.byteOffset,H.byteLength),ce={version:H[0],flags:new Uint8Array(H.subarray(1,4)),trackId:te.getUint32(4)},le=ce.flags[2]&1,ye=ce.flags[2]&2,be=ce.flags[2]&8,Ge=ce.flags[2]&16,Xe=ce.flags[2]&32,Je=ce.flags[0]&65536,ot=ce.flags[0]&131072,_t;return _t=8,le&&(_t+=4,ce.baseDataOffset=te.getUint32(12),_t+=4),ye&&(ce.sampleDescriptionIndex=te.getUint32(_t),_t+=4),be&&(ce.defaultSampleDuration=te.getUint32(_t),_t+=4),Ge&&(ce.defaultSampleSize=te.getUint32(_t),_t+=4),Xe&&(ce.defaultSampleFlags=te.getUint32(_t)),Je&&(ce.durationIsEmpty=!0),!le&&ot&&(ce.baseDataOffsetIsMoof=!0),ce},Ln=nn,hr;typeof window<"u"?hr=window:typeof n<"u"?hr=n:typeof self<"u"?hr=self:hr={};var wr=hr,il=Ct.discardEmulationPreventionBytes,sl=Qt.CaptionStream,ef=qc,M0=hd,ql=ht,tf=Ln,Rp=wr,bp=function(H,te){for(var ce=H,le=0;le<te.length;le++){var ye=te[le];if(ce<ye.size)return ye;ce-=ye.size}return null},w0=function(H,te,ce){var le=new DataView(H.buffer,H.byteOffset,H.byteLength),ye={logs:[],seiNals:[]},be,Ge,Xe,Je;for(Ge=0;Ge+4<H.length;Ge+=Xe)if(Xe=le.getUint32(Ge),Ge+=4,!(Xe<=0))switch(H[Ge]&31){case 6:var ot=H.subarray(Ge+1,Ge+1+Xe),_t=bp(Ge,te);if(be={nalUnitType:"sei_rbsp",size:Xe,data:ot,escapedRBSP:il(ot),trackId:ce},_t)be.pts=_t.pts,be.dts=_t.dts,Je=_t;else if(Je)be.pts=Je.pts,be.dts=Je.dts;else{ye.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+Ge+" for trackId "+ce+". See mux.js#223."});break}ye.seiNals.push(be);break}return ye},md=function(H,te,ce){var le=te,ye=ce.defaultSampleDuration||0,be=ce.defaultSampleSize||0,Ge=ce.trackId,Xe=[];return H.forEach(function(Je){var ot=ql(Je),_t=ot.samples;_t.forEach(function(Bt){Bt.duration===void 0&&(Bt.duration=ye),Bt.size===void 0&&(Bt.size=be),Bt.trackId=Ge,Bt.dts=le,Bt.compositionTimeOffset===void 0&&(Bt.compositionTimeOffset=0),typeof le=="bigint"?(Bt.pts=le+Rp.BigInt(Bt.compositionTimeOffset),le+=Rp.BigInt(Bt.duration)):(Bt.pts=le+Bt.compositionTimeOffset,le+=Bt.duration)}),Xe=Xe.concat(_t)}),Xe},O0=function(H,te){var ce=ef(H,["moof","traf"]),le=ef(H,["mdat"]),ye={},be=[];return le.forEach(function(Ge,Xe){var Je=ce[Xe];be.push({mdat:Ge,traf:Je})}),be.forEach(function(Ge){var Xe=Ge.mdat,Je=Ge.traf,ot=ef(Je,["tfhd"]),_t=tf(ot[0]),Bt=_t.trackId,Sn=ef(Je,["tfdt"]),tn=Sn.length>0?M0(Sn[0]).baseMediaDecodeTime:0,Kn=ef(Je,["trun"]),Vn,Ri;te===Bt&&Kn.length>0&&(Vn=md(Kn,tn,_t),Ri=w0(Xe,Vn,Bt),ye[Bt]||(ye[Bt]={seiNals:[],logs:[]}),ye[Bt].seiNals=ye[Bt].seiNals.concat(Ri.seiNals),ye[Bt].logs=ye[Bt].logs.concat(Ri.logs))}),ye},nf=function(H,te,ce){var le;if(te===null)return null;le=O0(H,te);var ye=le[te]||{};return{seiNals:ye.seiNals,logs:ye.logs,timescale:ce}},yS=function(){var H=!1,te,ce,le,ye,be,Ge;this.isInitialized=function(){return H},this.init=function(Xe){te=new sl,H=!0,Ge=Xe?Xe.isPartial:!1,te.on("data",function(Je){Je.startTime=Je.startPts/ye,Je.endTime=Je.endPts/ye,be.captions.push(Je),be.captionStreams[Je.stream]=!0}),te.on("log",function(Je){be.logs.push(Je)})},this.isNewInit=function(Xe,Je){return Xe&&Xe.length===0||Je&&typeof Je=="object"&&Object.keys(Je).length===0?!1:le!==Xe[0]||ye!==Je[le]},this.parse=function(Xe,Je,ot){var _t;if(this.isInitialized()){if(!Je||!ot)return null;if(this.isNewInit(Je,ot))le=Je[0],ye=ot[le];else if(le===null||!ye)return ce.push(Xe),null}else return null;for(;ce.length>0;){var Bt=ce.shift();this.parse(Bt,Je,ot)}return _t=nf(Xe,le,ye),_t&&_t.logs&&(be.logs=be.logs.concat(_t.logs)),_t===null||!_t.seiNals?be.logs.length?{logs:be.logs,captions:[],captionStreams:[]}:null:(this.pushNals(_t.seiNals),this.flushStream(),be)},this.pushNals=function(Xe){if(!this.isInitialized()||!Xe||Xe.length===0)return null;Xe.forEach(function(Je){te.push(Je)})},this.flushStream=function(){if(!this.isInitialized())return null;Ge?te.partialFlush():te.flush()},this.clearParsedCaptions=function(){be.captions=[],be.captionStreams={},be.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;te.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){ce=[],le=null,ye=null,be?this.clearParsedCaptions():be={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},N0=yS,Dp=function(H){for(var te=0,ce=String.fromCharCode(H[te]),le="";ce!=="\0";)le+=ce,te++,ce=String.fromCharCode(H[te]);return le+=ce,le},F0={uint8ToCString:Dp},rf=F0.uint8ToCString,k0=u.getUint64,ES=function(H){var te=4,ce=H[0],le,ye,be,Ge,Xe,Je,ot,_t;if(ce===0){le=rf(H.subarray(te)),te+=le.length,ye=rf(H.subarray(te)),te+=ye.length;var Bt=new DataView(H.buffer);be=Bt.getUint32(te),te+=4,Xe=Bt.getUint32(te),te+=4,Je=Bt.getUint32(te),te+=4,ot=Bt.getUint32(te),te+=4}else if(ce===1){var Bt=new DataView(H.buffer);be=Bt.getUint32(te),te+=4,Ge=k0(H.subarray(te)),te+=8,Je=Bt.getUint32(te),te+=4,ot=Bt.getUint32(te),te+=4,le=rf(H.subarray(te)),te+=le.length,ye=rf(H.subarray(te)),te+=ye.length}_t=new Uint8Array(H.subarray(te,H.byteLength));var Sn={scheme_id_uri:le,value:ye,timescale:be||1,presentation_time:Ge,presentation_time_delta:Xe,event_duration:Je,id:ot,message_data:_t};return TS(ce,Sn)?Sn:void 0},_S=function(H,te,ce,le){return H||H===0?H/te:le+ce/te},TS=function(H,te){var ce=te.scheme_id_uri!=="\0",le=H===0&&U0(te.presentation_time_delta)&&ce,ye=H===1&&U0(te.presentation_time)&&ce;return!(H>1)&&le||ye},U0=function(H){return H!==void 0||H!==null},ni={parseEmsgBox:ES,scaleTime:_S},sf=pi.toUnsigned,$u=pi.toHexString,Vr=qc,al=Ao,vd=ni,B0=Ln,j0=ht,zu=hd,SS=u.getUint64,K0,G0,W0,Pp,Ql,Yu,Lp,yd=wr,Xu=cn.parseId3Frames;K0=function(H){var te={},ce=Vr(H,["moov","trak"]);return ce.reduce(function(le,ye){var be,Ge,Xe,Je,ot;return be=Vr(ye,["tkhd"])[0],!be||(Ge=be[0],Xe=Ge===0?12:20,Je=sf(be[Xe]<<24|be[Xe+1]<<16|be[Xe+2]<<8|be[Xe+3]),ot=Vr(ye,["mdia","mdhd"])[0],!ot)?null:(Ge=ot[0],Xe=Ge===0?12:20,le[Je]=sf(ot[Xe]<<24|ot[Xe+1]<<16|ot[Xe+2]<<8|ot[Xe+3]),le)},te)},G0=function(H,te){var ce;ce=Vr(te,["moof","traf"]);var le=ce.reduce(function(ye,be){var Ge=Vr(be,["tfhd"])[0],Xe=sf(Ge[4]<<24|Ge[5]<<16|Ge[6]<<8|Ge[7]),Je=H[Xe]||9e4,ot=Vr(be,["tfdt"])[0],_t=new DataView(ot.buffer,ot.byteOffset,ot.byteLength),Bt;ot[0]===1?Bt=SS(ot.subarray(4,12)):Bt=_t.getUint32(4);let Sn;return typeof Bt=="bigint"?Sn=Bt/yd.BigInt(Je):typeof Bt=="number"&&!isNaN(Bt)&&(Sn=Bt/Je),Sn<Number.MAX_SAFE_INTEGER&&(Sn=Number(Sn)),Sn<ye&&(ye=Sn),ye},1/0);return typeof le=="bigint"||isFinite(le)?le:0},W0=function(H,te){var ce=Vr(te,["moof","traf"]),le=0,ye=0,be;if(ce&&ce.length){var Ge=Vr(ce[0],["tfhd"])[0],Xe=Vr(ce[0],["trun"])[0],Je=Vr(ce[0],["tfdt"])[0];if(Ge){var ot=B0(Ge);be=ot.trackId}if(Je){var _t=zu(Je);le=_t.baseMediaDecodeTime}if(Xe){var Bt=j0(Xe);Bt.samples&&Bt.samples.length&&(ye=Bt.samples[0].compositionTimeOffset||0)}}var Sn=H[be]||9e4;typeof le=="bigint"&&(ye=yd.BigInt(ye),Sn=yd.BigInt(Sn));var tn=(le+ye)/Sn;return typeof tn=="bigint"&&tn<Number.MAX_SAFE_INTEGER&&(tn=Number(tn)),tn},Pp=function(H){var te=Vr(H,["moov","trak"]),ce=[];return te.forEach(function(le){var ye=Vr(le,["mdia","hdlr"]),be=Vr(le,["tkhd"]);ye.forEach(function(Ge,Xe){var Je=al(Ge.subarray(8,12)),ot=be[Xe],_t,Bt,Sn;Je==="vide"&&(_t=new DataView(ot.buffer,ot.byteOffset,ot.byteLength),Bt=_t.getUint8(0),Sn=Bt===0?_t.getUint32(12):_t.getUint32(20),ce.push(Sn))})}),ce},Yu=function(H){var te=H[0],ce=te===0?12:20;return sf(H[ce]<<24|H[ce+1]<<16|H[ce+2]<<8|H[ce+3])},Ql=function(H){var te=Vr(H,["moov","trak"]),ce=[];return te.forEach(function(le){var ye={},be=Vr(le,["tkhd"])[0],Ge,Xe;be&&(Ge=new DataView(be.buffer,be.byteOffset,be.byteLength),Xe=Ge.getUint8(0),ye.id=Xe===0?Ge.getUint32(12):Ge.getUint32(20));var Je=Vr(le,["mdia","hdlr"])[0];if(Je){var ot=al(Je.subarray(8,12));ot==="vide"?ye.type="video":ot==="soun"?ye.type="audio":ye.type=ot}var _t=Vr(le,["mdia","minf","stbl","stsd"])[0];if(_t){var Bt=_t.subarray(8);ye.codec=al(Bt.subarray(4,8));var Sn=Vr(Bt,[ye.codec])[0],tn,Kn;Sn&&(/^[asm]vc[1-9]$/i.test(ye.codec)?(tn=Sn.subarray(78),Kn=al(tn.subarray(4,8)),Kn==="avcC"&&tn.length>11?(ye.codec+=".",ye.codec+=$u(tn[9]),ye.codec+=$u(tn[10]),ye.codec+=$u(tn[11])):ye.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(ye.codec)?(tn=Sn.subarray(28),Kn=al(tn.subarray(4,8)),Kn==="esds"&&tn.length>20&&tn[19]!==0?(ye.codec+="."+$u(tn[19]),ye.codec+="."+$u(tn[20]>>>2&63).replace(/^0/,"")):ye.codec="mp4a.40.2"):ye.codec=ye.codec.toLowerCase())}var Vn=Vr(le,["mdia","mdhd"])[0];Vn&&(ye.timescale=Yu(Vn)),ce.push(ye)}),ce},Lp=function(H,te=0){var ce=Vr(H,["emsg"]);return ce.map(le=>{var ye=vd.parseEmsgBox(new Uint8Array(le)),be=Xu(ye.message_data);return{cueTime:vd.scaleTime(ye.presentation_time,ye.timescale,ye.presentation_time_delta,te),duration:vd.scaleTime(ye.event_duration,ye.timescale),frames:be}})};var Dr={findBox:Vr,parseType:al,timescale:K0,startTime:G0,compositionStartTime:W0,videoTrackIds:Pp,tracks:Ql,getTimescaleFromMediaHeader:Yu,getEmsgID3:Lp},xo=sn,Ed=function(H){var te=H[1]&31;return te<<=8,te|=H[2],te},Co=function(H){return!!(H[1]&64)},Ls=function(H){var te=0;return(H[3]&48)>>>4>1&&(te+=H[4]+1),te},H0=function(H,te){var ce=Ed(H);return ce===0?"pat":ce===te?"pmt":te?"pes":null},AS=function(H){var te=Co(H),ce=4+Ls(H);return te&&(ce+=H[ce]+1),(H[ce+10]&31)<<8|H[ce+11]},qu=function(H){var te={},ce=Co(H),le=4+Ls(H);if(ce&&(le+=H[le]+1),!!(H[le+5]&1)){var ye,be,Ge;ye=(H[le+1]&15)<<8|H[le+2],be=3+ye-4,Ge=(H[le+10]&15)<<8|H[le+11];for(var Xe=12+Ge;Xe<be;){var Je=le+Xe;te[(H[Je+1]&31)<<8|H[Je+2]]=H[Je],Xe+=((H[Je+3]&15)<<8|H[Je+4])+5}return te}},V0=function(H,te){var ce=Ed(H),le=te[ce];switch(le){case xo.H264_STREAM_TYPE:return"video";case xo.ADTS_STREAM_TYPE:return"audio";case xo.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},_d=function(H){var te=Co(H);if(!te)return null;var ce=4+Ls(H);if(ce>=H.byteLength)return null;var le=null,ye;return ye=H[ce+7],ye&192&&(le={},le.pts=(H[ce+9]&14)<<27|(H[ce+10]&255)<<20|(H[ce+11]&254)<<12|(H[ce+12]&255)<<5|(H[ce+13]&254)>>>3,le.pts*=4,le.pts+=(H[ce+13]&6)>>>1,le.dts=le.pts,ye&64&&(le.dts=(H[ce+14]&14)<<27|(H[ce+15]&255)<<20|(H[ce+16]&254)<<12|(H[ce+17]&255)<<5|(H[ce+18]&254)>>>3,le.dts*=4,le.dts+=(H[ce+18]&6)>>>1)),le},ol=function(H){switch(H){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},Tr=function(H){for(var te=4+Ls(H),ce=H.subarray(te),le=0,ye=0,be=!1,Ge;ye<ce.byteLength-3;ye++)if(ce[ye+2]===1){le=ye+5;break}for(;le<ce.byteLength;)switch(ce[le]){case 0:if(ce[le-1]!==0){le+=2;break}else if(ce[le-2]!==0){le++;break}ye+3!==le-2&&(Ge=ol(ce[ye+3]&31),Ge==="slice_layer_without_partitioning_rbsp_idr"&&(be=!0));do le++;while(ce[le]!==1&&le<ce.length);ye=le-2,le+=3;break;case 1:if(ce[le-1]!==0||ce[le-2]!==0){le+=3;break}Ge=ol(ce[ye+3]&31),Ge==="slice_layer_without_partitioning_rbsp_idr"&&(be=!0),ye=le-2,le+=3;break;default:le+=3;break}return ce=ce.subarray(ye),le-=ye,ye=0,ce&&ce.byteLength>3&&(Ge=ol(ce[ye+3]&31),Ge==="slice_layer_without_partitioning_rbsp_idr"&&(be=!0)),be},Io={parseType:H0,parsePat:AS,parsePmt:qu,parsePayloadUnitStartIndicator:Co,parsePesType:V0,parsePesTime:_d,videoPacketContainsKeyFrame:Tr},Qs=sn,Qu=et.handleRollover,Ir={};Ir.ts=Io,Ir.aac=qi;var Jl=we.ONE_SECOND_IN_TS,Ji=188,Ms=71,Ro=function(H,te){for(var ce=0,le=Ji,ye,be;le<H.byteLength;){if(H[ce]===Ms&&H[le]===Ms){switch(ye=H.subarray(ce,le),be=Ir.ts.parseType(ye,te.pid),be){case"pat":te.pid=Ir.ts.parsePat(ye);break;case"pmt":var Ge=Ir.ts.parsePmt(ye);te.table=te.table||{},Object.keys(Ge).forEach(function(Xe){te.table[Xe]=Ge[Xe]});break}ce+=Ji,le+=Ji;continue}ce++,le++}},Mp=function(H,te,ce){for(var le=0,ye=Ji,be,Ge,Xe,Je,ot,_t=!1;ye<=H.byteLength;){if(H[le]===Ms&&(H[ye]===Ms||ye===H.byteLength)){switch(be=H.subarray(le,ye),Ge=Ir.ts.parseType(be,te.pid),Ge){case"pes":Xe=Ir.ts.parsePesType(be,te.table),Je=Ir.ts.parsePayloadUnitStartIndicator(be),Xe==="audio"&&Je&&(ot=Ir.ts.parsePesTime(be),ot&&(ot.type="audio",ce.audio.push(ot),_t=!0));break}if(_t)break;le+=Ji,ye+=Ji;continue}le++,ye++}for(ye=H.byteLength,le=ye-Ji,_t=!1;le>=0;){if(H[le]===Ms&&(H[ye]===Ms||ye===H.byteLength)){switch(be=H.subarray(le,ye),Ge=Ir.ts.parseType(be,te.pid),Ge){case"pes":Xe=Ir.ts.parsePesType(be,te.table),Je=Ir.ts.parsePayloadUnitStartIndicator(be),Xe==="audio"&&Je&&(ot=Ir.ts.parsePesTime(be),ot&&(ot.type="audio",ce.audio.push(ot),_t=!0));break}if(_t)break;le-=Ji,ye-=Ji;continue}le--,ye--}},Td=function(H,te,ce){for(var le=0,ye=Ji,be,Ge,Xe,Je,ot,_t,Bt,Sn,tn=!1,Kn={data:[],size:0};ye<H.byteLength;){if(H[le]===Ms&&H[ye]===Ms){switch(be=H.subarray(le,ye),Ge=Ir.ts.parseType(be,te.pid),Ge){case"pes":if(Xe=Ir.ts.parsePesType(be,te.table),Je=Ir.ts.parsePayloadUnitStartIndicator(be),Xe==="video"&&(Je&&!tn&&(ot=Ir.ts.parsePesTime(be),ot&&(ot.type="video",ce.video.push(ot),tn=!0)),!ce.firstKeyFrame)){if(Je&&Kn.size!==0){for(_t=new Uint8Array(Kn.size),Bt=0;Kn.data.length;)Sn=Kn.data.shift(),_t.set(Sn,Bt),Bt+=Sn.byteLength;if(Ir.ts.videoPacketContainsKeyFrame(_t)){var Vn=Ir.ts.parsePesTime(_t);Vn?(ce.firstKeyFrame=Vn,ce.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}Kn.size=0}Kn.data.push(be),Kn.size+=be.byteLength}break}if(tn&&ce.firstKeyFrame)break;le+=Ji,ye+=Ji;continue}le++,ye++}for(ye=H.byteLength,le=ye-Ji,tn=!1;le>=0;){if(H[le]===Ms&&H[ye]===Ms){switch(be=H.subarray(le,ye),Ge=Ir.ts.parseType(be,te.pid),Ge){case"pes":Xe=Ir.ts.parsePesType(be,te.table),Je=Ir.ts.parsePayloadUnitStartIndicator(be),Xe==="video"&&Je&&(ot=Ir.ts.parsePesTime(be),ot&&(ot.type="video",ce.video.push(ot),tn=!0));break}if(tn)break;le-=Ji,ye-=Ji;continue}le--,ye--}},Zl=function(H,te){if(H.audio&&H.audio.length){var ce=te;(typeof ce>"u"||isNaN(ce))&&(ce=H.audio[0].dts),H.audio.forEach(function(be){be.dts=Qu(be.dts,ce),be.pts=Qu(be.pts,ce),be.dtsTime=be.dts/Jl,be.ptsTime=be.pts/Jl})}if(H.video&&H.video.length){var le=te;if((typeof le>"u"||isNaN(le))&&(le=H.video[0].dts),H.video.forEach(function(be){be.dts=Qu(be.dts,le),be.pts=Qu(be.pts,le),be.dtsTime=be.dts/Jl,be.ptsTime=be.pts/Jl}),H.firstKeyFrame){var ye=H.firstKeyFrame;ye.dts=Qu(ye.dts,le),ye.pts=Qu(ye.pts,le),ye.dtsTime=ye.dts/Jl,ye.ptsTime=ye.pts/Jl}}},Pr=function(H){for(var te=!1,ce=0,le=null,ye=null,be=0,Ge=0,Xe;H.length-Ge>=3;){var Je=Ir.aac.parseType(H,Ge);switch(Je){case"timed-metadata":if(H.length-Ge<10){te=!0;break}if(be=Ir.aac.parseId3TagSize(H,Ge),be>H.length){te=!0;break}ye===null&&(Xe=H.subarray(Ge,Ge+be),ye=Ir.aac.parseAacTimestamp(Xe)),Ge+=be;break;case"audio":if(H.length-Ge<7){te=!0;break}if(be=Ir.aac.parseAdtsSize(H,Ge),be>H.length){te=!0;break}le===null&&(Xe=H.subarray(Ge,Ge+be),le=Ir.aac.parseSampleRate(Xe)),ce++,Ge+=be;break;default:Ge++;break}if(te)return null}if(le===null||ye===null)return null;var ot=Jl/le,_t={audio:[{type:"audio",dts:ye,pts:ye},{type:"audio",dts:ye+ce*1024*ot,pts:ye+ce*1024*ot}]};return _t},_r=function(H){var te={pid:null,table:null},ce={};Ro(H,te);for(var le in te.table)if(te.table.hasOwnProperty(le)){var ye=te.table[le];switch(ye){case Qs.H264_STREAM_TYPE:ce.video=[],Td(H,te,ce),ce.video.length===0&&delete ce.video;break;case Qs.ADTS_STREAM_TYPE:ce.audio=[],Mp(H,te,ce),ce.audio.length===0&&delete ce.audio;break}}return ce},$0=function(H,te){var ce=Ir.aac.isLikelyAacData(H),le;return ce?le=Pr(H):le=_r(H),!le||!le.audio&&!le.video?null:(Zl(le,te),le)},xS={inspect:$0,parseAudioPes_:Mp};const CS=function(H,te){te.on("data",function(ce){const le=ce.initSegment;ce.initSegment={data:le.buffer,byteOffset:le.byteOffset,byteLength:le.byteLength};const ye=ce.data;ce.data=ye.buffer,H.postMessage({action:"data",segment:ce,byteOffset:ye.byteOffset,byteLength:ye.byteLength},[ce.data])}),te.on("done",function(ce){H.postMessage({action:"done"})}),te.on("gopInfo",function(ce){H.postMessage({action:"gopInfo",gopInfo:ce})}),te.on("videoSegmentTimingInfo",function(ce){const le={start:{decode:we.videoTsToSeconds(ce.start.dts),presentation:we.videoTsToSeconds(ce.start.pts)},end:{decode:we.videoTsToSeconds(ce.end.dts),presentation:we.videoTsToSeconds(ce.end.pts)},baseMediaDecodeTime:we.videoTsToSeconds(ce.baseMediaDecodeTime)};ce.prependedContentDuration&&(le.prependedContentDuration=we.videoTsToSeconds(ce.prependedContentDuration)),H.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:le})}),te.on("audioSegmentTimingInfo",function(ce){const le={start:{decode:we.videoTsToSeconds(ce.start.dts),presentation:we.videoTsToSeconds(ce.start.pts)},end:{decode:we.videoTsToSeconds(ce.end.dts),presentation:we.videoTsToSeconds(ce.end.pts)},baseMediaDecodeTime:we.videoTsToSeconds(ce.baseMediaDecodeTime)};ce.prependedContentDuration&&(le.prependedContentDuration=we.videoTsToSeconds(ce.prependedContentDuration)),H.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:le})}),te.on("id3Frame",function(ce){H.postMessage({action:"id3Frame",id3Frame:ce})}),te.on("caption",function(ce){H.postMessage({action:"caption",caption:ce})}),te.on("trackinfo",function(ce){H.postMessage({action:"trackinfo",trackInfo:ce})}),te.on("audioTimingInfo",function(ce){H.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:we.videoTsToSeconds(ce.start),end:we.videoTsToSeconds(ce.end)}})}),te.on("videoTimingInfo",function(ce){H.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:we.videoTsToSeconds(ce.start),end:we.videoTsToSeconds(ce.end)}})}),te.on("log",function(ce){H.postMessage({action:"log",log:ce})})};class wp{constructor(te,ce){this.options=ce||{},this.self=te,this.init()}init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new zl.Transmuxer(this.options),CS(this.self,this.transmuxer)}pushMp4Captions(te){this.captionParser||(this.captionParser=new N0,this.captionParser.init());const ce=new Uint8Array(te.data,te.byteOffset,te.byteLength),le=this.captionParser.parse(ce,te.trackIds,te.timescales);this.self.postMessage({action:"mp4Captions",captions:le&&le.captions||[],logs:le&&le.logs||[],data:ce.buffer},[ce.buffer])}probeMp4StartTime({timescales:te,data:ce}){const le=Dr.startTime(te,ce);this.self.postMessage({action:"probeMp4StartTime",startTime:le,data:ce},[ce.buffer])}probeMp4Tracks({data:te}){const ce=Dr.tracks(te);this.self.postMessage({action:"probeMp4Tracks",tracks:ce,data:te},[te.buffer])}probeTs({data:te,baseStartTime:ce}){const le=typeof ce=="number"&&!isNaN(ce)?ce*we.ONE_SECOND_IN_TS:void 0,ye=xS.inspect(te,le);let be=null;ye&&(be={hasVideo:ye.video&&ye.video.length===2||!1,hasAudio:ye.audio&&ye.audio.length===2||!1},be.hasVideo&&(be.videoStart=ye.video[0].ptsTime),be.hasAudio&&(be.audioStart=ye.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:be,data:te},[te.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(te){const ce=new Uint8Array(te.data,te.byteOffset,te.byteLength);this.transmuxer.push(ce)}reset(){this.transmuxer.reset()}setTimestampOffset(te){const ce=te.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(we.secondsToVideoTs(ce)))}setAudioAppendStart(te){this.transmuxer.setAudioAppendStart(Math.ceil(we.secondsToVideoTs(te.appendStart)))}setRemux(te){this.transmuxer.setRemux(te.remux)}flush(te){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(te){this.transmuxer.alignGopsWith(te.gopsToAlignWith.slice())}}self.onmessage=function(H){if(H.data.action==="init"&&H.data.options){this.messageHandlers=new wp(self,H.data.options);return}this.messageHandlers||(this.messageHandlers=new wp(self)),H.data&&H.data.action&&H.data.action!=="init"&&this.messageHandlers[H.data.action]&&this.messageHandlers[H.data.action](H.data)}}));var Vse=OG(Hse);const $se=(n,e,t)=>{const{type:r,initSegment:o,captions:u,captionStreams:h,metadata:f,videoFrameDtsTime:d,videoFramePtsTime:m}=n.data.segment;e.buffer.push({captions:u,captionStreams:h,metadata:f});const g=n.data.segment.boxes||{data:n.data.segment.data},v={type:r,data:new Uint8Array(g.data,g.data.byteOffset,g.data.byteLength),initSegment:new Uint8Array(o.data,o.byteOffset,o.byteLength)};typeof d<"u"&&(v.videoFrameDtsTime=d),typeof m<"u"&&(v.videoFramePtsTime=m),t(v)},zse=({transmuxedData:n,callback:e})=>{n.buffer=[],e(n)},Yse=(n,e)=>{e.gopInfo=n.data.gopInfo},kG=n=>{const{transmuxer:e,bytes:t,audioAppendStart:r,gopsToAlignWith:o,remux:u,onData:h,onTrackInfo:f,onAudioTimingInfo:d,onVideoTimingInfo:m,onVideoSegmentTimingInfo:g,onAudioSegmentTimingInfo:v,onId3:_,onCaptions:S,onDone:E,onEndedTimeline:T,onTransmuxerLog:C,isEndOfTimeline:R}=n,b={buffer:[]};let F=R;const O=L=>{e.currentTransmux===n&&(L.data.action==="data"&&$se(L,b,h),L.data.action==="trackinfo"&&f(L.data.trackInfo),L.data.action==="gopInfo"&&Yse(L,b),L.data.action==="audioTimingInfo"&&d(L.data.audioTimingInfo),L.data.action==="videoTimingInfo"&&m(L.data.videoTimingInfo),L.data.action==="videoSegmentTimingInfo"&&g(L.data.videoSegmentTimingInfo),L.data.action==="audioSegmentTimingInfo"&&v(L.data.audioSegmentTimingInfo),L.data.action==="id3Frame"&&_([L.data.id3Frame],L.data.id3Frame.dispatchType),L.data.action==="caption"&&S(L.data.caption),L.data.action==="endedtimeline"&&(F=!1,T()),L.data.action==="log"&&C(L.data.log),L.data.type==="transmuxed"&&(F||(e.onmessage=null,zse({transmuxedData:b,callback:E}),UG(e))))};if(e.onmessage=O,r&&e.postMessage({action:"setAudioAppendStart",appendStart:r}),Array.isArray(o)&&e.postMessage({action:"alignGopsWith",gopsToAlignWith:o}),typeof u<"u"&&e.postMessage({action:"setRemux",remux:u}),t.byteLength){const L=t instanceof ArrayBuffer?t:t.buffer,D=t instanceof ArrayBuffer?0:t.byteOffset;e.postMessage({action:"push",data:L,byteOffset:D,byteLength:t.byteLength},[L])}R&&e.postMessage({action:"endTimeline"}),e.postMessage({action:"flush"})},UG=n=>{n.currentTransmux=null,n.transmuxQueue.length&&(n.currentTransmux=n.transmuxQueue.shift(),typeof n.currentTransmux=="function"?n.currentTransmux():kG(n.currentTransmux))},Z2=(n,e)=>{n.postMessage({action:e}),UG(n)},BG=(n,e)=>{if(!e.currentTransmux){e.currentTransmux=n,Z2(e,n);return}e.transmuxQueue.push(Z2.bind(null,e,n))},Xse=n=>{BG("reset",n)},qse=n=>{BG("endTimeline",n)},jG=n=>{if(!n.transmuxer.currentTransmux){n.transmuxer.currentTransmux=n,kG(n);return}n.transmuxer.transmuxQueue.push(n)},Qse=n=>{const e=new Vse;e.currentTransmux=null,e.transmuxQueue=[];const t=e.terminate;return e.terminate=()=>(e.currentTransmux=null,e.transmuxQueue.length=0,t.call(e)),e.postMessage({action:"init",options:n}),e};var _I={reset:Xse,endTimeline:qse,transmux:jG,createTransmuxer:Qse};const $_=function(n){const e=n.transmuxer,t=n.endAction||n.action,r=n.callback,o=qo({},n,{endAction:null,transmuxer:null,callback:null}),u=h=>{h.data.action===t&&(e.removeEventListener("message",u),h.data.data&&(h.data.data=new Uint8Array(h.data.data,n.byteOffset||0,n.byteLength||h.data.data.byteLength),n.data&&(n.data=h.data.data)),r(h.data))};if(e.addEventListener("message",u),n.data){const h=n.data instanceof ArrayBuffer;o.byteOffset=h?0:n.data.byteOffset,o.byteLength=n.data.byteLength;const f=[h?n.data:n.data.buffer];e.postMessage(o,f)}else e.postMessage(o)},Cl={FAILURE:2,TIMEOUT:-101,ABORTED:-102},Db=n=>{n.forEach(e=>{e.abort()})},Jse=n=>({bandwidth:n.bandwidth,bytesReceived:n.bytesReceived||0,roundTripTime:n.roundTripTime||0}),Zse=n=>{const e=n.target,r={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-e.requestTime||0};return r.bytesReceived=n.loaded,r.bandwidth=Math.floor(r.bytesReceived/r.roundTripTime*8*1e3),r},v1=(n,e)=>e.timedout?{status:e.status,message:"HLS request timed-out at URL: "+e.uri,code:Cl.TIMEOUT,xhr:e}:e.aborted?{status:e.status,message:"HLS request aborted at URL: "+e.uri,code:Cl.ABORTED,xhr:e}:n?{status:e.status,message:"HLS request errored at URL: "+e.uri,code:Cl.FAILURE,xhr:e}:e.responseType==="arraybuffer"&&e.response.byteLength===0?{status:e.status,message:"Empty HLS response at URL: "+e.uri,code:Cl.FAILURE,xhr:e}:null,eB=(n,e,t)=>(r,o)=>{const u=o.response,h=v1(r,o);if(h)return t(h,n);if(u.byteLength!==16)return t({status:o.status,message:"Invalid HLS key at URL: "+o.uri,code:Cl.FAILURE,xhr:o},n);const f=new DataView(u),d=new Uint32Array([f.getUint32(0),f.getUint32(4),f.getUint32(8),f.getUint32(12)]);for(let m=0;m<e.length;m++)e[m].bytes=d;return t(null,n)},KG=(n,e)=>{const t=NP(n.map.bytes);if(t!=="mp4"){const r=n.map.resolvedUri||n.map.uri;return e({internal:!0,message:`Found unsupported ${t||"unknown"} container for initialization segment at URL: ${r}`,code:Cl.FAILURE})}$_({action:"probeMp4Tracks",data:n.map.bytes,transmuxer:n.transmuxer,callback:({tracks:r,data:o})=>(n.map.bytes=o,r.forEach(function(u){n.map.tracks=n.map.tracks||{},!n.map.tracks[u.type]&&(n.map.tracks[u.type]=u,typeof u.id=="number"&&u.timescale&&(n.map.timescales=n.map.timescales||{},n.map.timescales[u.id]=u.timescale))}),e(null))})},eae=({segment:n,finishProcessingFn:e})=>(t,r)=>{const o=v1(t,r);if(o)return e(o,n);const u=new Uint8Array(r.response);if(n.map.key)return n.map.encryptedBytes=u,e(null,n);n.map.bytes=u,KG(n,function(h){if(h)return h.xhr=r,h.status=r.status,e(h,n);e(null,n)})},tae=({segment:n,finishProcessingFn:e,responseType:t})=>(r,o)=>{const u=v1(r,o);if(u)return e(u,n);const h=t==="arraybuffer"||!o.responseText?o.response:Gse(o.responseText.substring(n.lastReachedChar||0));return n.stats=Jse(o),n.key?n.encryptedBytes=new Uint8Array(h):n.bytes=new Uint8Array(h),e(null,n)},nae=({segment:n,bytes:e,trackInfoFn:t,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:h,captionsFn:f,isEndOfTimeline:d,endedTimelineFn:m,dataFn:g,doneFn:v,onTransmuxerLog:_})=>{const S=n.map&&n.map.tracks||{},E=Boolean(S.audio&&S.video);let T=r.bind(null,n,"audio","start");const C=r.bind(null,n,"audio","end");let R=r.bind(null,n,"video","start");const b=r.bind(null,n,"video","end"),F=()=>jG({bytes:e,transmuxer:n.transmuxer,audioAppendStart:n.audioAppendStart,gopsToAlignWith:n.gopsToAlignWith,remux:E,onData:O=>{O.type=O.type==="combined"?"video":O.type,g(n,O)},onTrackInfo:O=>{t&&(E&&(O.isMuxed=!0),t(n,O))},onAudioTimingInfo:O=>{T&&typeof O.start<"u"&&(T(O.start),T=null),C&&typeof O.end<"u"&&C(O.end)},onVideoTimingInfo:O=>{R&&typeof O.start<"u"&&(R(O.start),R=null),b&&typeof O.end<"u"&&b(O.end)},onVideoSegmentTimingInfo:O=>{o(O)},onAudioSegmentTimingInfo:O=>{u(O)},onId3:(O,L)=>{h(n,O,L)},onCaptions:O=>{f(n,[O])},isEndOfTimeline:d,onEndedTimeline:()=>{m()},onTransmuxerLog:_,onDone:O=>{v&&(O.type=O.type==="combined"?"video":O.type,v(null,n,O))}});$_({action:"probeTs",transmuxer:n.transmuxer,data:e,baseStartTime:n.baseStartTime,callback:O=>{n.bytes=e=O.data;const L=O.result;L&&(t(n,{hasAudio:L.hasAudio,hasVideo:L.hasVideo,isMuxed:E}),t=null,L.hasAudio&&!E&&T(L.audioStart),L.hasVideo&&R(L.videoStart),T=null,R=null),F()}})},GG=({segment:n,bytes:e,trackInfoFn:t,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:h,captionsFn:f,isEndOfTimeline:d,endedTimelineFn:m,dataFn:g,doneFn:v,onTransmuxerLog:_})=>{let S=new Uint8Array(e);if(Dre(S)){n.isFmp4=!0;const{tracks:E}=n.map,T={isFmp4:!0,hasVideo:!!E.video,hasAudio:!!E.audio};E.audio&&E.audio.codec&&E.audio.codec!=="enca"&&(T.audioCodec=E.audio.codec),E.video&&E.video.codec&&E.video.codec!=="encv"&&(T.videoCodec=E.video.codec),E.video&&E.audio&&(T.isMuxed=!0),t(n,T);const C=R=>{g(n,{data:S,type:T.hasAudio&&!T.isMuxed?"audio":"video"}),R&&R.length&&f(n,R),v(null,n,{})};$_({action:"probeMp4StartTime",timescales:n.map.timescales,data:S,transmuxer:n.transmuxer,callback:({data:R,startTime:b})=>{if(e=R.buffer,n.bytes=S=R,T.hasAudio&&!T.isMuxed&&r(n,"audio","start",b),T.hasVideo&&r(n,"video","start",b),!E.video||!R.byteLength||!n.transmuxer){C();return}$_({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:n.transmuxer,data:S,timescales:n.map.timescales,trackIds:[E.video.id],callback:F=>{e=F.data.buffer,n.bytes=S=F.data,F.logs.forEach(function(O){_(Zr(O,{stream:"mp4CaptionParser"}))}),C(F.captions)}})}});return}if(!n.transmuxer){v(null,n,{});return}if(typeof n.container>"u"&&(n.container=NP(S)),n.container!=="ts"&&n.container!=="aac"){t(n,{hasAudio:!1,hasVideo:!1}),v(null,n,{});return}nae({segment:n,bytes:e,trackInfoFn:t,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:h,captionsFn:f,isEndOfTimeline:d,endedTimelineFn:m,dataFn:g,doneFn:v,onTransmuxerLog:_})},WG=function({id:n,key:e,encryptedBytes:t,decryptionWorker:r},o){const u=f=>{if(f.data.source===n){r.removeEventListener("message",u);const d=f.data.decrypted;o(new Uint8Array(d.bytes,d.byteOffset,d.byteLength))}};r.addEventListener("message",u);let h;e.bytes.slice?h=e.bytes.slice():h=new Uint32Array(Array.prototype.slice.call(e.bytes)),r.postMessage(bG({source:n,encrypted:t,key:h,iv:e.iv}),[t.buffer,h.buffer])},rae=({decryptionWorker:n,segment:e,trackInfoFn:t,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:h,captionsFn:f,isEndOfTimeline:d,endedTimelineFn:m,dataFn:g,doneFn:v,onTransmuxerLog:_})=>{WG({id:e.requestId,key:e.key,encryptedBytes:e.encryptedBytes,decryptionWorker:n},S=>{e.bytes=S,GG({segment:e,bytes:e.bytes,trackInfoFn:t,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:h,captionsFn:f,isEndOfTimeline:d,endedTimelineFn:m,dataFn:g,doneFn:v,onTransmuxerLog:_})})},iae=({activeXhrs:n,decryptionWorker:e,trackInfoFn:t,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:h,captionsFn:f,isEndOfTimeline:d,endedTimelineFn:m,dataFn:g,doneFn:v,onTransmuxerLog:_})=>{let S=0,E=!1;return(T,C)=>{if(!E){if(T)return E=!0,Db(n),v(T,C);if(S+=1,S===n.length){const R=function(){if(C.encryptedBytes)return rae({decryptionWorker:e,segment:C,trackInfoFn:t,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:h,captionsFn:f,isEndOfTimeline:d,endedTimelineFn:m,dataFn:g,doneFn:v,onTransmuxerLog:_});GG({segment:C,bytes:C.bytes,trackInfoFn:t,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:h,captionsFn:f,isEndOfTimeline:d,endedTimelineFn:m,dataFn:g,doneFn:v,onTransmuxerLog:_})};if(C.endOfAllRequests=Date.now(),C.map&&C.map.encryptedBytes&&!C.map.bytes)return WG({decryptionWorker:e,id:C.requestId+"-init",encryptedBytes:C.map.encryptedBytes,key:C.map.key},b=>{C.map.bytes=b,KG(C,F=>{if(F)return Db(n),v(F,C);R()})});R()}}}},sae=({loadendState:n,abortFn:e})=>t=>{t.target.aborted&&e&&!n.calledAbortFn&&(e(),n.calledAbortFn=!0)},aae=({segment:n,progressFn:e,trackInfoFn:t,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:h,captionsFn:f,isEndOfTimeline:d,endedTimelineFn:m,dataFn:g})=>v=>{if(!v.target.aborted)return n.stats=Zr(n.stats,Zse(v)),!n.stats.firstBytesReceivedAt&&n.stats.bytesReceived&&(n.stats.firstBytesReceivedAt=Date.now()),e(v,n)},oae=({xhr:n,xhrOptions:e,decryptionWorker:t,segment:r,abortFn:o,progressFn:u,trackInfoFn:h,timingInfoFn:f,videoSegmentTimingInfoFn:d,audioSegmentTimingInfoFn:m,id3Fn:g,captionsFn:v,isEndOfTimeline:_,endedTimelineFn:S,dataFn:E,doneFn:T,onTransmuxerLog:C})=>{const R=[],b=iae({activeXhrs:R,decryptionWorker:t,trackInfoFn:h,timingInfoFn:f,videoSegmentTimingInfoFn:d,audioSegmentTimingInfoFn:m,id3Fn:g,captionsFn:v,isEndOfTimeline:_,endedTimelineFn:S,dataFn:E,doneFn:T,onTransmuxerLog:C});if(r.key&&!r.key.bytes){const x=[r.key];r.map&&!r.map.bytes&&r.map.key&&r.map.key.resolvedUri===r.key.resolvedUri&&x.push(r.map.key);const B=Zr(e,{uri:r.key.resolvedUri,responseType:"arraybuffer"}),M=eB(r,x,b),I=n(B,M);R.push(I)}if(r.map&&!r.map.bytes){if(r.map.key&&(!r.key||r.key.resolvedUri!==r.map.key.resolvedUri)){const U=Zr(e,{uri:r.map.key.resolvedUri,responseType:"arraybuffer"}),w=eB(r,[r.map.key],b),k=n(U,w);R.push(k)}const B=Zr(e,{uri:r.map.resolvedUri,responseType:"arraybuffer",headers:Rb(r.map)}),M=eae({segment:r,finishProcessingFn:b}),I=n(B,M);R.push(I)}const F=Zr(e,{uri:r.part&&r.part.resolvedUri||r.resolvedUri,responseType:"arraybuffer",headers:Rb(r)}),O=tae({segment:r,finishProcessingFn:b,responseType:F.responseType}),L=n(F,O);L.addEventListener("progress",aae({segment:r,progressFn:u,trackInfoFn:h,timingInfoFn:f,videoSegmentTimingInfoFn:d,audioSegmentTimingInfoFn:m,id3Fn:g,captionsFn:v,isEndOfTimeline:_,endedTimelineFn:S,dataFn:E})),R.push(L);const D={};return R.forEach(x=>{x.addEventListener("loadend",sae({loadendState:D,abortFn:o}))}),()=>Db(R)},lae=Jo("CodecUtils"),uae=function(n){const e=n.attributes||{};if(e.CODECS)return vl(e.CODECS)},HG=(n,e)=>{const t=e.attributes||{};return n&&n.mediaGroups&&n.mediaGroups.AUDIO&&t.AUDIO&&n.mediaGroups.AUDIO[t.AUDIO]},cae=(n,e)=>{if(!HG(n,e))return!0;const t=e.attributes||{},r=n.mediaGroups.AUDIO[t.AUDIO];for(const o in r)if(!r[o].uri&&!r[o].playlists)return!0;return!1},z_=function(n){const e={};return n.forEach(({mediaType:t,type:r,details:o})=>{e[t]=e[t]||[],e[t].push(o6(`${r}${o}`))}),Object.keys(e).forEach(function(t){if(e[t].length>1){lae(`multiple ${t} codecs found as attributes: ${e[t].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),e[t]=null;return}e[t]=e[t][0]}),e},tB=function(n){let e=0;return n.audio&&e++,n.video&&e++,e},Tm=function(n,e){const t=e.attributes||{},r=z_(uae(e)||[]);if(HG(n,e)&&!r.audio&&!cae(n,e)){const o=z_(Lte(n,t.AUDIO)||[]);o.audio&&(r.audio=o.audio)}return r},oE=Jo("PlaylistSelector"),nB=function(n){if(!n||!n.playlist)return;const e=n.playlist;return JSON.stringify({id:e.id,bandwidth:n.bandwidth,width:n.width,height:n.height,codecs:e.attributes&&e.attributes.CODECS||""})},Y_=function(n,e){if(!n)return"";const t=rt.getComputedStyle(n);return t?t[e]:""},Bh=function(n,e){const t=n.slice();n.sort(function(r,o){const u=e(r,o);return u===0?t.indexOf(r)-t.indexOf(o):u})},y1=function(n,e){let t,r;return n.attributes.BANDWIDTH&&(t=n.attributes.BANDWIDTH),t=t||rt.Number.MAX_VALUE,e.attributes.BANDWIDTH&&(r=e.attributes.BANDWIDTH),r=r||rt.Number.MAX_VALUE,t-r},fae=function(n,e){let t,r;return n.attributes.RESOLUTION&&n.attributes.RESOLUTION.width&&(t=n.attributes.RESOLUTION.width),t=t||rt.Number.MAX_VALUE,e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(r=e.attributes.RESOLUTION.width),r=r||rt.Number.MAX_VALUE,t===r&&n.attributes.BANDWIDTH&&e.attributes.BANDWIDTH?n.attributes.BANDWIDTH-e.attributes.BANDWIDTH:t-r};let VG=function(n,e,t,r,o,u){if(!n)return;const h={bandwidth:e,width:t,height:r,limitRenditionByPlayerDimensions:o};let f=n.playlists;ca.isAudioOnly(n)&&(f=u.getAudioTrackPlaylists_(),h.audioOnly=!0);let d=f.map(L=>{let D;const x=L.attributes&&L.attributes.RESOLUTION&&L.attributes.RESOLUTION.width,B=L.attributes&&L.attributes.RESOLUTION&&L.attributes.RESOLUTION.height;return D=L.attributes&&L.attributes.BANDWIDTH,D=D||rt.Number.MAX_VALUE,{bandwidth:D,width:x,height:B,playlist:L}});Bh(d,(L,D)=>L.bandwidth-D.bandwidth),d=d.filter(L=>!ca.isIncompatible(L.playlist));let m=d.filter(L=>ca.isEnabled(L.playlist));m.length||(m=d.filter(L=>!ca.isDisabled(L.playlist)));const g=m.filter(L=>L.bandwidth*is.BANDWIDTH_VARIANCE<e);let v=g[g.length-1];const _=g.filter(L=>L.bandwidth===v.bandwidth)[0];if(o===!1){const L=_||m[0]||d[0];if(L&&L.playlist){let D="sortedPlaylistReps";return _&&(D="bandwidthBestRep"),m[0]&&(D="enabledPlaylistReps"),oE(`choosing ${nB(L)} using ${D} with options`,h),L.playlist}return oE("could not choose a playlist with options",h),null}const S=g.filter(L=>L.width&&L.height);Bh(S,(L,D)=>L.width-D.width);const E=S.filter(L=>L.width===t&&L.height===r);v=E[E.length-1];const T=E.filter(L=>L.bandwidth===v.bandwidth)[0];let C,R,b;T||(C=S.filter(L=>L.width>t||L.height>r),R=C.filter(L=>L.width===C[0].width&&L.height===C[0].height),v=R[R.length-1],b=R.filter(L=>L.bandwidth===v.bandwidth)[0]);let F;if(u.leastPixelDiffSelector){const L=S.map(D=>(D.pixelDiff=Math.abs(D.width-t)+Math.abs(D.height-r),D));Bh(L,(D,x)=>D.pixelDiff===x.pixelDiff?x.bandwidth-D.bandwidth:D.pixelDiff-x.pixelDiff),F=L[0]}const O=F||b||T||_||m[0]||d[0];if(O&&O.playlist){let L="sortedPlaylistReps";return F?L="leastPixelDiffRep":b?L="resolutionPlusOneRep":T?L="resolutionBestRep":_?L="bandwidthBestRep":m[0]&&(L="enabledPlaylistReps"),oE(`choosing ${nB(O)} using ${L} with options`,h),O.playlist}return oE("could not choose a playlist with options",h),null};const rB=function(){const n=this.useDevicePixelRatio&&rt.devicePixelRatio||1;return VG(this.playlists.main,this.systemBandwidth,parseInt(Y_(this.tech_.el(),"width"),10)*n,parseInt(Y_(this.tech_.el(),"height"),10)*n,this.limitRenditionByPlayerDimensions,this.playlistController_)},dae=function(n){let e=-1,t=-1;if(n<0||n>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){const r=this.useDevicePixelRatio&&rt.devicePixelRatio||1;return e<0&&(e=this.systemBandwidth,t=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==t&&(e=n*this.systemBandwidth+(1-n)*e,t=this.systemBandwidth),VG(this.playlists.main,e,parseInt(Y_(this.tech_.el(),"width"),10)*r,parseInt(Y_(this.tech_.el(),"height"),10)*r,this.limitRenditionByPlayerDimensions,this.playlistController_)}},hae=function(n){const{main:e,currentTime:t,bandwidth:r,duration:o,segmentDuration:u,timeUntilRebuffer:h,currentTimeline:f,syncController:d}=n,m=e.playlists.filter(E=>!ca.isIncompatible(E));let g=m.filter(ca.isEnabled);g.length||(g=m.filter(E=>!ca.isDisabled(E)));const _=g.filter(ca.hasAttribute.bind(null,"BANDWIDTH")).map(E=>{const C=d.getSyncPoint(E,o,f,t)?1:2,b=ca.estimateSegmentRequestTime(u,r,E)*C-h;return{playlist:E,rebufferingImpact:b}}),S=_.filter(E=>E.rebufferingImpact<=0);return Bh(S,(E,T)=>y1(T.playlist,E.playlist)),S.length?S[0]:(Bh(_,(E,T)=>E.rebufferingImpact-T.rebufferingImpact),_[0]||null)},pae=function(){const n=this.playlists.main.playlists.filter(ca.isEnabled);return Bh(n,(t,r)=>y1(t,r)),n.filter(t=>!!Tm(this.playlists.main,t).video)[0]||null},gae=n=>{let e=0,t;return n.bytes&&(t=new Uint8Array(n.bytes),n.segments.forEach(r=>{t.set(r,e),e+=r.byteLength})),t},mae=function(n,e,t){if(!n[t]){e.trigger({type:"usage",name:"vhs-608"});let r=t;/^cc708_/.test(t)&&(r="SERVICE"+t.split("_")[1]);const o=e.textTracks().getTrackById(r);if(o)n[t]=o;else{const u=e.options_.vhs&&e.options_.vhs.captionServices||{};let h=t,f=t,d=!1;const m=u[r];m&&(h=m.label,f=m.language,d=m.default),n[t]=e.addRemoteTextTrack({kind:"captions",id:r,default:d,label:h,language:f},!1).track}}},vae=function({inbandTextTracks:n,captionArray:e,timestampOffset:t}){if(!e)return;const r=rt.WebKitDataCue||rt.VTTCue;e.forEach(o=>{const u=o.stream;n[u].addCue(new r(o.startTime+t,o.endTime+t,o.text))})},yae=function(n){Object.defineProperties(n.frame,{id:{get(){return jt.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),n.value.key}},value:{get(){return jt.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),n.value.data}},privateData:{get(){return jt.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),n.value.data}}})},Eae=({inbandTextTracks:n,metadataArray:e,timestampOffset:t,videoDuration:r})=>{if(!e)return;const o=rt.WebKitDataCue||rt.VTTCue,u=n.metadataTrack_;if(!u||(e.forEach(g=>{const v=g.cueTime+t;typeof v!="number"||rt.isNaN(v)||v<0||!(v<1/0)||g.frames.forEach(_=>{const S=new o(v,v,_.value||_.url||_.data||"");S.frame=_,S.value=_,yae(S),u.addCue(S)})}),!u.cues||!u.cues.length))return;const h=u.cues,f=[];for(let g=0;g<h.length;g++)h[g]&&f.push(h[g]);const d=f.reduce((g,v)=>{const _=g[v.startTime]||[];return _.push(v),g[v.startTime]=_,g},{}),m=Object.keys(d).sort((g,v)=>Number(g)-Number(v));m.forEach((g,v)=>{const _=d[g],S=Number(m[v+1])||r;_.forEach(E=>{E.endTime=S})})},_ae=(n,e,t)=>{n.metadataTrack_||(n.metadataTrack_=t.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,n.metadataTrack_.inBandMetadataTrackDispatchType=e)},im=function(n,e,t){let r,o;if(t&&t.cues)for(r=t.cues.length;r--;)o=t.cues[r],o.startTime>=n&&o.endTime<=e&&t.removeCue(o)},Tae=function(n){const e=n.cues;if(e)for(let t=0;t<e.length;t++){const r=[];let o=0;for(let u=0;u<e.length;u++)e[t].startTime===e[u].startTime&&e[t].endTime===e[u].endTime&&e[t].text===e[u].text&&(o++,o>1&&r.push(e[u]));r.length&&r.forEach(u=>n.removeCue(u))}},Sae=(n,e,t)=>{if(typeof e>"u"||e===null||!n.length)return[];const r=Math.ceil((e-t+3)*L_.ONE_SECOND_IN_TS);let o;for(o=0;o<n.length&&!(n[o].pts>r);o++);return n.slice(o)},Aae=(n,e,t)=>{if(!e.length)return n;if(t)return e.slice();const r=e[0].pts;let o=0;for(o;o<n.length&&!(n[o].pts>=r);o++);return n.slice(0,o).concat(e)},xae=(n,e,t,r)=>{const o=Math.ceil((e-r)*L_.ONE_SECOND_IN_TS),u=Math.ceil((t-r)*L_.ONE_SECOND_IN_TS),h=n.slice();let f=n.length;for(;f--&&!(n[f].pts<=u););if(f===-1)return h;let d=f+1;for(;d--&&!(n[d].pts<=o););return d=Math.max(d,0),h.splice(d,f-d+1),h},Cae=function(n,e){if(!n&&!e||!n&&e||n&&!e)return!1;if(n===e)return!0;const t=Object.keys(n).sort(),r=Object.keys(e).sort();if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++){const u=t[o];if(u!==r[o]||n[u]!==e[u])return!1}return!0},$G=22,Iae=function(n,e,t){e=e||[];const r=[];let o=0;for(let u=0;u<e.length;u++){const h=e[u];if(n===h.timeline&&(r.push(u),o+=h.duration,o>t))return u}return r.length===0?0:r[r.length-1]},Wg=1,Rae=500,iB=n=>typeof n=="number"&&isFinite(n),lE=1/60,bae=(n,e,t)=>n!=="main"||!e||!t?null:!t.hasAudio&&!t.hasVideo?"Neither audio nor video found in segment.":e.hasVideo&&!t.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!e.hasVideo&&t.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null,Dae=(n,e,t)=>{let r=e-is.BACK_BUFFER_LENGTH;n.length&&(r=Math.max(r,n.start(0)));const o=e-t;return Math.min(o,r)},th=n=>{const{startOfSegment:e,duration:t,segment:r,part:o,playlist:{mediaSequence:u,id:h,segments:f=[]},mediaIndex:d,partIndex:m,timeline:g}=n,v=f.length-1;let _="mediaIndex/partIndex increment";n.getMediaInfoForTime?_=`getMediaInfoForTime (${n.getMediaInfoForTime})`:n.isSyncRequest&&(_="getSyncSegmentCandidate (isSyncRequest)"),n.independent&&(_+=` with independent ${n.independent}`);const S=typeof m=="number",E=n.segment.uri?"segment":"pre-segment",T=S?pG({preloadSegment:r})-1:0;return`${E} [${u+d}/${u+v}]`+(S?` part [${m}/${T}]`:"")+` segment start/end [${r.start} => ${r.end}]`+(S?` part start/end [${o.start} => ${o.end}]`:"")+` startOfSegment [${e}] duration [${t}] timeline [${g}] selected by [${_}] playlist [${h}]`},sB=n=>`${n}TimingInfo`,Pae=({segmentTimeline:n,currentTimeline:e,startOfSegment:t,buffered:r,overrideCheck:o})=>!o&&n===e?null:n<e?t:r.length?r.end(r.length-1):t,aB=({timelineChangeController:n,currentTimeline:e,segmentTimeline:t,loaderType:r,audioDisabled:o})=>{if(e===t)return!1;if(r==="audio"){const u=n.lastTimelineChange({type:"main"});return!u||u.to!==t}if(r==="main"&&o){const u=n.pendingTimelineChange({type:"audio"});return!(u&&u.to===t)}return!1},Lae=n=>{let e=0;return["video","audio"].forEach(function(t){const r=n[`${t}TimingInfo`];if(!r)return;const{start:o,end:u}=r;let h;typeof o=="bigint"||typeof u=="bigint"?h=rt.BigInt(u)-rt.BigInt(o):typeof o=="number"&&typeof u=="number"&&(h=u-o),typeof h<"u"&&h>e&&(e=h)}),typeof e=="bigint"&&e<Number.MAX_SAFE_INTEGER&&(e=Number(e)),e},oB=({segmentDuration:n,maxDuration:e})=>n?Math.round(n)>e+Uc:!1,Mae=(n,e)=>{if(e!=="hls")return null;const t=Lae({audioTimingInfo:n.audioTimingInfo,videoTimingInfo:n.videoTimingInfo});if(!t)return null;const r=n.playlist.targetDuration,o=oB({segmentDuration:t,maxDuration:r*2}),u=oB({segmentDuration:t,maxDuration:r}),h=`Segment with index ${n.mediaIndex} from playlist ${n.playlist.id} has a duration of ${t} when the reported duration is ${n.duration} and the target duration is ${r}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`;return o||u?{severity:o?"warn":"info",message:h}:null};class Pb extends jt.EventTarget{constructor(e,t={}){if(super(),!e)throw new TypeError("Initialization settings are required");if(typeof e.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=e.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=e.hasPlayed,this.currentTime_=e.currentTime,this.seekable_=e.seekable,this.seeking_=e.seeking,this.duration_=e.duration,this.mediaSource_=e.mediaSource,this.vhs_=e.vhs,this.loaderType_=e.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=e.segmentMetadataTrack,this.goalBufferLength_=e.goalBufferLength,this.sourceType_=e.sourceType,this.sourceUpdater_=e.sourceUpdater,this.inbandTextTracks_=e.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=e.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=e.parse708captions,this.useDtsForTimestampOffset_=e.useDtsForTimestampOffset,this.captionServices_=e.captionServices,this.exactManifestTimings=e.exactManifestTimings,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=jt.browser.IE_VERSION>=11,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=e.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=e.decrypter,this.syncController_=e.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",()=>{this.isEndOfStream_()||(this.ended_=!1)}),this.fetchAtBuffer_=!1,this.logger_=Jo(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(r){r!==this.state_&&(this.logger_(`${this.state_} -> ${r}`),this.state_=r,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.loaderType_==="main"&&this.timelineChangeController_.on("pendingtimelinechange",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.loaderType_==="audio"&&this.timelineChangeController_.on("timelinechange",()=>{this.hasEnoughInfoToLoad_()&&this.processLoadQueue_(),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()})}createTransmuxer_(){return _I.createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&rt.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null);return}this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,rt.clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(e){return this.state==="APPENDING"&&!this.pendingSegment_?(this.state="READY",!0):!this.pendingSegment_||this.pendingSegment_.requestId!==e}error(e){return typeof e<"u"&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&_I.reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){const e=this.getMediaInfo_();if(!this.sourceUpdater_||!e)return xs();if(this.loaderType_==="main"){const{hasAudio:t,hasVideo:r,isMuxed:o}=e;if(r&&t&&!this.audioDisabled_&&!o)return this.sourceUpdater_.buffered();if(r)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(e,t=!1){if(!e)return null;const r=V_(e);let o=this.initSegments_[r];return t&&!o&&e.bytes&&(this.initSegments_[r]=o={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),o||e}segmentKey(e,t=!1){if(!e)return null;const r=DG(e);let o=this.keyCache_[r];this.cacheEncryptionKeys_&&t&&!o&&e.bytes&&(this.keyCache_[r]=o={resolvedUri:e.resolvedUri,bytes:e.bytes});const u={resolvedUri:(o||e).resolvedUri};return o&&(u.bytes=o.bytes),u}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),!!this.playlist_){if(this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(e,t={}){if(!e)return;const r=this.playlist_,o=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=t,this.state==="INIT"&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0},this.loaderType_==="main"&&this.syncController_.setDateTimeMappingForStart(e));let u=null;if(r&&(r.id?u=r.id:r.uri&&(u=r.uri)),this.logger_(`playlist update [${u} => ${e.id||e.uri}]`),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!r||r.uri!==e.uri){this.mediaIndex!==null&&(e.endList?this.resyncLoader():this.resetLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate");return}const h=e.mediaSequence-r.mediaSequence;if(this.logger_(`live window shift [${h}]`),this.mediaIndex!==null)if(this.mediaIndex-=h,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{const f=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!f.parts||!f.parts.length||!f.parts[this.partIndex])){const d=this.mediaIndex;this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=d}}o&&(o.mediaIndex-=h,o.mediaIndex<0?(o.mediaIndex=null,o.partIndex=null):(o.mediaIndex>=0&&(o.segment=e.segments[o.mediaIndex]),o.partIndex>=0&&o.segment.parts&&(o.part=o.segment.parts[o.partIndex]))),this.syncController_.saveExpiredSegmentInfo(r,e)}pause(){this.checkBufferTimeout_&&(rt.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return this.checkBufferTimeout_===null}resetEverything(e){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,e),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.resyncLoader()}resyncLoader(){this.transmuxer_&&_I.reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(e,t,r=()=>{},o=!1){if(t===1/0&&(t=this.duration_()),t<=e){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}let u=1;const h=()=>{u--,u===0&&r()};(o||!this.audioDisabled_)&&(u++,this.sourceUpdater_.removeAudio(e,t,h)),(o||this.loaderType_==="main")&&(this.gopBuffer_=xae(this.gopBuffer_,e,t,this.timeMapping_),u++,this.sourceUpdater_.removeVideo(e,t,h));for(const f in this.inbandTextTracks_)im(e,t,this.inbandTextTracks_[f]);im(e,t,this.segmentMetadataTrack_),h()}monitorBuffer_(){this.checkBufferTimeout_&&rt.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=rt.setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&rt.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=rt.setTimeout(this.monitorBufferTick_.bind(this),Rae)}fillBuffer_(){if(this.sourceUpdater_.updating())return;const e=this.chooseNextRequest_();e&&(typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline})),this.loadSegment_(e))}isEndOfStream_(e=this.mediaIndex,t=this.playlist_,r=this.partIndex){if(!t||!this.mediaSource_)return!1;const o=typeof e=="number"&&t.segments[e],u=e+1===t.segments.length,h=!o||!o.parts||r+1===o.parts.length;return t.endList&&this.mediaSource_.readyState==="open"&&u&&h}chooseNextRequest_(){const e=this.buffered_(),t=X2(e)||0,r=d1(e,this.currentTime_()),o=!this.hasPlayed_()&&r>=1,u=r>=this.goalBufferLength_(),h=this.playlist_.segments;if(!h.length||o||u)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_());const f={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(f.isSyncRequest)f.mediaIndex=Iae(this.currentTimeline_,h,t);else if(this.mediaIndex!==null){const v=h[this.mediaIndex],_=typeof this.partIndex=="number"?this.partIndex:-1;f.startOfSegment=v.end?v.end:t,v.parts&&v.parts[_+1]?(f.mediaIndex=this.mediaIndex,f.partIndex=_+1):f.mediaIndex=this.mediaIndex+1}else{const{segmentIndex:v,startTime:_,partIndex:S}=ca.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?t:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});f.getMediaInfoForTime=this.fetchAtBuffer_?`bufferedEnd ${t}`:`currentTime ${this.currentTime_()}`,f.mediaIndex=v,f.startOfSegment=_,f.partIndex=S}const d=h[f.mediaIndex];let m=d&&typeof f.partIndex=="number"&&d.parts&&d.parts[f.partIndex];if(!d||typeof f.partIndex=="number"&&!m)return null;if(typeof f.partIndex!="number"&&d.parts&&(f.partIndex=0,m=d.parts[0]),!r&&m&&!m.independent)if(f.partIndex===0){const v=h[f.mediaIndex-1],_=v.parts&&v.parts.length&&v.parts[v.parts.length-1];_&&_.independent&&(f.mediaIndex-=1,f.partIndex=v.parts.length-1,f.independent="previous segment")}else d.parts[f.partIndex-1].independent&&(f.partIndex-=1,f.independent="previous part");const g=this.mediaSource_&&this.mediaSource_.readyState==="ended";return f.mediaIndex>=h.length-1&&g&&!this.seeking_()?null:this.generateSegmentInfo_(f)}generateSegmentInfo_(e){const{independent:t,playlist:r,mediaIndex:o,startOfSegment:u,isSyncRequest:h,partIndex:f,forceTimestampOffset:d,getMediaInfoForTime:m}=e,g=r.segments[o],v=typeof f=="number"&&g.parts[f],_={requestId:"segment-loader-"+Math.random(),uri:v&&v.resolvedUri||g.resolvedUri,mediaIndex:o,partIndex:v?f:null,isSyncRequest:h,startOfSegment:u,playlist:r,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:g.timeline,duration:v&&v.duration||g.duration,segment:g,part:v,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:m,independent:t},S=typeof d<"u"?d:this.isPendingTimestampOffset_;_.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:g.timeline,currentTimeline:this.currentTimeline_,startOfSegment:u,buffered:this.buffered_(),overrideCheck:S});const E=X2(this.sourceUpdater_.audioBuffered());return typeof E=="number"&&(_.audioAppendStart=E-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(_.gopsToAlignWith=Sae(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),_}timestampOffsetForSegment_(e){return Pae(e)}earlyAbortWhenNeeded_(e){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH||Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return;const t=this.currentTime_(),r=e.bandwidth,o=this.pendingSegment_.duration,u=ca.estimateSegmentRequestTime(o,r,this.playlist_,e.bytesReceived),h=tse(this.buffered_(),t,this.vhs_.tech_.playbackRate())-1;if(u<=h)return;const f=hae({main:this.vhs_.playlists.main,currentTime:t,bandwidth:r,duration:this.duration_(),segmentDuration:o,timeUntilRebuffer:h,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!f)return;const m=u-h-f.rebufferingImpact;let g=.5;h<=Uc&&(g=1),!(!f.playlist||f.playlist.uri===this.playlist_.uri||m<g)&&(this.bandwidth=f.playlist.attributes.BANDWIDTH*is.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}handleAbort_(e){this.logger_(`Aborting ${th(e)}`),this.mediaRequestsAborted+=1}handleProgress_(e,t){this.earlyAbortWhenNeeded_(t.stats),!this.checkForAbort_(t.requestId)&&this.trigger("progress")}handleTrackInfo_(e,t){this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId)&&(this.checkForIllegalMediaSwitch(t)||(t=t||{},Cae(this.currentMediaInfo_,t)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=t,this.currentMediaInfo_=t,this.logger_("trackinfo update",t),this.trigger("trackinfo")),!this.checkForAbort_(e.requestId)&&(this.pendingSegment_.trackInfo=t,this.hasEnoughInfoToAppend_()&&this.processCallQueue_())))}handleTimingInfo_(e,t,r,o){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;const u=this.pendingSegment_,h=sB(t);u[h]=u[h]||{},u[h][r]=o,this.logger_(`timinginfo: ${t} - ${r} - ${o}`),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}handleCaptions_(e,t){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(t.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,t));return}const o=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),u={};t.forEach(h=>{u[h.stream]=u[h.stream]||{startTime:1/0,captions:[],endTime:0};const f=u[h.stream];f.startTime=Math.min(f.startTime,h.startTime+o),f.endTime=Math.max(f.endTime,h.endTime+o),f.captions.push(h)}),Object.keys(u).forEach(h=>{const{startTime:f,endTime:d,captions:m}=u[h],g=this.inbandTextTracks_;this.logger_(`adding cues from ${f} -> ${d} for ${h}`),mae(g,this.vhs_.tech_,h),im(f,d,g[h]),vae({captionArray:m,inbandTextTracks:g,timestampOffset:o})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}handleId3_(e,t,r){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,t,r));return}const u=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();_ae(this.inbandTextTracks_,r,this.vhs_.tech_),Eae({inbandTextTracks:this.inbandTextTracks_,metadataArray:t,timestampOffset:u,videoDuration:this.duration_()})}processMetadataQueue_(){this.metadataQueue_.id3.forEach(e=>e()),this.metadataQueue_.caption.forEach(e=>e()),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){const e=this.callQueue_;this.callQueue_=[],e.forEach(t=>t())}processLoadQueue_(){const e=this.loadQueue_;this.loadQueue_=[],e.forEach(t=>t())}hasEnoughInfoToLoad_(){if(this.loaderType_!=="audio")return!0;const e=this.pendingSegment_;return e?this.getCurrentMediaInfo_()?!aB({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}):!0:!1}getCurrentMediaInfo_(e=this.pendingSegment_){return e&&e.trackInfo||this.currentMediaInfo_}getMediaInfo_(e=this.pendingSegment_){return this.getCurrentMediaInfo_(e)||this.startingMediaInfo_}getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;const e=this.pendingSegment_,t=this.getCurrentMediaInfo_();if(!e||!t)return!1;const{hasAudio:r,hasVideo:o,isMuxed:u}=t;return!(o&&!e.videoTimingInfo||r&&!this.audioDisabled_&&!u&&!e.audioTimingInfo||aB({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(e,t){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){this.callQueue_.push(this.handleData_.bind(this,e,t));return}const r=this.pendingSegment_;if(this.setTimeMapping_(r.timeline),this.updateMediaSecondsLoaded_(r.part||r.segment),this.mediaSource_.readyState!=="closed"){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),r.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),r.isFmp4=e.isFmp4,r.timingInfo=r.timingInfo||{},r.isFmp4)this.trigger("fmp4"),r.timingInfo.start=r[sB(t.type)].start;else{const o=this.getCurrentMediaInfo_(),u=this.loaderType_==="main"&&o&&o.hasVideo;let h;u&&(h=r.videoTimingInfo.start),r.timingInfo.start=this.trueSegmentStart_({currentStart:r.timingInfo.start,playlist:r.playlist,mediaIndex:r.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:u,firstVideoFrameTimeForData:h,videoTimingInfo:r.videoTimingInfo,audioTimingInfo:r.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(r,t.type),this.updateSourceBufferTimestampOffset_(r),r.isSyncRequest){this.updateTimingInfoEnd_(r),this.syncController_.saveSegmentTimingInfo({segmentInfo:r,shouldSaveTimelineMapping:this.loaderType_==="main"});const o=this.chooseNextRequest_();if(o.mediaIndex!==r.mediaIndex||o.partIndex!==r.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}r.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(r,t)}}updateAppendInitSegmentStatus(e,t){this.loaderType_==="main"&&typeof e.timestampOffset=="number"&&!e.changedTimestampOffset&&(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[t]!==e.playlist&&(this.appendInitSegment_[t]=!0)}getInitSegmentAndUpdateState_({type:e,initSegment:t,map:r,playlist:o}){if(r){const u=V_(r);if(this.activeInitSegmentId_===u)return null;t=this.initSegmentForMap(r,!0).bytes,this.activeInitSegmentId_=u}return t&&this.appendInitSegment_[e]?(this.playlistOfLastInitSegment_[e]=o,this.appendInitSegment_[e]=!1,this.activeInitSegmentId_=null,t):null}handleQuotaExceededError_({segmentInfo:e,type:t,bytes:r},o){const u=this.sourceUpdater_.audioBuffered(),h=this.sourceUpdater_.videoBuffered();u.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+kf(u).join(", ")),h.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+kf(h).join(", "));const f=u.length?u.start(0):0,d=u.length?u.end(u.length-1):0,m=h.length?h.start(0):0,g=h.length?h.end(h.length-1):0;if(d-f<=Wg&&g-m<=Wg){this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${r.byteLength}, audio buffer: ${kf(u).join(", ")}, video buffer: ${kf(h).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),this.trigger("error");return}this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:e,type:t,bytes:r}));const _=this.currentTime_()-Wg;this.logger_(`On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ${_}`),this.remove(0,_,()=>{this.logger_(`On QUOTA_EXCEEDED_ERR, retrying append in ${Wg}s`),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=rt.setTimeout(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()},Wg*1e3)},!0)}handleAppendError_({segmentInfo:e,type:t,bytes:r},o){if(o){if(o.code===$G){this.handleQuotaExceededError_({segmentInfo:e,type:t,bytes:r});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",o),this.error(`${t} append of ${r.length}b failed for segment #${e.mediaIndex} in playlist ${e.playlist.id}`),this.trigger("appenderror")}}appendToSourceBuffer_({segmentInfo:e,type:t,initSegment:r,data:o,bytes:u}){if(!u){const h=[o];let f=o.byteLength;r&&(h.unshift(r),f+=r.byteLength),u=gae({bytes:f,segments:h})}this.sourceUpdater_.appendBuffer({segmentInfo:e,type:t,bytes:u},this.handleAppendError_.bind(this,{segmentInfo:e,type:t,bytes:u}))}handleSegmentTimingInfo_(e,t,r){if(!this.pendingSegment_||t!==this.pendingSegment_.requestId)return;const o=this.pendingSegment_.segment,u=`${e}TimingInfo`;o[u]||(o[u]={}),o[u].transmuxerPrependedSeconds=r.prependedContentDuration||0,o[u].transmuxedPresentationStart=r.start.presentation,o[u].transmuxedDecodeStart=r.start.decode,o[u].transmuxedPresentationEnd=r.end.presentation,o[u].transmuxedDecodeEnd=r.end.decode,o[u].baseMediaDecodeTime=r.baseMediaDecodeTime}appendData_(e,t){const{type:r,data:o}=t;if(!o||!o.byteLength||r==="audio"&&this.audioDisabled_)return;const u=this.getInitSegmentAndUpdateState_({type:r,initSegment:t.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:r,initSegment:u,data:o})}loadSegment_(e){if(this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),typeof e.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_()){this.loadQueue_.push(()=>{const t=qo({},e,{forceTimestampOffset:!0});qo(e,this.generateSegmentInfo_(t)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(e)});return}this.updateTransmuxerAndRequestSegment_(e)}updateTransmuxerAndRequestSegment_(e){this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset}));const t=this.createSimplifiedSegmentObj_(e),r=this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex),o=this.mediaIndex!==null,u=e.timeline!==this.currentTimeline_&&e.timeline>0,h=r||o&&u;this.logger_(`Requesting ${th(e)}`),t.map&&!t.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),e.abortRequests=oae({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:t,abortFn:this.handleAbort_.bind(this,e),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",e.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",e.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:h,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:f,level:d,stream:m})=>{this.logger_(`${th(e)} logged from transmuxer stream ${m} as a ${d}: ${f}`)}})}trimBackBuffer_(e){const t=Dae(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);t>0&&this.remove(0,t)}createSimplifiedSegmentObj_(e){const t=e.segment,r=e.part,o={resolvedUri:r?r.resolvedUri:t.resolvedUri,byterange:r?r.byterange:t.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,part:e.part},u=e.playlist.segments[e.mediaIndex-1];if(u&&u.timeline===t.timeline&&(u.videoTimingInfo?o.baseStartTime=u.videoTimingInfo.transmuxedDecodeEnd:u.audioTimingInfo&&(o.baseStartTime=u.audioTimingInfo.transmuxedDecodeEnd)),t.key){const h=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);o.key=this.segmentKey(t.key),o.key.iv=h}return t.map&&(o.map=this.initSegmentForMap(t.map)),o}saveTransferStats_(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)}saveBandwidthRelatedStats_(e,t){if(this.pendingSegment_.byteLength=t.bytesReceived,e<lE){this.logger_(`Ignoring segment's bandwidth because its duration of ${e} is less than the min to record ${lE}`);return}this.bandwidth=t.bandwidth,this.roundTrip=t.roundTripTime}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(e,t,r){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,t,r));return}if(this.saveTransferStats_(t.stats),!this.pendingSegment_||t.requestId!==this.pendingSegment_.requestId)return;if(e){if(this.pendingSegment_=null,this.state="READY",e.code===Cl.ABORTED)return;if(this.pause(),e.code===Cl.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1,this.error(e),this.trigger("error");return}const o=this.pendingSegment_;this.saveBandwidthRelatedStats_(o.duration,t.stats),o.endOfAllRequests=t.endOfAllRequests,r.gopInfo&&(this.gopBuffer_=Aae(this.gopBuffer_,r.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(o)}setTimeMapping_(e){const t=this.syncController_.mappingForTimeline(e);t!==null&&(this.timeMapping_=t)}updateMediaSecondsLoaded_(e){typeof e.start=="number"&&typeof e.end=="number"?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration}shouldUpdateTransmuxerTimestampOffset_(e){return e===null?!1:this.loaderType_==="main"&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset()}trueSegmentStart_({currentStart:e,playlist:t,mediaIndex:r,firstVideoFrameTimeForData:o,currentVideoTimestampOffset:u,useVideoTimingInfo:h,videoTimingInfo:f,audioTimingInfo:d}){if(typeof e<"u")return e;if(!h)return d.start;const m=t.segments[r-1];return r===0||!m||typeof m.start>"u"||m.end!==o+u?o:f.start}waitForAppendsToComplete_(e){const t=this.getCurrentMediaInfo_(e);if(!t){this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:1/0}),this.trigger("error");return}const{hasAudio:r,hasVideo:o,isMuxed:u}=t,h=this.loaderType_==="main"&&o,f=!this.audioDisabled_&&r&&!u;if(e.waitingOnAppends=0,!e.hasAppendedData_){!e.timingInfo&&typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),this.checkAppendsDone_(e);return}h&&e.waitingOnAppends++,f&&e.waitingOnAppends++,h&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),f&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))}checkAppendsDone_(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,e.waitingOnAppends===0&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(e){const t=bae(this.loaderType_,this.getCurrentMediaInfo_(),e);return t?(this.error({message:t,playlistExclusionDuration:1/0}),this.trigger("error"),!0):!1}updateSourceBufferTimestampOffset_(e){if(e.timestampOffset===null||typeof e.timingInfo.start!="number"||e.changedTimestampOffset||this.loaderType_!=="main")return;let t=!1;e.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e.segment.videoTimingInfo,audioTimingInfo:e.segment.audioTimingInfo,timingInfo:e.timingInfo}),e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),t=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),t=!0),t&&this.trigger("timestampoffset")}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e,audioTimingInfo:t,timingInfo:r}){return this.useDtsForTimestampOffset_?e&&typeof e.transmuxedDecodeStart=="number"?e.transmuxedDecodeStart:t&&typeof t.transmuxedDecodeStart=="number"?t.transmuxedDecodeStart:r.start:r.start}updateTimingInfoEnd_(e){e.timingInfo=e.timingInfo||{};const t=this.getMediaInfo_(),o=this.loaderType_==="main"&&t&&t.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;o&&(e.timingInfo.end=typeof o.end=="number"?o.end:o.start+e.duration)}handleAppendsDone_(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_){this.state="READY",this.paused()||this.monitorBuffer_();return}const e=this.pendingSegment_;this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:this.loaderType_==="main"});const t=Mae(e,this.sourceType_);if(t&&(t.severity==="warn"?jt.log.warn(t.message):this.logger_(t.message)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest&&(this.trigger("syncinfoupdate"),!e.hasAppendedData_)){this.logger_(`Throwing away un-appended sync request ${th(e)}`);return}this.logger_(`Appended ${th(e)}`),this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),this.loaderType_==="main"&&!this.audioDisabled_&&this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");const r=e.segment,o=e.part,u=r.end&&this.currentTime_()-r.end>e.playlist.targetDuration*3,h=o&&o.end&&this.currentTime_()-o.end>e.playlist.partTargetDuration*3;if(u||h){this.logger_(`bad ${u?"segment":"part"} ${th(e)}`),this.resetEverything();return}this.mediaIndex!==null&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.partIndex=e.partIndex,this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex)&&this.endOfStream(),this.trigger("appended"),e.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}recordThroughput_(e){if(e.duration<lE){this.logger_(`Ignoring segment's throughput because its duration of ${e.duration} is less than the min to record ${lE}`);return}const t=this.throughput.rate,r=Date.now()-e.endOfAllRequests+1,o=Math.floor(e.byteLength/r*8*1e3);this.throughput.rate+=(o-t)/++this.throughput.count}addSegmentMetadataCue_(e){if(!this.segmentMetadataTrack_)return;const t=e.segment,r=t.start,o=t.end;if(!iB(r)||!iB(o))return;im(r,o,this.segmentMetadataTrack_);const u=rt.WebKitDataCue||rt.VTTCue,h={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:r,end:o},f=JSON.stringify(h),d=new u(r,o,f);d.value=h,this.segmentMetadataTrack_.addCue(d)}}function xu(){}const zG=function(n){return typeof n!="string"?n:n.replace(/./,e=>e.toUpperCase())},wae=["video","audio"],Lb=(n,e)=>{const t=e[`${n}Buffer`];return t&&t.updating||e.queuePending[n]},Oae=(n,e)=>{for(let t=0;t<e.length;t++){const r=e[t];if(r.type==="mediaSource")return null;if(r.type===n)return t}return null},jh=(n,e)=>{if(e.queue.length===0)return;let t=0,r=e.queue[t];if(r.type==="mediaSource"){!e.updating()&&e.mediaSource.readyState!=="closed"&&(e.queue.shift(),r.action(e),r.doneFn&&r.doneFn(),jh("audio",e),jh("video",e));return}if(n!=="mediaSource"&&!(!e.ready()||e.mediaSource.readyState==="closed"||Lb(n,e))){if(r.type!==n){if(t=Oae(n,e.queue),t===null)return;r=e.queue[t]}if(e.queue.splice(t,1),e.queuePending[n]=r,r.action(n,e),!r.doneFn){e.queuePending[n]=null,jh(n,e);return}}},YG=(n,e)=>{const t=e[`${n}Buffer`],r=zG(n);t&&(t.removeEventListener("updateend",e[`on${r}UpdateEnd_`]),t.removeEventListener("error",e[`on${r}Error_`]),e.codecs[n]=null,e[`${n}Buffer`]=null)},El=(n,e)=>n&&e&&Array.prototype.indexOf.call(n.sourceBuffers,e)!==-1,Fa={appendBuffer:(n,e,t)=>(r,o)=>{const u=o[`${r}Buffer`];if(El(o.mediaSource,u)){o.logger_(`Appending segment ${e.mediaIndex}'s ${n.length} bytes to ${r}Buffer`);try{u.appendBuffer(n)}catch(h){o.logger_(`Error with code ${h.code} `+(h.code===$G?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${e.mediaIndex} to ${r}Buffer`),o.queuePending[r]=null,t(h)}}},remove:(n,e)=>(t,r)=>{const o=r[`${t}Buffer`];if(El(r.mediaSource,o)){r.logger_(`Removing ${n} to ${e} from ${t}Buffer`);try{o.remove(n,e)}catch{r.logger_(`Remove ${n} to ${e} from ${t}Buffer failed`)}}},timestampOffset:n=>(e,t)=>{const r=t[`${e}Buffer`];El(t.mediaSource,r)&&(t.logger_(`Setting ${e}timestampOffset to ${n}`),r.timestampOffset=n)},callback:n=>(e,t)=>{n()},endOfStream:n=>e=>{if(e.mediaSource.readyState==="open"){e.logger_(`Calling mediaSource endOfStream(${n||""})`);try{e.mediaSource.endOfStream(n)}catch(t){jt.log.warn("Failed to call media source endOfStream",t)}}},duration:n=>e=>{e.logger_(`Setting mediaSource duration to ${n}`);try{e.mediaSource.duration=n}catch(t){jt.log.warn("Failed to set media source duration",t)}},abort:()=>(n,e)=>{if(e.mediaSource.readyState!=="open")return;const t=e[`${n}Buffer`];if(El(e.mediaSource,t)){e.logger_(`calling abort on ${n}Buffer`);try{t.abort()}catch(r){jt.log.warn(`Failed to abort on ${n}Buffer`,r)}}},addSourceBuffer:(n,e)=>t=>{const r=zG(n),o=Jm(e);t.logger_(`Adding ${n}Buffer with codec ${e} to mediaSource`);const u=t.mediaSource.addSourceBuffer(o);u.addEventListener("updateend",t[`on${r}UpdateEnd_`]),u.addEventListener("error",t[`on${r}Error_`]),t.codecs[n]=e,t[`${n}Buffer`]=u},removeSourceBuffer:n=>e=>{const t=e[`${n}Buffer`];if(YG(n,e),!!El(e.mediaSource,t)){e.logger_(`Removing ${n}Buffer with codec ${e.codecs[n]} from mediaSource`);try{e.mediaSource.removeSourceBuffer(t)}catch(r){jt.log.warn(`Failed to removeSourceBuffer ${n}Buffer`,r)}}},changeType:n=>(e,t)=>{const r=t[`${e}Buffer`],o=Jm(n);El(t.mediaSource,r)&&t.codecs[e]!==n&&(t.logger_(`changing ${e}Buffer codec from ${t.codecs[e]} to ${n}`),r.changeType(o),t.codecs[e]=n)}},ka=({type:n,sourceUpdater:e,action:t,doneFn:r,name:o})=>{e.queue.push({type:n,action:t,doneFn:r,name:o}),jh(n,e)},lB=(n,e)=>t=>{if(e.queuePending[n]){const r=e.queuePending[n].doneFn;e.queuePending[n]=null,r&&r(e[`${n}Error_`])}jh(n,e)};class XG extends jt.EventTarget{constructor(e){super(),this.mediaSource=e,this.sourceopenListener_=()=>jh("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=Jo("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=lB("video",this),this.onAudioUpdateEnd_=lB("audio",this),this.onVideoError_=t=>{this.videoError_=t},this.onAudioError_=t=>{this.audioError_=t},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(e){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(e),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(e,t){ka({type:"mediaSource",sourceUpdater:this,action:Fa.addSourceBuffer(e,t),name:"addSourceBuffer"})}abort(e){ka({type:e,sourceUpdater:this,action:Fa.abort(e),name:"abort"})}removeSourceBuffer(e){if(!this.canRemoveSourceBuffer()){jt.log.error("removeSourceBuffer is not supported!");return}ka({type:"mediaSource",sourceUpdater:this,action:Fa.removeSourceBuffer(e),name:"removeSourceBuffer"})}canRemoveSourceBuffer(){return!jt.browser.IE_VERSION&&!jt.browser.IS_FIREFOX&&rt.MediaSource&&rt.MediaSource.prototype&&typeof rt.MediaSource.prototype.removeSourceBuffer=="function"}static canChangeType(){return rt.SourceBuffer&&rt.SourceBuffer.prototype&&typeof rt.SourceBuffer.prototype.changeType=="function"}canChangeType(){return this.constructor.canChangeType()}changeType(e,t){if(!this.canChangeType()){jt.log.error("changeType is not supported!");return}ka({type:e,sourceUpdater:this,action:Fa.changeType(t),name:"changeType"})}addOrChangeSourceBuffers(e){if(!e||typeof e!="object"||Object.keys(e).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach(t=>{const r=e[t];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(t,r);this.canChangeType()&&this.changeType(t,r)})}appendBuffer(e,t){const{segmentInfo:r,type:o,bytes:u}=e;if(this.processedAppend_=!0,o==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([e,t]),this.logger_(`delayed audio append of ${u.length} until video append`);return}const h=t;if(ka({type:o,sourceUpdater:this,action:Fa.appendBuffer(u,r||{mediaIndex:-1},h),doneFn:t,name:"appendBuffer"}),o==="video"){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;const f=this.delayedAudioAppendQueue_.slice();this.logger_(`queuing delayed audio ${f.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,f.forEach(d=>{this.appendBuffer.apply(this,d)})}}audioBuffered(){return El(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:xs()}videoBuffered(){return El(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:xs()}buffered(){const e=El(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,t=El(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return t&&!e?this.audioBuffered():e&&!t?this.videoBuffered():ese(this.audioBuffered(),this.videoBuffered())}setDuration(e,t=xu){ka({type:"mediaSource",sourceUpdater:this,action:Fa.duration(e),name:"duration",doneFn:t})}endOfStream(e=null,t=xu){typeof e!="string"&&(e=void 0),ka({type:"mediaSource",sourceUpdater:this,action:Fa.endOfStream(e),name:"endOfStream",doneFn:t})}removeAudio(e,t,r=xu){if(!this.audioBuffered().length||this.audioBuffered().end(0)===0){r();return}ka({type:"audio",sourceUpdater:this,action:Fa.remove(e,t),doneFn:r,name:"remove"})}removeVideo(e,t,r=xu){if(!this.videoBuffered().length||this.videoBuffered().end(0)===0){r();return}ka({type:"video",sourceUpdater:this,action:Fa.remove(e,t),doneFn:r,name:"remove"})}updating(){return!!(Lb("audio",this)||Lb("video",this))}audioTimestampOffset(e){return typeof e<"u"&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(ka({type:"audio",sourceUpdater:this,action:Fa.timestampOffset(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_}videoTimestampOffset(e){return typeof e<"u"&&this.videoBuffer&&this.videoTimestampOffset!==e&&(ka({type:"video",sourceUpdater:this,action:Fa.timestampOffset(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_}audioQueueCallback(e){this.audioBuffer&&ka({type:"audio",sourceUpdater:this,action:Fa.callback(e),name:"callback"})}videoQueueCallback(e){this.videoBuffer&&ka({type:"video",sourceUpdater:this,action:Fa.callback(e),name:"callback"})}dispose(){this.trigger("dispose"),wae.forEach(e=>{this.abort(e),this.canRemoveSourceBuffer()?this.removeSourceBuffer(e):this[`${e}QueueCallback`](()=>YG(e,this))}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}const uB=n=>decodeURIComponent(escape(String.fromCharCode.apply(null,n))),cB=new Uint8Array(`

`.split("").map(n=>n.charCodeAt(0)));class Nae extends Error{constructor(){super("Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}}class Fae extends Pb{constructor(e,t={}){super(e,t),this.mediaSource_=null,this.subtitlesTrack_=null,this.loaderType_="subtitle",this.featuresNativeTextTracks_=e.featuresNativeTextTracks,this.loadVttJs=e.loadVttJs,this.shouldSaveSegmentTimingInfo_=!1}createTransmuxer_(){return null}buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return xs();const e=this.subtitlesTrack_.cues,t=e[0].startTime,r=e[e.length-1].startTime;return xs([[t,r]])}initSegmentForMap(e,t=!1){if(!e)return null;const r=V_(e);let o=this.initSegments_[r];if(t&&!o&&e.bytes){const u=cB.byteLength+e.bytes.byteLength,h=new Uint8Array(u);h.set(e.bytes),h.set(cB,e.bytes.byteLength),this.initSegments_[r]=o={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:h}}return o||e}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(e){return typeof e>"u"?this.subtitlesTrack_:(this.subtitlesTrack_=e,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}remove(e,t){im(e,t,this.subtitlesTrack_)}fillBuffer_(){const e=this.chooseNextRequest_();if(e){if(this.syncController_.timestampOffsetForTimeline(e.timeline)===null){const t=()=>{this.state="READY",this.paused()||this.monitorBuffer_()};this.syncController_.one("timestampoffset",t),this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(e)}}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(e){for(;e&&e.segment.empty;){if(e.mediaIndex+1>=e.playlist.segments.length){e=null;break}e=this.generateSegmentInfo_({playlist:e.playlist,mediaIndex:e.mediaIndex+1,startOfSegment:e.startOfSegment+e.duration,isSyncRequest:e.isSyncRequest})}return e}stopForError(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(e,t,r){if(!this.subtitlesTrack_){this.state="READY";return}if(this.saveTransferStats_(t.stats),!this.pendingSegment_){this.state="READY",this.mediaRequestsAborted+=1;return}if(e){e.code===Cl.TIMEOUT&&this.handleTimeout_(),e.code===Cl.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(e);return}const o=this.pendingSegment_;this.saveBandwidthRelatedStats_(o.duration,t.stats),t.key&&this.segmentKey(t.key,!0),this.state="APPENDING",this.trigger("appending");const u=o.segment;if(u.map&&(u.map.bytes=t.map.bytes),o.bytes=t.bytes,typeof rt.WebVTT!="function"&&typeof this.loadVttJs=="function"){this.state="WAITING_ON_VTTJS",this.loadVttJs().then(()=>this.segmentRequestFinished_(e,t,r),()=>this.stopForError({message:"Error loading vtt.js"}));return}u.requested=!0;try{this.parseVTTCues_(o)}catch(h){this.stopForError({message:h.message});return}if(this.updateTimeMapping_(o,this.syncController_.timelines[o.timeline],this.playlist_),o.cues.length?o.timingInfo={start:o.cues[0].startTime,end:o.cues[o.cues.length-1].endTime}:o.timingInfo={start:o.startOfSegment,end:o.startOfSegment+o.duration},o.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}o.byteLength=o.bytes.byteLength,this.mediaSecondsLoaded+=u.duration,o.cues.forEach(h=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new rt.VTTCue(h.startTime,h.endTime,h.text):h)}),Tae(this.subtitlesTrack_),this.handleAppendsDone_()}handleData_(){}updateTimingInfoEnd_(){}parseVTTCues_(e){let t,r=!1;if(typeof rt.WebVTT!="function")throw new Nae;typeof rt.TextDecoder=="function"?t=new rt.TextDecoder("utf8"):(t=rt.WebVTT.StringDecoder(),r=!0);const o=new rt.WebVTT.Parser(rt,rt.vttjs,t);if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},o.oncue=e.cues.push.bind(e.cues),o.ontimestampmap=h=>{e.timestampmap=h},o.onparsingerror=h=>{jt.log.warn("Error encountered when parsing cues: "+h.message)},e.segment.map){let h=e.segment.map.bytes;r&&(h=uB(h)),o.parse(h)}let u=e.bytes;r&&(u=uB(u)),o.parse(u),o.flush()}updateTimeMapping_(e,t,r){const o=e.segment;if(!t)return;if(!e.cues.length){o.empty=!0;return}const u=e.timestampmap,h=u.MPEGTS/L_.ONE_SECOND_IN_TS-u.LOCAL+t.mapping;if(e.cues.forEach(f=>{f.startTime+=h,f.endTime+=h}),!r.syncInfo){const f=e.cues[0].startTime,d=e.cues[e.cues.length-1].startTime;r.syncInfo={mediaSequence:r.mediaSequence+e.mediaIndex,time:Math.min(f,d-o.duration)}}}}const kae=function(n,e){const t=n.cues;for(let r=0;r<t.length;r++){const o=t[r];if(e>=o.adStartTime&&e<=o.adEndTime)return o}return null},Uae=function(n,e,t=0){if(!n.segments)return;let r=t,o;for(let u=0;u<n.segments.length;u++){const h=n.segments[u];if(o||(o=kae(e,r+h.duration/2)),o){if("cueIn"in h){o.endTime=r,o.adEndTime=r,r+=h.duration,o=null;continue}if(r<o.endTime){r+=h.duration;continue}o.endTime+=h.duration}else if("cueOut"in h&&(o=new rt.VTTCue(r,r+h.duration,h.cueOut),o.adStartTime=r,o.adEndTime=r+parseFloat(h.cueOut),e.addCue(o)),"cueOutCont"in h){const[f,d]=h.cueOutCont.split("/").map(parseFloat);o=new rt.VTTCue(r,r+h.duration,""),o.adStartTime=r-f,o.adEndTime=o.adStartTime+d,e.addCue(o)}r+=h.duration}},Bae=86400,fB=[{name:"VOD",run:(n,e,t,r,o)=>t!==1/0?{time:0,segmentIndex:0,partIndex:null}:null},{name:"ProgramDateTime",run:(n,e,t,r,o)=>{if(!Object.keys(n.timelineToDatetimeMappings).length)return null;let u=null,h=null;const f=Sb(e);o=o||0;for(let d=0;d<f.length;d++){const m=e.endList||o===0?d:f.length-(d+1),g=f[m],v=g.segment,_=n.timelineToDatetimeMappings[v.timeline];if(!_||!v.dateTimeObject)continue;let E=v.dateTimeObject.getTime()/1e3+_;if(v.parts&&typeof g.partIndex=="number")for(let C=0;C<g.partIndex;C++)E+=v.parts[C].duration;const T=Math.abs(o-E);if(h!==null&&(T===0||h<T))break;h=T,u={time:E,segmentIndex:g.segmentIndex,partIndex:g.partIndex}}return u}},{name:"Segment",run:(n,e,t,r,o)=>{let u=null,h=null;o=o||0;const f=Sb(e);for(let d=0;d<f.length;d++){const m=e.endList||o===0?d:f.length-(d+1),g=f[m],v=g.segment,_=g.part&&g.part.start||v&&v.start;if(v.timeline===r&&typeof _<"u"){const S=Math.abs(o-_);if(h!==null&&h<S)break;(!u||h===null||h>=S)&&(h=S,u={time:_,segmentIndex:g.segmentIndex,partIndex:g.partIndex})}}return u}},{name:"Discontinuity",run:(n,e,t,r,o)=>{let u=null;if(o=o||0,e.discontinuityStarts&&e.discontinuityStarts.length){let h=null;for(let f=0;f<e.discontinuityStarts.length;f++){const d=e.discontinuityStarts[f],m=e.discontinuitySequence+f+1,g=n.discontinuities[m];if(g){const v=Math.abs(o-g.time);if(h!==null&&h<v)break;(!u||h===null||h>=v)&&(h=v,u={time:g.time,segmentIndex:d,partIndex:null})}}}return u}},{name:"Playlist",run:(n,e,t,r,o)=>e.syncInfo?{time:e.syncInfo.time,segmentIndex:e.syncInfo.mediaSequence-e.mediaSequence,partIndex:null}:null}];class jae extends jt.EventTarget{constructor(e={}){super(),this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={},this.logger_=Jo("SyncController")}getSyncPoint(e,t,r,o){const u=this.runStrategies_(e,t,r,o);return u.length?this.selectSyncPoint_(u,{key:"time",value:o}):null}getExpiredTime(e,t){if(!e||!e.segments)return null;const r=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!r.length)return null;const o=this.selectSyncPoint_(r,{key:"segmentIndex",value:0});return o.segmentIndex>0&&(o.time*=-1),Math.abs(o.time+_m({defaultDuration:e.targetDuration,durationList:e.segments,startIndex:o.segmentIndex,endIndex:0}))}runStrategies_(e,t,r,o){const u=[];for(let h=0;h<fB.length;h++){const f=fB[h],d=f.run(this,e,t,r,o);d&&(d.strategy=f.name,u.push({strategy:f.name,syncPoint:d}))}return u}selectSyncPoint_(e,t){let r=e[0].syncPoint,o=Math.abs(e[0].syncPoint[t.key]-t.value),u=e[0].strategy;for(let h=1;h<e.length;h++){const f=Math.abs(e[h].syncPoint[t.key]-t.value);f<o&&(o=f,r=e[h].syncPoint,u=e[h].strategy)}return this.logger_(`syncPoint for [${t.key}: ${t.value}] chosen with strategy [${u}]: [time:${r.time}, segmentIndex:${r.segmentIndex}`+(typeof r.partIndex=="number"?`,partIndex:${r.partIndex}`:"")+"]"),r}saveExpiredSegmentInfo(e,t){const r=t.mediaSequence-e.mediaSequence;if(r>Bae){jt.log.warn(`Not saving expired segment info. Media sequence gap ${r} is too large.`);return}for(let o=r-1;o>=0;o--){const u=e.segments[o];if(u&&typeof u.start<"u"){t.syncInfo={mediaSequence:e.mediaSequence+o,time:u.start},this.logger_(`playlist refresh sync: [time:${t.syncInfo.time}, mediaSequence: ${t.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(e){if(this.timelineToDatetimeMappings={},e.segments&&e.segments.length&&e.segments[0].dateTimeObject){const t=e.segments[0],r=t.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[t.timeline]=-r}}saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:t}){const r=this.calculateSegmentTimeMapping_(e,e.timingInfo,t),o=e.segment;r&&(this.saveDiscontinuitySyncInfo_(e),e.playlist.syncInfo||(e.playlist.syncInfo={mediaSequence:e.playlist.mediaSequence+e.mediaIndex,time:o.start}));const u=o.dateTimeObject;o.discontinuity&&t&&u&&(this.timelineToDatetimeMappings[o.timeline]=-(u.getTime()/1e3))}timestampOffsetForTimeline(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].time}mappingForTimeline(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].mapping}calculateSegmentTimeMapping_(e,t,r){const o=e.segment,u=e.part;let h=this.timelines[e.timeline],f,d;if(typeof e.timestampOffset=="number")h={time:e.startOfSegment,mapping:e.startOfSegment-t.start},r&&(this.timelines[e.timeline]=h,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${e.timeline}: [time: ${h.time}] [mapping: ${h.mapping}]`)),f=e.startOfSegment,d=t.end+h.mapping;else if(h)f=t.start+h.mapping,d=t.end+h.mapping;else return!1;return u&&(u.start=f,u.end=d),(!o.start||f<o.start)&&(o.start=f),o.end=d,!0}saveDiscontinuitySyncInfo_(e){const t=e.playlist,r=e.segment;if(r.discontinuity)this.discontinuities[r.timeline]={time:r.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(let o=0;o<t.discontinuityStarts.length;o++){const u=t.discontinuityStarts[o],h=t.discontinuitySequence+o+1,f=u-e.mediaIndex,d=Math.abs(f);if(!this.discontinuities[h]||this.discontinuities[h].accuracy>d){let m;f<0?m=r.start-_m({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex,endIndex:u}):m=r.end+_m({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex+1,endIndex:u}),this.discontinuities[h]={time:m,accuracy:d}}}}dispose(){this.trigger("dispose"),this.off()}}class Kae extends jt.EventTarget{constructor(){super(),this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:e,from:t,to:r}){return typeof t=="number"&&typeof r=="number"&&(this.pendingTimelineChanges_[e]={type:e,from:t,to:r},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[e]}lastTimelineChange({type:e,from:t,to:r}){return typeof t=="number"&&typeof r=="number"&&(this.lastTimelineChanges_[e]={type:e,from:t,to:r},delete this.pendingTimelineChanges_[e],this.trigger("timelinechange")),this.lastTimelineChanges_[e]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}const Gae=NG(FG(function(){var n=function(){function T(){this.listeners={}}var C=T.prototype;return C.on=function(b,F){this.listeners[b]||(this.listeners[b]=[]),this.listeners[b].push(F)},C.off=function(b,F){if(!this.listeners[b])return!1;var O=this.listeners[b].indexOf(F);return this.listeners[b]=this.listeners[b].slice(0),this.listeners[b].splice(O,1),O>-1},C.trigger=function(b){var F=this.listeners[b];if(F)if(arguments.length===2)for(var O=F.length,L=0;L<O;++L)F[L].call(this,arguments[1]);else for(var D=Array.prototype.slice.call(arguments,1),x=F.length,B=0;B<x;++B)F[B].apply(this,D)},C.dispose=function(){this.listeners={}},C.pipe=function(b){this.on("data",function(F){b.push(F)})},T}();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */function e(T){return T.subarray(0,T.byteLength-T[T.byteLength-1])}/*! @name aes-decrypter @version 4.0.1 @license Apache-2.0 */const t=function(){const T=[[[],[],[],[],[]],[[],[],[],[],[]]],C=T[0],R=T[1],b=C[4],F=R[4];let O,L,D;const x=[],B=[];let M,I,U,w,k,K;for(O=0;O<256;O++)B[(x[O]=O<<1^(O>>7)*283)^O]=O;for(L=D=0;!b[L];L^=M||1,D=B[D]||1)for(w=D^D<<1^D<<2^D<<3^D<<4,w=w>>8^w&255^99,b[L]=w,F[w]=L,U=x[I=x[M=x[L]]],K=U*16843009^I*65537^M*257^L*16843008,k=x[w]*257^w*16843008,O=0;O<4;O++)C[O][L]=k=k<<24^k>>>8,R[O][w]=K=K<<24^K>>>8;for(O=0;O<5;O++)C[O]=C[O].slice(0),R[O]=R[O].slice(0);return T};let r=null;class o{constructor(C){r||(r=t()),this._tables=[[r[0][0].slice(),r[0][1].slice(),r[0][2].slice(),r[0][3].slice(),r[0][4].slice()],[r[1][0].slice(),r[1][1].slice(),r[1][2].slice(),r[1][3].slice(),r[1][4].slice()]];let R,b,F;const O=this._tables[0][4],L=this._tables[1],D=C.length;let x=1;if(D!==4&&D!==6&&D!==8)throw new Error("Invalid aes key size");const B=C.slice(0),M=[];for(this._key=[B,M],R=D;R<4*D+28;R++)F=B[R-1],(R%D===0||D===8&&R%D===4)&&(F=O[F>>>24]<<24^O[F>>16&255]<<16^O[F>>8&255]<<8^O[F&255],R%D===0&&(F=F<<8^F>>>24^x<<24,x=x<<1^(x>>7)*283)),B[R]=B[R-D]^F;for(b=0;R;b++,R--)F=B[b&3?R:R-4],R<=4||b<4?M[b]=F:M[b]=L[0][O[F>>>24]]^L[1][O[F>>16&255]]^L[2][O[F>>8&255]]^L[3][O[F&255]]}decrypt(C,R,b,F,O,L){const D=this._key[1];let x=C^D[0],B=F^D[1],M=b^D[2],I=R^D[3],U,w,k;const K=D.length/4-2;let W,Y=4;const J=this._tables[1],ee=J[0],ue=J[1],ie=J[2],Q=J[3],se=J[4];for(W=0;W<K;W++)U=ee[x>>>24]^ue[B>>16&255]^ie[M>>8&255]^Q[I&255]^D[Y],w=ee[B>>>24]^ue[M>>16&255]^ie[I>>8&255]^Q[x&255]^D[Y+1],k=ee[M>>>24]^ue[I>>16&255]^ie[x>>8&255]^Q[B&255]^D[Y+2],I=ee[I>>>24]^ue[x>>16&255]^ie[B>>8&255]^Q[M&255]^D[Y+3],Y+=4,x=U,B=w,M=k;for(W=0;W<4;W++)O[(3&-W)+L]=se[x>>>24]<<24^se[B>>16&255]<<16^se[M>>8&255]<<8^se[I&255]^D[Y++],U=x,x=B,B=M,M=I,I=U}}class u extends n{constructor(){super(n),this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(C){this.jobs.push(C),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}const h=function(T){return T<<24|(T&65280)<<8|(T&16711680)>>8|T>>>24},f=function(T,C,R){const b=new Int32Array(T.buffer,T.byteOffset,T.byteLength>>2),F=new o(Array.prototype.slice.call(C)),O=new Uint8Array(T.byteLength),L=new Int32Array(O.buffer);let D,x,B,M,I,U,w,k,K;for(D=R[0],x=R[1],B=R[2],M=R[3],K=0;K<b.length;K+=4)I=h(b[K]),U=h(b[K+1]),w=h(b[K+2]),k=h(b[K+3]),F.decrypt(I,U,w,k,L,K),L[K]=h(L[K]^D),L[K+1]=h(L[K+1]^x),L[K+2]=h(L[K+2]^B),L[K+3]=h(L[K+3]^M),D=I,x=U,B=w,M=k;return O};class d{constructor(C,R,b,F){const O=d.STEP,L=new Int32Array(C.buffer),D=new Uint8Array(C.byteLength);let x=0;for(this.asyncStream_=new u,this.asyncStream_.push(this.decryptChunk_(L.subarray(x,x+O),R,b,D)),x=O;x<L.length;x+=O)b=new Uint32Array([h(L[x-4]),h(L[x-3]),h(L[x-2]),h(L[x-1])]),this.asyncStream_.push(this.decryptChunk_(L.subarray(x,x+O),R,b,D));this.asyncStream_.push(function(){F(null,e(D))})}static get STEP(){return 32e3}decryptChunk_(C,R,b,F){return function(){const O=f(C,R,b);F.set(O,C.byteOffset)}}}var m=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},g;typeof window<"u"?g=window:typeof m<"u"?g=m:typeof self<"u"?g=self:g={};var v=g,_=function(C){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(C):C&&C.buffer instanceof ArrayBuffer},S=v.BigInt||Number;S("0x1"),S("0x100"),S("0x10000"),S("0x1000000"),S("0x100000000"),S("0x10000000000"),S("0x1000000000000"),S("0x100000000000000"),S("0x10000000000000000"),function(){var T=new Uint16Array([65484]),C=new Uint8Array(T.buffer,T.byteOffset,T.byteLength);return C[0]===255?"big":C[0]===204?"little":"unknown"}();const E=function(T){const C={};return Object.keys(T).forEach(R=>{const b=T[R];_(b)?C[R]={bytes:b.buffer,byteOffset:b.byteOffset,byteLength:b.byteLength}:C[R]=b}),C};self.onmessage=function(T){const C=T.data,R=new Uint8Array(C.encrypted.bytes,C.encrypted.byteOffset,C.encrypted.byteLength),b=new Uint32Array(C.key.bytes,C.key.byteOffset,C.key.byteLength/4),F=new Uint32Array(C.iv.bytes,C.iv.byteOffset,C.iv.byteLength/4);new d(R,b,F,function(O,L){self.postMessage(E({source:C.source,decrypted:L}),[L.buffer])})}}));var Wae=OG(Gae);const Hae=n=>{let e=n.default?"main":"alternative";return n.characteristics&&n.characteristics.indexOf("public.accessibility.describes-video")>=0&&(e="main-desc"),e},X_=(n,e)=>{n.abort(),n.pause(),e&&e.activePlaylistLoader&&(e.activePlaylistLoader.pause(),e.activePlaylistLoader=null)},Mb=(n,e)=>{e.activePlaylistLoader=n,n.load()},Vae=(n,e)=>()=>{const{segmentLoaders:{[n]:t,main:r},mediaTypes:{[n]:o}}=e,u=o.activeTrack(),h=o.getActiveGroup(),f=o.activePlaylistLoader,d=o.lastGroup_;if(!(h&&d&&h.id===d.id)&&(o.lastGroup_=h,o.lastTrack_=u,X_(t,o),!(!h||h.isMainPlaylist))){if(!h.playlistLoader){f&&r.resetEverything();return}t.resyncLoader(),Mb(h.playlistLoader,o)}},$ae=(n,e)=>()=>{const{segmentLoaders:{[n]:t},mediaTypes:{[n]:r}}=e;r.lastGroup_=null,t.abort(),t.pause()},zae=(n,e)=>()=>{const{mainPlaylistLoader:t,segmentLoaders:{[n]:r,main:o},mediaTypes:{[n]:u}}=e,h=u.activeTrack(),f=u.getActiveGroup(),d=u.activePlaylistLoader,m=u.lastTrack_;if(!(m&&h&&m.id===h.id)&&(u.lastGroup_=f,u.lastTrack_=h,X_(r,u),!!f)){if(f.isMainPlaylist){if(!h||!m||h.id===m.id)return;const g=e.vhs.playlistController_,v=g.selectPlaylist();if(g.media()===v)return;u.logger_(`track change. Switching main audio from ${m.id} to ${h.id}`),t.pause(),o.resetEverything(),g.fastQualityChange_(v);return}if(n==="AUDIO"){if(!f.playlistLoader){o.setAudio(!0),o.resetEverything();return}r.setAudio(!0),o.setAudio(!1)}if(d===f.playlistLoader){Mb(f.playlistLoader,u);return}r.track&&r.track(h),r.resetEverything(),Mb(f.playlistLoader,u)}},q_={AUDIO:(n,e)=>()=>{const{segmentLoaders:{[n]:t},mediaTypes:{[n]:r},excludePlaylist:o}=e;X_(t,r);const u=r.activeTrack(),h=r.activeGroup(),f=(h.filter(m=>m.default)[0]||h[0]).id,d=r.tracks[f];if(u===d){o({error:{message:"Problem encountered loading the default audio track."}});return}jt.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const m in r.tracks)r.tracks[m].enabled=r.tracks[m]===d;r.onTrackChanged()},SUBTITLES:(n,e)=>()=>{const{segmentLoaders:{[n]:t},mediaTypes:{[n]:r}}=e;jt.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),X_(t,r);const o=r.activeTrack();o&&(o.mode="disabled"),r.onTrackChanged()}},dB={AUDIO:(n,e,t)=>{if(!e)return;const{tech:r,requestOptions:o,segmentLoaders:{[n]:u}}=t;e.on("loadedmetadata",()=>{const h=e.media();u.playlist(h,o),(!r.paused()||h.endList&&r.preload()!=="none")&&u.load()}),e.on("loadedplaylist",()=>{u.playlist(e.media(),o),r.paused()||u.load()}),e.on("error",q_[n](n,t))},SUBTITLES:(n,e,t)=>{const{tech:r,requestOptions:o,segmentLoaders:{[n]:u},mediaTypes:{[n]:h}}=t;e.on("loadedmetadata",()=>{const f=e.media();u.playlist(f,o),u.track(h.activeTrack()),(!r.paused()||f.endList&&r.preload()!=="none")&&u.load()}),e.on("loadedplaylist",()=>{u.playlist(e.media(),o),r.paused()||u.load()}),e.on("error",q_[n](n,t))}},Yae={AUDIO:(n,e)=>{const{vhs:t,sourceType:r,segmentLoaders:{[n]:o},requestOptions:u,main:{mediaGroups:h},mediaTypes:{[n]:{groups:f,tracks:d,logger_:m}},mainPlaylistLoader:g}=e,v=I0(g.main);(!h[n]||Object.keys(h[n]).length===0)&&(h[n]={main:{default:{default:!0}}},v&&(h[n].main.default.playlists=g.main.playlists));for(const _ in h[n]){f[_]||(f[_]=[]);for(const S in h[n][_]){let E=h[n][_][S],T;if(v?(m(`AUDIO group '${_}' label '${S}' is a main playlist`),E.isMainPlaylist=!0,T=null):r==="vhs-json"&&E.playlists?T=new Ch(E.playlists[0],t,u):E.resolvedUri?T=new Ch(E.resolvedUri,t,u):E.playlists&&r==="dash"?T=new bb(E.playlists[0],t,u,g):T=null,E=Zr({id:S,playlistLoader:T},E),dB[n](n,E.playlistLoader,e),f[_].push(E),typeof d[S]>"u"){const C=new jt.AudioTrack({id:S,kind:Hae(E),enabled:!1,language:E.language,default:E.default,label:S});d[S]=C}}}o.on("error",q_[n](n,e))},SUBTITLES:(n,e)=>{const{tech:t,vhs:r,sourceType:o,segmentLoaders:{[n]:u},requestOptions:h,main:{mediaGroups:f},mediaTypes:{[n]:{groups:d,tracks:m}},mainPlaylistLoader:g}=e;for(const v in f[n]){d[v]||(d[v]=[]);for(const _ in f[n][v]){if(f[n][v][_].forced)continue;let S=f[n][v][_],E;if(o==="hls")E=new Ch(S.resolvedUri,r,h);else if(o==="dash"){if(!S.playlists.filter(C=>C.excludeUntil!==1/0).length)return;E=new bb(S.playlists[0],r,h,g)}else o==="vhs-json"&&(E=new Ch(S.playlists?S.playlists[0]:S.resolvedUri,r,h));if(S=Zr({id:_,playlistLoader:E},S),dB[n](n,S.playlistLoader,e),d[v].push(S),typeof m[_]>"u"){const T=t.addRemoteTextTrack({id:_,kind:"subtitles",default:S.default&&S.autoselect,language:S.language,label:_},!1).track;m[_]=T}}}u.on("error",q_[n](n,e))},"CLOSED-CAPTIONS":(n,e)=>{const{tech:t,main:{mediaGroups:r},mediaTypes:{[n]:{groups:o,tracks:u}}}=e;for(const h in r[n]){o[h]||(o[h]=[]);for(const f in r[n][h]){const d=r[n][h][f];if(!/^(?:CC|SERVICE)/.test(d.instreamId))continue;const m=t.options_.vhs&&t.options_.vhs.captionServices||{};let g={label:f,language:d.language,instreamId:d.instreamId,default:d.default&&d.autoselect};if(m[g.instreamId]&&(g=Zr(g,m[g.instreamId])),g.default===void 0&&delete g.default,o[h].push(Zr({id:f},d)),typeof u[f]>"u"){const v=t.addRemoteTextTrack({id:g.instreamId,kind:"captions",default:g.default,language:g.language,label:g.label},!1).track;u[f]=v}}}}},qG=(n,e)=>{for(let t=0;t<n.length;t++)if(g1(e,n[t])||n[t].playlists&&qG(n[t].playlists,e))return!0;return!1},Xae=(n,e)=>t=>{const{mainPlaylistLoader:r,mediaTypes:{[n]:{groups:o}}}=e,u=r.media();if(!u)return null;let h=null;u.attributes[n]&&(h=o[u.attributes[n]]);const f=Object.keys(o);if(!h)if(n==="AUDIO"&&f.length>1&&I0(e.main))for(let d=0;d<f.length;d++){const m=o[f[d]];if(qG(m,u)){h=m;break}}else o.main?h=o.main:f.length===1&&(h=o[f[0]]);return typeof t>"u"?h:t===null||!h?null:h.filter(d=>d.id===t.id)[0]||null},qae={AUDIO:(n,e)=>()=>{const{mediaTypes:{[n]:{tracks:t}}}=e;for(const r in t)if(t[r].enabled)return t[r];return null},SUBTITLES:(n,e)=>()=>{const{mediaTypes:{[n]:{tracks:t}}}=e;for(const r in t)if(t[r].mode==="showing"||t[r].mode==="hidden")return t[r];return null}},Qae=(n,{mediaTypes:e})=>()=>{const t=e[n].activeTrack();return t?e[n].activeGroup(t):null},Jae=n=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(m=>{Yae[m](m,n)});const{mediaTypes:e,mainPlaylistLoader:t,tech:r,vhs:o,segmentLoaders:{["AUDIO"]:u,main:h}}=n;["AUDIO","SUBTITLES"].forEach(m=>{e[m].activeGroup=Xae(m,n),e[m].activeTrack=qae[m](m,n),e[m].onGroupChanged=Vae(m,n),e[m].onGroupChanging=$ae(m,n),e[m].onTrackChanged=zae(m,n),e[m].getActiveGroup=Qae(m,n)});const f=e.AUDIO.activeGroup();if(f){const m=(f.filter(v=>v.default)[0]||f[0]).id;e.AUDIO.tracks[m].enabled=!0,e.AUDIO.onGroupChanged(),e.AUDIO.onTrackChanged(),e.AUDIO.getActiveGroup().playlistLoader?(h.setAudio(!1),u.setAudio(!0)):h.setAudio(!0)}t.on("mediachange",()=>{["AUDIO","SUBTITLES"].forEach(m=>e[m].onGroupChanged())}),t.on("mediachanging",()=>{["AUDIO","SUBTITLES"].forEach(m=>e[m].onGroupChanging())});const d=()=>{e.AUDIO.onTrackChanged(),r.trigger({type:"usage",name:"vhs-audio-change"})};r.audioTracks().addEventListener("change",d),r.remoteTextTracks().addEventListener("change",e.SUBTITLES.onTrackChanged),o.on("dispose",()=>{r.audioTracks().removeEventListener("change",d),r.remoteTextTracks().removeEventListener("change",e.SUBTITLES.onTrackChanged)}),r.clearTracks("audio");for(const m in e.AUDIO.tracks)r.audioTracks().addTrack(e.AUDIO.tracks[m])},Zae=()=>{const n={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{n[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:xu,activeTrack:xu,getActiveGroup:xu,onGroupChanged:xu,onTrackChanged:xu,lastTrack_:null,logger_:Jo(`MediaGroups[${e}]`)}}),n},eoe=60*2;let mu;const toe=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],noe=function(n){return this.audioSegmentLoader_[n]+this.mainSegmentLoader_[n]},roe=function({currentPlaylist:n,buffered:e,currentTime:t,nextPlaylist:r,bufferLowWaterLine:o,bufferHighWaterLine:u,duration:h,bufferBasedABR:f,log:d}){if(!r)return jt.log.warn("We received no playlist to switch to. Please check your stream."),!1;const m=`allowing switch ${n&&n.id||"null"} -> ${r.id}`;if(!n)return d(`${m} as current playlist is not set`),!0;if(r.id===n.id)return!1;const g=Boolean(xh(e,t).length);if(!n.endList)return!g&&typeof n.partTargetDuration=="number"?(d(`not ${m} as current playlist is live llhls, but currentTime isn't in buffered.`),!1):(d(`${m} as current playlist is live`),!0);const v=d1(e,t),_=f?is.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:is.MAX_BUFFER_LOW_WATER_LINE;if(h<_)return d(`${m} as duration < max low water line (${h} < ${_})`),!0;const S=r.attributes.BANDWIDTH,E=n.attributes.BANDWIDTH;if(S<E&&(!f||v<u)){let T=`${m} as next bandwidth < current bandwidth (${S} < ${E})`;return f&&(T+=` and forwardBuffer < bufferHighWaterLine (${v} < ${u})`),d(T),!0}if((!f||S>E)&&v>=o){let T=`${m} as forwardBuffer >= bufferLowWaterLine (${v} >= ${o})`;return f&&(T+=` and next bandwidth > current bandwidth (${S} > ${E})`),d(T),!0}return d(`not ${m} as no switching criteria met`),!1};class ioe extends jt.EventTarget{constructor(e){super();const{src:t,withCredentials:r,tech:o,bandwidth:u,externVhs:h,useCueTags:f,playlistExclusionDuration:d,enableLowInitialPlaylist:m,sourceType:g,cacheEncryptionKeys:v,bufferBasedABR:_,leastPixelDiffSelector:S,captionServices:E}=e;if(!t)throw new Error("A non-empty playlist URL or JSON manifest string is required");let{maxPlaylistRetries:T}=e;(T===null||typeof T>"u")&&(T=1/0),mu=h,this.bufferBasedABR=Boolean(_),this.leastPixelDiffSelector=Boolean(S),this.withCredentials=r,this.tech_=o,this.vhs_=o.vhs,this.sourceType_=g,this.useCueTags_=f,this.playlistExclusionDuration=d,this.maxPlaylistRetries=T,this.enableLowInitialPlaylist=m,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:r,maxPlaylistRetries:T,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=Zae(),this.mediaSource=new rt.MediaSource,this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.seekable_=xs(),this.hasPlayed_=!1,this.syncController_=new jae(e),this.segmentMetadataTrack_=o.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.decrypter_=new Wae,this.sourceUpdater_=new XG(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new Kae;const C={vhs:this.vhs_,parse708captions:e.parse708captions,useDtsForTimestampOffset:e.useDtsForTimestampOffset,captionServices:E,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:u,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:v,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:e.exactManifestTimings};this.mainPlaylistLoader_=this.sourceType_==="dash"?new bb(t,this.vhs_,this.requestOptions_):new Ch(t,this.vhs_,this.requestOptions_),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new Pb(Zr(C,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),e),this.audioSegmentLoader_=new Pb(Zr(C,{loaderType:"audio"}),e),this.subtitleSegmentLoader_=new Fae(Zr(C,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks,loadVttJs:()=>new Promise((b,F)=>{function O(){o.off("vttjserror",L),b()}function L(){o.off("vttjsloaded",O),F()}o.one("vttjsloaded",O),o.one("vttjserror",L),o.addWebVttScript_()})}),e),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",()=>this.startABRTimer_()),this.tech_.on("pause",()=>this.stopABRTimer_()),this.tech_.on("play",()=>this.startABRTimer_())),toe.forEach(b=>{this[b+"_"]=noe.bind(this,b)}),this.logger_=Jo("pc"),this.triggeredFmp4Usage=!1,this.tech_.preload()==="none"?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1;const R=this.tech_.preload()==="none"?"play":"loadstart";this.tech_.one(R,()=>{const b=Date.now();this.tech_.one("loadeddata",()=>{this.timeToLoadedData__=Date.now()-b,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends})})}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){const e=this.mainAppendsToLoadedData_(),t=this.audioAppendsToLoadedData_();return e===-1||t===-1?-1:e+t}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(e="abr"){const t=this.selectPlaylist();t&&this.shouldSwitchToMedia_(t)&&this.switchMedia_(t,e)}switchMedia_(e,t,r){const o=this.media(),u=o&&(o.id||o.uri),h=e.id||e.uri;u&&u!==h&&(this.logger_(`switch media ${u} -> ${h} from ${t}`),this.tech_.trigger({type:"usage",name:`vhs-rendition-change-${t}`})),this.mainPlaylistLoader_.media(e,r)}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=rt.setInterval(()=>this.checkABR_(),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(rt.clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const e=this.main(),t=e&&e.playlists||[];if(!e||!e.mediaGroups||!e.mediaGroups.AUDIO)return t;const r=e.mediaGroups.AUDIO,o=Object.keys(r);let u;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)u=this.mediaTypes_.AUDIO.activeTrack();else{const f=r.main||o.length&&r[o[0]];for(const d in f)if(f[d].default){u={label:d};break}}if(!u)return t;const h=[];for(const f in r)if(r[f][u.label]){const d=r[f][u.label];if(d.playlists&&d.playlists.length)h.push.apply(h,d.playlists);else if(d.uri)h.push(d);else if(e.playlists.length)for(let m=0;m<e.playlists.length;m++){const g=e.playlists[m];g.attributes&&g.attributes.AUDIO&&g.attributes.AUDIO===f&&h.push(g)}}return h.length?h:t}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",()=>{const e=this.mainPlaylistLoader_.media(),t=e.targetDuration*1.5*1e3;Ab(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=t,e.endList&&this.tech_.preload()!=="none"&&(this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.mainSegmentLoader_.load()),Jae({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),e),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",()=>{this.trigger("selectedinitialmedia")})}),this.mainPlaylistLoader_.on("loadedplaylist",()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let e=this.mainPlaylistLoader_.media();if(!e){this.excludeUnsupportedVariants_();let t;if(this.enableLowInitialPlaylist&&(t=this.selectInitialPlaylist()),t||(t=this.selectPlaylist()),!t||!this.shouldSwitchToMedia_(t)||(this.initialMedia_=t,this.switchMedia_(this.initialMedia_,"initial"),!(this.sourceType_==="vhs-json"&&this.initialMedia_.segments)))return;e=this.initialMedia_}this.handleUpdatedMediaPlaylist(e)}),this.mainPlaylistLoader_.on("error",()=>{const e=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:e.playlist,error:e})}),this.mainPlaylistLoader_.on("mediachanging",()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()}),this.mainPlaylistLoader_.on("mediachange",()=>{const e=this.mainPlaylistLoader_.media(),t=e.targetDuration*1.5*1e3;Ab(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=t,this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainPlaylistLoader_.on("playlistunchanged",()=>{const e=this.mainPlaylistLoader_.media();if(e.lastExcludeReason_==="playlist-unchanged")return;this.stuckAtPlaylistEnd_(e)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))}),this.mainPlaylistLoader_.on("renditiondisabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})}),this.mainPlaylistLoader_.on("renditionenabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})})}handleUpdatedMediaPlaylist(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(e,t){const r=e.mediaGroups||{};let o=!0;const u=Object.keys(r.AUDIO);for(const h in r.AUDIO)for(const f in r.AUDIO[h])r.AUDIO[h][f].uri||(o=!1);o&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(r.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),mu.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),u.length&&Object.keys(r.AUDIO[u[0]]).length>1&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(e){const t=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,r=this.tech_.currentTime(),o=this.bufferLowWaterLine(),u=this.bufferHighWaterLine(),h=this.tech_.buffered();return roe({buffered:h,currentTime:r,currentPlaylist:t,nextPlaylist:e,bufferLowWaterLine:o,bufferHighWaterLine:u,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()}),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",()=>{this.trigger("progress")}),this.mainSegmentLoader_.on("error",()=>{const t=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:t.playlist,error:t})}),this.mainSegmentLoader_.on("appenderror",()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("ended",()=>{this.logger_("main segment loader ended"),this.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",t=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:eoe}))});const e=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();const t=this.getCodecsOrExclude_();t&&this.sourceUpdater_.addOrChangeSourceBuffers(t)};this.mainSegmentLoader_.on("trackinfo",e),this.audioSegmentLoader_.on("trackinfo",e),this.mainSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()})}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}fastQualityChange_(e=this.selectPlaylist()){if(e===this.mainPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(e,"fast-quality"),this.mainSegmentLoader_.resetEverything(()=>{jt.browser.IE_VERSION||jt.browser.IS_EDGE?this.tech_.setCurrentTime(this.tech_.currentTime()+.04):this.tech_.setCurrentTime(this.tech_.currentTime())})}play(){if(this.setupFirstPlay())return;this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();const e=this.tech_.seekable();if(this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0))return this.tech_.setCurrentTime(e.end(e.length-1))}setupFirstPlay(){const e=this.mainPlaylistLoader_.media();if(!e||this.tech_.paused()||this.hasPlayed_)return!1;if(!e.endList){const t=this.seekable();if(!t.length)return!1;if(jt.browser.IE_VERSION&&this.tech_.readyState()===0)return this.tech_.one("loadedmetadata",()=>{this.trigger("firstplay"),this.tech_.setCurrentTime(t.end(0)),this.hasPlayed_=!0}),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(t.end(0))}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){const e=this.tech_.play();typeof e<"u"&&typeof e.then=="function"&&e.then(null,t=>{})}this.trigger("sourceopen")}handleSourceEnded_(){if(!this.inbandTextTracks_.metadataTrack_)return;const e=this.inbandTextTracks_.metadataTrack_.cues;if(!e||!e.length)return;const t=this.duration();e[e.length-1].endTime=isNaN(t)||Math.abs(t)===1/0?Number.MAX_VALUE:t}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){const t=this.mainSegmentLoader_.getCurrentMediaInfo_();!t||t.hasVideo?e=e&&this.audioSegmentLoader_.ended_:e=this.audioSegmentLoader_.ended_}e&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(e){if(!this.seekable().length)return!1;const r=this.syncController_.getExpiredTime(e,this.duration());if(r===null)return!1;const o=mu.Playlist.playlistEnd(e,r),u=this.tech_.currentTime(),h=this.tech_.buffered();if(!h.length)return o-u<=xl;const f=h.end(h.length-1);return f-u<=xl&&o-f<=xl}excludePlaylist({playlistToExclude:e=this.mainPlaylistLoader_.media(),error:t={},playlistExclusionDuration:r}){if(e=e||this.mainPlaylistLoader_.media(),r=r||t.playlistExclusionDuration||this.playlistExclusionDuration,!e){this.error=t,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network");return}e.playlistErrors_++;const o=this.mainPlaylistLoader_.main.playlists,u=o.filter(oS),h=u.length===1&&u[0]===e;if(o.length===1&&r!==1/0)return jt.log.warn(`Problem encountered with playlist ${e.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(h);if(h){let S=!1;o.forEach(E=>{if(E===e)return;const T=E.excludeUntil;typeof T<"u"&&T!==1/0&&(S=!0,delete E.excludeUntil)}),S&&(jt.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let f;e.playlistErrors_>this.maxPlaylistRetries?f=1/0:f=Date.now()+r*1e3,e.excludeUntil=f,t.reason&&(e.lastExcludeReason_=t.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});const d=this.selectPlaylist();if(!d){this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error");return}const m=t.internal?this.logger_:jt.log.warn,g=t.message?" "+t.message:"";m(`${t.internal?"Internal problem":"Problem"} encountered with playlist ${e.id}.${g} Switching to playlist ${d.id}.`),d.attributes.AUDIO!==e.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),d.attributes.SUBTITLES!==e.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);const v=d.targetDuration/2*1e3||5*1e3,_=typeof d.lastRequest=="number"&&Date.now()-d.lastRequest<=v;return this.switchMedia_(d,"exclude",h||_)}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(e,t){const r=[],o=e==="all";(o||e==="main")&&r.push(this.mainPlaylistLoader_);const u=[];(o||e==="audio")&&u.push("AUDIO"),(o||e==="subtitle")&&(u.push("CLOSED-CAPTIONS"),u.push("SUBTITLES")),u.forEach(h=>{const f=this.mediaTypes_[h]&&this.mediaTypes_[h].activePlaylistLoader;f&&r.push(f)}),["main","audio","subtitle"].forEach(h=>{const f=this[`${h}SegmentLoader_`];f&&(e===h||e==="all")&&r.push(f)}),r.forEach(h=>t.forEach(f=>{typeof h[f]=="function"&&h[f]()}))}setCurrentTime(e){const t=xh(this.tech_.buffered(),e);if(!(this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media())||!this.mainPlaylistLoader_.media().segments)return 0;if(t&&t.length)return e;this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),this.load()}duration(){if(!this.mainPlaylistLoader_)return 0;const e=this.mainPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:mu.Playlist.duration(e):1/0:0}seekable(){return this.seekable_}onSyncInfoUpdate_(){let e;if(!this.mainPlaylistLoader_)return;let t=this.mainPlaylistLoader_.media();if(!t)return;let r=this.syncController_.getExpiredTime(t,this.duration());if(r===null)return;const o=this.mainPlaylistLoader_.main,u=mu.Playlist.seekable(t,r,mu.Playlist.liveEdgeDelay(o,t));if(u.length===0||this.mediaTypes_.AUDIO.activePlaylistLoader&&(t=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),r=this.syncController_.getExpiredTime(t,this.duration()),r===null||(e=mu.Playlist.seekable(t,r,mu.Playlist.liveEdgeDelay(o,t)),e.length===0)))return;let h,f;this.seekable_&&this.seekable_.length&&(h=this.seekable_.end(0),f=this.seekable_.start(0)),e?e.start(0)>u.end(0)||u.start(0)>e.end(0)?this.seekable_=u:this.seekable_=xs([[e.start(0)>u.start(0)?e.start(0):u.start(0),e.end(0)<u.end(0)?e.end(0):u.end(0)]]):this.seekable_=u,!(this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===h&&this.seekable_.start(0)===f)&&(this.logger_(`seekable updated [${dG(this.seekable_)}]`),this.tech_.trigger("seekablechanged"))}updateDuration(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,e),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(e){const o=this.seekable();if(!o.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<o.end(o.length-1))&&this.sourceUpdater_.setDuration(o.end(o.length-1));return}const t=this.tech_.buffered();let r=mu.Playlist.duration(this.mainPlaylistLoader_.media());t.length>0&&(r=Math.max(r,t.end(t.length-1))),this.mediaSource.duration!==r&&this.sourceUpdater_.setDuration(r)}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(e=>{const t=this.mediaTypes_[e].groups;for(const r in t)t[r].forEach(o=>{o.playlistLoader&&o.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){const e=!!this.mediaTypes_.AUDIO.activePlaylistLoader,t=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),r=e?!!this.audioSegmentLoader_.getCurrentMediaInfo_():!0;return!(!t||!r)}getCodecsOrExclude_(){const e={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},t=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();e.video=e.main;const r=Tm(this.main(),t),o={},u=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(e.main.hasVideo&&(o.video=r.video||e.main.videoCodec||wte),e.main.isMuxed&&(o.video+=`,${r.audio||e.main.audioCodec||JU}`),(e.main.hasAudio&&!e.main.isMuxed||e.audio.hasAudio||u)&&(o.audio=r.audio||e.main.audioCodec||e.audio.audioCodec||JU,e.audio.isFmp4=e.main.hasAudio&&!e.main.isMuxed?e.main.isFmp4:e.audio.isFmp4),!o.audio&&!o.video){this.excludePlaylist({playlistToExclude:t,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:1/0});return}const h=(m,g)=>m?OE(g):iI(g),f={};let d;if(["video","audio"].forEach(function(m){if(o.hasOwnProperty(m)&&!h(e[m].isFmp4,o[m])){const g=e[m].isFmp4?"browser":"muxer";f[g]=f[g]||[],f[g].push(o[m]),m==="audio"&&(d=g)}}),u&&d&&t.attributes.AUDIO){const m=t.attributes.AUDIO;this.main().playlists.forEach(g=>{(g.attributes&&g.attributes.AUDIO)===m&&g!==t&&(g.excludeUntil=1/0)}),this.logger_(`excluding audio group ${m} as ${d} does not support codec(s): "${o.audio}"`)}if(Object.keys(f).length){const m=Object.keys(f).reduce((g,v)=>(g&&(g+=", "),g+=`${v} does not support codec(s): "${f[v].join(",")}"`,g),"")+".";this.excludePlaylist({playlistToExclude:t,error:{internal:!0,message:m},playlistExclusionDuration:1/0});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const m=[];if(["video","audio"].forEach(g=>{const v=(vl(this.sourceUpdater_.codecs[g]||"")[0]||{}).type,_=(vl(o[g]||"")[0]||{}).type;v&&_&&v.toLowerCase()!==_.toLowerCase()&&m.push(`"${this.sourceUpdater_.codecs[g]}" -> "${o[g]}"`)}),m.length){this.excludePlaylist({playlistToExclude:t,error:{message:`Codec switching not supported: ${m.join(", ")}.`,internal:!0},playlistExclusionDuration:1/0});return}}return o}tryToCreateSourceBuffers_(){if(this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers()||!this.areMediaTypesKnown_())return;const e=this.getCodecsOrExclude_();if(!e)return;this.sourceUpdater_.createSourceBuffers(e);const t=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(t)}excludeUnsupportedVariants_(){const e=this.main().playlists,t=[];Object.keys(e).forEach(r=>{const o=e[r];if(t.indexOf(o.id)!==-1)return;t.push(o.id);const u=Tm(this.main,o),h=[];u.audio&&!iI(u.audio)&&!OE(u.audio)&&h.push(`audio codec ${u.audio}`),u.video&&!iI(u.video)&&!OE(u.video)&&h.push(`video codec ${u.video}`),u.text&&u.text==="stpp.ttml.im1t"&&h.push(`text codec ${u.text}`),h.length&&(o.excludeUntil=1/0,this.logger_(`excluding ${o.id} for unsupported: ${h.join(", ")}`))})}excludeIncompatibleVariants_(e){const t=[],r=this.main().playlists,o=z_(vl(e)),u=tB(o),h=o.video&&vl(o.video)[0]||null,f=o.audio&&vl(o.audio)[0]||null;Object.keys(r).forEach(d=>{const m=r[d];if(t.indexOf(m.id)!==-1||m.excludeUntil===1/0)return;t.push(m.id);const g=[],v=Tm(this.mainPlaylistLoader_.main,m),_=tB(v);if(!(!v.audio&&!v.video)){if(_!==u&&g.push(`codec count "${_}" !== "${u}"`),!this.sourceUpdater_.canChangeType()){const S=v.video&&vl(v.video)[0]||null,E=v.audio&&vl(v.audio)[0]||null;S&&h&&S.type.toLowerCase()!==h.type.toLowerCase()&&g.push(`video codec "${S.type}" !== "${h.type}"`),E&&f&&E.type.toLowerCase()!==f.type.toLowerCase()&&g.push(`audio codec "${E.type}" !== "${f.type}"`)}g.length&&(m.excludeUntil=1/0,this.logger_(`excluding ${m.id}: ${g.join(" && ")}`))}})}updateAdCues_(e){let t=0;const r=this.seekable();r.length&&(t=r.start(0)),Uae(e,this.cueTagsTrack_,t)}goalBufferLength(){const e=this.tech_.currentTime(),t=is.GOAL_BUFFER_LENGTH,r=is.GOAL_BUFFER_LENGTH_RATE,o=Math.max(t,is.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*r,o)}bufferLowWaterLine(){const e=this.tech_.currentTime(),t=is.BUFFER_LOW_WATER_LINE,r=is.BUFFER_LOW_WATER_LINE_RATE,o=Math.max(t,is.MAX_BUFFER_LOW_WATER_LINE),u=Math.max(t,is.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*r,this.bufferBasedABR?u:o)}bufferHighWaterLine(){return is.BUFFER_HIGH_WATER_LINE}}const soe=(n,e,t)=>r=>{const o=n.main.playlists[e],u=p1(o),h=oS(o);return typeof r>"u"?h:(r?delete o.disabled:o.disabled=!0,r!==h&&!u&&(t(),r?n.trigger("renditionenabled"):n.trigger("renditiondisabled")),r)};class aoe{constructor(e,t,r){const{playlistController_:o}=e,u=o.fastQualityChange_.bind(o);if(t.attributes){const h=t.attributes.RESOLUTION;this.width=h&&h.width,this.height=h&&h.height,this.bandwidth=t.attributes.BANDWIDTH,this.frameRate=t.attributes["FRAME-RATE"]}this.codecs=Tm(o.main(),t),this.playlist=t,this.id=r,this.enabled=soe(e.playlists,t.id,u)}}const ooe=function(n){n.representations=()=>{const e=n.playlistController_.main(),t=I0(e)?n.playlistController_.getAudioTrackPlaylists_():e.playlists;return t?t.filter(r=>!p1(r)).map((r,o)=>new aoe(n,r,r.id)):[]}},hB=["seeking","seeked","pause","playing","error"];class loe{constructor(e){this.playlistController_=e.playlistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=Jo("PlaybackWatcher"),this.logger_("initialize");const t=()=>this.monitorCurrentTime_(),r=()=>this.monitorCurrentTime_(),o=()=>this.techWaiting_(),u=()=>this.resetTimeUpdate_(),h=this.playlistController_,f=["main","subtitle","audio"],d={};f.forEach(g=>{d[g]={reset:()=>this.resetSegmentDownloads_(g),updateend:()=>this.checkSegmentDownloads_(g)},h[`${g}SegmentLoader_`].on("appendsdone",d[g].updateend),h[`${g}SegmentLoader_`].on("playlistupdate",d[g].reset),this.tech_.on(["seeked","seeking"],d[g].reset)});const m=g=>{["main","audio"].forEach(v=>{h[`${v}SegmentLoader_`][g]("appended",this.seekingAppendCheck_)})};this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),m("off"))},this.clearSeekingAppendCheck_=()=>m("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),m("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",o),this.tech_.on(hB,u),this.tech_.on("canplay",r),this.tech_.one("play",t),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",o),this.tech_.off(hB,u),this.tech_.off("canplay",r),this.tech_.off("play",t),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),f.forEach(g=>{h[`${g}SegmentLoader_`].off("appendsdone",d[g].updateend),h[`${g}SegmentLoader_`].off("playlistupdate",d[g].reset),this.tech_.off(["seeked","seeking"],d[g].reset)}),this.checkCurrentTimeTimeout_&&rt.clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&rt.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=rt.setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(e){const t=this.playlistController_[`${e}SegmentLoader_`];this[`${e}StalledDownloads_`]>0&&this.logger_(`resetting possible stalled download count for ${e} loader`),this[`${e}StalledDownloads_`]=0,this[`${e}Buffered_`]=t.buffered_()}checkSegmentDownloads_(e){const t=this.playlistController_,r=t[`${e}SegmentLoader_`],o=r.buffered_(),u=nse(this[`${e}Buffered_`],o);if(this[`${e}Buffered_`]=o,u){this.resetSegmentDownloads_(e);return}this[`${e}StalledDownloads_`]++,this.logger_(`found #${this[`${e}StalledDownloads_`]} ${e} appends that did not increase buffer (possible stalled download)`,{playlistId:r.playlist_&&r.playlist_.id,buffered:kf(o)}),!(this[`${e}StalledDownloads_`]<10)&&(this.logger_(`${e} loader stalled download exclusion`),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:`vhs-${e}-download-exclusion`}),e!=="subtitle"&&t.excludePlaylist({error:{message:`Excessive ${e} segment downloading detected.`},playlistExclusionDuration:1/0}))}checkCurrentTime_(){if(this.tech_.paused()||this.tech_.seeking())return;const e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+xl>=t.end(t.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;const t=this.seekable(),r=this.tech_.currentTime(),o=this.afterSeekableWindow_(t,r,this.media(),this.allowSeeksWithinUnsafeLiveWindow);let u;if(o&&(u=t.end(t.length-1)),this.beforeSeekableWindow_(t,r)){const E=t.start(0);u=E+(E===t.end(0)?0:xl)}if(typeof u<"u")return this.logger_(`Trying to seek outside of seekable at time ${r} with seekable range ${dG(t)}. Seeking to ${u}.`),this.tech_.setCurrentTime(u),!0;const h=this.playlistController_.sourceUpdater_,f=this.tech_.buffered(),d=h.audioBuffer?h.audioBuffered():null,m=h.videoBuffer?h.videoBuffered():null,g=this.media(),v=g.partTargetDuration?g.partTargetDuration:(g.targetDuration-Uc)*2,_=[d,m];for(let E=0;E<_.length;E++){if(!_[E])continue;if(d1(_[E],r)<v)return!1}const S=aE(f,r);return S.length===0?!1:(u=S.start(0)+xl,this.logger_(`Buffered region starts (${S.start(0)})  just beyond seek point (${r}). Seeking to ${u}.`),this.tech_.setCurrentTime(u),!0)}waiting_(){if(this.techWaiting_())return;const e=this.tech_.currentTime(),t=this.tech_.buffered(),r=xh(t,e);if(r.length&&e+3<=r.end(0)){this.resetTimeUpdate_(),this.tech_.setCurrentTime(e),this.logger_(`Stopped at ${e} while inside a buffered region [${r.start(0)} -> ${r.end(0)}]. Attempting to resume playback by seeking to the current time.`),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"});return}}techWaiting_(){const e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(e,t)){const f=e.end(e.length-1);return this.logger_(`Fell out of live window at time ${t}. Seeking to live point (seekable end) ${f}`),this.resetTimeUpdate_(),this.tech_.setCurrentTime(f),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}const r=this.tech_.vhs.playlistController_.sourceUpdater_,o=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:r.audioBuffered(),videoBuffered:r.videoBuffered(),currentTime:t}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;const h=aE(o,t);return h.length>0?(this.logger_(`Stopped at ${t} and seeking to ${h.start(0)}`),this.resetTimeUpdate_(),this.skipTheGap_(t),!0):!1}afterSeekableWindow_(e,t,r,o=!1){if(!e.length)return!1;let u=e.end(e.length-1)+xl;return!r.endList&&o&&(u=e.end(e.length-1)+r.targetDuration*3),t>u}beforeSeekableWindow_(e,t){return!!(e.length&&e.start(0)>0&&t<e.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:e,audioBuffered:t,currentTime:r}){if(!e)return;let o;if(e.length&&t.length){const u=xh(e,r-3),h=xh(e,r),f=xh(t,r);f.length&&!h.length&&u.length&&(o={start:u.end(0),end:f.end(0)})}else aE(e,r).length||(o=this.gapFromVideoUnderflow_(e,r));return o?(this.logger_(`Encountered a gap in video from ${o.start} to ${o.end}. Seeking to current time ${r}`),!0):!1}skipTheGap_(e){const t=this.tech_.buffered(),r=this.tech_.currentTime(),o=aE(t,r);this.resetTimeUpdate_(),!(o.length===0||r!==e)&&(this.logger_("skipTheGap_:","currentTime:",r,"scheduled currentTime:",e,"nextRange start:",o.start(0)),this.tech_.setCurrentTime(o.start(0)+Uc),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}))}gapFromVideoUnderflow_(e,t){const r=Zie(e);for(let o=0;o<r.length;o++){const u=r.start(o),h=r.end(o);if(t-u<4&&t-u>2)return{start:u,end:h}}return null}}const uoe={errorInterval:30,getSource(n){const t=this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource();return n(t)}},QG=function(n,e){let t=0,r=0;const o=Zr(uoe,e);n.ready(()=>{n.trigger({type:"usage",name:"vhs-error-reload-initialized"})});const u=function(){r&&n.currentTime(r)},h=function(g){g!=null&&(r=n.duration()!==1/0&&n.currentTime()||0,n.one("loadedmetadata",u),n.src(g),n.trigger({type:"usage",name:"vhs-error-reload"}),n.play())},f=function(){if(Date.now()-t<o.errorInterval*1e3){n.trigger({type:"usage",name:"vhs-error-reload-canceled"});return}if(!o.getSource||typeof o.getSource!="function"){jt.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return t=Date.now(),o.getSource.call(n,h)},d=function(){n.off("loadedmetadata",u),n.off("error",f),n.off("dispose",d)},m=function(g){d(),QG(n,g)};n.on("error",f),n.on("dispose",d),n.reloadSourceOnError=m},coe=function(n){QG(this,n)};var JG="3.0.2",foe="6.3.0",doe="1.0.1",hoe="6.0.0",poe="4.0.1";const Hs={PlaylistLoader:Ch,Playlist:ca,utils:Ise,STANDARD_PLAYLIST_SELECTOR:rB,INITIAL_PLAYLIST_SELECTOR:pae,lastBandwidthSelector:rB,movingAverageBandwidthSelector:dae,comparePlaylistBandwidth:y1,comparePlaylistResolution:fae,xhr:RG()};Object.keys(is).forEach(n=>{Object.defineProperty(Hs,n,{get(){return jt.log.warn(`using Vhs.${n} is UNSAFE be sure you know what you are doing`),is[n]},set(e){if(jt.log.warn(`using Vhs.${n} is UNSAFE be sure you know what you are doing`),typeof e!="number"||e<0){jt.log.warn(`value of Vhs.${n} must be greater than or equal to 0`);return}is[n]=e}})});const ZG="videojs-vhs",eW=function(n,e){const t=e.media();let r=-1;for(let o=0;o<n.length;o++)if(n[o].id===t.id){r=o;break}n.selectedIndex_=r,n.trigger({selectedIndex:r,type:"change"})},goe=function(n,e){e.representations().forEach(t=>{n.addQualityLevel(t)}),eW(n,e.playlists)};Hs.canPlaySource=function(){return jt.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const moe=(n,e,t)=>{if(!n)return n;let r={};e&&e.attributes&&e.attributes.CODECS&&(r=z_(vl(e.attributes.CODECS))),t&&t.attributes&&t.attributes.CODECS&&(r.audio=t.attributes.CODECS);const o=Jm(r.video),u=Jm(r.audio),h={};for(const f in n)h[f]={},u&&(h[f].audioContentType=u),o&&(h[f].videoContentType=o),e.contentProtection&&e.contentProtection[f]&&e.contentProtection[f].pssh&&(h[f].pssh=e.contentProtection[f].pssh),typeof n[f]=="string"&&(h[f].url=n[f]);return Zr(n,h)},voe=(n,e)=>n.reduce((t,r)=>{if(!r.contentProtection)return t;const o=e.reduce((u,h)=>{const f=r.contentProtection[h];return f&&f.pssh&&(u[h]={pssh:f.pssh}),u},{});return Object.keys(o).length&&t.push(o),t},[]),yoe=({player:n,sourceKeySystems:e,audioMedia:t,mainPlaylists:r})=>{if(!n.eme.initializeMediaKeys)return Promise.resolve();const o=t?r.concat([t]):r,u=voe(o,Object.keys(e)),h=[],f=[];return u.forEach(d=>{f.push(new Promise((m,g)=>{n.tech_.one("keysessioncreated",m)})),h.push(new Promise((m,g)=>{n.eme.initializeMediaKeys({keySystems:d},v=>{if(v){g(v);return}m()})}))}),Promise.race([Promise.all(h),Promise.race(f)])},Eoe=({player:n,sourceKeySystems:e,media:t,audioMedia:r})=>{const o=moe(e,t,r);return o?(n.currentSource().keySystems=o,o&&!n.eme?(jt.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0):!1},tW=()=>{if(!rt.localStorage)return null;const n=rt.localStorage.getItem(ZG);if(!n)return null;try{return JSON.parse(n)}catch{return null}},_oe=n=>{if(!rt.localStorage)return!1;let e=tW();e=e?Zr(e,n):n;try{rt.localStorage.setItem(ZG,JSON.stringify(e))}catch{return!1}return e},Toe=n=>n.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(n.substring(n.indexOf(",")+1)):n;Hs.supportsNativeHls=function(){if(!mn||!mn.createElement)return!1;const n=mn.createElement("video");return jt.getTech("Html5").isSupported()?["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(t){return/maybe|probably/i.test(n.canPlayType(t))}):!1}();Hs.supportsNativeDash=function(){return!mn||!mn.createElement||!jt.getTech("Html5").isSupported()?!1:/maybe|probably/i.test(mn.createElement("video").canPlayType("application/dash+xml"))}();Hs.supportsTypeNatively=n=>n==="hls"?Hs.supportsNativeHls:n==="dash"?Hs.supportsNativeDash:!1;Hs.isSupported=function(){return jt.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const Soe=jt.getComponent("Component");class nW extends Soe{constructor(e,t,r){if(super(t,r.vhs),typeof r.initialBandwidth=="number"&&(this.options_.bandwidth=r.initialBandwidth),this.logger_=Jo("VhsHandler"),t.options_&&t.options_.playerId){const o=jt.getPlayer(t.options_.playerId);this.player_=o}if(this.tech_=t,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&t.overrideNativeAudioTracks&&t.overrideNativeVideoTracks)t.overrideNativeAudioTracks(!0),t.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(t.featuresNativeVideoTracks||t.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(mn,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],o=>{const u=mn.fullscreenElement||mn.webkitFullscreenElement||mn.mozFullScreenElement||mn.msFullscreenElement;u&&u.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()}),this.on(this.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}setOptions_(){if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage<"u"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=this.options_.llhls!==!1,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,typeof this.options_.playlistExclusionDuration!="number"&&(this.options_.playlistExclusionDuration=5*60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){const e=tW();e&&e.bandwidth&&(this.options_.bandwidth=e.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),e&&e.throughput&&(this.options_.throughput=e.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=is.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===is.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach(e=>{typeof this.source_[e]<"u"&&(this.options_[e]=this.source_[e])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio}src(e,t){if(!e)return;this.setOptions_(),this.options_.src=Toe(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=Hs,this.options_.sourceType=u6(t),this.options_.seekTo=u=>{this.tech_.setCurrentTime(u)},this.playlistController_=new ioe(this.options_);const r=Zr({liveRangeSafeTimeDelta:xl},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_});this.playbackWatcher_=new loe(r),this.playlistController_.on("error",()=>{const u=jt.players[this.tech_.options_.playerId];let h=this.playlistController_.error;typeof h=="object"&&!h.code?h.code=3:typeof h=="string"&&(h={message:h,code:3}),u.error(h)});const o=this.options_.bufferBasedABR?Hs.movingAverageBandwidthSelector(.55):Hs.STANDARD_PLAYLIST_SELECTOR;this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):o.bind(this),this.playlistController_.selectInitialPlaylist=Hs.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(u){this.playlistController_.selectPlaylist=u.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(u){this.playlistController_.mainSegmentLoader_.throughput.rate=u,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let u=this.playlistController_.mainSegmentLoader_.bandwidth;const h=rt.navigator.connection||rt.navigator.mozConnection||rt.navigator.webkitConnection,f=1e7;if(this.options_.useNetworkInformationApi&&h){const d=h.downlink*1e3*1e3;d>=f&&u>=f?u=Math.max(u,d):u=d}return u},set(u){this.playlistController_.mainSegmentLoader_.bandwidth=u,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){const u=1/(this.bandwidth||1);let h;return this.throughput>0?h=1/this.throughput:h=0,Math.floor(1/(u+h))},set(){jt.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>kf(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>kf(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",()=>{this.options_.useBandwidthFromLocalStorage&&_oe({bandwidth:this.bandwidth,throughput:Math.round(this.throughput)})}),this.playlistController_.on("selectedinitialmedia",()=>{ooe(this)}),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",()=>{this.setupEme_()}),this.on(this.playlistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.playlistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=rt.URL.createObjectURL(this.playlistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),yoe({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:e&&e.media(),mainPlaylists:this.playlists.main.playlists}).then(()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()}).catch(t=>{this.logger_("error while creating EME key session",t),this.player_.error({message:"Failed to initialize media keys for EME",code:3})})}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,t=Eoe({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:e&&e.media()});if(this.player_.tech_.on("keystatuschange",r=>{if(r.status!=="output-restricted")return;const o=this.playlistController_.main();if(!o||!o.playlists)return;const u=[];o.playlists.forEach(h=>{h&&h.attributes&&h.attributes.RESOLUTION&&h.attributes.RESOLUTION.height>=720&&(!h.excludeUntil||h.excludeUntil<1/0)&&(h.excludeUntil=1/0,u.push(h))}),u.length&&(jt.log.warn('DRM keystatus changed to "output-restricted." Removing the following HD playlists that will most likely fail to play and clearing the buffer. This may be due to HDCP restrictions on the stream and the capabilities of the current device.',...u),this.playlistController_.fastQualityChange_())}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),jt.browser.IE_VERSION===11||!t){this.playlistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()}setupQualityLevels_(){const e=jt.players[this.tech_.options_.playerId];!e||!e.qualityLevels||this.qualityLevels_||(this.qualityLevels_=e.qualityLevels(),this.playlistController_.on("selectedinitialmedia",()=>{goe(this.qualityLevels_,this)}),this.playlists.on("mediachange",()=>{eW(this.qualityLevels_,this.playlists)}))}static version(){return{"@videojs/http-streaming":JG,"mux.js":foe,"mpd-parser":doe,"m3u8-parser":hoe,"aes-decrypter":poe}}version(){return this.constructor.version()}canChangeType(){return XG.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(e){this.playlistController_.setCurrentTime(e)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&rt.URL.revokeObjectURL&&(rt.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(e,t){return wse({playlist:this.playlistController_.media(),time:e,callback:t})}seekToProgramTime(e,t,r=!0,o=2){return MG({programTime:e,playlist:this.playlistController_.media(),retryCount:o,pauseAfterSeek:r,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}}const Q_={name:"videojs-http-streaming",VERSION:JG,canHandleSource(n,e={}){const t=Zr(jt.options,e);return Q_.canPlayType(n.type,t)},handleSource(n,e,t={}){const r=Zr(jt.options,t);return e.vhs=new nW(n,e,r),e.vhs.xhr=RG(),e.vhs.src(n.src,n.type),e.vhs},canPlayType(n,e){const t=u6(n);if(!t)return"";const r=Q_.getOverrideNative(e);return!Hs.supportsTypeNatively(t)||r?"maybe":""},getOverrideNative(n={}){const{vhs:e={}}=n,t=!(jt.browser.IS_ANY_SAFARI||jt.browser.IS_IOS),{overrideNative:r=t}=e;return r}},Aoe=()=>OE("avc1.4d400d,mp4a.40.2");Aoe()&&jt.getTech("Html5").registerSourceHandler(Q_,0);jt.VhsHandler=nW;jt.VhsSourceHandler=Q_;jt.Vhs=Hs;jt.use||jt.registerComponent("Vhs",Hs);jt.options.vhs=jt.options.vhs||{};(!jt.getPlugin||!jt.getPlugin("reloadSourceOnError"))&&jt.registerPlugin("reloadSourceOnError",coe);/*! @name @montevideo-tech/videojs-cmcd @version 1.0.0 @license Apache-2.0 */var xoe="1.0.0",TI=function(e){return e>=100?Math.round(e/100)*100:e===0?0:100},Coe=function(e){return e.ot!==void 0&&(e.ot==="v"||e.ot==="a"||e.ot==="av")},Ioe=function(){function n(t){this.player=t,this.vhs=t.tech(!0).vhs}var e=n.prototype;return e.bufferLengthMs=function(){try{var r=0,o=this.player.tech(!0),u=o.buffered();if(u.length>0){var h=u.end(u.length-1);isNaN(h)||(r=h-o.currentTime())}var f=r*1e3;return f}catch{return}},e.getBufferLength=function(){try{var r=this.bufferLengthMs();return TI(r)}catch{return}},e.getDeadline=function(){try{var r=this.bufferLengthMs(),o=this.player.playbackRate()*1e3,u=Math.round(r/o);return TI(u)}catch{return}},e.getMeasuredThroughput=function(){try{var r=Math.round(this.vhs.systemBandwidth/1e3);return TI(r)}catch{return}},e.getNextObjectRequest=function(r){try{var o;if(this.player.duration().toString()!=="Infinity"&&this.player.duration()!==0){var u=this.vhs.playlists.media().segments,h=u.findIndex(function(f){return f.resolvedUri===r});h!==-1&&h!==u.length&&(o=u[h+1].uri,o=encodeURIComponent(o))}return o}catch{return}},e.getNextRangeRequest=function(){},e.getKeys=function(r,o){return{bl:this.getBufferLength(),dl:this.getDeadline(),mtp:this.getMeasuredThroughput(),nor:this.getNextObjectRequest(r),nrr:this.getNextRangeRequest(),su:o}},n}(),Roe=function(){function n(t){this.player=t}var e=n.prototype;return e.getEncodedBitrate=function(){try{var r=this.player.tech(!0).vhs.playlists.media_.attributes.BANDWIDTH,o=Math.round(r/1e3);return o}catch{return}},e.getObjectDuration=function(r){try{var o=this.player.tech(!0).vhs.playlists.media(),u=o.segments.findIndex(function(f){return f.resolvedUri===r}),h=Math.round(o.segments[u].duration*1e3);return h}catch{return}},e.getObjectType=function(r){try{var o=r.split(".").pop(),u={m3u8:"m",mpd:"m",xml:"m",m4a:"a",amp3ac:"a",aac:"a",caf:"a",flac:"a",oga:"a",wav:"a",opus:"v",ogv:"v",mp4:"v",mov:"v",m4v:"v",mkv:"v",webm:"v",ogg:"v",flv:"v",ts:"av",webvtt:"c",vtt:"c",jpg:"o",jpeg:"o",gif:"o",png:"o",svg:"o",webp:"o"};return u.hasOwnProperty(o)?u[o]:void 0}catch{return}},e.getTopBitrate=function(){try{var r=this.player.qualityLevels().levels_,o=r.reduce(function(h,f){return h&&h.bitrate>f.bitrate?h:f}),u=Math.round(o.bitrate/1e3);return u}catch{return}},e.getKeys=function(r){return{br:this.getEncodedBitrate(),d:this.getObjectDuration(r),ot:this.getObjectType(r),tb:this.getTopBitrate()}},n}(),boe=function(){function n(t,r){this.player=t,this.sid=r}var e=n.prototype;return e.generateHashCode=function(r){var o=0;if(r.length===0)return o;for(var u=0;u<r.length;u++){var h=r.charCodeAt(u);o=(o<<5)-o+h,o|=0}return o},e.getContentId=function(r){try{var o=this.generateHashCode(r);return o.toString()}catch{return}},e.getPlaybackRate=function(){try{var r=this.player.playbackRate();return r===1?1:r===0?0:2}catch{return}},e.getStreamingFormat=function(){try{var r=this.player.currentType();return r==="application/dash+xml"?"d":r==="application/x-mpegURL"?"h":r==="application/vnd.ms-sstr+xml"?"s":"o"}catch{return}},e.getStreamType=function(){try{return this.player.duration().toString()==="Infinity"||this.player.duration()===0?"l":"v"}catch{return}},e.getVersion=function(){return 1},e.getKeys=function(r){return{cid:this.getContentId(r),pr:this.getPlaybackRate(),sf:this.getStreamingFormat(),sid:this.sid,st:this.getStreamType(),v:this.getVersion()}},n}(),Doe=function(){function n(t){this.player=t}var e=n.prototype;return e.getBufferStarvation=function(r){try{return r}catch{return}},e.getRequestedMaximumThroughput=function(){},e.getKeys=function(r){return{bs:this.getBufferStarvation(r),rtp:this.getRequestedMaximumThroughput()}},n}(),Sm=!0,Poe={},E1=function(e){var t=this;this.options=jt.obj.merge(Poe,e);var r=this,o=Loe();this.ready(function(){t.addClass("vjs-cmcd"),Moe(r),t.tech(!0).vhs?pB(r,o,t):t.on("loadstart",function(){pB(r,o,t)})})};function pB(n,e,t){t.tech(!0).vhs.xhr.beforeRequest=function(r){var o=new Ioe(n),u=new Roe(n),h=new boe(n,e),f=new Doe(n),d=o.getKeys(r.uri,Sm),m=u.getKeys(r.uri),g=h.getKeys(n.currentSrc()),v=f.getKeys(Sm),_=qo({},d,m,g,v);return r.uri.match(/\?./)?r.uri+="&CMCD="+gB(_):r.uri+="?CMCD="+gB(_),r}}function gB(n){for(var e="",t=Object.keys(n).sort().reduce(function(m,g){return n[g]!==void 0&&(m[g]=n[g]),m},{}),r=0,o=Object.entries(t);r<o.length;r++){var u=o[r],h=u[0],f=u[1],d=typeof f;h==="v"&&f===1||h==="pr"&&f===1||d==="boolean"&&!f||h==="bl"&&!Coe(t)||(h==="ot"||h==="sf"||h==="st"?e+=h+"="+f+",":d==="boolean"?e+=h+",":e+=h+"="+JSON.stringify(f)+",")}return encodeURIComponent(e.slice(0,-1))}function Loe(){for(var n=new Uint8Array(16),e=0;e<n.length;e++)n[e]=Math.floor(Math.random()*256);n[6]=n[6]&15|64,n[8]=n[8]&63|128;var t=Array.from(n,function(o){return o.toString(16).padStart(2,"0")}),r=t.join("");return r.slice(0,8)+"-"+r.slice(8,12)+"-4"+r.slice(13,16)+"-"+String.fromCharCode(n[8]&15|128)+r.slice(17,20)+"-"+r.slice(20)}function Moe(n){n.on("loadedmetadata",function(){Sm=!1}),n.on("waiting",function(){Sm=!0}),n.on("canplay",function(){Sm=!1})}E1.defaultState={};E1.VERSION=xoe;jt.registerPlugin("cmcd",E1);const woe=n=>{const e=Ws.useRef(null),t=Ws.useRef(null),{manifestURI:r,dispatchReqList:o}=n;return Ws.useEffect(()=>{const u={autoplay:!0,controls:!0,responsive:!0,plugins:{cmcd:{}},fluid:!0,sources:[{src:r}]};if(t.current){const f=t.current;f.autoplay(u.autoplay),f.src(u.sources),f.cmcd();var h=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){const d=arguments[1];o({type:"saveQuery",payload:{url:d,result:Kf(d)}}),h.apply(this,arguments)}}else{const f=document.createElement("video-js");f.classList.add("vjs-big-play-centered"),e.current.appendChild(f),(t.current=jt(f,u)).cmcd()}},[e,r]),Ws.useEffect(()=>{const u=t.current;return()=>{u&&!u.isDisposed()&&(u.dispose(),t.current=null)}},[t]),ln("div",{"data-vjs-player":!0,children:ln("div",{ref:e})})};var wb={},Ooe={get exports(){return wb},set exports(n){wb=n}};(function(n,e){(function(r,o){n.exports=o()})(self,()=>(()=>{var t={"./externals/base64.js":(h,f)=>{var d={};d.encode=function(g){for(var v=[],_=0;_<g.length;++_){var S=g.charCodeAt(_);S<128?v.push(S):S<2048?(v.push(192|S>>6),v.push(128|63&S)):S<65536?(v.push(224|S>>12),v.push(128|63&S>>6),v.push(128|63&S)):(v.push(240|S>>18),v.push(128|63&S>>12),v.push(128|63&S>>6),v.push(128|63&S))}return v},d.decode=function(g){for(var v=[],_=0;_<g.length;){var S=g[_++];S<128||(S<224?(S=(31&S)<<6,S|=63&g[_++]):S<240?(S=(15&S)<<12,S|=(63&g[_++])<<6,S|=63&g[_++]):(S=(7&S)<<18,S|=(63&g[_++])<<12,S|=(63&g[_++])<<6,S|=63&g[_++])),v.push(String.fromCharCode(S))}return v.join("")};var m={};(function(g){var v=function(C){for(var R=0,b=[],F=0|C.length/3;0<F--;){var O=(C[R]<<16)+(C[R+1]<<8)+C[R+2];R+=3,b.push(g.charAt(63&O>>18)),b.push(g.charAt(63&O>>12)),b.push(g.charAt(63&O>>6)),b.push(g.charAt(63&O))}if(C.length-R==2){var O=(C[R]<<16)+(C[R+1]<<8);b.push(g.charAt(63&O>>18)),b.push(g.charAt(63&O>>12)),b.push(g.charAt(63&O>>6)),b.push("=")}else if(C.length-R==1){var O=C[R]<<16;b.push(g.charAt(63&O>>18)),b.push(g.charAt(63&O>>12)),b.push("==")}return b.join("")},_=function(){for(var T=[],C=0;C<g.length;++C)T[g.charCodeAt(C)]=C;return T["=".charCodeAt(0)]=0,T}(),S=function(C){for(var R=0,b=[],F=0|C.length/4;0<F--;){var O=(_[C.charCodeAt(R)]<<18)+(_[C.charCodeAt(R+1)]<<12)+(_[C.charCodeAt(R+2)]<<6)+_[C.charCodeAt(R+3)];b.push(255&O>>16),b.push(255&O>>8),b.push(255&O),R+=4}return b&&(C.charAt(R-2)=="="?(b.pop(),b.pop()):C.charAt(R-1)=="="&&b.pop()),b},E={};E.encode=function(T){for(var C=[],R=0;R<T.length;++R)C.push(T.charCodeAt(R));return C},E.decode=function(T){for(var C=0;C<s.length;++C)a[C]=String.fromCharCode(a[C]);return a.join("")},m.decodeArray=function(T){var C=S(T);return new Uint8Array(C)},m.encodeASCII=function(T){var C=E.encode(T);return v(C)},m.decodeASCII=function(T){var C=S(T);return E.decode(C)},m.encode=function(T){var C=d.encode(T);return v(C)},m.decode=function(T){var C=S(T);return d.decode(C)}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),f.decode=m.decode,f.decodeArray=m.decodeArray,f.encode=m.encode,f.encodeASCII=m.encodeASCII},"./externals/cea608-parser.js":(h,f)=>{(function(d){var m={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},g=function(k){var K=k;return m.hasOwnProperty(k)&&(K=m[k]),String.fromCharCode(K)},v=15,_=32,S={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},E={17:2,18:4,21:6,22:8,23:10,19:13,20:15},T={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},C={25:2,26:4,29:6,30:8,31:10,27:13,28:15},R=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],b={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(k){this.time=k},log:function(k,K){var W=this.verboseFilter[k];this.verboseLevel>=W&&console.log(this.time+" ["+k+"] "+K)}},F=function(k){for(var K=[],W=0;W<k.length;W++)K.push(k[W].toString(16));return K},O=function(k,K,W,Y,J){this.foreground=k||"white",this.underline=K||!1,this.italics=W||!1,this.background=Y||"black",this.flash=J||!1};O.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(k){for(var K=["foreground","underline","italics","background","flash"],W=0;W<K.length;W++){var Y=K[W];k.hasOwnProperty(Y)&&(this[Y]=k[Y])}},isDefault:function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},equals:function(k){return this.foreground===k.foreground&&this.underline===k.underline&&this.italics===k.italics&&this.background===k.background&&this.flash===k.flash},copy:function(k){this.foreground=k.foreground,this.underline=k.underline,this.italics=k.italics,this.background=k.background,this.flash=k.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var L=function(k,K,W,Y,J,ee){this.uchar=k||" ",this.penState=new O(K,W,Y,J,ee)};L.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(k,K){this.uchar=k,this.penState.copy(K)},setPenState:function(k){this.penState.copy(k)},equals:function(k){return this.uchar===k.uchar&&this.penState.equals(k.penState)},copy:function(k){this.uchar=k.uchar,this.penState.copy(k.penState)},isEmpty:function(){return this.uchar===" "&&this.penState.isDefault()}};var D=function(){this.chars=[];for(var k=0;k<_;k++)this.chars.push(new L);this.pos=0,this.currPenState=new O};D.prototype={equals:function(k){for(var K=!0,W=0;W<_;W++)if(!this.chars[W].equals(k.chars[W])){K=!1;break}return K},copy:function(k){for(var K=0;K<_;K++)this.chars[K].copy(k.chars[K])},isEmpty:function(){for(var k=!0,K=0;K<_;K++)if(!this.chars[K].isEmpty()){k=!1;break}return k},setCursor:function(k){this.pos!==k&&(this.pos=k),this.pos<0?(b.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>_&&(b.log("ERROR","Too large cursor position "+this.pos),this.pos=_)},moveCursor:function(k){var K=this.pos+k;if(k>1)for(var W=this.pos+1;W<K+1;W++)this.chars[W].setPenState(this.currPenState);this.setCursor(K)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(k){k>=144&&this.backSpace();var K=g(k);if(this.pos>=_){b.log("ERROR","Cannot insert "+k.toString(16)+" ("+K+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(K,this.currPenState),this.moveCursor(1)},clearFromPos:function(k){var K;for(K=k;K<_;K++)this.chars[K].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var k=[],K=!0,W=0;W<_;W++){var Y=this.chars[W].uchar;Y!==" "&&(K=!1),k.push(Y)}return K?"":k.join("")},setPenStyles:function(k){this.currPenState.setStyles(k);var K=this.chars[this.pos];K.setPenState(this.currPenState)}};var x=function(){this.rows=[];for(var k=0;k<v;k++)this.rows.push(new D);this.currRow=v-1,this.nrRollUpRows=null,this.reset()};x.prototype={reset:function(){for(var k=0;k<v;k++)this.rows[k].clear();this.currRow=v-1},equals:function(k){for(var K=!0,W=0;W<v;W++)if(!this.rows[W].equals(k.rows[W])){K=!1;break}return K},copy:function(k){for(var K=0;K<v;K++)this.rows[K].copy(k.rows[K])},isEmpty:function(){for(var k=!0,K=0;K<v;K++)if(!this.rows[K].isEmpty()){k=!1;break}return k},backSpace:function(){var k=this.rows[this.currRow];k.backSpace()},clearToEndOfRow:function(){var k=this.rows[this.currRow];k.clearToEndOfRow()},insertChar:function(k){var K=this.rows[this.currRow];K.insertChar(k)},setPen:function(k){var K=this.rows[this.currRow];K.setPenStyles(k)},moveCursor:function(k){var K=this.rows[this.currRow];K.moveCursor(k)},setCursor:function(k){b.log("INFO","setCursor: "+k);var K=this.rows[this.currRow];K.setCursor(k)},setPAC:function(k){b.log("INFO","pacData = "+JSON.stringify(k));var K=k.row-1;this.nrRollUpRows&&K<this.nrRollUpRows-1&&(K=this.nrRollUpRows-1),this.currRow=K;var W=this.rows[this.currRow];if(k.indent!==null){var Y=k.indent,J=Math.max(Y-1,0);W.setCursor(k.indent),k.color=W.chars[J].penState.foreground}var ee={foreground:k.color,underline:k.underline,italics:k.italics,background:"black",flash:!1};this.setPen(ee)},setBkgData:function(k){b.log("INFO","bkgData = "+JSON.stringify(k)),this.backSpace(),this.setPen(k),this.insertChar(32)},setRollUpRows:function(k){this.nrRollUpRows=k},rollUp:function(){if(this.nrRollUpRows===null){b.log("DEBUG","roll_up but nrRollUpRows not set yet");return}b.log("TEXT",this.getDisplayText());var k=this.currRow+1-this.nrRollUpRows,K=this.rows.splice(k,1)[0];K.clear(),this.rows.splice(this.currRow,0,K),b.log("INFO","Rolling up")},getDisplayText:function(k){k=k||!1;for(var K=[],W="",Y=-1,J=0;J<v;J++){var ee=this.rows[J].getTextString();ee&&(Y=J+1,k?K.push("Row "+Y+': "'+ee+'"'):K.push(ee.trim()))}return K.length>0&&(k?W="["+K.join(" | ")+"]":W=K.join(`
`)),W},getTextAndFormat:function(){return this.rows}};var B=function(k,K){this.chNr=k,this.outputFilter=K,this.mode=null,this.verbose=0,this.displayedMemory=new x,this.nonDisplayedMemory=new x,this.lastOutputScreen=new x,this.currRollUpRow=this.displayedMemory.rows[v-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};B.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[v-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(k){this.outputFilter=k},setPAC:function(k){this.writeScreen.setPAC(k)},setBkgData:function(k){this.writeScreen.setBkgData(k)},setMode:function(k){k!==this.mode&&(this.mode=k,b.log("INFO","MODE="+k),this.mode=="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=k)},insertChars:function(k){for(var K=0;K<k.length;K++)this.writeScreen.insertChar(k[K]);var W=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";b.log("INFO",W+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(b.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){b.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){b.log("INFO","BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){b.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(k){b.log("INFO","RU("+k+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(k)},cc_FON:function(){b.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){b.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){b.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){b.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){b.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){b.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){b.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(b.log("INFO","EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var k=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=k,this.writeScreen=this.nonDisplayedMemory,b.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(k){b.log("INFO","TO("+k+") - Tab Offset"),this.writeScreen.moveCursor(k)},cc_MIDROW:function(k){var K={flash:!1};if(K.underline=k%2===1,K.italics=k>=46,K.italics)K.foreground="white";else{var W=Math.floor(k/2)-16,Y=["white","green","blue","cyan","red","yellow","magenta"];K.foreground=Y[W]}b.log("INFO","MIDROW: "+JSON.stringify(K)),this.writeScreen.setPen(K)},outputDataUpdate:function(){var k=b.time;k!==null&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(k,this.displayedMemory),this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=k:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,k,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:k),this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(k){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,k,this.displayedMemory),this.cueStartTime=k))}};var M=function(k,K,W){this.field=k||1,this.outputs=[K,W],this.channels=[new B(1,K),new B(2,W)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};M.prototype={getHandler:function(k){return this.channels[k].getHandler()},setHandler:function(k,K){this.channels[k].setHandler(K)},addData:function(k,K){var W,Y,J,ee=!1;this.lastTime=k,b.setTime(k);for(var ue=0;ue<K.length;ue+=2){if(Y=K[ue]&127,J=K[ue+1]&127,Y>=16&&Y<=31&&Y===this.lastCmdA&&J===this.lastCmdB){this.lastCmdA=null,this.lastCmdB=null,b.log("DEBUG","Repeated command ("+F([Y,J])+") is dropped");continue}if(Y===0&&J===0){this.dataCounters.padding+=2;continue}else b.log("DATA","["+F([K[ue],K[ue+1]])+"] -> ("+F([Y,J])+")");if(W=this.parseCmd(Y,J),W||(W=this.parseMidrow(Y,J)),W||(W=this.parsePAC(Y,J)),W||(W=this.parseBackgroundAttributes(Y,J)),!W&&(ee=this.parseChars(Y,J),ee))if(this.currChNr&&this.currChNr>=0){var ie=this.channels[this.currChNr-1];ie.insertChars(ee)}else b.log("WARNING","No channel found yet. TEXT-MODE?");W?this.dataCounters.cmd+=2:ee?this.dataCounters.char+=2:(this.dataCounters.other+=2,b.log("WARNING","Couldn't parse cleaned data "+F([Y,J])+" orig: "+F([K[ue],K[ue+1]])))}},parseCmd:function(k,K){var W=null,Y=(k===20||k===21||k===28||k===29)&&32<=K&&K<=47,J=(k===23||k===31)&&33<=K&&K<=35;if(!(Y||J))return!1;k===20||k===21||k===23?W=1:W=2;var ee=this.channels[W-1];return k===20||k===21||k===28||k===29?K===32?ee.cc_RCL():K===33?ee.cc_BS():K===34?ee.cc_AOF():K===35?ee.cc_AON():K===36?ee.cc_DER():K===37?ee.cc_RU(2):K===38?ee.cc_RU(3):K===39?ee.cc_RU(4):K===40?ee.cc_FON():K===41?ee.cc_RDC():K===42?ee.cc_TR():K===43?ee.cc_RTD():K===44?ee.cc_EDM():K===45?ee.cc_CR():K===46?ee.cc_ENM():K===47&&ee.cc_EOC():ee.cc_TO(K-32),this.lastCmdA=k,this.lastCmdB=K,this.currChNr=W,!0},parseMidrow:function(k,K){var W=null;if((k===17||k===25)&&32<=K&&K<=47){if(k===17?W=1:W=2,W!==this.currChNr)return b.log("ERROR","Mismatch channel in midrow parsing"),!1;var Y=this.channels[W-1];return Y.insertChars([32]),Y.cc_MIDROW(K),b.log("DEBUG","MIDROW ("+F([k,K])+")"),this.lastCmdA=k,this.lastCmdB=K,!0}return!1},parsePAC:function(k,K){var W=null,Y=null,J=(17<=k&&k<=23||25<=k&&k<=31)&&64<=K&&K<=127,ee=(k===16||k===24)&&64<=K&&K<=95;if(!(J||ee))return!1;W=k<=23?1:2,64<=K&&K<=95?Y=W===1?S[k]:T[k]:Y=W===1?E[k]:C[k];var ue=this.interpretPAC(Y,K),ie=this.channels[W-1];return ie.setPAC(ue),this.lastCmdA=k,this.lastCmdB=K,this.currChNr=W,!0},interpretPAC:function(k,K){var W=K,Y={color:null,italics:!1,indent:null,underline:!1,row:k};return K>95?W=K-96:W=K-64,Y.underline=(W&1)===1,W<=13?Y.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(W/2)]:W<=15?(Y.italics=!0,Y.color="white"):Y.indent=Math.floor((W-16)/2)*4,Y},parseChars:function(k,K){var W=null,Y=null,J=null;if(k>=25?(W=2,J=k-8):(W=1,J=k),17<=J&&J<=19){var ee=K;J===17?ee=K+80:J===18?ee=K+112:ee=K+144,b.log("INFO","Special char '"+g(ee)+"' in channel "+W),Y=[ee],this.lastCmdA=k,this.lastCmdB=K}else 32<=k&&k<=127&&(Y=K===0?[k]:[k,K],this.lastCmdA=null,this.lastCmdB=null);if(Y){var ue=F(Y);b.log("DEBUG","Char codes =  "+ue.join(","))}return Y},parseBackgroundAttributes:function(k,K){var W,Y,J,ee,ue=(k===16||k===24)&&32<=K&&K<=47,ie=(k===23||k===31)&&45<=K&&K<=47;return ue||ie?(W={},k===16||k===24?(Y=Math.floor((K-32)/2),W.background=R[Y],K%2===1&&(W.background=W.background+"_semi")):K===45?W.background="transparent":(W.foreground="black",K===47&&(W.underline=!0)),J=k<24?1:2,ee=this.channels[J-1],ee.setBkgData(W),this.lastCmdA=k,this.lastCmdB=K,!0):!1},reset:function(){for(var k=0;k<this.channels.length;k++)this.channels[k]&&this.channels[k].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(k){for(var K=0;K<this.channels.length;K++)this.channels[K]&&this.channels[K].cueSplitAtTime(k)}};var I=function(k,K,W){for(var Y=0,J=K,ee=0,ue=[],ie=function(Ee,Se,Me,de){if(Ee!==4||Se<8)return null;var xe=Me.getUint8(de),Fe=Me.getUint16(de+1),Le=Me.getUint32(de+3),De=Me.getUint8(de+7);return xe==181&&Fe==49&&Le==1195456820&&De==3};J<K+W;){if(Y=k.getUint32(J),ee=k.getUint8(J+4)&31,ee===6)for(var Q=J+5,se=-1;Q<J+4+Y-1;){se=0;for(var ve=255;ve===255;)ve=k.getUint8(Q),se+=ve,Q++;var _e=0;for(ve=255;ve===255;)ve=k.getUint8(Q),_e+=ve,Q++;ie(se,_e,k,Q)&&ue.push([Q,_e]),Q+=_e}J+=Y+4}return ue},U=function(k,K){var W=K[0],Y=[[],[]];W+=8;var J=k.getUint8(W)&31;W+=2;for(var ee=0;ee<J;ee++){var ue=k.getUint8(W),ie=ue&4,Q=ue&3;W++;var se=k.getUint8(W);W++;var ve=k.getUint8(W);W++,ie&&(se&127)+(ve&127)!==0&&(Q===0?(Y[0].push(se),Y[0].push(ve)):Q===1&&(Y[1].push(se),Y[1].push(ve)))}return Y};d.logger=b,d.PenState=O,d.CaptionScreen=x,d.Cea608Parser=M,d.findCea608Nalus=I,d.extractCea608DataFromRange=U})(f)},"./externals/xml2json.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>g});function m(v){var _="1.2.0";v=v||{},S();function S(){v.escapeMode===void 0&&(v.escapeMode=!0),v.attributePrefix===void 0&&(v.attributePrefix="_"),v.arrayAccessForm=v.arrayAccessForm||"none",v.emptyNodeForm=v.emptyNodeForm||"text",v.enableToStringFunc===void 0&&(v.enableToStringFunc=!0),v.arrayAccessFormPaths=v.arrayAccessFormPaths||[],v.skipEmptyTextNodesForObj===void 0&&(v.skipEmptyTextNodesForObj=!0),v.stripWhitespaces===void 0&&(v.stripWhitespaces=!0),v.datetimeAccessFormPaths=v.datetimeAccessFormPaths||[],v.useDoubleQuotes===void 0&&(v.useDoubleQuotes=!1),v.xmlElementsFilter=v.xmlElementsFilter||[],v.jsonPropertiesFilter=v.jsonPropertiesFilter||[],v.keepCData===void 0&&(v.keepCData=!1),v.ignoreRoot===void 0&&(v.ignoreRoot=!1)}var E={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function T(ie){var Q=ie.localName;return Q==null&&(Q=ie.baseName),(Q==null||Q=="")&&(Q=ie.nodeName),Q}function C(ie){return ie.prefix}function R(ie){return typeof ie=="string"?ie.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):ie}function b(ie,Q,se,ve){for(var _e=0;_e<ie.length;_e++){var Z=ie[_e];if(typeof Z=="string"){if(Z==ve)break}else if(Z instanceof RegExp){if(Z.test(ve))break}else if(typeof Z=="function"&&Z(Q,se,ve))break}return _e!=ie.length}function F(ie,Q,se){switch(v.arrayAccessForm){case"property":ie[Q]instanceof Array?ie[Q+"_asArray"]=ie[Q]:ie[Q+"_asArray"]=[ie[Q]];break}!(ie[Q]instanceof Array)&&v.arrayAccessFormPaths.length>0&&b(v.arrayAccessFormPaths,ie,Q,se)&&(ie[Q]=[ie[Q]])}function O(ie){var Q=ie.split(/[-T:+Z]/g),se=new Date(Q[0],Q[1]-1,Q[2]),ve=Q[5].split(".");if(se.setHours(Q[3],Q[4],ve[0]),ve.length>1&&se.setMilliseconds(ve[1]),Q[6]&&Q[7]){var _e=Q[6]*60+Number(Q[7]),Z=/\d\d-\d\d:\d\d$/.test(ie)?"-":"+";_e=0+(Z=="-"?-1*_e:_e),se.setMinutes(se.getMinutes()-_e-se.getTimezoneOffset())}else ie.indexOf("Z",ie.length-1)!==-1&&(se=new Date(Date.UTC(se.getFullYear(),se.getMonth(),se.getDate(),se.getHours(),se.getMinutes(),se.getSeconds(),se.getMilliseconds())));return se}function L(ie,Q,se){if(v.datetimeAccessFormPaths.length>0){var ve=se.split(".#")[0];return b(v.datetimeAccessFormPaths,ie,Q,ve)?O(ie):ie}else return ie}function D(ie,Q,se,ve){return Q==E.ELEMENT_NODE&&v.xmlElementsFilter.length>0?b(v.xmlElementsFilter,ie,se,ve):!0}function x(ie,Q){if(ie.nodeType==E.DOCUMENT_NODE){for(var se=new Object,ve=ie.childNodes,_e=0;_e<ve.length;_e++){var Z=ve[_e];if(Z.nodeType==E.ELEMENT_NODE)if(v.ignoreRoot)se=x(Z);else{se={};var Ee=T(Z);se[Ee]=x(Z)}}return se}else if(ie.nodeType==E.ELEMENT_NODE){var se=new Object;se.__cnt=0;for(var Se=[],ve=ie.childNodes,_e=0;_e<ve.length;_e++){var Z=ve[_e],Ee=T(Z);if(Z.nodeType!=E.COMMENT_NODE){var Me=Q+"."+Ee;if(D(se,Z.nodeType,Ee,Me))if(se.__cnt++,se[Ee]==null){var de=x(Z,Me);if(Ee!="#text"||/[^\s]/.test(de)){var xe={};xe[Ee]=de,Se.push(xe)}se[Ee]=de,F(se,Ee,Me)}else{se[Ee]!=null&&(se[Ee]instanceof Array||(se[Ee]=[se[Ee]],F(se,Ee,Me)));var de=x(Z,Me);if(Ee!="#text"||/[^\s]/.test(de)){var xe={};xe[Ee]=de,Se.push(xe)}se[Ee][se[Ee].length]=de}}}se.__children=Se;for(var Fe=T(ie),Le=0;Le<ie.attributes.length;Le++){var De=ie.attributes[Le];se.__cnt++;for(var Ae=De.value,ge=0,pe=v.matchers.length;ge<pe;ge++){var Re=v.matchers[ge];Re.test(De,Fe)&&(Ae=Re.converter(De.value))}se[v.attributePrefix+De.name]=Ae}var me=C(ie);return me!=null&&me!=""&&(se.__cnt++,se.__prefix=me),se["#text"]!=null&&(se.__text=se["#text"],se.__text instanceof Array&&(se.__text=se.__text.join(`
`)),v.stripWhitespaces&&(se.__text=se.__text.trim()),delete se["#text"],v.arrayAccessForm=="property"&&delete se["#text_asArray"],se.__text=L(se.__text,Ee,Q+"."+Ee)),se["#cdata-section"]!=null&&(se.__cdata=se["#cdata-section"],delete se["#cdata-section"],v.arrayAccessForm=="property"&&delete se["#cdata-section_asArray"]),se.__cnt==0&&v.emptyNodeForm=="text"?se="":se.__cnt==1&&se.__text!=null?se=se.__text:se.__cnt==1&&se.__cdata!=null&&!v.keepCData?se=se.__cdata:se.__cnt>1&&se.__text!=null&&v.skipEmptyTextNodesForObj&&(v.stripWhitespaces&&se.__text==""||se.__text.trim()=="")&&delete se.__text,delete se.__cnt,v.enableToStringFunc&&(se.__text!=null||se.__cdata!=null)&&(se.toString=function(){return(this.__text!=null?this.__text:"")+(this.__cdata!=null?this.__cdata:"")}),se}else if(ie.nodeType==E.TEXT_NODE||ie.nodeType==E.CDATA_SECTION_NODE)return ie.nodeValue}function B(ie,Q,se,ve){var _e="<"+(ie!=null&&ie.__prefix!=null?ie.__prefix+":":"")+Q;if(se!=null)for(var Z=0;Z<se.length;Z++){var Ee=se[Z],Se=ie[Ee];v.escapeMode&&(Se=R(Se)),_e+=" "+Ee.substr(v.attributePrefix.length)+"=",v.useDoubleQuotes?_e+='"'+Se+'"':_e+="'"+Se+"'"}return ve?_e+="/>":_e+=">",_e}function M(ie,Q){return"</"+(ie.__prefix!=null?ie.__prefix+":":"")+Q+">"}function I(ie,Q){return ie.indexOf(Q,ie.length-Q.length)!==-1}function U(ie,Q){return!!(v.arrayAccessForm=="property"&&I(Q.toString(),"_asArray")||Q.toString().indexOf(v.attributePrefix)==0||Q.toString().indexOf("__")==0||ie[Q]instanceof Function)}function w(ie){var Q=0;if(ie instanceof Object)for(var se in ie)U(ie,se)||Q++;return Q}function k(ie,Q,se){return v.jsonPropertiesFilter.length==0||se==""||b(v.jsonPropertiesFilter,ie,Q,se)}function K(ie){var Q=[];if(ie instanceof Object)for(var se in ie)se.toString().indexOf("__")==-1&&se.toString().indexOf(v.attributePrefix)==0&&Q.push(se);return Q}function W(ie){var Q="";return ie.__cdata!=null&&(Q+="<![CDATA["+ie.__cdata+"]]>"),ie.__text!=null&&(v.escapeMode?Q+=R(ie.__text):Q+=ie.__text),Q}function Y(ie){var Q="";return ie instanceof Object?Q+=W(ie):ie!=null&&(v.escapeMode?Q+=R(ie):Q+=ie),Q}function J(ie,Q){return ie===""?Q:ie+"."+Q}function ee(ie,Q,se,ve){var _e="";if(ie.length==0)_e+=B(ie,Q,se,!0);else for(var Z=0;Z<ie.length;Z++)_e+=B(ie[Z],Q,K(ie[Z]),!1),_e+=ue(ie[Z],J(ve,Q)),_e+=M(ie[Z],Q);return _e}function ue(ie,Q){var se="",ve=w(ie);if(ve>0){for(var _e in ie)if(!(U(ie,_e)||Q!=""&&!k(ie,_e,J(Q,_e)))){var Z=ie[_e],Ee=K(Z);if(Z==null||Z==null)se+=B(Z,_e,Ee,!0);else if(Z instanceof Object)if(Z instanceof Array)se+=ee(Z,_e,Ee,Q);else if(Z instanceof Date)se+=B(Z,_e,Ee,!1),se+=Z.toISOString(),se+=M(Z,_e);else{var Se=w(Z);Se>0||Z.__text!=null||Z.__cdata!=null?(se+=B(Z,_e,Ee,!1),se+=ue(Z,J(Q,_e)),se+=M(Z,_e)):se+=B(Z,_e,Ee,!0)}else se+=B(Z,_e,Ee,!1),se+=Y(Z),se+=M(Z,_e)}}return se+=Y(ie),se}this.parseXmlString=function(ie){if(ie===void 0)return null;var Q;if(window.DOMParser){var se=new window.DOMParser;try{Q=se.parseFromString(ie,"text/xml"),Q.getElementsByTagNameNS("*","parsererror").length>0&&(Q=null)}catch{Q=null}}else ie.indexOf("<?")==0&&(ie=ie.substr(ie.indexOf("?>")+2)),Q=new ActiveXObject("Microsoft.XMLDOM"),Q.async="false",Q.loadXML(ie);return Q},this.asArray=function(ie){return ie===void 0||ie==null?[]:ie instanceof Array?ie:[ie]},this.toXmlDateTime=function(ie){return ie instanceof Date?ie.toISOString():typeof ie=="number"?new Date(ie).toISOString():null},this.asDateTime=function(ie){return typeof ie=="string"?O(ie):ie},this.xml2json=function(ie){return x(ie)},this.xml_str2json=function(ie){var Q=this.parseXmlString(ie);return Q!=null?this.xml2json(Q):null},this.json2xml_str=function(ie){return ue(ie,"")},this.json2xml=function(ie){var Q=this.json2xml_str(ie);return this.parseXmlString(Q)},this.getVersion=function(){return _}}const g=m},"./index_mediaplayerOnly.js":(h,f,d)=>{d.r(f),d.d(f,{Debug:()=>v.default,FactoryMaker:()=>g.default,MediaPlayer:()=>m.default,default:()=>T});var m=d("./src/streaming/MediaPlayer.js"),g=d("./src/core/FactoryMaker.js"),v=d("./src/core/Debug.js"),_=d("./src/core/Version.js");d("./node_modules/es6-promise/auto.js");var S=typeof window<"u"&&window||d.g,E=S.dashjs;E||(E=S.dashjs={}),E.MediaPlayer=m.default,E.FactoryMaker=g.default,E.Debug=v.default,E.Version=(0,_.getVersionString)();const T=E},"./src/core/Debug.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>O});var m=d("./src/core/EventBus.js"),g=d("./src/core/events/Events.js"),v=d("./src/core/FactoryMaker.js"),_=0,S=1,E=2,T=3,C=4,R=5;function b(L){L=L||{};var D=this.context,x=(0,m.default)(D).getInstance(),B=L.settings,M=[],I,U,w,k;function K(){U=!0,w=!0,k=new Date().getTime(),typeof window<"u"&&window.console&&(M[S]=W(window.console.error),M[E]=W(window.console.error),M[T]=W(window.console.warn),M[C]=W(window.console.info),M[R]=W(window.console.debug))}function W(Z){return Z&&Z.bind?Z.bind(window.console):window.console.log.bind(window.console)}function Y(Z){return{fatal:ue.bind(Z),error:ie.bind(Z),warn:Q.bind(Z),info:se.bind(Z),debug:ve.bind(Z)}}function J(Z){U=Z}function ee(Z){w=Z}function ue(){for(var Z=arguments.length,Ee=new Array(Z),Se=0;Se<Z;Se++)Ee[Se]=arguments[Se];_e.apply(void 0,[S,this].concat(Ee))}function ie(){for(var Z=arguments.length,Ee=new Array(Z),Se=0;Se<Z;Se++)Ee[Se]=arguments[Se];_e.apply(void 0,[E,this].concat(Ee))}function Q(){for(var Z=arguments.length,Ee=new Array(Z),Se=0;Se<Z;Se++)Ee[Se]=arguments[Se];_e.apply(void 0,[T,this].concat(Ee))}function se(){for(var Z=arguments.length,Ee=new Array(Z),Se=0;Se<Z;Se++)Ee[Se]=arguments[Se];_e.apply(void 0,[C,this].concat(Ee))}function ve(){for(var Z=arguments.length,Ee=new Array(Z),Se=0;Se<Z;Se++)Ee[Se]=arguments[Se];_e.apply(void 0,[R,this].concat(Ee))}function _e(Z,Ee){var Se="",Me=null;U&&(Me=new Date().getTime(),Se+="["+(Me-k)+"]"),w&&Ee&&Ee.getClassName&&(Se+="["+Ee.getClassName()+"]",Ee.getType&&(Se+="["+Ee.getType()+"]")),Se.length>0&&(Se+=" ");for(var de=arguments.length,xe=new Array(de>2?de-2:0),Fe=2;Fe<de;Fe++)xe[Fe-2]=arguments[Fe];Array.apply(null,xe).forEach(function(Le){Se+=Le+" "}),M[Z]&&B&&B.get().debug.logLevel>=Z&&M[Z](Se),B&&B.get().debug.dispatchEvent&&x.trigger(g.default.LOG,{message:Se,level:Z})}return I={getLogger:Y,setLogTimestampVisible:J,setCalleeNameVisible:ee},K(),I}b.__dashjs_factory_name="Debug";var F=v.default.getSingletonFactory(b);F.LOG_LEVEL_NONE=_,F.LOG_LEVEL_FATAL=S,F.LOG_LEVEL_ERROR=E,F.LOG_LEVEL_WARNING=T,F.LOG_LEVEL_INFO=C,F.LOG_LEVEL_DEBUG=R,v.default.updateSingletonFactory(b.__dashjs_factory_name,F);const O=F},"./src/core/EventBus.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>T});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/MediaPlayerEvents.js"),v=0,_=5e3;function S(){var C={};function R(x,B,M){var I=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};if(!x)throw new Error("event type cannot be null or undefined");if(!B||typeof B!="function")throw new Error("listener must be a function: "+B);var U=I.priority||v;if(!(O(x,B,M)>=0)){C[x]=C[x]||[];var w={callback:B,scope:M,priority:U};M&&M.getStreamId&&(w.streamId=M.getStreamId()),M&&M.getType&&(w.mediaType=M.getType()),I&&I.mode&&(w.mode=I.mode);var k=C[x].some(function(K,W){if(K&&U>K.priority)return C[x].splice(W,0,w),!0});k||C[x].push(w)}}function b(x,B,M){if(!(!x||!B||!C[x])){var I=O(x,B,M);I<0||(C[x][I]=null)}}function F(x){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!(!x||!C[x])){if(B=B||{},B.hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");B.type=x,M.streamId&&(B.streamId=M.streamId),M.mediaType&&(B.mediaType=M.mediaType),C[x].filter(function(I){return!(!I||M.streamId&&I.streamId&&I.streamId!==M.streamId||M.mediaType&&I.mediaType&&I.mediaType!==M.mediaType||M.mode&&I.mode&&I.mode!==M.mode||!I.mode&&M.mode&&M.mode===g.default.EVENT_MODE_ON_RECEIVE)}).forEach(function(I){return I&&I.callback.call(I.scope,B)})}}function O(x,B,M){var I=-1;return C[x]&&C[x].some(function(U,w){if(U&&U.callback===B&&(!M||M===U.scope))return I=w,!0}),I}function L(){C={}}var D={on:R,off:b,trigger:F,reset:L};return D}S.__dashjs_factory_name="EventBus";var E=m.default.getSingletonFactory(S);E.EVENT_PRIORITY_LOW=v,E.EVENT_PRIORITY_HIGH=_,m.default.updateSingletonFactory(S.__dashjs_factory_name,E);const T=E},"./src/core/FactoryMaker.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>g});var m=function(){var v,_=[],S={},E={};function T(w,k,K,W){!W[w]&&k&&(W[w]={instance:k,override:K})}function C(w,k){for(var K in _){var W=_[K];if(W.context===w&&W.name===k)return W.instance}return null}function R(w,k,K){for(var W in _){var Y=_[W];if(Y.context===w&&Y.name===k){_[W].instance=K;return}}_.push({name:k,context:w,instance:K})}function b(w){_=_.filter(function(k){return k.context!==w})}function F(w,k){return k[w]}function O(w,k,K){w in K&&(K[w]=k)}function L(w,k){O(w,k,E)}function D(w){return F(w,E)}function x(w){var k=F(w.__dashjs_factory_name,E);return k||(k=function(W){return W===void 0&&(W={}),{create:function(){return U(w,W,arguments)}}},E[w.__dashjs_factory_name]=k),k}function B(w,k){O(w,k,S)}function M(w){return F(w,S)}function I(w){var k=F(w.__dashjs_factory_name,S);return k||(k=function(W){var Y;return W===void 0&&(W={}),{getInstance:function(){return Y||(Y=C(W,w.__dashjs_factory_name)),Y||(Y=U(w,W,arguments),_.push({name:w.__dashjs_factory_name,context:W,instance:Y})),Y}}},S[w.__dashjs_factory_name]=k),k}function U(w,k,K){var W,Y=w.__dashjs_factory_name,J=k[Y];if(J){var ee=J.instance;if(J.override){W=w.apply({context:k},K),ee=ee.apply({context:k,factory:v,parent:W},K);for(var ue in ee)W.hasOwnProperty(ue)&&(W[ue]=ee[ue])}else return ee.apply({context:k,factory:v},K)}else W=w.apply({context:k},K);return W.getClassName=function(){return Y},W}return v={extend:T,getSingletonInstance:C,setSingletonInstance:R,deleteSingletonInstances:b,getSingletonFactory:I,getSingletonFactoryByName:M,updateSingletonFactory:B,getClassFactory:x,getClassFactoryByName:D,updateClassFactory:L},v}();const g=m},"./src/core/Settings.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>O});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/Utils.js"),v=d("./src/core/Debug.js"),_=d("./src/streaming/constants/Constants.js"),S=d("./src/streaming/vo/metrics/HTTPRequest.js"),E=d("./src/core/EventBus.js"),T=d("./src/core/events/Events.js");function C(L){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?C=function(x){return typeof x}:C=function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},C(L)}function R(L,D,x){return D in L?Object.defineProperty(L,D,{value:x,enumerable:!0,configurable:!0,writable:!0}):L[D]=x,L}function b(){var L,D,x,B=this.context,M=(0,E.default)(B).getInstance(),I={"streaming.delay.liveDelay":T.default.SETTING_UPDATED_LIVE_DELAY,"streaming.delay.liveDelayFragmentCount":T.default.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,"streaming.liveCatchup.enabled":T.default.SETTING_UPDATED_CATCHUP_ENABLED,"streaming.liveCatchup.playbackRate.min":T.default.SETTING_UPDATED_PLAYBACK_RATE_MIN,"streaming.liveCatchup.playbackRate.max":T.default.SETTING_UPDATED_PLAYBACK_RATE_MAX},U={debug:{logLevel:v.default.LOG_LEVEL_WARNING,dispatchEvent:!1},streaming:{abandonLoadTimeout:1e4,wallclockTimeUpdateInterval:100,manifestUpdateRetryInterval:100,cacheInitSegments:!1,applyServiceDescription:!0,applyProducerReferenceTime:!0,applyContentSteering:!0,eventControllerRefreshDelay:100,enableManifestDurationMismatchFix:!0,enableManifestTimescaleMismatchFix:!1,capabilities:{filterUnsupportedEssentialProperties:!0,useMediaCapabilitiesApi:!1},timeShiftBuffer:{calcFromSegmentTimeline:!1,fallbackToSegmentTimeline:!0},metrics:{maxListDepth:100},delay:{liveDelayFragmentCount:NaN,liveDelay:NaN,useSuggestedPresentationDelay:!0},protection:{keepProtectionMediaKeys:!1,ignoreEmeEncryptedEvent:!1,detectPlayreadyMessageFormat:!0},buffer:{enableSeekDecorrelationFix:!1,fastSwitchEnabled:!0,flushBufferAtTrackSwitch:!1,reuseExistingSourceBuffers:!0,bufferPruningInterval:10,bufferToKeep:20,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,initialBufferLevel:NaN,stableBufferTime:12,longFormContentDurationThreshold:600,stallThreshold:.3,useAppendWindow:!0,setStallState:!0,avoidCurrentTimeRangePruning:!1,useChangeTypeForTrackSwitch:!0},gaps:{jumpGaps:!0,jumpLargeGaps:!0,smallGapLimit:1.5,threshold:.3,enableSeekFix:!0,enableStallFix:!1,stallSeek:.1},utcSynchronization:{enabled:!0,useManifestDateHeaderTimeSource:!0,backgroundAttempts:2,timeBetweenSyncAttempts:30,maximumTimeBetweenSyncAttempts:600,minimumTimeBetweenSyncAttempts:2,timeBetweenSyncAttemptsAdjustmentFactor:2,maximumAllowedDrift:100,enableBackgroundSyncAfterSegmentDownloadError:!0,defaultTimingSource:{scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"https://time.akamai.com/?iso&ms"}},scheduling:{defaultTimeout:500,lowLatencyTimeout:0,scheduleWhilePaused:!0},text:{defaultEnabled:!0,extendSegmentedCues:!0,webvtt:{customRenderingEnabled:!1}},liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN},playbackBufferMin:.5,enabled:null,mode:_.default.LIVE_CATCHUP_MODE_DEFAULT},lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},trackSwitchMode:{audio:_.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE,video:_.default.TRACK_SWITCH_MODE_NEVER_REPLACE},selectionModeForInitialTrack:_.default.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY,fragmentRequestTimeout:2e4,manifestRequestTimeout:1e4,retryIntervals:(L={},R(L,S.HTTPRequest.MPD_TYPE,500),R(L,S.HTTPRequest.XLINK_EXPANSION_TYPE,500),R(L,S.HTTPRequest.MEDIA_SEGMENT_TYPE,1e3),R(L,S.HTTPRequest.INIT_SEGMENT_TYPE,1e3),R(L,S.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),R(L,S.HTTPRequest.INDEX_SEGMENT_TYPE,1e3),R(L,S.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE,1e3),R(L,S.HTTPRequest.LICENSE,1e3),R(L,S.HTTPRequest.OTHER_TYPE,1e3),R(L,"lowLatencyReductionFactor",10),L),retryAttempts:(D={},R(D,S.HTTPRequest.MPD_TYPE,3),R(D,S.HTTPRequest.XLINK_EXPANSION_TYPE,1),R(D,S.HTTPRequest.MEDIA_SEGMENT_TYPE,3),R(D,S.HTTPRequest.INIT_SEGMENT_TYPE,3),R(D,S.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),R(D,S.HTTPRequest.INDEX_SEGMENT_TYPE,3),R(D,S.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE,3),R(D,S.HTTPRequest.LICENSE,3),R(D,S.HTTPRequest.OTHER_TYPE,3),R(D,"lowLatencyMultiplyFactor",5),D),abr:{movingAverageMethod:_.default.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:_.default.ABR_STRATEGY_DYNAMIC,additionalAbrRules:{insufficientBufferRule:!0,switchHistoryRule:!0,droppedFramesRule:!0,abandonRequestsRule:!0},bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0},fetchThroughputCalculationMode:_.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING},cmcd:{enabled:!1,sid:null,cid:null,rtp:null,rtpSafetyFactor:5,mode:_.default.CMCD_MODE_QUERY,enabledKeys:["br","d","ot","tb","bl","dl","mtp","nor","nrr","su","bs","rtp","cid","pr","sf","sid","st","v"]},cmsd:{enabled:!1,abr:{applyMb:!1,etpWeightRatio:0}}},errors:{recoverAttempts:{mediaErrorDecode:5}}},w=g.default.clone(U);function k(J,ee,ue){for(var ie in J)J.hasOwnProperty(ie)&&(ee.hasOwnProperty(ie)?C(J[ie])==="object"&&!(J[ie]instanceof Array)&&J[ie]!==null?k(J[ie],ee[ie],ue.slice()+ie+"."):(ee[ie]=g.default.clone(J[ie]),I[ue+ie]&&M.trigger(I[ue+ie])):console.error("Settings parameter "+ue+ie+" is not supported"))}function K(){return w}function W(J){C(J)==="object"&&k(J,w,"")}function Y(){w=g.default.clone(U)}return x={get:K,update:W,reset:Y},x}b.__dashjs_factory_name="Settings";var F=m.default.getSingletonFactory(b);const O=F},"./src/core/Utils.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>R});var m=d("./node_modules/path-browserify/index.js"),g=d.n(m),v=d("./node_modules/ua-parser-js/src/ua-parser.js");function _(b){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_=function(O){return typeof O}:_=function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},_(b)}function S(b,F){if(!(b instanceof F))throw new TypeError("Cannot call a class as a function")}function E(b,F){for(var O=0;O<F.length;O++){var L=F[O];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(b,L.key,L)}}function T(b,F,O){return F&&E(b.prototype,F),O&&E(b,O),b}var C=function(){function b(){S(this,b)}return T(b,null,[{key:"mixin",value:function(O,L,D){var x,B={};if(O)for(var M in L)L.hasOwnProperty(M)&&(x=L[M],(!(M in O)||O[M]!==x&&(!(M in B)||B[M]!==x))&&(_(O[M])==="object"&&O[M]!==null?O[M]=b.mixin(O[M],x,D):O[M]=D(x)));return O}},{key:"clone",value:function(O){if(!O||_(O)!=="object")return O;var L;if(O instanceof Array){L=[];for(var D=0,x=O.length;D<x;++D)D in O&&L.push(b.clone(O[D]))}else L={};return b.mixin(L,O,b.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(O,L){try{if(!L||L.length===0)return O;var D=new URL(O);return L.forEach(function(x){x.key&&x.value&&D.searchParams.set(x.key,x.value)}),D.href}catch{return O}}},{key:"parseHttpHeaders",value:function(O){var L={};if(!O)return L;for(var D=O.trim().split(`\r
`),x=0,B=D.length;x<B;x++){var M=D[x],I=M.indexOf(": ");I>0&&(L[M.substring(0,I)]=M.substring(I+2))}return L}},{key:"generateUuid",value:function(){var O=new Date().getTime(),L="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(D){var x=(O+Math.random()*16)%16|0;return O=Math.floor(O/16),(D=="x"?x:x&3|8).toString(16)});return L}},{key:"generateHashCode",value:function(O){var L=0;if(O.length===0)return L;for(var D=0;D<O.length;D++){var x=O.charCodeAt(D);L=(L<<5)-L+x,L|=0}return L}},{key:"getRelativeUrl",value:function(O,L){try{var D=new URL(O),x=new URL(L);if(D.protocol=x.protocol,D.origin!==x.origin)return L;var B=g().relative(D.pathname.substr(0,D.pathname.lastIndexOf("/")),x.pathname.substr(0,x.pathname.lastIndexOf("/"))),M=B.length===0?1:0;return B+=x.pathname.substr(x.pathname.lastIndexOf("/")+M,x.pathname.length-1),x.pathname.length<B.length?x.pathname:B}catch{return L}}},{key:"parseUserAgent",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;try{var L=O===null&&typeof navigator<"u"?navigator.userAgent.toLowerCase():"";return(0,v.UAParser)(L)}catch{return{}}}}]),b}();const R=C},"./src/core/Version.js":(h,f,d)=>{d.r(f),d.d(f,{getVersionString:()=>g});var m="4.6.0";function g(){return m}},"./src/core/errors/Errors.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/core/errors/ErrorsBase.js");function g(D){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(B){return typeof B}:g=function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},g(D)}function v(D,x){if(!(D instanceof x))throw new TypeError("Cannot call a class as a function")}function _(D,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");D.prototype=Object.create(x&&x.prototype,{constructor:{value:D,writable:!0,configurable:!0}}),x&&S(D,x)}function S(D,x){return S=Object.setPrototypeOf||function(M,I){return M.__proto__=I,M},S(D,x)}function E(D){var x=R();return function(){var M=b(D),I;if(x){var U=b(this).constructor;I=Reflect.construct(M,arguments,U)}else I=M.apply(this,arguments);return T(this,I)}}function T(D,x){return x&&(g(x)==="object"||typeof x=="function")?x:C(D)}function C(D){if(D===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D}function R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(D){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)},b(D)}var F=function(D){_(B,D);var x=E(B);function B(){var M;return v(this,B),M=x.call(this),M.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,M.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,M.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,M.SEGMENT_BASE_LOADER_ERROR_CODE=15,M.TIME_SYNC_FAILED_ERROR_CODE=16,M.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,M.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,M.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,M.APPEND_ERROR_CODE=20,M.REMOVE_ERROR_CODE=21,M.DATA_UPDATE_FAILED_ERROR_CODE=22,M.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,M.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,M.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,M.DOWNLOAD_ERROR_ID_SIDX_CODE=26,M.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,M.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,M.DOWNLOAD_ERROR_ID_XLINK_CODE=29,M.MANIFEST_ERROR_ID_PARSE_CODE=31,M.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,M.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,M.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,M.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,M.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",M.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",M.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",M.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",M.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",M.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segment ranges from sidx",M.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize client and server time",M.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",M.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",M.APPEND_ERROR_MESSAGE="chunk is not defined",M.REMOVE_ERROR_MESSAGE="Removing data from the SourceBuffer",M.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",M.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",M.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",M.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",M.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",M}return B}(m.default),O=new F;const L=O},"./src/core/errors/ErrorsBase.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});function m(E,T){if(!(E instanceof T))throw new TypeError("Cannot call a class as a function")}function g(E,T){for(var C=0;C<T.length;C++){var R=T[C];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(E,R.key,R)}}function v(E,T,C){return T&&g(E.prototype,T),C&&g(E,C),E}var _=function(){function E(){m(this,E)}return v(E,[{key:"extend",value:function(C,R){if(C){var b=R?R.override:!1,F=R?R.publicOnly:!1;for(var O in C)!C.hasOwnProperty(O)||this[O]&&!b||F&&C[O].indexOf("public_")===-1||(this[O]=C[O])}}}]),E}();const S=_},"./src/core/events/CoreEvents.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>O});var m=d("./src/core/events/EventsBase.js");function g(L){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(x){return typeof x}:g=function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},g(L)}function v(L,D){if(!(L instanceof D))throw new TypeError("Cannot call a class as a function")}function _(L,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function");L.prototype=Object.create(D&&D.prototype,{constructor:{value:L,writable:!0,configurable:!0}}),D&&S(L,D)}function S(L,D){return S=Object.setPrototypeOf||function(B,M){return B.__proto__=M,B},S(L,D)}function E(L){var D=R();return function(){var B=b(L),M;if(D){var I=b(this).constructor;M=Reflect.construct(B,arguments,I)}else M=B.apply(this,arguments);return T(this,M)}}function T(L,D){return D&&(g(D)==="object"||typeof D=="function")?D:C(L)}function C(L){if(L===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L}function R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(L){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)},b(L)}var F=function(L){_(x,L);var D=E(x);function x(){var B;return v(this,x),B=D.call(this),B.ATTEMPT_BACKGROUND_SYNC="attemptBackgroundSync",B.BUFFERING_COMPLETED="bufferingCompleted",B.BUFFER_CLEARED="bufferCleared",B.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",B.BUFFER_REPLACEMENT_STARTED="bufferReplacementStarted",B.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",B.CMSD_STATIC_HEADER="cmsdStaticHeader",B.CURRENT_TRACK_CHANGED="currentTrackChanged",B.DATA_UPDATE_COMPLETED="dataUpdateCompleted",B.INBAND_EVENTS="inbandEvents",B.INITIAL_STREAM_SWITCH="initialStreamSwitch",B.INIT_FRAGMENT_LOADED="initFragmentLoaded",B.INIT_FRAGMENT_NEEDED="initFragmentNeeded",B.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",B.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",B.LOADING_COMPLETED="loadingCompleted",B.LOADING_PROGRESS="loadingProgress",B.LOADING_DATA_PROGRESS="loadingDataProgress",B.LOADING_ABANDONED="loadingAborted",B.MANIFEST_UPDATED="manifestUpdated",B.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",B.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",B.QUOTA_EXCEEDED="quotaExceeded",B.SEGMENT_LOCATION_BLACKLIST_ADD="segmentLocationBlacklistAdd",B.SEGMENT_LOCATION_BLACKLIST_CHANGED="segmentLocationBlacklistChanged",B.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",B.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",B.SET_FRAGMENTED_TEXT_AFTER_DISABLED="setFragmentedTextAfterDisabled",B.SET_NON_FRAGMENTED_TEXT="setNonFragmentedText",B.SOURCE_BUFFER_ERROR="sourceBufferError",B.STREAMS_COMPOSED="streamsComposed",B.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",B.STREAM_REQUESTING_COMPLETED="streamRequestingCompleted",B.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",B.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",B.UPDATE_TIME_SYNC_OFFSET="updateTimeSyncOffset",B.URL_RESOLUTION_FAILED="urlResolutionFailed",B.VIDEO_CHUNK_RECEIVED="videoChunkReceived",B.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",B.XLINK_ELEMENT_LOADED="xlinkElementLoaded",B.XLINK_READY="xlinkReady",B.SEEK_TARGET="seekTarget",B.SETTING_UPDATED_LIVE_DELAY="settingUpdatedLiveDelay",B.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT="settingUpdatedLiveDelayFragmentCount",B.SETTING_UPDATED_CATCHUP_ENABLED="settingUpdatedCatchupEnabled",B.SETTING_UPDATED_PLAYBACK_RATE_MIN="settingUpdatedPlaybackRateMin",B.SETTING_UPDATED_PLAYBACK_RATE_MAX="settingUpdatedPlaybackRateMax",B}return x}(m.default);const O=F},"./src/core/events/Events.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/core/events/CoreEvents.js");function g(D){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(B){return typeof B}:g=function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},g(D)}function v(D,x){if(!(D instanceof x))throw new TypeError("Cannot call a class as a function")}function _(D,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");D.prototype=Object.create(x&&x.prototype,{constructor:{value:D,writable:!0,configurable:!0}}),x&&S(D,x)}function S(D,x){return S=Object.setPrototypeOf||function(M,I){return M.__proto__=I,M},S(D,x)}function E(D){var x=R();return function(){var M=b(D),I;if(x){var U=b(this).constructor;I=Reflect.construct(M,arguments,U)}else I=M.apply(this,arguments);return T(this,I)}}function T(D,x){return x&&(g(x)==="object"||typeof x=="function")?x:C(D)}function C(D){if(D===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D}function R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(D){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)},b(D)}var F=function(D){_(B,D);var x=E(B);function B(){return v(this,B),x.apply(this,arguments)}return B}(m.default),O=new F;const L=O},"./src/core/events/EventsBase.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});function m(E,T){if(!(E instanceof T))throw new TypeError("Cannot call a class as a function")}function g(E,T){for(var C=0;C<T.length;C++){var R=T[C];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(E,R.key,R)}}function v(E,T,C){return T&&g(E.prototype,T),C&&g(E,C),E}var _=function(){function E(){m(this,E)}return v(E,[{key:"extend",value:function(C,R){if(C){var b=R?R.override:!1,F=R?R.publicOnly:!1;for(var O in C)!C.hasOwnProperty(O)||this[O]&&!b||F&&C[O].indexOf("public_")===-1||(this[O]=C[O])}}}]),E}();const S=_},"./src/dash/DashAdapter.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/dash/constants/DashConstants.js"),g=d("./src/dash/vo/RepresentationInfo.js"),v=d("./src/dash/vo/MediaInfo.js"),_=d("./src/dash/vo/StreamInfo.js"),S=d("./src/dash/vo/ManifestInfo.js"),E=d("./src/dash/vo/Event.js"),T=d("./src/core/FactoryMaker.js"),C=d("./src/dash/models/DashManifestModel.js"),R=d("./src/dash/models/PatchManifestModel.js"),b=d("./node_modules/bcp-47-normalize/index.js"),F=d.n(b);function O(){var D,x,B,M,I,U,w,k=this.context,K="urn:dvb:dash:profile:dvb-dash:2014";function W(){x=(0,C.default)(k).getInstance(),B=(0,R.default)(k).getInstance(),Pt()}function Y(je){je&&(je.constants&&(U=je.constants),je.cea608parser&&(w=je.cea608parser),je.errHandler&&x.setConfig({errHandler:je.errHandler}),je.BASE64&&x.setConfig({BASE64:je.BASE64}))}function J(je){if(je){var Oe=new g.default,ze=je.adaptation.period.mpd.manifest.Period_asArray[je.adaptation.period.index].AdaptationSet_asArray[je.adaptation.index],ct=x.getRepresentationFor(je.index,ze);return Oe.id=je.id,Oe.quality=je.index,Oe.bandwidth=x.getBandwidth(ct),Oe.fragmentDuration=je.segmentDuration||(je.segments&&je.segments.length>0?je.segments[0].duration:NaN),Oe.MSETimeOffset=je.MSETimeOffset,Oe.mediaInfo=Ht(je.adaptation),Oe}else return null}function ee(je,Oe){if(M.length===0||!je)return null;var ze=Wt(je,M);if(!ze)return null;var ct=x.getAdaptationsForPeriod(ze),dt=ie(je.index,Oe,je);if(!dt)return null;var bt=x.getIndexForAdaptation(dt,M[0].mpd.manifest,je.index);return Ht(ct[bt])}function ue(je){return x.getRolesForAdaptation(je).filter(function(Oe){return Oe.value===m.default.MAIN})[0]}function ie(je,Oe,ze){var ct=x.getAdaptationsForType(M[0].mpd.manifest,je,Oe);if(!ct||ct.length===0)return null;if(ct.length>1&&ze){var dt=ve(ze,Oe);if(I[ze.id]&&I[ze.id][Oe]){for(var bt=0,Ft=ct.length;bt<Ft;bt++)if(Q(I[ze.id][Oe],dt[bt]))return ct[bt]}for(var Dt=0,Kt=ct.length;Dt<Kt;Dt++)if(ue(ct[Dt]))return ct[Dt]}return ct[0]}function Q(je,Oe){if(!je||!Oe)return!1;var ze=je.id===Oe.id,ct=je.codec===Oe.codec,dt=je.viewpoint===Oe.viewpoint,bt=je.lang===Oe.lang,Ft=je.roles.toString()===Oe.roles.toString(),Dt=je.accessibility.toString()===Oe.accessibility.toString(),Kt=je.audioChannelConfiguration.toString()===Oe.audioChannelConfiguration.toString();return ze&&ct&&dt&&bt&&Ft&&Dt&&Kt}function se(je,Oe,ze,ct,dt,bt){var Ft=[],Dt,Kt,on,Tn,Ke,ut;if(!ct||ct.length===0)return[];var wt=x.getAdaptationsForPeriod(Oe);for(Tn=0,ut=ct.length;Tn<ut;Tn++)if(Dt=ct[Tn],on=x.getIndexForAdaptation(Dt,je,ze.index),Kt=Ht(wt[on]),bt){var Gt=Kt.accessibility.length;for(Ke=0;Ke<Gt;Ke++)if(Kt){var Qt=Kt.accessibility[Ke];if(Qt.indexOf("cea-608:")===0){var sn=Qt.substring(8),Dn=sn.split(";");if(Dn[0].substring(0,2)==="CC")for(Ke=0;Ke<Dn.length;Ke++)Kt||(Kt=Ht.call(this,wt[on])),nt(Kt,Dn[Ke].substring(0,3),Dn[Ke].substring(4)),Ft.push(Kt),Kt=null;else for(Ke=0;Ke<Dn.length;Ke++)Kt||(Kt=Ht.call(this,wt[on])),nt(Kt,"CC"+(Ke+1),Dn[Ke]),Ft.push(Kt),Kt=null}else Qt.indexOf("cea-608")===0&&(nt(Kt,U.CC1,"eng"),Ft.push(Kt),Kt=null)}}else dt===U.IMAGE?(Et(Kt),Ft.push(Kt),Kt=null):Kt&&Ft.push(Kt);return Ft}function ve(je,Oe,ze){var ct=M,dt=ze,bt=[];if(dt)Vt(),ct=j(dt);else if(M.length>0)dt=M[0].mpd.manifest;else return bt;var Ft=Wt(je,ct),Dt=x.getAdaptationsForType(dt,je?je.index:null,Oe);return bt=se(dt,Ft,je,Dt,Oe),Oe===U.TEXT&&(Dt=x.getAdaptationsForType(dt,je?je.index:null,U.VIDEO),bt=bt.concat(se(dt,Ft,je,Dt,Oe,!0))),bt}function _e(je){if(!je)return null;Vt(),M=j(je)}function Z(je,Oe){var ze=[],ct=M;if(je&&(Vt(),ct=j(je)),ct.length>0){(!Oe||Oe>ct.length)&&(Oe=ct.length);for(var dt=0;dt<Oe;dt++)ze.push(St(ct[dt]))}return ze}function Ee(je,Oe){var ze,ct,dt=Wt(je,M);return ze=Oe?Oe.id:null,M.length>0&&dt&&(ct=ze?x.getAdaptationForId(ze,M[0].mpd.manifest,dt.index):x.getAdaptationForIndex(Oe?Oe.index:null,M[0].mpd.manifest,dt.index)),ct}function Se(je,Oe){var ze,ct,dt=Wt(je,M);return ze=Oe?Oe.id:null,M.length>0&&dt&&(ct=ze?x.getAdaptationForId(ze,M[0].mpd.manifest,dt.index):x.getAdaptationForIndex(Oe?Oe.index:null,M[0].mpd.manifest,dt.index)),ct?x.getProducerReferenceTimesForAdaptation(ct):[]}function Me(je){try{return x.getEssentialPropertiesForRepresentation(je)}catch{return[]}}function de(je){return x.getRealPeriodForIndex(je,M[0].mpd.manifest)}function xe(je){var Oe,ze=Nt(je);return Oe=x.getRepresentationsForAdaptation(ze),Oe}function Fe(je,Oe,ze,ct){try{if(!je||!Oe||isNaN(ze)||!ct)return null;var dt=je.scheme_id_uri,bt=je.value;if(!Oe[dt+"/"+bt])return null;var Ft=new E.default,Dt=je.timescale||1,Kt=ct.adaptation.period.start,on=Oe[dt+"/"+bt],Tn=isNaN(ct.presentationTimeOffset)?isNaN(on.presentationTimeOffset)?0:on.presentationTimeOffset:ct.presentationTimeOffset,Ke=je.presentation_time_delta/Dt,ut;je.version===0?ut=Kt+ze-Tn+Ke:ut=Kt-Tn+Ke;var wt=je.event_duration/Dt,Gt=je.id,Qt=je.message_data;return Ft.eventStream=on,Ft.eventStream.value=bt,Ft.eventStream.timescale=Dt,Ft.duration=wt,Ft.id=Gt,Ft.calculatedPresentationTime=ut,Ft.messageData=Qt,Ft.presentationTimeDelta=Ke,Ft}catch{return null}}function Le(je,Oe,ze){var ct=[];if(M.length>0){var dt=M[0].mpd.manifest;if(je instanceof _.default){var bt=Wt(je,M);ct=x.getEventsForPeriod(bt)}else if(je instanceof v.default){var Ft=Wt(ze,M);ct=x.getEventStreamForAdaptationSet(dt,Nt(je),Ft)}else if(je instanceof g.default){var Dt=Wt(ze,M);ct=x.getEventStreamForRepresentation(dt,Oe,Dt)}}return ct}function De(je,Oe,ze){I[je]=I[je]||{},I[je][Oe]=I[je][Oe]||{},I[je][Oe]=ze}function Ae(je){return x.getIsText(je)}function ge(){var je=st();return x.getUTCTimingSources(je)}function pe(){var je=M.length>0?M[0].mpd:null;return x.getSuggestedPresentationDelay(je)}function Re(je){var Oe=$(je);return x.getAvailabilityStartTime(Oe)}function me(je){var Oe=st(je);return x.getIsDynamic(Oe)}function V(je){var Oe=st(je);return x.getDuration(Oe)}function j(je){var Oe=$(je);return x.getRegularPeriods(Oe)}function $(je){var Oe=st(je);return x.getMpd(Oe)}function re(je){return x.getContentSteering(je)}function oe(je){return x.getLocation(je)}function X(je){var Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return x.getManifestUpdatePeriod(je,Oe)}function z(je){return x.getPublishTime(je)}function ne(je){var Oe=x.getPatchLocation(je),ze=x.getPublishTime(je);if(!Oe||!ze)return null;if(Oe.hasOwnProperty("ttl")&&ze){var ct=parseFloat(Oe.ttl)*1e3;if(ze.getTime()+ct<=new Date().getTime())return null}return Oe.__text}function fe(je){return x.hasProfile(je,K)}function Ce(je){return B.getIsPatch(je)}function Pe(je){return x.getBaseURLsFromElement(je)}function he(){return x.getRepresentationSortFunction()}function Ue(je,Oe,ze){return x.getCodec(je,Oe,ze)}function we(je,Oe){var ze,ct=Zt(Oe);return ze=In(ct,je),ze?ze.bandwidth:null}function $e(je,Oe){var ze=Zt(Oe);return We(ze,je)}function it(je,Oe){var ze=Zt(Oe);return Ct(ze,je)}function mt(je){if(!je||M.length===0)return null;var Oe=M.filter(function(ze){return ze.id===je});return Oe&&Oe.length>0?Oe[0]:null}function pt(je,Oe){return x.getIsTypeOf(je,Oe)}function Pt(){M=[],I={}}function lt(je,Oe){var ze=x.getId(je),ct=B.getMpdId(Oe),dt=x.getPublishTime(je),bt=B.getPublishTime(Oe),Ft=B.getOriginalPublishTime(Oe);return!!(ze&&ct&&ze==ct&&dt&&Ft&&dt.getTime()==Ft.getTime()&&bt&&dt.getTime()<bt.getTime())}function Ye(je,Oe){B.getPatchOperations(Oe).forEach(function(ze){var ct=ze.getMpdTarget(je);if(ct!==null){var dt=ct.name,bt=ct.target,Ft=ct.leaf;if(ze.xpath.findsAttribute()){switch(ze.action){case"add":case"replace":bt[dt]=ze.value;break;case"remove":delete bt[dt];break}return}var Dt=(bt[dt+"_asArray"]||[]).indexOf(Ft),Kt=ze.position==="prepend"||ze.position==="before";if((ze.action==="remove"||ze.action==="replace")&&(delete bt[dt],Dt!=-1)){var on=bt[dt+"_asArray"];on.splice(Dt,1),on.length>1?bt[dt]=on:on.length==1?bt[dt]=on[0]:delete bt[dt+"_asArray"]}(ze.action==="add"||ze.action==="replace")&&Object.keys(ze.value).forEach(function(Tn){var Ke=ze.value[Tn],ut=bt[Tn+"_asArray"]||[];if(ut.length===0&&bt[Tn]&&ut.push(bt[Tn]),ut.length===0)ut=Ke;else{var wt=ut.length;Tn==dt&&Dt!=-1?wt=Dt+(Kt?0:1)+(ze.action=="replace"?-1:0):wt=Kt?0:ut.length,ut.splice.apply(ut,[wt,0].concat(Ke))}bt[Tn+"_asArray"]=ut,bt[Tn]=ut.length==1?ut[0]:ut})}})}function st(je){return je||(M.length>0?M[0].mpd.manifest:null)}function Nt(je){try{var Oe=Wt(je.streamInfo,M),ze=x.getAdaptationsForPeriod(Oe);return!je||!je.streamInfo||je.streamInfo.id===void 0||!ze?null:ze[je.index]}catch{return null}}function Wt(je,Oe){for(var ze=Oe.length,ct=0;ct<ze;ct++){var dt=Oe[ct];if(je&&je.id===dt.id)return dt}return null}function Ht(je){if(!je)return null;var Oe=new v.default,ze=je.period.mpd.manifest.Period_asArray[je.period.index].AdaptationSet_asArray[je.index],ct;if(Oe.id=je.id,Oe.index=je.index,Oe.type=je.type,Oe.streamInfo=St(je.period),Oe.representationCount=x.getRepresentationCount(ze),Oe.labels=x.getLabelsForAdaptation(ze),Oe.lang=x.getLanguageForAdaptation(ze),ct=x.getViewpointForAdaptation(ze),Oe.viewpoint=ct?ct.value:void 0,Oe.accessibility=x.getAccessibilityForAdaptation(ze).map(function(Ft){var Dt=Ft.value,Kt=Dt;return Ft.schemeIdUri&&Ft.schemeIdUri.search("cea-608")>=0&&typeof w<"u"&&(Dt?Kt="cea-608:"+Dt:Kt="cea-608",Oe.embeddedCaptions=!0),Kt}),Oe.audioChannelConfiguration=x.getAudioChannelConfigurationForAdaptation(ze).map(function(Ft){return Ft.value}),Oe.audioChannelConfiguration.length===0&&Array.isArray(ze.Representation_asArray)&&ze.Representation_asArray.length>0&&(Oe.audioChannelConfiguration=x.getAudioChannelConfigurationForRepresentation(ze.Representation_asArray[0]).map(function(Ft){return Ft.value})),Oe.roles=x.getRolesForAdaptation(ze).map(function(Ft){return Ft.value}),Oe.codec=x.getCodec(ze),Oe.mimeType=x.getMimeType(ze),Oe.contentProtection=x.getContentProtectionData(ze),Oe.bitrateList=x.getBitrateListForAdaptation(ze),Oe.selectionPriority=x.getSelectionPriority(ze),Oe.contentProtection){var dt=Oe.contentProtection.map(function(Ft){return x.getKID(Ft)}).filter(function(Ft){return Ft!==null});if(dt.length){var bt=dt[0];Oe.contentProtection.forEach(function(Ft){Ft.keyId=bt})}}return Oe.isText=x.getIsText(ze),Oe.supplementalProperties=x.getSupplementalProperties(ze),Oe.isFragmented=x.getIsFragmented(ze),Oe.isEmbedded=!1,Oe}function nt(je,Oe,ze){je.id=Oe,je.index=100+parseInt(Oe.substring(2,3)),je.type=U.TEXT,je.codec="cea-608-in-SEI",je.isEmbedded=!0,je.isFragmented=!1,je.lang=F()(ze),je.roles=["caption"]}function Et(je){je.type=U.IMAGE}function St(je){var Oe=new _.default,ze=1;return Oe.id=je.id,Oe.index=je.index,Oe.start=je.start,Oe.duration=je.duration,Oe.manifestInfo=Ut(je.mpd),Oe.isLast=je.mpd.manifest.Period_asArray.length===1||Math.abs(Oe.start+Oe.duration-Oe.manifestInfo.duration)<ze,Oe}function Ut(je){var Oe=new S.default;return Oe.dvrWindowSize=je.timeShiftBufferDepth,Oe.loadedTime=je.manifest.loadedTime,Oe.availableFrom=je.availabilityStartTime,Oe.minBufferTime=je.manifest.minBufferTime,Oe.maxFragmentDuration=je.maxSegmentDuration,Oe.duration=x.getDuration(je.manifest),Oe.isDynamic=x.getIsDynamic(je.manifest),Oe.serviceDescriptions=x.getServiceDescriptions(je.manifest),Oe.protocol=je.manifest.protocol,Oe}function Vt(){if(!U)throw new Error("setConfig function has to be called previously")}function Zt(je){return M.length>0?M[0].mpd.manifest.Period_asArray[je]:null}function We(je,Oe){var ze=In(je,Oe,!0);return ze!==null?ze:-1}function In(je,Oe,ze){var ct,dt,bt,Ft,Dt,Kt;if(je){for(dt=je.AdaptationSet_asArray,Dt=0;Dt<dt.length;Dt=Dt+1)for(ct=dt[Dt],Ft=ct.Representation_asArray,Kt=0;Kt<Ft.length;Kt=Kt+1)if(bt=Ft[Kt],Oe===bt.id)return ze?Kt:bt}return null}function Ct(je,Oe){var ze,ct,dt,bt;if(!je||!Oe)return-1;for(ct=je.AdaptationSet_asArray,bt=0;bt<ct.length;bt=bt+1)if(ze=ct[bt],dt=ze.Representation_asArray,x.getIsTypeOf(ze,Oe))return dt.length;return-1}return D={getBandwidthForRepresentation:we,getIndexForRepresentation:$e,getMaxIndexForBufferType:it,convertRepresentationToRepresentationInfo:J,getStreamsInfo:Z,getMediaInfoForType:ee,getAllMediaInfoForType:ve,getAdaptationForType:ie,getRealAdaptation:Ee,getProducerReferenceTimes:Se,getRealPeriodByIndex:de,getEssentialPropertiesForRepresentation:Me,getVoRepresentations:xe,getEventsFor:Le,getEvent:Fe,getMpd:$,setConfig:Y,updatePeriods:_e,getIsTextTrack:Ae,getUTCTimingSources:ge,getSuggestedPresentationDelay:pe,getAvailabilityStartTime:Re,getIsTypeOf:pt,getIsDynamic:me,getDuration:V,getRegularPeriods:j,getContentSteering:re,getLocation:oe,getPatchLocation:ne,getManifestUpdatePeriod:X,getPublishTime:z,getIsDVB:fe,getIsPatch:Ce,getBaseURLsFromElement:Pe,getRepresentationSortFunction:he,getCodec:Ue,getPeriodById:mt,setCurrentMediaInfo:De,isPatchValid:lt,applyPatchToManifest:Ye,areMediaInfosEqual:Q,reset:Pt},W(),D}O.__dashjs_factory_name="DashAdapter";const L=T.default.getSingletonFactory(O)},"./src/dash/DashHandler.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>b});var m=d("./src/streaming/vo/FragmentRequest.js"),g=d("./src/streaming/vo/metrics/HTTPRequest.js"),v=d("./src/core/FactoryMaker.js"),_=d("./src/streaming/MediaPlayerEvents.js"),S=d("./src/dash/utils/SegmentsUtils.js"),E=d("./src/dash/constants/DashConstants.js"),T=.5,C=.001;function R(F){F=F||{};var O=F.eventBus,L=F.debug,D=F.urlUtils,x=F.type,B=F.streamInfo,M=F.segmentsController,I=F.timelineConverter,U=F.baseURLController,w,k,K,W,Y;function J(){k=L.getLogger(w),se(),O.on(_.default.DYNAMIC_TO_STATIC,Ae,w)}function ee(ge){W=ge,Y=!1,M.initialize(ge)}function ue(){return B.id}function ie(){return x}function Q(){return B}function se(){K=null}function ve(){se(),O.off(_.default.DYNAMIC_TO_STATIC,Ae,w)}function _e(ge,pe,Re){var me=U.resolve(Re.path),V,j;return!me||pe===me.url||!D.isRelative(pe)?V=pe:(V=me.url,j=me.serviceLocation,pe&&(V=D.resolve(pe,V))),D.isRelative(V)?!1:(ge.url=V,ge.serviceLocation=j,!0)}function Z(ge,pe){return pe?Ee(ge,pe,ie()):null}function Ee(ge,pe,Re){var me=new m.default,V=pe.adaptation.period,j=V.start;if(me.mediaType=Re,me.type=g.HTTPRequest.INIT_SEGMENT_TYPE,me.range=pe.range,me.availabilityStartTime=I.calcAvailabilityStartTimeFromPresentationTime(j,pe,W),me.availabilityEndTime=I.calcAvailabilityEndTimeFromPresentationTime(j+V.duration,pe,W),me.quality=pe.index,me.mediaInfo=ge,me.representationId=pe.id,_e(me,pe.initialization,pe))return me.url=(0,S.replaceTokenForTemplate)(me.url,"Bandwidth",pe.bandwidth),me}function Se(ge,pe){if(pe==null)return null;var Re=new m.default,me=pe.representation,V=me.adaptation.period.mpd.manifest.Period_asArray[me.adaptation.period.index].AdaptationSet_asArray[me.adaptation.index].Representation_asArray[me.index].bandwidth,j=pe.media;if(j=(0,S.replaceTokenForTemplate)(j,"Number",pe.replacementNumber),j=(0,S.replaceTokenForTemplate)(j,"Time",pe.replacementTime),j=(0,S.replaceTokenForTemplate)(j,"Bandwidth",V),j=(0,S.replaceIDForTemplate)(j,me.id),j=(0,S.unescapeDollarsInTemplate)(j),Re.mediaType=ie(),Re.type=g.HTTPRequest.MEDIA_SEGMENT_TYPE,Re.range=pe.mediaRange,Re.startTime=pe.presentationStartTime,Re.mediaStartTime=pe.mediaStartTime,Re.duration=pe.duration,Re.timescale=me.timescale,Re.availabilityStartTime=pe.availabilityStartTime,Re.availabilityEndTime=pe.availabilityEndTime,Re.availabilityTimeComplete=me.availabilityTimeComplete,Re.wallStartTime=pe.wallStartTime,Re.quality=me.index,Re.index=pe.index,Re.mediaInfo=ge,Re.adaptationIndex=me.adaptation.index,Re.representationId=me.id,_e(Re,j,me))return Re}function Me(ge,pe){if(!ge||!K)return!1;if(Y)return!0;if(!isFinite(ge.adaptation.period.duration)||K.presentationStartTime+K.duration>pe)return!1;if(ge.mediaFinishedInformation&&!isNaN(ge.mediaFinishedInformation.numberOfSegments)&&!isNaN(K.index)&&K.index>=ge.mediaFinishedInformation.numberOfSegments-1){if(!W||ge.segmentInfoType===E.default.SEGMENT_TEMPLATE)return!0;if(W&&ge.segmentInfoType===E.default.SEGMENT_LIST&&ge.adaptation.period.nextPeriodId)return!0}return!!(W&&ge.adaptation.period.nextPeriodId&&ge.segmentInfoType===E.default.SEGMENT_TIMELINE&&ge.mediaFinishedInformation&&!isNaN(ge.mediaFinishedInformation.mediaTimeOfLastSignaledSegment)&&K&&!isNaN(K.mediaStartTime)&&!isNaN(K.duration)&&K.mediaStartTime+K.duration>=ge.mediaFinishedInformation.mediaTimeOfLastSignaledSegment-.05)}function de(ge,pe,Re){var me=null;if(!pe||!pe.segmentInfoType)return me;var V=M.getSegmentByTime(pe,Re);return V&&(K=V,k.debug("Index for time "+Re+" is "+V.index),me=Se(ge,V)),me}function xe(ge,pe){var Re=null,me=K?K.index+1:0,V=M.getSegmentByIndex(pe,me,K?K.mediaStartTime:-1);return V?(Re=Se(ge,V),Re):null}function Fe(ge,pe){var Re=null;if(!pe||!pe.segmentInfoType)return null;var me=K?K.index+1:0,V=M.getSegmentByIndex(pe,me,K?K.mediaStartTime:-1);if(V)Re=Se(ge,V),K=V;else{if(W&&!Y)return k.debug(ie()+" No segment found at index: "+me+". Wait for next loop"),null;Y=!0}return Re}function Le(ge,pe,Re,me){try{if(isNaN(ge)||!pe||!Re)return NaN;if(ge<0&&(ge=0),isNaN(me)&&(me=T),de(pe,Re,ge))return ge;if(Re.adaptation.period.start+Re.adaptation.period.duration<ge)return NaN;for(var V=isFinite(Re.adaptation.period.duration)?Re.adaptation.period.start+Re.adaptation.period.duration:ge+30,j=Math.min(ge+me,V),$=NaN,re=null;j<=V;){var oe=null;if(j<=V&&(oe=de(pe,Re,j)),oe){$=j,re=oe;break}j+=me}if(re){var X=re.startTime+re.duration;return ge>re.startTime&&X-ge>me?ge:!isNaN(re.startTime)&&ge<re.startTime&&$>re.startTime?re.startTime+C:Math.min(X-me,$)}return $}catch{return NaN}}function De(){return K?K.index:-1}function Ae(){k.debug("Dynamic stream complete"),Y=!0}return w={initialize:ee,getStreamId:ue,getType:ie,getStreamInfo:Q,getInitRequest:Z,getSegmentRequestForTime:de,getCurrentIndex:De,getNextSegmentRequest:Fe,isLastSegmentRequested:Me,reset:ve,getNextSegmentRequestIdempotent:xe,getValidTimeAheadOfTargetTime:Le},J(),w}R.__dashjs_factory_name="DashHandler";const b=v.default.getClassFactory(R)},"./src/dash/DashMetrics.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>b});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/streaming/vo/metrics/HTTPRequest.js"),v=d("./src/core/FactoryMaker.js"),_=d("./src/streaming/constants/MetricsConstants.js"),S=d("./src/dash/utils/Round10.js"),E=d("./src/streaming/models/MetricsModel.js"),T=d("./src/core/Utils.js"),C=d("./src/streaming/vo/metrics/PlayList.js");function R(F){F=F||{};var O=this.context,L,D,x,B,M=F.metricsModel;function I(){M=M||(0,E.default)(O).getInstance({settings:F.settings}),U()}function U(){D=!0,x=null,B=null}function w(oe){var X=M.getMetricsFor(oe,!0);return se(X,_.default.TRACK_SWITCH)}function k(oe,X,z,ne,fe){M.addRepresentationSwitch(oe,X,z,ne,fe)}function K(oe){var X=M.getMetricsFor(oe,!0);return se(X,_.default.BUFFER_STATE)}function W(oe){var X=M.getMetricsFor(oe,!0),z=se(X,_.default.BUFFER_LEVEL);return z?S.default.round10(z.level/1e3,-3):0}function Y(oe,X,z){M.addBufferLevel(oe,X,z)}function J(oe,X,z){M.addBufferState(oe,X,z)}function ee(){M.clearAllCurrentMetrics()}function ue(oe){var X=M.getMetricsFor(oe,!0);if(!X)return null;var z=X.HttpList,ne=null,fe;if(!z||z.length<=0)return null;for(fe=z.length-1;fe>=0;){if(z[fe].responsecode){ne=z[fe];break}fe--}return ne}function ie(oe){var X=M.getMetricsFor(oe,!0);return X?X.HttpList?X.HttpList:[]:[]}function Q(oe,X,z){M.addRequestsQueue(oe,X,z)}function se(oe,X){if(!oe)return null;var z=oe[X];return!z||z.length===0?null:z[z.length-1]}function ve(){var oe=M.getMetricsFor(m.default.VIDEO,!0);return se(oe,_.default.DROPPED_FRAMES)}function _e(oe){M.addDroppedFrames(m.default.VIDEO,oe)}function Z(oe){var X=M.getMetricsFor(oe,!0);return se(X,_.default.SCHEDULING_INFO)}function Ee(oe,X){M.addSchedulingInfo(oe.mediaType,new Date,oe.type,oe.startTime,oe.availabilityStartTime,oe.duration,oe.quality,oe.range,X)}function Se(){var oe=M.getMetricsFor(m.default.STREAM);return se(oe,_.default.MANIFEST_UPDATE)}function Me(oe){var X=this.getCurrentManifestUpdate();M.updateManifestUpdateInfo(X,oe)}function de(oe){if(oe){var X=this.getCurrentManifestUpdate();M.addManifestUpdateStreamInfo(X,oe.id,oe.index,oe.start,oe.duration)}}function xe(oe){M.addManifestUpdate(m.default.STREAM,oe.type,oe.requestStartDate,oe.requestEndDate)}function Fe(oe,X,z,ne,fe,Ce){M.addHttpRequest(oe.mediaType,null,oe.type,oe.url,oe.quality,X,oe.serviceLocation||null,oe.range||null,oe.requestStartDate,oe.firstByteDate,oe.requestEndDate,z,oe.duration,ne,fe,oe.fileLoaderType,Ce)}function Le(oe,X){if(oe){var z=this.getCurrentManifestUpdate();M.addManifestUpdateRepresentationInfo(z,oe.id,oe.index,oe.streamIndex,X,oe.presentationTimeOffset,oe.startNumber,oe.fragmentInfoType)}}function De(oe){var X=oe?M.getMetricsFor(oe,!0):M.getMetricsFor(m.default.VIDEO,!0)||M.getMetricsFor(m.default.AUDIO,!0);return se(X,_.default.DVR_INFO)}function Ae(oe,X,z,ne){M.addDVRInfo(oe,X,z,ne)}function ge(oe){if(!oe)return null;var X={},z,ne,fe;for(z=ie(m.default.STREAM),fe=z.length-1;fe>=0;fe--)if(ne=z[fe],ne.type===g.HTTPRequest.MPD_TYPE){X=T.default.parseHttpHeaders(ne._responseHeaders);break}var Ce=X[oe.toLowerCase()];return Ce===void 0?null:Ce}function pe(oe,X){if(!X)return null;var z={},ne=ue(oe);ne&&(z=T.default.parseHttpHeaders(ne._responseHeaders));var fe=z[X.toLowerCase()];return fe===void 0?null:fe}function Re(){B&&(M.addPlayList(B),B=null)}function me(oe,X){B=new C.PlayList,B.start=new Date,B.mstart=oe,B.starttype=X}function V(oe,X,z){D===!0&&(D=!1,x=new C.PlayListTrace,x.representationid=oe,x.start=new Date,x.mstart=X,x.playbackspeed=z!==null?z.toString():null)}function j(oe){if(x)for(var X in x)x[X]=oe[X]}function $(oe,X){if(D===!1&&B&&x&&x.start){var z=x.start,ne=oe.getTime()-z.getTime();x.duration=ne,x.stopreason=X,B.trace.push(x),D=!0}}function re(oe){M.addDVBErrors(oe)}return L={getCurrentRepresentationSwitch:w,getCurrentBufferState:K,getCurrentBufferLevel:W,getCurrentHttpRequest:ue,getHttpRequests:ie,getCurrentDroppedFrames:ve,getCurrentSchedulingInfo:Z,getCurrentDVRInfo:De,getCurrentManifestUpdate:Se,getLatestFragmentRequestHeaderValueByID:pe,getLatestMPDRequestHeaderValueByID:ge,addRepresentationSwitch:k,addDVRInfo:Ae,updateManifestUpdateInfo:Me,addManifestUpdateStreamInfo:de,addManifestUpdateRepresentationInfo:Le,addManifestUpdate:xe,addHttpRequest:Fe,addSchedulingInfo:Ee,addRequestsQueue:Q,addBufferLevel:Y,addBufferState:J,addDroppedFrames:_e,addPlayList:Re,addDVBErrors:re,createPlaylistMetrics:me,createPlaylistTraceMetrics:V,updatePlayListTraceMetrics:j,pushPlayListTraceMetrics:$,clearAllCurrentMetrics:ee},I(),L}R.__dashjs_factory_name="DashMetrics";const b=v.default.getSingletonFactory(R)},"./src/dash/SegmentBaseLoader.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>T});var m=d("./src/dash/vo/Segment.js"),g=d("./src/streaming/vo/DashJSError.js"),v=d("./src/core/FactoryMaker.js"),_=d("./src/streaming/vo/FragmentRequest.js"),S=d("./src/streaming/net/URLLoader.js");function E(){var C=this.context,R,b,F,O,L,D,x,B,M,I,U,w,k;function K(){B=(0,S.default)(C).create({errHandler:F,dashMetrics:D,mediaPlayerModel:x,requestModifier:L,boxParser:O,errors:M,urlUtils:w,constants:I,dashConstants:U})}function W(_e){_e.baseURLController&&(k=_e.baseURLController),_e.dashMetrics&&(D=_e.dashMetrics),_e.mediaPlayerModel&&(x=_e.mediaPlayerModel),_e.errHandler&&(F=_e.errHandler),_e.boxParser&&(O=_e.boxParser),_e.debug&&(b=_e.debug.getLogger(R)),_e.requestModifier&&(L=_e.requestModifier),_e.errors&&(M=_e.errors),_e.urlUtils&&(w=_e.urlUtils),_e.constants&&(I=_e.constants),_e.dashConstants&&(U=_e.dashConstants)}function Y(_e,Z){return new Promise(function(Ee){J(_e,Z,Ee)})}function J(_e,Z,Ee,Se){var Me=null,de=_e?k.resolve(_e.path):null,xe=Se||{init:!0,url:de?de.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:Z};b.debug("Start searching for initialization.");var Fe=ve(xe),Le=function(ge){if(xe.bytesLoaded=xe.range.end,Me=O.findInitRange(ge),Me)_e.range=Me,Ee(_e);else return xe.range.end=xe.bytesLoaded+xe.bytesToLoad,J(_e,Z,Ee,xe)},De=function(){Ee(_e)};B.load({request:Fe,success:Le,error:De}),b.debug("Perform init search: "+xe.url)}function ee(_e,Z,Ee){return new Promise(function(Se){ue(_e,Z,Ee,Se)})}function ue(_e,Z,Ee,Se,Me,de){if(Ee&&(Ee.start===void 0||Ee.end===void 0)){var xe=Ee?Ee.toString().split("-"):null;Ee=xe?{start:parseFloat(xe[0]),end:parseFloat(xe[1])}:null}Me=Me||ie;var Fe=null,Le=null,De=!!Ee,Ae=_e?k.resolve(_e.path):null,ge={init:!1,url:Ae?Ae.url:void 0,range:De?Ee:{start:0,end:1500},searching:!De,bytesLoaded:de?de.bytesLoaded:0,bytesToLoad:1500,mediaType:Z},pe=ve(ge),Re=function(j){var $=ge.bytesToLoad,re=j.byteLength;if(ge.bytesLoaded=ge.range.end-ge.range.start,Fe=O.parse(j),Le=Fe.getBox("sidx"),!Le||!Le.isComplete){if(Le)ge.range.start=Le.offset||ge.range.start,ge.range.end=ge.range.start+(Le.size||$);else if(re<ge.bytesLoaded){Me(null,_e,Se);return}else{var oe=Fe.getLastBox();oe&&oe.size?(ge.range.start=oe.offset+oe.size,ge.range.end=ge.range.start+$):ge.range.end+=$}ue(_e,Z,ge.range,Se,null,ge)}else{var X=Le.references,z,ne;if(X!=null&&X.length>0&&(z=X[0].reference_type===1),z){b.debug("Initiate multiple SIDX load."),ge.range.end=ge.range.start+Le.size;var fe,Ce,Pe,he,Ue,we=[],$e=0,it=(Le.offset||ge.range.start)+Le.size,mt=function(Pt){Pt?(we=we.concat(Pt),$e++,$e>=Ce&&(we.sort(function(lt,Ye){return lt.startTime-Ye.startTime<0?-1:0}),Me(we,_e,Se))):Me(null,_e,Se)};for(fe=0,Ce=X.length;fe<Ce;fe++)Pe=it,he=it+X[fe].referenced_size-1,it=it+X[fe].referenced_size,Ue={start:Pe,end:he},ue(_e,Z,Ue,Se,mt,ge)}else b.debug("Parsing segments from SIDX. representation "+Z+" - id: "+_e.id+" for range : "+ge.range.start+" - "+ge.range.end),ne=se(Le,ge),Me(ne,_e,Se)}},me=function(){Me(null,_e,Se)};B.load({request:pe,success:Re,error:me}),b.debug("Perform SIDX load for type ".concat(Z," : ").concat(ge.url," with range ").concat(ge.range.start," - ").concat(ge.range.end))}function ie(_e,Z,Ee){Ee({segments:_e,representation:Z,error:_e?void 0:new g.default(M.SEGMENT_BASE_LOADER_ERROR_CODE,M.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function Q(){B&&(B.abort(),B=null)}function se(_e,Z){for(var Ee=_e.references,Se=Ee.length,Me=_e.timescale,de=_e.earliest_presentation_time,xe=Z.range.start+_e.offset+_e.first_offset+_e.size,Fe=[],Le,De,Ae,ge,pe=0;pe<Se;pe++)Ae=Ee[pe].subsegment_duration,ge=Ee[pe].referenced_size,Le=new m.default,Le.duration=Ae,Le.startTime=de,Le.timescale=Me,De=xe+ge-1,Le.mediaRange=xe+"-"+De,Fe.push(Le),de+=Ae,xe+=ge;return Fe}function ve(_e){if(_e.url){var Z=new _.default;return Z.setInfo(_e),Z}}return R={setConfig:W,initialize:K,loadInitialization:Y,loadSegments:ee,reset:Q},R}E.__dashjs_factory_name="SegmentBaseLoader";const T=v.default.getSingletonFactory(E)},"./src/dash/WebmSegmentBaseLoader.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>R});var m=d("./src/streaming/utils/EBMLParser.js"),g=d("./src/streaming/constants/Constants.js"),v=d("./src/core/FactoryMaker.js"),_=d("./src/dash/vo/Segment.js"),S=d("./src/streaming/vo/FragmentRequest.js"),E=d("./src/streaming/net/URLLoader.js"),T=d("./src/streaming/vo/DashJSError.js");function C(){var b=this.context,F,O,L,D,x,B,M,I,U,w;function k(){L={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}}}function K(){I=(0,E.default)(b).create({errHandler:D,dashMetrics:B,mediaPlayerModel:M,requestModifier:x,errors:U})}function W(ve){if(!ve.baseURLController||!ve.dashMetrics||!ve.mediaPlayerModel||!ve.errHandler)throw new Error(g.default.MISSING_CONFIG_ERROR);w=ve.baseURLController,B=ve.dashMetrics,M=ve.mediaPlayerModel,D=ve.errHandler,U=ve.errors,O=ve.debug.getLogger(F),x=ve.requestModifier}function Y(ve){var _e=[],Z=(0,m.default)(b).create({data:ve}),Ee,Se;for(Z.consumeTagAndSize(L.Segment.Cues);Z.moreData()&&Z.consumeTagAndSize(L.Segment.Cues.CuePoint,!0);){for(Ee={},Ee.CueTime=Z.parseTag(L.Segment.Cues.CuePoint.CueTime),Ee.CueTracks=[];Z.moreData()&&Z.consumeTag(L.Segment.Cues.CuePoint.CueTrackPositions,!0);){var Me=Z.getMatroskaCodedNum(),de=Z.getPos();if(Se={},Se.Track=Z.parseTag(L.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),Se.Track===0)throw new Error("Cue track cannot be 0");Se.ClusterPosition=Z.parseTag(L.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),Ee.CueTracks.push(Se),Z.setPos(de+Me)}if(Ee.CueTracks.length===0)throw new Error("Mandatory cuetrack not found");_e.push(Ee)}if(_e.length===0)throw new Error("mandatory cuepoint not found");return _e}function J(ve,_e,Z,Ee){var Se,Me,de,xe,Fe,Le,De,Ae;for(Me=Y(ve),de=[],Fe=0,Le=Me.length;Fe<Le;Fe+=1)xe=new _.default,Se=0,Fe<Me.length-1?Se=Me[Fe+1].CueTime-Me[Fe].CueTime:Se=Ee-Me[Fe].CueTime,xe.duration=Se,xe.startTime=Me[Fe].CueTime,xe.timescale=1e3,De=Me[Fe].CueTracks[0].ClusterPosition+_e,Fe<Me.length-1?Ae=Me[Fe+1].CueTracks[0].ClusterPosition+_e-1:Ae=Z-1,xe.mediaRange=De+"-"+Ae,de.push(xe);return O.debug("Parsed cues: "+de.length+" cues."),de}function ee(ve,_e,Z,Ee){if(!ve||ve.byteLength===0){Ee(null);return}var Se=(0,m.default)(b).create({data:ve}),Me,de,xe,Fe,Le=Z?Z.split("-"):null,De=null,Ae={url:_e,range:{start:Le?parseFloat(Le[0]):null,end:Le?parseFloat(Le[1]):null},request:De};for(O.debug("Parse EBML header: "+Ae.url),Se.skipOverElement(L.EBML),Se.consumeTag(L.Segment),xe=Se.getMatroskaCodedNum(),xe+=Se.getPos(),Fe=Se.getPos();Se.moreData()&&!Se.consumeTagAndSize(L.Segment.Info,!0);)if(!(Se.skipOverElement(L.Segment.SeekHead,!0)||Se.skipOverElement(L.Segment.Tracks,!0)||Se.skipOverElement(L.Segment.Cues,!0)||Se.skipOverElement(L.Void,!0)))throw new Error("no valid top level element found");for(;Me===void 0;){var ge=Se.getMatroskaCodedNum(!0),pe=Se.getMatroskaCodedNum();switch(ge){case L.Segment.Info.Duration.tag:Me=Se[L.Segment.Info.Duration.parse](pe);break;default:Se.setPos(Se.getPos()+pe);break}}De=Q(Ae);var Re=function(j){de=J(j,Fe,xe,Me),Ee(de)},me=function(){O.error("Download Error: Cues "+Ae.url),Ee(null)};I.load({request:De,success:Re,error:me}),O.debug("Perform cues load: "+Ae.url+" bytes="+Ae.range.start+"-"+Ae.range.end)}function ue(ve,_e){return new Promise(function(Z){var Ee=null,Se=ve?w.resolve(ve.path):null,Me=ve?ve.range.split("-"):null,de={range:{start:Me?parseFloat(Me[0]):null,end:Me?parseFloat(Me[1]):null},request:Ee,url:Se?Se.url:void 0,init:!0,mediaType:_e};O.info("Start loading initialization."),Ee=Q(de);var xe=function(){Z(ve)},Fe=function(){Z(ve)};I.load({request:Ee,success:xe,error:Fe}),O.debug("Perform init load: "+de.url)})}function ie(ve,_e,Z){return new Promise(function(Ee){var Se=null,Me=ve?w.resolve(ve.path):null,de=Me?Me.url:void 0,xe=8192,Fe={bytesLoaded:0,bytesToLoad:xe,range:{start:0,end:xe},request:Se,url:de,init:!1,mediaType:_e};Se=Q(Fe),O.debug("Parsing ebml header");var Le=function(ge){ee(ge,de,Z,function(pe){Ee({segments:pe,representation:ve,error:pe?void 0:new T.default(U.SEGMENT_BASE_LOADER_ERROR_CODE,U.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})})},De=function(){Ee({representation:ve,error:new T.default(U.SEGMENT_BASE_LOADER_ERROR_CODE,U.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})};I.load({request:Se,success:Le,error:De})})}function Q(ve){var _e=new S.default;return _e.setInfo(ve),_e}function se(){I&&(I.abort(),I=null)}return F={setConfig:W,initialize:K,loadInitialization:ue,loadSegments:ie,reset:se},k(),F}C.__dashjs_factory_name="WebmSegmentBaseLoader";const R=v.default.getSingletonFactory(C)},"./src/dash/constants/DashConstants.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});function m(T,C){if(!(T instanceof C))throw new TypeError("Cannot call a class as a function")}function g(T,C){for(var R=0;R<C.length;R++){var b=C[R];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(T,b.key,b)}}function v(T,C,R){return C&&g(T.prototype,C),R&&g(T,R),T}var _=function(){function T(){m(this,T),this.init()}return v(T,[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.INBAND_EVENT_STREAM="InbandEventStream",this.PRODUCER_REFERENCE_TIME="ProducerReferenceTime",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.ROLE_ASARRAY="Role_asArray",this.REPRESENTATION_ASARRAY="Representation_asArray",this.PRODUCERREFERENCETIME_ASARRAY="ProducerReferenceTime_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate",this.SERVICE_DESCRIPTION_OPERATING_QUALITY="OperatingQuality",this.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH="OperatingBandwidth",this.PATCH_LOCATION="PatchLocation",this.PUBLISH_TIME="publishTime",this.ORIGINAL_PUBLISH_TIME="originalPublishTime",this.ORIGINAL_MPD_ID="mpdId",this.WALL_CLOCK_TIME="wallClockTime",this.PRESENTATION_TIME="presentationTime",this.LABEL="Label",this.GROUP_LABEL="GroupLabel",this.CONTENT_STEERING="ContentSteering",this.CONTENT_STEERING_AS_ARRAY="ContentSteering_asArray",this.DEFAULT_SERVICE_LOCATION="defaultServiceLocation",this.QUERY_BEFORE_START="queryBeforeStart",this.PROXY_SERVER_URL="proxyServerURL",this.CONTENT_STEERING_RESPONSE={VERSION:"VERSION",TTL:"TTL",RELOAD_URI:"RELOAD-URI",SERVICE_LOCATION_PRIORITY:"SERVICE-LOCATION-PRIORITY"}}}]),T}(),S=new _;const E=S},"./src/dash/controllers/ContentSteeringController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>x});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/Debug.js"),v=d("./src/streaming/net/URLLoader.js"),_=d("./src/core/errors/Errors.js"),S=d("./src/dash/vo/ContentSteeringRequest.js"),E=d("./src/dash/vo/ContentSteeringResponse.js"),T=d("./src/dash/constants/DashConstants.js"),C=d("./src/streaming/MediaPlayerEvents.js"),R=d("./src/core/events/Events.js"),b=d("./src/streaming/constants/Constants.js"),F=d("./src/core/Utils.js"),O=d("./src/streaming/utils/URLUtils.js"),L={THROUGHPUT:"_DASH_throughput",PATHWAY:"_DASH_pathway",URL:"url"};function D(){var B=this.context,M=(0,O.default)(B).getInstance(),I,U,w,k,K,W,Y,J,ee,ue,ie,Q,se,ve,_e;function Z(){U=(0,g.default)(B).getInstance().getLogger(I),j()}function Ee($){$&&($.adapter&&(_e=$.adapter),$.errHandler&&(J=$.errHandler),$.dashMetrics&&(ee=$.dashMetrics),$.mediaPlayerModel&&(ue=$.mediaPlayerModel),$.requestModifier&&(Q=$.requestModifier),$.manifestModel&&(ie=$.manifestModel),$.abrController&&(se=$.abrController),$.eventBus&&(ve=$.eventBus))}function Se(){Y=(0,v.default)(B).create({errHandler:J,dashMetrics:ee,mediaPlayerModel:ue,requestModifier:Q,errors:_.default}),ve.on(C.default.PERIOD_SWITCH_COMPLETED,Me,I),ve.on(R.default.FRAGMENT_LOADING_STARTED,de,I)}function Me($){$&&$.toStreamInfo&&(k=$.toStreamInfo)}function de($){$&&$.request&&$.request.serviceLocation&&(K=$.request.serviceLocation)}function xe(){var $=ie.getValue();return _e.getContentSteering($)}function Fe(){var $=xe();return $&&$.queryBeforeStart}function Le(){return new Promise(function($){try{var re=xe();if(!re||!re.serverUrl){$();return}var oe=De(re),X=new S.default(oe);Y.load({request:X,success:function(ne){Ae(ne),ve.trigger(C.default.CONTENT_STEERING_REQUEST_COMPLETED,{currentSteeringResponseData:w,url:oe}),$()},error:function(ne){Re(ne),$(ne)}})}catch(z){$(z)}})}function De($){var re=$.proxyServerUrl?$.proxyServerUrl:$.serverUrl;w&&w.reloadUri&&(M.isRelative(w.reloadUri)?re=M.resolve(w.reloadUri,$.serverUrl):re=w.reloadUri);var oe=[];if(k){var X=_e.getIsDynamic(),z=_e.getAllMediaInfoForType(k,b.default.VIDEO).length>0?b.default.VIDEO:b.default.AUDIO,ne=se.getThroughputHistory(),fe=ne?ne.getAverageThroughput(z,X):NaN;isNaN(fe)||oe.push({key:L.THROUGHPUT,value:fe*1e3})}return K&&oe.push({key:L.PATHWAY,value:K}),$.proxyServerUrl&&$.proxyServerUrl===re&&$.serverUrl&&oe.push({key:L.URL,value:encodeURI($.serverUrl)}),re=F.default.addAditionalQueryParameterToUrl(re,oe),re}function Ae($){!$||!$[T.default.CONTENT_STEERING_RESPONSE.VERSION]||parseInt($[T.default.CONTENT_STEERING_RESPONSE.VERSION])!==1||(w=new E.default,w.version=$[T.default.CONTENT_STEERING_RESPONSE.VERSION],$[T.default.CONTENT_STEERING_RESPONSE.TTL]&&!isNaN($[T.default.CONTENT_STEERING_RESPONSE.TTL])&&(w.ttl=$[T.default.CONTENT_STEERING_RESPONSE.TTL]),$[T.default.CONTENT_STEERING_RESPONSE.RELOAD_URI]&&(w.reloadUri=$[T.default.CONTENT_STEERING_RESPONSE.RELOAD_URI]),$[T.default.CONTENT_STEERING_RESPONSE.SERVICE_LOCATION_PRIORITY]&&(w.serviceLocationPriority=$[T.default.CONTENT_STEERING_RESPONSE.SERVICE_LOCATION_PRIORITY]),ge())}function ge(){w&&w.ttl&&!isNaN(w.ttl)&&(W&&clearTimeout(W),W=setTimeout(function(){Le()},w.ttl*1e3))}function pe(){W&&clearTimeout(W),W=null}function Re($){U.warn("Error fetching data from content steering server",$),ge()}function me(){return w}function V(){j(),ve.off(C.default.PERIOD_SWITCH_COMPLETED,Me,I),ve.off(R.default.FRAGMENT_LOADING_STARTED,de,I)}function j(){w=null,k=null,K=null,pe()}return I={reset:V,setConfig:Ee,loadSteeringData:Le,getCurrentSteeringResponseData:me,shouldQueryBeforeStart:Fe,getSteeringDataFromManifest:xe,stopSteeringRequestTimer:pe,initialize:Se},Z(),I}D.__dashjs_factory_name="ContentSteeringController";const x=m.default.getSingletonFactory(D)},"./src/dash/controllers/RepresentationController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/core/FactoryMaker.js"),v=d("./src/streaming/MediaPlayerEvents.js"),_=d("./src/dash/utils/SegmentsUtils.js");function S(T){T=T||{};var C=T.eventBus,R=T.events,b=T.abrController,F=T.dashMetrics,O=T.playbackController,L=T.timelineConverter,D=T.type,x=T.streamInfo,B=T.dashConstants,M=T.segmentsController,I=T.isDynamic,U,w,k,K,W;function Y(){ve(),C.on(v.default.MANIFEST_VALIDITY_CHANGED,me,U)}function J(){return x.id}function ee(){return D}function ue(){if(!b||!F||!O||!L)throw new Error(m.default.MISSING_CONFIG_ERROR)}function ie(){return w}function Q(){return k}function se(){return W}function ve(){w=null,k=!0,K=[]}function _e(){C.off(v.default.MANIFEST_VALIDITY_CHANGED,me,U),ve()}function Z(V,j,$,re,oe){ue(),k=!0,K=j;var X=Fe(oe);if(Re(X),w=V,$!==m.default.VIDEO&&$!==m.default.AUDIO&&($!==m.default.TEXT||!re))return Ae(),Promise.resolve();for(var z=[],ne=0,fe=K.length;ne<fe;ne++){var Ce=K[ne];z.push(Ee(Ce))}return Promise.all(z)}function Ee(V){return new Promise(function(j,$){var re=V.hasInitialization(),oe=V.hasSegments(),X=[];X.push(M.updateInitData(V,re)),X.push(M.updateSegmentData(V,oe)),Promise.all(X).then(function(z){z[0]&&!z[0].error&&(V=Me(V,z[0])),z[1]&&!z[1].error&&(V=de(V,z[1])),Se(V),ge(V),j()}).catch(function(z){$(z)})})}function Se(V){V.mediaFinishedInformation=M.getMediaFinishedInformation(V)}function Me(V,j){return!j||j.error||!j.representation?V:j.representation}function de(V,j){if(!(!j||j.error)){var $=j.segments,re=[],oe=0,X,z,ne,fe;for(X=0,z=$?$.length:0;X<z;X++)ne=$[X],fe=(0,_.getTimeBasedSegment)(L,I,V,ne.startTime,ne.duration,ne.timescale,ne.media,ne.mediaRange,oe),fe&&(re.push(fe),fe=null,oe++);return re.length>0&&(V.segments=re),V}}function xe(){ue();var V=new Date,j=se(),$=O.getTime()*1e3;j&&F.addRepresentationSwitch(j.adaptation.type,V,$,j.id),C.trigger(v.default.REPRESENTATION_SWITCH,{mediaType:D,streamId:x.id,currentRepresentation:j,numberOfRepresentations:K.length},{streamId:x.id,mediaType:D})}function Fe(V){return V==null||V>=K.length?null:K[V]}function Le(V){return K.indexOf(V)}function De(){for(var V=0,j=K.length;V<j;V++){var $=K[V].segmentInfoType;if(!K[V].hasInitialization()||($===B.SEGMENT_BASE||$===B.BASE_URL)&&!K[V].segments)return!1}return!0}function Ae(V){k=!1,C.trigger(R.DATA_UPDATE_COMPLETED,{data:w,currentRepresentation:W,error:V},{streamId:x.id,mediaType:D})}function ge(V){if(Q()){var j=F.getCurrentManifestUpdate(),$=!1,re,oe;if(j){for(var X=0;X<j.representationInfo.length;X++)if(re=j.representationInfo[X],re.index===V.index&&re.mediaType===ee()){$=!0;break}$||F.addManifestUpdateRepresentationInfo(V,ee())}if(De()){b.setPlaybackQuality(D,x,Le(W));var z=F.getCurrentDVRInfo(D);z&&F.updateManifestUpdateInfo({latency:z.range.end-O.getTime()}),oe=F.getCurrentRepresentationSwitch(se().adaptation.type),oe||xe(),Ae()}}}function pe(V){var j=Fe(V);Re(j),xe()}function Re(V){W=V}function me(V){if(V.newDuration){var j=se();if(j&&j.adaptation.period){var $=j.adaptation.period;$.duration=V.newDuration}}}return U={getStreamId:J,getType:ee,getData:ie,isUpdating:Q,updateData:Z,getCurrentRepresentation:se,getRepresentationForQuality:Fe,prepareQualityChange:pe,reset:_e},Y(),U}S.__dashjs_factory_name="RepresentationController";const E=g.default.getClassFactory(S)},"./src/dash/controllers/SegmentBaseController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});var m=d("./src/core/FactoryMaker.js"),g=d("./src/dash/SegmentBaseLoader.js"),v=d("./src/dash/WebmSegmentBaseLoader.js");function _(T){T=T||{};var C=this.context,R=T.eventBus,b=T.events,F=T.dashMetrics,O=T.mediaPlayerModel,L=T.errHandler,D=T.baseURLController,x=T.debug,B=T.boxParser,M=T.requestModifier,I=T.errors,U,w,k;function K(){w=(0,g.default)(C).getInstance(),k=(0,v.default)(C).getInstance(),w.setConfig({baseURLController:D,dashMetrics:F,mediaPlayerModel:O,errHandler:L,eventBus:R,events:b,errors:I,debug:x,boxParser:B,requestModifier:M}),k.setConfig({baseURLController:D,dashMetrics:F,mediaPlayerModel:O,errHandler:L,eventBus:R,events:b,errors:I,debug:x,requestModifier:M})}function W(ie){var Q=ie?ie.split("/")[1]:"";return Q.toLowerCase()==="webm"}function Y(){w.initialize(),k.initialize()}function J(ie){return W(ie.representation.mimeType)?k.loadInitialization(ie.representation,ie.mediaType):w.loadInitialization(ie.representation,ie.mediaType)}function ee(ie){return W(ie.mimeType)?k.loadSegments(ie.representation,ie.mediaType,ie.representation?ie.representation.indexRange:null):w.loadSegments(ie.representation,ie.mediaType,ie.representation?ie.representation.indexRange:null)}function ue(){w.reset(),k.reset()}return U={initialize:Y,getSegmentBaseInitSegment:J,getSegmentList:ee,reset:ue},K(),U}_.__dashjs_factory_name="SegmentBaseController";var S=m.default.getSingletonFactory(_);const E=S},"./src/dash/controllers/SegmentsController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>C});var m=d("./src/core/FactoryMaker.js"),g=d("./src/dash/utils/TimelineSegmentsGetter.js"),v=d("./src/dash/utils/TemplateSegmentsGetter.js"),_=d("./src/dash/utils/ListSegmentsGetter.js"),S=d("./src/dash/utils/SegmentBaseGetter.js");function E(R){R=R||{};var b=this.context,F=R.dashConstants,O=R.type,L=R.segmentBaseController,D,x;function B(){x={}}function M(Y){x[F.SEGMENT_TIMELINE]=(0,g.default)(b).create(R,Y),x[F.SEGMENT_TEMPLATE]=(0,v.default)(b).create(R,Y),x[F.SEGMENT_LIST]=(0,_.default)(b).create(R,Y),x[F.SEGMENT_BASE]=(0,S.default)(b).create(R,Y)}function I(Y,J){return J?Promise.resolve():L.getSegmentBaseInitSegment({representation:Y,mediaType:O})}function U(Y,J){return J?Promise.resolve():L.getSegmentList({mimeType:Y.mimeType,representation:Y,mediaType:O})}function w(Y){return Y?Y.segments?x[F.SEGMENT_BASE]:x[Y.segmentInfoType]:null}function k(Y,J,ee){var ue=w(Y);return ue?ue.getSegmentByIndex(Y,J,ee):null}function K(Y,J){var ee=w(Y);return ee?ee.getSegmentByTime(Y,J):null}function W(Y){var J=w(Y);return J?J.getMediaFinishedInformation(Y):{numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN}}return D={initialize:M,updateInitData:I,updateSegmentData:U,getSegmentByIndex:k,getSegmentByTime:K,getMediaFinishedInformation:W},B(),D}E.__dashjs_factory_name="SegmentsController";var T=m.default.getClassFactory(E);const C=T},"./src/dash/controllers/ServiceDescriptionController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>C});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/Debug.js"),v=d("./src/streaming/constants/Constants.js"),_=d("./src/dash/constants/DashConstants.js"),S=[v.default.SERVICE_DESCRIPTION_DVB_LL_SCHEME],E={VIDEO:"video",AUDIO:"audio",ANY:"any",ALL:"all"};function T(){var R=this.context,b,F,O,L,D;function x(){L=(0,g.default)(R).getInstance().getLogger(b),I()}function B(se){se&&se.adapter&&(D=se.adapter)}function M(){I()}function I(){F={liveDelay:NaN,liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN}},minBitrate:{},maxBitrate:{},initialBitrate:{}},O=[]}function U(){return F}function w(se){if(!(!se||!se.serviceDescriptions)){var ve=se.serviceDescriptions.filter(function(Ee){return S.includes(Ee.schemeIdUri)}),_e=se.serviceDescriptions.filter(function(Ee){return Ee.schemeIdUri==null}),Z=ve.length>0?ve[ve.length-1]:_e[_e.length-1];Z&&(Z.latency&&Z.latency.target>0&&k(Z),Z.playbackRate&&Y(Z),Z.operatingQuality,Z.operatingBandwidth&&J(Z))}}function k(se){var ve;if(se.schemeIdUri===v.default.SERVICE_DESCRIPTION_DVB_LL_SCHEME?ve=W(se):ve=K(se),O.length>0){var _e=Q(ve),Z=_e.to,Ee=_e.id;F.liveDelay=ve.liveDelay-Z,F.liveCatchup.maxDrift=ve.maxDrift,L.debug(`
                Found latency properties coming from service description. Applied time offset of `.concat(Z," from ProducerReferenceTime element with id ").concat(Ee,`.
                Live Delay: `).concat(ve.liveDelay-Z,", Live catchup max drift: ").concat(ve.maxDrift,`
            `))}else F.liveDelay=ve.liveDelay,F.liveCatchup.maxDrift=ve.maxDrift,L.debug("Found latency properties coming from service description: Live Delay: ".concat(ve.liveDelay,", Live catchup max drift: ").concat(ve.maxDrift))}function K(se){var ve=se.latency.target/1e3,_e=!isNaN(se.latency.max)&&se.latency.max>se.latency.target?(se.latency.max-se.latency.target+500)/1e3:NaN,Z=se.latency.referenceId||NaN;return{liveDelay:ve,maxDrift:_e,referenceId:Z}}function W(se){var ve=se.latency.target/1e3,_e=!isNaN(se.latency.max)&&se.latency.max>se.latency.target?(se.latency.max-se.latency.target+500)/1e3:NaN,Z=se.latency.referenceId||NaN;return{liveDelay:ve,maxDrift:_e,referenceId:Z}}function Y(se){var ve=se.playbackRate.min?Math.round((se.playbackRate.min-1)*1e3)/1e3:NaN,_e=se.playbackRate.max?Math.round((se.playbackRate.max-1)*1e3)/1e3:NaN;F.liveCatchup.playbackRate.min=ve,F.liveCatchup.playbackRate.max=_e,L.debug("Found latency properties coming from service description: Live catchup min playback rate: ".concat(ve)),L.debug("Found latency properties coming from service description: Live catchup max playback rate: ".concat(_e))}function J(se){if(!(!se||!se.operatingBandwidth||!se.operatingBandwidth.mediaType||se.operatingBandwidth.mediaType===E.ALL)){var ve={};ve.minBandwidth=se.operatingBandwidth.min,ve.maxBandwidth=se.operatingBandwidth.max,ve.targetBandwidth=se.operatingBandwidth.target;var _e=[];se.operatingBandwidth.mediaType===E.VIDEO||se.operatingBandwidth.mediaType===E.AUDIO?_e.push(se.operatingBandwidth.mediaType):se.operatingBandwidth.mediaType===E.ANY&&(_e.push(E.AUDIO),_e.push(E.VIDEO)),_e.forEach(function(Z){isNaN(ve.minBandwidth)||ee("minBitrate",Z,ve.minBandwidth),isNaN(ve.maxBandwidth)||ee("maxBitrate",Z,ve.maxBandwidth),isNaN(ve.targetBandwidth)||ee("initialBitrate",Z,ve.targetBandwidth)})}}function ee(se,ve,_e){try{F[se][ve]=_e/1e3}catch(Z){L.error(Z)}}function ue(){return O}function ie(se){try{var ve=[];if(se&&se.length>0){var _e=[v.default.VIDEO,v.default.AUDIO,v.default.TEXT],Z=D.getAvailabilityStartTime()/1e3;se.forEach(function(Ee){var Se=_e.reduce(function(Me,de){return Me=Me.concat(D.getAllMediaInfoForType(Ee,de)),Me},[]).reduce(function(Me,de){var xe=D.getProducerReferenceTimes(Ee,de);return xe.forEach(function(Fe){var Le=D.getVoRepresentations(de);if(Le&&Le.length>0&&Le[0].adaptation&&Le[0].segmentInfoType===_.default.SEGMENT_TEMPLATE){var De=Le[0],Ae=new Date(Fe[_.default.WALL_CLOCK_TIME]),ge=Ae.getTime()/1e3,pe=ge-(Fe[_.default.PRESENTATION_TIME]/De[_.default.TIMESCALE]-De[_.default.PRESENTATION_TIME_OFFSET]+Ee.start),Re=Z-pe;Me.push({id:Fe[_.default.ID],to:Re})}}),Me},[]);ve=ve.concat(Se)})}O=ve}catch(Ee){L.error(Ee),O=[]}}function Q(se){var ve=0,_e,Z=O.filter(function(Ee){return Ee.id===se.referenceId});return Z.length===0?(ve=O.length>0?O[0].to:0,_e=O[0].id||NaN):(ve=Z[0].to||0,_e=Z[0].id||NaN),{to:ve,id:_e}}return b={getServiceDescriptionSettings:U,getProducerReferenceTimeOffsets:ue,calculateProducerReferenceTimeOffsets:ie,applyServiceDescription:w,reset:M,setConfig:B},x(),b}T.__dashjs_factory_name="ServiceDescriptionController";const C=m.default.getSingletonFactory(T)},"./src/dash/models/DashManifestModel.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>ie});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/dash/constants/DashConstants.js"),v=d("./src/dash/vo/Representation.js"),_=d("./src/dash/vo/AdaptationSet.js"),S=d("./src/dash/vo/Period.js"),E=d("./src/dash/vo/Mpd.js"),T=d("./src/dash/vo/UTCTiming.js"),C=d("./src/dash/vo/Event.js"),R=d("./src/dash/vo/BaseURL.js"),b=d("./src/dash/vo/EventStream.js"),F=d("./src/dash/vo/ProducerReferenceTime.js"),O=d("./src/dash/vo/ContentSteering.js"),L=d("./src/streaming/utils/ObjectUtils.js"),D=d("./src/streaming/utils/URLUtils.js"),x=d("./src/core/FactoryMaker.js"),B=d("./src/core/Debug.js"),M=d("./src/streaming/vo/DashJSError.js"),I=d("./src/core/errors/Errors.js"),U=d("./src/streaming/thumbnail/ThumbnailTracks.js");function w(Q,se){var ve;if(typeof Symbol>"u"||Q[Symbol.iterator]==null){if(Array.isArray(Q)||(ve=W(Q))||se&&Q&&typeof Q.length=="number"){ve&&(Q=ve);var _e=0,Z=function(){};return{s:Z,n:function(){return _e>=Q.length?{done:!0}:{done:!1,value:Q[_e++]}},e:function(xe){throw xe},f:Z}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ee=!0,Se=!1,Me;return{s:function(){ve=Q[Symbol.iterator]()},n:function(){var xe=ve.next();return Ee=xe.done,xe},e:function(xe){Se=!0,Me=xe},f:function(){try{!Ee&&ve.return!=null&&ve.return()}finally{if(Se)throw Me}}}}function k(Q){return J(Q)||Y(Q)||W(Q)||K()}function K(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W(Q,se){if(Q){if(typeof Q=="string")return ee(Q,se);var ve=Object.prototype.toString.call(Q).slice(8,-1);if(ve==="Object"&&Q.constructor&&(ve=Q.constructor.name),ve==="Map"||ve==="Set")return Array.from(Q);if(ve==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ve))return ee(Q,se)}}function Y(Q){if(typeof Symbol<"u"&&Symbol.iterator in Object(Q))return Array.from(Q)}function J(Q){if(Array.isArray(Q))return ee(Q)}function ee(Q,se){(se==null||se>Q.length)&&(se=Q.length);for(var ve=0,_e=new Array(se);ve<se;ve++)_e[ve]=Q[ve];return _e}function ue(){var Q,se,ve,_e,Z=this.context,Ee=(0,D.default)(Z).getInstance(),Se=Number.isInteger||function(Be){return typeof Be=="number"&&isFinite(Be)&&Math.floor(Be)===Be};function Me(){se=(0,B.default)(Z).getInstance().getLogger(Q)}function de(Be,Tt){if(!Be)throw new Error("adaptation is not defined");if(!Tt)throw new Error("type is not defined");if(Be.Representation_asArray&&Be.Representation_asArray.length){var Xt=Ut(Be.Representation_asArray[0]);if(Xt&&Xt.length>0&&U.THUMBNAILS_SCHEME_ID_URIS.indexOf(Xt[0].schemeIdUri)>=0)return Tt===m.default.IMAGE}if(Be.ContentComponent_asArray&&Be.ContentComponent_asArray.length>0){if(Be.ContentComponent_asArray.length>1)return Tt===m.default.MUXED;if(Be.ContentComponent_asArray[0].contentType===Tt)return!0}var et=Tt===m.default.TEXT?new RegExp("(ttml|vtt|wvtt|stpp)"):new RegExp(Tt);if(Be.Representation_asArray&&Be.Representation_asArray.length){var gt=Be.Representation_asArray[0].codecs;if(et.test(gt))return!0}if(Be.hasOwnProperty(g.default.MIME_TYPE))return et.test(Be.mimeType);if(Be.Representation_asArray){for(var At,en=0;en<Be.Representation_asArray.length;en++)if(At=Be.Representation_asArray[en],At.hasOwnProperty(g.default.MIME_TYPE))return et.test(At.mimeType)}return!1}function xe(Be){if(!Be)throw new Error("adaptation is not defined");if(Be.hasOwnProperty(g.default.SEGMENT_TEMPLATE)||Be.hasOwnProperty(g.default.SEGMENT_TIMELINE)||Be.hasOwnProperty(g.default.SEGMENT_LIST)||Be.hasOwnProperty(g.default.SEGMENT_BASE))return!0;if(Be.Representation_asArray&&Be.Representation_asArray.length>0){var Tt=Be.Representation_asArray[0];if(Tt.hasOwnProperty(g.default.SEGMENT_TEMPLATE)||Tt.hasOwnProperty(g.default.SEGMENT_TIMELINE)||Tt.hasOwnProperty(g.default.SEGMENT_LIST)||Tt.hasOwnProperty(g.default.SEGMENT_BASE))return!0}return!1}function Fe(Be){return de(Be,m.default.AUDIO)}function Le(Be){return de(Be,m.default.VIDEO)}function De(Be){return de(Be,m.default.TEXT)}function Ae(Be){return de(Be,m.default.MUXED)}function ge(Be){return de(Be,m.default.IMAGE)}function pe(Be){var Tt=Be&&Be.hasOwnProperty(g.default.PRODUCERREFERENCETIME_ASARRAY)?Be[g.default.PRODUCERREFERENCETIME_ASARRAY]:[],Xt=Be&&Be.hasOwnProperty(g.default.REPRESENTATION_ASARRAY)?Be[g.default.REPRESENTATION_ASARRAY]:[];Xt.forEach(function(gt){gt.hasOwnProperty(g.default.PRODUCERREFERENCETIME_ASARRAY)&&Tt.push.apply(Tt,k(gt[g.default.PRODUCERREFERENCETIME_ASARRAY]))});var et=[];return Tt.forEach(function(gt){var At=new F.default;if(gt.hasOwnProperty(g.default.ID))At[g.default.ID]=gt[g.default.ID];else return;if(gt.hasOwnProperty(g.default.WALL_CLOCK_TIME))At[g.default.WALL_CLOCK_TIME]=gt[g.default.WALL_CLOCK_TIME];else return;if(gt.hasOwnProperty(g.default.PRESENTATION_TIME))At[g.default.PRESENTATION_TIME]=gt[g.default.PRESENTATION_TIME];else return;et.push(At)}),et}function Re(Be){var Tt="";return Be&&Be.hasOwnProperty(g.default.LANG)&&(Tt=Be.lang),Tt}function me(Be){return Be&&Be.hasOwnProperty(g.default.VIEWPOINT)?Be.Viewpoint:null}function V(Be){return Be&&Be.hasOwnProperty(g.default.ROLE_ASARRAY)?Be.Role_asArray:[]}function j(Be){return Be&&Be.hasOwnProperty(g.default.ACCESSIBILITY_ASARRAY)?Be.Accessibility_asArray:[]}function $(Be){return Be&&Be.hasOwnProperty(g.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?Be.AudioChannelConfiguration_asArray:[]}function re(Be){return Be&&Be.hasOwnProperty(g.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?Be.AudioChannelConfiguration_asArray:[]}function oe(){return function(Be,Tt){return Be.bandwidth-Tt.bandwidth}}function X(Be){return Be&&Array.isArray(Be.Representation_asArray)&&Be.Representation_asArray.sort(oe()),Be}function z(Be,Tt){return Be&&Be.Period_asArray&&Se(Tt)?Be.Period_asArray[Tt]?Be.Period_asArray[Tt].AdaptationSet_asArray:[]:[]}function ne(Be){return Be&&Be.Period_asArray?Be.Period_asArray:[]}function fe(Be,Tt){var Xt=ne(Tt);return Xt.length>0&&Se(Be)?Xt[Be]:null}function Ce(Be,Tt,Xt){var et=z(Tt,Xt),gt,At;for(gt=0,At=et.length;gt<At;gt++)if(et[gt].hasOwnProperty(g.default.ID)&&et[gt].id===Be)return et[gt];return null}function Pe(Be,Tt,Xt){var et=z(Tt,Xt);return et.length>0&&Se(Be)?et[Be]:null}function he(Be,Tt,Xt){if(!Be)return-1;for(var et=z(Tt,Xt),gt=0;gt<et.length;gt++){var At=(0,L.default)(Z).getInstance();if(At.areEqual(et[gt],Be))return gt}return-1}function Ue(Be,Tt,Xt){var et=z(Be,Tt),gt,At,en=[];for(gt=0,At=et.length;gt<At;gt++)de(et[gt],Xt)&&en.push(X(et[gt]));return en}function we(Be,Tt,Xt){var et=null;if(Be&&Be.Representation_asArray&&Be.Representation_asArray.length>0){var gt=Se(Tt)&&Tt>=0&&Tt<Be.Representation_asArray.length?Be.Representation_asArray[Tt]:Be.Representation_asArray[0];gt&&(et=gt.mimeType+';codecs="'+gt.codecs+'"',Xt&&gt.width!==void 0&&(et+=';width="'+gt.width+'";height="'+gt.height+'"'))}return et&&(et=et.replace(/\sprofiles=[^;]*/g,"")),et}function $e(Be){return Be&&Be.Representation_asArray&&Be.Representation_asArray.length>0?Be.Representation_asArray[0].mimeType:null}function it(Be){return!Be||!Be.hasOwnProperty(g.default.CENC_DEFAULT_KID)?null:Be[g.default.CENC_DEFAULT_KID]}function mt(Be){if(!Be||!Array.isArray(Be.Label_asArray))return[];for(var Tt=[],Xt=0;Xt<Be.Label_asArray.length;Xt++)Tt.push({lang:Be.Label_asArray[Xt].lang,text:Be.Label_asArray[Xt].__text||Be.Label_asArray[Xt]});return Tt}function pt(Be){return!Be||!Be.hasOwnProperty(g.default.CONTENTPROTECTION_ASARRAY)||Be.ContentProtection_asArray.length===0?null:Be.ContentProtection_asArray}function Pt(Be){var Tt=!1;return Be&&Be.hasOwnProperty("type")&&(Tt=Be.type===g.default.DYNAMIC),Tt}function lt(Be){return Be&&Be[g.default.ID]||null}function Ye(Be,Tt){var Xt=!1;return Be&&Be.profiles&&Be.profiles.length>0&&(Xt=Be.profiles.indexOf(Tt)!==-1),Xt}function st(Be){var Tt;return Be&&Be.hasOwnProperty(g.default.MEDIA_PRESENTATION_DURATION)?Tt=Be.mediaPresentationDuration:Be&&Be.type=="dynamic"?Tt=Number.POSITIVE_INFINITY:Tt=Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,Tt}function Nt(Be){return Be&&Be.bandwidth?Be.bandwidth:NaN}function Wt(Be){var Tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,Xt=NaN;return Be&&Be.hasOwnProperty(g.default.MINIMUM_UPDATE_PERIOD)&&(Xt=Be.minimumUpdatePeriod),isNaN(Xt)?Xt:Math.max(Xt-Tt,1)}function Ht(Be){return Be&&Be.hasOwnProperty(g.default.PUBLISH_TIME)?new Date(Be[g.default.PUBLISH_TIME]):null}function nt(Be){return Be&&Array.isArray(Be.Representation_asArray)?Be.Representation_asArray.length:0}function Et(Be){var Tt=X(Be),Xt=Tt&&Array.isArray(Tt.Representation_asArray)?Tt.Representation_asArray:[];return Xt.map(function(et){return{bandwidth:et.bandwidth,width:et.width||0,height:et.height||0,scanType:et.scanType||null,id:et.id||null}})}function St(Be){try{var Tt=Be&&typeof Be.selectionPriority<"u"?parseInt(Be.selectionPriority):1;return isNaN(Tt)?1:Tt}catch{return 1}}function Ut(Be){return!Be||!Be.EssentialProperty_asArray||!Be.EssentialProperty_asArray.length?null:Be.EssentialProperty_asArray.map(function(Tt){return{schemeIdUri:Tt.schemeIdUri,value:Tt.value}})}function Vt(Be,Tt){return Tt&&Tt.Representation_asArray&&Tt.Representation_asArray.length>0&&Se(Be)?Tt.Representation_asArray[Be]:null}function Zt(Be){if(Be&&Be.period&&Se(Be.period.index)){var Tt=Be.period.mpd.manifest.Period_asArray[Be.period.index];if(Tt&&Tt.AdaptationSet_asArray&&Se(Be.index))return X(Tt.AdaptationSet_asArray[Be.index])}}function We(Be){var Tt=[],Xt=Zt(Be),et,gt;if(Xt&&Xt.Representation_asArray){if(Be&&Be.period&&Se(Be.period.index)){var At=Ke(Be.period.mpd.manifest);At&&(gt=At[0])}for(var en=0,Nn=Xt.Representation_asArray.length;en<Nn;++en){var _n=Xt.Representation_asArray[en],En=new v.default;if(En.index=en,En.adaptation=Be,_n.hasOwnProperty(g.default.ID)&&(En.id=_n.id),_n.hasOwnProperty(g.default.CODECS)&&(En.codecs=_n.codecs),_n.hasOwnProperty(g.default.MIME_TYPE)&&(En.mimeType=_n[g.default.MIME_TYPE]),_n.hasOwnProperty(g.default.CODEC_PRIVATE_DATA)&&(En.codecPrivateData=_n.codecPrivateData),_n.hasOwnProperty(g.default.BANDWITH)&&(En.bandwidth=_n.bandwidth),_n.hasOwnProperty(g.default.WIDTH)&&(En.width=_n.width),_n.hasOwnProperty(g.default.HEIGHT)&&(En.height=_n.height),_n.hasOwnProperty(g.default.SCAN_TYPE)&&(En.scanType=_n.scanType),_n.hasOwnProperty(g.default.MAX_PLAYOUT_RATE)&&(En.maxPlayoutRate=_n.maxPlayoutRate),_n.hasOwnProperty(g.default.SEGMENT_BASE)?(et=_n.SegmentBase,En.segmentInfoType=g.default.SEGMENT_BASE):_n.hasOwnProperty(g.default.SEGMENT_LIST)?(et=_n.SegmentList,et.hasOwnProperty(g.default.SEGMENT_TIMELINE)?En.segmentInfoType=g.default.SEGMENT_TIMELINE:En.segmentInfoType=g.default.SEGMENT_LIST):_n.hasOwnProperty(g.default.SEGMENT_TEMPLATE)?(et=_n.SegmentTemplate,et.hasOwnProperty(g.default.SEGMENT_TIMELINE)?En.segmentInfoType=g.default.SEGMENT_TIMELINE:En.segmentInfoType=g.default.SEGMENT_TEMPLATE,et.hasOwnProperty(g.default.INITIALIZATION_MINUS)&&(En.initialization=et.initialization.split("$Bandwidth$").join(_n.bandwidth).split("$RepresentationID$").join(_n.id))):En.segmentInfoType=g.default.BASE_URL,En.essentialProperties=Ut(_n),et){if(et.hasOwnProperty(g.default.INITIALIZATION)){var mr=et.Initialization;mr.hasOwnProperty(g.default.SOURCE_URL)&&(En.initialization=mr.sourceURL),mr.hasOwnProperty(g.default.RANGE)&&(En.range=mr.range)}else De(Xt)&&xe(Xt)&&Xt.mimeType&&Xt.mimeType.indexOf("application/mp4")===-1&&(En.range=0);et.hasOwnProperty(g.default.TIMESCALE)&&(En.timescale=et.timescale),et.hasOwnProperty(g.default.DURATION)?En.segmentDuration=et.duration/En.timescale:_n.hasOwnProperty(g.default.SEGMENT_TEMPLATE)&&(et=_n.SegmentTemplate,et.hasOwnProperty(g.default.SEGMENT_TIMELINE)&&(En.segmentDuration=In(et.SegmentTimeline)/En.timescale)),et.hasOwnProperty(g.default.MEDIA)&&(En.media=et.media),et.hasOwnProperty(g.default.START_NUMBER)&&(En.startNumber=et.startNumber),et.hasOwnProperty(g.default.INDEX_RANGE)&&(En.indexRange=et.indexRange),et.hasOwnProperty(g.default.PRESENTATION_TIME_OFFSET)&&(En.presentationTimeOffset=et.presentationTimeOffset/En.timescale),et.hasOwnProperty(g.default.AVAILABILITY_TIME_OFFSET)?En.availabilityTimeOffset=et.availabilityTimeOffset:gt&&gt.availabilityTimeOffset!==void 0&&(En.availabilityTimeOffset=gt.availabilityTimeOffset),et.hasOwnProperty(g.default.AVAILABILITY_TIME_COMPLETE)?En.availabilityTimeComplete=et.availabilityTimeComplete!=="false":gt&&gt.availabilityTimeComplete!==void 0&&(En.availabilityTimeComplete=gt.availabilityTimeComplete)}En.MSETimeOffset=Ct(En),En.path=[Be.period.index,Be.index,en],Tt.push(En)}}return Tt}function In(Be){if(!Be||!Be.S_asArray)return NaN;var Tt=Be.S_asArray[0],Xt=Be.S_asArray[1];return Tt.hasOwnProperty("d")?Tt.d:Xt.t-Tt.t}function Ct(Be){var Tt=Be.presentationTimeOffset,Xt=Be.adaptation.period.start;return Xt-Tt}function je(Be){var Tt=Be&&Se(Be.index)?Be.mpd.manifest.Period_asArray[Be.index]:null,Xt=[],et,gt,At;if(Tt&&Tt.AdaptationSet_asArray)for(At=0;At<Tt.AdaptationSet_asArray.length;At++)gt=Tt.AdaptationSet_asArray[At],et=new _.default,gt.hasOwnProperty(g.default.ID)&&(et.id=gt.id),et.index=At,et.period=Be,Ae(gt)?et.type=m.default.MUXED:Fe(gt)?et.type=m.default.AUDIO:Le(gt)?et.type=m.default.VIDEO:De(gt)?et.type=m.default.TEXT:ge(gt)?et.type=m.default.IMAGE:se.warn("Unknown Adaptation stream type"),Xt.push(et);return Xt}function Oe(Be){var Tt=Be?Pt(Be.manifest):!1,Xt=[],et=null,gt=null,At=null,en=null,Nn,_n;for(_n=0,Nn=Be&&Be.manifest&&Be.manifest.Period_asArray?Be.manifest.Period_asArray.length:0;_n<Nn;_n++)gt=Be.manifest.Period_asArray[_n],gt.hasOwnProperty(g.default.START)?(en=new S.default,en.start=gt.start):et!==null&&et.hasOwnProperty(g.default.DURATION)&&At!==null?(en=new S.default,en.start=parseFloat((At.start+At.duration).toFixed(5))):_n===0&&!Tt&&(en=new S.default,en.start=0),At!==null&&isNaN(At.duration)&&(en!==null?At.duration=parseFloat((en.start-At.start).toFixed(5)):se.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),en!==null&&(en.id=ze(gt,_n),en.index=_n,en.mpd=Be,gt.hasOwnProperty(g.default.DURATION)&&(en.duration=gt.duration),At&&(At.nextPeriodId=en.id),Xt.push(en),et=gt,At=en),gt=null,en=null;return Xt.length===0||At!==null&&isNaN(At.duration)&&(At.duration=parseFloat((bt(At)-At.start).toFixed(5))),Xt}function ze(Be,Tt){if(!Be)throw new Error("Period cannot be null or undefined");var Xt=S.default.DEFAULT_ID+"_"+Tt;return Be.hasOwnProperty(g.default.ID)&&Be.id.length>0&&Be.id!=="__proto__"&&(Xt=Be.id),Xt}function ct(Be){var Tt=new E.default;return Be&&(Tt.manifest=Be,Be.hasOwnProperty(g.default.AVAILABILITY_START_TIME)?Tt.availabilityStartTime=new Date(Be.availabilityStartTime.getTime()):Be.loadedTime&&(Tt.availabilityStartTime=new Date(Be.loadedTime.getTime())),Be.hasOwnProperty(g.default.AVAILABILITY_END_TIME)&&(Tt.availabilityEndTime=new Date(Be.availabilityEndTime.getTime())),Be.hasOwnProperty(g.default.MINIMUM_UPDATE_PERIOD)&&(Tt.minimumUpdatePeriod=Be.minimumUpdatePeriod),Be.hasOwnProperty(g.default.MEDIA_PRESENTATION_DURATION)&&(Tt.mediaPresentationDuration=Be.mediaPresentationDuration),Be.hasOwnProperty(g.default.SUGGESTED_PRESENTATION_DELAY)&&(Tt.suggestedPresentationDelay=Be.suggestedPresentationDelay),Be.hasOwnProperty(g.default.TIMESHIFT_BUFFER_DEPTH)&&(Tt.timeShiftBufferDepth=Be.timeShiftBufferDepth),Be.hasOwnProperty(g.default.MAX_SEGMENT_DURATION)&&(Tt.maxSegmentDuration=Be.maxSegmentDuration),Be.hasOwnProperty(g.default.PUBLISH_TIME)&&(Tt.publishTime=new Date(Be.publishTime))),Tt}function dt(){if(!ve||!ve.hasOwnProperty("error"))throw new Error(m.default.MISSING_CONFIG_ERROR)}function bt(Be){dt();var Tt=Pt(Be.mpd.manifest),Xt;return Be.mpd.manifest.mediaPresentationDuration?Xt=Be.mpd.manifest.mediaPresentationDuration:Be.duration?Xt=Be.duration:Tt?Xt=Number.POSITIVE_INFINITY:ve.error(new M.default(I.default.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",Be)),Xt}function Ft(Be){var Tt=Be&&Be.mpd&&Be.mpd.manifest?Be.mpd.manifest:null,Xt=Tt?Tt.Period_asArray:null,et=Xt&&Be&&Se(Be.index)?Xt[Be.index].EventStream_asArray:null,gt=[],At,en;if(et)for(At=0;At<et.length;At++){var Nn=new b.default;if(Nn.period=Be,Nn.timescale=1,et[At].hasOwnProperty(m.default.SCHEME_ID_URI))Nn.schemeIdUri=et[At][m.default.SCHEME_ID_URI];else throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(et[At].hasOwnProperty(g.default.TIMESCALE)&&(Nn.timescale=et[At][g.default.TIMESCALE]),et[At].hasOwnProperty(g.default.VALUE)&&(Nn.value=et[At][g.default.VALUE]),et[At].hasOwnProperty(g.default.PRESENTATION_TIME_OFFSET)&&(Nn.presentationTimeOffset=et[At][g.default.PRESENTATION_TIME_OFFSET]),en=0;et[At].Event_asArray&&en<et[At].Event_asArray.length;en++){var _n=et[At].Event_asArray[en],En=new C.default;En.presentationTime=0,En.eventStream=Nn,_n.hasOwnProperty(g.default.PRESENTATION_TIME)&&(En.presentationTime=_n.presentationTime);var mr=Nn.presentationTimeOffset?Nn.presentationTimeOffset/Nn.timescale:0;En.calculatedPresentationTime=En.presentationTime/Nn.timescale+Be.start-mr,_n.hasOwnProperty(g.default.DURATION)&&(En.duration=_n.duration/Nn.timescale),_n.hasOwnProperty(g.default.ID)?En.id=_n.id:En.id=null,_n.Signal&&_n.Signal.Binary?En.messageData=_e.decodeArray(_n.Signal.Binary.toString()):En.messageData=_n.messageData||_n.__cdata||_n.__text,gt.push(En)}}return gt}function Dt(Be,Tt,Xt){var et=[],gt;if(!Be)return et;for(gt=0;gt<Be.length;gt++){var At=new b.default;if(At.timescale=1,At.representation=Tt,Be[gt].hasOwnProperty(m.default.SCHEME_ID_URI))At.schemeIdUri=Be[gt].schemeIdUri;else throw new Error("Invalid EventStream. SchemeIdUri has to be set");Be[gt].hasOwnProperty(g.default.TIMESCALE)&&(At.timescale=Be[gt].timescale),Be[gt].hasOwnProperty(g.default.VALUE)&&(At.value=Be[gt].value),et.push(At),At.period=Xt}return et}function Kt(Be,Tt,Xt){var et,gt,At;return Be&&Be.Period_asArray&&Tt&&Tt.period&&Se(Tt.period.index)&&(gt=Be.Period_asArray[Tt.period.index],gt&&gt.AdaptationSet_asArray&&Se(Tt.index)&&(At=gt.AdaptationSet_asArray[Tt.index],At&&(et=At.InbandEventStream_asArray))),Dt(et,null,Xt)}function on(Be,Tt,Xt){var et,gt,At,en;return Be&&Be.Period_asArray&&Tt&&Tt.adaptation&&Tt.adaptation.period&&Se(Tt.adaptation.period.index)&&(gt=Be.Period_asArray[Tt.adaptation.period.index],gt&&gt.AdaptationSet_asArray&&Se(Tt.adaptation.index)&&(At=gt.AdaptationSet_asArray[Tt.adaptation.index],At&&At.Representation_asArray&&Se(Tt.index)&&(en=At.Representation_asArray[Tt.index],en&&(et=en.InbandEventStream_asArray)))),Dt(et,Tt,Xt)}function Tn(Be){var Tt=Pt(Be),Xt=Be?Be.hasOwnProperty(g.default.AVAILABILITY_START_TIME):!1,et=Be?Be.UTCTiming_asArray:null,gt=[];return(Tt||Xt)&&et&&et.forEach(function(At){var en=new T.default;if(At.hasOwnProperty(m.default.SCHEME_ID_URI))en.schemeIdUri=At.schemeIdUri;else return;if(At.hasOwnProperty(g.default.VALUE))en.value=At.value.toString();else return;gt.push(en)}),gt}function Ke(Be){var Tt=[],Xt=Be.BaseURL_asArray||[Be.baseUri],et=!1;return Xt.some(function(gt){if(gt){var At=new R.default,en=gt.__text||gt;return Ee.isRelative(en)&&(et=!0,Be.baseUri&&(en=Ee.resolve(en,Be.baseUri))),At.url=en,gt.hasOwnProperty(g.default.SERVICE_LOCATION)&&gt.serviceLocation.length?At.serviceLocation=gt.serviceLocation:At.serviceLocation=en,gt.hasOwnProperty(g.default.DVB_PRIORITY)&&(At.dvb_priority=gt[g.default.DVB_PRIORITY]),gt.hasOwnProperty(g.default.DVB_WEIGHT)&&(At.dvb_weight=gt[g.default.DVB_WEIGHT]),gt.hasOwnProperty(g.default.AVAILABILITY_TIME_OFFSET)&&(At.availabilityTimeOffset=gt[g.default.AVAILABILITY_TIME_OFFSET]),gt.hasOwnProperty(g.default.AVAILABILITY_TIME_COMPLETE)&&(At.availabilityTimeComplete=gt[g.default.AVAILABILITY_TIME_COMPLETE]!=="false"),Tt.push(At),et}}),Tt}function ut(Be){if(Be&&Be.hasOwnProperty(g.default.CONTENT_STEERING_AS_ARRAY)){var Tt=Be[g.default.CONTENT_STEERING_AS_ARRAY][0],Xt=new O.default;return Xt.serverUrl=Tt.__text,Tt.hasOwnProperty(g.default.DEFAULT_SERVICE_LOCATION)&&(Xt.defaultServiceLocation=Tt[g.default.DEFAULT_SERVICE_LOCATION]),Tt.hasOwnProperty(g.default.QUERY_BEFORE_START)&&(Xt.queryBeforeStart=Tt[g.default.QUERY_BEFORE_START].toLowerCase()==="true"),Tt.hasOwnProperty(g.default.PROXY_SERVER_URL)&&(Xt.proxyServerUrl=Tt[g.default.PROXY_SERVER_URL]),Xt}}function wt(Be){if(Be&&Be.hasOwnProperty(m.default.LOCATION))return Be.Location=Be.Location_asArray[0],Be.Location}function Gt(Be){if(Be&&Be.hasOwnProperty(g.default.PATCH_LOCATION))return Be.PatchLocation=Be.PatchLocation_asArray[0],Be.PatchLocation}function Qt(Be){return Be&&Be.hasOwnProperty(g.default.SUGGESTED_PRESENTATION_DELAY)?Be.suggestedPresentationDelay:null}function sn(Be){return Be&&Be.hasOwnProperty(g.default.AVAILABILITY_START_TIME)&&Be.availabilityStartTime!==null?Be.availabilityStartTime.getTime():null}function Dn(Be){var Tt=[];if(Be&&Be.hasOwnProperty(g.default.SERVICE_DESCRIPTION)){var Xt=w(Be.ServiceDescription_asArray),et;try{for(Xt.s();!(et=Xt.n()).done;){var gt=et.value,At=null,en=null,Nn=null,_n=null,En=null,mr=null;for(var jn in gt)gt.hasOwnProperty(jn)&&(jn===g.default.ID?At=gt[jn]:jn===g.default.SERVICE_DESCRIPTION_SCOPE?en=gt[jn].schemeIdUri:jn===g.default.SERVICE_DESCRIPTION_LATENCY?Nn={target:parseInt(gt[jn].target),max:parseInt(gt[jn].max),min:parseInt(gt[jn].min),referenceId:parseInt(gt[jn].referenceId)}:jn===g.default.SERVICE_DESCRIPTION_PLAYBACK_RATE?_n={max:parseFloat(gt[jn].max),min:parseFloat(gt[jn].min)}:jn===g.default.SERVICE_DESCRIPTION_OPERATING_QUALITY?En={mediaType:gt[jn].mediaType,max:parseInt(gt[jn].max),min:parseInt(gt[jn].min),target:parseInt(gt[jn].target),type:gt[jn].type,maxQualityDifference:parseInt(gt[jn].maxQualityDifference)}:jn===g.default.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH&&(mr={mediaType:gt[jn].mediaType,max:parseInt(gt[jn].max),min:parseInt(gt[jn].min),target:parseInt(gt[jn].target)}));Tt.push({id:At,schemeIdUri:en,latency:Nn,playbackRate:_n,operatingQuality:En,operatingBandwidth:mr})}}catch(Mt){Xt.e(Mt)}finally{Xt.f()}}return Tt}function pn(Be){var Tt={};if(Be&&Be.hasOwnProperty(g.default.SUPPLEMENTAL_PROPERTY)){var Xt=w(Be.SupplementalProperty_asArray),et;try{for(Xt.s();!(et=Xt.n()).done;){var gt=et.value;gt.hasOwnProperty(m.default.SCHEME_ID_URI)&&gt.hasOwnProperty(g.default.VALUE)&&(Tt[gt[m.default.SCHEME_ID_URI]]=gt[g.default.VALUE])}}catch(At){Xt.e(At)}finally{Xt.f()}}return Tt}function sr(Be){Be&&(Be.errHandler&&(ve=Be.errHandler),Be.BASE64&&(_e=Be.BASE64))}return Q={getIsTypeOf:de,getIsText:De,getIsFragmented:xe,getProducerReferenceTimesForAdaptation:pe,getLanguageForAdaptation:Re,getViewpointForAdaptation:me,getRolesForAdaptation:V,getAccessibilityForAdaptation:j,getAudioChannelConfigurationForAdaptation:$,getAudioChannelConfigurationForRepresentation:re,getAdaptationForIndex:Pe,getIndexForAdaptation:he,getAdaptationForId:Ce,getAdaptationsForType:Ue,getRealPeriods:ne,getRealPeriodForIndex:fe,getCodec:we,getSelectionPriority:St,getMimeType:$e,getKID:it,getLabelsForAdaptation:mt,getContentProtectionData:pt,getIsDynamic:Pt,getId:lt,hasProfile:Ye,getDuration:st,getBandwidth:Nt,getManifestUpdatePeriod:Wt,getPublishTime:Ht,getRepresentationCount:nt,getBitrateListForAdaptation:Et,getRepresentationFor:Vt,getRepresentationsForAdaptation:We,getAdaptationsForPeriod:je,getRegularPeriods:Oe,getMpd:ct,getEventsForPeriod:Ft,getEssentialPropertiesForRepresentation:Ut,getEventStreamForAdaptationSet:Kt,getEventStreamForRepresentation:on,getUTCTimingSources:Tn,getBaseURLsFromElement:Ke,getRepresentationSortFunction:oe,getContentSteering:ut,getLocation:wt,getPatchLocation:Gt,getSuggestedPresentationDelay:Qt,getAvailabilityStartTime:sn,getServiceDescriptions:Dn,getSupplementalProperties:pn,setConfig:sr},Me(),Q}ue.__dashjs_factory_name="DashManifestModel";const ie=x.default.getSingletonFactory(ue)},"./src/dash/models/PatchManifestModel.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>T});var m=d("./src/dash/constants/DashConstants.js"),g=d("./src/core/FactoryMaker.js"),v=d("./src/core/Debug.js"),_=d("./src/dash/vo/SimpleXPath.js"),S=d("./src/dash/vo/PatchOperation.js");function E(){var C,R,b=this.context;function F(){R=(0,v.default)(b).getInstance().getLogger(C)}function O(M){return M&&M.hasOwnProperty(m.default.ORIGINAL_MPD_ID)||!1}function L(M){return M&&M.hasOwnProperty(m.default.PUBLISH_TIME)?new Date(M[m.default.PUBLISH_TIME]):null}function D(M){return M&&M.hasOwnProperty(m.default.ORIGINAL_PUBLISH_TIME)?new Date(M[m.default.ORIGINAL_PUBLISH_TIME]):null}function x(M){return M&&M[m.default.ORIGINAL_MPD_ID]||null}function B(M){return M?(M.__children||[]).map(function(I){var U=Object.keys(I)[0];if(U!=="add"&&U!=="remove"&&U!=="replace")return R.warn("Ignoring node of invalid action: ".concat(U)),null;var w=I[U],k=w.sel;if(U==="add"&&w.type){if(!w.type.startsWith("@"))return R.warn("Ignoring add action for prefixed namespace declaration: ".concat(w.type,"=").concat(w.__text)),null;k="".concat(k,"/").concat(w.type)}var K=new _.default(k);if(!K.isValid())return R.warn("Ignoring action with invalid selector: ".concat(U," - ").concat(k)),null;var W=null;K.findsAttribute()?W=w.__text||"":U!=="remove"&&(W=w.__children.reduce(function(J,ee){var ue=Object.keys(ee)[0];return ue!=="#text"&&(J[ue]=J[ue]||[],J[ue].push(ee[ue])),J},{}));var Y=new S.default(U,K,W);return U==="add"&&(Y.position=w.pos),Y}).filter(function(I){return!!I}):[]}return C={getIsPatch:O,getPublishTime:L,getOriginalPublishTime:D,getMpdId:x,getPatchOperations:B},F(),C}E.__dashjs_factory_name="PatchManifestModel";const T=g.default.getSingletonFactory(E)},"./src/dash/parser/DashParser.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>O});var m=d("./src/core/FactoryMaker.js"),g=d("./src/dash/parser/objectiron.js"),v=d("./externals/xml2json.js"),_=d("./src/dash/parser/matchers/StringMatcher.js"),S=d("./src/dash/parser/matchers/DurationMatcher.js"),E=d("./src/dash/parser/matchers/DateTimeMatcher.js"),T=d("./src/dash/parser/matchers/NumericMatcher.js"),C=d("./src/dash/parser/matchers/LangMatcher.js"),R=d("./src/dash/parser/maps/RepresentationBaseValuesMap.js"),b=d("./src/dash/parser/maps/SegmentValuesMap.js");function F(L){L=L||{};var D=this.context,x=L.debug,B,M,I,U,w;function k(){M=x.getLogger(B),I=[new S.default,new E.default,new T.default,new C.default,new _.default],U=new v.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!1,matchers:I}),w=(0,g.default)(D).create({adaptationset:new R.default,period:new b.default})}function K(){return I}function W(){return w}function Y(J){var ee,ue=window.performance.now();if(ee=U.xml_str2json(J),!ee)throw new Error("parsing the manifest failed");var ie=window.performance.now();ee.Patch?(ee=ee.Patch,ee.add_asArray&&ee.add_asArray.forEach(function(se){return w.run(se)}),ee.replace_asArray&&ee.replace_asArray.forEach(function(se){return w.run(se)})):(ee=ee.MPD,w.run(ee));var Q=window.performance.now();return M.info("Parsing complete: ( xml2json: "+(ie-ue).toPrecision(3)+"ms, objectiron: "+(Q-ie).toPrecision(3)+"ms, total: "+((Q-ue)/1e3).toPrecision(3)+"s)"),ee.protocol="DASH",ee}return B={parse:Y,getMatchers:K,getIron:W},k(),B}F.__dashjs_factory_name="DashParser";const O=m.default.getClassFactory(F)},"./src/dash/parser/maps/CommonProperty.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});function m(E,T){if(!(E instanceof T))throw new TypeError("Cannot call a class as a function")}function g(E,T){for(var C=0;C<T.length;C++){var R=T[C];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(E,R.key,R)}}function v(E,T,C){return T&&g(E.prototype,T),C&&g(E,C),E}var _=function(){function E(T){m(this,E);var C=function(b){return b&&b.length&&b.charAt(0)===b.charAt(0).toUpperCase()};this._name=T,this._merge=C(T)}return v(E,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),E}();const S=_},"./src/dash/parser/maps/MapNode.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});var m=d("./src/dash/parser/maps/CommonProperty.js");function g(T,C){if(!(T instanceof C))throw new TypeError("Cannot call a class as a function")}function v(T,C){for(var R=0;R<C.length;R++){var b=C[R];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(T,b.key,b)}}function _(T,C,R){return C&&v(T.prototype,C),R&&v(T,R),T}var S=function(){function T(C,R,b){var F=this;g(this,T),this._name=C||"",this._properties=[],this._children=b||[],Array.isArray(R)&&R.forEach(function(O){F._properties.push(new m.default(O))})}return _(T,[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),T}();const E=S},"./src/dash/parser/maps/RepresentationBaseValuesMap.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/dash/parser/maps/MapNode.js"),g=d("./src/dash/constants/DashConstants.js");function v(D){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?v=function(B){return typeof B}:v=function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},v(D)}function _(D,x){if(!(D instanceof x))throw new TypeError("Cannot call a class as a function")}function S(D,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");D.prototype=Object.create(x&&x.prototype,{constructor:{value:D,writable:!0,configurable:!0}}),x&&E(D,x)}function E(D,x){return E=Object.setPrototypeOf||function(M,I){return M.__proto__=I,M},E(D,x)}function T(D){var x=b();return function(){var M=F(D),I;if(x){var U=F(this).constructor;I=Reflect.construct(M,arguments,U)}else I=M.apply(this,arguments);return C(this,I)}}function C(D,x){return x&&(v(x)==="object"||typeof x=="function")?x:R(D)}function R(D){if(D===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D}function b(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function F(D){return F=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)},F(D)}var O=function(D){S(B,D);var x=T(B);function B(){_(this,B);var M=[g.default.PROFILES,g.default.WIDTH,g.default.HEIGHT,g.default.SAR,g.default.FRAMERATE,g.default.AUDIO_SAMPLING_RATE,g.default.MIME_TYPE,g.default.SEGMENT_PROFILES,g.default.CODECS,g.default.MAXIMUM_SAP_PERIOD,g.default.START_WITH_SAP,g.default.MAX_PLAYOUT_RATE,g.default.CODING_DEPENDENCY,g.default.SCAN_TYPE,g.default.FRAME_PACKING,g.default.AUDIO_CHANNEL_CONFIGURATION,g.default.CONTENT_PROTECTION,g.default.ESSENTIAL_PROPERTY,g.default.SUPPLEMENTAL_PROPERTY,g.default.INBAND_EVENT_STREAM];return x.call(this,g.default.ADAPTATION_SET,M,[new m.default(g.default.REPRESENTATION,M,[new m.default(g.default.SUB_REPRESENTATION,M)])])}return B}(m.default);const L=O},"./src/dash/parser/maps/SegmentValuesMap.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/dash/parser/maps/MapNode.js"),g=d("./src/dash/constants/DashConstants.js");function v(D){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?v=function(B){return typeof B}:v=function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},v(D)}function _(D,x){if(!(D instanceof x))throw new TypeError("Cannot call a class as a function")}function S(D,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");D.prototype=Object.create(x&&x.prototype,{constructor:{value:D,writable:!0,configurable:!0}}),x&&E(D,x)}function E(D,x){return E=Object.setPrototypeOf||function(M,I){return M.__proto__=I,M},E(D,x)}function T(D){var x=b();return function(){var M=F(D),I;if(x){var U=F(this).constructor;I=Reflect.construct(M,arguments,U)}else I=M.apply(this,arguments);return C(this,I)}}function C(D,x){return x&&(v(x)==="object"||typeof x=="function")?x:R(D)}function R(D){if(D===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D}function b(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function F(D){return F=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)},F(D)}var O=function(D){S(B,D);var x=T(B);function B(){_(this,B);var M=[g.default.SEGMENT_BASE,g.default.SEGMENT_TEMPLATE,g.default.SEGMENT_LIST];return x.call(this,g.default.PERIOD,M,[new m.default(g.default.ADAPTATION_SET,M,[new m.default(g.default.REPRESENTATION,M)])])}return B}(m.default);const L=O},"./src/dash/parser/matchers/BaseMatcher.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});function m(E,T){if(!(E instanceof T))throw new TypeError("Cannot call a class as a function")}function g(E,T){for(var C=0;C<T.length;C++){var R=T[C];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(E,R.key,R)}}function v(E,T,C){return T&&g(E.prototype,T),C&&g(E,C),E}var _=function(){function E(T,C){m(this,E),this._test=T,this._converter=C}return v(E,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),E}();const S=_},"./src/dash/parser/matchers/DateTimeMatcher.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>B});var m=d("./src/dash/parser/matchers/BaseMatcher.js");function g(M){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(U){return typeof U}:g=function(U){return U&&typeof Symbol=="function"&&U.constructor===Symbol&&U!==Symbol.prototype?"symbol":typeof U},g(M)}function v(M,I){if(!(M instanceof I))throw new TypeError("Cannot call a class as a function")}function _(M,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function");M.prototype=Object.create(I&&I.prototype,{constructor:{value:M,writable:!0,configurable:!0}}),I&&S(M,I)}function S(M,I){return S=Object.setPrototypeOf||function(w,k){return w.__proto__=k,w},S(M,I)}function E(M){var I=R();return function(){var w=b(M),k;if(I){var K=b(this).constructor;k=Reflect.construct(w,arguments,K)}else k=w.apply(this,arguments);return T(this,k)}}function T(M,I){return I&&(g(I)==="object"||typeof I=="function")?I:C(M)}function C(M){if(M===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return M}function R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(M){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(U){return U.__proto__||Object.getPrototypeOf(U)},b(M)}var F=60,O=60,L=1e3,D=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,x=function(M){_(U,M);var I=E(U);function U(){return v(this,U),I.call(this,function(w){return D.test(w.value)},function(w){var k=D.exec(w),K;if(K=Date.UTC(parseInt(k[1],10),parseInt(k[2],10)-1,parseInt(k[3],10),parseInt(k[4],10),parseInt(k[5],10),k[6]&&parseInt(k[6],10)||0,k[7]&&parseFloat(k[7])*L||0),k[9]&&k[10]){var W=parseInt(k[9],10)*O+parseInt(k[10],10);K+=(k[8]==="+"?-1:1)*W*F*L}return new Date(K)})}return U}(m.default);const B=x},"./src/dash/parser/matchers/DurationMatcher.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>w});var m=d("./src/dash/parser/matchers/BaseMatcher.js"),g=d("./src/streaming/constants/Constants.js"),v=d("./src/dash/constants/DashConstants.js");function _(k){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_=function(W){return typeof W}:_=function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},_(k)}function S(k,K){if(!(k instanceof K))throw new TypeError("Cannot call a class as a function")}function E(k,K){if(typeof K!="function"&&K!==null)throw new TypeError("Super expression must either be null or a function");k.prototype=Object.create(K&&K.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),K&&T(k,K)}function T(k,K){return T=Object.setPrototypeOf||function(Y,J){return Y.__proto__=J,Y},T(k,K)}function C(k){var K=F();return function(){var Y=O(k),J;if(K){var ee=O(this).constructor;J=Reflect.construct(Y,arguments,ee)}else J=Y.apply(this,arguments);return R(this,J)}}function R(k,K){return K&&(_(K)==="object"||typeof K=="function")?K:b(k)}function b(k){if(k===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k}function F(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function O(k){return O=Object.setPrototypeOf?Object.getPrototypeOf:function(W){return W.__proto__||Object.getPrototypeOf(W)},O(k)}var L=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,D=365*24*60*60,x=30*24*60*60,B=24*60*60,M=60*60,I=60,U=function(k){E(W,k);var K=C(W);function W(){return S(this,W),K.call(this,function(Y){for(var J=[v.default.MIN_BUFFER_TIME,v.default.MEDIA_PRESENTATION_DURATION,v.default.MINIMUM_UPDATE_PERIOD,v.default.TIMESHIFT_BUFFER_DEPTH,v.default.MAX_SEGMENT_DURATION,v.default.MAX_SUBSEGMENT_DURATION,v.default.SUGGESTED_PRESENTATION_DELAY,v.default.START,g.default.START_TIME,v.default.DURATION],ee=J.length,ue=0;ue<ee;ue++)if(Y.nodeName===J[ue])return L.test(Y.value);return!1},function(Y){var J=L.exec(Y),ee=parseFloat(J[3]||0)*D+parseFloat(J[5]||0)*x+parseFloat(J[7]||0)*B+parseFloat(J[9]||0)*M+parseFloat(J[11]||0)*I+parseFloat(J[13]||0);return J[1]!==void 0&&(ee=-ee),ee})}return W}(m.default);const w=U},"./src/dash/parser/matchers/LangMatcher.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>B});var m=d("./src/dash/parser/matchers/BaseMatcher.js"),g=d("./src/dash/constants/DashConstants.js"),v=d("./node_modules/bcp-47-normalize/index.js"),_=d.n(v);function S(M){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?S=function(U){return typeof U}:S=function(U){return U&&typeof Symbol=="function"&&U.constructor===Symbol&&U!==Symbol.prototype?"symbol":typeof U},S(M)}function E(M,I,U){return I in M?Object.defineProperty(M,I,{value:U,enumerable:!0,configurable:!0,writable:!0}):M[I]=U,M}function T(M,I){if(!(M instanceof I))throw new TypeError("Cannot call a class as a function")}function C(M,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function");M.prototype=Object.create(I&&I.prototype,{constructor:{value:M,writable:!0,configurable:!0}}),I&&R(M,I)}function R(M,I){return R=Object.setPrototypeOf||function(w,k){return w.__proto__=k,w},R(M,I)}function b(M){var I=L();return function(){var w=D(M),k;if(I){var K=D(this).constructor;k=Reflect.construct(w,arguments,K)}else k=w.apply(this,arguments);return F(this,k)}}function F(M,I){return I&&(S(I)==="object"||typeof I=="function")?I:O(M)}function O(M){if(M===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return M}function L(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function D(M){return D=Object.setPrototypeOf?Object.getPrototypeOf:function(U){return U.__proto__||Object.getPrototypeOf(U)},D(M)}var x=function(M){C(U,M);var I=b(U);function U(){return T(this,U),I.call(this,function(w,k){var K,W=(K={},E(K,g.default.ADAPTATION_SET,[g.default.LANG]),E(K,g.default.REPRESENTATION,[g.default.LANG]),E(K,g.default.CONTENT_COMPONENT,[g.default.LANG]),E(K,g.default.LABEL,[g.default.LANG]),E(K,g.default.GROUP_LABEL,[g.default.LANG]),K);if(W.hasOwnProperty(k)){var Y=W[k];return Y!==void 0?Y.indexOf(w.name)>=0:!1}return!1},function(w){var k=_()(w);return k!==void 0?k:String(w)})}return U}(m.default);const B=x},"./src/dash/parser/matchers/NumericMatcher.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/dash/parser/matchers/BaseMatcher.js");function g(D){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(B){return typeof B}:g=function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},g(D)}function v(D,x){if(!(D instanceof x))throw new TypeError("Cannot call a class as a function")}function _(D,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");D.prototype=Object.create(x&&x.prototype,{constructor:{value:D,writable:!0,configurable:!0}}),x&&S(D,x)}function S(D,x){return S=Object.setPrototypeOf||function(M,I){return M.__proto__=I,M},S(D,x)}function E(D){var x=R();return function(){var M=b(D),I;if(x){var U=b(this).constructor;I=Reflect.construct(M,arguments,U)}else I=M.apply(this,arguments);return T(this,I)}}function T(D,x){return x&&(g(x)==="object"||typeof x=="function")?x:C(D)}function C(D){if(D===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D}function R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(D){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)},b(D)}var F=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,O=function(D){_(B,D);var x=E(B);function B(){return v(this,B),x.call(this,function(M){return F.test(M.value)},function(M){return parseFloat(M)})}return B}(m.default);const L=O},"./src/dash/parser/matchers/StringMatcher.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>D});var m=d("./src/dash/parser/matchers/BaseMatcher.js"),g=d("./src/dash/constants/DashConstants.js");function v(x){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?v=function(M){return typeof M}:v=function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},v(x)}function _(x,B,M){return B in x?Object.defineProperty(x,B,{value:M,enumerable:!0,configurable:!0,writable:!0}):x[B]=M,x}function S(x,B){if(!(x instanceof B))throw new TypeError("Cannot call a class as a function")}function E(x,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function");x.prototype=Object.create(B&&B.prototype,{constructor:{value:x,writable:!0,configurable:!0}}),B&&T(x,B)}function T(x,B){return T=Object.setPrototypeOf||function(I,U){return I.__proto__=U,I},T(x,B)}function C(x){var B=F();return function(){var I=O(x),U;if(B){var w=O(this).constructor;U=Reflect.construct(I,arguments,w)}else U=I.apply(this,arguments);return R(this,U)}}function R(x,B){return B&&(v(B)==="object"||typeof B=="function")?B:b(x)}function b(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x}function F(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function O(x){return O=Object.setPrototypeOf?Object.getPrototypeOf:function(M){return M.__proto__||Object.getPrototypeOf(M)},O(x)}var L=function(x){E(M,x);var B=C(M);function M(){return S(this,M),B.call(this,function(I,U){var w,k=(w={},_(w,g.default.MPD,[g.default.ID,g.default.PROFILES]),_(w,g.default.PERIOD,[g.default.ID]),_(w,g.default.BASE_URL,[g.default.SERVICE_LOCATION,g.default.BYTE_RANGE]),_(w,g.default.SEGMENT_BASE,[g.default.INDEX_RANGE]),_(w,g.default.INITIALIZATION,[g.default.RANGE]),_(w,g.default.REPRESENTATION_INDEX,[g.default.RANGE]),_(w,g.default.SEGMENT_LIST,[g.default.INDEX_RANGE]),_(w,g.default.BITSTREAM_SWITCHING,[g.default.RANGE]),_(w,g.default.SEGMENT_URL,[g.default.MEDIA_RANGE,g.default.INDEX_RANGE]),_(w,g.default.SEGMENT_TEMPLATE,[g.default.INDEX_RANGE,g.default.MEDIA,g.default.INDEX,g.default.INITIALIZATION_MINUS,g.default.BITSTREAM_SWITCHING_MINUS]),_(w,g.default.ASSET_IDENTIFIER,[g.default.VALUE,g.default.ID]),_(w,g.default.EVENT_STREAM,[g.default.VALUE]),_(w,g.default.ADAPTATION_SET,[g.default.PROFILES,g.default.MIME_TYPE,g.default.SEGMENT_PROFILES,g.default.CODECS,g.default.CONTENT_TYPE]),_(w,g.default.FRAME_PACKING,[g.default.VALUE,g.default.ID]),_(w,g.default.AUDIO_CHANNEL_CONFIGURATION,[g.default.VALUE,g.default.ID]),_(w,g.default.CONTENT_PROTECTION,[g.default.VALUE,g.default.ID]),_(w,g.default.ESSENTIAL_PROPERTY,[g.default.VALUE,g.default.ID]),_(w,g.default.SUPPLEMENTAL_PROPERTY,[g.default.VALUE,g.default.ID]),_(w,g.default.INBAND_EVENT_STREAM,[g.default.VALUE,g.default.ID]),_(w,g.default.ACCESSIBILITY,[g.default.VALUE,g.default.ID]),_(w,g.default.ROLE,[g.default.VALUE,g.default.ID]),_(w,g.default.RATING,[g.default.VALUE,g.default.ID]),_(w,g.default.VIEWPOINT,[g.default.VALUE,g.default.ID]),_(w,g.default.CONTENT_COMPONENT,[g.default.CONTENT_TYPE]),_(w,g.default.REPRESENTATION,[g.default.ID,g.default.DEPENDENCY_ID,g.default.MEDIA_STREAM_STRUCTURE_ID]),_(w,g.default.SUBSET,[g.default.ID]),_(w,g.default.METRICS,[g.default.METRICS_MINUS]),_(w,g.default.REPORTING,[g.default.VALUE,g.default.ID]),w);if(k.hasOwnProperty(U)){var K=k[U];return K!==void 0?K.indexOf(I.name)>=0:!1}return!1},function(I){return String(I)})}return M}(m.default);const D=L},"./src/dash/parser/objectiron.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/core/FactoryMaker.js");function g(E){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(C){return typeof C}:g=function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},g(E)}function v(E){function T(F,O){for(var L in F)O.hasOwnProperty(L)||(O[L]=F[L])}function C(F,O,L){for(var D=0,x=F.length;D<x;++D){var B=F[D];if(O[B.name])if(L[B.name]){if(B.merge){var M=O[B.name],I=L[B.name];g(M)==="object"&&g(I)==="object"?T(M,I):L[B.name]=M+I}}else L[B.name]=O[B.name]}}function R(F,O){for(var L=0,D=F.children.length;L<D;++L){var x=F.children[L],B=O[x.name+"_asArray"];if(B)for(var M=0,I=B.length;M<I;++M){var U=B[M];C(F.properties,O,U),R(x,U)}}}function b(F){if(F===null||g(F)!=="object")return F;if(F.Period_asArray&&"period"in E)for(var O=E.period,L=F.Period_asArray,D=0,x=L.length;D<x;++D){var B=L[D];if(R(O,B),"adaptationset"in E){var M=B.AdaptationSet_asArray;if(M)for(var I=E.adaptationset,U=0,w=M.length;U<w;++U)R(I,M[U])}}return F}return{run:b}}v.__dashjs_factory_name="ObjectIron";var _=m.default.getClassFactory(v);const S=_},"./src/dash/utils/ListSegmentsGetter.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/constants/Constants.js"),v=d("./src/dash/utils/SegmentsUtils.js");function _(T,C){T=T||{};var R=T.timelineConverter,b;function F(){if(!R||!R.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(g.default.MISSING_CONFIG_ERROR)}function O(x){var B={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!x)return B;var M=x.adaptation.period.mpd.manifest.Period_asArray[x.adaptation.period.index].AdaptationSet_asArray[x.adaptation.index].Representation_asArray[x.index].SegmentList,I=x&&!isNaN(x.startNumber)?x.startNumber:1,U=Math.max(I-1,0);return B.numberOfSegments=U+M.SegmentURL_asArray.length,B}function L(x,B){if(F(),!x)return null;var M=x.adaptation.period.mpd.manifest.Period_asArray[x.adaptation.period.index].AdaptationSet_asArray[x.adaptation.index].Representation_asArray[x.index].SegmentList,I=M.SegmentURL_asArray.length,U=x&&!isNaN(x.startNumber)?x.startNumber:1,w=Math.max(U-1,0),k=Math.max(B-w,0),K=null;if(k<I){var W=M.SegmentURL_asArray[k];K=(0,v.getIndexBasedSegment)(R,C,x,B),K&&(K.replacementTime=(U+B-1)*x.segmentDuration,K.media=W.media?W.media:"",K.mediaRange=W.mediaRange,K.indexRange=W.indexRange)}return K}function D(x,B){if(F(),!x)return null;var M=x.segmentDuration;if(isNaN(M))return null;var I=R.calcPeriodRelativeTimeFromMpdRelativeTime(x,B),U=Math.floor(I/M);return L(x,U)}return b={getSegmentByIndex:L,getSegmentByTime:D,getMediaFinishedInformation:O},b}_.__dashjs_factory_name="ListSegmentsGetter";var S=m.default.getClassFactory(_);const E=S},"./src/dash/utils/Round10.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});function m(E,T){if(!(E instanceof T))throw new TypeError("Cannot call a class as a function")}function g(E,T){for(var C=0;C<T.length;C++){var R=T[C];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(E,R.key,R)}}function v(E,T,C){return T&&g(E.prototype,T),C&&g(E,C),E}var _=function(){function E(){m(this,E)}return v(E,null,[{key:"round10",value:function(C,R){return S("round",C,R)}}]),E}();function S(E,T,C){return typeof C>"u"||+C==0?Math[E](T):(T=+T,C=+C,T===null||isNaN(T)||!(typeof C=="number"&&C%1===0)?NaN:(T=T.toString().split("e"),T=Math[E](+(T[0]+"e"+(T[1]?+T[1]-C:-C))),T=T.toString().split("e"),+(T[0]+"e"+(T[1]?+T[1]+C:C))))}},"./src/dash/utils/SegmentBaseGetter.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/constants/Constants.js");function v(E){E=E||{};var T=E.timelineConverter,C;function R(){if(!T||!T.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(g.default.MISSING_CONFIG_ERROR)}function b(D){var x={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};return!D||!D.segments||(x.numberOfSegments=D.segments.length),x}function F(D,x){if(R(),!D)return null;var B=D.segments?D.segments.length:-1,M;if(x<B&&(M=D.segments[x],M&&M.index===x))return M;for(var I=0;I<B;I++)if(M=D.segments[I],M&&M.index===x)return M;return null}function O(D,x){R();var B=L(D,x);return F(D,B)}function L(D,x){if(!D)return-1;var B=D.segments,M=B?B.length:null,I=-1,U,w,k,K,W;if(B&&M>0){for(W=0;W<M;W++)if(w=B[W],k=w.presentationStartTime,K=w.duration,U=K/2,x+U>=k&&x-U<k+K){I=w.index;break}}return I}return C={getSegmentByIndex:F,getSegmentByTime:O,getMediaFinishedInformation:b},C}v.__dashjs_factory_name="SegmentBaseGetter";var _=m.default.getClassFactory(v);const S=_},"./src/dash/utils/SegmentsUtils.js":(h,f,d)=>{d.r(f),d.d(f,{getIndexBasedSegment:()=>R,getTimeBasedSegment:()=>b,replaceIDForTemplate:()=>S,replaceTokenForTemplate:()=>E,unescapeDollarsInTemplate:()=>_});var m=d("./src/dash/vo/Segment.js");function g(F,O){for(;F.length<O;)F="0"+F;return F}function v(F,O){return F.representation.startNumber+O}function _(F){return F&&F.split("$$").join("$")}function S(F,O){if(!O||!F||F.indexOf("$RepresentationID$")===-1)return F;var L=O.toString();return F.split("$RepresentationID$").join(L)}function E(F,O,L){var D="%0",x,B,M,I,U,w,k=O.length,K=D.length;if(!F)return F;for(;;){if(x=F.indexOf("$"+O),x<0||(B=F.indexOf("$",x+k),B<0))return F;if(M=F.indexOf(D,x+k),M>x&&M<B)switch(I=F.charAt(B-1),U=parseInt(F.substring(M+K,B-1),10),I){case"d":case"i":case"u":w=g(L.toString(),U);break;case"x":w=g(L.toString(16),U);break;case"X":w=g(L.toString(16),U).toUpperCase();break;case"o":w=g(L.toString(8),U);break;default:return F}else w=L;F=F.substring(0,x)+w+F.substring(B+1)}}function T(F,O,L,D,x,B,M,I){var U=new m.default;return U.representation=F,U.duration=O,U.presentationStartTime=L,U.mediaStartTime=D,U.availabilityStartTime=x.calcAvailabilityStartTimeFromPresentationTime(B,F,M),U.availabilityEndTime=x.calcAvailabilityEndTimeFromPresentationTime(B+O,F,M),U.wallStartTime=x.calcWallTimeForSegment(U,M),U.replacementNumber=v(U,I),U.index=I,U}function C(F,O,L,D){var x=O.adaptation.period;if(isFinite(x.duration)&&x.start+x.duration<=L.presentationStartTime)return!1;if(D){if(O.availabilityTimeOffset==="INF")return!0;var B=F.getClientReferenceTime();return L.availabilityStartTime.getTime()<=B&&(!isFinite(L.availabilityEndTime)||L.availabilityEndTime.getTime()>=B)}return!0}function R(F,O,L,D){var x,B,M;x=L.segmentDuration,isNaN(x)&&(x=L.adaptation.period.duration),B=parseFloat((L.adaptation.period.start+D*x).toFixed(5)),M=parseFloat((B+x).toFixed(5));var I=F.calcMediaTimeFromPresentationTime(B,L),U=T(L,x,B,I,F,M,O,D);return C(F,L,U,O)?U:null}function b(F,O,L,D,x,B,M,I,U,w){var k=D/B,K=x/B,W,Y,J;return W=F.calcPresentationTimeFromMediaTime(k,L),Y=W+K,J=T(L,K,W,k,F,Y,O,U),C(F,L,J,O)?(J.replacementTime=w||D,M=E(M,"Number",J.replacementNumber),M=E(M,"Time",J.replacementTime),J.media=M,J.mediaRange=I,J):null}},"./src/dash/utils/TemplateSegmentsGetter.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/constants/Constants.js"),v=d("./src/dash/utils/SegmentsUtils.js");function _(T,C){T=T||{};var R=T.timelineConverter,b;function F(){if(!R||!R.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(g.default.MISSING_CONFIG_ERROR)}function O(x){var B={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!x)return B;var M=x.segmentDuration;return isNaN(M)?B.numberOfSegments=1:B.numberOfSegments=Math.ceil(x.adaptation.period.duration/M),B}function L(x,B){if(F(),!x)return null;var M=x.adaptation.period.mpd.manifest.Period_asArray[x.adaptation.period.index].AdaptationSet_asArray[x.adaptation.index].Representation_asArray[x.index].SegmentTemplate;B=Math.max(B,0);var I=(0,v.getIndexBasedSegment)(R,C,x,B);if(I){I.replacementTime=Math.round((B-1)*x.segmentDuration*x.timescale,10);var U=M.media;U=(0,v.replaceTokenForTemplate)(U,"Number",I.replacementNumber),U=(0,v.replaceTokenForTemplate)(U,"Time",I.replacementTime),I.media=U}return I}function D(x,B){if(F(),!x)return null;var M=x.segmentDuration;if(isNaN(M))return null;var I=R.calcPeriodRelativeTimeFromMpdRelativeTime(x,B),U=Math.floor(I/M);return L(x,U)}return b={getSegmentByIndex:L,getSegmentByTime:D,getMediaFinishedInformation:O},b}_.__dashjs_factory_name="TemplateSegmentsGetter";var S=m.default.getClassFactory(_);const E=S},"./src/dash/utils/TimelineConverter.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>F});var m=d("./src/core/EventBus.js"),g=d("./src/core/events/Events.js"),v=d("./src/core/FactoryMaker.js"),_=d("./src/dash/constants/DashConstants.js"),S=d("./src/dash/models/DashManifestModel.js"),E=d("./src/core/Settings.js"),T=d("./src/streaming/constants/Constants.js"),C=d("./src/streaming/MediaPlayerEvents.js"),R=d("./src/streaming/constants/ConformanceViolationConstants.js");function b(){var O=this.context,L=(0,m.default)(O).getInstance(),D=(0,E.default)(O).getInstance(),x,B,M,I;function U(){B=(0,S.default)(O).getInstance(),De()}function w(){Le(),L.on(g.default.UPDATE_TIME_SYNC_OFFSET,Fe,this)}function k(){return I}function K(Ae){I=Ae}function W(){return Date.now()-M*1e3+I*1e3}function Y(Ae,ge,pe,Re){var me,V=ge.adaptation.period.mpd,j=V.availabilityStartTime;if(Re)pe&&V.timeShiftBufferDepth!==Number.POSITIVE_INFINITY?me=new Date(j.getTime()+(Ae+V.timeShiftBufferDepth)*1e3):me=V.availabilityEndTime;else if(pe){var $=ge.availabilityTimeOffset;me=new Date(j.getTime()+(Ae-$)*1e3)}else me=j;return me}function J(Ae,ge,pe){return Y(Ae,ge,pe)}function ee(Ae,ge,pe){return Y(Ae,ge,pe,!0)}function ue(Ae,ge){return(Ae.getTime()-ge.mpd.availabilityStartTime.getTime()+I*1e3)/1e3}function ie(Ae,ge){var pe=ge.adaptation.period.start,Re=ge.presentationTimeOffset;return Ae+(pe-Re)}function Q(Ae,ge){var pe=ge.adaptation.period.start,Re=ge.presentationTimeOffset;return Ae-pe+Re}function se(Ae,ge){var pe,Re,me;return ge&&(pe=Ae.representation.adaptation.period.mpd.suggestedPresentationDelay,Re=Ae.presentationStartTime+pe,me=new Date(Ae.availabilityStartTime.getTime()+Re*1e3)),me}function ve(Ae,ge){if(!ge)return _e(Ae);if(D.get().streaming.timeShiftBuffer.calcFromSegmentTimeline){var pe=Ee(Ae);return Se(pe.now,pe.range),pe.range}return Z(Ae)}function _e(Ae){var ge={start:NaN,end:NaN},pe=0,Re=NaN;return Ae.forEach(function(me){var V=me.getStreamInfo();pe+=V.duration,(isNaN(Re)||V.start<Re)&&(Re=V.start)}),ge.start=Re,ge.end=Re+pe,ge}function Z(Ae){var ge={start:NaN,end:NaN};if(!Ae||Ae.length===0)return ge;var pe=Ae[0].getAdapter().getRegularPeriods()[0],Re=ue(new Date,pe),me=pe.mpd.timeShiftBufferDepth,V=isNaN(me)?0:Re-me;if(ge.start=Me(Ae,V),ge.end=!isNaN(ge.start)&&Re<ge.start?Re:Me(Ae,Re,!0),!isNaN(me)&&ge.end<Re-me&&(ge.end=NaN),D.get().streaming.timeShiftBuffer.fallbackToSegmentTimeline){var j=Ee(Ae);if(j.range.end<ge.start)return L.trigger(C.default.CONFORMANCE_VIOLATION,{level:R.default.LEVELS.WARNING,event:R.default.EVENTS.INVALID_DVR_WINDOW}),Se(j.now,j.range),j.range}return ge}function Ee(Ae){var ge={start:NaN,end:NaN},pe=Ae[0].getAdapter().getRegularPeriods()[0],Re=ue(new Date,pe);if(!Ae||Ae.length===0)return{range:ge,now:Re};Ae.forEach(function(V){var j=V.getAdapter(),$=j.getMediaInfoForType(V.getStreamInfo(),T.default.VIDEO)||j.getMediaInfoForType(V.getStreamInfo(),T.default.AUDIO),re=j.getVoRepresentations($),oe=re[0],X={start:NaN,end:NaN};if(oe)if(oe.segmentInfoType===_.default.SEGMENT_TIMELINE)X=de(oe);else{var z=oe.adaptation.period;X.start=z.start,X.end=Math.max(Re,z.start+z.duration)}!isNaN(X.start)&&(isNaN(ge.start)||ge.start>X.start)&&(ge.start=X.start),!isNaN(X.end)&&(isNaN(ge.end)||ge.end<X.end)&&(ge.end=X.end)}),ge.end=Math.min(Re,ge.end);var me=Me(Ae,ge.end,!0);return ge.end=isNaN(me)?ge.end:me,ge.start=pe&&pe.mpd&&pe.mpd.timeShiftBufferDepth&&!isNaN(pe.mpd.timeShiftBufferDepth)&&!isNaN(ge.end)?Math.max(ge.end-pe.mpd.timeShiftBufferDepth,ge.start):ge.start,ge.start=Me(Ae,ge.start),{range:ge,now:Re}}function Se(Ae,ge){M=Ae-ge.end}function Me(Ae,ge){var pe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;try{for(var Re=0,me=!1,V=NaN;!me&&Re<Ae.length;){var j=Ae[Re].getStreamInfo();j.start<=ge&&(!isFinite(j.duration)||j.start+j.duration>=ge)?(V=ge,me=!0):!pe&&j.start>ge&&(isNaN(V)||j.start<V)?V=j.start:pe&&j.start+j.duration<ge&&(isNaN(V)||j.start+j.duration>V)&&(V=j.start+j.duration),Re+=1}return V}catch{return ge}}function de(Ae){var ge=Ae.adaptation.period.mpd.manifest.Period_asArray[Ae.adaptation.period.index].AdaptationSet_asArray[Ae.adaptation.index],pe=B.getRepresentationFor(Ae.index,ge),Re=pe.SegmentTemplate.SegmentTimeline,me=pe.SegmentTemplate.timescale,V=Re.S_asArray,j={start:0,end:0},$=0,re,oe,X,z;for(j.start=ie(V[0].t/me,Ae),X=0,z=V.length;X<z;X++)re=V[X],oe=0,re.hasOwnProperty("r")&&(oe=re.r),$+=re.d*(1+oe);return j.end=ie((V[0].t+$)/me,Ae),j}function xe(Ae,ge){var pe=Ae.adaptation.period.start;return ge-pe}function Fe(Ae){Ae.offset!==void 0&&!isNaN(Ae.offset)&&K(Ae.offset/1e3)}function Le(){I=0,M=0}function De(){L.off(g.default.UPDATE_TIME_SYNC_OFFSET,Fe,this),Le()}return x={initialize:w,getClientTimeOffset:k,setClientTimeOffset:K,getClientReferenceTime:W,calcAvailabilityStartTimeFromPresentationTime:J,calcAvailabilityEndTimeFromPresentationTime:ee,calcPresentationTimeFromWallTime:ue,calcPresentationTimeFromMediaTime:ie,calcPeriodRelativeTimeFromMpdRelativeTime:xe,calcMediaTimeFromPresentationTime:Q,calcWallTimeForSegment:se,calcTimeShiftBufferWindow:ve,reset:De},U(),x}b.__dashjs_factory_name="TimelineConverter";const F=v.default.getSingletonFactory(b)},"./src/dash/utils/TimelineSegmentsGetter.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/constants/Constants.js"),v=d("./src/dash/utils/SegmentsUtils.js");function _(T,C){T=T||{};var R=T.timelineConverter,b=T.dashMetrics,F;function O(){if(!R)throw new Error(g.default.MISSING_CONFIG_ERROR)}function L(U){if(!U)return 0;var w=U.adaptation.period.mpd.manifest.Period_asArray[U.adaptation.period.index].AdaptationSet_asArray[U.adaptation.index].Representation_asArray[U.index].SegmentTemplate||U.adaptation.period.mpd.manifest.Period_asArray[U.adaptation.period.index].AdaptationSet_asArray[U.adaptation.index].Representation_asArray[U.index].SegmentList,k=w.SegmentTimeline,K=0,W=0,Y=0,J,ee,ue,ie,Q,se,ve;for(ve=U.timescale,J=k.S_asArray,ie=J.length,ue=0;ue<ie;ue++){if(ee=J[ue],se=0,ee.hasOwnProperty("r")&&(se=ee.r),ee.hasOwnProperty("t")&&(K=ee.t,W=K/ve),se<0){var _e=J[ue+1];se=x(U,_e,ee,ve,W)}for(Q=0;Q<=se;Q++)Y++,K+=ee.d,W=K/ve}return{numberOfSegments:Y,mediaTimeOfLastSignaledSegment:W}}function D(U,w){var k=U.adaptation.period.mpd.manifest.Period_asArray[U.adaptation.period.index].AdaptationSet_asArray[U.adaptation.index].Representation_asArray[U.index].SegmentTemplate||U.adaptation.period.mpd.manifest.Period_asArray[U.adaptation.period.index].AdaptationSet_asArray[U.adaptation.index].Representation_asArray[U.index].SegmentList,K=k.SegmentTimeline,W=k.SegmentURL_asArray,Y=0,J=-1,ee,ue,ie,Q,se,ve,_e;_e=U.timescale,ee=K.S_asArray;var Z=!1;for(ie=0,Q=ee.length;ie<Q&&!Z;ie++){if(ue=ee[ie],ve=0,ue.hasOwnProperty("r")&&(ve=ue.r),ue.hasOwnProperty("t")&&(Y=ue.t),ve<0){var Ee=ee[ie+1];ve=x(U,Ee,ue,_e,Y/_e)}for(se=0;se<=ve&&!Z;se++)J++,Z=w(Y,k,W,ue,_e,J,ie),Z&&(U.segmentDuration=ue.d/_e),Y+=ue.d}}function x(U,w,k,K,W){var Y;if(w&&w.hasOwnProperty("t"))Y=w.t/K;else try{var J=0;if(!isNaN(U.adaptation.period.start)&&!isNaN(U.adaptation.period.duration)&&isFinite(U.adaptation.period.duration))J=U.adaptation.period.start+U.adaptation.period.duration;else{var ee=b.getCurrentDVRInfo();J=isNaN(ee.end)?0:ee.end}Y=R.calcMediaTimeFromPresentationTime(J,U),U.segmentDuration=k.d/K}catch{Y=0}return Math.max(Math.ceil((Y-W)/(k.d/K))-1,0)}function B(U,w,k){if(O(),!U)return null;var K=null,W=!1;return D(U,function(Y,J,ee,ue,ie,Q,se){if(W||k<0){var ve=J.media,_e=ue.mediaRange;return ee&&(ve=ee[se].media||"",_e=ee[se].mediaRange),K=(0,v.getTimeBasedSegment)(R,C,U,Y,ue.d,ie,ve,_e,Q,ue.tManifest),!0}else Y>=k*ie-ue.d*.5&&(W=!0);return!1}),K}function M(U,w){if(O(),!U)return null;w===void 0&&(w=null);var k=null,K=R.calcMediaTimeFromPresentationTime(w,U);return D(U,function(W,Y,J,ee,ue,ie,Q){var se=I(K*ue);if(se<W+ee.d&&se>=W){var ve=Y.media,_e=ee.mediaRange;return J&&(ve=J[Q].media||"",_e=J[Q].mediaRange),k=(0,v.getTimeBasedSegment)(R,C,U,W,ee.d,ue,ve,_e,ie,ee.tManifest),!0}return!1}),k}function I(U){return parseFloat(U.toPrecision(15))}return F={getSegmentByIndex:B,getSegmentByTime:M,getMediaFinishedInformation:L},F}_.__dashjs_factory_name="TimelineSegmentsGetter";var S=m.default.getClassFactory(_);const E=S},"./src/dash/vo/AdaptationSet.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.period=null,this.index=-1,this.type=null};const v=g},"./src/dash/vo/BaseURL.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});function m(E,T){if(!(E instanceof T))throw new TypeError("Cannot call a class as a function")}var g=1,v=1,_=function E(T,C,R,b){m(this,E),this.url=T||"",this.serviceLocation=C||T||"",this.dvb_priority=R||g,this.dvb_weight=b||v,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0};_.DEFAULT_DVB_PRIORITY=g,_.DEFAULT_DVB_WEIGHT=v;const S=_},"./src/dash/vo/ContentSteering.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.defaultServiceLocation=null,this.queryBeforeStart=!1,this.proxyServerUrl=null,this.serverUrl=null};const v=g},"./src/dash/vo/ContentSteeringRequest.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});var m=d("./src/streaming/vo/metrics/HTTPRequest.js");function g(S,E){if(!(S instanceof E))throw new TypeError("Cannot call a class as a function")}var v=function S(E){g(this,S),this.url=E||null,this.type=m.HTTPRequest.CONTENT_STEERING_TYPE,this.responseType="json"};const _=v},"./src/dash/vo/ContentSteeringResponse.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.version=null,this.ttl=300,this.reloadUri=null,this.serviceLocationPriority=[]};const v=g},"./src/dash/vo/Event.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN};const v=g},"./src/dash/vo/EventStream.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri="",this.presentationTimeOffset=0};const v=g},"./src/dash/vo/ManifestInfo.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.dvrWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null};const v=g},"./src/dash/vo/MediaInfo.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.labels=null,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.KID=null,this.bitrateList=null,this.isFragmented=null,this.isEmbedded=null,this.selectionPriority=1,this.supplementalProperties={}};const v=g},"./src/dash/vo/Mpd.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.publishTime=null,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN};const v=g},"./src/dash/vo/PatchOperation.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});function m(E,T){if(!(E instanceof T))throw new TypeError("Cannot call a class as a function")}function g(E,T){for(var C=0;C<T.length;C++){var R=T[C];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(E,R.key,R)}}function v(E,T,C){return T&&g(E.prototype,T),C&&g(E,C),E}var _=function(){function E(T,C,R){m(this,E),this.action=T,this.xpath=C,this.value=R,this.position=null}return v(E,[{key:"getMpdTarget",value:function(C){var R=this.action==="remove"||this.action==="replace"||this.position==="before"||this.position==="after";return this.xpath.getMpdTarget(C,R)}}]),E}();const S=_},"./src/dash/vo/Period.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null,this.nextPeriodId=null};g.DEFAULT_ID="defaultId";const v=g},"./src/dash/vo/ProducerReferenceTime.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.id=null,this.inband=!1,this.type="encoder",this.applicationScheme=null,this.wallClockTime=null,this.presentationTime=NaN,this.UTCTiming=null};const v=g},"./src/dash/vo/Representation.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});var m=d("./src/dash/constants/DashConstants.js");function g(T,C){if(!(T instanceof C))throw new TypeError("Cannot call a class as a function")}function v(T,C){for(var R=0;R<C.length;R++){var b=C[R];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(T,b.key,b)}}function _(T,C,R){return C&&v(T.prototype,C),R&&v(T,R),T}var S=function(){function T(){g(this,T),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.mimeType=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.mediaFinishedInformation={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN},this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0}return _(T,[{key:"hasInitialization",value:function(){return this.initialization!==null||this.range!==null}},{key:"hasSegments",value:function(){return this.segmentInfoType!==m.default.BASE_URL&&this.segmentInfoType!==m.default.SEGMENT_BASE&&!this.indexRange}}]),T}();const E=S},"./src/dash/vo/RepresentationInfo.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.id=null,this.quality=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null};const v=g},"./src/dash/vo/Segment.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.wallStartTime=NaN,this.representation=null};const v=g},"./src/dash/vo/SimpleXPath.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});function m(E,T){if(!(E instanceof T))throw new TypeError("Cannot call a class as a function")}function g(E,T){for(var C=0;C<T.length;C++){var R=T[C];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(E,R.key,R)}}function v(E,T,C){return T&&g(E.prototype,T),C&&g(E,C),E}var _=function(){function E(T){var C=this;m(this,E),this.valid=T[0]=="/",this.path=T.split("/").filter(function(R){return R.length!==0}).map(function(R){var b={name:R},F=R.indexOf("[");if(F!=-1){b.name=R.substring(0,F);var O=R.substring(F+1,R.length-1);C.valid=C.valid&&O.indexOf("[")==-1;var L=O.indexOf("=");L!=-1?(b.attribute={name:O.substring(1,L),value:O.substring(L+1)},["'",'"'].indexOf(b.attribute.value[0])!=-1&&(b.attribute.value=b.attribute.value.substring(1,b.attribute.value.length-1))):b.position=parseInt(O,10)-1}return b})}return v(E,[{key:"isValid",value:function(){return this.valid}},{key:"findsElement",value:function(){return!this.findsAttribute()}},{key:"findsAttribute",value:function(){return this.path[this.path.length-1].name.startsWith("@")}},{key:"getMpdTarget",value:function(C,R){for(var b=null,F=C,O=1,L="MPD";O<this.path.length&&F!==null;){b=F;var D=this.path[O];if(L=D.name,O!==this.path.length-1||!L.startsWith("@")){var x=b[L+"_asArray"]||[];x.length===0&&b[L]&&x.push(b[L]),D.position?F=x[D.position]||null:D.attribute?function(){var B=D.attribute;F=x.filter(function(M){return M[B.name]==B.value})[0]||null}():F=x[0]||null}O++}return F===null?null:L.startsWith("@")?{name:L.substring(1),leaf:F,target:F}:{name:L,leaf:F,target:R?b:F}}}]),E}();const S=_},"./src/dash/vo/StreamInfo.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0};const v=g},"./src/dash/vo/UTCTiming.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.schemeIdUri="",this.value=""};const v=g},"./src/streaming/FragmentLoader.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>T});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/streaming/net/URLLoader.js"),v=d("./src/streaming/vo/HeadRequest.js"),_=d("./src/streaming/vo/DashJSError.js"),S=d("./src/core/FactoryMaker.js");function E(C){C=C||{};var R=this.context,b=C.eventBus,F=C.events,O=C.urlUtils,L=C.errors,D=C.streamId,x,B;function M(){B=(0,g.default)(R).create({errHandler:C.errHandler,errors:L,dashMetrics:C.dashMetrics,mediaPlayerModel:C.mediaPlayerModel,requestModifier:C.requestModifier,urlUtils:O,constants:m.default,boxParser:C.boxParser,dashConstants:C.dashConstants,requestTimeout:C.settings.get().streaming.fragmentRequestTimeout})}function I(K){var W=function(ee){b.trigger(F.CHECK_FOR_EXISTENCE_COMPLETED,{request:K,exists:ee})};if(K){var Y=new v.default(K.url);B.load({request:Y,success:function(){W(!0)},error:function(){W(!1)}})}else W(!1)}function U(K){var W=function(J,ee){b.trigger(F.LOADING_COMPLETED,{request:K,response:J||null,error:ee||null,sender:x})};K?B.load({request:K,progress:function(J){b.trigger(F.LOADING_PROGRESS,{request:K,stream:J.stream,streamId:D}),J.data&&b.trigger(F.LOADING_DATA_PROGRESS,{request:K,response:J.data||null,error:null,sender:x})},success:function(J){W(J)},error:function(J,ee,ue){W(void 0,new _.default(L.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,ue,ee))},abort:function(J){J&&b.trigger(F.LOADING_ABANDONED,{mediaType:J.mediaType,request:J,sender:x})}}):W(void 0,new _.default(L.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,L.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))}function w(){B&&B.abort()}function k(){B&&(B.abort(),B=null)}return x={checkForExistence:I,load:U,abort:w,reset:k},M(),x}E.__dashjs_factory_name="FragmentLoader";const T=S.default.getClassFactory(E)},"./src/streaming/ManifestLoader.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>B});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/dash/constants/DashConstants.js"),v=d("./src/streaming/controllers/XlinkController.js"),_=d("./src/streaming/net/URLLoader.js"),S=d("./src/streaming/utils/URLUtils.js"),E=d("./src/streaming/vo/TextRequest.js"),T=d("./src/streaming/vo/DashJSError.js"),C=d("./src/streaming/vo/metrics/HTTPRequest.js"),R=d("./src/core/EventBus.js"),b=d("./src/core/events/Events.js"),F=d("./src/core/errors/Errors.js"),O=d("./src/core/FactoryMaker.js"),L=d("./src/dash/parser/DashParser.js");function D(M){M=M||{};var I=this.context,U=M.debug,w=M.settings,k=(0,R.default)(I).getInstance(),K=(0,S.default)(I).getInstance(),W,Y,J,ee,ue,ie=M.mssHandler,Q=M.errHandler;function se(){Y=U.getLogger(W),k.on(b.default.XLINK_READY,ve,W),J=(0,_.default)(I).create({errHandler:M.errHandler,dashMetrics:M.dashMetrics,mediaPlayerModel:M.mediaPlayerModel,requestModifier:M.requestModifier,urlUtils:K,constants:m.default,dashConstants:g.default,errors:F.default,requestTimeout:M.settings.get().streaming.manifestRequestTimeout}),ee=(0,v.default)(I).create({errHandler:Q,dashMetrics:M.dashMetrics,mediaPlayerModel:M.mediaPlayerModel,requestModifier:M.requestModifier,settings:M.settings}),ue=null}function ve(Se){k.trigger(b.default.INTERNAL_MANIFEST_LOADED,{manifest:Se.manifest})}function _e(Se){var Me=null;return Se.indexOf("SmoothStreamingMedia")>-1?(ie&&(Me=ie.createMssParser(),ie.registerEvents()),Me):Se.indexOf("MPD")>-1||Se.indexOf("Patch")>-1?(0,L.default)(I).create({debug:U}):Me}function Z(Se){var Me=new E.default(Se,C.HTTPRequest.MPD_TYPE);J.load({request:Me,success:function(xe,Fe,Le){if(ee){var De,Ae,ge;if(Le&&Le!==Se?(Ae=K.parseBaseUrl(Le),De=Le):(K.isRelative(Se)&&(Se=K.resolve(Se,window.location.href)),Ae=K.parseBaseUrl(Se)),Fe=="No Content"){k.trigger(b.default.INTERNAL_MANIFEST_LOADED,{manifest:null});return}if(ue===null&&(ue=_e(xe)),ue===null){k.trigger(b.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new T.default(F.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,F.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(Se))});return}ee.setMatchers(ue.getMatchers()),ee.setIron(ue.getIron());try{ge=ue.parse(xe)}catch{k.trigger(b.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new T.default(F.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,F.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(Se))});return}if(ge){if(ge.url=De||Se,ge.originalUrl||(ge.originalUrl=ge.url),ge.hasOwnProperty(m.default.LOCATION)&&(Ae=K.parseBaseUrl(ge.Location_asArray[0]),Y.debug("BaseURI set by Location to: "+Ae)),w&&w.get().streaming.enableManifestDurationMismatchFix&&ge.mediaPresentationDuration&&ge.Period_asArray.length>1){var pe=ge.Period_asArray.reduce(function(Re,me){return Re+me.duration},0);!isNaN(pe)&&ge.mediaPresentationDuration>pe&&(Y.warn("Media presentation duration greater than duration of all periods. Setting duration to total period duration"),ge.mediaPresentationDuration=pe)}ge.baseUri=Ae,ge.loadedTime=new Date,ee.resolveManifestOnLoad(ge),k.trigger(b.default.ORIGINAL_MANIFEST_LOADED,{originalManifest:xe})}else k.trigger(b.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new T.default(F.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,F.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(Se))})}},error:function(xe,Fe,Le){k.trigger(b.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new T.default(F.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,F.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+"".concat(Se,", ").concat(Le))})}})}function Ee(){k.off(b.default.XLINK_READY,ve,W),ie&&ie.reset(),ee&&(ee.reset(),ee=null),J&&(J.abort(),J=null)}return W={load:Z,reset:Ee},se(),W}D.__dashjs_factory_name="ManifestLoader";var x=O.default.getClassFactory(D);const B=x},"./src/streaming/ManifestUpdater.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>b});var m=d("./src/core/EventBus.js"),g=d("./src/core/events/Events.js"),v=d("./src/streaming/MediaPlayerEvents.js"),_=d("./src/core/FactoryMaker.js"),S=d("./src/core/Debug.js"),E=d("./src/core/errors/Errors.js"),T=d("./src/dash/constants/DashConstants.js"),C=d("./src/streaming/utils/URLUtils.js");function R(){var F=this.context,O=(0,m.default)(F).getInstance(),L=(0,C.default)(F).getInstance(),D,x,B,M,I,U,w,k,K,W,Y,J;function ee(){x=(0,S.default)(F).getInstance().getLogger(D)}function ue(Ae){Ae&&(Ae.manifestModel&&(K=Ae.manifestModel),Ae.adapter&&(W=Ae.adapter),Ae.manifestLoader&&(k=Ae.manifestLoader),Ae.errHandler&&(Y=Ae.errHandler),Ae.settings&&(J=Ae.settings))}function ie(){se(),O.on(g.default.STREAMS_COMPOSED,Le,this),O.on(v.default.PLAYBACK_STARTED,xe,this),O.on(v.default.PLAYBACK_PAUSED,Fe,this),O.on(g.default.INTERNAL_MANIFEST_LOADED,de,this)}function Q(Ae){Se(Ae)}function se(){B=NaN,w=!1,I=!0,U=!1,_e()}function ve(){O.off(v.default.PLAYBACK_STARTED,xe,this),O.off(v.default.PLAYBACK_PAUSED,Fe,this),O.off(g.default.STREAMS_COMPOSED,Le,this),O.off(g.default.INTERNAL_MANIFEST_LOADED,de,this),se()}function _e(){M!==null&&(clearTimeout(M),M=null)}function Z(Ae){_e(),!U&&(isNaN(Ae)&&!isNaN(B)&&(Ae=B*1e3),isNaN(Ae)||(x.debug("Refresh manifest in "+Ae+" milliseconds."),M=setTimeout(Me,Ae)))}function Ee(){var Ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;w=!0;var ge=K.getValue(),pe=ge.url,Re=W.getPatchLocation(ge),me=W.getLocation(ge);Re&&!Ae?pe=Re:me&&(pe=me),L.isRelative(pe)&&(pe=L.resolve(pe,ge.url)),k.load(pe)}function Se(Ae){if(!Ae)Ae=K.getValue(),Ae.loadedTime=new Date;else if(W.getIsPatch(Ae)){var ge=Ae;Ae=K.getValue();var pe=W.isPatchValid(Ae,ge),Re=pe;if(pe){var me=W.getPublishTime(Ae);Re=W.applyPatchToManifest(Ae,ge);var V=W.getPublishTime(Ae);Re=me.getTime()!=V.getTime()}if(!Re){x.debug("Patch provided is invalid, performing full manifest refresh"),Ee(!0);return}Ae.loadedTime=new Date}if(K.getValue()&&K.getValue().type===T.default.DYNAMIC&&Ae.type===T.default.STATIC){O.trigger(g.default.DYNAMIC_TO_STATIC),w=!1,U=!0;return}K.setValue(Ae);var j=new Date,$=(j.getTime()-Ae.loadedTime.getTime())/1e3;B=W.getManifestUpdatePeriod(Ae,$),B*1e3>2147483647&&(B=2147483647e-3),O.trigger(g.default.MANIFEST_UPDATED,{manifest:Ae}),x.info("Manifest has been refreshed at "+j+"["+j.getTime()/1e3+"] "),I||Z()}function Me(){if(!I){if(w){Z(J.get().streaming.manifestUpdateRetryInterval);return}Ee()}}function de(Ae){Ae.error?Ae.error.code===E.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&Y.error(Ae.error):Se(Ae.manifest)}function xe(){I=!1,Z()}function Fe(){I=!J.get().streaming.scheduling.scheduleWhilePaused,I&&_e()}function Le(){w=!1}function De(){return w}return D={initialize:ie,setManifest:Q,refreshManifest:Ee,getIsUpdating:De,setConfig:ue,reset:ve},ee(),D}R.__dashjs_factory_name="ManifestUpdater";const b=_.default.getClassFactory(R)},"./src/streaming/MediaPlayer.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>X});var m=d("./externals/cea608-parser.js"),g=d.n(m),v=d("./src/streaming/constants/Constants.js"),_=d("./src/dash/constants/DashConstants.js"),S=d("./src/streaming/constants/MetricsConstants.js"),E=d("./src/streaming/controllers/PlaybackController.js"),T=d("./src/streaming/controllers/StreamController.js"),C=d("./src/streaming/controllers/GapController.js"),R=d("./src/streaming/controllers/CatchupController.js"),b=d("./src/dash/controllers/ServiceDescriptionController.js"),F=d("./src/dash/controllers/ContentSteeringController.js"),O=d("./src/streaming/controllers/MediaController.js"),L=d("./src/streaming/controllers/BaseURLController.js"),D=d("./src/streaming/ManifestLoader.js"),x=d("./src/streaming/utils/ErrorHandler.js"),B=d("./src/streaming/utils/Capabilities.js"),M=d("./src/streaming/utils/CapabilitiesFilter.js"),I=d("./src/streaming/utils/RequestModifier.js"),U=d("./src/streaming/models/URIFragmentModel.js"),w=d("./src/streaming/models/ManifestModel.js"),k=d("./src/streaming/models/MediaPlayerModel.js"),K=d("./src/streaming/controllers/AbrController.js"),W=d("./src/streaming/net/SchemeLoaderFactory.js"),Y=d("./src/streaming/models/VideoModel.js"),J=d("./src/streaming/models/CmcdModel.js"),ee=d("./src/streaming/models/CmsdModel.js"),ue=d("./src/streaming/utils/DOMStorage.js"),ie=d("./src/core/Debug.js"),Q=d("./src/core/errors/Errors.js"),se=d("./src/core/EventBus.js"),ve=d("./src/core/events/Events.js"),_e=d("./src/streaming/MediaPlayerEvents.js"),Z=d("./src/core/FactoryMaker.js"),Ee=d("./src/core/Settings.js"),Se=d("./src/core/Version.js"),Me=d("./src/dash/controllers/SegmentBaseController.js"),de=d("./src/dash/DashAdapter.js"),xe=d("./src/dash/DashMetrics.js"),Fe=d("./src/dash/utils/TimelineConverter.js"),Le=d("./src/streaming/vo/metrics/HTTPRequest.js"),De=d("./externals/base64.js"),Ae=d("./node_modules/codem-isoboxer/dist/iso_boxer.js"),ge=d("./src/streaming/vo/DashJSError.js"),pe=d("./src/streaming/utils/SupervisorTools.js"),Re=d("./src/streaming/ManifestUpdater.js"),me=d("./src/streaming/utils/URLUtils.js"),V=d("./src/streaming/utils/BoxParser.js"),j=d("./src/streaming/text/TextController.js"),$=d("./src/streaming/models/CustomParametersModel.js");function re(){var z="You must first call initialize() and set a source before calling this method",ne="You must first call initialize() and set a valid source and view before calling this method",fe="You must first call attachView() to set the video element before calling this method",Ce="You must first call attachSource() with a valid source before calling this method",Pe="MediaPlayer not initialized!",he=this.context,Ue=(0,se.default)(he).getInstance(),we=(0,Ee.default)(he).getInstance(),$e=(0,ie.default)(he).getInstance({settings:we}),it,mt,pt,Pt,lt,Ye,st,Nt,Wt,Ht,nt,Et,St,Ut,Vt,Zt,We,In,Ct,je,Oe,ze,ct,dt,bt,Ft,Dt,Kt,on,Tn,Ke,ut,wt,Gt,Qt,sn,Dn,pn;function sr(){mt=$e.getLogger(it),lt=!1,st=!1,Ye=!1,Nt=!0,St=null,Zt=null,Pt=null,We=null,pn=null,ve.default.extend(_e.default),In=(0,k.default)(he).getInstance(),Ct=(0,$.default)(he).getInstance(),Qt=(0,Y.default)(he).getInstance(),sn=(0,U.default)(he).getInstance()}function Be(ht){ht&&(ht.capabilities&&(ze=ht.capabilities),ht.capabilitiesFilter&&(ct=ht.capabilitiesFilter),ht.streamController&&(dt=ht.streamController),ht.textController&&(bt=ht.textController),ht.gapController&&(Ft=ht.gapController),ht.playbackController&&(Dt=ht.playbackController),ht.serviceDescriptionController&&(Kt=ht.serviceDescriptionController),ht.contentSteeringController&&(on=ht.contentSteeringController),ht.catchupController&&(Tn=ht.catchupController),ht.mediaPlayerModel&&(In=ht.mediaPlayerModel),ht.customParametersModel&&(Ct=ht.customParametersModel),ht.abrController&&(Wt=ht.abrController),ht.schemeLoaderFactory&&(Ht=ht.schemeLoaderFactory),ht.mediaController&&(Et=ht.mediaController),ht.settings&&(we=ht.settings))}function Tt(ht,nn,Ln){var hr=arguments.length>3&&arguments[3]!==void 0?arguments[3]:NaN;if(ze||(ze=(0,B.default)(he).getInstance(),ze.setConfig({settings:we})),je||(je=(0,x.default)(he).getInstance()),!ze.supportsMediaSource()){je.error(new ge.default(Q.default.CAPABILITY_MEDIASOURCE_ERROR_CODE,Q.default.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE));return}lt||(lt=!0,nt=(0,Fe.default)(he).getInstance(),Wt||(Wt=(0,K.default)(he).getInstance(),Wt.setConfig({settings:we})),Ht||(Ht=(0,W.default)(he).getInstance()),Dt||(Dt=(0,E.default)(he).getInstance()),Et||(Et=(0,O.default)(he).getInstance()),dt||(dt=(0,T.default)(he).getInstance()),Ft||(Ft=(0,C.default)(he).getInstance()),Tn||(Tn=(0,R.default)(he).getInstance()),Kt||(Kt=(0,b.default)(he).getInstance()),on||(on=(0,F.default)(he).getInstance()),ct||(ct=(0,M.default)(he).getInstance()),We=(0,de.default)(he).getInstance(),ut=(0,w.default)(he).getInstance(),wt=(0,J.default)(he).getInstance(),Gt=(0,ee.default)(he).getInstance(),Ke=(0,xe.default)(he).getInstance({settings:we}),Dn=(0,ue.default)(he).getInstance({settings:we}),We.setConfig({constants:v.default,cea608parser:g(),errHandler:je,BASE64:De}),Oe||(Oe=(0,L.default)(he).create()),Oe.setConfig({adapter:We}),Kt.setConfig({adapter:We}),pn||(pn=(0,Me.default)(he).getInstance({dashMetrics:Ke,mediaPlayerModel:In,errHandler:je,baseURLController:Oe,events:ve.default,eventBus:Ue,debug:$e,boxParser:(0,V.default)(he).getInstance(),requestModifier:(0,I.default)(he).getInstance(),errors:Q.default})),Et.setConfig({domStorage:Dn,settings:we,customParametersModel:Ct}),In.setConfig({playbackController:Dt,serviceDescriptionController:Kt}),on.setConfig({adapter:We,errHandler:je,dashMetrics:Ke,mediaPlayerModel:In,manifestModel:ut,abrController:Wt,eventBus:Ue,requestModifier:(0,I.default)(he).getInstance()}),xa(),ji(Ln!==void 0?Ln:!0),gd()),ht&&Ca(ht),nn&&Da(nn,hr),mt.info("[dash.js "+Nn()+"] MediaPlayer has been initialized")}function Xt(){Da(null),Ca(null),Pt=null,St&&(St.reset(),St=null),Ut&&(Ut.reset(),Ut=null),Ct&&Ct.reset(),we.reset(),Zt&&(Zt.reset(),Zt=null)}function et(){Xt(),Z.default.deleteSingletonInstances(he)}function gt(){return!!pt&&!!Qt.getElement()}function At(ht,nn,Ln,hr){Ue.on(ht,nn,Ln,hr)}function en(ht,nn,Ln){Ue.off(ht,nn,Ln)}function Nn(){return(0,Se.getVersionString)()}function _n(){return $e}function En(){if(Qt.getElement()||Ye)return!1;if(pt)Zc();else throw Ce}function mr(){if(!st)throw ne;(!Nt||Mt()&&st)&&Dt.play(!0)}function jn(){if(!st)throw ne;Dt.pause()}function Mt(){if(!st)throw ne;return Dt.isPaused()}function gn(ht){if(!st)throw ne;if((0,pe.checkParameterType)(ht,"number"),isNaN(ht))throw v.default.BAD_ARGUMENT_ERROR;ht<0&&(ht=0);var nn=Dt.getIsDynamic()?Mi(ht):ht,Ln=Kr();!Dt.getIsDynamic()&&Ln.duration&&(nn=Math.min(Ln.duration,nn)),Dt.seek(nn,!1,!1,!0)}function cn(){!st||!vt()||Dt.seekToOriginalLive()}function tt(){if(!st)throw ne;return Dt.isSeeking()}function vt(){if(!st)throw ne;return Dt.getIsDynamic()}function He(){if(!st)throw ne;return Dt.getLowLatencyModeEnabled()}function ft(ht){Kr().playbackRate=ht}function $t(){return Kr().playbackRate}function vn(ht){(0,pe.checkParameterType)(ht,"boolean"),Kr().muted=ht}function yn(){return Kr().muted}function On(ht){if(typeof ht!="number"||isNaN(ht)||ht<0||ht>1)throw v.default.BAD_ARGUMENT_ERROR;Kr().volume=ht}function nr(){return Kr().volume}function Un(ht){var nn=[v.default.VIDEO,v.default.AUDIO,v.default.TEXT];if(ht)if(nn.indexOf(ht)!==-1){var hr=Cn().getCurrentBufferLevel(ht);return hr||NaN}else return mt.warn("getBufferLength requested for invalid type"),NaN;else{var Ln=nn.map(function(wr){return Yc(wr).length>0?Cn().getCurrentBufferLevel(wr):Number.MAX_VALUE}).reduce(function(wr,il){return Math.min(wr,il)});return Ln===Number.MAX_VALUE?NaN:Ln}}function Br(){var ht=dt&&dt.hasVideoTrack()?v.default.VIDEO:v.default.AUDIO,nn=Ke.getCurrentDVRInfo(ht);return nn?nn.manifestInfo.dvrWindowSize:0}function Mi(ht){var nn=dt&&dt.hasVideoTrack()?v.default.VIDEO:v.default.AUDIO,Ln=Ke.getCurrentDVRInfo(nn);if(!Ln)return 0;var hr=Dt.getOriginalLiveDelay(),wr=Ln.range.start+ht;return wr>Ln.range.end-hr&&(wr=Ln.range.end-hr),wr}function Bi(){if(!st)throw ne;return Dt.getOriginalLiveDelay()}function li(ht){if(!st)throw ne;var nn=Kr().currentTime;if(ht!==void 0)nn=dt.getTimeRelativeToStreamId(nn,ht);else if(Dt.getIsDynamic()){var Ln=dt&&dt.hasVideoTrack()?v.default.VIDEO:v.default.AUDIO,hr=Ke.getCurrentDVRInfo(Ln);nn=hr===null||nn===0?0:Math.max(0,nn-hr.range.start)}return nn}function Xs(){if(!st)throw ne;var ht=Kr().duration;if(Dt.getIsDynamic()){var nn=dt&&dt.hasVideoTrack()?v.default.VIDEO:v.default.AUDIO,Ln=Ke.getCurrentDVRInfo(nn);ht=Ln?Ln.range.end-Ln.range.start:0}return ht}function Sa(){if(!st)throw ne;return li()<0?NaN:Xl(li())}function Zo(){if(!st)throw ne;return Xl(Xs())}function bs(ht){if(!Ye)throw z;return Wt.getTopBitrateInfoFor(ht)}function Aa(ht){if(!Ye)throw z;if(ht===v.default.IMAGE){var nn=Ao();if(!nn)return-1;var Ln=nn.getThumbnailController();return Ln?Ln.getCurrentTrackIndex():-1}return Wt.getQualityFor(ht)}function Ds(ht,nn){var Ln=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!Ye)throw z;if(ht===v.default.IMAGE){var hr=Ao();if(!hr)return;var wr=hr.getThumbnailController();wr&&wr.setTrackByIndex(nn)}Wt.setPlaybackQuality(ht,dt.getActiveStreamInfo(),nn,{forceReplace:Ln})}function qs(){Wt.setElementSize(),Wt.setWindowResizeEventCalled(!0)}function ji(ht){(0,pe.checkParameterType)(ht,"boolean"),Nt=ht}function Gl(){return Nt}function Eo(){if(!lt)throw Pe;return st?Dt.getCurrentLiveLatency():NaN}function Wi(ht,nn,Ln){Ct.addAbrCustomRule(ht,nn,Ln)}function el(ht){Ct.removeAbrCustomRule(ht)}function Hi(){Ct.removeAllAbrCustomRule()}function er(){return Ct.getAbrCustomRules()}function Ii(ht,nn){Ct.addUTCTimingSource(ht,nn)}function _o(ht,nn){Ct.removeUTCTimingSource(ht,nn)}function To(){Ct.clearDefaultUTCTimingSources()}function xa(){Ct.restoreDefaultUTCTimingSources()}function at(ht){var nn=Wt.getThroughputHistory(),Ln=Dt.getIsDynamic();return nn?nn.getAverageThroughput(ht,Ln):0}function Rt(ht,nn){Ct.setXHRWithCredentialsForType(ht,nn)}function an(ht){return Ct.getXHRWithCredentialsForType(ht)}function Rn(){return gd()}function Cn(){return Ke}function Xn(ht){var nn=dt.getActiveStreamInfo();return!nn||!bt?!1:bt.enableText(nn.id,ht)}function ar(ht){var nn=dt.getActiveStreamInfo();return!nn||!bt?!1:bt.enableForcedTextStreaming(ht)}function hi(){var ht=dt.getActiveStreamInfo();return!ht||!bt?!1:bt.isTextEnabled(ht)}function ti(ht){if(!st)throw ne;var nn=dt.getActiveStreamInfo();!nn||!bt||bt.setTextTrack(nn.id,ht)}function qi(){var ht=NaN,nn=dt.getActiveStreamInfo();if(!(!nn||!bt))return ht=bt.getCurrentTrackIdx(nn.id),ht}function Kr(){if(!Qt.getElement())throw fe;return Qt.getElement()}function Ca(ht){if(!lt)throw Pe;Qt.setElement(ht),ht&&(Jc(),hd(),pd(),dt&&dt.switchToVideoElement()),st&&qc(),Zc()}function Ia(){return Qt?Qt.getTTMLRenderingDiv():null}function Xa(ht){if(!Qt.getElement())throw fe;Qt.setTTMLRenderingDiv(ht)}function zc(ht){if(!Qt.getElement())throw fe;Qt.setVttRenderingDiv(ht)}function Wl(ht){if(!Ye)throw z;var nn=Ao();return nn?nn.getBitrateListFor(ht):[]}function Hl(ht){if(!Ye)throw z;return We.getStreamsInfo(ht)}function Yc(ht){if(!Ye)throw z;var nn=dt.getActiveStreamInfo();return nn?Et.getTracksFor(ht,nn.id):[]}function Vl(ht,nn,Ln){if(!Ye)throw z;return Ln=Ln||We.getStreamsInfo(nn,1)[0],Ln?We.getAllMediaInfoForType(Ln,ht,nn):[]}function tl(ht){if(!Ye)throw z;var nn=dt.getActiveStreamInfo();return Et.getCurrentTrackFor(ht,nn.id)}function Ra(ht,nn){if(!lt)throw Pe;Et.setInitialSettings(ht,nn)}function Hu(ht){if(!lt)throw Pe;return Et.getInitialSettings(ht)}function ui(ht){if(!Ye)throw z;Et.setTrack(ht)}function Qi(ht){Ct.registerCustomCapabilitiesFilter(ht)}function Vi(ht){Ct.unregisterCustomCapabilitiesFilter(ht)}function ld(ht){Ct.setCustomInitialTrackSelectionFunction(ht)}function ba(){Ct.resetCustomInitialTrackSelectionFunction(null)}function $l(ht){Ct.registerLicenseRequestFilter(ht)}function xp(ht){Ct.registerLicenseResponseFilter(ht)}function Cp(ht){Ct.unregisterLicenseRequestFilter(ht)}function Vu(ht){Ct.unregisterLicenseResponseFilter(ht)}function Xc(){return Jc()}function nl(ht){St=ht}function So(ht){Pt=ht,dt&&dt.setProtectionData(Pt)}function Hr(ht,nn){if(typeof nn=="function"){if(ht<0){nn(null);return}var Ln=Dt.getIsDynamic()?Mi(ht):ht,hr=dt.getStreamForTime(Ln);if(hr===null){nn(null);return}var wr=hr.getThumbnailController();if(!wr){nn(null);return}return wr.provide(Ln,nn)}}function Ps(ht,nn){var Ln=Qc(),hr=this,wr=function il(sl){sl.error?nn(null,sl.error):nn(sl.manifest),Ue.off(ve.default.INTERNAL_MANIFEST_LOADED,il,hr),Ln.reset()};Ue.on(ve.default.INTERNAL_MANIFEST_LOADED,wr,hr),sn.initialize(ht),Ln.load(ht)}function kn(){if(!pt)throw Ce;return pt}function vs(ht){pt=ht,dt.load(pt)}function Da(ht){var nn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NaN;if(!lt)throw Pe;typeof ht=="string"&&sn.initialize(ht),nn==null&&(nn=NaN),isNaN(nn)||(nn=Math.max(0,nn)),pt=ht,(Ye||st)&&qc(),gt()&&Zc(nn)}function Pa(){return we.get()}function zl(ht){we.update(ht)}function Yl(){we.reset()}function ud(ht,nn,Ln){var hr=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,wr=new Date(ht*1e3),il=wr.toLocaleDateString(nn),sl=wr.toLocaleTimeString(nn,{hour12:Ln});return hr?sl+" "+il:sl}function pi(ht){ht=Math.max(ht,0);var nn=Math.floor(ht/3600),Ln=Math.floor(ht%3600/60),hr=Math.floor(ht%3600%60);return(nn===0?"":nn<10?"0"+nn.toString()+":":nn.toString()+":")+(Ln<10?"0"+Ln.toString():Ln.toString())+":"+(hr<10?"0"+hr.toString():hr.toString())}function cd(ht,nn,Ln){Z.default.extend(ht,nn,Ln,he)}function Ao(){if(!Ye)throw z;var ht=dt.getActiveStreamInfo();return ht?dt.getStreamById(ht.id):null}function rl(){return We}function fd(){if(on)return on.loadSteeringData()}function dd(){if(on)return on.getCurrentSteeringResponseData()}function qc(){st=!1,Ye=!1,We.reset(),dt.reset(),Ft.reset(),Tn.reset(),Dt.reset(),Kt.reset(),on.reset(),Wt.reset(),Et.reset(),pn.reset(),St&&(we.get().streaming.protection.keepProtectionMediaKeys?St.stop():(St.reset(),St=null,Jc())),bt.reset(),wt.reset(),Gt.reset()}function Ip(){var ht=Qc();dt||(dt=(0,T.default)(he).getInstance()),bt||(bt=(0,j.default)(he).create({errHandler:je,manifestModel:ut,adapter:We,mediaController:Et,videoModel:Qt,settings:we})),ct.setConfig({capabilities:ze,customParametersModel:Ct,adapter:We,settings:we,manifestModel:ut,errHandler:je}),dt.setConfig({capabilities:ze,capabilitiesFilter:ct,manifestLoader:ht,manifestModel:ut,mediaPlayerModel:In,customParametersModel:Ct,protectionController:St,textController:bt,adapter:We,dashMetrics:Ke,errHandler:je,timelineConverter:nt,videoModel:Qt,playbackController:Dt,serviceDescriptionController:Kt,contentSteeringController:on,abrController:Wt,mediaController:Et,settings:we,baseURLController:Oe,uriFragmentModel:sn,segmentBaseController:pn}),Ft.setConfig({settings:we,playbackController:Dt,streamController:dt,videoModel:Qt,timelineConverter:nt,adapter:We}),Dt.setConfig({streamController:dt,serviceDescriptionController:Kt,dashMetrics:Ke,adapter:We,videoModel:Qt,timelineConverter:nt,settings:we}),Tn.setConfig({streamController:dt,playbackController:Dt,mediaPlayerModel:In,videoModel:Qt,settings:we}),Wt.setConfig({streamController:dt,domStorage:Dn,mediaPlayerModel:In,customParametersModel:Ct,cmsdModel:Gt,dashMetrics:Ke,adapter:We,videoModel:Qt,settings:we}),wt.setConfig({abrController:Wt,dashMetrics:Ke,playbackController:Dt}),Gt.setConfig({}),Wt.initialize(),dt.initialize(Nt,Pt),bt.initialize(),Ft.initialize(),Tn.initialize(),wt.initialize(),Gt.initialize(),on.initialize(),pn.initialize()}function Qc(){return(0,D.default)(he).create({debug:$e,errHandler:je,dashMetrics:Ke,mediaPlayerModel:In,requestModifier:(0,I.default)(he).getInstance(),mssHandler:Vt,settings:we})}function Jc(){if(St)return St;var ht=dashjs.Protection;if(typeof ht=="function"){var nn=ht(he).create();return ve.default.extend(ht.events),_e.default.extend(ht.events,{publicOnly:!0}),Q.default.extend(ht.errors),ze||(ze=(0,B.default)(he).getInstance()),St=nn.createProtectionSystem({debug:$e,errHandler:je,videoModel:Qt,customParametersModel:Ct,capabilities:ze,eventBus:Ue,events:ve.default,BASE64:De,constants:v.default,cmcdModel:wt,settings:we}),St}return null}function hd(){if(!Ut){var ht=dashjs.MetricsReporting;if(typeof ht=="function"){var nn=ht(he).create();Ut=nn.createMetricsReporting({debug:$e,eventBus:Ue,mediaElement:Kr(),adapter:We,dashMetrics:Ke,mediaPlayerModel:In,events:ve.default,constants:v.default,metricsConstants:S.default})}}}function pd(){if(!Vt){var ht=dashjs.MssHandler;typeof ht=="function"&&(Q.default.extend(ht.errors),Vt=ht(he).create({eventBus:Ue,mediaPlayerModel:In,dashMetrics:Ke,manifestModel:ut,playbackController:Dt,streamController:dt,protectionController:St,baseURLController:Oe,errHandler:je,events:ve.default,constants:v.default,debug:$e,initSegmentType:Le.HTTPRequest.INIT_SEGMENT_TYPE,BASE64:De,ISOBoxer:Ae,settings:we}))}}function gd(){if(!lt)throw Pe;if(Zt)return Zt;var ht=dashjs.OfflineController;if(typeof ht=="function"){ve.default.extend(ht.events),_e.default.extend(ht.events,{publicOnly:!0}),Q.default.extend(ht.errors);var nn=Qc(),Ln=(0,Re.default)(he).create();return Ln.setConfig({manifestModel:ut,adapter:We,manifestLoader:nn,errHandler:je}),Zt=ht(he).create({debug:$e,manifestUpdater:Ln,baseURLController:Oe,manifestLoader:nn,manifestModel:ut,mediaPlayerModel:In,abrController:Wt,playbackController:Dt,adapter:We,errHandler:je,dashMetrics:Ke,timelineConverter:nt,segmentBaseController:pn,schemeLoaderFactory:Ht,eventBus:Ue,events:ve.default,errors:Q.default,constants:v.default,settings:we,dashConstants:_.default,urlUtils:(0,me.default)(he).getInstance()}),Zt}return null}function Xl(ht){var nn=dt&&dt.hasVideoTrack()?v.default.VIDEO:v.default.AUDIO,Ln=Ke.getCurrentDVRInfo(nn),hr,wr;return Ln?(hr=Ln.manifestInfo.availableFrom.getTime()/1e3,wr=ht+(hr+Ln.range.start),wr):0}function Zc(){var ht=arguments.length>0&&arguments[0]!==void 0?arguments[0]:NaN;Zt&&Zt.resetRecords(),!Ye&&pt&&(Ye=!0,mt.info("Streaming Initialized"),Ip(),typeof pt=="string"?dt.load(pt,ht):dt.loadWithManifest(pt,ht)),!st&&gt()&&(st=!0,mt.info("Playback Initialized"))}return it={initialize:Tt,setConfig:Be,on:At,off:en,extend:cd,attachView:Ca,attachSource:Da,isReady:gt,preload:En,play:mr,isPaused:Mt,pause:jn,isSeeking:tt,isDynamic:vt,getLowLatencyModeEnabled:He,seek:gn,seekToOriginalLive:cn,setPlaybackRate:ft,getPlaybackRate:$t,setMute:vn,isMuted:yn,setVolume:On,getVolume:nr,time:li,duration:Xs,timeAsUTC:Sa,durationAsUTC:Zo,getActiveStream:Ao,getDVRWindowSize:Br,getDVRSeekOffset:Mi,getTargetLiveDelay:Bi,convertToTimeCode:pi,formatUTC:ud,getVersion:Nn,getDebug:_n,getBufferLength:Un,getTTMLRenderingDiv:Ia,getVideoElement:Kr,getSource:kn,updateSource:vs,getCurrentLiveLatency:Eo,getTopBitrateInfoFor:bs,setAutoPlay:ji,getAutoPlay:Gl,getDashMetrics:Cn,getQualityFor:Aa,setQualityFor:Ds,updatePortalSize:qs,enableText:Xn,enableForcedTextStreaming:ar,isTextEnabled:hi,setTextTrack:ti,getBitrateInfoListFor:Wl,getStreamsFromManifest:Hl,getTracksFor:Yc,getTracksForTypeFromManifest:Vl,getCurrentTrackFor:tl,setInitialMediaSettingsFor:Ra,getInitialMediaSettingsFor:Hu,setCurrentTrack:ui,addABRCustomRule:Wi,removeABRCustomRule:el,removeAllABRCustomRule:Hi,getABRCustomRules:er,getAverageThroughput:at,retrieveManifest:Ps,addUTCTimingSource:Ii,removeUTCTimingSource:_o,clearDefaultUTCTimingSources:To,restoreDefaultUTCTimingSources:xa,setXHRWithCredentialsForType:Rt,getXHRWithCredentialsForType:an,getProtectionController:Xc,attachProtectionController:nl,setProtectionData:So,registerLicenseRequestFilter:$l,registerLicenseResponseFilter:xp,unregisterLicenseRequestFilter:Cp,unregisterLicenseResponseFilter:Vu,registerCustomCapabilitiesFilter:Qi,unregisterCustomCapabilitiesFilter:Vi,setCustomInitialTrackSelectionFunction:ld,resetCustomInitialTrackSelectionFunction:ba,attachTTMLRenderingDiv:Xa,attachVttRenderingDiv:zc,getCurrentTextTrackIndex:qi,provideThumbnail:Hr,getDashAdapter:rl,getOfflineController:Rn,triggerSteeringRequest:fd,getCurrentSteeringResponseData:dd,getSettings:Pa,updateSettings:zl,resetSettings:Yl,reset:Xt,destroy:et},sr(),it}re.__dashjs_factory_name="MediaPlayer";var oe=Z.default.getClassFactory(re);oe.events=_e.default,oe.errors=Q.default,Z.default.updateClassFactory(re.__dashjs_factory_name,oe);const X=oe},"./src/streaming/MediaPlayerEvents.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/core/events/EventsBase.js");function g(D){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(B){return typeof B}:g=function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},g(D)}function v(D,x){if(!(D instanceof x))throw new TypeError("Cannot call a class as a function")}function _(D,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");D.prototype=Object.create(x&&x.prototype,{constructor:{value:D,writable:!0,configurable:!0}}),x&&S(D,x)}function S(D,x){return S=Object.setPrototypeOf||function(M,I){return M.__proto__=I,M},S(D,x)}function E(D){var x=R();return function(){var M=b(D),I;if(x){var U=b(this).constructor;I=Reflect.construct(M,arguments,U)}else I=M.apply(this,arguments);return T(this,I)}}function T(D,x){return x&&(g(x)==="object"||typeof x=="function")?x:C(D)}function C(D){if(D===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D}function R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(D){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)},b(D)}var F=function(D){_(B,D);var x=E(B);function B(){var M;return v(this,B),M=x.call(this),M.AST_IN_FUTURE="astInFuture",M.BUFFER_EMPTY="bufferStalled",M.BUFFER_LOADED="bufferLoaded",M.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",M.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",M.DYNAMIC_TO_STATIC="dynamicToStatic",M.ERROR="error",M.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",M.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",M.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",M.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",M.LOG="log",M.MANIFEST_LOADED="manifestLoaded",M.METRICS_CHANGED="metricsChanged",M.METRIC_CHANGED="metricChanged",M.METRIC_ADDED="metricAdded",M.METRIC_UPDATED="metricUpdated",M.PERIOD_SWITCH_STARTED="periodSwitchStarted",M.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",M.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",M.QUALITY_CHANGE_RENDERED="qualityChangeRendered",M.TRACK_CHANGE_RENDERED="trackChangeRendered",M.STREAM_INITIALIZING="streamInitializing",M.STREAM_UPDATED="streamUpdated",M.STREAM_ACTIVATED="streamActivated",M.STREAM_DEACTIVATED="streamDeactivated",M.STREAM_INITIALIZED="streamInitialized",M.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",M.TEXT_TRACKS_ADDED="allTextTracksAdded",M.TEXT_TRACK_ADDED="textTrackAdded",M.TTML_PARSED="ttmlParsed",M.TTML_TO_PARSE="ttmlToParse",M.CAPTION_RENDERED="captionRendered",M.CAPTION_CONTAINER_RESIZE="captionContainerResize",M.CAN_PLAY="canPlay",M.CAN_PLAY_THROUGH="canPlayThrough",M.PLAYBACK_ENDED="playbackEnded",M.PLAYBACK_ERROR="playbackError",M.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",M.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",M.PLAYBACK_LOADED_DATA="playbackLoadedData",M.PLAYBACK_PAUSED="playbackPaused",M.PLAYBACK_PLAYING="playbackPlaying",M.PLAYBACK_PROGRESS="playbackProgress",M.PLAYBACK_RATE_CHANGED="playbackRateChanged",M.PLAYBACK_SEEKED="playbackSeeked",M.PLAYBACK_SEEKING="playbackSeeking",M.PLAYBACK_STALLED="playbackStalled",M.PLAYBACK_STARTED="playbackStarted",M.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",M.PLAYBACK_VOLUME_CHANGED="playbackVolumeChanged",M.PLAYBACK_WAITING="playbackWaiting",M.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",M.EVENT_MODE_ON_START="eventModeOnStart",M.EVENT_MODE_ON_RECEIVE="eventModeOnReceive",M.CONFORMANCE_VIOLATION="conformanceViolation",M.REPRESENTATION_SWITCH="representationSwitch",M.ADAPTATION_SET_REMOVED_NO_CAPABILITIES="adaptationSetRemovedNoCapabilities",M.CONTENT_STEERING_REQUEST_COMPLETED="contentSteeringRequestCompleted",M}return B}(m.default),O=new F;const L=O},"./src/streaming/MediaPlayerFactory.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>C});var m=d("./src/streaming/MediaPlayer.js");function g(){var R="application/dash+xml",b;function F(D,x,B){if(!D||!/^VIDEO$/i.test(D.nodeName))return null;if(D._dashjs_player)return D._dashjs_player;var M,I=D.id||D.name||"video element";if(x=x||[].slice.call(D.querySelectorAll("source")).filter(function(U){return U.type==R})[0],!x&&D.src)x=document.createElement("source"),x.src=D.src;else if(!x&&!D.src)return null;return B=B||{},M=(0,m.default)(B).create(),M.initialize(D,x.src,D.autoplay),b||(b=M.getDebug().getLogger()),b.debug("Converted "+I+" to dash.js player and added content: "+x.src),D._dashjs_player=M,M}function O(D,x){var B=[];D=D||"[data-dashjs-player]",x=x||document;for(var M=x.querySelectorAll(D),I=0;I<M.length;I++){var U=F(M[I],null);B.push(U)}for(var w=x.querySelectorAll('source[type="'+R+'"]'),k=0;k<w.length;k++){var K=L(w[k]),W=F(K,null);B.push(W)}return B}function L(D){return/^VIDEO$/i.test(D.nodeName)?D:L(D.parentNode)}return{create:F,createAll:O}}var v=g(),_;function S(){window.removeEventListener("load",S),v.createAll()}function E(){window.dashjs&&(window.clearInterval(_),v.createAll())}var T=typeof window<"u"&&window&&window.dashjs&&window.dashjs.skipAutoCreate;!T&&typeof window<"u"&&window&&window.addEventListener&&(window.document.readyState==="complete"?window.dashjs?v.createAll():_=window.setInterval(E,500):window.addEventListener("load",S));const C=v},"./src/streaming/PreBufferSink.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/core/Debug.js"),g=d("./src/core/FactoryMaker.js");function v(E){var T=this.context,C,R,b,F=[],O=E;function L(){R=(0,m.default)(T).getInstance().getLogger(C)}function D(){F=[],b=null,O=null}function x(Y){return Y.segmentType!=="InitializationSegment"?(F.push(Y),F.sort(function(J,ee){return J.start-ee.start}),b=null):b=Y,R.debug("PreBufferSink appended chunk s: "+Y.start+"; e: "+Y.end),O&&O({chunk:Y}),Promise.resolve()}function B(Y,J){return F=F.filter(function(ee){return!((isNaN(J)||ee.start<J)&&(isNaN(Y)||ee.end>Y))}),Promise.resolve()}function M(){return Promise.resolve()}function I(){for(var Y=[],J=0;J<F.length;J++){var ee=F[J];Y.length===0||ee.start>Y[Y.length-1].end?Y.push({start:ee.start,end:ee.end}):Y[Y.length-1].end=ee.end}var ue={start:function(Q){return Y[Q].start},end:function(Q){return Y[Q].end}};return Object.defineProperty(ue,"length",{get:function(){return Y.length}}),ue}function U(){return Promise.resolve()}function w(){return this}function k(Y,J){var ee=K(Y,J);return b&&(ee.push(b),b=null),B(Y,J),ee}function K(Y,J){return F.filter(function(ee){return(isNaN(J)||ee.start<J)&&(isNaN(Y)||ee.end>Y)})}function W(Y){Y()}return C={getAllBufferRanges:I,append:x,remove:B,abort:M,discharge:k,reset:D,updateTimestampOffset:U,waitForUpdateEnd:W,getBuffer:w},L(),C}v.__dashjs_factory_name="PreBufferSink";var _=g.default.getClassFactory(v);const S=_},"./src/streaming/SourceBufferSink.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>D});var m=d("./src/core/Debug.js"),g=d("./src/streaming/vo/DashJSError.js"),v=d("./src/core/FactoryMaker.js"),_=d("./src/core/errors/Errors.js"),S=d("./src/core/Settings.js"),E=d("./src/streaming/constants/Constants.js"),T=d("./src/streaming/vo/metrics/HTTPRequest.js"),C=d("./src/core/events/Events.js"),R=.1,b=.01,F=50;function O(x){var B=this.context,M=(0,S.default)(B).getInstance(),I=x.textController,U=x.eventBus,w,k,K,W,Y,J,ee=[],ue=[],ie=!1,Q=x.mediaSource,se=null;function ve(){K=(0,m.default)(B).getInstance().getLogger(w)}function _e(fe,Ce,Pe){Y=fe,k=Y.type;var he=Y.codec;Ee(Pe),de();var Ue=[];return Ue.push(me()),Ue.push(Le(Y.streamInfo)),Ue.push(Z(he)),Ce&&Ce.MSETimeOffset!==void 0&&Ue.push(De(Ce.MSETimeOffset)),Promise.all(Ue)}function Z(fe){return new Promise(function(Ce){ne(function(){W.changeType&&W.changeType(fe),Ce()})})}function Ee(fe){W=fe.getBuffer()}function Se(fe,Ce,Pe){Y=Ce,k=Y.type;var he=Y.codec;try{if(he.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))return Me(fe);W=Q.addSourceBuffer(he),de();var Ue=[];return Ue.push(Le(Y.streamInfo)),Pe&&Pe.MSETimeOffset!==void 0&&Ue.push(De(Pe.MSETimeOffset)),Promise.all(Ue)}catch(we){return Y.type==E.default.TEXT&&!Y.isFragmented||he.indexOf('codecs="stpp')!==-1||he.indexOf('codecs="vtt')!==-1?Me(fe):Promise.reject(we)}}function Me(fe){return W=I.getTextSourceBuffer(fe),Promise.resolve()}function de(){if(typeof W.addEventListener=="function")try{W.addEventListener("updateend",oe,!1),W.addEventListener("error",X,!1),W.addEventListener("abort",X,!1)}catch{J=setInterval(oe,F)}else J=setInterval(oe,F)}function xe(){return k}function Fe(){try{typeof W.removeEventListener=="function"&&(W.removeEventListener("updateend",oe,!1),W.removeEventListener("error",X,!1),W.removeEventListener("abort",X,!1)),clearInterval(J)}catch(fe){K.error(fe)}}function Le(fe){return new Promise(function(Ce){if(!W||!M.get().streaming.buffer.useAppendWindow){Ce();return}ne(function(){try{if(!W){Ce();return}var Pe=Q.duration,he=0;fe&&!isNaN(fe.start)&&!isNaN(fe.duration)&&isFinite(fe.duration)&&(Pe=fe.start+fe.duration),fe&&!isNaN(fe.start)&&(he=fe.start),(W.appendWindowEnd!==Pe||W.appendWindowStart!==he)&&(W.appendWindowStart=0,W.appendWindowEnd=Pe+b,W.appendWindowStart=Math.max(he-R,0),K.debug("Updated append window for ".concat(Y.type,". Set start to ").concat(W.appendWindowStart," and end to ").concat(W.appendWindowEnd))),Ce()}catch{K.warn("Failed to set append window"),Ce()}})})}function De(fe){return new Promise(function(Ce){if(!W){Ce();return}ne(function(){try{W.timestampOffset!==fe&&!isNaN(fe)&&(W.timestampOffset=fe,K.debug("Set MSE timestamp offset to ".concat(fe))),Ce()}catch{Ce()}})})}function Ae(){if(W){try{ee=[],Fe(),ie=!1,ue=[],(!W.getClassName||W.getClassName()!=="TextSourceBuffer")&&(K.debug("Removing sourcebuffer from media source"),Q.removeSourceBuffer(W))}catch{}W=null}se=null}function ge(){return W}function pe(){try{return W.buffered}catch(fe){return K.error("getAllBufferRanges exception: "+fe.message),null}}function Re(fe){var Ce=this,Pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return new Promise(function(he,Ue){if(!fe){Ue({chunk:fe,error:new g.default(_.default.APPEND_ERROR_CODE,_.default.APPEND_ERROR_MESSAGE)});return}ue.push({data:fe,promise:{resolve:he,reject:Ue},request:Pe}),ne(j.bind(Ce))})}function me(){return new Promise(function(fe){ne(function(){var Ce=W.appendWindowStart,Pe=W.appendWindowEnd;W&&(W.abort(),W.appendWindowStart=Ce,W.appendWindowEnd=Pe),fe()})})}function V(fe){return new Promise(function(Ce,Pe){var he=fe.start,Ue=fe.end;if(!(he>=0&&Ue>he)){Ce();return}ne(function(){try{W.remove(he,Ue),ne(function(){Ce({from:he,to:Ue,unintended:!1}),fe.resolve&&fe.resolve()})}catch(we){Pe({from:he,to:Ue,unintended:!1,error:new g.default(_.default.REMOVE_ERROR_CODE,_.default.REMOVE_ERROR_MESSAGE)}),fe.reject&&fe.reject(we)}})})}function j(){if(!ie&&ue.length>0){ie=!0;var fe=ue[0];ue.splice(0,1);var Ce=function(){ie=!1,ue.length>0&&j.call(this),fe&&fe.data&&fe.data.segmentType&&fe.data.segmentType!==T.HTTPRequest.INIT_SEGMENT_TYPE&&delete fe.data.bytes,fe.promise.resolve({chunk:fe.data})};try{se=fe.request,fe.data.bytes.byteLength===0?Ce.call(this):(W.appendBuffer?W.appendBuffer(fe.data.bytes):W.append(fe.data.bytes,fe.data),ne(Ce.bind(this)))}catch(Pe){K.fatal('SourceBuffer append failed "'+Pe+'"'),ue.length>0?j():ie=!1,delete fe.data.bytes,fe.promise.reject({chunk:fe.data,error:new g.default(Pe.code,Pe.message)})}}}function $(){return new Promise(function(fe){try{ue=[],Q.readyState==="open"?ne(function(){try{W&&W.abort(),fe()}catch{fe()}}):(W&&W.setTextTrack&&Q.readyState==="ended"&&W.abort(),fe())}catch{fe()}})}function re(){if(ee.length>0&&!W.updating){var fe=ee.shift();fe(),re()}}function oe(){W.updating||re()}function X(fe){var Ce=fe.target||{};z(C.default.SOURCE_BUFFER_ERROR,{error:Ce,lastRequestAppended:se})}function z(fe,Ce){var Pe=Ce||{};U.trigger(fe,Pe,{streamId:Y.streamInfo.id,mediaType:k})}function ne(fe){ee.push(fe),W.updating||re()}return w={getType:xe,getAllBufferRanges:pe,getBuffer:ge,append:Re,remove:V,abort:$,reset:Ae,updateTimestampOffset:De,initializeForStreamSwitch:_e,initializeForFirstUse:Se,updateAppendWindow:Le,changeType:Z},ve(),w}O.__dashjs_factory_name="SourceBufferSink";var L=v.default.getClassFactory(O);const D=L},"./src/streaming/Stream.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>M});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/dash/constants/DashConstants.js"),v=d("./src/streaming/StreamProcessor.js"),_=d("./src/streaming/controllers/FragmentController.js"),S=d("./src/streaming/thumbnail/ThumbnailController.js"),E=d("./src/core/EventBus.js"),T=d("./src/core/events/Events.js"),C=d("./src/core/Debug.js"),R=d("./src/core/errors/Errors.js"),b=d("./src/core/FactoryMaker.js"),F=d("./src/streaming/vo/DashJSError.js"),O=d("./src/streaming/utils/BoxParser.js"),L=d("./src/streaming/utils/URLUtils.js"),D=d("./src/streaming/controllers/BlacklistController.js"),x=[m.default.VIDEO,m.default.AUDIO,m.default.TEXT,m.default.MUXED,m.default.IMAGE];function B(I){I=I||{};var U=this.context,w=(0,E.default)(U).getInstance(),k=(0,L.default)(U).getInstance(),K=I.manifestModel,W=I.mediaPlayerModel,Y=I.dashMetrics,J=I.manifestUpdater,ee=I.adapter,ue=I.timelineConverter,ie=I.capabilities,Q=I.errHandler,se=I.abrController,ve=I.playbackController,_e=I.eventController,Z=I.mediaController,Ee=I.protectionController,Se=I.textController,Me=I.videoModel,de=I.streamInfo,xe=I.settings,Fe,Le,De,Ae,ge,pe,Re,me,V,j,$,re,oe,X,z,ne,fe,Ce;function Pe(){try{ne=(0,C.default)(U).getInstance(),Le=ne.getLogger(Fe),Zt(),z=(0,O.default)(U).getInstance(),oe=(0,D.default)(U).create({updateEventName:T.default.SEGMENT_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:T.default.SEGMENT_LOCATION_BLACKLIST_ADD}),$=(0,_.default)(U).create({streamInfo:de,mediaPlayerModel:W,dashMetrics:Y,errHandler:Q,settings:xe,boxParser:z,dashConstants:g.default,urlUtils:k})}catch(Mt){throw Mt}}function he(){Ue(),$e(),Se.initializeForStream(de),w.trigger(T.default.STREAM_UPDATED,{streamInfo:de})}function Ue(){w.on(T.default.BUFFERING_COMPLETED,Qt,Fe),w.on(T.default.DATA_UPDATE_COMPLETED,sn,Fe),w.on(T.default.INBAND_EVENTS,Dn,Fe)}function we(){w.off(T.default.DATA_UPDATE_COMPLETED,sn,Fe),w.off(T.default.BUFFERING_COMPLETED,Qt,Fe),w.off(T.default.INBAND_EVENTS,Dn,Fe)}function $e(){Ee&&(w.on(T.default.KEY_ERROR,on,Fe),w.on(T.default.SERVER_CERTIFICATE_UPDATED,on,Fe),w.on(T.default.LICENSE_REQUEST_COMPLETE,on,Fe),w.on(T.default.KEY_SYSTEM_SELECTED,on,Fe),w.on(T.default.KEY_SESSION_CREATED,on,Fe),w.on(T.default.KEY_STATUSES_CHANGED,on,Fe))}function it(){Ee&&(w.off(T.default.KEY_ERROR,on,Fe),w.off(T.default.SERVER_CERTIFICATE_UPDATED,on,Fe),w.off(T.default.LICENSE_REQUEST_COMPLETE,on,Fe),w.off(T.default.KEY_SYSTEM_SELECTED,on,Fe),w.off(T.default.KEY_SESSION_CREATED,on,Fe),w.off(T.default.KEY_STATUSES_CHANGED,on,Fe))}function mt(){return de?de.id:null}function pt(Mt,gn){return new Promise(function(cn,tt){if(ge){cn(gn);return}if(En()){ge=!0,w.trigger(T.default.STREAM_ACTIVATED,{streamInfo:de}),cn(gn);return}lt(Mt,gn).then(function(vt){ge=!0,w.trigger(T.default.STREAM_ACTIVATED,{streamInfo:de}),cn(vt)}).catch(function(vt){tt(vt)})})}function Pt(Mt,gn){return new Promise(function(cn,tt){if(En()){tt();return}Le.info("[startPreloading] Preloading next stream with id ".concat(ze())),_n(!0),Ye(Mt,gn).then(function(){for(var vt=0;vt<De.length&&De[vt];vt++)De[vt].setExplicitBufferingTime(Oe()),De[vt].getScheduleController().startScheduleTimer();cn()}).catch(function(){_n(!1),tt()})})}function lt(Mt,gn){return Ye(Mt,gn)}function Ye(Mt,gn){return new Promise(function(cn,tt){Dt(),j=!0,ut();var vt=Me.getElement();x.forEach(function(He){!(He===m.default.TEXT&&!Mt)&&(He!==m.default.VIDEO||!vt||vt&&/^VIDEO$/i.test(vt.nodeName))&&Nt(He,Mt)}),nt(gn).then(function(He){if(j=!1,De.length===0){var ft="No streams to play.";Q.error(new F.default(R.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,ft,K.getValue())),Le.fatal(ft)}else wt();Mt&&Se.createTracks(de),cn(He)}).catch(function(He){tt(He)})})}function st(Mt){return new Promise(function(gn,cn){Nt(m.default.TEXT,Mt),Et().then(function(){Se.createTracks(de),gn()}).catch(function(tt){cn(tt)})})}function Nt(Mt,gn){var cn=ee.getAllMediaInfoForType(de,Mt),tt=[],vt=null,He;if(!cn||cn.length===0){Le.info("No "+Mt+" data.");return}Mt===m.default.VIDEO&&(Re=!0),Mt===m.default.AUDIO&&(me=!0);for(var ft=0,$t=cn.length;ft<$t;ft++)vt=cn[ft],Mt===m.default.TEXT&&vt.isEmbedded&&(Se.addEmbeddedTrack(de,vt),tt.push(vt)),Wt(vt)&&Z.addTrack(vt);if(tt.length>0&&(Z.setInitialMediaSettingsForType(Mt,de),Se.addMediaInfosToBuffer(de,Mt,tt)),cn=cn.filter(function(yn){return!yn.isEmbedded}),cn.length!==0){if(Mt===m.default.IMAGE){re=(0,S.default)(U).create({streamInfo:de,adapter:ee,baseURLController:I.baseURLController,timelineConverter:I.timelineConverter,debug:ne,eventBus:w,events:T.default,dashConstants:g.default,dashMetrics:I.dashMetrics,segmentBaseController:I.segmentBaseController}),re.initialize();return}w.trigger(T.default.STREAM_INITIALIZING,{streamInfo:de,mediaInfo:vt}),Z.setInitialMediaSettingsForType(Mt,de);var vn=Ht(cn,gn);He=Z.getCurrentTrackFor(Mt,de.id),He&&(se.updateTopQualityIndex(He),vn.selectMediaInfo(Mt!==m.default.TEXT||!He.isEmbedded?He:cn[0]))}}function Wt(Mt){var gn=Mt?Mt.type:null,cn;return gn===m.default.MUXED?(cn="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",Le.fatal(cn),Q.error(new F.default(R.default.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,cn,K.getValue())),!1):gn===m.default.TEXT||gn===m.default.IMAGE?!0:Mt.contentProtection&&!ie.supportsEncryptedMedia()?(Q.error(new F.default(R.default.CAPABILITY_MEDIAKEYS_ERROR_CODE,R.default.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE)),!1):!0}function Ht(Mt,gn){var cn=Mt&&Mt.length>0?Mt[0]:null,tt=$.getModel(cn?cn.type:null),vt=cn?cn.type:null,He=cn?cn.mimeType:null,ft=cn?cn.isFragmented:null,$t=(0,v.default)(U).create({streamInfo:de,type:vt,mimeType:He,timelineConverter:ue,adapter:ee,manifestModel:K,mediaPlayerModel:W,fragmentModel:tt,dashMetrics:I.dashMetrics,baseURLController:I.baseURLController,segmentBaseController:I.segmentBaseController,abrController:se,playbackController:ve,mediaController:Z,textController:Se,errHandler:Q,settings:xe,boxParser:z,segmentBlacklistController:oe});$t.initialize(gn,Re,ft),De.push($t);for(var vn=0;vn<Mt.length;vn++)$t.addMediaInfo(Mt[vn]);return vt===m.default.TEXT&&Se.addMediaInfosToBuffer(de,vt,Mt,tt),$t}function nt(Mt){return new Promise(function(gn){var cn={},tt=De.map(function(vt){return vt.createBufferSinks(Mt)});Promise.all(tt).then(function(vt){vt.forEach(function(He){He&&(cn[He.getType()]=He)}),gn(cn)}).catch(function(){gn(cn)})})}function Et(){var Mt=sr(m.default.TEXT);return Mt?Mt.createBufferSinks():Promise.resolve()}function St(Mt){for(var gn=De?De.length:0,cn=!1,tt=0;tt<gn;tt++){var vt=De[tt].getFragmentModel();vt.abortRequests(),vt.resetInitialSettings(),De[tt].reset(cn,Mt)}Se&&Se.deactivateStream(de),De=[],ge=!1,pe=!1,_n(!1),je(!1),w.trigger(T.default.STREAM_DEACTIVATED,{streamInfo:de})}function Ut(){return ge}function Vt(Mt){return new Promise(function(gn,cn){for(var tt=[],vt=0;vt<De.length;)Wt(De[vt].getMediaInfo())?(tt.push(De[vt].setMediaSource(Mt)),vt++):(De[vt].reset(),De.splice(vt,1));Promise.all(tt).then(function(){for(var He=0;He<De.length;He++)De[He].dischargePreBuffer();if(De.length===0){var ft="No streams to play.";Q.error(new F.default(R.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,ft+"nostreams",K.getValue())),Le.fatal(ft)}gn()}).catch(function(He){Le.error(He),cn(He)})})}function Zt(Mt){St(Mt),Ae=!1,Re=!1,me=!1,V={},j=!1,fe=!1,Ce=[]}function We(Mt){$&&($.reset(),$=null),se&&de&&se.clearDataForStream(de.id),oe&&(oe.reset(),oe=null),Zt(Mt),de=null,we(),it()}function In(){return de?de.duration:NaN}function Ct(){return fe}function je(Mt){fe=Mt}function Oe(){return de?de.start:NaN}function ze(){return de?de.id:null}function ct(){return de}function dt(){return me}function bt(){return Re}function Ft(){return re}function Dt(){if(!Me||!se)throw new Error(m.default.MISSING_CONFIG_ERROR)}function Kt(Mt){if(Dt(),Mt===m.default.IMAGE)return re?re.getBitrateList():[];var gn=Gt(Mt);return se.getBitrateList(gn)}function on(Mt){Mt.error&&(Q.error(Mt.error),Le.fatal(Mt.error.message))}function Tn(Mt){if(!(!ge||!de)){pe=!1;var gn=Mt.newMediaInfo,cn=K.getValue();ee.setCurrentMediaInfo(de.id,gn.type,gn);var tt=pn(gn);if(tt){var vt=ve.getTime();Le.info("Stream -  Process track changed at current time "+vt),cn.refreshManifestOnSwitchTrack?(Ce.push(Mt),J.getIsUpdating()||(Le.debug("Stream -  Refreshing manifest for switch track"),J.refreshManifest())):tt.selectMediaInfo(gn).then(function(){(gn.type===m.default.VIDEO||gn.type===m.default.AUDIO)&&se.updateTopQualityIndex(gn),tt.prepareTrackSwitch()})}}}function Ke(Mt){var gn=sr(Mt.mediaType);gn&&gn.prepareQualityChange(Mt)}function ut(){if(_e){var Mt=ee.getEventsFor(de);Mt&&Mt.length>0&&_e.addInlineEvents(Mt,de.id)}}function wt(){for(var Mt=De.length,gn=!!V.audio||!!V.video,cn=gn?new F.default(R.default.DATA_UPDATE_FAILED_ERROR_CODE,R.default.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,tt=0;tt<Mt;tt++)if(De[tt].isUpdating()||j)return;if(Ee){Ee.clearMediaInfoArray();for(var vt=0;vt<Mt&&De[vt];vt++){var He=De[vt].getType(),ft=De[vt].getMediaInfo();if(He===m.default.AUDIO||He===m.default.VIDEO||He===m.default.TEXT&&ft.isFragmented){var $t=De[vt].getMediaInfo();$t&&Ee.initializeForMedia($t)}}Ee.handleKeySystemFromManifest()}cn?Q.error(cn):Ae||(Ae=!0,Me.waitForReadyState(m.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,function(){w.trigger(T.default.STREAM_INITIALIZED,{streamInfo:de})}))}function Gt(Mt){for(var gn=null,cn=0;cn<De.length;cn++)if(gn=De[cn],gn.getType()===Mt)return gn.getMediaInfo();return null}function Qt(){var Mt=Be(),gn=Mt.length;if(gn===0){Le.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined");return}for(var cn=0;cn<gn;cn++)if(!Mt[cn].isBufferingCompleted()&&(Mt[cn].getType()===m.default.AUDIO||Mt[cn].getType()===m.default.VIDEO)){Le.debug("onBufferingCompleted - One streamProcessor has finished but",Mt[cn].getType(),"one is not buffering completed");return}Le.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),pe=!0,w.trigger(T.default.STREAM_BUFFERING_COMPLETED,{streamInfo:de},{streamInfo:de})}function sn(Mt){V[Mt.mediaType]=Mt.error,wt()}function Dn(Mt){_e&&_e.addInbandEvents(Mt.events,de.id)}function pn(Mt){return!Mt||!Mt.type?null:sr(Mt.type)}function sr(Mt){if(!Mt)return null;var gn=Be();return gn.filter(function(cn){return cn.getType()===Mt})[0]}function Be(){for(var Mt=[],gn,cn,tt=0;tt<De.length;tt++)cn=De[tt],gn=cn.getType(),(gn===m.default.AUDIO||gn===m.default.VIDEO||gn===m.default.TEXT)&&Mt.push(cn);return Mt}function Tt(){for(var Mt=De.length,gn=0;gn<Mt&&De[gn];gn++)De[gn].getScheduleController().startScheduleTimer()}function Xt(Mt){return new Promise(function(gn){j=!0,de=Mt,_e&&ut();for(var cn=[],tt=0,vt=De.length;tt<vt;tt++){var He=De[tt],ft=He.getMediaInfo();cn.push(He.updateStreamInfo(de));var $t=ee.getAllMediaInfoForType(de,He.getType());if($t=$t.filter(function(On){return!On.isEmbedded}),$t){He.clearMediaInfoArray();for(var vn=0;vn<$t.length;vn++){var yn=$t[vn];He.addMediaInfo($t[vn]),ee.areMediaInfosEqual(ft,yn)&&(se.updateTopQualityIndex(yn),cn.push(He.selectMediaInfo(yn)))}}}Promise.all(cn).then(function(){for(cn=[];Ce.length>0;){var On=Ce.pop(),nr=On.newMediaInfo,Un=pn(On.oldMediaInfo);if(!Un)return;cn.push(Un.prepareTrackSwitch()),Un.selectMediaInfo(nr)}return Promise.all(cn)}).then(function(){j=!1,wt(),w.trigger(T.default.STREAM_UPDATED,{streamInfo:de}),gn()})})}function et(Mt){var gn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return Nn(Mt,m.default.VIDEO,gn)&&Nn(Mt,m.default.AUDIO,gn)}function gt(Mt){return Mt?At(m.default.VIDEO,Mt)&&At(m.default.AUDIO,Mt):!0}function At(Mt,gn){var cn=ct(),tt=gn.getStreamInfo();if(!tt||!cn)return!0;var vt=ee.getAdaptationForType(tt.index,Mt,tt),He=ee.getAdaptationForType(cn.index,Mt,cn);return!vt||!He?!vt&&!He:!(!en(He)&&en(vt))}function en(Mt){return Mt?!!(Mt.ContentProtection||Mt.Representation&&Mt.Representation.length>0&&Mt.Representation[0].ContentProtection):!1}function Nn(Mt,gn){var cn=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!Mt||!Mt.hasOwnProperty("getStreamInfo"))return!1;var tt=Mt.getStreamInfo(),vt=cn?cn.getStreamInfo():ct();if(!tt||!vt)return!1;var He=ee.getAdaptationForType(tt.index,gn,tt),ft=ee.getAdaptationForType(vt.index,gn,vt);if(!He||!ft)return!He&&!ft;var $t=He&&ft&&He.mimeType===ft.mimeType,vn=ft.Representation_asArray.map(function(Un){return Un.codecs}),yn=He.Representation_asArray.map(function(Un){return Un.codecs}),On=yn.some(function(Un){return vn.indexOf(Un)>-1}),nr=yn.some(function(Un){return vn.some(function(Br){return ie.codecRootCompatibleWithCodec(Br,Un)})});return On||nr&&$t}function _n(Mt){X=Mt}function En(){return X}function mr(){return pe}function jn(){return ee}return Fe={initialize:he,getStreamId:mt,activate:pt,deactivate:St,getIsActive:Ut,getDuration:In,getStartTime:Oe,getId:ze,getStreamInfo:ct,getHasAudioTrack:dt,getHasVideoTrack:bt,startPreloading:Pt,initializeForTextWithMediaSource:st,getThumbnailController:Ft,getBitrateListFor:Kt,updateData:Xt,reset:We,getProcessors:Be,setMediaSource:Vt,isMediaCodecCompatible:et,isProtectionCompatible:gt,getPreloaded:En,getIsEndedEventSignaled:Ct,setIsEndedEventSignaled:je,getAdapter:jn,getHasFinishedBuffering:mr,setPreloaded:_n,startScheduleControllers:Tt,prepareTrackChange:Tn,prepareQualityChange:Ke},Pe(),Fe}B.__dashjs_factory_name="Stream";const M=b.default.getClassFactory(B)},"./src/streaming/StreamProcessor.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>Y});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/dash/constants/DashConstants.js"),v=d("./src/streaming/constants/MetricsConstants.js"),_=d("./src/streaming/models/FragmentModel.js"),S=d("./src/streaming/controllers/BufferController.js"),E=d("./src/streaming/text/NotFragmentedTextBufferController.js"),T=d("./src/streaming/controllers/ScheduleController.js"),C=d("./src/dash/controllers/RepresentationController.js"),R=d("./src/core/FactoryMaker.js"),b=d("./src/streaming/utils/SupervisorTools.js"),F=d("./src/core/EventBus.js"),O=d("./src/core/events/Events.js"),L=d("./src/dash/DashHandler.js"),D=d("./src/core/errors/Errors.js"),x=d("./src/streaming/vo/DashJSError.js"),B=d("./src/core/Debug.js"),M=d("./src/streaming/utils/RequestModifier.js"),I=d("./src/streaming/utils/URLUtils.js"),U=d("./src/streaming/utils/BoxParser.js"),w=d("./src/streaming/vo/metrics/PlayList.js"),k=d("./src/dash/controllers/SegmentsController.js"),K=d("./src/streaming/vo/metrics/HTTPRequest.js");function W(J){J=J||{};var ee=this.context,ue=(0,F.default)(ee).getInstance(),ie=J.streamInfo,Q=J.type,se=J.errHandler,ve=J.mimeType,_e=J.timelineConverter,Z=J.adapter,Ee=J.manifestModel,Se=J.mediaPlayerModel,Me=J.fragmentModel,de=J.abrController,xe=J.playbackController,Fe=J.mediaController,Le=J.textController,De=J.dashMetrics,Ae=J.settings,ge=J.boxParser,pe=J.segmentBlacklistController,Re,me,V,j,$,re,oe,X,z,ne,fe,Ce,Pe;function he(){me=(0,B.default)(ee).getInstance().getLogger(Re),mt(),ue.on(O.default.DATA_UPDATE_COMPLETED,Ut,Re,{priority:F.default.EVENT_PRIORITY_HIGH}),ue.on(O.default.INIT_FRAGMENT_NEEDED,st,Re),ue.on(O.default.MEDIA_FRAGMENT_NEEDED,Nt,Re),ue.on(O.default.INIT_FRAGMENT_LOADED,en,Re),ue.on(O.default.MEDIA_FRAGMENT_LOADED,Nn,Re),ue.on(O.default.BUFFER_LEVEL_STATE_CHANGED,Vt,Re),ue.on(O.default.BUFFER_CLEARED,Zt,Re),ue.on(O.default.SEEK_TARGET,cn,Re),ue.on(O.default.FRAGMENT_LOADING_ABANDONED,ze,Re),ue.on(O.default.FRAGMENT_LOADING_COMPLETED,ct,Re),ue.on(O.default.QUOTA_EXCEEDED,Dt,Re),ue.on(O.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,bt,Re),ue.on(O.default.SET_NON_FRAGMENTED_TEXT,Ft,Re),ue.on(O.default.SOURCE_BUFFER_ERROR,We,Re)}function Ue(He,ft,$t){Ce=(0,k.default)(ee).create({events:O.default,eventBus:ue,streamInfo:ie,timelineConverter:_e,dashConstants:g.default,segmentBaseController:J.segmentBaseController,type:Q}),fe=(0,L.default)(ee).create({streamInfo:ie,type:Q,timelineConverter:_e,dashMetrics:De,mediaPlayerModel:Se,baseURLController:J.baseURLController,errHandler:se,segmentsController:Ce,settings:Ae,boxParser:ge,events:O.default,eventBus:ue,errors:D.default,debug:(0,B.default)(ee).getInstance(),requestModifier:(0,M.default)(ee).getInstance(),dashConstants:g.default,constants:m.default,urlUtils:(0,I.default)(ee).getInstance()}),V=ie.manifestInfo.isDynamic,fe.initialize(V),de.registerStreamType(Q,Re),X=(0,C.default)(ee).create({streamInfo:ie,type:Q,abrController:de,dashMetrics:De,playbackController:xe,timelineConverter:_e,dashConstants:g.default,events:O.default,eventBus:ue,errors:D.default,isDynamic:V,segmentsController:Ce}),re=gn(Q,$t),re&&re.initialize(He),oe=(0,T.default)(ee).create({streamInfo:ie,type:Q,mimeType:ve,adapter:Z,dashMetrics:De,mediaPlayerModel:Se,fragmentModel:Me,abrController:de,playbackController:xe,textController:Le,mediaController:Fe,bufferController:re,settings:Ae}),oe.initialize(ft),Pe=0,z=!1}function we(){return ie.id}function $e(){return Q}function it(){return Z.getIsTextTrack(X.getData())}function mt(){$=[],j=null,Pe=0,z=!1,ne=!1}function pt(He,ft){fe&&fe.reset(),re&&(re.reset(He,ft),re=null),oe&&(oe.reset(),oe=null),X&&(X.reset(),X=null),Ce&&(Ce=null),de&&de.unRegisterStreamType(we(),Q),ue.off(O.default.DATA_UPDATE_COMPLETED,Ut,Re),ue.off(O.default.INIT_FRAGMENT_NEEDED,st,Re),ue.off(O.default.MEDIA_FRAGMENT_NEEDED,Nt,Re),ue.off(O.default.INIT_FRAGMENT_LOADED,en,Re),ue.off(O.default.MEDIA_FRAGMENT_LOADED,Nn,Re),ue.off(O.default.BUFFER_LEVEL_STATE_CHANGED,Vt,Re),ue.off(O.default.BUFFER_CLEARED,Zt,Re),ue.off(O.default.SEEK_TARGET,cn,Re),ue.off(O.default.FRAGMENT_LOADING_ABANDONED,ze,Re),ue.off(O.default.FRAGMENT_LOADING_COMPLETED,ct,Re),ue.off(O.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,bt,Re),ue.off(O.default.SET_NON_FRAGMENTED_TEXT,Ft,Re),ue.off(O.default.QUOTA_EXCEEDED,Dt,Re),ue.off(O.default.SOURCE_BUFFER_ERROR,We,Re),mt(),Q=null,ie=null}function Pt(){return X?X.isUpdating():!1}function lt(He){return new Promise(function(ft){var $t=re.hasBufferAtTime(He.seekTime);if($t){re.pruneBuffer(),ft();return}oe.clearScheduleTimer(),Me.abortRequests(),re.prepareForPlaybackSeek().then(function(){var vn=re.getAllRangesWithSafetyFactor(He.seekTime);return re.clearBuffers(vn)}).then(function(){var vn=re.getContinuousBufferTimeForTargetTime(He.seekTime);if(!isNaN(vn)&&!isNaN(ie.duration)&&isFinite(ie.duration)&&vn>=ie.start+ie.duration)re.setIsBufferingCompleted(!0),ft();else{var yn=isNaN(vn)?He.seekTime:vn;tt(yn),re.setSeekTarget(yn);var On=[];On.push(re.updateAppendWindow());var nr=Xt();On.push(re.updateBufferTimestampOffset(nr)),Promise.all(On).then(function(){oe.setInitSegmentRequired(!0),oe.setCheckPlaybackQuality(!1),oe.startScheduleTimer(),ft()})}}).catch(function(vn){me.error(vn)})})}function Ye(){return new Promise(function(He,ft){try{oe.clearScheduleTimer(),Me.abortRequests(),re.prepareForPlaybackSeek().then(function(){return re.pruneAllSafely()}).then(function(){He()})}catch($t){ft($t)}})}function st(He){var ft=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(He.sender){if(xe.getIsManifestUpdateInProgress()){St();return}if(!(it()&&!Le.isTextEnabled())&&re&&He.representationId&&!re.appendInitSegmentFromCache(He.representationId)){var $t=X.getCurrentRepresentation();if($t.range===0){Nt();return}var vn=fe?fe.getInitRequest(j,$t):null;vn?Me.executeRequest(vn):ft&&(oe.setInitSegmentRequired(!0),St())}}}function Nt(He){var ft=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(xe.getIsManifestUpdateInProgress()||re.getIsPruningInProgress()){St();return}var $t=Et();$t?(z=!1,Wt($t)):Ht(ft)}function Wt(He){isNaN(He.startTime+He.duration)||(Pe=He.startTime+He.duration),He.delayLoadingTime=new Date().getTime()+oe.getTimeToLoadDelay(),oe.setTimeToLoadDelay(0),nt(He)?(me.warn("Fragment request url ".concat(He.url," for stream id ").concat(ie.id," and media type ").concat(Q," is on the ignore list and will be skipped")),St()):(me.debug("Next fragment request url for stream id ".concat(ie.id," and media type ").concat(Q," is ").concat(He.url)),Me.executeRequest(He))}function Ht(He){var ft=X.getCurrentRepresentation();if(Ae.get().streaming.gaps.enableSeekFix&&(z||xe.getTime()===0)){var $t;if(V?V&&ft.segmentInfoType===g.default.SEGMENT_TIMELINE&&($t=fe.getValidTimeAheadOfTargetTime(Pe,j,ft,Ae.get().streaming.gaps.threshold)):$t=fe.getValidTimeAheadOfTargetTime(Pe,j,ft,Ae.get().streaming.gaps.threshold),!isNaN($t)&&$t!==Pe){xe.isSeeking()||xe.getTime()===0?(me.warn("Adjusting playback time ".concat($t," because of gap in the manifest. Seeking by ").concat($t-Pe)),xe.seek($t,!1,!1)):(me.warn("Adjusting buffering time ".concat($t," because of gap in the manifest. Adjusting time by ").concat($t-Pe)),tt($t),He&&St());return}}var vn=fe.isLastSegmentRequested(ft,Pe);if(vn){var yn=fe.getCurrentIndex();me.debug("Segment requesting for stream ".concat(ie.id," has finished")),ue.trigger(O.default.STREAM_REQUESTING_COMPLETED,{segmentIndex:yn},{streamId:ie.id,mediaType:Q}),re.segmentRequestingCompleted(yn),oe.clearScheduleTimer();return}He&&St()}function nt(He){var ft=He.url;return He.range&&(ft=ft.concat("_",He.range)),pe.contains(ft)}function Et(){var He=Xt(),ft;if(isNaN(Pe)||$e()===m.default.TEXT&&!Le.isTextEnabled())return null;if(fe){var $t=X&&He?X.getRepresentationForQuality(He.quality):null;z?ft=fe.getSegmentRequestForTime(j,$t,Pe):ft=fe.getNextSegmentRequest(j,$t)}return ft}function St(){oe.startScheduleTimer(xe.getLowLatencyModeEnabled()?Ae.get().streaming.scheduling.lowLatencyTimeout:Ae.get().streaming.scheduling.defaultTimeout)}function Ut(He){He.error||(oe.setCurrentRepresentation(Z.convertRepresentationToRepresentationInfo(He.currentRepresentation)),re.getIsBufferingCompleted()||re.updateBufferTimestampOffset(He.currentRepresentation))}function Vt(He){De.addBufferState(Q,He.state,oe.getBufferTarget()),He.state===v.default.BUFFER_EMPTY&&!xe.isSeeking()&&(me.info("Buffer is empty! Stalling!"),De.pushPlayListTraceMetrics(new Date,w.PlayListTrace.REBUFFERING_REASON))}function Zt(He){Me.syncExecutedRequestsWithBufferedRange(re.getBuffer().getAllBufferRanges(),ie.duration),He.quotaExceeded&&He.from>xe.getTime()&&tt(He.from),He.hasEnoughSpaceToAppend&&He.quotaExceeded&&oe.startScheduleTimer()}function We(He){if(!(!He||!He.lastRequestAppended||!He.lastRequestAppended.url)){var ft=He.lastRequestAppended.url;He.lastRequestAppended.range&&(ft=ft.concat("_",He.lastRequestAppended.range)),me.warn("Blacklisting segment with url ".concat(ft)),pe.add(ft)}}function In(He){me.debug("Preparing quality switch for type ".concat(Q));var ft=He.newQuality;ne=!0,oe.clearScheduleTimer();var $t=Xt(ft);oe.setCurrentRepresentation($t),X.prepareQualityChange(ft),Me.abortRequests(),re.updateBufferTimestampOffset($t).then(function(){He.reason&&He.reason.forceReplace?Ct():Ae.get().streaming.buffer.fastSwitchEnabled?je($t):Oe(),De.pushPlayListTraceMetrics(new Date,w.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),De.createPlaylistTraceMetrics($t.id,xe.getTime()*1e3,xe.getPlaybackRate())})}function Ct(){ue.trigger(O.default.BUFFER_REPLACEMENT_STARTED,{mediaType:Q,streamId:ie.id},{mediaType:Q,streamId:ie.id}),re.prepareForReplacementQualitySwitch().then(function(){jn(),ne=!1}).catch(function(){jn(),ne=!1})}function je(He){var ft=xe.getTime(),$t=1.5*(isNaN(He.fragmentDuration)?1:He.fragmentDuration),vn=Me.getRequests({state:_.default.FRAGMENT_MODEL_EXECUTED,time:ft+$t,threshold:0})[0];if(vn&&!it()){var yn=re.getBufferLevel(),On=de.getAbandonmentStateFor(ie.id,Q);if(vn.quality<He.quality&&yn>=$t&&On!==v.default.ABANDON_LOAD){var nr=ft+$t;tt(nr),oe.setCheckPlaybackQuality(!1),oe.startScheduleTimer()}else Oe()}else oe.startScheduleTimer();ne=!1}function Oe(){Mt(),ne=!1}function ze(He){me.info("onFragmentLoadingAbandoned request: "+He.request.url+" has been aborted"),!xe.isSeeking()&&!oe.getSwitchStrack()&&!ne&&(me.info("onFragmentLoadingAbandoned request: "+He.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),He.request&&He.request.isInitializationRequest()?oe.setInitSegmentRequired(!0):tt(He.request.startTime+He.request.duration/2),oe.startScheduleTimer(0))}function ct(He){me.info("OnFragmentLoadingCompleted for stream id "+ie.id+" and media type "+Q+" - Url:",He.request?He.request.url:"undefined",He.request.range?", Range:"+He.request.range:""),it()&&oe.startScheduleTimer(0),He.error&&He.request.serviceLocation&&dt(He)}function dt(He){me.info("Fragment loading completed with an error"),!(!He||!He.request||!He.request.type)&&(He.request.type===K.HTTPRequest.INIT_SEGMENT_TYPE?st({representationId:He.request.representationId,sender:{}},!1):He.request.type===K.HTTPRequest.MEDIA_SEGMENT_TYPE&&(tt(He.request.startTime+He.request.duration/2),Nt({},!1)))}function bt(){tt(xe.getTime()),Tt().startScheduleTimer()}function Ft(He){var ft=He.currentTrackInfo;if(ft){var $t=$.find(function(vn){return vn.index===ft.index&&vn.lang===ft.lang});$t&&Qt($t).then(function(){re.setIsBufferingCompleted(!1),tt(xe.getTime()),oe.setInitSegmentRequired(!0),oe.startScheduleTimer()})}}function Dt(He){tt(He.quotaExceededTime),oe.clearScheduleTimer()}function Kt(){return X}function on(){return re?re.getBuffer():null}function Tn(){return re}function Ke(){re.dischargePreBuffer()}function ut(){return Me}function wt(He){return ie=He,et()?Promise.resolve():re.updateAppendWindow()}function Gt(){return ie}function Qt(He){He!==j&&(!He||!j||He.type===j.type)&&(j=He);var ft=Z.getRealAdaptation(ie,j),$t=Z.getVoRepresentations(j);if(X){var vn=X.getData(),yn=de.getMaxAllowedIndexFor(Q,ie.id),On=de.getMinAllowedIndexFor(Q,ie.id),nr,Un,Br=null;return(vn===null||vn.id!==ft.id)&&Q!==m.default.TEXT?(Un=de.getThroughputHistory().getAverageThroughput(Q,V),Br=Un||de.getInitialBitrateFor(Q,ie.id),nr=de.getQualityForBitrate(j,Br,ie.id)):nr=de.getQualityFor(Q,ie.id),On!==void 0&&nr<On&&(nr=On),nr>yn&&(nr=yn),X.updateData(ft,$t,Q,j.isFragmented,nr)}else return Promise.resolve()}function sn(He){$.indexOf(He)===-1&&$.push(He)}function Dn(){$=[]}function pn(){return j}function sr(){return re.getMediaSource()}function Be(He){return re.setMediaSource(He,j)}function Tt(){return oe}function Xt(He){var ft;return He!==void 0?((0,b.checkInteger)(He),ft=X?X.getRepresentationForQuality(He):null):ft=X?X.getCurrentRepresentation():null,Z.convertRepresentationToRepresentationInfo(ft)}function et(){return re?re.getIsBufferingCompleted():!1}function gt(){return re?re.getBufferLevel():0}function At(){var He=Xt(),ft=X&&He?X.getRepresentationForQuality(He.quality):null;return fe.getNextSegmentRequestIdempotent(j,ft)}function en(He){if(Ae.get().streaming.enableManifestTimescaleMismatchFix){var ft=He.chunk,$t=ft.bytes,vn=ft.quality,yn=Xt(vn),On=X&&yn?X.getRepresentationForQuality(yn.quality):null;if(yn&&On){var nr=ge.getMediaTimescaleFromMoov($t);On.timescale=nr}}}function Nn(He){var ft=He.chunk,$t=ft.bytes,vn=ft.quality,yn=Xt(vn),On=X&&yn?X.getRepresentationForQuality(yn.quality):null;if(yn&&On){var nr=Z.getEventsFor(yn.mediaInfo,null,ie),Un=Z.getEventsFor(yn,On,ie);if(nr&&nr.length>0||Un&&Un.length>0){var Br=Me.getRequests({state:_.default.FRAGMENT_MODEL_EXECUTED,quality:vn,index:ft.index})[0],Mi=_n($t,Br,nr,Un);ue.trigger(O.default.INBAND_EVENTS,{events:Mi},{streamId:ie.id})}}}function _n(He,ft,$t,vn){try{for(var yn={},On=[],nr=$t.concat(vn),Un=0,Br=nr.length;Un<Br;Un++)yn[nr[Un].schemeIdUri+"/"+nr[Un].value]=nr[Un];var Mi=(0,U.default)(ee).getInstance().parse(He),Bi=Mi.getBoxes("emsg");if(!Bi||Bi.length===0)return On;for(var li=Mi.getBox("sidx"),Xs=li&&!isNaN(li.earliest_presentation_time)&&!isNaN(li.timescale)?li.earliest_presentation_time/li.timescale:ft&&!isNaN(ft.mediaStartTime)?ft.mediaStartTime:0,Sa=Math.max(Xs,0),Zo=X.getCurrentRepresentation(),bs=0,Aa=Bi.length;bs<Aa;bs++){var Ds=Z.getEvent(Bi[bs],yn,Sa,Zo);Ds&&On.push(Ds)}return On}catch{return[]}}function En(He){var ft=on();return ft?Promise.resolve(ft):re?re.createBufferSink(j,He):Promise.resolve(null)}function mr(){return new Promise(function(He){me.debug("Preparing track switch for type ".concat(Q));var ft=Q===m.default.TEXT||Ae.get().streaming.trackSwitchMode[Q]===m.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&xe.getTimeToStreamEnd(ie)>Ae.get().streaming.buffer.stallThreshold;if(re.getIsBufferingCompleted()&&!ft){re.prepareForNonReplacementTrackSwitch(j.codec).then(function(){ue.trigger(O.default.BUFFERING_COMPLETED,{},{streamId:ie.id,mediaType:Q})}).catch(function(){ue.trigger(O.default.BUFFERING_COMPLETED,{},{streamId:ie.id,mediaType:Q})}),He();return}oe.clearScheduleTimer(),oe.setSwitchTrack(!0),ft?(ue.trigger(O.default.BUFFER_REPLACEMENT_STARTED,{mediaType:Q,streamId:ie.id},{mediaType:Q,streamId:ie.id}),Me.abortRequests(),re.prepareForReplacementTrackSwitch(j.codec).then(function(){var $t=Xt();return re.updateBufferTimestampOffset($t)}).then(function(){jn(),He()}).catch(function(){jn(),He()})):re.prepareForNonReplacementTrackSwitch(j.codec).then(function(){Mt(),He()}).catch(function(){Mt(),He()})})}function jn(){var He=xe.getTime();Ae.get().streaming.buffer.flushBufferAtTrackSwitch&&xe.seek(He+.001,!1,!0),tt(He),re.setSeekTarget(He),oe.startScheduleTimer()}function Mt(){var He=xe.getTime(),ft=re.getContinuousBufferTimeForTargetTime(He),$t=isNaN(ft)?He:ft;tt($t),oe.startScheduleTimer()}function gn(He,ft){var $t=null;return He?(He===m.default.TEXT&&!ft?$t=(0,E.default)(ee).create({streamInfo:ie,type:He,mimeType:ve,fragmentModel:Me,textController:Le,errHandler:se,settings:Ae}):$t=(0,S.default)(ee).create({streamInfo:ie,type:He,mediaPlayerModel:Se,manifestModel:Ee,fragmentModel:Me,errHandler:se,mediaController:Fe,representationController:X,adapter:Z,textController:Le,abrController:de,playbackController:xe,settings:Ae}),$t):(se.error(new x.default(D.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,D.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null)}function cn(He){He&&!isNaN(He.time)&&(tt(He.time),re.setSeekTarget(He.time))}function tt(He){Pe=He,z=!0}function vt(He,ft){De.pushPlayListTraceMetrics(He,ft)}return Re={initialize:Ue,getStreamId:we,getType:$e,isUpdating:Pt,getBufferController:Tn,dischargePreBuffer:Ke,getFragmentModel:ut,getScheduleController:Tt,getRepresentationController:Kt,getRepresentationInfo:Xt,getBufferLevel:gt,isBufferingCompleted:et,createBufferSinks:En,updateStreamInfo:wt,getStreamInfo:Gt,selectMediaInfo:Qt,clearMediaInfoArray:Dn,addMediaInfo:sn,prepareTrackSwitch:mr,prepareQualityChange:In,getMediaInfo:pn,getMediaSource:sr,setMediaSource:Be,getBuffer:on,setExplicitBufferingTime:tt,finalisePlayList:vt,probeNextRequest:At,prepareInnerPeriodPlaybackSeeking:lt,prepareOuterPeriodPlaybackSeeking:Ye,reset:pt},he(),Re}W.__dashjs_factory_name="StreamProcessor";const Y=R.default.getClassFactory(W)},"./src/streaming/XlinkLoader.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>b});var m=d("./src/streaming/vo/DashJSError.js"),g=d("./src/streaming/net/URLLoader.js"),v=d("./src/streaming/vo/metrics/HTTPRequest.js"),_=d("./src/streaming/vo/TextRequest.js"),S=d("./src/core/EventBus.js"),E=d("./src/core/events/Events.js"),T=d("./src/core/FactoryMaker.js"),C=d("./src/core/errors/Errors.js");function R(F){F=F||{};var O="urn:mpeg:dash:resolve-to-zero:2013",L=this.context,D=(0,S.default)(L).getInstance(),x=(0,g.default)(L).create({errHandler:F.errHandler,dashMetrics:F.dashMetrics,mediaPlayerModel:F.mediaPlayerModel,requestModifier:F.requestModifier,errors:C.default}),B;function M(U,w,k){var K=function(J,ee){w.resolved=!0,w.resolvedContent=J||null,D.trigger(E.default.XLINK_ELEMENT_LOADED,{element:w,resolveObject:k,error:J||ee?null:new m.default(C.default.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,C.default.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+U)})};if(U===O)K(null,!0);else{var W=new _.default(U,v.HTTPRequest.XLINK_EXPANSION_TYPE);x.load({request:W,success:function(J){K(J)},error:function(){K(null)}})}}function I(){x&&(x.abort(),x=null)}return B={load:M,reset:I},B}R.__dashjs_factory_name="XlinkLoader";const b=T.default.getClassFactory(R)},"./src/streaming/constants/ConformanceViolationConstants.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>m});const m={LEVELS:{SUGGESTION:"Suggestion",WARNING:"Warning",ERROR:"Error"},EVENTS:{NO_UTC_TIMING_ELEMENT:{key:"NO_UTC_TIMING_ELEMENT",message:"No UTCTiming element is present in the manifest. You may experience playback failures. For a detailed validation use https://conformance.dashif.org/"},NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE:{key:"NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE",message:'SMPTE 2052-1:2013 defines the attribute name as "imageType" and does not define "imagetype"'},INVALID_DVR_WINDOW:{key:"INVALID_DVR_WINDOW",message:"No valid segment found when applying a specification compliant DVR window calculation. Using SegmentTimeline entries as a fallback."}}}},"./src/streaming/constants/Constants.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});function m(T,C){if(!(T instanceof C))throw new TypeError("Cannot call a class as a function")}function g(T,C){for(var R=0;R<C.length;R++){var b=C[R];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(T,b.key,b)}}function v(T,C,R){return C&&g(T.prototype,C),R&&g(T,R),T}var _=function(){function T(){m(this,T),this.init()}return v(T,[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.CONTENT_STEERING="contentSteering",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_L2A="abrL2A",this.ABR_STRATEGY_LoLP="abrLoLP",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA="abrFetchThroughputCalculationDownloadedData",this.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING="abrFetchThroughputCalculationMoofParsing",this.ABR_FETCH_THROUGHPUT_CALCULATION_AAST="abrFetchThroughputCalculationAAST",this.LIVE_CATCHUP_MODE_DEFAULT="liveCatchupModeDefault",this.LIVE_CATCHUP_MODE_LOLP="liveCatchupModeLoLP",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.TRACK_SWITCH_MODE_ALWAYS_REPLACE="alwaysReplace",this.TRACK_SWITCH_MODE_NEVER_REPLACE="neverReplace",this.TRACK_SELECTION_MODE_FIRST_TRACK="firstTrack",this.TRACK_SELECTION_MODE_HIGHEST_BITRATE="highestBitrate",this.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY="highestEfficiency",this.TRACK_SELECTION_MODE_WIDEST_RANGE="widestRange",this.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY="highestSelectionPriority",this.CMCD_MODE_QUERY="query",this.CMCD_MODE_HEADER="header",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer",this.DVB_REPORTING_URL="dvb:reportingUrl",this.DVB_PROBABILITY="dvb:probability",this.VIDEO_ELEMENT_READY_STATES={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},this.FILE_LOADER_TYPES={FETCH:"fetch_loader",XHR:"xhr_loader"}}}]),T}(),S=new _;const E=S},"./src/streaming/constants/MetricsConstants.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});function m(T,C){if(!(T instanceof C))throw new TypeError("Cannot call a class as a function")}function g(T,C){for(var R=0;R<C.length;R++){var b=C[R];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(T,b.key,b)}}function v(T,C,R){return C&&g(T.prototype,C),R&&g(T,R),T}var _=function(){function T(){m(this,T),this.init()}return v(T,[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors",this.HTTP_REQUEST_DVB_REPORTING_TYPE="DVBReporting"}}]),T}(),S=new _;const E=S},"./src/streaming/constants/ProtectionConstants.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});function m(T,C){if(!(T instanceof C))throw new TypeError("Cannot call a class as a function")}function g(T,C){for(var R=0;R<C.length;R++){var b=C[R];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(T,b.key,b)}}function v(T,C,R){return C&&g(T.prototype,C),R&&g(T,R),T}var _=function(){function T(){m(this,T),this.init()}return v(T,[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready",this.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING="com.microsoft.playready.recommendation",this.INITIALIZATION_DATA_TYPE_CENC="cenc",this.INITIALIZATION_DATA_TYPE_KEYIDS="keyids",this.INITIALIZATION_DATA_TYPE_WEBM="webm"}}]),T}(),S=new _;const E=S},"./src/streaming/controllers/AbrController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>W});var m=d("./src/streaming/rules/abr/ABRRulesCollection.js"),g=d("./src/streaming/constants/Constants.js"),v=d("./src/streaming/constants/MetricsConstants.js"),_=d("./src/streaming/vo/BitrateInfo.js"),S=d("./src/streaming/models/FragmentModel.js"),E=d("./src/core/EventBus.js"),T=d("./src/core/events/Events.js"),C=d("./src/core/FactoryMaker.js"),R=d("./src/streaming/rules/RulesContext.js"),b=d("./src/streaming/rules/SwitchRequest.js"),F=d("./src/streaming/rules/SwitchRequestHistory.js"),O=d("./src/streaming/rules/DroppedFramesHistory.js"),L=d("./src/streaming/rules/ThroughputHistory.js"),D=d("./src/core/Debug.js"),x=d("./src/streaming/vo/metrics/HTTPRequest.js"),B=d("./src/streaming/utils/SupervisorTools.js"),M=d("./src/streaming/MediaPlayerEvents.js"),I=1e3,U=100,w=0;function k(){var Y=this.context,J=(0,D.default)(Y).getInstance(),ee=(0,E.default)(Y).getInstance(),ue,ie,Q,se,ve,_e,Z,Ee,Se,Me,de,xe,Fe,Le,De,Ae,ge,pe,Re,me,V,j,$,re,oe,X,z;function ne(){ie=J.getLogger(ue),Ue()}function fe(){V=(0,O.default)(Y).create(),j=(0,L.default)(Y).create({settings:z}),Q=(0,m.default)(Y).create({dashMetrics:X,customParametersModel:Ae,mediaPlayerModel:De,settings:z}),Q.initialize(),ee.on(M.default.QUALITY_CHANGE_RENDERED,pt,ue),ee.on(M.default.METRIC_ADDED,Pt,ue),ee.on(T.default.LOADING_PROGRESS,mt,ue)}function Ce(Ke,ut){var wt=ut.getStreamInfo().id;Z[wt]||(Z[wt]={}),me[wt]||(me[wt]={}),Ee[wt]||(Ee[wt]={}),me[wt][Ke]=(0,F.default)(Y).create(),Z[wt][Ke]=ut,Ee[wt][Ke]={},Ee[wt][Ke].state=v.default.ALLOW_LOAD,Pe(Ke),Ke===g.default.VIDEO&&on()}function Pe(Ke){var ut=z.get().streaming.abr.ABRStrategy;ut===g.default.ABR_STRATEGY_L2A?($[Ke]=!1,oe[Ke]=!1,re[Ke]=!0):ut===g.default.ABR_STRATEGY_LoLP?($[Ke]=!1,oe[Ke]=!0,re[Ke]=!1):ut===g.default.ABR_STRATEGY_BOLA?($[Ke]=!0,oe[Ke]=!1,re[Ke]=!1):ut===g.default.ABR_STRATEGY_THROUGHPUT?($[Ke]=!1,oe[Ke]=!1,re[Ke]=!1):ut===g.default.ABR_STRATEGY_DYNAMIC&&($[Ke]=$&&$[Ke]?$[Ke]:!1,oe[Ke]=!1,re[Ke]=!1)}function he(Ke,ut){try{Z[Ke]&&Z[Ke][ut]&&delete Z[Ke][ut],me[Ke]&&me[Ke][ut]&&delete me[Ke][ut],Ee[Ke]&&Ee[Ke][ut]&&delete Ee[Ke][ut]}catch{}}function Ue(){ve={},_e={},Ee={},Z={},me={},$={},re={},oe={},Me===void 0&&(Me=!1),V&&V.reset(),Re=void 0,V=void 0,j=void 0,clearTimeout(Se),Se=null}function we(){Ue(),ee.off(T.default.LOADING_PROGRESS,mt,ue),ee.off(M.default.QUALITY_CHANGE_RENDERED,pt,ue),ee.off(M.default.METRIC_ADDED,Pt,ue),Q&&Q.reset()}function $e(Ke){Ke&&(Ke.streamController&&(se=Ke.streamController),Ke.domStorage&&(pe=Ke.domStorage),Ke.mediaPlayerModel&&(De=Ke.mediaPlayerModel),Ke.customParametersModel&&(Ae=Ke.customParametersModel),Ke.cmsdModel&&(ge=Ke.cmsdModel),Ke.dashMetrics&&(X=Ke.dashMetrics),Ke.adapter&&(Fe=Ke.adapter),Ke.videoModel&&(Le=Ke.videoModel),Ke.settings&&(z=Ke.settings))}function it(){if(!pe||!pe.hasOwnProperty("getSavedBitrateSettings"))throw new Error(g.default.MISSING_CONFIG_ERROR)}function mt(Ke){var ut=Ke.request.mediaType,wt=Ke.streamId;if(!(!ut||!wt||!Z[wt]||!z.get().streaming.abr.autoSwitchBitrate[ut])){var Gt=Z[wt][ut];if(Gt){var Qt=(0,R.default)(Y).create({abrController:ue,streamProcessor:Gt,currentRequest:Ke.request,useBufferOccupancyABR:$[ut],useL2AABR:re[ut],useLoLPABR:oe[ut],videoModel:Le}),sn=Q.shouldAbandonFragment(Qt,wt);if(sn.quality>b.default.NO_CHANGE){var Dn=Gt.getFragmentModel(),pn=Dn.getRequests({state:S.default.FRAGMENT_MODEL_LOADING,index:Ke.request.index})[0];pn&&(Ee[wt][ut].state=v.default.ABANDON_LOAD,me[wt][ut].reset(),me[wt][ut].push({oldValue:Zt(ut,wt),newValue:sn.quality,confidence:1,reason:sn.reason}),We(ut,se.getActiveStreamInfo(),sn.quality,sn.reason),clearTimeout(Se),Se=setTimeout(function(){Ee[wt][ut].state=v.default.ALLOW_LOAD,Se=null},z.get().streaming.abandonLoadTimeout))}}}}function pt(Ke){Ke.mediaType===g.default.VIDEO&&(Re!==void 0&&V.push(Ke.streamId,Re,Le.getPlaybackQuality()),Re=Ke.newQuality)}function Pt(Ke){Ke.metric===v.default.HTTP_REQUEST&&Ke.value&&Ke.value.type===x.HTTPRequest.MEDIA_SEGMENT_TYPE&&(Ke.mediaType===g.default.AUDIO||Ke.mediaType===g.default.VIDEO)&&j.push(Ke.mediaType,Ke.value,z.get().streaming.abr.useDeadTimeLatency),Ke.metric===v.default.BUFFER_LEVEL&&(Ke.mediaType===g.default.AUDIO||Ke.mediaType===g.default.VIDEO)&&ct(Ke.mediaType,.001*Ke.value.level)}function lt(Ke,ut){try{var wt;return ve[ut]=ve[ut]||{},ve[ut].hasOwnProperty(Ke)||(ve[ut][Ke]=0),wt=Wt(Ke,ut),wt=nt(wt,Ke,ut),wt=Et(wt,Ke,ut),z.get().streaming.cmsd.enabled&&z.get().streaming.cmsd.abr.applyMb&&(wt=Ht(wt,Ke,ut)),wt}catch{return}}function Ye(Ke,ut){try{return Nt(Ke,ut)}catch{return}}function st(Ke,ut){try{var wt=De.getAbrBitrateParameter("maxBitrate",Ke);return wt>-1?Oe(Z[ut][Ke].getMediaInfo(),wt,ut):void 0}catch{return}}function Nt(Ke,ut){try{var wt=De.getAbrBitrateParameter("minBitrate",Ke);if(wt>-1){var Gt=Z[ut][Ke].getMediaInfo(),Qt=ze(Gt),sn=Oe(Gt,wt,ut);return Qt[sn]&&sn<Qt.length-1&&Qt[sn].bitrate<wt*1e3&&sn++,sn}else return}catch{return}}function Wt(Ke,ut){var wt=ve[ut][Ke],Gt=wt;if(!Z[ut]||!Z[ut][Ke])return Gt;var Qt=Ye(Ke,ut);Qt!==void 0&&(Gt=Math.max(wt,Qt));var sn=st(Ke,ut);return sn!==void 0&&(Gt=Math.min(Gt,sn)),Gt}function Ht(Ke,ut,wt){if(ut!=="video")return Ke;var Gt=ge.getMaxBitrate(ut);if(Gt<0)return Ke;var Qt=je(wt,"audio",Zt("audio",wt));Gt-=Qt?Qt.bitrate/1e3:0;var sn=Oe(Z[wt][ut].getMediaInfo(),Gt,wt);return ie.debug("Stream ID: "+wt+" ["+ut+"] Apply max bit rate from CMSD: "+Gt),Math.min(Ke,sn)}function nt(Ke,ut,wt){var Gt=ve[wt][ut],Qt=z.get().streaming.abr.maxRepresentationRatio[ut];return isNaN(Qt)||Qt>=1||Qt<0?Ke:Math.min(Ke,Math.round(Gt*Qt))}function Et(Ke,ut,wt){if(ut!==g.default.VIDEO||!z.get().streaming.abr.limitBitrateByPortal||!Z[wt]||!Z[wt][ut])return Ke;Me||on();var Gt=Z[wt][ut].getStreamInfo(),Qt=Fe.getAdaptationForType(Gt.index,ut,Gt).Representation_asArray,sn=Ke;if(de>0&&xe>0){for(;sn>0&&Qt[sn]&&de<Qt[sn].width&&de-Qt[sn-1].width<Qt[sn].width-de;)sn=sn-1;for(;sn<Qt.length-1&&Qt[sn].width===Qt[sn+1].width;)sn=sn+1}return sn}function St(Ke){var ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(ut||(ut=se.getActiveStreamInfo().id),Ke&&Z&&Z[ut]&&Z[ut][Ke]){var wt=lt(Ke,ut),Gt=ze(Z[ut][Ke].getMediaInfo());return Gt[wt]?Gt[wt]:null}return null}function Ut(Ke,ut){if(it(),Ke===g.default.TEXT)return NaN;var wt=pe.getSavedBitrateSettings(Ke),Gt=De.getAbrBitrateParameter("initialBitrate",Ke),Qt=z.get().streaming.abr.initialRepresentationRatio[Ke];if(Gt===-1)if(Qt>-1){var sn=Z[ut][Ke].getStreamInfo(),Dn=Fe.getAdaptationForType(sn.index,Ke,sn).Representation_asArray;if(Array.isArray(Dn)){var pn=Math.max(Math.round(Dn.length*Qt)-1,0);Gt=Dn[pn].bandwidth/1e3}else Gt=0}else isNaN(wt)?Gt=Ke===g.default.VIDEO?I:U:Gt=wt;return Gt}function Vt(Ke,ut){try{if(!Ke||!Z||!Z[ut]||!Z[ut][Ke])return!1;if(V){var wt=Le.getPlaybackQuality();wt&&V.push(ut,Re,wt)}if(!z.get().streaming.abr.autoSwitchBitrate[Ke])return!1;var Gt=Zt(Ke,ut),Qt=(0,R.default)(Y).create({abrController:ue,switchHistory:me[ut][Ke],droppedFramesHistory:V,streamProcessor:Z[ut][Ke],currentValue:Gt,useBufferOccupancyABR:$[Ke],useL2AABR:re[Ke],useLoLPABR:oe[Ke],videoModel:Le}),sn=Ye(Ke,ut),Dn=lt(Ke,ut),pn=Q.getMaxQuality(Qt),sr=pn.quality;return sn!==void 0&&(sr>b.default.NO_CHANGE?sr:Gt)<sn&&(sr=sn),sr>Dn&&(sr=Dn),me[ut][Ke].push({oldValue:Gt,newValue:sr}),sr>b.default.NO_CHANGE&&sr!==Gt&&(Ee[ut][Ke].state===v.default.ALLOW_LOAD||sr<Gt)?(Ct(Ke,Gt,sr,Dn,pn.reason,ut),!0):!1}catch{return!1}}function Zt(Ke){var ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;try{if(ut||(ut=se.getActiveStreamInfo().id),Ke&&Z[ut]&&Z[ut][Ke]){var wt;if(ut)return _e[ut]=_e[ut]||{},_e[ut].hasOwnProperty(Ke)||(_e[ut][Ke]=w),wt=_e[ut][Ke],wt}return w}catch{return w}}function We(Ke,ut,wt){var Gt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(!(!ut||!ut.id||!Ke)){var Qt=ut.id,sn=Zt(Ke,Qt);(0,B.checkInteger)(wt);var Dn=lt(Ke,Qt);wt!==sn&&wt>=0&&wt<=Dn&&Ct(Ke,sn,wt,Dn,Gt,Qt)}}function In(Ke,ut){return Ee[Ke]&&Ee[Ke][ut]?Ee[Ke][ut].state:null}function Ct(Ke,ut,wt,Gt,Qt,sn){if(Ke&&Z[sn]&&Z[sn][Ke]){var Dn=Z[sn][Ke].getStreamInfo(),pn=Dn&&Dn.manifestInfo&&Dn.manifestInfo.isDynamic,sr=X.getCurrentBufferLevel(Ke);ie.info("Stream ID: "+sn+" ["+Ke+"] switch from "+ut+" to "+wt+"/"+Gt+" (buffer: "+sr+") "+(Qt?JSON.stringify(Qt):".")),_e[sn]=_e[sn]||{},_e[sn][Ke]=wt;var Be=je(sn,Ke,wt);ee.trigger(T.default.QUALITY_CHANGE_REQUESTED,{oldQuality:ut,newQuality:wt,reason:Qt,streamInfo:Dn,bitrateInfo:Be,maxIdx:Gt,mediaType:Ke},{streamId:Dn.id,mediaType:Ke});var Tt=j.getAverageThroughput(Ke,pn);isNaN(Tt)||pe.setSavedBitrateSettings(Ke,Tt)}}function je(Ke,ut,wt){if(ut&&Z&&Z[Ke]&&Z[Ke][ut]){var Gt=ze(Z[Ke][ut].getMediaInfo());return Gt[wt]?Gt[wt]:null}return null}function Oe(Ke,ut,wt){var Gt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,Qt=Ke&&Ke.type?Z[wt][Ke.type].getRepresentationInfo():null;if(z.get().streaming.abr.useDeadTimeLatency&&Gt&&Qt&&Qt.fragmentDuration){Gt=Gt/1e3;var sn=Qt.fragmentDuration;if(Gt>sn)return 0;var Dn=Gt/sn;ut=ut*(1-Dn)}for(var pn=ze(Ke),sr=pn.length-1;sr>=0;sr--){var Be=pn[sr];if(ut*1e3>=Be.bitrate)return sr}return w}function ze(Ke){var ut=[];if(!Ke||!Ke.bitrateList)return ut;for(var wt=Ke.bitrateList,Gt=Ke.type,Qt,sn=0,Dn=wt.length;sn<Dn;sn++)Qt=new _.default,Qt.mediaType=Gt,Qt.qualityIndex=sn,Qt.bitrate=wt[sn].bandwidth,Qt.width=wt[sn].width,Qt.height=wt[sn].height,Qt.scanType=wt[sn].scanType,ut.push(Qt);return ut}function ct(Ke,ut){var wt=z.get().streaming.abr.ABRStrategy;wt===g.default.ABR_STRATEGY_DYNAMIC&&dt(Ke,ut)}function dt(Ke,ut){try{var wt=De.getStableBufferTime(),Gt=wt,Qt=.5*wt,sn=$[Ke],Dn=ut>(sn?Qt:Gt);$[Ke]=Dn,Dn!==sn&&(Dn?ie.info("["+Ke+"] switching from throughput to buffer occupancy ABR rule (buffer: "+ut.toFixed(3)+")."):ie.info("["+Ke+"] switching from buffer occupancy to throughput ABR rule (buffer: "+ut.toFixed(3)+")."))}catch(pn){ie.error(pn)}}function bt(){return j}function Ft(Ke){var ut=Ke.type,wt=Ke.streamInfo.id,Gt=Ke.representationCount-1;return ve[wt]=ve[wt]||{},ve[wt][ut]=Gt,Gt}function Dt(Ke){var ut=Ke?Ke.id:null,wt=Zt(g.default.AUDIO,ut),Gt=Zt(g.default.VIDEO,ut),Qt=wt===lt(g.default.AUDIO,ut)&&Gt===lt(g.default.VIDEO,ut);return Qt}function Kt(Ke){Me=Ke}function on(){if(Le){var Ke=z.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio"),ut=Ke?window.devicePixelRatio:1;de=Le.getClientWidth()*ut,xe=Le.getClientHeight()*ut}}function Tn(Ke){V&&V.clearForStream(Ke),Z[Ke]&&delete Z[Ke],me[Ke]&&delete me[Ke],Ee[Ke]&&delete Ee[Ke]}return ue={initialize:fe,isPlayingAtTopQuality:Dt,updateTopQualityIndex:Ft,clearDataForStream:Tn,getThroughputHistory:bt,getBitrateList:ze,getQualityForBitrate:Oe,getTopBitrateInfoFor:St,getMinAllowedIndexFor:Ye,getMaxAllowedIndexFor:lt,getInitialBitrateFor:Ut,getQualityFor:Zt,getAbandonmentStateFor:In,setPlaybackQuality:We,checkPlaybackQuality:Vt,setElementSize:on,setWindowResizeEventCalled:Kt,registerStreamType:Ce,unRegisterStreamType:he,setConfig:$e,reset:we},ne(),ue}k.__dashjs_factory_name="AbrController";var K=C.default.getSingletonFactory(k);K.QUALITY_DEFAULT=w,C.default.updateSingletonFactory(k.__dashjs_factory_name,K);const W=K},"./src/streaming/controllers/BaseURLController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>R});var m=d("./src/streaming/models/BaseURLTreeModel.js"),g=d("./src/streaming/utils/BaseURLSelector.js"),v=d("./src/streaming/utils/URLUtils.js"),_=d("./src/dash/vo/BaseURL.js"),S=d("./src/core/FactoryMaker.js"),E=d("./src/core/EventBus.js"),T=d("./src/core/events/Events.js");function C(){var b,F,O=this.context,L=(0,E.default)(O).getInstance(),D=(0,v.default)(O).getInstance(),x,B;function M(Y){x.invalidateSelectedIndexes(Y.entry)}function I(){x=(0,m.default)(O).create(),B=(0,g.default)(O).create(),L.on(T.default.SERVICE_LOCATION_BLACKLIST_CHANGED,M,b)}function U(Y){Y.baseURLTreeModel&&(x=Y.baseURLTreeModel),Y.baseURLSelector&&(B=Y.baseURLSelector),Y.adapter&&(F=Y.adapter)}function w(Y){x.update(Y),B.chooseSelector(F.getIsDVB(Y))}function k(Y){var J=x.getForPath(Y),ee=J.reduce(function(ue,ie){var Q=B.select(ie);if(Q)D.isRelative(Q.url)?ue.url=D.resolve(Q.url,ue.url):(ue.url=Q.url,ue.serviceLocation=Q.serviceLocation),ue.availabilityTimeOffset=Q.availabilityTimeOffset,ue.availabilityTimeComplete=Q.availabilityTimeComplete;else return new _.default;return ue},new _.default);if(!D.isRelative(ee.url))return ee}function K(){x.reset(),B.reset()}function W(Y){x.setConfig({adapter:F}),w(Y)}return b={reset:K,initialize:W,resolve:k,setConfig:U},I(),b}C.__dashjs_factory_name="BaseURLController";const R=S.default.getClassFactory(C)},"./src/streaming/controllers/BlacklistController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/EventBus.js");function v(S){S=S||{};var E,T=[],C=(0,g.default)(this.context).getInstance(),R=S.updateEventName,b=S.addBlacklistEventName;function F(B){return!T.length||!B||!B.length?!1:T.indexOf(B)!==-1}function O(B){T.indexOf(B)===-1&&(T.push(B),C.trigger(R,{entry:B}))}function L(B){O(B.entry)}function D(){b&&C.on(b,L,E)}function x(){T=[]}return E={add:O,contains:F,reset:x},D(),E}v.__dashjs_factory_name="BlackListController";const _=m.default.getClassFactory(v)},"./src/streaming/controllers/BufferController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>w});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/streaming/constants/MetricsConstants.js"),v=d("./src/streaming/models/FragmentModel.js"),_=d("./src/streaming/SourceBufferSink.js"),S=d("./src/streaming/PreBufferSink.js"),E=d("./src/core/EventBus.js"),T=d("./src/core/events/Events.js"),C=d("./src/core/FactoryMaker.js"),R=d("./src/core/Debug.js"),b=d("./src/streaming/utils/InitCache.js"),F=d("./src/streaming/vo/DashJSError.js"),O=d("./src/core/errors/Errors.js"),L=d("./src/streaming/vo/metrics/HTTPRequest.js"),D=d("./src/streaming/MediaPlayerEvents.js"),x=.5,B=.01,M=22,I="BufferController";function U(k){k=k||{};var K=this.context,W=(0,E.default)(K).getInstance(),Y=k.errHandler,J=k.fragmentModel,ee=k.representationController,ue=k.adapter,ie=k.textController,Q=k.abrController,se=k.playbackController,ve=k.streamInfo,_e=k.type,Z=k.settings,Ee,Se,Me,de,xe,Fe,Le,De,Ae,ge,pe,Re,me,V,j,$,re,oe,X,z;function ne(){Se=(0,R.default)(K).getInstance().getLogger(Ee),re=(0,b.default)(K).getInstance(),gn()}function fe(tt){Ue(tt),W.on(T.default.INIT_FRAGMENT_LOADED,lt,Ee),W.on(T.default.MEDIA_FRAGMENT_LOADED,st,Ee),W.on(T.default.WALLCLOCK_TIME_UPDATED,Be,Ee),W.on(D.default.PLAYBACK_PLAYING,ct,Ee),W.on(D.default.PLAYBACK_PROGRESS,Oe,Ee),W.on(D.default.PLAYBACK_TIME_UPDATED,Oe,Ee),W.on(D.default.PLAYBACK_RATE_CHANGED,Tt,Ee),W.on(D.default.PLAYBACK_STALLED,ze,Ee)}function Ce(){return ve.id}function Pe(){return _e}function he(){return I}function Ue(tt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return new Promise(function(He,ft){Fe=tt,Ae&&vt&&typeof Ae.discharge=="function"?(ge=Ae,$e(vt).then(function(){He()}).catch(function($t){ft($t)})):He()})}function we(tt){return ue.convertRepresentationToRepresentationInfo(ee.getRepresentationForQuality(tt))}function $e(tt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return new Promise(function(He,ft){if(!re||!tt){He(null);return}Fe?mt(tt,vt).then(function($t){He($t)}).catch(function($t){ft($t)}):it().then(function($t){He($t)}).catch(function($t){ft($t)})})}function it(){var tt=this;return new Promise(function(vt,He){var ft=Q.getQualityFor(_e,ve.id);Ae=(0,S.default)(K).create(Ht.bind(tt)),Dn(we(ft)).then(function(){vt(Ae)}).catch(function(){He()})})}function mt(tt,vt){return new Promise(function(He,ft){var $t=Q.getQualityFor(_e,ve.id);Ae=(0,_.default)(K).create({mediaSource:Fe,textController:ie,eventBus:W}),pt(tt,vt,$t).then(function(){return Dn(we($t))}).then(function(){He(Ae)}).catch(function(vn){Se.fatal("Caught error on create SourceBuffer: "+vn),Y.error(new F.default(O.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,O.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+_e)),ft(vn)})})}function pt(tt,vt,He){var ft=we(He);return vt&&vt[_e]&&(_e===m.default.VIDEO||_e===m.default.AUDIO)?Ae.initializeForStreamSwitch(tt,ft,vt[_e]):Ae.initializeForFirstUse(ve,tt,ft)}function Pt(){if(Ae&&ge&&typeof ge.discharge=="function"){var tt=ge.getAllBufferRanges();if(tt.length>0){for(var vt="Beginning "+_e+"PreBuffer discharge, adding buffer for:",He=0;He<tt.length;He++)vt+=" start: "+tt.start(He)+", end: "+tt.end(He)+";";Se.debug(vt)}else Se.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");pe=[];for(var ft=ge.discharge(),$t=null,vn=0;vn<ft.length;vn++){var yn=ft[vn];if(yn.segmentType!==L.HTTPRequest.INIT_SEGMENT_TYPE){var On=re.extract(yn.streamId,yn.representationId);On&&$t!==On&&(pe.push(On),Ae.append(On),$t=On)}pe.push(yn),Ae.append(yn)}ge.reset(),ge=null}}function lt(tt){Z.get().streaming.cacheInitSegments&&(Se.info("Init fragment finished loading saving to",_e+"'s init cache"),re.save(tt.chunk)),Se.debug("Append Init fragment",_e," with representationId:",tt.chunk.representationId," and quality:",tt.chunk.quality,", data size:",tt.chunk.bytes.byteLength),Nt(tt.chunk)}function Ye(tt){var vt=re.extract(ve.id,tt);return vt?(Se.info("Append Init fragment",_e," with representationId:",vt.representationId," and quality:",vt.quality,", data size:",vt.bytes.byteLength),Nt(vt),!0):!1}function st(tt){Nt(tt.chunk,tt.request)}function Nt(tt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Ae.append(tt,vt).then(function(He){Ht(He)}).catch(function(He){Ht(He)}),tt.mediaInfo.type===m.default.VIDEO&&Mt(T.default.VIDEO_CHUNK_RECEIVED,{chunk:tt})}function Wt(tt){if(tt&&tt.length>0)for(var vt=0,He=tt.length;vt<He;vt++)Se.debug("Buffered range: "+tt.start(vt)+" - "+tt.end(vt)+", currentTime = ",se.getTime())}function Ht(tt){if(tt.error){tt.error.code===M&&Et(),(tt.error.code===M||!mr())&&(Se.warn("Clearing playback buffer to overcome quota exceed situation"),Mt(T.default.QUOTA_EXCEEDED,{criticalBufferLevel:xe,quotaExceededTime:tt.chunk.start}),wt(ut()));return}if(Ae&&(Dt(),$=!1,me=tt.chunk,!(!me||!me.endFragment))){me&&!isNaN(me.index)&&(Le=Math.max(me.index,Le),Kt());var vt=Ae.getAllBufferRanges();me.segmentType===L.HTTPRequest.MEDIA_SEGMENT_TYPE&&(Wt(vt),Oe(),nt());var He=!1;pe&&(pe.indexOf(me)>0&&(He=!0),pe=null),me&&!He&&Mt(T.default.BYTES_APPENDED_END_FRAGMENT,{quality:me.quality,startTime:me.start,index:me.index,bufferedRanges:vt,segmentType:me.segmentType,mediaType:_e})}}function nt(){if(!isNaN(z)){if(_e!==m.default.AUDIO&&_e!==m.default.VIDEO){z=NaN;return}var tt=se.getTime(),vt=bt(tt,0),He=bt(z,0);if(vt&&He&&vt.start===He.start){z=NaN;return}var ft=ee.getCurrentRepresentation().segmentDuration,$t=bt(z,ft);$t&&(Z.get().streaming.buffer.enableSeekDecorrelationFix&&Math.abs(tt-z)>ft?z<=$t.end&&se.seek(Math.max(z,$t.start),!1,!0):tt<$t.start&&se.seek($t.start,!1,!0))}}function Et(){if($=!0,xe=_n()*.8,Se.warn("Quota exceeded, Critical Buffer: "+xe),xe>0){var tt=Math.max(.2*xe,1),vt=xe-tt,He=Math.min(Z.get().streaming.buffer.bufferTimeAtTopQuality,vt*.9),ft=Math.min(Z.get().streaming.buffer.bufferTimeAtTopQualityLongForm,vt*.9),$t={streaming:{buffer:{bufferToKeep:parseFloat(tt.toFixed(5)),bufferTimeAtTopQuality:parseFloat(He.toFixed(5)),bufferTimeAtTopQualityLongForm:parseFloat(ft.toFixed(5))}}};Z.update($t)}}function St(){return Me&&en(!1),Ae.abort()}function Ut(tt){return new Promise(function(vt,He){Ae.abort().then(function(){return pn()}).then(function(){return Z.get().streaming.buffer.useChangeTypeForTrackSwitch?Ae.changeType(tt):Promise.resolve()}).then(function(){return We()}).then(function(){en(!1),vt()}).catch(function(ft){He(ft)})})}function Vt(){return new Promise(function(tt,vt){Ae.abort().then(function(){return pn()}).then(function(){return We()}).then(function(){en(!1),tt()}).catch(function(He){vt(He)})})}function Zt(tt){return new Promise(function(vt,He){pn().then(function(){return Z.get().streaming.buffer.useChangeTypeForTrackSwitch?Ae.changeType(tt):Promise.resolve()}).then(function(){vt()}).catch(function(ft){He(ft)})})}function We(){return new Promise(function(tt,vt){var He=In();if(!He||He.length===0){Oe(),tt();return}wt(He).then(function(){tt()}).catch(function(ft){vt(ft)})})}function In(tt){var vt=[],He=Ae.getAllBufferRanges();if(!He||He.length===0)return vt;if(!tt&&tt!==0||isNaN(tt))vt.push({start:He.start(0),end:He.end(He.length-1)+x});else{var ft=Ct(tt,He),$t=je(tt,He);ft&&vt.push(ft),$t&&vt.push($t)}return vt}function Ct(tt,vt){var He=Z.get().streaming.buffer.bufferToKeep,ft=vt.start(0),$t=tt-ft;if($t>He){var vn=Math.max(0,tt-He),yn=J.getRequests({state:v.default.FRAGMENT_MODEL_EXECUTED,time:tt,threshold:B})[0];if(yn&&(vn=Math.min(yn.startTime,vn)),vn>0)return{start:ft,end:vn}}return null}function je(tt,vt){var He=vt.end(vt.length-1)+x,ft=En(tt),$t=ve.manifestInfo.duration>=Z.get().streaming.buffer.longFormContentDurationThreshold,vn=$t?Z.get().streaming.buffer.bufferTimeAtTopQualityLongForm:Z.get().streaming.buffer.bufferTimeAtTopQuality,yn=isNaN(ft)?tt:Math.min(ft,tt+vn);if(yn>=vt.end(vt.length-1))return null;var On=J.getRequests({state:v.default.FRAGMENT_MODEL_EXECUTED,time:tt,threshold:B})[0];On&&(yn=Math.max(On.startTime+On.duration,yn));var nr=Z.get().streaming.buffer.avoidCurrentTimeRangePruning;if(nr){for(var Un=0;Un<vt.length;Un++)if(vt.start(Un)<=tt&&tt<=vt.end(Un)&&vt.start(Un)<=yn&&yn<=vt.end(Un)){var Br=yn;Un+1<vt.length?yn=vt.start(Un+1):yn=vt.end(Un)+1,Se.debug("Buffered range ["+vt.start(Un)+", "+vt.end(Un)+"] overlaps with targetTime "+tt+" and range to be pruned ["+Br+", "+He+"], using ["+yn+", "+He+"] instead"+(yn<He?"":" (no actual pruning)"));break}}return yn<vt.end(vt.length-1)?{start:yn,end:He}:null}function Oe(){(!X||_e===m.default.TEXT&&ie.isTextEnabled())&&Dt()}function ze(){on()}function ct(){on(),z=NaN}function dt(tt){try{var vt=Ae.getAllBufferRanges();if(!vt||vt.length===0)return!1;for(var He=0;He<vt.length;){var ft=vt.start(He),$t=vt.end(He);if(tt>=ft&&tt<=$t)return!0;He+=1}return!1}catch(vn){return Se.error(vn),!1}}function bt(tt,vt){var He=Ae.getAllBufferRanges(),ft=0,$t=0,vn=null,yn=null,On=0,nr,Un,Br=isNaN(vt)?.15:vt;if(He!=null){for(Un=0,nr=He.length;Un<nr;Un++)if(ft=He.start(Un),$t=He.end(Un),vn===null)On=Math.abs(ft-tt),(tt>=ft&&tt<$t||On<=Br)&&(vn=ft,yn=$t);else if(On=ft-yn,On<=Br)yn=$t;else break;if(vn!==null)return{start:vn,end:yn}}return null}function Ft(tt,vt){var He,ft;return Z.get().streaming.gaps.jumpGaps&&(vt=Z.get().streaming.gaps.smallGapLimit),He=bt(tt,vt),He===null?ft=0:ft=He.end-tt,ft}function Dt(){if(se){var tt=Z.get().streaming.gaps.jumpGaps&&!isNaN(Z.get().streaming.gaps.smallGapLimit)?Z.get().streaming.gaps.smallGapLimit:NaN;de=Math.max(Ft(se.getTime()||0,tt),0),Mt(T.default.BUFFER_LEVEL_UPDATED,{mediaType:_e,bufferLevel:de}),on()}}function Kt(){var tt=Le>=De-1,vt=se.getTimeToStreamEnd(ve)-de<1e-5;(tt||vt)&&!Me&&(en(!0),Se.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED for stream id ".concat(ve.id," and type ").concat(_e)))}function on(){_e!==m.default.AUDIO&&_e!==m.default.VIDEO||((!se.getLowLatencyModeEnabled()&&de<Z.get().streaming.buffer.stallThreshold||de===0)&&!Me?Tn(g.default.BUFFER_EMPTY):(Me||de>=Z.get().streaming.buffer.stallThreshold||se.getLowLatencyModeEnabled()&&de>0)&&Tn(g.default.BUFFER_LOADED))}function Tn(tt){Re===tt||tt===g.default.BUFFER_EMPTY&&se.getTime()===0||_e===m.default.TEXT&&!ie.isTextEnabled()||(Re=tt,Mt(T.default.BUFFER_LEVEL_STATE_CHANGED,{state:tt}),Mt(tt===g.default.BUFFER_LOADED?T.default.BUFFER_LOADED:T.default.BUFFER_EMPTY),Se.debug(tt===g.default.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"))}function Ke(){!Ae||_e===m.default.TEXT||Me||wt(ut())}function ut(){var tt=[],vt=Ae.getAllBufferRanges();if(!vt||vt.length===0)return tt;var He=se.getTime(),ft=Math.max(0,He-Z.get().streaming.buffer.bufferToKeep),$t=J.getRequests({state:v.default.FRAGMENT_MODEL_EXECUTED,time:He,threshold:B})[0];if($t)ft=Math.min($t.startTime,ft);else if(He===0&&se.getIsDynamic())return[];if(vt.start(0)<=ft){for(var vn={start:0,end:ft},yn=0;yn<vt.length&&vt.end(yn)<=ft;yn++)vn.end=vt.end(yn);vn.start<vn.end&&tt.push(vn)}return tt}function wt(tt){return new Promise(function(vt,He){if(!tt||!Ae||tt.length===0){vt();return}var ft=[];tt.forEach(function($t){ft.push(Gt($t))}),j||Qt(),Promise.all(ft).then(function(){vt()}).catch(function($t){He($t)})})}function Gt(tt){return new Promise(function(vt,He){tt.resolve=vt,tt.reject=He,oe.push(tt)})}function Qt(){try{if(oe.length===0||!Ae){Se.debug("Nothing to prune, halt pruning"),oe=[],j=!1;return}var tt=Ae.getBuffer();if(!tt||!tt.buffered||tt.buffered.length===0){Se.debug("SourceBuffer is empty (or does not exist), halt pruning"),oe=[],j=!1;return}var vt=oe.shift();Se.debug("".concat(_e,": Removing buffer from: ").concat(vt.start," to ").concat(vt.end)),j=!0;var He=se.getTime();He<vt.end&&en(!1),Ae.remove(vt).then(function(ft){sn(ft)}).catch(function(ft){sn(ft)})}catch{j=!1}}function sn(tt){Se.debug("onRemoved buffer from:",tt.from,"to",tt.to);var vt=Ae.getAllBufferRanges();Wt(vt),oe.length===0&&(j=!1,Dt()),tt.unintended&&(Se.warn("Detected unintended removal from:",tt.from,"to",tt.to,"setting streamprocessor time to",tt.from),Mt(T.default.SEEK_TARGET,{time:tt.from})),j?Qt():(X?X=!1:Dt(),Mt(T.default.BUFFER_CLEARED,{from:tt.from,to:tt.to,unintended:tt.unintended,hasEnoughSpaceToAppend:mr(),quotaExceeded:$}))}function Dn(tt){return new Promise(function(vt){if(!tt||tt.MSETimeOffset===void 0||!Ae||!Ae.updateTimestampOffset){vt();return}Ae.updateTimestampOffset(tt.MSETimeOffset).then(function(){vt()}).catch(function(){vt()})})}function pn(){return Ae&&!Me?Ae.updateAppendWindow(ve):Promise.resolve()}function sr(tt){isNaN(tt)||(De=tt,Kt())}function Be(){V++;var tt=V*(Z.get().streaming.wallclockTimeUpdateInterval/1e3);tt>=Z.get().streaming.buffer.bufferPruningInterval&&(V=0,Ke())}function Tt(){on()}function Xt(){return Ae}function et(){return de}function gt(){return Fe}function At(){return Me}function en(tt){Me!==tt&&(Me=tt,Me?Mt(T.default.BUFFERING_COMPLETED):De=Number.POSITIVE_INFINITY)}function Nn(){return j}function _n(){try{var tt=Ae.getAllBufferRanges(),vt=0,He,ft;if(!tt)return vt;for(ft=0,He=tt.length;ft<He;ft++)vt+=tt.end(ft)-tt.start(ft);return vt}catch{return 0}}function En(tt){try{var vt=tt,He=Ae.getAllBufferRanges();if(!He||He.length===0)return NaN;for(var ft=0;vt===tt&&ft<He.length;){var $t=He.start(ft),vn=He.end(ft);vt>=$t&&vt<=vn&&(vt=vn),ft+=1}return vt===tt?NaN:vt}catch{}}function mr(){var tt=_n();return isNaN(tt)||tt<xe}function jn(tt){z=tt}function Mt(tt,vt){var He=vt||{};W.trigger(tt,He,{streamId:ve.id,mediaType:_e})}function gn(tt,vt){if(xe=Number.POSITIVE_INFINITY,Re=void 0,De=Number.POSITIVE_INFINITY,Le=0,me=null,Me=!1,j=!1,$=!1,de=0,V=0,oe=[],z=NaN,Ae){var He=Ae;Ae=null,!tt&&!vt&&He.abort().then(function(){He.reset(vt),He=null})}X=!1}function cn(tt,vt){W.off(T.default.INIT_FRAGMENT_LOADED,lt,this),W.off(T.default.MEDIA_FRAGMENT_LOADED,st,this),W.off(T.default.WALLCLOCK_TIME_UPDATED,Be,this),W.off(D.default.PLAYBACK_PLAYING,ct,this),W.off(D.default.PLAYBACK_PROGRESS,Oe,this),W.off(D.default.PLAYBACK_TIME_UPDATED,Oe,this),W.off(D.default.PLAYBACK_RATE_CHANGED,Tt,this),W.off(D.default.PLAYBACK_STALLED,ze,this),gn(tt,vt)}return Ee={initialize:fe,getStreamId:Ce,getType:Pe,getBufferControllerType:he,createBufferSink:$e,dischargePreBuffer:Pt,getBuffer:Xt,getBufferLevel:et,getRangeAt:bt,hasBufferAtTime:dt,pruneBuffer:Ke,setMediaSource:Ue,getMediaSource:gt,appendInitSegmentFromCache:Ye,getIsBufferingCompleted:At,setIsBufferingCompleted:en,getIsPruningInProgress:Nn,reset:cn,prepareForPlaybackSeek:St,prepareForReplacementTrackSwitch:Ut,prepareForNonReplacementTrackSwitch:Zt,prepareForReplacementQualitySwitch:Vt,updateAppendWindow:pn,getAllRangesWithSafetyFactor:In,getContinuousBufferTimeForTargetTime:En,clearBuffers:wt,pruneAllSafely:We,updateBufferTimestampOffset:Dn,setSeekTarget:jn,segmentRequestingCompleted:sr},ne(),Ee}U.__dashjs_factory_name=I;const w=C.default.getClassFactory(U)},"./src/streaming/controllers/CatchupController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>b});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/Debug.js"),v=d("./src/core/EventBus.js"),_=d("./src/streaming/constants/Constants.js"),S=d("./src/streaming/MediaPlayerEvents.js"),E=d("./src/core/events/Events.js"),T=d("./src/streaming/constants/MetricsConstants.js"),C=d("./src/core/Utils.js");function R(){var F=this.context,O=(0,v.default)(F).getInstance(),L,D,x,B,M,I,U,w,k,K;function W(){J(),ge()}function Y(pe){pe&&(pe.settings&&(M=pe.settings),pe.videoModel&&(B=pe.videoModel),pe.streamController&&(I=pe.streamController),pe.playbackController&&(U=pe.playbackController),pe.mediaPlayerModel&&(w=pe.mediaPlayerModel))}function J(){O.on(S.default.BUFFER_LEVEL_UPDATED,ve,L),O.on(S.default.BUFFER_LEVEL_STATE_CHANGED,_e,L),O.on(S.default.PLAYBACK_PROGRESS,Ee,L),O.on(S.default.PLAYBACK_TIME_UPDATED,Ee,L),O.on(S.default.PLAYBACK_SEEKED,se,L),O.on(E.default.SETTING_UPDATED_CATCHUP_ENABLED,Z,L),O.on(E.default.SETTING_UPDATED_PLAYBACK_RATE_MIN,ge,L),O.on(E.default.SETTING_UPDATED_PLAYBACK_RATE_MAX,ge,L),O.on(S.default.STREAM_INITIALIZED,ge,L)}function ee(){O.off(S.default.BUFFER_LEVEL_UPDATED,ve,L),O.off(S.default.BUFFER_LEVEL_STATE_CHANGED,_e,L),O.off(S.default.PLAYBACK_PROGRESS,Ee,L),O.off(S.default.PLAYBACK_TIME_UPDATED,Ee,L),O.off(S.default.PLAYBACK_SEEKED,Ee,L),O.off(E.default.SETTING_UPDATED_CATCHUP_ENABLED,Z,L),O.off(E.default.SETTING_UPDATED_PLAYBACK_RATE_MIN,ge,L),O.off(E.default.SETTING_UPDATED_PLAYBACK_RATE_MAX,ge,L),O.off(S.default.STREAM_INITIALIZED,ge,L)}function ue(){K=(0,g.default)(F).getInstance().getLogger(L),Q()}function ie(){ee(),Q(),B.setPlaybackRate(1,!0)}function Q(){D=!1;var pe=C.default.parseUserAgent();x=pe&&pe.browser&&pe.browser.name&&pe.browser.name.toLowerCase()==="safari"}function se(){D=!1}function ve(pe){if(!(pe.streamId!==I.getActiveStreamInfo().id||!k)){var Re=U.getLiveDelay(),me=U.getBufferLevel();me>Re/2&&(k=!1)}}function _e(pe){pe.streamId===I.getActiveStreamInfo().id&&(k=pe.state===T.default.BUFFER_EMPTY)}function Z(){w.getCatchupModeEnabled()||B.setPlaybackRate(1)}function Ee(){U.getIsDynamic()&&w.getCatchupModeEnabled()&&(w.getCatchupPlaybackRates().max>0||w.getCatchupPlaybackRates().min<0)&&!U.isPaused()&&!U.isSeeking()&&de()&&Se()}function Se(){if(!D&&B){var pe,Re=B.getPlaybackRate(),me=w.getCatchupPlaybackRates(),V=U.getBufferLevel(),j=Me(),$=w.getCatchupMaxDrift();if(!isNaN($)&&$>0&&j>$)K.info("[CatchupController]: Low Latency catchup mechanism. Latency too high, doing a seek to live point"),D=!0,U.seekToCurrentLive(!0,!1);else{var re=U.getCurrentLiveLatency(),oe=U.getLiveDelay();if(xe()===_.default.LIVE_CATCHUP_MODE_LOLP){var X=M.get().streaming.liveCatchup.playbackBufferMin;pe=Ae(me,re,oe,X,V)}else pe=De(me,re,oe,V);var z=x?.25:.02/(.5/me.max);pe&&Math.abs(Re-pe)>=z&&(K.debug("[CatchupController]: Setting playback rate to ".concat(pe)),B.setPlaybackRate(pe))}}}function Me(){var pe=U.getCurrentLiveLatency(),Re=U.getLiveDelay();return pe-Re}function de(){try{if(!U.getTime()>0||D)return!1;var pe=xe();if(pe===_.default.LIVE_CATCHUP_MODE_LOLP){var Re=U.getBufferLevel(),me=M.get().streaming.liveCatchup.playbackBufferMin;return Le(Re,me)}else return Fe()}catch{return!1}}function xe(){var pe=M.get().streaming.liveCatchup.playbackBufferMin;return M.get().streaming.liveCatchup.mode===_.default.LIVE_CATCHUP_MODE_LOLP&&pe!==null&&!isNaN(pe)?_.default.LIVE_CATCHUP_MODE_LOLP:_.default.LIVE_CATCHUP_MODE_DEFAULT}function Fe(){try{var pe=Math.abs(Me());return pe>0}catch{return!1}}function Le(pe,Re){try{var me=Math.abs(Me());return me>0||pe<Re}catch{return!1}}function De(pe,Re,me,V){if(k)return 1;var j=Re-me,$=j<0?Math.abs(pe.min):pe.max,re=j*5,oe=$*2/(1+Math.pow(Math.E,-re)),X=1-$+oe;return U.getPlaybackStalled()&&V<=me/2&&j>0&&(X=1),X}function Ae(pe,Re,me,V,j){var $;if(j<V){var re=Math.abs(pe.min),oe=j-V,X=oe*5,z=re*2/(1+Math.pow(Math.E,-X));$=1-re+z,K.debug("[LoL+ playback control_buffer-based] bufferLevel: "+j+", newRate: "+$)}else{var ne=pe.max,fe=.02;if(Math.abs(Re-me)<=fe*me)$=1;else{var Ce=Re-me,Pe=Ce*5,he=ne*2/(1+Math.pow(Math.E,-Pe));$=1-ne+he}K.debug("[LoL+ playback control_latency-based] latency: "+Re+", newRate: "+$)}return $}function ge(){w.getCatchupPlaybackRates(!0)}return L={reset:ie,setConfig:Y,initialize:W},ue(),L}R.__dashjs_factory_name="CatchupController";const b=m.default.getSingletonFactory(R)},"./src/streaming/controllers/EventController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>T});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/Debug.js"),v=d("./src/core/EventBus.js"),_=d("./src/streaming/MediaPlayerEvents.js"),S=d("./src/streaming/net/XHRLoader.js");function E(){var C="urn:mpeg:dash:event:2012",R=1,b="urn:mpeg:dash:event:callback:2015",F=1,O=300,L={DISCARDED:"discarded",UPDATED:"updated",ADDED:"added"},D=this.context,x=(0,v.default)(D).getInstance(),B,M,I,U,w,k,K,W,Y,J,ee;function ue(){M=(0,g.default)(D).getInstance().getLogger(B),Q()}function ie(){if(!K||!W)throw new Error("setConfig function has to be called previously")}function Q(){ee=!1,I={},U={},w=null,J=!1,k=Date.now()/1e3}function se(){try{w!==null&&ee&&(clearInterval(w),w=null,ee=!1,Fe())}catch(X){throw X}}function ve(){try{ie(),M.debug("Start Event Controller");var X=Y.get().streaming.eventControllerRefreshDelay;!ee&&!isNaN(X)&&(ee=!0,w=setInterval(_e,X))}catch(z){throw z}}function _e(){try{if(!J){J=!0;var X=W.getTime(),z=X-k;z=k>0?Math.max(0,z):0,Z(U,z,X),Z(I,z,X),Ee(U),Ee(I),k=X,J=!1}}catch(ne){J=!1,M.error(ne)}}function Z(X,z,ne){try{var fe=function(Pe){if(Pe!==void 0){var he=isNaN(Pe.duration)?0:Pe.duration;Pe.calculatedPresentationTime<=ne&&Pe.calculatedPresentationTime+z+he>=ne?pe(Pe,_.default.EVENT_MODE_ON_START):(Ae(ne,he+z,Pe.calculatedPresentationTime)||ge(Pe))&&(M.debug("Removing event ".concat(Pe.id," from period ").concat(Pe.eventStream.period.id," as it is expired or invalid")),Re(X,Pe))}};De(X,fe)}catch(Ce){M.error(Ce)}}function Ee(X){try{for(var z in X)X.hasOwnProperty(z)&&Object.keys(X[z]).length===0&&delete X[z]}catch(ne){M.error(ne)}}function Se(X,z){try{if(ie(),I[z]||(I[z]={}),X)for(var ne=0;ne<X.length;ne++){var fe=X[ne],Ce=W.getTime(),Pe=isNaN(fe.duration)?0:fe.duration;if(!Ae(Ce,Pe,fe.calculatedPresentationTime)){var he=de(fe,I[z],!0);he===L.ADDED?(M.debug("Added inline event with id ".concat(fe.id," from period ").concat(z)),pe(fe,_.default.EVENT_MODE_ON_RECEIVE)):he===L.UPDATED&&M.debug("Updated inline event with id ".concat(fe.id," from period ").concat(z))}}}catch(Ue){throw Ue}}function Me(X,z){try{ie(),U[z]||(U[z]={});for(var ne=0;ne<X.length;ne++){var fe=X[ne],Ce=W.getTime(),Pe=isNaN(fe.duration)?0:fe.duration;if(!Ae(Ce,Pe,fe.calculatedPresentationTime)){var he=de(fe,U[z],!1);he===L.ADDED?(fe.eventStream.schemeIdUri===C&&xe(fe),M.debug("Added inband event with id ".concat(fe.id," from period ").concat(z)),pe(fe,_.default.EVENT_MODE_ON_RECEIVE)):M.debug("Inband event with scheme_id_uri ".concat(fe.eventStream.schemeIdUri,", value ").concat(fe.eventStream.value,", period id ").concat(z," and event id ").concat(fe.id," was ignored because it has been added before."))}}_e()}catch(Ue){throw Ue}}function de(X,z){var ne=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,fe=X.eventStream.schemeIdUri,Ce=X.eventStream.value,Pe=X.id,he=L.DISCARDED;z[fe]||(z[fe]=[]);var Ue=z[fe].findIndex(function($e){return(!Ce||$e.eventStream.value&&$e.eventStream.value===Ce)&&$e.id===Pe});if(Ue===-1)z[fe].push(X),X.triggeredReceivedEvent=!1,X.triggeredStartEvent=!1,he=L.ADDED;else if(ne){var we=z[fe][Ue];X.triggeredReceivedEvent=we.triggeredReceivedEvent,X.triggeredStartEvent=we.triggeredStartEvent,z[fe][Ue]=X,he=L.UPDATED}return he}function xe(X){try{if(X.eventStream.value==R){var z=X.calculatedPresentationTime,ne;X.calculatedPresentationTime==4294967295?ne=NaN:ne=X.calculatedPresentationTime+X.duration,x.trigger(_.default.MANIFEST_VALIDITY_CHANGED,{id:X.id,validUntil:z,newDuration:ne,newManifestValidAfter:NaN},{mode:_.default.EVENT_MODE_ON_START})}}catch(fe){M.error(fe)}}function Fe(){try{Le(U),Le(I)}catch(X){M.error(X)}}function Le(X){try{var z=W.getTime(),ne=function(Ce){var Pe=Ce.eventStream&&Ce.eventStream.period&&!isNaN(Ce.eventStream.period.duration)?Ce.eventStream.period.duration:NaN,he=Ce.eventStream&&Ce.eventStream.period&&!isNaN(Ce.eventStream.period.start)?Ce.eventStream.period.start:NaN;if(!(isNaN(Pe)||isNaN(he))){var Ue=Ce.calculatedPresentationTime;Math.abs(Ue-z)<O&&pe(Ce,_.default.EVENT_MODE_ON_START)}};De(X,ne)}catch(fe){M.error(fe)}}function De(X,z){try{if(X)for(var ne=Object.keys(X),fe=0;fe<ne.length;fe++)for(var Ce=X[ne[fe]],Pe=Object.keys(Ce),he=0;he<Pe.length;he++){var Ue=Ce[Pe[he]];Ue.forEach(function(we){we!==void 0&&z(we)})}}catch(we){M.error(we)}}function Ae(X,z,ne){try{return X-z>ne}catch(fe){return M.error(fe),!1}}function ge(X){try{var z=X.eventStream.period.start+X.eventStream.period.duration;return X.calculatedPresentationTime>z}catch(ne){return M.error(ne),!1}}function pe(X,z){try{var ne=W.getTime(),fe=X.id;if(z===_.default.EVENT_MODE_ON_RECEIVE&&!X.triggeredReceivedEvent){M.debug("Received event ".concat(fe)),X.triggeredReceivedEvent=!0,x.trigger(X.eventStream.schemeIdUri,{event:X},{mode:z});return}X.triggeredStartEvent||(X.eventStream.schemeIdUri===C&&X.eventStream.value==R?(X.duration!==0||X.presentationTimeDelta!==0)&&(M.debug("Starting manifest refresh event ".concat(fe," at ").concat(ne)),me()):X.eventStream.schemeIdUri===b&&X.eventStream.value==F?(M.debug("Starting callback event ".concat(fe," at ").concat(ne)),V(X.messageData)):(M.debug("Starting event ".concat(fe," from period ").concat(X.eventStream.period.id," at ").concat(ne)),x.trigger(X.eventStream.schemeIdUri,{event:X},{mode:z})),X.triggeredStartEvent=!0)}catch(Ce){M.error(Ce)}}function Re(X,z){try{var ne=z.eventStream.schemeIdUri,fe=z.eventStream.period.id,Ce=z.eventStream.value,Pe=z.id;X[fe][ne]=X[fe][ne].filter(function(he){return Ce&&he.eventStream.value&&he.eventStream.value!==Ce||he.id!==Pe}),X[fe][ne].length===0&&delete X[fe][ne]}catch(he){M.error(he)}}function me(){try{ie(),K.refreshManifest()}catch(X){M.error(X)}}function V(X){try{var z=(0,S.default)(D).create({});z.load({method:"get",url:X,request:{responseType:"arraybuffer"}})}catch(ne){M.error(ne)}}function j(X){try{if(!X)return;X.manifestUpdater&&(K=X.manifestUpdater),X.playbackController&&(W=X.playbackController),X.settings&&(Y=X.settings)}catch(z){throw z}}function $(){return I}function re(){return U}function oe(){se(),Q()}return B={addInlineEvents:Se,addInbandEvents:Me,getInbandEvents:re,getInlineEvents:$,start:ve,setConfig:j,reset:oe},ue(),B}E.__dashjs_factory_name="EventController";const T=m.default.getSingletonFactory(E)},"./src/streaming/controllers/FragmentController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>D});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/streaming/vo/DataChunk.js"),v=d("./src/streaming/models/FragmentModel.js"),_=d("./src/streaming/FragmentLoader.js"),S=d("./src/streaming/utils/RequestModifier.js"),E=d("./src/core/EventBus.js"),T=d("./src/core/events/Events.js"),C=d("./src/streaming/MediaPlayerEvents.js"),R=d("./src/core/errors/Errors.js"),b=d("./src/core/FactoryMaker.js"),F=d("./src/core/Debug.js"),O=d("./src/streaming/utils/SegmentResponseModifier.js");function L(x){x=x||{};var B=this.context,M=(0,E.default)(B).getInstance(),I=x.errHandler,U=x.mediaPlayerModel,w=x.dashMetrics,k=(0,F.default)(B).getInstance(),K=(0,O.default)(B).getInstance(),W=x.streamInfo,Y,J,ee;function ue(){J=k.getLogger(Y),se(),M.on(C.default.FRAGMENT_LOADING_COMPLETED,Z,Y),M.on(C.default.FRAGMENT_LOADING_PROGRESS,Z,Y)}function ie(){return W.id}function Q(Ee){var Se=ee[Ee];return Se||(Se=(0,v.default)(B).create({streamInfo:W,type:Ee,dashMetrics:w,fragmentLoader:(0,_.default)(B).create({dashMetrics:w,mediaPlayerModel:U,errHandler:I,requestModifier:(0,S.default)(B).getInstance(),settings:x.settings,boxParser:x.boxParser,eventBus:M,events:T.default,errors:R.default,dashConstants:x.dashConstants,urlUtils:x.urlUtils,streamId:ie()}),debug:k,eventBus:M,events:T.default}),ee[Ee]=Se),Se}function se(){for(var Ee in ee)ee[Ee].reset();ee={}}function ve(){M.off(C.default.FRAGMENT_LOADING_COMPLETED,Z,this),M.off(C.default.FRAGMENT_LOADING_PROGRESS,Z,this),se()}function _e(Ee,Se,Me,de){var xe=new g.default;return xe.streamId=Me,xe.mediaInfo=Se.mediaInfo,xe.segmentType=Se.type,xe.start=Se.startTime,xe.duration=Se.duration,xe.end=xe.start+xe.duration,xe.bytes=Ee,xe.index=Se.index,xe.quality=Se.quality,xe.representationId=Se.representationId,xe.endFragment=de,xe}function Z(Ee){if(Ee.sender){var Se=Ee.request,Me=Ee.response,de=Se.isInitializationRequest(),xe=Se.mediaInfo.streamInfo;if(Ee.error&&(Se.mediaType===m.default.AUDIO||Se.mediaType===m.default.VIDEO||Se.mediaType===m.default.TEXT&&Se.mediaInfo.isFragmented)&&M.trigger(T.default.SERVICE_LOCATION_BLACKLIST_ADD,{entry:Ee.request.serviceLocation}),!Me||!xe){J.warn("No "+Se.mediaType+" bytes to push or stream is inactive.");return}var Fe=_e(Me,Se,W.id,Ee.type!==T.default.FRAGMENT_LOADING_PROGRESS);K.modifyResponseAsync(Fe).then(function(Le){M.trigger(de?T.default.INIT_FRAGMENT_LOADED:T.default.MEDIA_FRAGMENT_LOADED,{chunk:Le,request:Se},{streamId:xe.id,mediaType:Se.mediaType})}).catch(function(Le){J.error(Le),M.trigger(de?T.default.INIT_FRAGMENT_LOADED:T.default.MEDIA_FRAGMENT_LOADED,{chunk:Fe,request:Se},{streamId:xe.id,mediaType:Se.mediaType})})}}return Y={getStreamId:ie,getModel:Q,reset:ve},ue(),Y}L.__dashjs_factory_name="FragmentController";const D=b.default.getClassFactory(L)},"./src/streaming/controllers/GapController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>b});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/Debug.js"),v=d("./src/core/events/Events.js"),_=d("./src/core/EventBus.js"),S=d("./src/streaming/constants/Constants.js"),E=100,T=10,C=.1;function R(){var F=this.context,O=(0,_.default)(F).getInstance(),L,D,x,B,M,I,U,w,k,K,W,Y;function J(){se()}function ee(){Y=(0,g.default)(F).getInstance().getLogger(L),ue()}function ue(){Ae(),ve(),ie()}function ie(){M=null,I=NaN,B=0,K=null,W={}}function Q(pe){pe&&(pe.settings&&(x=pe.settings),pe.playbackController&&(U=pe.playbackController),pe.streamController&&(w=pe.streamController),pe.videoModel&&(k=pe.videoModel))}function se(){O.on(v.default.WALLCLOCK_TIME_UPDATED,Me,this),O.on(v.default.INITIAL_STREAM_SWITCH,Se,this),O.on(v.default.PLAYBACK_SEEKING,_e,this),O.on(v.default.BUFFER_REPLACEMENT_STARTED,Z,L),O.on(v.default.TRACK_CHANGE_RENDERED,Ee,L)}function ve(){O.off(v.default.WALLCLOCK_TIME_UPDATED,Me,this),O.off(v.default.INITIAL_STREAM_SWITCH,Se,this),O.off(v.default.PLAYBACK_SEEKING,_e,this),O.off(v.default.BUFFER_REPLACEMENT_STARTED,Z,L),O.off(v.default.TRACK_CHANGE_RENDERED,Ee,L)}function _e(){K&&(clearTimeout(K),K=null)}function Z(pe){try{if(pe.streamId!==w.getActiveStreamInfo().id||pe.mediaType!==S.default.VIDEO&&pe.mediaType!==S.default.AUDIO)return;pe.streamId===w.getActiveStreamInfo().id&&(W[pe.mediaType]=!0)}catch(Re){Y.error(Re)}}function Ee(pe){!pe||!pe.mediaType||(W[pe.mediaType]=!1)}function Se(){M||De()}function Me(){if(de(x.get().streaming.gaps.enableSeekFix)&&(B++,B>=T)){var pe=U.getTime();D===pe?ge(pe,!0):(D=pe,I=NaN),B=0}}function de(){var pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!w.getActiveStream())return!1;var Re=Object.keys(W).some(function(V){return W[V]}),me=pe?xe():!1;return!Re&&x.get().streaming.gaps.jumpGaps&&w.getActiveStreamProcessors().length>0&&(!U.isSeeking()||me)&&!U.isPaused()&&!w.getIsStreamSwitchInProgress()&&!w.getHasMediaOrInitialisationError()}function xe(){var pe=w.getActiveStream(),Re=parseFloat((pe.getStartTime()+pe.getDuration()).toFixed(5));return U.getTime()+x.get().streaming.gaps.threshold>=Re}function Fe(pe,Re){try{if(!pe||pe.length<=1&&Re>0)return NaN;for(var me=NaN,V=0;isNaN(me)&&V<pe.length;){var j=V>0?pe.end(V-1):0;Re<pe.start(V)&&j-Re<x.get().streaming.gaps.threshold&&(me=V),V+=1}return me}catch{return null}}function Le(pe,Re){for(var me=0,V=pe.length;me<V;me++)if(Re>=pe.start(me)&&Re<=pe.end(me))return!0;return!1}function De(){try{M||(Y.debug("Starting the gap controller"),M=setInterval(function(){if(de()){var pe=U.getTime();ge(pe)}},E))}catch{}}function Ae(){Y.debug("Stopping the gap controller"),M&&(clearInterval(M),M=null)}function ge(pe){var Re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,me=x.get().streaming.gaps.enableStallFix,V=x.get().streaming.gaps.stallSeek,j=x.get().streaming.gaps.smallGapLimit,$=x.get().streaming.gaps.jumpLargeGaps,re=k.getBufferRange(),oe,X=NaN,z=!1;if(oe=Fe(re,pe),!isNaN(oe)){var ne=re.start(oe),fe=ne-pe;fe>0&&(fe<=j||$)&&(X=ne)}var Ce=U.getTimeToStreamEnd();if(isNaN(X)&&Re&&isFinite(Ce)&&!isNaN(Ce)&&Ce<j&&(X=parseFloat(U.getStreamEndTime().toFixed(5)),z=!0),me&&isNaN(X)&&Re&&isNaN(oe)&&Le(re,pe)&&(V===0?(Y.warn("Toggle play pause to break stall"),k.pause(),k.play()):(Y.warn("Jumping ".concat(V,"s to break stall")),X=pe+V)),X>0&&I!==X&&X>pe&&!K){var Pe=X-pe;if(z){var he=w.getStreamForTime(X),Ue=he&&!!he.getPreloaded();Y.warn("Jumping to end of stream because of gap from ".concat(pe," to ").concat(X,". Gap duration: ").concat(Pe)),U.seek(X,!0,Ue)}else{var we=U.getIsDynamic(),$e=oe>0?re.end(oe-1):pe,it=we?Math.max(0,Pe-C)*1e3:0;K=window.setTimeout(function(){U.seek(X,!0,!0),Y.warn("Jumping gap occuring in period ".concat(w.getActiveStream().getStreamId()," starting at ").concat($e," and ending at ").concat(X,". Jumping by: ").concat(X-$e)),K=null},it)}I=X}}return L={reset:ue,setConfig:Q,initialize:J},ee(),L}R.__dashjs_factory_name="GapController";const b=m.default.getSingletonFactory(R)},"./src/streaming/controllers/MediaController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>F});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/core/events/Events.js"),v=d("./src/core/EventBus.js"),_=d("./src/core/FactoryMaker.js"),S=d("./src/core/Debug.js"),E=d("./node_modules/bcp-47-normalize/index.js"),T=d.n(E),C=d("./node_modules/bcp-47-match/index.js");function R(){var O=this.context,L=(0,v.default)(O).getInstance(),D,x,B,M,I,U,w,k;function K(){x=(0,S.default)(O).getInstance().getLogger(D),Se()}function W(Pe,he){var Ue=U[Pe]||se(Pe),we=J(Pe,he.id),$e=[];Ue||(Ue=k.getSavedMediaSettings(Pe),Q(Pe,Ue)),!(!we||we.length===0)&&(Ue&&($e=Array.from(we),$e=de($e,xe,Ue),$e=de($e,Fe,Ue),$e=de($e,Le,Ue),Pe===m.default.AUDIO&&U[Pe]||($e=de($e,De,Ue)),$e=de($e,Ae,Ue),$e=de($e,ge,Ue)),$e.length===0?ie(re(Pe,we),!0):$e.length>1?ie(re(Pe,$e,!!U[Pe])):ie($e[0]))}function Y(Pe){if(Pe){var he=Pe.type;if(_e(he)){var Ue=Pe.streamInfo.id;B[Ue]||(B[Ue]=Ce());for(var we=B[Ue][he].list,$e=0,it=we.length;$e<it;++$e)if(Z(we[$e],Pe))return;we.push(Pe)}}}function J(Pe,he){return Pe?!B[he]||!B[he][Pe]?[]:B[he][Pe].list:[]}function ee(Pe,he){return!Pe||!B[he]||!B[he][Pe]?null:B[he][Pe].current}function ue(Pe){if(!Pe)return!1;var he=Pe.type,Ue=Pe.streamInfo.id;return B[Ue]&&B[Ue][he]&&Z(B[Ue][he].current,Pe)}function ie(Pe){var he=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!(!Pe||!Pe.streamInfo)){var Ue=Pe.type,we=Pe.streamInfo,$e=we.id,it=ee(Ue,$e);if(!(!B[$e]||!B[$e][Ue])&&(B[$e][Ue].current=Pe,B[$e][Ue].current&&(Ue!==m.default.TEXT&&!Z(Pe,it)||Ue===m.default.TEXT&&Pe.isFragmented)&&L.trigger(g.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:it,newMediaInfo:Pe,switchMode:M.get().streaming.trackSwitchMode[Ue]},{streamId:$e}),!he)){var mt=Me(Pe);if(!mt||!B[$e][Ue].storeLastSettings)return;mt.roles&&(mt.role=mt.roles[0],delete mt.roles),mt.accessibility&&(mt.accessibility=mt.accessibility[0]),mt.audioChannelConfiguration&&(mt.audioChannelConfiguration=mt.audioChannelConfiguration[0]),U[Ue]=mt,k.setSavedMediaSettings(Ue,mt)}}}function Q(Pe,he){!Pe||!he||(I[Pe]=he)}function se(Pe){return Pe?I[Pe]:null}function ve(){k.setSavedMediaSettings(m.default.TEXT,null)}function _e(Pe){return Pe===m.default.AUDIO||Pe===m.default.VIDEO||Pe===m.default.TEXT||Pe===m.default.IMAGE}function Z(Pe,he){if(!Pe&&!he)return!0;if(!Pe||!he)return!1;var Ue=Pe.id===he.id,we=Pe.viewpoint===he.viewpoint,$e=Pe.lang===he.lang,it=Pe.codec===he.codec,mt=Pe.roles.toString()===he.roles.toString(),pt=Pe.accessibility.toString()===he.accessibility.toString(),Pt=Pe.audioChannelConfiguration.toString()===he.audioChannelConfiguration.toString();return Ue&&it&&we&&$e&&mt&&pt&&Pt}function Ee(Pe){Pe&&(Pe.domStorage&&(k=Pe.domStorage),Pe.settings&&(M=Pe.settings),Pe.customParametersModel&&(w=Pe.customParametersModel))}function Se(){B={},U={},Re()}function Me(Pe){var he={lang:Pe.lang,viewpoint:Pe.viewpoint,roles:Pe.roles,accessibility:Pe.accessibility,audioChannelConfiguration:Pe.audioChannelConfiguration},Ue=he.lang||he.viewpoint||he.role&&he.role.length>0||he.accessibility&&he.accessibility.length>0||he.audioChannelConfiguration&&he.audioChannelConfiguration.length>0;return Ue?he:null}function de(Pe,he,Ue){var we=[];return Pe.forEach(function($e){he(Ue,$e)&&we.push($e)}),we.length!==0?we:Pe}function xe(Pe,he){return!Pe.lang||Pe.lang instanceof RegExp?he.lang.match(Pe.lang):he.lang!==""?(0,C.extendedFilter)(he.lang,T()(Pe.lang)).length>0:!1}function Fe(Pe,he){return Pe.index===void 0||Pe.index===null||he.index===Pe.index}function Le(Pe,he){return!Pe.viewpoint||Pe.viewpoint===he.viewpoint}function De(Pe,he){var Ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,we=!Pe.role||!!he.roles.filter(function($e){return $e===Pe.role})[0];return we||he.type===m.default.AUDIO&&Ue}function Ae(Pe,he){var Ue;return Pe.accessibility?Ue=!!he.accessibility.filter(function(we){return we===Pe.accessibility})[0]:Ue=!he.accessibility.length,Ue}function ge(Pe,he){var Ue=!Pe.audioChannelConfiguration||!!he.audioChannelConfiguration.filter(function(we){return we===Pe.audioChannelConfiguration})[0];return Ue}function pe(Pe,he){var Ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;try{var we=!1;if(!Pe.lang)we=!0;else if(Pe.lang instanceof RegExp)we=he.lang.match(Pe.lang);else if(he.lang!==""){var $e=T()(Pe.lang);$e&&(we=(0,C.extendedFilter)(he.lang,$e).length>0)}var it=Pe.index===void 0||Pe.index===null||he.index===Pe.index,mt=!Pe.viewpoint||Pe.viewpoint===he.viewpoint,pt=!Pe.role||!!he.roles.filter(function(Ye){return Ye===Pe.role})[0],Pt=!Pe.accessibility||!!he.accessibility.filter(function(Ye){return Ye===Pe.accessibility})[0],lt=!Pe.audioChannelConfiguration||!!he.audioChannelConfiguration.filter(function(Ye){return Ye===Pe.audioChannelConfiguration})[0];return we&&it&&mt&&(pt||he.type===m.default.AUDIO&&Ue)&&Pt&&lt}catch{return!1}}function Re(){I={audio:null,video:null,text:null}}function me(Pe){var he=0,Ue=[];return Pe.forEach(function(we){isNaN(we.selectionPriority)||(we.selectionPriority>he?(he=we.selectionPriority,Ue=[we]):we.selectionPriority===he&&Ue.push(we))}),Ue}function V(Pe){var he=0,Ue=[],we;return Pe.forEach(function($e){we=Math.max.apply(Math,$e.bitrateList.map(function(it){return it.bandwidth})),we>he?(he=we,Ue=[$e]):we===he&&Ue.push($e)}),Ue}function j(Pe){var he=1/0,Ue=[],we;return Pe.forEach(function($e){var it=$e.bitrateList.reduce(function(mt,pt){var Pt=Math.max(1,pt.width*pt.height),lt=pt.bandwidth/Pt;return mt+lt},0);we=it/$e.bitrateList.length,we<he?(he=we,Ue=[$e]):we===he&&Ue.push($e)}),Ue}function $(Pe){var he=0,Ue=[],we;return Pe.forEach(function($e){we=$e.representationCount,we>he?(he=we,Ue=[$e]):we===he&&Ue.push($e)}),Ue}function re(Pe,he){if(Pe===m.default.TEXT)return he[0];var Ue=M.get().streaming.selectionModeForInitialTrack,we,$e=w.getCustomInitialTrackSelectionFunction();if($e&&typeof $e=="function")we=$e(he);else switch(Ue){case m.default.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY:we=oe(he);break;case m.default.TRACK_SELECTION_MODE_HIGHEST_BITRATE:we=X(he);break;case m.default.TRACK_SELECTION_MODE_FIRST_TRACK:we=z(he);break;case m.default.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY:we=ne(he);break;case m.default.TRACK_SELECTION_MODE_WIDEST_RANGE:we=fe(he);break;default:x.warn("Track selection mode ".concat(Ue," is not supported. Falling back to TRACK_SELECTION_MODE_FIRST_TRACK")),we=z(he);break}return we.length>0?we[0]:he[0]}function oe(Pe){var he=me(Pe);return he.length>1&&(he=V(he)),he.length>1&&(he=$(he)),he}function X(Pe){var he=V(Pe);return he.length>1&&(he=$(he)),he}function z(Pe){return Pe[0]}function ne(Pe){var he=j(Pe);return he.length>1&&(he=V(he)),he}function fe(Pe){var he=$(Pe);return he.length>1&&(he=V(Pe)),he}function Ce(){return{audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}}}return D={setInitialMediaSettingsForType:W,addTrack:Y,getTracksFor:J,getCurrentTrackFor:ee,isCurrentTrack:ue,setTrack:ie,selectInitialTrack:re,setInitialSettings:Q,getInitialSettings:se,getTracksWithHighestBitrate:V,getTracksWithHighestEfficiency:j,getTracksWithWidestRange:$,isTracksEqual:Z,matchSettings:pe,matchSettingsLang:xe,matchSettingsIndex:Fe,matchSettingsViewPoint:Le,matchSettingsRole:De,matchSettingsAccessibility:Ae,matchSettingsAudioChannelConfig:ge,saveTextSettingsDisabled:ve,setConfig:Ee,reset:Se},K(),D}R.__dashjs_factory_name="MediaController";var b=_.default.getSingletonFactory(R);_.default.updateSingletonFactory(R.__dashjs_factory_name,b);const F=b},"./src/streaming/controllers/MediaSourceController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/Debug.js");function v(){var S,E,T,C=this.context;function R(){T=(0,g.default)(C).getInstance().getLogger(S)}function b(){var M="WebKitMediaSource"in window,I="MediaSource"in window;return I?E=new MediaSource:M&&(E=new WebKitMediaSource),E}function F(M){var I=window.URL.createObjectURL(E);return M.setSource(I),I}function O(M){M.setSource(null)}function L(M){!E||E.readyState!=="open"||M===null&&isNaN(M)||E.duration!==M&&(B(E)?setTimeout(L.bind(null,M),50):(T.info("Set MediaSource duration:"+M),E.duration=M))}function D(M,I){E&&typeof E.setLiveSeekableRange=="function"&&typeof E.clearLiveSeekableRange=="function"&&E.readyState==="open"&&M>=0&&M<I&&(E.clearLiveSeekableRange(),E.setLiveSeekableRange(M,I))}function x(M){if(!(!M||M.readyState!=="open")){for(var I=M.sourceBuffers,U=0;U<I.length;U++)if(I[U].updating||I[U].buffered.length===0)return;T.info("call to mediaSource endOfStream"),M.endOfStream()}}function B(M){for(var I=M.sourceBuffers,U=0;U<I.length;U++)if(I[U].updating)return!0;return!1}return S={createMediaSource:b,attachMediaSource:F,detachMediaSource:O,setDuration:L,setSeekable:D,signalEndOfStream:x},R(),S}v.__dashjs_factory_name="MediaSourceController";const _=m.default.getSingletonFactory(v)},"./src/streaming/controllers/PlaybackController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>b});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/core/EventBus.js"),v=d("./src/core/events/Events.js"),_=d("./src/core/FactoryMaker.js"),S=d("./src/core/Debug.js"),E=d("./src/streaming/MediaPlayerEvents.js"),T=d("./src/streaming/constants/MetricsConstants.js"),C=500;function R(){var F=this.context,O=(0,g.default)(F).getInstance(),L,D,x,B,M,I,U,w,k,K,W,Y,J,ee,ue,ie,Q,se,ve,_e,Z,Ee,Se,Me;function de(){D=(0,S.default)(F).getInstance().getLogger(L),xe()}function xe(){Re(),ee=!1,K=0,W=0,ie=0,Ee=!1,Q=!0,se=!1,Se=!1,ve=NaN,U&&(O.off(v.default.DATA_UPDATE_COMPLETED,Ht,L),O.off(v.default.LOADING_PROGRESS,wt,L),O.off(v.default.MANIFEST_UPDATED,pn,L),O.off(v.default.STREAMS_COMPOSED,sr,L),O.off(E.default.PLAYBACK_ENDED,Dt,L),O.off(E.default.STREAM_INITIALIZING,Qt,L),O.off(E.default.REPRESENTATION_SWITCH,sn,L),O.off(E.default.BUFFER_LEVEL_STATE_CHANGED,St,L),Wt(),Xt()),k=null,U=null,Y=null,J=null}function Fe(et,gt){Y=et,gt!==!0&&Le()}function Le(){Tt(),J=Y.manifestInfo.isDynamic,Z=!1,_e=!1,O.on(v.default.DATA_UPDATE_COMPLETED,Ht,L),O.on(v.default.LOADING_PROGRESS,wt,L),O.on(v.default.MANIFEST_UPDATED,pn,L),O.on(v.default.STREAMS_COMPOSED,sr,L),O.on(E.default.PLAYBACK_ENDED,Dt,L,{priority:g.default.EVENT_PRIORITY_HIGH}),O.on(E.default.STREAM_INITIALIZING,Qt,L),O.on(E.default.REPRESENTATION_SWITCH,sn,L),O.on(E.default.BUFFER_LEVEL_STATE_CHANGED,St,L),ee&&(ee=!1,pe())}function De(){return Z}function Ae(){var et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return parseFloat((ge(et)-oe()).toFixed(5))}function ge(et){var gt=et||Y;return gt.start+gt.duration}function pe(){var et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;Y&&U&&U.getElement()?(et&&J&&re(oe()),U.play()):ee=!0}function Re(){Y&&U&&U.pause()}function me(et){var gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,At=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,en=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!(!Y||!U)){var Nn=isNaN(ve)?U.getTime():ve;et!==Nn&&(_e=At===!0,_e||(ve=et),D.info("Requesting seek to time: "+et+(_e?" (internal)":"")),J&&en&&re(et),U.setCurrentTime(et,gt))}}function V(){var et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,At=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,en=$();if(en!==0){K=W;var Nn=en-K;me(Nn,et,gt,At)}}function j(){var et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,At=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,en=$();if(en!==0){var Nn=en-K;me(Nn,et,gt,At)}}function $(){if(!(!Y||!U||!J)){var et=x&&x.hasVideoTrack()?m.default.VIDEO:m.default.AUDIO,gt=M.getCurrentDVRInfo(et);return gt&&gt.range?gt.range.end:0}}function re(et){var gt=new Date(w.getClientReferenceTime()),At=I.getRegularPeriods()[0],en=w.calcPresentationTimeFromWallTime(gt,At);K=en-et}function oe(){return Y&&U?U.getTime():null}function X(){return Y&&U?U.isPaused():null}function z(){return Y&&U?U.isSeeking():null}function ne(){return Y&&U?U.isStalled():null}function fe(){return Y&&U?U.getPlaybackRate():null}function Ce(){return Y&&U?U.getPlayedRanges():null}function Pe(){return Y&&U?U.getEnded():null}function he(){return J}function Ue(){return x}function we(){return Ee}function $e(){return ie}function it(){return K}function mt(){return W}function pt(){if(!J||isNaN(ie))return NaN;var et=oe();if(isNaN(et)||et===0)return 0;var gt=new Date().getTime()+w.getClientTimeOffset()*1e3;return Math.max(((gt-ie-et*1e3)/1e3).toFixed(3),0)}function Pt(et,gt){var At,en,Nn,_n=4,En=4,mr=!isNaN(et)&&isFinite(et)?et:NaN,jn=I.getSuggestedPresentationDelay(),Mt=B.getServiceDescriptionSettings();return isNaN(Me.get().streaming.delay.liveDelay)?Me.get().streaming.delay.liveDelayFragmentCount!==null&&!isNaN(Me.get().streaming.delay.liveDelayFragmentCount)&&!isNaN(mr)?At=mr*Me.get().streaming.delay.liveDelayFragmentCount:Mt&&!isNaN(Mt.liveDelay)&&Mt.liveDelay>0?At=Mt.liveDelay:Me.get().streaming.delay.useSuggestedPresentationDelay===!0&&jn!==null&&!isNaN(jn)&&jn>0?At=jn:isNaN(mr)?At=gt&&!isNaN(gt.minBufferTime)?gt.minBufferTime*_n:Y.manifestInfo.minBufferTime*_n:At=mr*En:At=Me.get().streaming.delay.liveDelay,Nn=I.getAvailabilityStartTime(),Nn!==null&&(ie=Nn),gt&&gt.dvrWindowSize>0?en=Math.min(At,gt.dvrWindowSize):en=At,K=en,W=en,en}function lt(et){et&&(et.streamController&&(x=et.streamController),et.serviceDescriptionController&&(B=et.serviceDescriptionController),et.dashMetrics&&(M=et.dashMetrics),et.adapter&&(I=et.adapter),et.videoModel&&(U=et.videoModel),et.timelineConverter&&(w=et.timelineConverter),et.settings&&(Me=et.settings))}function Ye(){var et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(!(X()||!J||U.getReadyState()===0||z()||Ee)){et||(et=x.hasVideoTrack()?m.default.VIDEO:m.default.AUDIO);var gt=oe(),At=st(gt,et),en=!isNaN(At)&&At!==gt;en&&!z()&&(ne()||Z||U.getReadyState()===1)&&(D.debug("UpdateCurrentTime: Seek to actual time: ".concat(At," from currentTime: ").concat(gt)),me(At,!1,!1))}}function st(et,gt){var At=M.getCurrentDVRInfo(gt),en=At?At.range:null,Nn;return en?(et>en.end?Nn=Math.max(en.end-K,en.start):et>0&&et+.25<en.start&&Math.abs(et-en.start)<31536e4?se?Nn=Math.max(en.end-K,en.start):Nn=en.start:Nn=et,Nn):NaN}function Nt(){k===null&&(k=setInterval(function(){on()},Me.get().streaming.wallclockTimeUpdateInterval))}function Wt(){clearInterval(k),k=null}function Ht(et){var gt=I.convertRepresentationToRepresentationInfo(et.currentRepresentation),At=gt?gt.mediaInfo.streamInfo:null;At===null||Y.id!==At.id||(Y=At)}function nt(){O.trigger(v.default.CAN_PLAY)}function Et(){O.trigger(v.default.CAN_PLAY_THROUGH)}function St(et){et.streamId===x.getActiveStreamInfo().id&&(Z=et.state===T.default.BUFFER_EMPTY,Me.get().streaming.buffer.setStallState&&U.setStallState(et.mediaType,et.state===T.default.BUFFER_EMPTY))}function Ut(){D.info("Native video element event: play"),Ye(),Nt(),O.trigger(v.default.PLAYBACK_STARTED,{startTime:oe()})}function Vt(){D.info("Native video element event: waiting"),O.trigger(v.default.PLAYBACK_WAITING,{playingTime:oe()})}function Zt(){D.info("Native video element event: playing"),_e=!1,O.trigger(v.default.PLAYBACK_PLAYING,{playingTime:oe()})}function We(){D.info("Native video element event: pause"),O.trigger(v.default.PLAYBACK_PAUSED,{ended:Pe()})}function In(){if(!_e){var et=oe();!isNaN(ve)&&ve!==et&&(et=ve),ve=NaN,D.info("Seeking to: "+et),Nt(),O.trigger(v.default.PLAYBACK_SEEKING,{seekTime:et,streamId:Y.id})}}function Ct(){D.info("Native video element event: seeked"),_e=!1,O.trigger(v.default.PLAYBACK_SEEKED)}function je(){Y&&O.trigger(v.default.PLAYBACK_TIME_UPDATED,{timeToEnd:Ae(),time:oe(),streamId:Y.id})}function Oe(){O.trigger(v.default.PLAYBACK_PROGRESS,{streamId:Y.id})}function ze(){var et=fe();D.info("Native video element event: ratechange: ",et),O.trigger(v.default.PLAYBACK_RATE_CHANGED,{playbackRate:et})}function ct(){D.info("Native video element event: loadedmetadata"),O.trigger(v.default.PLAYBACK_METADATA_LOADED),Nt()}function dt(){D.info("Native video element event: loadeddata"),O.trigger(v.default.PLAYBACK_LOADED_DATA)}function bt(){D.info("Native video element event: ended"),Re(),Wt();var et=x?x.getActiveStreamInfo():null;et&&O.trigger(v.default.PLAYBACK_ENDED,{isLast:et.isLast})}function Ft(){O.trigger(v.default.PLAYBACK_VOLUME_CHANGED)}function Dt(et){if(k&&et.isLast){D.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended");var gt=et.seekTime?et.seekTime:ge();U.setCurrentTime(gt),Re(),Wt()}}function Kt(et){var gt=et.target||et.srcElement;O.trigger(v.default.PLAYBACK_ERROR,{error:gt.error})}function on(){O.trigger(v.default.WALLCLOCK_TIME_UPDATED,{isDynamic:J,time:new Date}),he()&&(x.addDVRMetric(),X()?Tn():Ye())}function Tn(){var et=Date.now();(!ue||et>ue+C)&&(ue=et,je())}function Ke(){var et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,gt=null;return x.getActiveStreamProcessors().forEach(function(At){if(!et||et.length===0||et.indexOf(At.getType())===-1){var en=At.getBufferLevel();gt===null?gt=en:gt=Math.min(gt,en)}}),gt}function ut(){return se}function wt(et){if(et.stream===!1&&se&&!isNaN(et.request.duration)){var gt=1.2*et.request.duration;gt>K&&(D.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",gt.toFixed(2)),K=gt,W=gt)}}function Gt(et){O.trigger(v.default.PLAYBACK_STALLED,{e:et})}function Qt(et){Be(et.mediaInfo)}function sn(et){var gt=x.getActiveStreamInfo();!et||!gt||!et.currentRepresentation||!et.streamId||et.streamId!==gt.id||!et.mediaType||et.mediaType!==m.default.VIDEO&&et.mediaType!==m.default.AUDIO||(Q=et.currentRepresentation.availabilityTimeComplete,se=!Q,se&&!Se&&(Se=!0))}function Dn(){return Se}function pn(){Ee=!0}function sr(){Ee=!1}function Be(et){et&&et.supplementalProperties&&et.supplementalProperties[m.default.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME]==="true"&&(D.debug("Low Latency critical SupplementalProperty set: Enabling low Latency"),se=!0)}function Tt(){U.addEventListener("canplay",nt),U.addEventListener("canplaythrough",Et),U.addEventListener("play",Ut),U.addEventListener("waiting",Vt),U.addEventListener("playing",Zt),U.addEventListener("pause",We),U.addEventListener("error",Kt),U.addEventListener("seeking",In),U.addEventListener("seeked",Ct),U.addEventListener("timeupdate",je),U.addEventListener("progress",Oe),U.addEventListener("ratechange",ze),U.addEventListener("loadedmetadata",ct),U.addEventListener("loadeddata",dt),U.addEventListener("stalled",Gt),U.addEventListener("ended",bt),U.addEventListener("volumechange",Ft)}function Xt(){U.removeEventListener("canplay",nt),U.removeEventListener("canplaythrough",Et),U.removeEventListener("play",Ut),U.removeEventListener("waiting",Vt),U.removeEventListener("playing",Zt),U.removeEventListener("pause",We),U.removeEventListener("error",Kt),U.removeEventListener("seeking",In),U.removeEventListener("seeked",Ct),U.removeEventListener("timeupdate",je),U.removeEventListener("progress",Oe),U.removeEventListener("ratechange",ze),U.removeEventListener("loadedmetadata",ct),U.removeEventListener("loadeddata",dt),U.removeEventListener("stalled",Gt),U.removeEventListener("ended",bt),U.removeEventListener("volumechange",Ft)}return L={initialize:Fe,setConfig:lt,getTimeToStreamEnd:Ae,getBufferLevel:Ke,getPlaybackStalled:De,getTime:oe,getLowLatencyModeEnabled:ut,getInitialCatchupModeActivated:Dn,getIsManifestUpdateInProgress:we,getPlaybackRate:fe,getPlayedRanges:Ce,getEnded:Pe,getIsDynamic:he,getStreamController:Ue,computeAndSetLiveDelay:Pt,getLiveDelay:it,getOriginalLiveDelay:mt,getCurrentLiveLatency:pt,play:pe,isPaused:X,isStalled:ne,pause:Re,isSeeking:z,getStreamEndTime:ge,seek:me,seekToOriginalLive:V,seekToCurrentLive:j,reset:xe,updateCurrentTime:Ye,getAvailabilityStartTime:$e},de(),L}R.__dashjs_factory_name="PlaybackController";const b=_.default.getSingletonFactory(R)},"./src/streaming/controllers/ScheduleController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>b});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/streaming/models/FragmentModel.js"),v=d("./src/core/EventBus.js"),_=d("./src/core/events/Events.js"),S=d("./src/core/FactoryMaker.js"),E=d("./src/core/Debug.js"),T=d("./src/streaming/constants/MetricsConstants.js"),C=d("./src/streaming/MediaPlayerEvents.js");function R(F){F=F||{};var O=this.context,L=(0,v.default)(O).getInstance(),D=F.dashMetrics,x=F.mediaPlayerModel,B=F.fragmentModel,M=F.abrController,I=F.playbackController,U=F.textController,w=F.type,k=F.bufferController,K=F.settings,W,Y,J,ee,ue,ie,Q,se,ve,_e,Z,Ee,Se;function Me(){J=(0,E.default)(O).getInstance().getLogger(W),Pt(),Y=F.streamInfo}function de(st){Q=st,L.on(_.default.BYTES_APPENDED_END_FRAGMENT,Pe,W),L.on(_.default.URL_RESOLUTION_FAILED,he,W),L.on(C.default.PLAYBACK_STARTED,Ue,W),L.on(C.default.PLAYBACK_RATE_CHANGED,we,W),L.on(C.default.PLAYBACK_TIME_UPDATED,fe,W)}function xe(){return w}function Fe(){return Y.id}function Le(st){ee=st}function De(st){if(!k.getIsBufferingCompleted()){Ae();var Nt=isNaN(st)?0:st;ie=setTimeout(pe,Nt)}}function Ae(){ie&&(clearTimeout(ie),ie=null)}function ge(){var st=Y.id,Nt=M.getMaxAllowedIndexFor(w,st);return isNaN(ve)||ve!=Nt?(J.info("Top quality "+w+" index has changed from "+ve+" to "+Nt),ve=Nt,!0):!1}function pe(){try{if(me()){Ae();return}if(V()){var st=!1;Se&&(st=M.checkPlaybackQuality(w,Y.id)),st||Re()}else De(I.getLowLatencyModeEnabled()?K.get().streaming.scheduling.lowLatencyTimeout:K.get().streaming.scheduling.defaultTimeout)}catch{De(I.getLowLatencyModeEnabled()?K.get().streaming.scheduling.lowLatencyTimeout:K.get().streaming.scheduling.defaultTimeout)}}function Re(){Ee||ee.quality!==_e||Z?(Z?(J.debug("Switch track for "+w+", representation id = "+ee.id),Z=!1):J.debug("Quality has changed, get init request for representationid = "+ee.id),L.trigger(_.default.INIT_FRAGMENT_NEEDED,{representationId:ee.id,sender:W},{streamId:Y.id,mediaType:w}),Se=!1,Ee=!1):(J.debug("Media segment needed for ".concat(w," and stream id ").concat(Y.id)),L.trigger(_.default.MEDIA_FRAGMENT_NEEDED,{},{streamId:Y.id,mediaType:w}),Se=!0)}function me(){try{return w===m.default.TEXT&&!U.isTextEnabled()||I.isPaused()&&(!I.getStreamController().getInitialPlayback()||!I.getStreamController().getAutoPlay())&&!K.get().streaming.scheduling.scheduleWhilePaused}catch{return!1}}function V(){try{return ee&&(isNaN(_e)||Z||ge()||j())}catch{return!1}}function j(){if(!w||!ee)return!0;var st=D.getCurrentBufferLevel(w);return st<$()}function $(){var st=NaN;return!w||!ee||(w===m.default.TEXT?st=re():w===m.default.AUDIO&&Q?st=oe():st=X()),st}function re(){try{if(U.isTextEnabled())if(isNaN(ee.fragmentDuration)){var st=D.getCurrentSchedulingInfo(T.default.SCHEDULING_INFO);return st?st.duration:0}else return ee.fragmentDuration;else return 0}catch{return 0}}function oe(){try{var st=D.getCurrentBufferLevel(m.default.VIDEO);return isNaN(ee.fragmentDuration)?st+1:Math.max(st+1,ee.fragmentDuration)}catch{return 0}}function X(){try{var st=ee.mediaInfo.streamInfo;if(M.isPlayingAtTopQuality(st)){var Nt=st.manifestInfo.duration>=K.get().streaming.buffer.longFormContentDurationThreshold;return Nt?K.get().streaming.buffer.bufferTimeAtTopQualityLongForm:K.get().streaming.buffer.bufferTimeAtTopQuality}else return x.getStableBufferTime()}catch{return x.getStableBufferTime()}}function z(st){Z=st}function ne(){return Z}function fe(){Ce(!0)}function Ce(st){if(I&&B){var Nt=B.getRequests({state:g.default.FRAGMENT_MODEL_EXECUTED,time:I.getTime(),threshold:0})[0];Nt&&I.getTime()>=Nt.startTime&&((!se.mediaInfo||Nt.mediaInfo.type===se.mediaInfo.type&&Nt.mediaInfo.id!==se.mediaInfo.id)&&st&&L.trigger(_.default.TRACK_CHANGE_RENDERED,{mediaType:w,oldMediaInfo:se.mediaInfo,newMediaInfo:Nt.mediaInfo,streamId:Y.id}),(Nt.quality!==se.quality||Nt.adaptationIndex!==se.adaptationIndex)&&st&&(J.debug("Quality change rendered for streamId ".concat(Y.id," and type ").concat(w)),L.trigger(_.default.QUALITY_CHANGE_RENDERED,{mediaType:w,oldQuality:se.quality,newQuality:Nt.quality,streamId:Y.id})),se={mediaInfo:Nt.mediaInfo,quality:Nt.quality,adaptationIndex:Nt.adaptationIndex})}}function Pe(st){J.debug("Appended bytes for ".concat(st.mediaType," and stream id ").concat(Y.id)),(isNaN(st.index)||isNaN(_e))&&(_e=st.quality,J.info("["+w+"] lastInitializedRepresentationInfo changed to "+st.quality)),De(0)}function he(){B.abortRequests(),Ae()}function Ue(){K.get().streaming.scheduling.scheduleWhilePaused||De()}function we(st){D.updatePlayListTraceMetrics({playbackspeed:st.playbackRate.toString()})}function $e(st){ue=st}function it(){return ue}function mt(st){Se=st}function pt(st){Ee=st}function Pt(){Se=!0,ue=0,_e=NaN,se={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},ve=NaN,Z=!1,Ee=!1}function lt(){L.off(_.default.BYTES_APPENDED_END_FRAGMENT,Pe,W),L.off(_.default.URL_RESOLUTION_FAILED,he,W),L.off(C.default.PLAYBACK_STARTED,Ue,W),L.off(C.default.PLAYBACK_RATE_CHANGED,we,W),L.off(C.default.PLAYBACK_TIME_UPDATED,fe,W),Ae(),Ce(!1),Pt(),Y=null}function Ye(){return I}return W={initialize:de,getType:xe,getStreamId:Fe,setCurrentRepresentation:Le,setTimeToLoadDelay:$e,getTimeToLoadDelay:it,setSwitchTrack:z,getSwitchStrack:ne,startScheduleTimer:De,clearScheduleTimer:Ae,reset:lt,getBufferTarget:$,getPlaybackController:Ye,setCheckPlaybackQuality:mt,setInitSegmentRequired:pt},Me(),W}R.__dashjs_factory_name="ScheduleController";const b=S.default.getClassFactory(R)},"./src/streaming/controllers/StreamController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>ue});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/streaming/constants/MetricsConstants.js"),v=d("./src/streaming/Stream.js"),_=d("./src/streaming/ManifestUpdater.js"),S=d("./src/core/EventBus.js"),E=d("./src/core/events/Events.js"),T=d("./src/core/FactoryMaker.js"),C=d("./src/streaming/vo/metrics/PlayList.js"),R=d("./src/core/Debug.js"),b=d("./src/streaming/utils/InitCache.js"),F=d("./src/streaming/MediaPlayerEvents.js"),O=d("./src/streaming/controllers/TimeSyncController.js"),L=d("./src/streaming/controllers/MediaSourceController.js"),D=d("./src/streaming/vo/DashJSError.js"),x=d("./src/core/errors/Errors.js"),B=d("./src/streaming/controllers/EventController.js"),M=d("./src/streaming/constants/ConformanceViolationConstants.js");function I(ie){return K(ie)||k(ie)||w(ie)||U()}function U(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w(ie,Q){if(ie){if(typeof ie=="string")return W(ie,Q);var se=Object.prototype.toString.call(ie).slice(8,-1);if(se==="Object"&&ie.constructor&&(se=ie.constructor.name),se==="Map"||se==="Set")return Array.from(ie);if(se==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(se))return W(ie,Q)}}function k(ie){if(typeof Symbol<"u"&&Symbol.iterator in Object(ie))return Array.from(ie)}function K(ie){if(Array.isArray(ie))return W(ie)}function W(ie,Q){(Q==null||Q>ie.length)&&(Q=ie.length);for(var se=0,ve=new Array(Q);se<Q;se++)ve[se]=ie[se];return ve}var Y=200,J=2;function ee(){var ie=this.context,Q=(0,S.default)(ie).getInstance(),se,ve,_e,Z,Ee,Se,Me,de,xe,Fe,Le,De,Ae,ge,pe,Re,me,V,j,$,re,oe,X,z,ne,fe,Ce,Pe,he,Ue,we,$e,it,mt,pt,Pt,lt,Ye,st,Nt,Wt,Ht,nt,Et,St,Ut,Vt,Zt;function We(){ve=(0,R.default)(ie).getInstance().getLogger(se),Le=(0,O.default)(ie).getInstance(),Fe=(0,L.default)(ie).getInstance(),j=(0,b.default)(ie).getInstance(),Ii()}function In(at,Rt){Oe(),Ce=at,fe=Rt,re.initialize(),Ee=(0,_.default)(ie).create(),Ee.setConfig({manifestModel:Me,adapter:de,manifestLoader:Se,errHandler:$,settings:Et}),Ee.initialize(),V=(0,B.default)(ie).getInstance(),V.setConfig({manifestUpdater:Ee,playbackController:it,settings:Et}),V.start(),Le.setConfig({dashMetrics:xe,baseURLController:Ae,errHandler:$,settings:Et}),Le.initialize(),z&&(Q.trigger(E.default.PROTECTION_CREATED,{controller:z}),z.setMediaElement($e.getElement()),fe&&z.setProtectionData(fe)),Ct()}function Ct(){Q.on(F.default.PLAYBACK_TIME_UPDATED,en,se),Q.on(F.default.PLAYBACK_SEEKING,wt,se),Q.on(F.default.PLAYBACK_ERROR,Ds,se),Q.on(F.default.PLAYBACK_STARTED,Nn,se),Q.on(F.default.PLAYBACK_PAUSED,_n,se),Q.on(F.default.PLAYBACK_ENDED,tt,se),Q.on(F.default.METRIC_ADDED,To,se),Q.on(F.default.MANIFEST_VALIDITY_CHANGED,el,se),Q.on(F.default.BUFFER_LEVEL_UPDATED,et,se),Q.on(F.default.QUALITY_CHANGE_REQUESTED,gt,se),E.default.KEY_SESSION_UPDATED&&Q.on(E.default.KEY_SESSION_UPDATED,Ft,se),Q.on(E.default.MANIFEST_UPDATED,li,se),Q.on(E.default.STREAM_BUFFERING_COMPLETED,En,se),Q.on(E.default.TIME_SYNCHRONIZATION_COMPLETED,bt,se),Q.on(E.default.CURRENT_TRACK_CHANGED,pn,se),Q.on(E.default.SETTING_UPDATED_LIVE_DELAY,At,se),Q.on(E.default.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,At,se)}function je(){Q.off(F.default.PLAYBACK_TIME_UPDATED,en,se),Q.off(F.default.PLAYBACK_SEEKING,wt,se),Q.off(F.default.PLAYBACK_ERROR,Ds,se),Q.off(F.default.PLAYBACK_STARTED,Nn,se),Q.off(F.default.PLAYBACK_PAUSED,_n,se),Q.off(F.default.PLAYBACK_ENDED,tt,se),Q.off(F.default.METRIC_ADDED,To,se),Q.off(F.default.MANIFEST_VALIDITY_CHANGED,el,se),Q.off(F.default.BUFFER_LEVEL_UPDATED,et,se),Q.off(F.default.QUALITY_CHANGE_REQUESTED,gt,se),E.default.KEY_SESSION_UPDATED&&Q.off(E.default.KEY_SESSION_UPDATED,Ft,se),Q.off(E.default.MANIFEST_UPDATED,li,se),Q.off(E.default.STREAM_BUFFERING_COMPLETED,En,se),Q.off(E.default.TIME_SYNCHRONIZATION_COMPLETED,bt,se),Q.off(E.default.CURRENT_TRACK_CHANGED,pn,se),Q.off(E.default.SETTING_UPDATED_LIVE_DELAY,At,se),Q.off(E.default.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,At,se)}function Oe(){if(!Se||!Se.hasOwnProperty("load")||!re||!re.hasOwnProperty("initialize")||!re.hasOwnProperty("reset")||!re.hasOwnProperty("getClientTimeOffset")||!Me||!$||!xe||!it)throw new Error(m.default.MISSING_CONFIG_ERROR)}function ze(){if(!Ee||!Ee.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}function ct(at){var Rt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NaN;Oe(),Vt=Rt,Se.load(at)}function dt(at){var Rt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NaN;ze(),Vt=Rt,Ee.setManifest(at)}function bt(){Dt()}function Ft(){St=!0}function Dt(){try{var at=de.getStreamsInfo();if(!X&&at.length===0)throw new Error("There are no periods in the MPD");X&&at.length>0&&xe.updateManifestUpdateInfo({currentTime:it.getTime(),buffered:$e.getBufferRange(),presentationStartTime:at[0].start,clientTimeOffset:re.getClientTimeOffset()}),oe.length>0&&Mi(at);for(var Rt=[],an=0,Rn=at.length;an<Rn;an++){var Cn=at[an];Rt.push(Kt(Cn)),xe.addManifestUpdateStreamInfo(Cn)}Promise.all(Rt).then(function(){return Et.get().streaming.applyContentSteering&&!X&&De.shouldQueryBeforeStart()?De.loadSteeringData():Promise.resolve()}).then(function(){X||on(at),Q.trigger(E.default.STREAMS_COMPOSED),mr()}).catch(function(Xn){throw Xn})}catch(Xn){$.error(new D.default(x.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,Xn.message+" nostreamscomposed",Me.getValue())),Ue=!0,_o()}}function Kt(at){var Rt=Wi(at.id);return Rt?Rt.updateData(at):(Rt=(0,v.default)(ie).create({manifestModel:Me,mediaPlayerModel:pt,dashMetrics:xe,manifestUpdater:Ee,adapter:de,timelineConverter:re,capabilities:_e,capabilitiesFilter:Z,errHandler:$,baseURLController:Ae,segmentBaseController:ge,textController:ne,abrController:Re,playbackController:it,eventController:V,mediaController:me,protectionController:z,videoModel:$e,streamInfo:at,settings:Et}),oe.push(Rt),Rt.initialize(),Promise.resolve())}function on(at){Xt();var Rt=xe.getCurrentDVRInfo().range;if(Rt.end<Rt.start){Ut&&clearTimeout(Ut);var an=Math.min(((Rt.end-Rt.start)*-1+J)*1e3,2147483647);ve.debug("Waiting for ".concat(an," ms before playback can start")),Q.trigger(E.default.AST_IN_FUTURE,{delay:an}),Ut=setTimeout(function(){on(at)},an);return}Et.get().streaming.applyProducerReferenceTime&&mt.calculateProducerReferenceTimeOffsets(at);var Rn=at[0].manifestInfo;if(Et.get().streaming.applyServiceDescription&&mt.applyServiceDescription(Rn),de.getIsDynamic()){var Cn=Bi(at,Rn);it.computeAndSetLiveDelay(Cn,Rn)}var Xn=On(),ar=Tt(Xn),hi=ar!==null?ar:oe[0];Q.trigger(E.default.INITIAL_STREAM_SWITCH,{startTime:Xn}),Tn(hi,null,Xn),jn()}function Tn(at,Rt,an){try{if(Pe||!at||Rt===at&&at.getIsActive())return;Pe=!0,Q.trigger(E.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:Rt?Rt.getStreamInfo():null,toStreamInfo:at.getStreamInfo()});var Rn=!1;X=at,Rt&&(Rn=sr(at,Rt),Rt.deactivate(Rn)),an=isNaN(an)?!Rn&&Rt?at.getStreamInfo().start:NaN:an,ve.info("Switch to stream ".concat(at.getId(),". Seektime is ").concat(an,", current playback time is ").concat(it.getTime(),". Seamless period switch is set to ").concat(Rn)),Ht=Ht.filter(function(Cn){return Cn.getId()!==X.getId()}),it.initialize(ji(),!!Rt),$e.getElement()?Ke(an,Rn,!1):ut(an,Rn)}catch{Pe=!1}}function Ke(at,Rt){var an=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,Rn;function Cn(){if(!(!we||we.readyState!=="open")){ve.debug("MediaSource is open!"),window.URL.revokeObjectURL(Rn),we.removeEventListener("sourceopen",Cn),we.removeEventListener("webkitsourceopen",Cn),ft();var ar=xe.getCurrentDVRInfo();Fe.setSeekable(ar.range.start,ar.range.end),an?X.setMediaSource(we).then(function(){X.initializeForTextWithMediaSource(we)}):ut(at,Rt)}}function Xn(){we.addEventListener("sourceopen",Cn,!1),we.addEventListener("webkitsourceopen",Cn,!1),Rn=Fe.attachMediaSource($e),ve.debug("MediaSource attached to element.  Waiting on open...")}we?Rt?ut(at,Rt):(Fe.detachMediaSource($e),Xn()):(we=Fe.createMediaSource(),Xn())}function ut(at,Rt){X.activate(we,Rt?Wt:void 0,at).then(function(an){if(an){var Rn=Object.keys(an);Rn.length>0&&an[Rn[0]].getBuffer().changeType&&(nt=!0),Wt=an}isNaN(at)||(Q.trigger(E.default.SEEK_TARGET,{time:at},{streamId:X.getId()}),it.seek(at,!1,!0),X.startScheduleControllers()),Pe=!1,Q.trigger(E.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:ji()})})}function wt(at){var Rt=at.seekTime,an=Tt(Rt);!an||an===X?(Gt(),sn(at)):an&&an!==X&&(Gt(an),Dn(at,an)),Aa(C.PlayList.SEEK_START_REASON)}function Gt(){var at=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Qt()}function Qt(){Ht&&Ht.length>0&&(Ht.forEach(function(at){at.deactivate(!0)}),Ht=[])}function sn(at){var Rt=X.getProcessors();Rt.forEach(function(an){return an.prepareInnerPeriodPlaybackSeeking(at)}),bs(C.PlayListTrace.USER_REQUEST_STOP_REASON)}function Dn(at,Rt){var an=at&&!isNaN(at.seekTime)?at.seekTime:NaN,Rn=X.getProcessors(),Cn=Rn.map(function(Xn){return Xn.prepareOuterPeriodPlaybackSeeking(at)});Promise.all(Cn).then(function(){Tn(Rt,X,an)}).catch(function(Xn){$.error(Xn)})}function pn(at){at.newMediaInfo.streamInfo.id===X.getId()&&(Qt(),X.prepareTrackChange(at))}function sr(at,Rt){try{return Et.get().streaming.buffer.reuseExistingSourceBuffers&&(Rt.isProtectionCompatible(at)||St)&&(nt||Rt.isMediaCodecCompatible(at,Rt))}catch{return!1}}function Be(at){var Rt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(we&&!at.getPreloaded()){var an=sr(at,Rt);an&&at.startPreloading(we,Wt).then(function(){Ht.push(at)})}}function Tt(at){if(isNaN(at))return null;for(var Rt=oe.length,an=0;an<Rt;an++){var Rn=oe[an],Cn=parseFloat((Rn.getStartTime()+Rn.getDuration()).toFixed(5));if(at<Cn)return Rn}return null}function Xt(){try{var at=de.getIsDynamic(),Rt=de.getStreamsInfo(),an=Rt[0].manifestInfo,Rn=it.getTime(),Cn=re.calcTimeShiftBufferWindow(oe,at),Xn=cn();if(typeof Cn.start>"u"||typeof Cn.end>"u")return;!Xn||Xn.length===0?xe.addDVRInfo(m.default.VIDEO,Rn,an,Cn):Xn.forEach(function(ar){xe.addDVRInfo(ar.getType(),Rn,an,Cn)})}catch{}}function et(at){if(Ye&&Ce){var Rt=pt.getInitialBufferLevel(),an=[m.default.TEXT];(isNaN(Rt)||Rt<=it.getBufferLevel(an)||de.getIsDynamic()&&Rt>it.getLiveDelay())&&(Ye=!1,Aa(C.PlayList.INITIAL_PLAYOUT_START_REASON),it.play())}at&&at.mediaType&&xe.addBufferLevel(at.mediaType,new Date,at.bufferLevel*1e3)}function gt(at){at.streamInfo.id===X.getId()&&at.reason&&at.reason.forceReplace&&Qt();var Rt=Wi(at.streamInfo.id);Rt.prepareQualityChange(at)}function At(){if(de.getIsDynamic()&&it.getOriginalLiveDelay()!==0&&X){var at=de.getStreamsInfo();if(at.length>0){var Rt=at[0].manifestInfo,an=Bi(at,Rt);it.computeAndSetLiveDelay(an,Rt)}}}function en(){if(Xs()){var at=$e.getPlaybackQuality();at&&xe.addDroppedFrames(at)}}function Nn(){ve.debug("[onPlaybackStarted]"),!Ye&&lt&&Aa(C.PlayList.RESUME_FROM_PAUSE_START_REASON),Ye&&(Ye=!1),st&&(st=!1,Et.get().streaming.applyContentSteering&&!De.shouldQueryBeforeStart()&&De.loadSteeringData()),lt=!1}function _n(at){ve.debug("[onPlaybackPaused]"),at.ended||(lt=!0,bs(C.PlayListTrace.USER_REQUEST_STOP_REASON))}function En(at){ve.debug("Stream with id ".concat(at.streamInfo.id," finished buffering"));var Rt=at.streamInfo.isLast;we&&Rt?(ve.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),Fe.signalEndOfStream(we)):mr()}function mr(){if(!(!X||!X.getHasFinishedBuffering()))for(var at=He(X),Rt=0;Rt<at.length;){var an=at[Rt],Rn=Rt===0?X:at[Rt-1];!an.getPreloaded()&&Rn.getHasFinishedBuffering()&&we&&Be(an,Rn),Rt+=1}}function jn(){Nt||(Nt=setInterval(function(){!Pe&&it.getTimeToStreamEnd()<=0&&!it.isSeeking()&&Q.trigger(E.default.PLAYBACK_ENDED,{isLast:ji().isLast})},Y))}function Mt(){Nt&&(clearInterval(Nt),Nt=null)}function gn(at,Rt){for(var an=null,Rn=0,Cn=0,Xn=null,ar=0;ar<oe.length;ar++){if(an=oe[ar],Cn=an.getStartTime(),Xn=an.getDuration(),Number.isFinite(Cn)&&(Rn=Cn),an.getId()===Rt)return at-Rn;Number.isFinite(Xn)&&(Rn+=Xn)}return null}function cn(){return X?X.getProcessors():[]}function tt(at){if(X&&!X.getIsEndedEventSignaled()){X.setIsEndedEventSignaled(!0);var Rt=vt();Rt?(ve.debug("StreamController onEnded, found next stream with id ".concat(Rt.getStreamInfo().id,". Switching from ").concat(X.getStreamInfo().id," to ").concat(Rt.getStreamInfo().id)),Tn(Rt,X,NaN)):(ve.debug("StreamController no next stream found"),X.setIsEndedEventSignaled(!1)),bs(Rt?C.PlayListTrace.END_OF_PERIOD_STOP_REASON:C.PlayListTrace.END_OF_CONTENT_STOP_REASON)}at&&at.isLast&&(Mt(),De.stopSteeringRequestTimer())}function vt(){var at=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,Rt=at||X||null;if(!Rt)return null;for(var an=Rt.getStreamInfo(),Rn=an.start,Cn=0,Xn=-1,ar=NaN;Cn<oe.length;){var hi=oe[Cn],ti=hi.getStreamInfo(),qi=ti.start-Rn;qi>0&&(isNaN(ar)||qi<ar)&&an.id!==ti.id&&(ar=qi,Xn=Cn),Cn+=1}return Xn>=0?oe[Xn]:null}function He(){var at=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;try{var Rt=at||X||null;if(Rt){var an=Rt.getStreamInfo();return oe.filter(function(Rn){var Cn=Rn.getStreamInfo();return Cn.start>an.start&&an.id!==Cn.id})}}catch{return[]}}function ft(at){var Rt=at||ji().manifestInfo.duration;Fe.setDuration(Rt)}function $t(){return X}function vn(){return Ye}function yn(){return Ce}function On(){var at,Rt=de.getIsDynamic();if(Rt){var an=xe.getCurrentDVRInfo(),Rn=an&&an.range?an.range.end:0;at=Rn-it.getOriginalLiveDelay();var Cn=an?an.range:null;if(Cn){if(!isNaN(Vt)||Vt.toString().indexOf("posix:")!==-1){ve.info("Start time provided by the app: ".concat(Vt));var Xn=Un(!0,Vt);isNaN(Xn)||(at=Math.min(at,Xn))}else{var ar=nr(!0);isNaN(ar)||(ve.info("Start time from URI parameters: ".concat(ar)),at=Math.min(at,ar))}var hi=Et.get().streaming.timeShiftBuffer.calcFromSegmentTimeline?.1:0;at=Math.max(at,Cn.start+hi)}}else{var ti=xa(),qi=ti[0].getStreamInfo();if(at=qi.start,isNaN(Vt)){var Ca=nr(!1);isNaN(Ca)||(ve.info("Start time from URI parameters: ".concat(Ca)),at=Math.max(at,Ca))}else{ve.info("Start time provided by the app: ".concat(Vt));var Kr=Un(!1,Vt);isNaN(Kr)||(at=Math.max(at,Kr))}}return at}function nr(at){var Rt=pe.getURIFragmentData();if(!Rt||!Rt.t)return NaN;var an=xa()[0],Rn=an.getStreamInfo().start;return Rt.t=Rt.t.split(",")[0],Br(at,Rt.t,Rn)}function Un(at,Rt){var an=0;if(!at){var Rn=xa()[0];an=Rn.getStreamInfo().start}return Br(at,Rt,an)}function Br(at,Rt,an){var Rn=de.getRegularPeriods()[0],Cn=Rt.toString(),Xn=Cn.indexOf("posix:")!==-1?Cn.substring(6)==="now"?Date.now()/1e3:parseFloat(Cn.substring(6)):NaN,ar=at&&!isNaN(Xn)?re.calcPresentationTimeFromWallTime(new Date(Xn*1e3),Rn):parseFloat(Cn)+an;return ar}function Mi(at){if(at.length===0){ve.warn("No periods included in the current manifest. Skipping the filtering of outdated stream objects.");return}oe=oe.filter(function(Rt){var an=at.filter(function(Cn){return Cn.id===Rt.getId()}).length>0,Rn=an||Rt.getId()===X.getId();return Rn||(ve.debug("Removing stream ".concat(Rt.getId())),Rt.reset(!0)),Rn})}function Bi(at,Rt){try{var an=NaN;if(Rt&&!isNaN(Rt.maxFragmentDuration)&&isFinite(Rt.maxFragmentDuration))return Rt.maxFragmentDuration;if(at&&at.length===1){var Rn=at[0],Cn=[m.default.VIDEO,m.default.AUDIO,m.default.TEXT],Xn=Cn.reduce(function(ar,hi){var ti=de.getMediaInfoForType(Rn,hi);return ti&&ti.isFragmented!==!1&&ar.push(ti),ar},[]).reduce(function(ar,hi){var ti=de.getVoRepresentations(hi);return ti&&ti.length>0&&ti.forEach(function(qi){qi&&ar.push(qi)}),ar},[]).reduce(function(ar,hi){var ti=de.convertRepresentationToRepresentationInfo(hi);return ti&&ti.fragmentDuration&&!isNaN(ti.fragmentDuration)&&ar.push(ti.fragmentDuration),ar},[]);an=Math.max.apply(Math,I(Xn))}return isFinite(an)?an:NaN}catch{return NaN}}function li(at){if(at.error)Ue=!0,_o();else{ve.info("Manifest updated... updating data system wide.");var Rt=at.manifest;de.updatePeriods(Rt);var an=de.getUTCTimingSources();de.getIsDynamic()&&(!an||an.length===0)&&Q.trigger(F.default.CONFORMANCE_VIOLATION,{level:M.default.LEVELS.WARNING,event:M.default.EVENTS.NO_UTC_TIMING_ELEMENT});var Rn=de.getIsDynamic()?an.concat(Pt.getUTCTimingSources()):an;Z.filterUnsupportedFeatures(Rt).then(function(){Ae.initialize(Rt),Le.attemptSync(Rn,de.getIsDynamic())})}}function Xs(){return X?X.getHasVideoTrack():!1}function Sa(){return X?X.getHasAudioTrack():!1}function Zo(at){X&&(it.initialize(ji()),Ke(at,!1,!0))}function bs(at,Rt){Rt=Rt||new Date,cn().forEach(function(an){an.finalisePlayList(Rt,at)}),xe.addPlayList()}function Aa(at){xe.createPlaylistMetrics(it.getTime()*1e3,at)}function Ds(at){if(at.error){var Rt="";switch(at.error.code){case 1:Rt="MEDIA_ERR_ABORTED";break;case 2:Rt="MEDIA_ERR_NETWORK";break;case 3:Rt="MEDIA_ERR_DECODE",Zt.counts.mediaErrorDecode+=1;break;case 4:Rt="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:Rt="MEDIA_ERR_ENCRYPTED";break;default:Rt="UNKNOWN";break}if(Rt==="MEDIA_ERR_DECODE"&&Et.get().errors.recoverAttempts.mediaErrorDecode>=Zt.counts.mediaErrorDecode){qs();return}he=!0,at.error.message&&(Rt+=" ("+at.error.message+")"),at.error.msExtendedCode&&(Rt+=" (0x"+(at.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),ve.fatal("Video Element Error: "+Rt),at.error&&ve.fatal(at.error),$.error(new D.default(at.error.code,Rt)),_o()}}function qs(){ve.warn("A MEDIA_ERR_DECODE occured: Resetting the MediaSource");var at=it.getTime();X.deactivate(!1),ve.warn("MediaSource has been resetted. Resuming playback from time ".concat(at)),Ke(at,!1,!1)}function ji(){return X?X.getStreamInfo():null}function Gl(){return Pe}function Eo(){return he||Ue}function Wi(at){for(var Rt=0,an=oe.length;Rt<an;Rt++)if(oe[Rt].getId()===at)return oe[Rt];return null}function el(at){isNaN(at.newDuration)||ft(at.newDuration)}function Hi(at){at&&(at.capabilities&&(_e=at.capabilities),at.capabilitiesFilter&&(Z=at.capabilitiesFilter),at.manifestLoader&&(Se=at.manifestLoader),at.manifestModel&&(Me=at.manifestModel),at.mediaPlayerModel&&(pt=at.mediaPlayerModel),at.customParametersModel&&(Pt=at.customParametersModel),at.protectionController&&(z=at.protectionController),at.adapter&&(de=at.adapter),at.dashMetrics&&(xe=at.dashMetrics),at.errHandler&&($=at.errHandler),at.timelineConverter&&(re=at.timelineConverter),at.videoModel&&($e=at.videoModel),at.playbackController&&(it=at.playbackController),at.serviceDescriptionController&&(mt=at.serviceDescriptionController),at.contentSteeringController&&(De=at.contentSteeringController),at.textController&&(ne=at.textController),at.abrController&&(Re=at.abrController),at.mediaController&&(me=at.mediaController),at.settings&&(Et=at.settings),at.baseURLController&&(Ae=at.baseURLController),at.uriFragmentModel&&(pe=at.uriFragmentModel),at.segmentBaseController&&(ge=at.segmentBaseController))}function er(at){fe=at,z&&z.setProtectionData(fe)}function Ii(){oe=[],Vt=NaN,z=null,Pe=!1,X=null,he=!1,Ue=!1,Ye=!0,st=!0,lt=!1,Ce=!0,Nt=null,St=!1,nt=!1,Ht=[],Ut=null,Zt={counts:{mediaErrorDecode:0}}}function _o(){Oe(),Le.reset(),bs(he||Ue?C.PlayListTrace.FAILURE_STOP_REASON:C.PlayListTrace.USER_REQUEST_STOP_REASON);for(var at=0,Rt=oe?oe.length:0;at<Rt;at++){var an=oe[at];an.reset(he)}je(),Ae.reset(),Ee.reset(),V.reset(),xe.clearAllCurrentMetrics(),Me.setValue(null),Se.reset(),re.reset(),j.reset(),we&&(Fe.detachMediaSource($e),we=null),$e=null,z&&(z=null,fe=null,Me.getValue()&&Q.trigger(E.default.PROTECTION_DESTROYED,{data:Me.getValue().url})),Mt(),Q.trigger(E.default.STREAM_TEARDOWN_COMPLETE),Ii()}function To(at){if(at.metric===g.default.DVR_INFO){var Rt=Sa()?m.default.AUDIO:m.default.VIDEO;at.mediaType===Rt&&Fe.setSeekable(at.value.range.start,at.value.range.end)}}function xa(){return oe}return se={initialize:In,getActiveStreamInfo:ji,addDVRMetric:Xt,hasVideoTrack:Xs,hasAudioTrack:Sa,getStreamById:Wi,getStreamForTime:Tt,getTimeRelativeToStreamId:gn,load:ct,loadWithManifest:dt,getActiveStreamProcessors:cn,setConfig:Hi,setProtectionData:er,getIsStreamSwitchInProgress:Gl,switchToVideoElement:Zo,getHasMediaOrInitialisationError:Eo,getStreams:xa,getActiveStream:$t,getInitialPlayback:vn,getAutoPlay:yn,reset:_o},We(),se}ee.__dashjs_factory_name="StreamController";const ue=T.default.getSingletonFactory(ee)},"./src/streaming/controllers/TimeSyncController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>U});var m=d("./src/streaming/vo/DashJSError.js"),g=d("./src/streaming/vo/metrics/HTTPRequest.js"),v=d("./src/core/EventBus.js"),_=d("./src/core/events/Events.js"),S=d("./src/core/errors/Errors.js"),E=d("./src/core/FactoryMaker.js"),T=d("./src/core/Debug.js"),C=d("./src/streaming/utils/URLUtils.js"),R=5e3,b=100,F=2,O=2,L=30,D=30,x=600,B=2;function M(){var w=this.context,k=(0,v.default)(w).getInstance(),K=(0,C.default)(w).getInstance(),W,Y,J,ee,ue,ie,Q,se,ve,_e,Z,Ee,Se,Me,de,xe;function Fe(){Y=(0,T.default)(w).getInstance().getLogger(W),k.on(_.default.ATTEMPT_BACKGROUND_SYNC,pe,W)}function Le(pt){pt&&(pt.dashMetrics&&(Q=pt.dashMetrics),pt.baseURLController&&(xe=pt.baseURLController),pt.errHandler&&(de=pt.errHandler),pt.settings&&(ue=pt.settings))}function De(){se=[],ve=[],_e=null,Z=null,Se=null,Ee=NaN,J=!1,ee=!1,Me=ue.get().streaming.utcSynchronization.timeBetweenSyncAttempts}function Ae(){De(),ie={"urn:mpeg:dash:utc:http-head:2014":Pe,"urn:mpeg:dash:utc:http-xsdate:2014":Ce.bind(null,oe),"urn:mpeg:dash:utc:http-iso:2014":Ce.bind(null,X),"urn:mpeg:dash:utc:direct:2014":fe,"urn:mpeg:dash:utc:http-head:2012":Pe,"urn:mpeg:dash:utc:http-xsdate:2012":Ce.bind(null,oe),"urn:mpeg:dash:utc:http-iso:2012":Ce.bind(null,X),"urn:mpeg:dash:utc:direct:2012":fe,"urn:mpeg:dash:utc:http-ntp:2014":ne,"urn:mpeg:dash:utc:ntp:2014":ne,"urn:mpeg:dash:utc:sntp:2014":ne}}function ge(pt,Pt){if(ve=pt,!J){if(!j(Pt)){k.trigger(_.default.TIME_SYNCHRONIZATION_COMPLETED);return}J=!0,me()}}function pe(){if(!(!ue.get().streaming.utcSynchronization.enabled||J||ee||!Se||!Se.value||!Se.schemeIdUri||isNaN(Ee)||isNaN(ue.get().streaming.utcSynchronization.backgroundAttempts))&&!(Z&&(Date.now()-Z)/1e3<D)){se=[],ee=!0;var pt=isNaN(ue.get().streaming.utcSynchronization.backgroundAttempts)?O:ue.get().streaming.utcSynchronization.backgroundAttempts;Re(pt)}}function Re(pt){try{if(pt<=0){$e();return}var Pt=Date.now();ie[Se.schemeIdUri](Se.value,function(lt){var Ye=Date.now(),st=V(Pt,Ye,lt);se.push(st),Re(pt-1)},function(){$e()})}catch{$e()}}function me(){var pt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,Pt=pt||0;if(!ve||ve.length===0||Pt>=ve.length){$();return}var lt=ve[Pt];if(lt)if(ie.hasOwnProperty(lt.schemeIdUri)){var Ye=new Date().getTime();ie[lt.schemeIdUri](lt.value,function(st){var Nt=new Date().getTime(),Wt=V(Ye,Nt,st);Se=lt,$(Wt)},function(){me(Pt+1)})}else me(Pt+1);else $()}function V(pt,Pt,lt){var Ye=Pt-(Pt-pt)/2;return lt-Ye}function j(pt){try{if(!pt||!ue.get().streaming.utcSynchronization.enabled)return!1;var Pt=isNaN(Me)?L:Me;return!_e||!Pt||isNaN(Pt)?!0:(Date.now()-_e)/1e3>=Pt}catch{return!0}}function $(){var pt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:NaN,Pt=isNaN(pt);Pt&&ue.get().streaming.utcSynchronization.useManifestDateHeaderTimeSource?he():Ue(Pt,pt)}function re(pt){var Pt=60,lt=60,Ye=1e3,st=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/,Nt,Wt,Ht=st.exec(pt);return Nt=Date.UTC(parseInt(Ht[1],10),parseInt(Ht[2],10)-1,parseInt(Ht[3],10),parseInt(Ht[4],10),parseInt(Ht[5],10),Ht[6]&&(parseInt(Ht[6],10)||0),Ht[7]&&parseFloat(Ht[7])*Ye||0),Ht[9]&&Ht[10]&&(Wt=parseInt(Ht[9],10)*lt+parseInt(Ht[10],10),Nt+=(Ht[8]==="+"?-1:1)*Wt*Pt*Ye),new Date(Nt).getTime()}function oe(pt){var Pt=Date.parse(pt);return isNaN(Pt)&&(Pt=re(pt)),Pt}function X(pt){return Date.parse(pt)}function z(pt){return Date.parse(pt)}function ne(pt,Pt,lt){lt()}function fe(pt,Pt,lt){var Ye=oe(pt);if(!isNaN(Ye)){Pt(Ye);return}lt()}function Ce(pt,Pt,lt,Ye,st){var Nt,Wt,Ht=!1,nt=new XMLHttpRequest,Et=st?g.HTTPRequest.HEAD:g.HTTPRequest.GET,St=Pt.match(/\S+/g);if(Pt=St.shift(),Nt=function(){Ht||(Ht=!0,St.length?Ce(pt,St.join(" "),lt,Ye,st):Ye())},Wt=function(){var Zt,We;nt.status===200&&(Zt=st?nt.getResponseHeader("Date"):nt.response,We=pt(Zt),isNaN(We)||(lt(We),Ht=!0))},K.isRelative(Pt)){var Ut=xe.resolve();Ut&&(Pt=K.resolve(Pt,Ut.url))}nt.open(Et,Pt),nt.timeout=R,nt.onload=Wt,nt.onloadend=Nt,nt.send()}function Pe(pt,Pt,lt){Ce(z,pt,Pt,lt,!0)}function he(){var pt=Q.getLatestMPDRequestHeaderValueByID("Date"),Pt=pt!==null?new Date(pt).getTime():Number.NaN;if(isNaN(Pt))Ue(!0);else{var lt=Pt-Date.now();Ue(!1,lt)}}function Ue(pt,Pt){if(!isNaN(Ee)&&!isNaN(Pt)&&!pt&&we(Pt),!pt&&!isNaN(Pt)){_e=Date.now(),J=!1;var lt=isNaN(Ee);Ee=Pt,lt&&pe(),Y.debug("Completed UTC sync. Setting client - server offset to ".concat(Pt))}pt&&(Se=null,J=!1,de.error(new m.default(S.default.TIME_SYNC_FAILED_ERROR_CODE,S.default.TIME_SYNC_FAILED_ERROR_MESSAGE))),k.trigger(_.default.UPDATE_TIME_SYNC_OFFSET,{offset:Pt}),k.trigger(_.default.TIME_SYNCHRONIZATION_COMPLETED)}function we(pt){try{var Pt=it(pt),lt=isNaN(Me)?L:Me,Ye=isNaN(ue.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor)?F:ue.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor,st=isNaN(ue.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts)?x:ue.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts,Nt=isNaN(ue.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts)?B:ue.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts,Wt;Pt?(Wt=Math.min(lt*Ye,st),Y.debug("Increasing timeBetweenSyncAttempts to ".concat(Wt))):(Wt=Math.max(lt/Ye,Nt),Y.debug("Decreasing timeBetweenSyncAttempts to ".concat(Wt))),Me=Wt}catch{}}function $e(){if(!(!se||se.length===0)){var pt=se.reduce(function(Pt,lt){return Pt+lt},0)/se.length;it(pt)?Y.debug("Completed background UTC sync. Offset is within allowed threshold and is not adjusted."):(Y.debug("Completed background UTC sync. Setting client - server offset to ".concat(pt)),Ee=pt,k.trigger(_.default.UPDATE_TIME_SYNC_OFFSET,{offset:Ee})),ee=!1,Z=Date.now()}}function it(pt){try{if(isNaN(Ee))return!0;var Pt=ue.get().streaming.utcSynchronization.maximumAllowedDrift&&!isNaN(ue.get().streaming.utcSynchronization.maximumAllowedDrift)?ue.get().streaming.utcSynchronization.maximumAllowedDrift:b,lt=Ee-Pt,Ye=Ee+Pt;return pt>=lt&&pt<=Ye}catch{return!0}}function mt(){De(),k.off(_.default.ATTEMPT_BACKGROUND_SYNC,pe,W)}return W={initialize:Ae,attemptSync:ge,setConfig:Le,reset:mt},Fe(),W}M.__dashjs_factory_name="TimeSyncController";var I=E.default.getSingletonFactory(M);I.HTTP_TIMEOUT_MS=R,E.default.updateSingletonFactory(M.__dashjs_factory_name,I);const U=I},"./src/streaming/controllers/XlinkController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>O});var m=d("./src/streaming/XlinkLoader.js"),g=d("./src/core/EventBus.js"),v=d("./src/core/events/Events.js"),_=d("./src/core/FactoryMaker.js"),S=d("./externals/xml2json.js"),E=d("./src/streaming/utils/URLUtils.js"),T=d("./src/dash/constants/DashConstants.js"),C="onLoad",R="onActuate",b="urn:mpeg:dash:resolve-to-zero:2013";function F(L){L=L||{};var D=this.context,x=(0,g.default)(D).getInstance(),B=(0,E.default)(D).getInstance(),M,I,U,w,k,K;function W(){x.on(v.default.XLINK_ELEMENT_LOADED,Q,M),K=(0,m.default)(D).create({errHandler:L.errHandler,dashMetrics:L.dashMetrics,mediaPlayerModel:L.mediaPlayerModel,requestModifier:L.requestModifier,settings:L.settings})}function Y(Me){Me&&(I=Me)}function J(Me){Me&&(U=Me)}function ee(Me){var de;k=new S.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:I}),w=Me,w.Period_asArray?(de=ve(w.Period_asArray,w,T.default.PERIOD,C),ie(de,T.default.PERIOD,C)):x.trigger(v.default.XLINK_READY,{manifest:w})}function ue(){x.off(v.default.XLINK_ELEMENT_LOADED,Q,M),K&&(K.reset(),K=null)}function ie(Me,de,xe){var Fe={},Le,De;Fe.elements=Me,Fe.type=de,Fe.resolveType=xe,Fe.elements.length===0&&se(Fe);for(var Ae=0;Ae<Fe.elements.length;Ae++)Le=Fe.elements[Ae],B.isHTTPURL(Le.url)?De=Le.url:De=Le.originalContent.BaseURL+Le.url,K.load(De,Le,Fe)}function Q(Me){var de,xe,Fe="<response>",Le="</response>",De="";if(de=Me.element,xe=Me.resolveObject,de.resolvedContent){var Ae=0;de.resolvedContent.indexOf("<?xml")===0&&(Ae=de.resolvedContent.indexOf("?>")+2),De=de.resolvedContent.substr(0,Ae)+Fe+de.resolvedContent.substr(Ae)+Le,de.resolvedContent=k.xml_str2json(De)}Ee(xe)&&se(xe)}function se(Me){var de=[],xe,Fe;if(_e(Me),Me.resolveType===R&&x.trigger(v.default.XLINK_READY,{manifest:w}),Me.resolveType===C)switch(Me.type){case T.default.PERIOD:for(xe=0;xe<w[T.default.PERIOD+"_asArray"].length;xe++)Fe=w[T.default.PERIOD+"_asArray"][xe],Fe.hasOwnProperty(T.default.ADAPTATION_SET+"_asArray")&&(de=de.concat(ve(Fe[T.default.ADAPTATION_SET+"_asArray"],Fe,T.default.ADAPTATION_SET,C))),Fe.hasOwnProperty(T.default.EVENT_STREAM+"_asArray")&&(de=de.concat(ve(Fe[T.default.EVENT_STREAM+"_asArray"],Fe,T.default.EVENT_STREAM,C)));ie(de,T.default.ADAPTATION_SET,C);break;case T.default.ADAPTATION_SET:x.trigger(v.default.XLINK_READY,{manifest:w});break}}function ve(Me,de,xe,Fe){var Le=[],De,Ae,ge;for(Ae=Me.length-1;Ae>=0;Ae--)De=Me[Ae],De.hasOwnProperty("xlink:href")&&De["xlink:href"]===b&&Me.splice(Ae,1);for(Ae=0;Ae<Me.length;Ae++)De=Me[Ae],De.hasOwnProperty("xlink:href")&&De.hasOwnProperty("xlink:actuate")&&De["xlink:actuate"]===Fe&&(ge=Z(De["xlink:href"],de,xe,Ae,Fe,De),Le.push(ge));return Le}function _e(Me){var de=[],xe,Fe,Le,De,Ae,ge;for(De=Me.elements.length-1;De>=0;De--){if(xe=Me.elements[De],Fe=xe.type+"_asArray",!xe.resolvedContent||Se())delete xe.originalContent["xlink:actuate"],delete xe.originalContent["xlink:href"],de.push(xe.originalContent);else if(xe.resolvedContent)for(Ae=0;Ae<xe.resolvedContent[Fe].length;Ae++)Le=xe.resolvedContent[Fe][Ae],de.push(Le);for(xe.parentElement[Fe].splice(xe.index,1),ge=0;ge<de.length;ge++)xe.parentElement[Fe].splice(xe.index+ge,0,de[ge]);de=[]}Me.elements.length>0&&U.run(w)}function Z(Me,de,xe,Fe,Le,De){return{url:Me,parentElement:de,type:xe,index:Fe,resolveType:Le,originalContent:De,resolvedContent:null,resolved:!1}}function Ee(Me){var de,xe;for(de=0;de<Me.elements.length;de++)if(xe=Me.elements[de],xe.resolved===!1)return!1;return!0}function Se(){return!1}return M={resolveManifestOnLoad:ee,setMatchers:Y,setIron:J,reset:ue},W(),M}F.__dashjs_factory_name="XlinkController";const O=_.default.getClassFactory(F)},"./src/streaming/metrics/MetricsReporting.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>C});var m=d("./src/streaming/metrics/utils/DVBErrorsTranslator.js"),g=d("./src/streaming/metrics/MetricsReportingEvents.js"),v=d("./src/streaming/metrics/controllers/MetricsCollectionController.js"),_=d("./src/streaming/metrics/metrics/MetricsHandlerFactory.js"),S=d("./src/streaming/metrics/reporting/ReportingFactory.js");function E(){var R=this.context,b,F;function O(x){return F=(0,m.default)(R).getInstance({eventBus:x.eventBus,dashMetrics:x.dashMetrics,metricsConstants:x.metricsConstants,events:x.events}),F.initialise(),(0,v.default)(R).create(x)}function L(){return(0,S.default)(R).getInstance()}function D(){return(0,_.default)(R).getInstance()}return b={createMetricsReporting:O,getReportingFactory:L,getMetricsHandlerFactory:D},b}E.__dashjs_factory_name="MetricsReporting";var T=dashjs.FactoryMaker.getClassFactory(E);T.events=g.default,dashjs.FactoryMaker.updateClassFactory(E.__dashjs_factory_name,T);const C=T},"./src/streaming/metrics/MetricsReportingEvents.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/core/events/EventsBase.js");function g(D){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(B){return typeof B}:g=function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},g(D)}function v(D,x){if(!(D instanceof x))throw new TypeError("Cannot call a class as a function")}function _(D,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");D.prototype=Object.create(x&&x.prototype,{constructor:{value:D,writable:!0,configurable:!0}}),x&&S(D,x)}function S(D,x){return S=Object.setPrototypeOf||function(M,I){return M.__proto__=I,M},S(D,x)}function E(D){var x=R();return function(){var M=b(D),I;if(x){var U=b(this).constructor;I=Reflect.construct(M,arguments,U)}else I=M.apply(this,arguments);return T(this,I)}}function T(D,x){return x&&(g(x)==="object"||typeof x=="function")?x:C(D)}function C(D){if(D===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D}function R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(D){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)},b(D)}var F=function(D){_(B,D);var x=E(B);function B(){var M;return v(this,B),M=x.call(this),M.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",M.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",M.CMCD_DATA_GENERATED="cmcdDataGenerated",M}return B}(m.default),O=new F;const L=O},"./src/streaming/metrics/controllers/MetricsCollectionController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/streaming/metrics/controllers/MetricsController.js"),g=d("./src/streaming/metrics/utils/ManifestParsing.js"),v=d("./src/streaming/metrics/MetricsReportingEvents.js");function _(E){E=E||{};var T,C={},R=this.context,b=E.eventBus,F=E.events;function O(B){if(!B.error){var M=Object.keys(C),I=(0,g.default)(R).getInstance({adapter:E.adapter,constants:E.constants}).getMetrics(B.manifest);I.forEach(function(U){var w=JSON.stringify(U);if(C.hasOwnProperty(w))M.splice(w,1);else try{var k=(0,m.default)(R).create(E);k.initialize(U),C[w]=k}catch{}}),M.forEach(function(U){C[U].reset(),delete C[U]}),b.trigger(v.default.METRICS_INITIALISATION_COMPLETE)}}function L(){Object.keys(C).forEach(function(B){C[B].reset()}),C={}}function D(){b.on(F.MANIFEST_UPDATED,O,T),b.on(F.STREAM_TEARDOWN_COMPLETE,L,T)}function x(){b.off(F.MANIFEST_UPDATED,O,T),b.off(F.STREAM_TEARDOWN_COMPLETE,L,T)}return T={reset:x},D(),T}_.__dashjs_factory_name="MetricsCollectionController";const S=dashjs.FactoryMaker.getClassFactory(_)},"./src/streaming/metrics/controllers/MetricsController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/streaming/metrics/controllers/RangeController.js"),g=d("./src/streaming/metrics/controllers/ReportingController.js"),v=d("./src/streaming/metrics/controllers/MetricsHandlersController.js");function _(E){E=E||{};var T,C,R,b,F=this.context;function O(D){try{R=(0,m.default)(F).create({mediaElement:E.mediaElement}),R.initialize(D.Range),C=(0,g.default)(F).create({debug:E.debug,metricsConstants:E.metricsConstants,mediaPlayerModel:E.mediaPlayerModel}),C.initialize(D.Reporting,R),T=(0,v.default)(F).create({debug:E.debug,eventBus:E.eventBus,metricsConstants:E.metricsConstants,events:E.events}),T.initialize(D.metrics,C)}catch(x){throw L(),x}}function L(){T&&T.reset(),C&&C.reset(),R&&R.reset()}return b={initialize:O,reset:L},b}_.__dashjs_factory_name="MetricsController";const S=dashjs.FactoryMaker.getClassFactory(_)},"./src/streaming/metrics/controllers/MetricsHandlersController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/streaming/metrics/metrics/MetricsHandlerFactory.js");function g(_){_=_||{};var S=[],E,T=this.context,C=_.eventBus,R=_.events,b=(0,m.default)(T).getInstance({debug:_.debug,eventBus:_.eventBus,metricsConstants:_.metricsConstants});function F(D){S.forEach(function(x){x.handleNewMetric(D.metric,D.value,D.mediaType)})}function O(D,x){D.split(",").forEach(function(B,M,I){var U;if(B.indexOf("(")!==-1&&B.indexOf(")")===-1){var w=I[M+1];w&&w.indexOf("(")===-1&&w.indexOf(")")!==-1&&(B+=","+w,delete I[M+1])}U=b.create(B,x),U&&S.push(U)}),C.on(R.METRIC_ADDED,F,E),C.on(R.METRIC_UPDATED,F,E)}function L(){C.off(R.METRIC_ADDED,F,E),C.off(R.METRIC_UPDATED,F,E),S.forEach(function(D){return D.reset()}),S=[]}return E={initialize:O,reset:L},E}g.__dashjs_factory_name="MetricsHandlersController";const v=dashjs.FactoryMaker.getClassFactory(g)},"./src/streaming/metrics/controllers/RangeController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/streaming/utils/CustomTimeRanges.js");function g(_){_=_||{};var S=!1,E=this.context,T,C,R=_.mediaElement;function b(D){D&&D.length&&(D.forEach(function(x){var B=x.starttime,M=B+x.duration;C.add(B,M)}),S=!!D[0]._useWallClockTime)}function F(){C.clear()}function O(){C=(0,m.default)(E).create()}function L(){var D=C.length,x;if(!D)return!0;x=S?new Date().getTime()/1e3:R.currentTime;for(var B=0;B<D;B+=1){var M=C.start(B),I=C.end(B);if(M<=x&&x<I)return!0}return!1}return T={initialize:b,reset:F,isEnabled:L},O(),T}g.__dashjs_factory_name="RangeController";const v=dashjs.FactoryMaker.getClassFactory(g)},"./src/streaming/metrics/controllers/ReportingController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/streaming/metrics/reporting/ReportingFactory.js");function g(_){var S=[],E,T=(0,m.default)(this.context).getInstance(_);function C(F,O){F.some(function(L){var D=T.create(L,O);if(D)return S.push(D),!0})}function R(){S.forEach(function(F){return F.reset()}),S=[]}function b(F,O){S.forEach(function(L){return L.report(F,O)})}return E={initialize:C,reset:R,report:b},E}g.__dashjs_factory_name="ReportingController";const v=dashjs.FactoryMaker.getClassFactory(g)},"./src/streaming/metrics/metrics/MetricsHandlerFactory.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});var m=d("./src/streaming/metrics/metrics/handlers/BufferLevelHandler.js"),g=d("./src/streaming/metrics/metrics/handlers/DVBErrorsHandler.js"),v=d("./src/streaming/metrics/metrics/handlers/HttpListHandler.js"),_=d("./src/streaming/metrics/metrics/handlers/GenericMetricHandler.js");function S(T){T=T||{};var C,R=T.debug?T.debug.getLogger(C):{},b=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,F=this.context,O={BufferLevel:m.default,DVBErrors:g.default,HttpList:v.default,PlayList:_.default,RepSwitchList:_.default,TcpList:_.default};function L(B,M){var I=B.match(b),U;if(I){try{U=O[I[1]](F).create({eventBus:T.eventBus,metricsConstants:T.metricsConstants}),U.initialize(I[1],M,I[3],I[5])}catch(w){U=null,R.error("MetricsHandlerFactory: Could not create handler for type ".concat(I[1]," with args ").concat(I[3],", ").concat(I[5]," (").concat(w.message,")"))}return U}}function D(B,M){O[B]=M}function x(B){delete O[B]}return C={create:L,register:D,unregister:x},C}S.__dashjs_factory_name="MetricsHandlerFactory";const E=dashjs.FactoryMaker.getSingletonFactory(S)},"./src/streaming/metrics/metrics/handlers/BufferLevelHandler.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/streaming/metrics/utils/HandlerHelpers.js");function g(_){_=_||{};var S,E,T,C,R,b,F=this.context,O=(0,m.default)(F).getInstance(),L=[],D=_.metricsConstants;function x(){try{return Object.keys(L).map(function(w){return L[w]}).reduce(function(w,k){return w.level<k.level?w:k})}catch{return}}function B(){var w=x();w&&b!==w.t&&(b=w.t,E.report(C,w))}function M(w,k,K){k&&(T=O.validateN(K),E=k,C=O.reconstructFullMetricName(w,K),R=setInterval(B,T))}function I(){clearInterval(R),R=null,T=0,E=null,b=null}function U(w,k,K){w===D.BUFFER_LEVEL&&(L[K]=k)}return S={initialize:M,reset:I,handleNewMetric:U},S}g.__dashjs_factory_name="BufferLevelHandler";const v=dashjs.FactoryMaker.getClassFactory(g)},"./src/streaming/metrics/metrics/handlers/DVBErrorsHandler.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/streaming/metrics/MetricsReportingEvents.js");function g(_){_=_||{};var S,E,T=_.eventBus,C=_.metricsConstants;function R(){T.off(m.default.METRICS_INITIALISATION_COMPLETE,R,this),T.trigger(m.default.BECAME_REPORTING_PLAYER)}function b(L,D){D&&(E=D,T.on(m.default.METRICS_INITIALISATION_COMPLETE,R,this))}function F(){E=null}function O(L,D){L===C.DVB_ERRORS&&E&&E.report(L,D)}return S={initialize:b,reset:F,handleNewMetric:O},S}const v=dashjs.FactoryMaker.getClassFactory(g)},"./src/streaming/metrics/metrics/handlers/GenericMetricHandler.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>g});function m(){var v,_,S;function E(R,b){_=R,S=b}function T(){S=null,_=void 0}function C(R,b){R===_&&S&&S.report(_,b)}return v={initialize:E,reset:T,handleNewMetric:C},v}m.__dashjs_factory_name="GenericMetricHandler";const g=dashjs.FactoryMaker.getClassFactory(m)},"./src/streaming/metrics/metrics/handlers/HttpListHandler.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/streaming/metrics/utils/HandlerHelpers.js");function g(_){_=_||{};var S,E,T,C,R,b,F=[],O=(0,m.default)(this.context).getInstance(),L=_.metricsConstants;function D(){var I=F;I.length&&E&&E.report(R,I),F=[]}function x(I,U,w,k){U&&(T=O.validateN(w),E=U,k&&k.length&&(C=k),R=O.reconstructFullMetricName(I,w,k),b=setInterval(D,T))}function B(){clearInterval(b),b=null,T=null,C=null,F=[],E=null}function M(I,U){I===L.HTTP_REQUEST&&(!C||C===U.type)&&F.push(U)}return S={initialize:x,reset:B,handleNewMetric:M},S}g.__dashjs_factory_name="HttpListHandler";const v=dashjs.FactoryMaker.getClassFactory(g)},"./src/streaming/metrics/reporting/ReportingFactory.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/streaming/metrics/reporting/reporters/DVBReporting.js");function g(_){_=_||{};var S={"urn:dvb:dash:reporting:2014":m.default},E=this.context,T,C=_.debug?_.debug.getLogger(T):{},R=_.metricsConstants,b=_.mediaPlayerModel||{};function F(D,x){var B;try{B=S[D.schemeIdUri](E).create({metricsConstants:R,mediaPlayerModel:b}),B.initialize(D,x)}catch(M){B=null,C.error("ReportingFactory: could not create Reporting with schemeIdUri ".concat(D.schemeIdUri," (").concat(M.message,")"))}return B}function O(D,x){S[D]=x}function L(D){delete S[D]}return T={create:F,register:O,unregister:L},T}g.__dashjs_factory_name="ReportingFactory";const v=dashjs.FactoryMaker.getSingletonFactory(g)},"./src/streaming/metrics/reporting/reporters/DVBReporting.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/streaming/metrics/utils/MetricSerialiser.js"),g=d("./src/streaming/metrics/utils/RNG.js"),v=d("./src/streaming/models/CustomParametersModel.js");function _(E){E=E||{};var T,C=this.context,R,b,F,O,L,D,x,B=[],M=E.metricsConstants;function I(){R=(0,m.default)(C).getInstance(),F=(0,g.default)(C).getInstance(),b=(0,v.default)(C).getInstance(),K()}function U(Y,J,ee){var ue=new XMLHttpRequest;ue.withCredentials=b.getXHRWithCredentialsForType(M.HTTP_REQUEST_DVB_REPORTING_TYPE);var ie=function(){var se=B.indexOf(ue);se!==-1&&(B.splice(se,1),ue.status>=200&&ue.status<300?J&&J():ee&&ee())};B.push(ue);try{ue.open("GET",Y),ue.onloadend=ie,ue.onerror=ie,ue.send()}catch{ue.onerror()}}function w(Y,J){Array.isArray(J)||(J=[J]),L&&x.isEnabled()&&J.forEach(function(ee){var ue=R.serialise(ee);Y!==M.DVB_ERRORS&&(ue="metricname=".concat(Y,"&").concat(ue)),ue="".concat(D,"?").concat(ue),U(ue,null,function(){L=!1})})}function k(Y,J){var ee;if(x=J,D=Y.dvb_reportingUrl,!D)throw new Error("required parameter missing (dvb:reportingUrl)");O||(ee=Y.dvb_probability,ee&&(ee===1e3||ee/1e3>=F.random())&&(L=!0),O=!0)}function K(){O=!1,L=!1,D=null,x=null}function W(){K()}return T={report:w,initialize:k,reset:W},I(),T}_.__dashjs_factory_name="DVBReporting";const S=dashjs.FactoryMaker.getClassFactory(_)},"./src/streaming/metrics/utils/DVBErrorsTranslator.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});var m=d("./src/streaming/metrics/vo/DVBErrors.js"),g=d("./src/streaming/metrics/MetricsReportingEvents.js");function v(S){S=S||{};var E,T,C=S.eventBus,R=S.dashMetrics,b=S.metricsConstants,F=S.events;function O(k){var K=new m.default;if(T){for(var W in k)k.hasOwnProperty(W)&&(K[W]=k[W]);K.mpdurl||(K.mpdurl=T.originalUrl||T.url),K.terror||(K.terror=new Date),R.addDVBErrors(K)}}function L(k){k.error||(T=k.manifest)}function D(k){O({errorcode:m.default.BASE_URL_CHANGED,servicelocation:k.entry})}function x(){O({errorcode:m.default.BECAME_REPORTER})}function B(k){(k.responsecode===0||k.responsecode==null||k.responsecode>=400||k.responsecode<100||k.responsecode>=600)&&O({errorcode:k.responsecode||m.default.CONNECTION_ERROR,url:k.url,terror:k.tresponse,servicelocation:k._serviceLocation})}function M(k){switch(k.metric){case b.HTTP_REQUEST:B(k.value);break}}function I(k){var K=k.error?k.error.code:0,W;switch(K){case MediaError.MEDIA_ERR_NETWORK:W=m.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:W=m.default.CORRUPT_MEDIA_OTHER;break;default:return}O({errorcode:W})}function U(){C.on(F.MANIFEST_UPDATED,L,E),C.on(F.SERVICE_LOCATION_BLACKLIST_CHANGED,D,E),C.on(F.METRIC_ADDED,M,E),C.on(F.METRIC_UPDATED,M,E),C.on(F.PLAYBACK_ERROR,I,E),C.on(g.default.BECAME_REPORTING_PLAYER,x,E)}function w(){C.off(F.MANIFEST_UPDATED,L,E),C.off(F.SERVICE_LOCATION_BLACKLIST_CHANGED,D,E),C.off(F.METRIC_ADDED,M,E),C.off(F.METRIC_UPDATED,M,E),C.off(F.PLAYBACK_ERROR,I,E),C.off(g.default.BECAME_REPORTING_PLAYER,x,E)}return E={initialise:U,reset:w},E}v.__dashjs_factory_name="DVBErrorsTranslator";const _=dashjs.FactoryMaker.getSingletonFactory(v)},"./src/streaming/metrics/utils/HandlerHelpers.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>g});function m(){return{reconstructFullMetricName:function(_,S,E){var T=_;return S&&(T+="("+S,E&&E.length&&(T+=","+E),T+=")"),T},validateN:function(_){if(!_)throw new Error("missing n");if(isNaN(_))throw new Error("n is NaN");if(_<0)throw new Error("n must be positive");return _}}}m.__dashjs_factory_name="HandlerHelpers";const g=dashjs.FactoryMaker.getSingletonFactory(m)},"./src/streaming/metrics/utils/ManifestParsing.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/streaming/metrics/vo/Metrics.js"),g=d("./src/streaming/metrics/vo/Range.js"),v=d("./src/streaming/metrics/vo/Reporting.js");function _(E){E=E||{};var T,C=E.adapter,R=E.constants;function b(O,L,D){var x,B,M=0;return L?M=C.getAvailabilityStartTime(O)/1e3:(x=C.getRegularPeriods(O),x.length&&(M=x[0].start)),B=M,D&&D.hasOwnProperty(R.START_TIME)&&(B+=D.starttime),B}function F(O){var L=[];return O&&O.Metrics_asArray&&O.Metrics_asArray.forEach(function(D){var x=new m.default,B=C.getIsDynamic(O);if(D.hasOwnProperty("metrics"))x.metrics=D.metrics;else return;if(D.Range_asArray&&D.Range_asArray.forEach(function(M){var I=new g.default;I.starttime=b(O,B,M),M.hasOwnProperty("duration")?I.duration=M.duration:I.duration=C.getDuration(O),I._useWallClockTime=B,x.Range.push(I)}),D.Reporting_asArray)D.Reporting_asArray.forEach(function(M){var I=new v.default;if(M.hasOwnProperty(R.SCHEME_ID_URI))I.schemeIdUri=M.schemeIdUri;else return;M.hasOwnProperty("value")&&(I.value=M.value),M.hasOwnProperty(R.DVB_REPORTING_URL)&&(I.dvb_reportingUrl=M[R.DVB_REPORTING_URL]),M.hasOwnProperty(R.DVB_PROBABILITY)&&(I.dvb_probability=M[R.DVB_PROBABILITY]),x.Reporting.push(I)});else return;L.push(x)}),L}return T={getMetrics:F},T}_.__dashjs_factory_name="ManifestParsing";const S=dashjs.FactoryMaker.getSingletonFactory(_)},"./src/streaming/metrics/utils/MetricSerialiser.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>g});function m(){function v(_){var S=[],E=[],T,C;for(T in _)if(_.hasOwnProperty(T)&&T.indexOf("_")!==0){if(C=_[T],C==null&&(C=""),Array.isArray(C)){if(!C.length)continue;E=[],C.forEach(function(R){var b=Object.prototype.toString.call(R).slice(8,-1)!=="Object";E.push(b?R:v(R))}),C=E.map(encodeURIComponent).join(",")}else typeof C=="string"?C=encodeURIComponent(C):C instanceof Date?C=C.toISOString():typeof C=="number"&&(C=Math.round(C));S.push(T+"="+C)}return S.join("&")}return{serialise:v}}m.__dashjs_factory_name="MetricSerialiser";const g=dashjs.FactoryMaker.getSingletonFactory(m)},"./src/streaming/metrics/utils/RNG.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>g});function m(){var v=window.crypto||window.msCrypto,_=Uint32Array,S=Math.pow(2,_.BYTES_PER_ELEMENT*8)-1,E=10,T,C,R;function b(){v&&(T||(T=new _(E)),v.getRandomValues(T),C=0)}function F(O,L){var D;return O||(O=0),L||(L=1),v?(C===T.length&&b(),D=T[C]/S,C+=1):D=Math.random(),D*(L-O)+O}return R={random:F},b(),R}m.__dashjs_factory_name="RNG";const g=dashjs.FactoryMaker.getSingletonFactory(m)},"./src/streaming/metrics/vo/DVBErrors.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};g.SSL_CONNECTION_FAILED_PREFIX="SSL",g.DNS_RESOLUTION_FAILED="C00",g.HOST_UNREACHABLE="C01",g.CONNECTION_REFUSED="C02",g.CONNECTION_ERROR="C03",g.CORRUPT_MEDIA_ISOBMFF="M00",g.CORRUPT_MEDIA_OTHER="M01",g.BASE_URL_CHANGED="F00",g.BECAME_REPORTER="S00";const v=g},"./src/streaming/metrics/vo/Metrics.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.metrics="",this.Range=[],this.Reporting=[]};const v=g},"./src/streaming/metrics/vo/Range.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1};const v=g},"./src/streaming/metrics/vo/Reporting.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});function m(S,E){if(!(S instanceof E))throw new TypeError("Cannot call a class as a function")}var g=1e3,v=function S(){m(this,S),this.schemeIdUri="",this.value="",this.dvb_reportingUrl="",this.dvb_probability=g};const _=v},"./src/streaming/models/BaseURLTreeModel.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>T});var m=d("./src/streaming/utils/ObjectUtils.js"),g=d("./src/core/FactoryMaker.js");function v(C,R){if(!(C instanceof R))throw new TypeError("Cannot call a class as a function")}var _=NaN,S=function C(R,b){v(this,C),this.data={baseUrls:R||null,selectedIdx:b||_},this.children=[]};function E(){var C,R,b,F=this.context,O=(0,m.default)(F).getInstance();function L(){k()}function D(W){W.adapter&&(b=W.adapter)}function x(){if(!b||!b.hasOwnProperty("getBaseURLsFromElement")||!b.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}function B(W,Y,J){var ee=b.getBaseURLsFromElement(J);W[Y]?O.areEqual(ee,W[Y].data.baseUrls)||(W[Y].data.baseUrls=ee,W[Y].data.selectedIdx=_):W[Y]=new S(ee)}function M(W){x();var Y=b.getBaseURLsFromElement(W);O.areEqual(Y,R.data.baseUrls)||(R.data.baseUrls=Y,R.data.selectedIdx=_),W&&W.Period_asArray&&W.Period_asArray.forEach(function(J,ee){B(R.children,ee,J),J.AdaptationSet_asArray&&J.AdaptationSet_asArray.forEach(function(ue,ie){B(R.children[ee].children,ie,ue),ue.Representation_asArray&&ue.Representation_asArray.sort(b.getRepresentationSortFunction()).forEach(function(Q,se){B(R.children[ee].children[ie].children,se,Q)})})})}function I(W,Y){var J=Y||R;W(J.data),J.children&&J.children.forEach(function(ee){return I(W,ee)})}function U(W){I(function(Y){isNaN(Y.selectedIdx)||W===Y.baseUrls[Y.selectedIdx].serviceLocation&&(Y.selectedIdx=_)})}function w(W){M(W)}function k(){R=new S}function K(W){var Y=R,J=[Y.data];return W&&W.forEach(function(ee){Y=Y.children[ee],Y&&J.push(Y.data)}),J.filter(function(ee){return ee.baseUrls.length})}return C={reset:k,update:w,getForPath:K,invalidateSelectedIndexes:U,setConfig:D},L(),C}E.__dashjs_factory_name="BaseURLTreeModel";const T=g.default.getClassFactory(E)},"./src/streaming/models/CmcdModel.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>w});var m=d("./src/core/EventBus.js"),g=d("./src/streaming/MediaPlayerEvents.js"),v=d("./src/streaming/metrics/MetricsReportingEvents.js"),_=d("./src/core/FactoryMaker.js"),S=d("./src/core/Settings.js"),E=d("./src/streaming/constants/Constants.js"),T=d("./src/streaming/vo/metrics/HTTPRequest.js"),C=d("./src/dash/models/DashManifestModel.js"),R=d("./src/core/Utils.js");function b(k,K){var W;if(typeof Symbol>"u"||k[Symbol.iterator]==null){if(Array.isArray(k)||(W=F(k))||K&&k&&typeof k.length=="number"){W&&(k=W);var Y=0,J=function(){};return{s:J,n:function(){return Y>=k.length?{done:!0}:{done:!1,value:k[Y++]}},e:function(se){throw se},f:J}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ee=!0,ue=!1,ie;return{s:function(){W=k[Symbol.iterator]()},n:function(){var se=W.next();return ee=se.done,se},e:function(se){ue=!0,ie=se},f:function(){try{!ee&&W.return!=null&&W.return()}finally{if(ue)throw ie}}}}function F(k,K){if(k){if(typeof k=="string")return O(k,K);var W=Object.prototype.toString.call(k).slice(8,-1);if(W==="Object"&&k.constructor&&(W=k.constructor.name),W==="Map"||W==="Set")return Array.from(k);if(W==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(W))return O(k,K)}}function O(k,K){(K==null||K>k.length)&&(K=k.length);for(var W=0,Y=new Array(K);W<K;W++)Y[W]=k[W];return Y}var L="CMCD",D=1,x={MANIFEST:"m",AUDIO:"a",VIDEO:"v",INIT:"i",CAPTION:"c",ISOBMFF_TEXT_TRACK:"tt",ENCRYPTION_KEY:"k",OTHER:"o"},B={DASH:"d",MSS:"s"},M={VOD:"v",LIVE:"l"},I=5;function U(){var k,K,W,Y,J,ee,ue,ie,Q,se,ve=this.context,_e=(0,m.default)(ve).getInstance(),Z=(0,S.default)(ve).getInstance();function Ee(){k=(0,C.default)(ve).getInstance(),de()}function Se(){_e.on(g.default.PLAYBACK_RATE_CHANGED,Ue,K),_e.on(g.default.MANIFEST_LOADED,we,K),_e.on(g.default.BUFFER_LEVEL_STATE_CHANGED,$e,K),_e.on(g.default.PLAYBACK_SEEKED,it,K),_e.on(g.default.PERIOD_SWITCH_COMPLETED,xe,K)}function Me(Ye){Ye&&(Ye.abrController&&(Y=Ye.abrController),Ye.dashMetrics&&(J=Ye.dashMetrics),Ye.playbackController&&(ee=Ye.playbackController))}function de(){W={pr:1,nor:null,st:null,sf:null,sid:"".concat(R.default.generateUuid()),cid:null},Q={},ie={},se={},Fe()}function xe(){Fe()}function Fe(){if(ee){var Ye=ee.getStreamController();if(Ye&&typeof Ye.getActiveStream=="function"){var st=Ye.getActiveStream();st&&(ue=st.getProcessors())}}}function Le(Ye){try{if(Z.get().streaming.cmcd&&Z.get().streaming.cmcd.enabled){var st=Re(Ye),Nt=De(st),Wt=mt(Nt);return _e.trigger(v.default.CMCD_DATA_GENERATED,{url:Ye.url,mediaType:Ye.mediaType,cmcdData:st,cmcdString:Wt}),{key:L,value:Wt}}return null}catch{return null}}function De(Ye){try{var st=Z.get().streaming.cmcd.enabledKeys;return Object.keys(Ye).filter(function(Nt){return st.includes(Nt)}).reduce(function(Nt,Wt){return Nt[Wt]=Ye[Wt],Nt},{})}catch{return Ye}}function Ae(Ye,st){var Nt={},Wt=b(st),Ht;try{for(Wt.s();!(Ht=Wt.n()).done;){var nt=Ht.value;Ye[nt]&&(Nt[nt]=Ye[nt])}}catch(Et){Wt.e(Et)}finally{Wt.f()}return Nt}function ge(Ye){try{if(Z.get().streaming.cmcd&&Z.get().streaming.cmcd.enabled){var st=Re(Ye),Nt=Ae(st,pe(["br","d","ot","tb"])),Wt=Ae(st,pe(["bl","dl","mtp","nor","nrr","su"])),Ht=Ae(st,pe(["bs","rtp"])),nt=Ae(st,pe(["cid","pr","sf","sid","st","v"])),Et={"CMCD-Object":mt(Nt),"CMCD-Request":mt(Wt),"CMCD-Status":mt(Ht),"CMCD-Session":mt(nt)};return _e.trigger(v.default.CMCD_DATA_GENERATED,{url:Ye.url,mediaType:Ye.mediaType,cmcdData:st,headers:Et}),Et}return null}catch{return null}}function pe(Ye){var st=Z.get().streaming.cmcd.enabledKeys;return Ye.filter(function(Nt){return st.includes(Nt)})}function Re(Ye){try{var st=null;return Ye.type===T.HTTPRequest.MPD_TYPE?V(Ye):Ye.type===T.HTTPRequest.MEDIA_SEGMENT_TYPE?($(Ye.mediaType),j(Ye)):Ye.type===T.HTTPRequest.INIT_SEGMENT_TYPE?re(Ye):Ye.type===T.HTTPRequest.OTHER_TYPE||Ye.type===T.HTTPRequest.XLINK_EXPANSION_TYPE?oe(Ye):Ye.type===T.HTTPRequest.LICENSE?me(Ye):st}catch{return null}}function me(Ye){var st=X();return st.ot=x.ENCRYPTION_KEY,st}function V(){var Ye=X();return Ye.ot=x.MANIFEST,Ye}function j(Ye){var st=X(),Nt=z(Ye),Wt=fe(Ye),Ht=Ce(Ye.mediaType),nt=Pe(Ye.mediaType),Et=he(Ye.mediaType),St=ne(Ye.mediaType),Ut=W.pr,Vt=pt(Ye.mediaType),Zt;Ye.mediaType===E.default.VIDEO&&(Zt=x.VIDEO),Ye.mediaType===E.default.AUDIO&&(Zt=x.AUDIO),Ye.mediaType===E.default.TEXT&&(Ye.mediaInfo.mimeType==="application/mp4"?Zt=x.ISOBMFF_TEXT_TRACK:Zt=x.CAPTION);var We=Z.get().streaming.cmcd.rtp;return We||(We=Pt(Ye)),st.rtp=We,Vt&&(Ye.url!==Vt.url?st.nor=encodeURIComponent(R.default.getRelativeUrl(Ye.url,Vt.url)):Vt.range&&(st.nrr=Vt.range)),Nt&&(st.br=Nt),Zt&&(st.ot=Zt),isNaN(Wt)||(st.d=Wt),isNaN(Ht)||(st.mtp=Ht),isNaN(nt)||(st.dl=nt),isNaN(Et)||(st.bl=Et),isNaN(St)||(st.tb=St),!isNaN(Ut)&&Ut!==1&&(st.pr=Ut),Q[Ye.mediaType]&&(st.bs=!0,Q[Ye.mediaType]=!1),(ie[Ye.mediaType]||!se[Ye.mediaType])&&(st.su=!0,ie[Ye.mediaType]=!1,se[Ye.mediaType]=!0),st}function $(Ye){se.hasOwnProperty(Ye)||(se[Ye]=!1),ie.hasOwnProperty(Ye)||(ie[Ye]=!1),Q.hasOwnProperty(Ye)||(Q[Ye]=!1)}function re(){var Ye=X();return Ye.ot=x.INIT,Ye.su=!0,Ye}function oe(){var Ye=X();return Ye.ot=x.OTHER,Ye}function X(){var Ye={},st=Z.get().streaming.cmcd.cid?Z.get().streaming.cmcd.cid:W.cid;return Ye.v=D,Ye.sid=Z.get().streaming.cmcd.sid?Z.get().streaming.cmcd.sid:W.sid,Ye.sid="".concat(Ye.sid),st&&(Ye.cid="".concat(st)),!isNaN(W.pr)&&W.pr!==1&&W.pr!==null&&(Ye.pr=W.pr),W.st&&(Ye.st=W.st),W.sf&&(Ye.sf=W.sf),Ye}function z(Ye){try{var st=Ye.quality,Nt=Ye.mediaInfo.bitrateList;return parseInt(Nt[st].bandwidth/1e3)}catch{return null}}function ne(Ye){try{var st=Y.getTopBitrateInfoFor(Ye);return Math.round(st.bitrate/1e3)}catch{return null}}function fe(Ye){try{return isNaN(Ye.duration)?null:Math.round(Ye.duration*1e3)}catch{return null}}function Ce(Ye){try{return parseInt(Y.getThroughputHistory().getSafeAverageThroughput(Ye)/100)*100}catch{return null}}function Pe(Ye){try{var st=W.pr,Nt=J.getCurrentBufferLevel(Ye);return!isNaN(st)&&!isNaN(Nt)?parseInt(Nt/st*10)*100:null}catch{return null}}function he(Ye){try{var st=J.getCurrentBufferLevel(Ye);return isNaN(st)?null:parseInt(st*10)*100}catch{return null}}function Ue(Ye){try{W.pr=Ye.playbackRate}catch{}}function we(Ye){try{var st=k.getIsDynamic(Ye.data),Nt=st?M.LIVE:M.VOD,Wt=Ye.protocol&&Ye.protocol==="MSS"?B.MSS:B.DASH;W.st="".concat(Nt),W.sf="".concat(Wt)}catch{}}function $e(Ye){try{Ye.state&&Ye.mediaType&&Ye.state===g.default.BUFFER_EMPTY&&(Q[Ye.mediaType]||(Q[Ye.mediaType]=!0),ie[Ye.mediaType]||(ie[Ye.mediaType]=!0))}catch{}}function it(){for(var Ye in Q)Q.hasOwnProperty(Ye)&&(Q[Ye]=!0);for(var st in ie)ie.hasOwnProperty(st)&&(ie[st]=!0)}function mt(Ye){try{if(!Ye)return null;var st=Object.keys(Ye).sort(function(Ht,nt){return Ht.localeCompare(nt)}),Nt=st.length,Wt=st.reduce(function(Ht,nt,Et){return nt==="v"&&Ye[nt]===1||(typeof Ye[nt]=="string"&&nt!=="ot"&&nt!=="sf"&&nt!=="st"?Ht+="".concat(nt,"=").concat(JSON.stringify(Ye[nt])):Ht+="".concat(nt,"=").concat(Ye[nt]),Et<Nt-1&&(Ht+=",")),Ht},"");return Wt=Wt.replace(/=true/g,""),Wt=Wt.replace(/,\s*$/,""),Wt}catch{return null}}function pt(Ye){if(!(!ue||ue.length===0)){var st=b(ue),Nt;try{for(st.s();!(Nt=st.n()).done;){var Wt=Nt.value;if(Wt.getType()===Ye)return Wt.probeNextRequest()}}catch(Ht){st.e(Ht)}finally{st.f()}}}function Pt(Ye){var st=ee.getPlaybackRate();st||(st=1);var Nt=Ye.quality,Wt=Ye.mediaType,Ht=Ye.mediaInfo,nt=Ye.duration,Et=he(Wt);Et===0&&(Et=500);var St=Ht.bitrateList[Nt].bandwidth,Ut=St*nt/1e3,Vt=Et/st/1e3,Zt=Ut/Vt,We=Z.get().streaming.cmcd.rtpSafetyFactor&&!isNaN(Z.get().streaming.cmcd.rtpSafetyFactor)?Z.get().streaming.cmcd.rtpSafetyFactor:I,In=Zt*We,Ct=(parseInt(In/100)+1)*100;return Ct}function lt(){_e.off(g.default.PLAYBACK_RATE_CHANGED,Ue,this),_e.off(g.default.MANIFEST_LOADED,we,this),_e.off(g.default.BUFFER_LEVEL_STATE_CHANGED,$e,K),_e.off(g.default.PLAYBACK_SEEKED,it,K),de()}return K={getQueryParameter:Le,getHeaderParameters:ge,setConfig:Me,reset:lt,initialize:Se},Ee(),K}U.__dashjs_factory_name="CmcdModel";const w=_.default.getSingletonFactory(U)},"./src/streaming/models/CmsdModel.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>J});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/EventBus.js"),v=d("./src/core/events/Events.js"),_=d("./src/core/Debug.js");function S(ee){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?S=function(ie){return typeof ie}:S=function(ie){return ie&&typeof Symbol=="function"&&ie.constructor===Symbol&&ie!==Symbol.prototype?"symbol":typeof ie},S(ee)}function E(ee,ue){E=function(Ee,Se){return new ve(Ee,void 0,Se)};var ie=C(RegExp),Q=RegExp.prototype,se=new WeakMap;function ve(Z,Ee,Se){var Me=ie.call(this,Z,Ee);return se.set(Me,Se||se.get(Z)),Me}T(ve,ie),ve.prototype.exec=function(Z){var Ee=Q.exec.call(this,Z);return Ee&&(Ee.groups=_e(Ee,this)),Ee},ve.prototype[Symbol.replace]=function(Z,Ee){if(typeof Ee=="string"){var Se=se.get(this);return Q[Symbol.replace].call(this,Z,Ee.replace(/\$<([^>]+)>/g,function(de,xe){return"$"+Se[xe]}))}else if(typeof Ee=="function"){var Me=this;return Q[Symbol.replace].call(this,Z,function(){var de=[];return de.push.apply(de,arguments),S(de[de.length-1])!=="object"&&de.push(_e(de,Me)),Ee.apply(this,de)})}else return Q[Symbol.replace].call(this,Z,Ee)};function _e(Z,Ee){var Se=se.get(Ee);return Object.keys(Se).reduce(function(Me,de){return Me[de]=Z[Se[de]],Me},Object.create(null))}return E.apply(this,arguments)}function T(ee,ue){if(typeof ue!="function"&&ue!==null)throw new TypeError("Super expression must either be null or a function");ee.prototype=Object.create(ue&&ue.prototype,{constructor:{value:ee,writable:!0,configurable:!0}}),ue&&O(ee,ue)}function C(ee){var ue=typeof Map=="function"?new Map:void 0;return C=function(Q){if(Q===null||!F(Q))return Q;if(typeof Q!="function")throw new TypeError("Super expression must either be null or a function");if(typeof ue<"u"){if(ue.has(Q))return ue.get(Q);ue.set(Q,se)}function se(){return R(Q,arguments,L(this).constructor)}return se.prototype=Object.create(Q.prototype,{constructor:{value:se,enumerable:!1,writable:!0,configurable:!0}}),O(se,Q)},C(ee)}function R(ee,ue,ie){return b()?R=Reflect.construct:R=function(se,ve,_e){var Z=[null];Z.push.apply(Z,ve);var Ee=Function.bind.apply(se,Z),Se=new Ee;return _e&&O(Se,_e.prototype),Se},R.apply(null,arguments)}function b(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function F(ee){return Function.toString.call(ee).indexOf("[native code]")!==-1}function O(ee,ue){return O=Object.setPrototypeOf||function(Q,se){return Q.__proto__=se,Q},O(ee,ue)}function L(ee){return L=Object.setPrototypeOf?Object.getPrototypeOf:function(ie){return ie.__proto__||Object.getPrototypeOf(ie)},L(ee)}var D="static",x="dynamic",B="cmsd-",M=B+D,I=B+x,U={AVAILABILITY_TIME:"at",DURESS:"du",ENCODED_BITRATE:"br",ESTIMATED_THROUGHPUT:"etp",HELD_TIME:"ht",INTERMEDIARY_IDENTIFIER:"n",MAX_SUGGESTED_BITRATE:"mb",NEXT_OBJECT_RESPONSE:"nor",NEXT_RANGE_RESPONSE:"nrr",OBJECT_DURATION:"d",OBJECT_TYPE:"ot",RESPONSE_DELAY:"rd",ROUND_TRIP_TIME:"rtt",STARTUP:"su",STREAM_TYPE:"st",STREAMING_FORMAT:"sf",VERSION:"v"},w={MANIFEST:"m",AUDIO:"a",VIDEO:"v",INIT:"i",CAPTION:"c",ISOBMFF_TEXT_TRACK:"tt",ENCRYPTION_KEY:"k",OTHER:"o",STREAM:"stream"},k=[U.MAX_SUGGESTED_BITRATE,U.STREAM_TYPE,U.STREAMING_FORMAT,U.VERSION],K={video:w.VIDEO,audio:w.AUDIO,text:w.ISOBMFF_TEXT_TRACK,stream:w.STREAM},W=/^[-0-9]/;function Y(){var ee=this.context,ue=(0,g.default)(ee).getInstance(),ie,Q,se,ve;function _e(){Q=(0,_.default)(ee).getInstance().getLogger(ie),Se()}function Z(){}function Ee(){}function Se(){se={},ve={}}function Me(j){j&&Object.keys(j).forEach(function($){k.includes($)||delete j[$]})}function de(j){return j?j.toLowerCase()==="false"?!1:W.test(j)?parseInt(j,10):j.replace(/["]+/g,""):!0}function xe(j){try{for(var $={},re=j.split(","),oe=0;oe<re.length;oe++){var X=re[oe].split("="),z=X[0],ne=de(X[1]);$[z]=ne}return $}catch(fe){Q.error("Failed to parse CMSD-Static response header value:",fe)}}function Fe(j){try{for(var $={},re=j.split(","),oe=re[re.length-1],X=oe.split(";"),z=1;z<X.length;z++){var ne=X[z].split("="),fe=ne[0],Ce=de(ne[1]);$[fe]=Ce}return $}catch(Pe){return Q.error("Failed to parse CMSD-Dynamic response header value:",Pe),[]}}function Le(j){return K[j]||w.OTHER}function De(j,$,re){var oe=j===D?se:ve,X=oe[$]||{},z=oe[w.STREAM]||{},ne=X[re]||z[re];return ne}function Ae(j,$){for(var re=null,oe=null,X=j.split(`\r
`),z=X.length-1;z>=0;z--){var ne=X[z],fe=ne.match(E(/^((?:(?!:)[\s\S])*):[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(.*)$/,{key:1,value:2}));if(fe&&fe.groups){var Ce=fe.groups.key.toLowerCase(),Pe=fe.groups.value;switch(Ce){case M:re=xe(Pe),ue.trigger(v.default.CMSD_STATIC_HEADER,re);break;case I:oe||(oe=Fe(Pe));break}}}var he=w.STREAM;return re&&re[U.OBJECT_TYPE]?he=re[U.OBJECT_TYPE]:$&&(he=Le($)),Me(se[he]),Me(ve[he]),re&&(se[he]=Object.assign(se[he]||{},re)),oe&&(ve[he]=Object.assign(ve[he]||{},oe)),{static:re,dynamic:oe}}function ge(j){var $=Le(j),re=De(x,$,U.MAX_SUGGESTED_BITRATE);return re||-1}function pe(j){var $=Le(j),re=De(x,$,U.ESTIMATED_THROUGHPUT);return re||null}function Re(j){var $=Le(j),re=De(x,$,U.RESPONSE_DELAY);return re||null}function me(j){var $=Le(j),re=De(x,$,U.ROUND_TRIP_TIME);return re||null}function V(){Se()}return ie={setConfig:Ee,initialize:Z,reset:V,parseResponseHeaders:Ae,getMaxBitrate:ge,getEstimatedThroughput:pe,getResponseDelay:Re,getRoundTripTime:me},_e(),ie}Y.__dashjs_factory_name="CmsdModel";const J=m.default.getSingletonFactory(Y)},"./src/streaming/models/CustomParametersModel.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>R});var m=d("./src/dash/vo/UTCTiming.js"),g=d("./src/core/FactoryMaker.js"),v=d("./src/core/Settings.js"),_=d("./src/streaming/utils/SupervisorTools.js"),S=d("./src/streaming/rules/abr/ABRRulesCollection.js"),E=d("./src/streaming/constants/Constants.js"),T=!1;function C(){var b,F,O,L,D,x,B,M,I=this.context,U=(0,v.default)(I).getInstance();function w(){O={default:T},k()}function k(){L=[],D=[],x=[],M=[],B=null,F=[]}function K(){k()}function W(){}function Y($){B=$}function J(){B=null}function ee(){return B}function ue(){return L}function ie(){return D}function Q($){L.push($)}function se($){D.push($)}function ve($){Me(L,$)}function _e($){Me(D,$)}function Z(){return x}function Ee($){x.push($)}function Se($){Me(x,$)}function Me($,re){var oe=-1;$.some(function(X,z){if(X===re)return oe=z,!0}),!(oe<0)&&$.splice(oe,1)}function de($){var re;for(re=0;re<M.length;re++)if(M[re].rulename===$)return re;return-1}function xe($,re,oe){if(typeof $!="string"||$!==S.default.ABANDON_FRAGMENT_RULES&&$!==S.default.QUALITY_SWITCH_RULES||typeof re!="string")throw E.default.BAD_ARGUMENT_ERROR;var X=de(re);X===-1?M.push({type:$,rulename:re,rule:oe}):(M[X].type=$,M[X].rule=oe)}function Fe($){if($){var re=de($);re!==-1&&M.splice(re,1)}else M=[]}function Le(){M=[]}function De(){return M}function Ae($,re){pe($,re);var oe=new m.default;oe.schemeIdUri=$,oe.value=re,F.push(oe)}function ge(){return F}function pe($,re){(0,_.checkParameterType)($,"string"),(0,_.checkParameterType)(re,"string"),F.forEach(function(oe,X){oe.schemeIdUri===$&&oe.value===re&&F.splice(X,1)})}function Re(){F=[]}function me(){var $=U.get().streaming.utcSynchronization.defaultTimingSource;Ae($.scheme,$.value)}function V($,re){$?O[$]=!!re:Object.keys(O).forEach(function(oe){V(oe,re)})}function j($){var re=O[$];return re===void 0?O.default:re}return b={getCustomInitialTrackSelectionFunction:ee,setCustomInitialTrackSelectionFunction:Y,resetCustomInitialTrackSelectionFunction:J,getLicenseResponseFilters:ie,getLicenseRequestFilters:ue,getCustomCapabilitiesFilters:Z,registerCustomCapabilitiesFilter:Ee,registerLicenseResponseFilter:se,registerLicenseRequestFilter:Q,unregisterCustomCapabilitiesFilter:Se,unregisterLicenseResponseFilter:_e,unregisterLicenseRequestFilter:ve,addAbrCustomRule:xe,removeAllAbrCustomRule:Le,removeAbrCustomRule:Fe,getAbrCustomRules:De,addUTCTimingSource:Ae,removeUTCTimingSource:pe,getUTCTimingSources:ge,clearDefaultUTCTimingSources:Re,restoreDefaultUTCTimingSources:me,setXHRWithCredentialsForType:V,getXHRWithCredentialsForType:j,setConfig:W,reset:K},w(),b}C.__dashjs_factory_name="CustomParametersModel";const R=g.default.getSingletonFactory(C)},"./src/streaming/models/FragmentModel.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>R});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/vo/FragmentRequest.js"),v="loading",_="executed",S="canceled",E="failed";function T(b){b=b||{};var F=b.eventBus,O=b.events,L=b.dashMetrics,D=b.fragmentLoader,x=b.debug,B=b.streamInfo,M=b.type,I,U,w,k;function K(){U=x.getLogger(I),ge(),F.on(O.LOADING_COMPLETED,Le,I),F.on(O.LOADING_DATA_PROGRESS,De,I),F.on(O.LOADING_ABANDONED,Ae,I)}function W(){return B.id}function Y(){return M}function J(me){var V=function(X,z){return X.action===g.default.ACTION_COMPLETE&&X.action===z.action},j=function(X,z){return!isNaN(X.index)&&X.startTime===z.startTime&&X.adaptationIndex===z.adaptationIndex&&X.type===z.type},$=function(X,z){return isNaN(X.index)&&isNaN(z.index)&&X.quality===z.quality},re=function(X){var z=!1;return X.some(function(ne){if(j(me,ne)||$(me,ne)||V(me,ne))return z=!0,z}),z};return me?re(w):!1}function ee(me){var V=!1,j=0,$;if(V=J(me),!V)for(j=0;j<k.length;j++)$=k[j],me.url===$.url&&me.startTime===$.startTime&&(V=!0);return V}function ue(me){var V=me?me.state instanceof Array?me.state:[me.state]:[],j=[];return V.forEach(function($){var re=xe($);j=j.concat(de(re,me))}),j}function ie(me){return isNaN(me.duration)?.25:Math.min(me.duration/8,.5)}function Q(me){w=w.filter(function(V){var j=ie(V);return isNaN(V.startTime)||(me!==void 0?V.startTime>=me-j:!1)})}function se(me){w=w.filter(function(V){return isNaN(V.startTime)||(me!==void 0?V.startTime<me:!1)})}function ve(me,V){V<=me+.5||(w=w.filter(function(j){var $=ie(j);return isNaN(j.startTime)||j.startTime>=V-$||isNaN(j.duration)||j.startTime+j.duration<=me+$}))}function _e(me,V){if(!me||me.length===0){Q();return}for(var j=0,$=0,re=me.length;$<re;$++)ve(j,me.start($)),j=me.end($);V>0&&ve(j,V)}function Z(){U.debug("abort requests"),D.abort(),k=[]}function Ee(me){switch(me.action){case g.default.ACTION_DOWNLOAD:Fe(me,v),k.push(me),Se(me);break;default:U.warn("Unknown request action.")}}function Se(me){F.trigger(O.FRAGMENT_LOADING_STARTED,{request:me},{streamId:B.id,mediaType:M}),D.load(me)}function Me(me,V,j){for(var $=me.length-1,re=$;re>=0;re--){var oe=me[re],X=oe.startTime,z=X+oe.duration;if(j=isNaN(j)?ie(oe):j,!isNaN(X)&&!isNaN(z)&&V+j>=X&&V-j<z||isNaN(X)&&isNaN(V))return oe}return null}function de(me,V){return V.hasOwnProperty("time")?[Me(me,V.time,V.threshold)]:me.filter(function(j){for(var $ in V)if($!=="state"&&V.hasOwnProperty($)&&j[$]!=V[$])return!1;return!0})}function xe(me){var V;switch(me){case v:V=k;break;case _:V=w;break;default:V=[]}return V}function Fe(me,V){L.addSchedulingInfo(me,V),L.addRequestsQueue(me.mediaType,k,w)}function Le(me){me.sender===D&&(k.splice(k.indexOf(me.request),1),me.response&&!me.error&&w.push(me.request),Fe(me.request,me.error?E:_),F.trigger(O.FRAGMENT_LOADING_COMPLETED,{request:me.request,response:me.response,error:me.error,sender:this},{streamId:B.id,mediaType:M}))}function De(me){me.sender===D&&F.trigger(O.FRAGMENT_LOADING_PROGRESS,{request:me.request,response:me.response,error:me.error,sender:this},{streamId:B.id,mediaType:M})}function Ae(me){me.sender===D&&F.trigger(O.FRAGMENT_LOADING_ABANDONED,{request:me.request},{streamId:B.id,mediaType:M})}function ge(){w=[],k=[]}function pe(){F.off(O.LOADING_COMPLETED,Le,this),F.off(O.LOADING_DATA_PROGRESS,De,this),F.off(O.LOADING_ABANDONED,Ae,this),D&&D.reset(),ge()}function Re(me){w.push(me)}return I={getStreamId:W,getType:Y,getRequests:ue,isFragmentLoaded:J,isFragmentLoadedOrPending:ee,removeExecutedRequestsBeforeTime:Q,removeExecutedRequestsAfterTime:se,syncExecutedRequestsWithBufferedRange:_e,abortRequests:Z,executeRequest:Ee,reset:pe,resetInitialSettings:ge,addExecutedRequest:Re},K(),I}T.__dashjs_factory_name="FragmentModel";var C=m.default.getClassFactory(T);C.FRAGMENT_MODEL_LOADING=v,C.FRAGMENT_MODEL_EXECUTED=_,C.FRAGMENT_MODEL_CANCELED=S,C.FRAGMENT_MODEL_FAILED=E,m.default.updateClassFactory(T.__dashjs_factory_name,C);const R=C},"./src/streaming/models/LowLatencyThroughputModel.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});var m=d("./src/core/Debug.js"),g=d("./src/core/FactoryMaker.js");function v(){var S=10,E=.8,T=.6,C=1.05,R=250,b=this.context,F,O,L={};function D(){O=(0,m.default)(b).getInstance().getLogger(F)}function x(w){for(var k={},K=0,W=0,Y=0,J=0,ee=w.length,ue=0;ue<ee;++ue)K+=w[ue].chunkDownloadTimeRelativeMS,W+=w[ue].bufferLevel,Y+=w[ue].chunkDownloadTimeRelativeMS*w[ue].bufferLevel,J+=w[ue].chunkDownloadTimeRelativeMS*w[ue].chunkDownloadTimeRelativeMS;return k.m=(Y-K*W/ee)/(J-K*K/ee),k.b=W/ee-k.m*K/ee,function(ie){return k.m*ie+k.b}}function B(w){var k=!0,K,W=w.reduce(function(Y,J){return Y+J.bufferLevelAtSegmentEnd},0)/w.length;return w.forEach(function(Y){Math.abs(Y.bufferLevelAtSegmentEnd/Y.bufferLevelAtSegmentStart)<.95&&(k=!1),Y.bufferLevelAtSegmentEnd/W<.8&&(k=!1),K?K>Y.bitrate&&(k=!1):K=Y.bitrate}),k}function M(w){var k=L[w.mediaType].slice(-1).pop(),K=L[w.mediaType].slice(-3),W=k.chunkMeasurements.slice(-1).pop().chunkDownloadTimeRelativeMS;k.bufferLevelAtSegmentStart=k.getEstimatedBufferLevel(W/2),k.bufferLevelAtSegmentEnd=k.getEstimatedBufferLevel(W);var Y=B(K),J=Y?T:E;if(k.isBufferStable&&k.segDurationMS*C<k.fetchDownloadDurationMS)return k.fetchDownloadDurationMS;if(!Y||k.segDurationMS<k.fetchDownloadDurationMS||k.adjustedAvailabilityStartTimeMS<=k.requestTimeMS+k.throughputCapacityDelayMS-k.segDurationMS)return k.fetchDownloadDurationMS*E;for(var ee=k.requestTimeMS+k.throughputCapacityDelayMS-k.adjustedAvailabilityStartTimeMS,ue=0,ie=0,Q=0,se=0;se<k.chunkMeasurements.length;se++){var ve=k.chunkMeasurements[se];if(ee<ie+ve.chunkDownloadDurationMS)break;ie+=ve.chunkDownloadDurationMS,ue+=ve.chunkBytes,Q++}if(ee<0&&O.warn("request time was before adjusted availibitly start time"),ue&&ie&&Q>k.chunkMeasurements.length*.2){var _e=ue/ie,Z=k.segmentBytes/_e;return k.fetchDownloadDurationMS<Z?k.fetchDownloadDurationMS*J:Z*J}var Ee=k.bitrate;return k.bitrateList.some(function(Se){if(Se.bandwidth>k.bitrate)return Ee=Se.bandwidth,!0}),Ee===k.bitrate?k.fetchDownloadDurationMS*J:J*k.segmentBytes*8*1e3/Ee}function I(w,k){var K=L[w.mediaType]&&L[w.mediaType].slice(-3);return!K||K.length<3||!B(K)?0:k/4>R?R:k/4}function U(w,k,K,W,Y){w&&w.mediaType&&!L[w.mediaType]&&(L[w.mediaType]=[]);var J=w.mediaInfo.bitrateList.find(function(ee){return ee.id===w.representationId});L[w.mediaType].push({index:w.index,repId:w.representationId,mediaType:w.mediaType,requestTimeMS:W,adjustedAvailabilityStartTimeMS:w.availabilityStartTime.getTime(),segDurationMS:w.duration*1e3,chunksDurationMS:K.reduce(function(ee,ue){return ee+ue.chunkDownloadDurationMS},0),segmentBytes:K.reduce(function(ee,ue){return ee+ue.chunkBytes},0),bitrate:J&&J.bandwidth,bitrateList:w.mediaInfo.bitrateList,chunkMeasurements:K,fetchDownloadDurationMS:k,throughputCapacityDelayMS:Y,getEstimatedBufferLevel:x(K.slice(1))}),L[w.mediaType].length>S&&L[w.mediaType].shift()}return F={setup:D,addMeasurement:U,getThroughputCapacityDelayMS:I,getEstimatedDownloadDurationMS:M},D(),F}v.__dashjs_factory_name="LowLatencyThroughputModel";const _=g.default.getSingletonFactory(v)},"./src/streaming/models/ManifestModel.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/core/EventBus.js"),g=d("./src/core/events/Events.js"),v=d("./src/core/FactoryMaker.js");function _(){var E=this.context,T=(0,m.default)(E).getInstance(),C,R;function b(){return R}function F(O){R=O,O&&T.trigger(g.default.MANIFEST_LOADED,{data:O})}return C={getValue:b,setValue:F},C}_.__dashjs_factory_name="ManifestModel";const S=v.default.getSingletonFactory(_)},"./src/streaming/models/MediaPlayerModel.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>D});var m=d("./src/core/Debug.js"),g=d("./src/core/FactoryMaker.js"),v=d("./src/core/Settings.js"),_=12,S=20,E=10,T=5,C=12,R=-.5,b=.5,F=-.5,O=1;function L(){var x,B,M,I,U=this.context,w=(0,v.default)(U).getInstance();function k(){B=(0,m.default)(U).getInstance().getLogger(x)}function K(Ee){Ee.playbackController&&(M=Ee.playbackController),Ee.serviceDescriptionController&&(I=Ee.serviceDescriptionController)}function W(Ee,Se){return isNaN(Ee)?0:Ee>0?(Se&&B.warn("Supplied minimum playback rate is a positive value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):Ee<F?(Se&&B.warn("Supplied minimum playback rate is out of range and will be limited to ".concat(F,": ").concat(F*100,"% playback speed.")),F):Ee}function Y(Ee,Se){return isNaN(Ee)?0:Ee<0?(Se&&B.warn("Supplied maximum playback rate is a negative value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):Ee>O?(Se&&B.warn("Supplied maximum playback rate is out of range and will be limited to ".concat(O,": ").concat((1+O)*100,"% playback speed.")),O):Ee}function J(){if(!isNaN(w.get().streaming.liveCatchup.maxDrift)&&w.get().streaming.liveCatchup.maxDrift>0)return w.get().streaming.liveCatchup.maxDrift;var Ee=I.getServiceDescriptionSettings();return Ee&&Ee.liveCatchup&&!isNaN(Ee.liveCatchup.maxDrift)&&Ee.liveCatchup.maxDrift>0?Ee.liveCatchup.maxDrift:C}function ee(Ee){var Se=w.get().streaming.liveCatchup.playbackRate;if(!isNaN(Se.min)||!isNaN(Se.max))return{min:W(Se.min,Ee),max:Y(Se.max,Ee)};var Me=I.getServiceDescriptionSettings();if(Me&&Me.liveCatchup&&(!isNaN(Me.liveCatchup.playbackRate.min)||!isNaN(Me.liveCatchup.playbackRate.max))){var de=Me.liveCatchup.playbackRate;return{min:W(de.min,Ee),max:Y(de.max,Ee)}}return{min:R,max:b}}function ue(){return w.get().streaming.liveCatchup.enabled!==null?w.get().streaming.liveCatchup.enabled:M.getInitialCatchupModeActivated()}function ie(Ee,Se){try{var Me=w.get().streaming.abr[Ee][Se];if(!isNaN(Me)&&Me!==-1)return Me;var de=I.getServiceDescriptionSettings();return de&&de[Ee]&&!isNaN(de[Ee][Se])?de[Ee][Se]:-1}catch{return-1}}function Q(){var Ee=w.get().streaming.buffer.initialBufferLevel;return isNaN(Ee)||Ee<0?0:Math.min(se(),Ee)}function se(){var Ee=w.get().streaming.buffer.stableBufferTime>0?w.get().streaming.buffer.stableBufferTime:w.get().streaming.buffer.fastSwitchEnabled?S:_,Se=M.getLiveDelay();return!isNaN(Se)&&Se>0?Math.min(Ee,Se):Ee}function ve(Ee){var Se=isNaN(w.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?T:w.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return M.getLowLatencyModeEnabled()?w.get().streaming.retryAttempts[Ee]*Se:w.get().streaming.retryAttempts[Ee]}function _e(Ee){var Se=isNaN(w.get().streaming.retryIntervals.lowLatencyReductionFactor)?E:w.get().streaming.retryIntervals.lowLatencyReductionFactor;return M.getLowLatencyModeEnabled()?w.get().streaming.retryIntervals[Ee]/Se:w.get().streaming.retryIntervals[Ee]}function Z(){}return x={getCatchupMaxDrift:J,getCatchupModeEnabled:ue,getStableBufferTime:se,getInitialBufferLevel:Q,getRetryAttemptsForType:ve,getRetryIntervalsForType:_e,getCatchupPlaybackRates:ee,getAbrBitrateParameter:ie,setConfig:K,reset:Z},k(),x}L.__dashjs_factory_name="MediaPlayerModel";const D=g.default.getSingletonFactory(L)},"./src/streaming/models/MetricsModel.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>M});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/streaming/constants/MetricsConstants.js"),v=d("./src/streaming/vo/MetricsList.js"),_=d("./src/streaming/vo/metrics/HTTPRequest.js"),S=d("./src/streaming/vo/metrics/RepresentationSwitch.js"),E=d("./src/streaming/vo/metrics/BufferLevel.js"),T=d("./src/streaming/vo/metrics/BufferState.js"),C=d("./src/streaming/vo/metrics/DVRInfo.js"),R=d("./src/streaming/vo/metrics/DroppedFrames.js"),b=d("./src/streaming/vo/metrics/ManifestUpdate.js"),F=d("./src/streaming/vo/metrics/SchedulingInfo.js"),O=d("./src/core/EventBus.js"),L=d("./src/streaming/vo/metrics/RequestsQueue.js"),D=d("./src/core/events/Events.js"),x=d("./src/core/FactoryMaker.js");function B(I){I=I||{};var U=I.settings,w=this.context,k=(0,O.default)(w).getInstance(),K,W;function Y(){W={}}function J(){k.trigger(D.default.METRICS_CHANGED)}function ee($){k.trigger(D.default.METRIC_CHANGED,{mediaType:$}),J()}function ue($,re,oe){k.trigger(D.default.METRIC_UPDATED,{mediaType:$,metric:re,value:oe}),ee($)}function ie($,re,oe){k.trigger(D.default.METRIC_ADDED,{mediaType:$,metric:re,value:oe}),ee($)}function Q($){delete W[$],ee($)}function se(){W={},J()}function ve($,re){var oe=null;return $&&(W.hasOwnProperty($)?oe=W[$]:re||(oe=new v.default,W[$]=oe)),oe}function _e($,re,oe){var X=ve($);X!==null&&(X[re].push(oe),X[re].length>U.get().streaming.metrics.maxListDepth&&X[re].shift())}function Z($,re,oe,X){var z=new _.HTTPRequestTrace;return z.s=re,z.d=oe,z.b=X,$.trace.push(z),$.interval||($.interval=0),$.interval+=oe,z}function Ee($,re,oe,X,z,ne,fe,Ce,Pe,he,Ue,we,$e,it,mt,pt,Pt){var lt=new _.HTTPRequest;ne&&ne!==X&&(Ee($,null,oe,X,z,null,null,Ce,Pe,null,null,null,$e,null,null,pt,Pt),lt.actualurl=ne),lt.tcpid=re,lt.type=oe,lt.url=X,lt.range=Ce,lt.trequest=Pe,lt.tresponse=he,lt.responsecode=we,lt.cmsd=Pt,lt._tfinish=Ue,lt._stream=$,lt._mediaduration=$e,lt._quality=z,lt._responseHeaders=it,lt._serviceLocation=fe,lt._fileLoaderType=pt,mt?mt.forEach(function(Ye){Z(lt,Ye.s,Ye.d,Ye.b)}):(delete lt.interval,delete lt.trace),Me($,g.default.HTTP_REQUEST,lt)}function Se($,re,oe,X,z){var ne=new S.default;ne.t=re,ne.mt=oe,ne.to=X,z?ne.lto=z:delete ne.lto,Me($,g.default.TRACK_SWITCH,ne)}function Me($,re,oe){_e($,re,oe),ie($,re,oe)}function de($,re,oe){var X=new E.default;X.t=re,X.level=oe,Me($,g.default.BUFFER_LEVEL,X)}function xe($,re,oe){var X=new T.default;X.target=oe,X.state=re,Me($,g.default.BUFFER_STATE,X)}function Fe($,re,oe,X){var z=new C.default;z.time=re,z.range=X,z.manifestInfo=oe,Me($,g.default.DVR_INFO,z)}function Le($,re){var oe=new R.default,X=ve($).DroppedFrames;re&&(oe.time=re.creationTime,oe.droppedFrames=re.droppedVideoFrames,!(X.length>0&&X[X.length-1]==oe)&&Me($,g.default.DROPPED_FRAMES,oe))}function De($,re,oe,X,z,ne,fe,Ce,Pe){var he=new F.default;he.mediaType=$,he.t=re,he.type=oe,he.startTime=X,he.availabilityStartTime=z,he.duration=ne,he.quality=fe,he.range=Ce,he.state=Pe,Me($,g.default.SCHEDULING_INFO,he)}function Ae($,re,oe){var X=new L.default;X.loadingRequests=re,X.executedRequests=oe,ve($).RequestsQueue=X,ie($,g.default.REQUESTS_QUEUE,X)}function ge($,re,oe,X,z,ne,fe,Ce,Pe,he){var Ue=new b.ManifestUpdate;Ue.mediaType=$,Ue.type=re,Ue.requestTime=oe,Ue.fetchTime=X,Ue.availabilityStartTime=z,Ue.presentationStartTime=ne,Ue.clientTimeOffset=fe,Ue.currentTime=Ce,Ue.buffered=Pe,Ue.latency=he,_e(m.default.STREAM,g.default.MANIFEST_UPDATE,Ue),ie($,g.default.MANIFEST_UPDATE,Ue)}function pe($,re){if($){for(var oe in re)$[oe]=re[oe];ue($.mediaType,g.default.MANIFEST_UPDATE,$)}}function Re($,re,oe,X,z){if($){var ne=new b.ManifestUpdateStreamInfo;ne.id=re,ne.index=oe,ne.start=X,ne.duration=z,$.streamInfo.push(ne),ue($.mediaType,g.default.MANIFEST_UPDATE_STREAM_INFO,$)}}function me($,re,oe,X,z,ne,fe,Ce){if($&&$.representationInfo){var Pe=new b.ManifestUpdateRepresentationInfo;Pe.id=re,Pe.index=oe,Pe.streamIndex=X,Pe.mediaType=z,Pe.startNumber=fe,Pe.fragmentInfoType=Ce,Pe.presentationTimeOffset=ne,$.representationInfo.push(Pe),ue($.mediaType,g.default.MANIFEST_UPDATE_TRACK_INFO,$)}}function V($){$.trace&&Array.isArray($.trace)?$.trace.forEach(function(re){re.hasOwnProperty("subreplevel")&&!re.subreplevel&&delete re.subreplevel}):delete $.trace,Me(m.default.STREAM,g.default.PLAY_LIST,$)}function j($){Me(m.default.STREAM,g.default.DVB_ERRORS,$)}return K={clearCurrentMetricsForType:Q,clearAllCurrentMetrics:se,getMetricsFor:ve,addHttpRequest:Ee,addRepresentationSwitch:Se,addBufferLevel:de,addBufferState:xe,addDVRInfo:Fe,addDroppedFrames:Le,addSchedulingInfo:De,addRequestsQueue:Ae,addManifestUpdate:ge,updateManifestUpdateInfo:pe,addManifestUpdateStreamInfo:Re,addManifestUpdateRepresentationInfo:me,addPlayList:V,addDVBErrors:j},Y(),K}B.__dashjs_factory_name="MetricsModel";const M=x.default.getSingletonFactory(B)},"./src/streaming/models/URIFragmentModel.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});var m=d("./src/streaming/vo/URIFragmentData.js"),g=d("./src/core/FactoryMaker.js");function v(){var S,E;function T(R){if(E=new m.default,!R)return null;var b=R.indexOf("#");if(b!==-1)for(var F=R.substr(b+1).split("&"),O=0,L=F.length;O<L;++O){var D=F[O],x=D.indexOf("=");if(x!==-1){var B=D.substring(0,x);E.hasOwnProperty(B)&&(E[B]=D.substr(x+1))}}}function C(){return E}return S={initialize:T,getURIFragmentData:C},S}v.__dashjs_factory_name="URIFragmentModel";const _=g.default.getSingletonFactory(v)},"./src/streaming/models/VideoModel.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>C});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/EventBus.js"),v=d("./src/core/events/Events.js"),_=d("./src/core/Debug.js"),S=d("./src/streaming/constants/Constants.js"),E=new Map([[S.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,"loadedmetadata"],[S.default.VIDEO_ELEMENT_READY_STATES.HAVE_CURRENT_DATA,"loadeddata"],[S.default.VIDEO_ELEMENT_READY_STATES.HAVE_FUTURE_DATA,"canplay"],[S.default.VIDEO_ELEMENT_READY_STATES.HAVE_ENOUGH_DATA,"canplaythrough"]]);function T(){var R,b,F,O,L,D,x="element is not video or audio DOM type!",B=this.context,M=(0,g.default)(B).getInstance(),I=[];function U(){b=(0,_.default)(B).getInstance().getLogger(R),O=NaN}function w(){M.on(v.default.PLAYBACK_PLAYING,Fe,this)}function k(){M.off(v.default.PLAYBACK_PLAYING,Fe,this)}function K(){F&&(F.playbackRate=1,F.removeEventListener("canplay",K))}function W(lt){var Ye=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;F&&(!Ye&&F.readyState<=2&&lt>0?F.addEventListener("canplay",K):F.playbackRate=lt)}function Y(lt,Ye){F&&(O=lt,pt(S.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,function(){if(F.currentTime===O){O=NaN;return}try{O=Ye?J(O):O,F.currentTime=O,O=NaN}catch(st){F.readyState===0&&st.code===st.INVALID_STATE_ERR&&setTimeout(function(){F.currentTime=O,O=NaN},400)}}))}function J(lt){var Ye=X(),st=lt,Nt=9999999999;if(Ye)for(var Wt=0;Wt<Ye.length;Wt++){var Ht=Ye.start(Wt),nt=Ye.end(Wt),Et=Math.abs(Ht-lt),St=Math.abs(nt-lt);if(lt>=Ht&&lt<=nt)return lt;Et<Nt&&(Nt=Et,st=Ht),St<Nt&&(Nt=St,st=nt)}return st}function ee(){return F}function ue(lt){if(lt==null||lt&&/^(VIDEO|AUDIO)$/i.test(lt.nodeName))F=lt,F&&(F.preload="auto");else throw x}function ie(lt){F&&(lt?F.src=lt:(F.removeAttribute("src"),F.load()))}function Q(){return F?F.src:null}function se(){return L}function ve(){return D}function _e(lt){L=lt,L.style.position="absolute",L.style.display="flex",L.style.overflow="hidden",L.style.pointerEvents="none",L.style.top=0,L.style.left=0}function Z(lt){D=lt}function Ee(lt,Ye){xe(lt,Ye)}function Se(){return I.length>0}function Me(lt){lt===null||!F||F.seeking||I.indexOf(lt)!==-1||I.push(lt)}function de(lt){var Ye=I.indexOf(lt);lt!==null&&Ye!==-1&&I.splice(Ye,1)}function xe(lt,Ye){Ye?Me(lt):de(lt)}function Fe(){if(F&&Se()&&F.playbackRate===0){var lt=document.createEvent("Event");lt.initEvent("waiting",!0,!1),F.dispatchEvent(lt)}}function Le(){if(!F)return null;var lt="webkitDroppedFrameCount"in F&&"webkitDecodedFrameCount"in F,Ye="getVideoPlaybackQuality"in F,st=null;return Ye?st=F.getVideoPlaybackQuality():lt&&(st={droppedVideoFrames:F.webkitDroppedFrameCount,totalVideoFrames:F.webkitDroppedFrameCount+F.webkitDecodedFrameCount,creationTime:new Date}),st}function De(){if(F){F.autoplay=!0;var lt=F.play();lt&&lt.catch&&typeof Promise<"u"&&lt.catch(function(Ye){Ye.name==="NotAllowedError"&&M.trigger(v.default.PLAYBACK_NOT_ALLOWED),b.warn("Caught pending play exception - continuing (".concat(Ye,")"))})}}function Ae(){return F?F.paused:null}function ge(){F&&(F.pause(),F.autoplay=!1)}function pe(){return F?F.seeking||!isNaN(O):null}function Re(){return F?isNaN(O)?F.currentTime:O:null}function me(){return F?F.playbackRate:null}function V(){return F?F.played:null}function j(){return F?F.ended:null}function $(lt,Ye){F&&F.addEventListener(lt,Ye)}function re(lt,Ye){F&&F.removeEventListener(lt,Ye)}function oe(){return F?F.readyState:NaN}function X(){return F?F.buffered:null}function z(){return F?F.clientWidth:NaN}function ne(){return F?F.clientHeight:NaN}function fe(){return F?F.videoWidth:NaN}function Ce(){return F?F.videoHeight:NaN}function Pe(){var lt=F.parentNode.host||F.parentNode;return lt?F.getBoundingClientRect().top-lt.getBoundingClientRect().top:NaN}function he(){var lt=F.parentNode.host||F.parentNode;return lt?F.getBoundingClientRect().left-lt.getBoundingClientRect().left:NaN}function Ue(){return F?F.textTracks:[]}function we(lt,Ye,st,Nt,Wt){if(F){for(var Ht=0;Ht<F.textTracks.length;Ht++)if(F.textTracks[Ht].kind===lt&&(!Ye||F.textTracks[Ht].label==Ye)&&F.textTracks[Ht].language===st&&F.textTracks[Ht].isTTML===Nt&&F.textTracks[Ht].isEmbedded===Wt)return F.textTracks[Ht]}return null}function $e(lt,Ye,st,Nt,Wt){if(!F)return null;var Ht=we(lt,Ye,st,Nt,Wt);return Ht||(Ht=F.addTextTrack(lt,Ye,st),Ht.isEmbedded=Wt,Ht.isTTML=Nt),Ht}function it(lt){F&&(F.appendChild(lt),lt.isTTML!==void 0&&(F.textTracks[F.textTracks.length-1].isTTML=lt.isTTML,F.textTracks[F.textTracks.length-1].isEmbedded=lt.isEmbedded))}function mt(lt){F&&F.removeChild(lt)}function pt(lt,Ye){if(lt===S.default.VIDEO_ELEMENT_READY_STATES.HAVE_NOTHING||oe()>=lt)Ye();else{var st=E.get(lt);Pt(st,Ye)}}function Pt(lt,Ye){var st=function Nt(){re(lt,Nt),Ye(lt)};$(lt,st)}return R={initialize:w,setCurrentTime:Y,play:De,isPaused:Ae,pause:ge,isStalled:Se,isSeeking:pe,getTime:Re,getPlaybackRate:me,setPlaybackRate:W,getPlayedRanges:V,getEnded:j,setStallState:Ee,getElement:ee,setElement:ue,setSource:ie,getSource:Q,getTTMLRenderingDiv:se,setTTMLRenderingDiv:_e,getVttRenderingDiv:ve,setVttRenderingDiv:Z,getPlaybackQuality:Le,addEventListener:$,removeEventListener:re,getReadyState:oe,getBufferRange:X,getClientWidth:z,getClientHeight:ne,getTextTracks:Ue,getTextTrack:we,addTextTrack:$e,appendChild:it,removeChild:mt,getVideoWidth:fe,getVideoHeight:Ce,getVideoRelativeOffsetTop:Pe,getVideoRelativeOffsetLeft:he,waitForReadyState:pt,reset:k},U(),R}T.__dashjs_factory_name="VideoModel";const C=m.default.getSingletonFactory(T)},"./src/streaming/net/FetchLoader.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>D});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/Settings.js"),v=d("./src/streaming/constants/Constants.js"),_=d("./src/streaming/utils/RequestModifier.js");function S(x,B){return C(x)||T(x,B)||b(x,B)||E()}function E(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T(x,B){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(x)))){var M=[],I=!0,U=!1,w=void 0;try{for(var k=x[Symbol.iterator](),K;!(I=(K=k.next()).done)&&(M.push(K.value),!(B&&M.length===B));I=!0);}catch(W){U=!0,w=W}finally{try{!I&&k.return!=null&&k.return()}finally{if(U)throw w}}return M}}function C(x){if(Array.isArray(x))return x}function R(x,B){var M;if(typeof Symbol>"u"||x[Symbol.iterator]==null){if(Array.isArray(x)||(M=b(x))||B&&x&&typeof x.length=="number"){M&&(x=M);var I=0,U=function(){};return{s:U,n:function(){return I>=x.length?{done:!0}:{done:!1,value:x[I++]}},e:function(Y){throw Y},f:U}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var w=!0,k=!1,K;return{s:function(){M=x[Symbol.iterator]()},n:function(){var Y=M.next();return w=Y.done,Y},e:function(Y){k=!0,K=Y},f:function(){try{!w&&M.return!=null&&M.return()}finally{if(k)throw K}}}}function b(x,B){if(x){if(typeof x=="string")return F(x,B);var M=Object.prototype.toString.call(x).slice(8,-1);if(M==="Object"&&x.constructor&&(M=x.constructor.name),M==="Map"||M==="Set")return Array.from(x);if(M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M))return F(x,B)}}function F(x,B){(B==null||B>x.length)&&(B=x.length);for(var M=0,I=new Array(B);M<B;M++)I[M]=x[M];return I}function O(x){x=x||{};var B=this.context,M=x.requestModifier,I=x.lowLatencyThroughputModel,U=x.boxParser,w=(0,g.default)(B).getInstance(),k,K;function W(ve){K=ve.dashMetrics}function Y(ve){M&&M.modifyRequest?(0,_.modifyRequest)(ve,M).then(function(){return J(ve)}):J(ve)}function J(ve){var _e=new Date,Z=ve.request,Ee=new Headers;if(Z.range&&Ee.append("Range","bytes="+Z.range),ve.headers)for(var Se in ve.headers){var Me=ve.headers[Se];Me&&Ee.append(Se,Me)}Z.requestStartDate||(Z.requestStartDate=_e),M&&M.modifyRequestHeader&&M.modifyRequestHeader({setRequestHeader:function(ge,pe){Ee.append(ge,pe)}},{url:ve.url});var de;typeof window.AbortController=="function"&&(de=new AbortController,ve.abortController=de,de.signal.onabort=ve.onabort);var xe={method:ve.method,headers:Ee,credentials:ve.withCredentials?"include":void 0,signal:de?de.signal:void 0},Fe=w.get().streaming.abr.fetchThroughputCalculationMode,Le=Date.now(),De=0;new Promise(function(Ae){if(Fe===v.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&I&&(De=I.getThroughputCapacityDelayMS(Z,K.getCurrentBufferLevel(Z.mediaType)*1e3),De))return setTimeout(Ae,De);Ae()}).then(function(){var Ae=Date.now();fetch(ve.url,xe).then(function(ge){ve.response||(ve.response={}),ve.response.status=ge.status,ve.response.statusText=ge.statusText,ve.response.responseURL=ge.url,ge.ok||ve.onerror();var pe="",Re=R(ge.headers.keys()),me;try{for(Re.s();!(me=Re.n()).done;){var V=me.value;pe+=V+": "+ge.headers.get(V)+`\r
`}}catch(Pt){Re.e(Pt)}finally{Re.f()}if(ve.response.responseHeaders=pe,!ge.body)return ge.arrayBuffer().then(function(Pt){ve.response.response=Pt;var lt={loaded:Pt.byteLength,total:Pt.byteLength,stream:!1};ve.progress(lt),ve.onload(),ve.onend()});var j=parseInt(ge.headers.get("Content-Length"),10),$=0,re=!1,oe=new Uint8Array,X=0;if(Fe===v.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&I){var z=function(lt){var Ye=lt.getReader(),st=[];Ye.read().then(function Nt(Wt){var Ht=Wt.value,nt=Wt.done;if(fe=Date.now(),Ht&&Ht.length){var Et=fe-ne,St=Ht.length;st.push({chunkDownloadTimeRelativeMS:fe-Ae,chunkDownloadDurationMS:Et,chunkBytes:St,kbps:Math.round(8*St/(Et/1e3)),bufferLevel:K.getCurrentBufferLevel(Z.mediaType)})}if(nt){var Ut=fe-Ae,Vt=st.reduce(function(Zt,We){return Zt+We.chunkBytes},0);I.addMeasurement(Z,Ut,st,Le,De,pe),ve.progress({loaded:Vt,total:Vt,lengthComputable:!0,time:I.getEstimatedDownloadDurationMS(Z),stream:!0});return}return ne=Date.now(),Ye.read().then(Nt)})},ne=Ae,fe=0,Ce=ge.body.tee(),Pe=S(Ce,2),he=Pe[0],Ue=Pe[1];z(he),ve.reader=Ue.getReader()}else ve.reader=ge.body.getReader();var we=[],$e=[],it=[],mt=!0,pt=function Pt(lt){var Ye=lt.value,st=lt.done;if(st){if(oe){if(Fe!==v.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST){var Nt=null,Wt=null;Fe===v.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING?(Nt=se($e,it),Nt&&(Wt=$*8/Nt)):Fe===v.default.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA&&(Wt=Q(we,$)),ve.progress({loaded:$,total:isNaN(j)?$:j,lengthComputable:!0,time:Wt,stream:!0})}ve.response.response=oe.buffer}ve.onload(),ve.onend();return}if(Ye&&Ye.length>0){if(oe=ue(oe,Ye),$+=Ye.length,we.push({ts:Date.now(),bytes:Ye.length}),Fe===v.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&mt){var Ht=U.findLastTopIsoBoxCompleted(["moof"],oe,X);Ht.found&&(mt=!1,$e.push({ts:performance.now(),bytes:Ye.length}))}var nt=U.findLastTopIsoBoxCompleted(["moov","mdat"],oe,X);if(nt.found){var Et=nt.lastCompletedOffset+nt.size;Fe===v.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&!mt&&(mt=!0,it.push({ts:performance.now(),bytes:oe.length}));var St;Et===oe.length?(St=oe,oe=new Uint8Array):(St=new Uint8Array(oe.subarray(0,Et)),oe=oe.subarray(Et)),ve.progress({data:St.buffer,lengthComputable:!1,noTrace:!0}),X=0}else X=nt.lastCompletedOffset,re||(ve.progress({lengthComputable:!1,noTrace:!0}),re=!0)}ee(ve,Pt)};ee(ve,pt)}).catch(function(ge){ve.onerror&&ve.onerror(ge)})})}function ee(ve,_e){ve.reader.read().then(_e).catch(function(Z){ve.onerror&&ve.response.status===200&&ve.onerror(Z)})}function ue(ve,_e){if(ve.length===0)return _e;var Z=new Uint8Array(ve.length+_e.length);return Z.set(ve),Z.set(_e,ve.length),Z}function ie(ve){if(ve.abortController)ve.abortController.abort();else if(ve.reader)try{ve.reader.cancel(),ve.onabort()}catch{}}function Q(ve,_e){try{if(ve=ve.filter(function(Se){return Se.bytes>_e/4/ve.length}),ve.length>1){var Z=0,Ee=(ve[ve.length-1].ts-ve[0].ts)/ve.length;return ve.forEach(function(Se,Me){var de=ve[Me+1];if(de){var xe=de.ts-Se.ts;Z+=xe<Ee?xe:0}}),Z}return null}catch{return null}}function se(ve,_e){try{var Z,Ee;Z=ve.filter(function(Ae,ge){return ge<ve.length-1}),Ee=_e.filter(function(Ae,ge){return ge<_e.length-1});var Se=[];if(Z.length>1){for(var Me=0,de=0,xe=0;xe<Z.length;xe++)if(Z[xe]&&Ee[xe]){var Fe=Ee[xe].ts-Z[xe].ts;if(Fe>1)Se.push(8*Ee[xe].bytes/Fe);else{de===0&&(de=Z[xe].ts);var Le=Ee[xe].ts-de;Le>1?(Se.push(8*Me/Le),Me=0,de=0):Me+=Ee[xe].bytes}}if(Se.length>0){var De=Se.reduce(function(Ae,ge){return Ae+ge},0);return De/Se.length}}return null}catch{return null}}return k={load:Y,abort:ie,calculateDownloadedTime:Q,setup:W},k}O.__dashjs_factory_name="FetchLoader";var L=m.default.getClassFactory(O);const D=L},"./src/streaming/net/HTTPLoader.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>U});var m=d("./src/streaming/net/XHRLoader.js"),g=d("./src/streaming/net/FetchLoader.js"),v=d("./src/streaming/vo/metrics/HTTPRequest.js"),_=d("./src/core/FactoryMaker.js"),S=d("./src/streaming/vo/DashJSError.js"),E=d("./src/streaming/models/CmcdModel.js"),T=d("./src/streaming/models/CmsdModel.js"),C=d("./src/core/Utils.js"),R=d("./src/core/Debug.js"),b=d("./src/core/EventBus.js"),F=d("./src/core/events/Events.js"),O=d("./src/core/Settings.js"),L=d("./src/streaming/constants/Constants.js"),D=d("./src/streaming/models/LowLatencyThroughputModel.js"),x=d("./src/streaming/models/CustomParametersModel.js");function B(w,k,K){return k in w?Object.defineProperty(w,k,{value:K,enumerable:!0,configurable:!0,writable:!0}):w[k]=K,w}function M(w){w=w||{};var k=this.context,K=w.errHandler,W=w.dashMetrics,Y=w.mediaPlayerModel,J=w.requestModifier,ee=w.boxParser,ue=w.errors,ie=w.requestTimeout||0,Q=(0,b.default)(k).getInstance(),se=(0,O.default)(k).getInstance(),ve,_e,Z,Ee,Se,Me,de,xe,Fe,Le;function De(){var me;Le=(0,R.default)(k).getInstance().getLogger(ve),_e=[],Z=[],Ee=[],Me=(0,E.default)(k).getInstance(),de=(0,T.default)(k).getInstance(),Fe=(0,D.default)(k).getInstance(),xe=(0,x.default)(k).getInstance(),Se=(me={},B(me,v.HTTPRequest.MPD_TYPE,ue.DOWNLOAD_ERROR_ID_MANIFEST_CODE),B(me,v.HTTPRequest.XLINK_EXPANSION_TYPE,ue.DOWNLOAD_ERROR_ID_XLINK_CODE),B(me,v.HTTPRequest.INIT_SEGMENT_TYPE,ue.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),B(me,v.HTTPRequest.MEDIA_SEGMENT_TYPE,ue.DOWNLOAD_ERROR_ID_CONTENT_CODE),B(me,v.HTTPRequest.INDEX_SEGMENT_TYPE,ue.DOWNLOAD_ERROR_ID_CONTENT_CODE),B(me,v.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,ue.DOWNLOAD_ERROR_ID_CONTENT_CODE),B(me,v.HTTPRequest.OTHER_TYPE,ue.DOWNLOAD_ERROR_ID_CONTENT_CODE),me)}function Ae(me,V){var j=me.request,$=[],re=!0,oe=!0,X=new Date,z=X,ne=0,fe=null,Ce;if(!J||!W||!K)throw new Error("config object is not correct or missing");var Pe=function(Et){if(oe=!1,j.requestStartDate=X,j.requestEndDate=new Date,j.firstByteDate=j.firstByteDate||X,j.fileLoaderType=fe,!j.checkExistenceOnly){var St=Ce.response?Ce.response.responseURL:null,Ut=Ce.response?Ce.response.status:null,Vt=Ce.response&&Ce.response.getAllResponseHeaders?Ce.response.getAllResponseHeaders():Ce.response?Ce.response.responseHeaders:null,Zt=se.get().streaming.cmsd&&se.get().streaming.cmsd.enabled?de.parseResponseHeaders(Vt,j.mediaType):null;W.addHttpRequest(j,St,Ut,Vt,Et?$:null,Zt),j.type===v.HTTPRequest.MPD_TYPE&&W.addManifestUpdate(j)}},he=function(){if(_e.indexOf(Ce)!==-1&&(_e.splice(_e.indexOf(Ce),1),oe))if(Pe(!1),V>0){try{if(se.get().streaming.utcSynchronization.enableBackgroundSyncAfterSegmentDownloadError&&j.type===v.HTTPRequest.MEDIA_SEGMENT_TYPE){var Et=Y.getRetryAttemptsForType(v.HTTPRequest.MEDIA_SEGMENT_TYPE);Et===V&&Q.trigger(F.default.ATTEMPT_BACKGROUND_SYNC)}}catch{}V--;var St={config:me};Ee.push(St),St.timeout=setTimeout(function(){Ee.indexOf(St)!==-1&&(Ee.splice(Ee.indexOf(St),1),Ae(me,V))},Y.getRetryIntervalsForType(j.type))}else{if(j.type===v.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE)return;K.error(new S.default(Se[j.type],j.url+" is not available",{request:j,response:Ce.response})),me.error&&me.error(j,"error",Ce.response.statusText),me.complete&&me.complete(j,Ce.response.statusText)}},Ue=function(Et){var St=new Date;re&&(re=!1,(!Et.lengthComputable||Et.lengthComputable&&Et.total!==Et.loaded)&&(j.firstByteDate=St)),Et.lengthComputable&&(j.bytesLoaded=Et.loaded,j.bytesTotal=Et.total),Et.noTrace||($.push({s:z,d:Et.time?Et.time:St.getTime()-z.getTime(),b:[Et.loaded?Et.loaded-ne:0]}),z=St,ne=Et.loaded),me.progress&&Et&&me.progress(Et)},we=function(){Ce.response.status>=200&&Ce.response.status<=299&&(Pe(!0),me.success&&me.success(Ce.response.response,Ce.response.statusText,Ce.response.responseURL),me.complete&&me.complete(j,Ce.response.statusText))},$e=function(){me.abort&&me.abort(j)},it=function(Et){var St;if(Et.lengthComputable){var Ut=Et.loaded/Et.total*100;St="Request timeout: loaded: "+Et.loaded+", out of: "+Et.total+" : "+Ut.toFixed(3)+"% Completed"}else St="Request timeout: non-computable download size";Le.warn(St)},mt;j.hasOwnProperty("availabilityTimeComplete")&&j.availabilityTimeComplete===!1&&window.fetch&&j.responseType==="arraybuffer"&&j.type===v.HTTPRequest.MEDIA_SEGMENT_TYPE?(mt=(0,g.default)(k).create({requestModifier:J,lowLatencyThroughputModel:Fe,boxParser:ee}),mt.setup({dashMetrics:W}),fe=L.default.FILE_LOADER_TYPES.FETCH):(mt=(0,m.default)(k).create({requestModifier:J}),fe=L.default.FILE_LOADER_TYPES.XHR);var pt=null,Pt=J.modifyRequestURL?J.modifyRequestURL(j.url):j.url;if(se.get().streaming.cmcd&&se.get().streaming.cmcd.enabled){var lt=se.get().streaming.cmcd.mode;if(lt===L.default.CMCD_MODE_QUERY){var Ye=ge(j);Pt=C.default.addAditionalQueryParameterToUrl(Pt,Ye)}else lt===L.default.CMCD_MODE_HEADER&&(pt=Me.getHeaderParameters(j))}j.url=Pt;var st=j.checkExistenceOnly?v.HTTPRequest.HEAD:v.HTTPRequest.GET,Nt=xe.getXHRWithCredentialsForType(j.type);Ce={url:Pt,method:st,withCredentials:Nt,request:j,onload:we,onend:he,onerror:he,progress:Ue,onabort:$e,ontimeout:it,loader:mt,timeout:ie,headers:pt};var Wt=new Date().getTime();if(isNaN(j.delayLoadingTime)||Wt>=j.delayLoadingTime)_e.push(Ce),mt.load(Ce);else{var Ht={httpRequest:Ce};Z.push(Ht),Ht.delayTimeout=setTimeout(function(){if(Z.indexOf(Ht)!==-1){Z.splice(Z.indexOf(Ht),1);try{X=new Date,z=X,_e.push(Ht.httpRequest),mt.load(Ht.httpRequest)}catch{Ht.httpRequest.onerror()}}},j.delayLoadingTime-Wt)}}function ge(me){try{var V=[],j=Me.getQueryParameter(me);return j&&V.push(j),V}catch{return[]}}function pe(me){me.request?Ae(me,Y.getRetryAttemptsForType(me.request.type)):me.error&&me.error(me.request,"error")}function Re(){Ee.forEach(function(me){clearTimeout(me.timeout),me.config.request&&me.config.abort&&me.config.abort(me.config.request)}),Ee=[],Z.forEach(function(me){return clearTimeout(me.delayTimeout)}),Z=[],_e.forEach(function(me){me.request.type!==v.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE&&(me.onloadend=me.onerror=me.onprogress=void 0,me.loader.abort(me))}),_e=[]}return ve={load:pe,abort:Re},De(),ve}M.__dashjs_factory_name="HTTPLoader";var I=_.default.getClassFactory(M);const U=I},"./src/streaming/net/SchemeLoaderFactory.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/net/HTTPLoader.js");function v(){var E,T;function C(D,x){T[D]=x}function R(D){T[D]&&delete T[D]}function b(){T={}}function F(D){for(var x in T)if(T.hasOwnProperty(x)&&D.startsWith(x))return T[x];return g.default}function O(){b()}function L(){O()}return L(),E={getLoader:F,registerLoader:C,unregisterLoader:R,unregisterAllLoader:b,reset:O},E}v.__dashjs_factory_name="SchemeLoaderFactory";var _=m.default.getSingletonFactory(v);const S=_},"./src/streaming/net/URLLoader.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/net/SchemeLoaderFactory.js");function v(E){E=E||{};var T=this.context,C,R,b;R=(0,g.default)(T).getInstance();function F(L){if(!b){var D=R.getLoader(L&&L.request?L.request.url:null);b=D(T).create({errHandler:E.errHandler,mediaPlayerModel:E.mediaPlayerModel,requestModifier:E.requestModifier,dashMetrics:E.dashMetrics,boxParser:E.boxParser?E.boxParser:null,constants:E.constants?E.constants:null,dashConstants:E.dashConstants?E.dashConstants:null,urlUtils:E.urlUtils?E.urlUtils:null,requestTimeout:isNaN(E.requestTimeout)?0:E.requestTimeout,errors:E.errors})}b.load(L)}function O(){b&&b.abort()}return C={load:F,abort:O},C}v.__dashjs_factory_name="URLLoader";var _=m.default.getClassFactory(v);const S=_},"./src/streaming/net/XHRLoader.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/utils/RequestModifier.js");function v(E){E=E||{};var T=E.requestModifier,C;function R(O){T&&T.modifyRequest?(0,g.modifyRequest)(O,T).then(function(){return b(O)}):b(O)}function b(O){var L=new Date,D=O.request,x=new XMLHttpRequest;if(x.open(O.method,O.url,!0),D.responseType&&(x.responseType=D.responseType),D.range&&x.setRequestHeader("Range","bytes="+D.range),D.requestStartDate||(D.requestStartDate=L),T&&T.modifyRequestHeader&&(x=T.modifyRequestHeader(x,{url:O.url})),O.headers)for(var B in O.headers){var M=O.headers[B];M&&x.setRequestHeader(B,M)}x.withCredentials=O.withCredentials,x.onload=O.onload,x.onloadend=O.onend,x.onerror=O.onerror,x.onprogress=O.progress,x.onabort=O.onabort,x.ontimeout=O.ontimeout,x.timeout=O.timeout,x.send(),O.response=x}function F(O){var L=O.response;L.onloadend=L.onerror=L.onprogress=void 0,L.abort()}return C={load:R,abort:F},C}v.__dashjs_factory_name="XHRLoader";var _=m.default.getClassFactory(v);const S=_},"./src/streaming/protection/CommonEncryption.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});function m(T,C){if(!(T instanceof C))throw new TypeError("Cannot call a class as a function")}function g(T,C){for(var R=0;R<C.length;R++){var b=C[R];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(T,b.key,b)}}function v(T,C,R){return C&&g(T.prototype,C),R&&g(T,R),T}var _={attributes:["Laurl","laurl"],prefixes:["clearkey","dashif"]},S=function(){function T(){m(this,T)}return v(T,null,[{key:"findCencContentProtection",value:function(R){for(var b=null,F=0;F<R.length;++F){var O=R[F];O.schemeIdUri.toLowerCase()==="urn:mpeg:dash:mp4protection:2011"&&(O.value.toLowerCase()==="cenc"||O.value.toLowerCase()==="cbcs")&&(b=O)}return b}},{key:"getPSSHData",value:function(R){var b=8,F=new DataView(R),O=F.getUint8(b);return b+=20,O>0&&(b+=4+16*F.getUint32(b)),b+=4,R.slice(b)}},{key:"getPSSHForKeySystem",value:function(R,b){var F=T.parsePSSHList(b);return R&&F.hasOwnProperty(R.uuid.toLowerCase())?F[R.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(R,b){return"pssh"in R?(R.pssh.__text=R.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),b.decodeArray(R.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(R){if(R==null)return[];for(var b=new DataView(R.buffer||R),F=!1,O={},L=0;!F;){var D=void 0,x=void 0,B=void 0,M=void 0,I=L;if(L>=b.buffer.byteLength)break;if(D=b.getUint32(L),x=L+D,L+=4,b.getUint32(L)!==1886614376){L=x;continue}if(L+=4,B=b.getUint8(L),B!==0&&B!==1){L=x;continue}L++,L+=3,M="";var U=void 0,w=void 0;for(U=0;U<4;U++)w=b.getUint8(L+U).toString(16),M+=w.length===1?"0"+w:w;for(L+=4,M+="-",U=0;U<2;U++)w=b.getUint8(L+U).toString(16),M+=w.length===1?"0"+w:w;for(L+=2,M+="-",U=0;U<2;U++)w=b.getUint8(L+U).toString(16),M+=w.length===1?"0"+w:w;for(L+=2,M+="-",U=0;U<2;U++)w=b.getUint8(L+U).toString(16),M+=w.length===1?"0"+w:w;for(L+=2,M+="-",U=0;U<6;U++)w=b.getUint8(L+U).toString(16),M+=w.length===1?"0"+w:w;L+=6,M=M.toLowerCase(),L+=4,O[M]=b.buffer.slice(I,x),L=x}return O}},{key:"getLicenseServerUrlFromMediaInfo",value:function(R,b){try{if(!R||R.length===0)return null;for(var F=0,O=null;F<R.length&&!O;){var L=R[F];if(L&&L.contentProtection&&L.contentProtection.length>0){var D=L.contentProtection.filter(function(k){return k.schemeIdUri&&k.schemeIdUri===b});if(D&&D.length>0)for(var x=0;x<D.length&&!O;){for(var B=D[x],M=0;M<_.attributes.length&&!O;){for(var I=0,U=_.attributes[M];I<_.prefixes.length&&!O;){var w=_.prefixes[I];B[U]&&B[U].__prefix&&B[U].__prefix===w&&B[U].__text&&(O=B[U].__text),I+=1}M+=1}x+=1}}F+=1}return O}catch{return null}}}]),T}();const E=S},"./src/streaming/protection/Protection.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>O});var m=d("./src/streaming/protection/controllers/ProtectionController.js"),g=d("./src/streaming/protection/controllers/ProtectionKeyController.js"),v=d("./src/streaming/protection/ProtectionEvents.js"),_=d("./src/streaming/protection/errors/ProtectionErrors.js"),S=d("./src/streaming/protection/models/ProtectionModel_21Jan2015.js"),E=d("./src/streaming/protection/models/ProtectionModel_3Feb2014.js"),T=d("./src/streaming/protection/models/ProtectionModel_01b.js"),C=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],R=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function b(){var L,D=this.context;function x(I){var U=null,w=(0,g.default)(D).getInstance();w.setConfig({debug:I.debug,BASE64:I.BASE64,settings:I.settings}),w.initialize();var k=B(I);return!U&&k&&(U=(0,m.default)(D).create({protectionModel:k,protectionKeyController:w,eventBus:I.eventBus,debug:I.debug,events:I.events,BASE64:I.BASE64,constants:I.constants,cmcdModel:I.cmcdModel,customParametersModel:I.customParametersModel,settings:I.settings}),I.capabilities.setEncryptedMediaSupported(!0)),U}function B(I){var U=I.debug,w=U.getLogger(L),k=I.eventBus,K=I.errHandler,W=I.videoModel?I.videoModel.getElement():null;return(!W||W.onencrypted!==void 0)&&(!W||W.mediaKeys!==void 0)?(w.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,S.default)(D).create({debug:U,eventBus:k,events:I.events})):M(W,R)?(w.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,E.default)(D).create({debug:U,eventBus:k,events:I.events,api:M(W,R)})):M(W,C)?(w.info("EME detected on this user agent! (ProtectionModel_01b)"),(0,T.default)(D).create({debug:U,eventBus:k,errHandler:K,events:I.events,api:M(W,C)})):(w.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null)}function M(I,U){for(var w=0;w<U.length;w++){var k=U[w];if(typeof I[k[Object.keys(k)[0]]]=="function")return k}return null}return L={createProtectionSystem:x},L}b.__dashjs_factory_name="Protection";var F=dashjs.FactoryMaker.getClassFactory(b);F.events=v.default,F.errors=_.default,dashjs.FactoryMaker.updateClassFactory(b.__dashjs_factory_name,F);const O=F},"./src/streaming/protection/ProtectionEvents.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/core/events/EventsBase.js");function g(D){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(B){return typeof B}:g=function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},g(D)}function v(D,x){if(!(D instanceof x))throw new TypeError("Cannot call a class as a function")}function _(D,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");D.prototype=Object.create(x&&x.prototype,{constructor:{value:D,writable:!0,configurable:!0}}),x&&S(D,x)}function S(D,x){return S=Object.setPrototypeOf||function(M,I){return M.__proto__=I,M},S(D,x)}function E(D){var x=R();return function(){var M=b(D),I;if(x){var U=b(this).constructor;I=Reflect.construct(M,arguments,U)}else I=M.apply(this,arguments);return T(this,I)}}function T(D,x){return x&&(g(x)==="object"||typeof x=="function")?x:C(D)}function C(D){if(D===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D}function R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(D){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)},b(D)}var F=function(D){_(B,D);var x=E(B);function B(){var M;return v(this,B),M=x.call(this),M.INTERNAL_KEY_MESSAGE="internalKeyMessage",M.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",M.KEY_ADDED="public_keyAdded",M.KEY_ERROR="public_keyError",M.KEY_MESSAGE="public_keyMessage",M.KEY_SESSION_CLOSED="public_keySessionClosed",M.KEY_SESSION_CREATED="public_keySessionCreated",M.KEY_SESSION_REMOVED="public_keySessionRemoved",M.KEY_STATUSES_CHANGED="public_keyStatusesChanged",M.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",M.KEY_SYSTEM_SELECTED="public_keySystemSelected",M.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",M.LICENSE_REQUEST_SENDING="public_licenseRequestSending",M.NEED_KEY="needkey",M.PROTECTION_CREATED="public_protectioncreated",M.PROTECTION_DESTROYED="public_protectiondestroyed",M.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",M.TEARDOWN_COMPLETE="protectionTeardownComplete",M.VIDEO_ELEMENT_SELECTED="videoElementSelected",M.KEY_SESSION_UPDATED="public_keySessionUpdated",M}return B}(m.default),O=new F;const L=O},"./src/streaming/protection/controllers/ProtectionController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>U});var m=d("./src/streaming/protection/CommonEncryption.js"),g=d("./src/streaming/protection/vo/MediaCapability.js"),v=d("./src/streaming/protection/vo/KeySystemConfiguration.js"),_=d("./src/streaming/protection/errors/ProtectionErrors.js"),S=d("./src/streaming/vo/DashJSError.js"),E=d("./src/streaming/protection/vo/LicenseRequest.js"),T=d("./src/streaming/protection/vo/LicenseResponse.js"),C=d("./src/streaming/vo/metrics/HTTPRequest.js"),R=d("./src/core/Utils.js"),b=d("./src/streaming/constants/Constants.js"),F=d("./src/core/FactoryMaker.js");function O(w){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?O=function(K){return typeof K}:O=function(K){return K&&typeof Symbol=="function"&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K},O(w)}var L=5,D=500,x=3,B=1e3,M=8e3;function I(w){w=w||{};var k=w.protectionKeyController,K=w.protectionModel,W=w.eventBus,Y=w.events,J=w.debug,ee=w.BASE64,ue=w.constants,ie=[],Q=w.cmcdModel,se=w.settings,ve=w.customParametersModel,_e,Z,Ee,Se,Me,de,xe,Fe,Le,De,Ae;function ge(){Z=J.getLogger(_e),Ee=[],Se=[],de="temporary",xe="",De=null,Ae=null,W.on(Y.INTERNAL_KEY_MESSAGE,Wt,_e),W.on(Y.INTERNAL_KEY_STATUS_CHANGED,Nt,_e)}function pe(){if(!W||!W.hasOwnProperty("on")||!k||!k.hasOwnProperty("getSupportedKeySystemsFromContentProtection"))throw new Error("Missing config parameter(s)")}function Re(Oe){if(!Oe)throw new Error("mediaInfo can not be null or undefined");pe(),Se.push(Oe)}function me(){if(!(!Se||Se.length===0)){var Oe=[];Se.forEach(function(ze){var ct=k.getSupportedKeySystemsFromContentProtection(ze.contentProtection,Me,de);ct.length>0&&(Oe.length===0&&(Oe=ct),Ee.push(ct))}),Oe&&Oe.length>0&&j(Oe,!0)}}function V(Oe){Ee.push(Oe),j(Oe,!1)}function j(Oe,ze){!Fe&&!Le?$(Oe,ze):Fe&&re()}function $(Oe,ze){if(!Le){Le=!0;var ct=[];Oe=Oe.sort(function(Dt,Kt){var on=Me&&Me[Dt.ks.systemString]&&Me[Dt.ks.systemString].priority>=0?Me[Dt.ks.systemString].priority:Oe.length,Tn=Me&&Me[Kt.ks.systemString]&&Me[Kt.ks.systemString].priority>=0?Me[Kt.ks.systemString].priority:Oe.length;return on-Tn});for(var dt=0;dt<Oe.length;dt++){var bt=st(Oe[dt]);ct.push({ks:Oe[dt].ks,configs:[bt],protData:Oe[dt].protData})}var Ft;K.requestKeySystemAccess(ct).then(function(Dt){Ft=Dt.data;var Kt=Ft.mksa&&Ft.mksa.selectedSystemString?Ft.mksa.selectedSystemString:Ft.keySystem.systemString;return Z.info("DRM: KeySystem Access Granted for system string ("+Kt+")!  Selecting key system..."),K.selectKeySystem(Ft)}).then(function(Dt){if(Fe=Dt,Le=!1,!!K){W.trigger(Y.KEY_SYSTEM_SELECTED,{data:Ft});var Kt=ne(Fe);Kt&&Kt.serverCertificate&&Kt.serverCertificate.length>0&&K.setServerCertificate(ee.decodeArray(Kt.serverCertificate).buffer),re()}}).catch(function(Dt){Fe=null,Le=!1,ze||W.trigger(Y.KEY_SYSTEM_SELECTED,{data:null,error:new S.default(_.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,_.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+Dt.error)})})}}function re(){for(var Oe,ze=0;ze<Ee.length;ze++)for(Oe=0;Oe<Ee[ze].length;Oe++)if(Fe===Ee[ze][Oe].ks){var ct=Ee[ze][Oe];oe(ct);break}Ee=[]}function oe(Oe){if(k.isClearKey(Fe)&&Oe.protData&&Oe.protData.hasOwnProperty("clearkeys")&&Object.keys(Oe.protData.clearkeys).length!==0){var ze={kids:Object.keys(Oe.protData.clearkeys)};Oe.initData=new TextEncoder().encode(JSON.stringify(ze))}Oe.sessionId?X(Oe):Oe.initData!==null&&z(Oe)}function X(Oe){pe(),K.loadKeySession(Oe)}function z(Oe){var ze=m.default.getPSSHForKeySystem(Fe,Oe?Oe.initData:null);if(ze){if(Pe(Oe.keyId)||he(ze))return;try{Oe.initData=ze,K.createKeySession(Oe)}catch(ct){W.trigger(Y.KEY_SESSION_CREATED,{data:null,error:new S.default(_.default.KEY_SESSION_CREATED_ERROR_CODE,_.default.KEY_SESSION_CREATED_ERROR_MESSAGE+ct.message)})}}else Oe&&Oe.initData?K.createKeySession(Oe):W.trigger(Y.KEY_SESSION_CREATED,{data:null,error:new S.default(_.default.KEY_SESSION_CREATED_ERROR_CODE,_.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(Fe?Fe.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function ne(Oe){if(Oe){var ze=Oe.systemString;if(Me)return ze in Me?Me[ze]:null}return null}function fe(){Se=[]}function Ce(Oe){return pe(),k.getSupportedKeySystemsFromContentProtection(Oe,Me,de)}function Pe(Oe){if(!Oe)return!1;try{for(var ze=K.getSessions(),ct=0;ct<ze.length;ct++)if(ze[ct].getKeyId()===Oe)return!0;return!1}catch{return!1}}function he(Oe){if(!Oe)return!1;try{for(var ze=K.getAllInitData(),ct=0;ct<ze.length;ct++)if(k.initDataEquals(Oe,ze[ct]))return Z.debug("DRM: Ignoring initData because we have already seen it!"),!0;return!1}catch{return!1}}function Ue(Oe){pe(),K.removeKeySession(Oe)}function we(Oe){pe(),K.closeKeySession(Oe)}function $e(Oe){pe(),K.setServerCertificate(Oe)}function it(Oe){pe(),Oe?(K.setMediaElement(Oe),W.on(Y.NEED_KEY,In,_e)):Oe===null&&(K.setMediaElement(Oe),W.off(Y.NEED_KEY,In,_e))}function mt(Oe){de=Oe}function pt(Oe){xe=Oe}function Pt(Oe){Me=Oe,k.setProtectionData(Oe)}function lt(){St(),K&&K.stop()}function Ye(){W.off(Y.INTERNAL_KEY_MESSAGE,Wt,_e),W.off(Y.INTERNAL_KEY_STATUS_CHANGED,Nt,_e),pe(),St(),it(null),Fe=null,Le=!1,K&&(K.reset(),K=null),ie.forEach(function(Oe){return clearTimeout(Oe)}),ie=[],Se=[],Ee=[]}function st(Oe){var ze=Oe.protData,ct=[],dt=[],bt=ze&&ze.audioRobustness&&ze.audioRobustness.length>0?ze.audioRobustness:xe,Ft=ze&&ze.videoRobustness&&ze.videoRobustness.length>0?ze.videoRobustness:xe,Dt=Oe.sessionType,Kt=ze&&ze.distinctiveIdentifier?ze.distinctiveIdentifier:"optional",on=ze&&ze.persistentState?ze.persistentState:Dt==="temporary"?"optional":"required";return Se.forEach(function(Tn){Tn.type===ue.AUDIO?ct.push(new g.default(Tn.codec,bt)):Tn.type===ue.VIDEO&&dt.push(new g.default(Tn.codec,Ft))}),new v.default(ct,dt,Kt,on,[Dt])}function Nt(Oe){Oe.error?W.trigger(Y.KEY_STATUSES_CHANGED,{data:null,error:Oe.error}):Z.debug("DRM: key status = "+Oe.status)}function Wt(Oe){Z.debug("DRM: onKeyMessage");var ze=Oe.data;W.trigger(Y.KEY_MESSAGE,{data:ze});var ct=ze.messageType?ze.messageType:"license-request",dt=ze.message,bt=ze.sessionToken,Ft=ne(Fe),Dt=k.getLicenseServerModelInstance(Fe,Ft,ct),Kt={sessionToken:bt,messageType:ct};if(!dt||dt.byteLength===0){Ht(Kt,new S.default(_.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,_.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE));return}if(!Dt){Z.debug("DRM: License server request not required for this message (type = "+Oe.data.messageType+").  Session ID = "+bt.getSessionId()),Ht(Kt);return}if(k.isClearKey(Fe)){var on=k.processClearKeyLicenseRequest(Fe,Ft,dt);if(on&&on.keyPairs&&on.keyPairs.length>0){Z.debug("DRM: ClearKey license request handled by application!"),Ht(Kt),K.updateKeySession(bt,on);return}}nt(ze,Dt,Ft)}function Ht(Oe,ze){W.trigger(Y.LICENSE_REQUEST_COMPLETE,{data:Oe,error:ze})}function nt(Oe,ze,ct){var dt=Oe.sessionToken,bt=Oe.messageType?Oe.messageType:"license-request",Ft={sessionToken:dt,messageType:bt},Dt=Fe?Fe.systemString:null,Kt=Ut(ct,bt,dt,Oe,ze);if(!Kt){Ht(Ft,new S.default(_.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,_.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE));return}var on={},Tn=!1;ct&&Vt(on,ct.httpRequestHeaders);var Ke=Oe.message,ut=Fe.getRequestHeadersFromMessage(Ke);Vt(on,ut),Object.keys(on).forEach(function(gt){gt.toLowerCase()==="authorization"&&(Tn=!0)}),ct&&typeof ct.withCredentials=="boolean"&&(Tn=ct.withCredentials);var wt=function(At){if(K)if(At.status>=200&&At.status<=299){var en=R.default.parseHttpHeaders(At.getAllResponseHeaders?At.getAllResponseHeaders():null),Nn=new T.default(At.responseURL,en,At.response),_n=ve.getLicenseResponseFilters();We(_n,Nn).then(function(){var En=ze.getLicenseMessage(Nn.data,Dt,bt);En!==null?(Ht(Ft),K.updateKeySession(dt,En)):Zt(At,Ft,Dt,bt,ze)})}else Zt(At,Ft,Dt,bt,ze)},Gt=function(At){Ht(Ft,new S.default(_.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,_.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+Dt+' update, XHR aborted. status is "'+At.statusText+'" ('+At.status+"), readyState is "+At.readyState))},Qt=function(At){Ht(Ft,new S.default(_.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,_.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+Dt+' update, XHR error. status is "'+At.statusText+'" ('+At.status+"), readyState is "+At.readyState))},sn=Fe.getLicenseRequestFromMessage(Ke),Dn=ze.getHTTPMethod(bt),pn=ze.getResponseType(Dt,bt),sr=ct&&!isNaN(ct.httpTimeout)?ct.httpTimeout:M,Be=dt.getSessionId()||null,Tt=new E.default(Kt,Dn,pn,on,Tn,bt,Be,sn),Xt=isNaN(se.get().streaming.retryAttempts[C.HTTPRequest.LICENSE])?x:se.get().streaming.retryAttempts[C.HTTPRequest.LICENSE],et=ve.getLicenseRequestFilters();We(et,Tt).then(function(){Et(Tt,Xt,sr,wt,Gt,Qt)})}function Et(Oe,ze,ct,dt,bt,Ft){var Dt=new XMLHttpRequest;if(se.get().streaming.cmcd&&se.get().streaming.cmcd.enabled){var Kt=se.get().streaming.cmcd.mode;if(Kt===b.default.CMCD_MODE_QUERY){var on=Q.getQueryParameter({url:Oe.url,type:C.HTTPRequest.LICENSE});on&&(Oe.url=R.default.addAditionalQueryParameterToUrl(Oe.url,[on]))}}Dt.open(Oe.method,Oe.url,!0),Dt.responseType=Oe.responseType,Dt.withCredentials=Oe.withCredentials,ct>0&&(Dt.timeout=ct);for(var Tn in Oe.headers)Dt.setRequestHeader(Tn,Oe.headers[Tn]);if(se.get().streaming.cmcd&&se.get().streaming.cmcd.enabled){var Ke=se.get().streaming.cmcd.mode;if(Ke===b.default.CMCD_MODE_HEADER){var ut=Q.getHeaderParameters({url:Oe.url,type:C.HTTPRequest.LICENSE});if(ut)for(var wt in ut){var Gt=ut[wt];Gt&&Dt.setRequestHeader(wt,Gt)}}}var Qt=function(){ze--;var Dn=isNaN(se.get().streaming.retryIntervals[C.HTTPRequest.LICENSE])?B:se.get().streaming.retryIntervals[C.HTTPRequest.LICENSE];Ae=setTimeout(function(){Et(Oe,ze,ct,dt,bt,Ft)},Dn)};Dt.onload=function(){De=null,this.status>=200&&this.status<=299||ze<=0?dt(this):(Z.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+ze),Qt())},Dt.ontimeout=Dt.onerror=function(){De=null,ze<=0?Ft(this):(Z.warn("License request network request failed . Retrying it... Pending retries: "+ze),Qt())},Dt.onabort=function(){bt(this)},W.trigger(Y.LICENSE_REQUEST_SENDING,{url:Oe.url,headers:Oe.headers,payload:Oe.data,sessionId:Oe.sessionId}),De=Dt,Dt.send(Oe.data)}function St(){De&&(De.onloadend=De.onerror=De.onprogress=void 0,De.abort(),De=null),Ae&&(clearTimeout(Ae),Ae=null)}function Ut(Oe,ze,ct,dt,bt){var Ft=null,Dt=dt.message;if(Oe&&Oe.serverURL){var Kt=Oe.serverURL;typeof Kt=="string"&&Kt!==""?Ft=Kt:O(Kt)==="object"&&Kt.hasOwnProperty(ze)&&(Ft=Kt[ze])}else if(Oe&&Oe.laURL&&Oe.laURL!=="")Ft=Oe.laURL;else if(Ft=m.default.getLicenseServerUrlFromMediaInfo(Se,Fe.schemeIdURI),!Ft&&!k.isClearKey(Fe)){var on=m.default.getPSSHData(ct.initData);Ft=Fe.getLicenseServerURLFromInitData(on),Ft||(Ft=dt.laURL)}return Ft=bt.getServerURLFromMessage(Ft,Dt,ze),Ft}function Vt(Oe,ze){if(ze)for(var ct in ze)Oe[ct]=ze[ct]}function Zt(Oe,ze,ct,dt,bt){var Ft="NONE",Dt=null;Oe.response&&(Ft=bt.getErrorResponse(Oe.response,ct,dt),Dt={serverResponse:Oe.response||null,responseCode:Oe.status||null,responseText:Oe.statusText||null}),Ht(ze,new S.default(_.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,_.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+ct+' update, XHR complete. status is "'+Oe.statusText+'" ('+Oe.status+"), readyState is "+Oe.readyState+".  Response is "+Ft,Dt))}function We(Oe,ze){return Oe?Oe.reduce(function(ct,dt){return ct.then(function(){return dt(ze)})},Promise.resolve()):Promise.resolve()}function In(Oe,ze){if(!se.get().streaming.protection.ignoreEmeEncryptedEvent){if(Z.debug("DRM: onNeedKey"),Oe.key.initDataType!=="cenc"){Z.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+Oe.key.initDataType);return}if(Se.length===0&&(Z.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),ze=typeof ze>"u"?1:ze+1,ze<L)){ie.push(setTimeout(function(){In(Oe,ze)},D));return}var ct=Oe.key.initData;if(ArrayBuffer.isView(ct)&&(ct=ct.buffer),Fe){var dt=m.default.getPSSHForKeySystem(Fe,ct);if(dt&&he(dt))return}Z.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(ct)));var bt=k.getSupportedKeySystemsFromSegmentPssh(ct,Me,de);if(bt.length===0){Z.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!");return}V(bt)}}function Ct(){return k?k.getKeySystems():[]}function je(Oe){k&&k.setKeySystems(Oe)}return _e={initializeForMedia:Re,clearMediaInfoArray:fe,handleKeySystemFromManifest:me,createKeySession:z,loadKeySession:X,removeKeySession:Ue,closeKeySession:we,setServerCertificate:$e,setMediaElement:it,setSessionType:mt,setRobustnessLevel:pt,setProtectionData:Pt,getSupportedKeySystemsFromContentProtection:Ce,getKeySystems:Ct,setKeySystems:je,stop:lt,reset:Ye},ge(),_e}I.__dashjs_factory_name="ProtectionController";const U=F.default.getClassFactory(I)},"./src/streaming/protection/controllers/ProtectionKeyController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>O});var m=d("./src/streaming/protection/CommonEncryption.js"),g=d("./src/streaming/protection/drm/KeySystemClearKey.js"),v=d("./src/streaming/protection/drm/KeySystemW3CClearKey.js"),_=d("./src/streaming/protection/drm/KeySystemWidevine.js"),S=d("./src/streaming/protection/drm/KeySystemPlayReady.js"),E=d("./src/streaming/protection/servers/DRMToday.js"),T=d("./src/streaming/protection/servers/PlayReady.js"),C=d("./src/streaming/protection/servers/Widevine.js"),R=d("./src/streaming/protection/servers/ClearKey.js"),b=d("./src/streaming/constants/ProtectionConstants.js");function F(){var L=this.context,D,x,B,M,I,U,w,k;function K(de){de&&(de.debug&&(x=de.debug,B=x.getLogger(D)),de.BASE64&&(I=de.BASE64),de.settings&&(U=de.settings))}function W(){M=[];var de;de=(0,S.default)(L).getInstance({BASE64:I,settings:U}),M.push(de),de=(0,_.default)(L).getInstance({BASE64:I}),M.push(de),de=(0,g.default)(L).getInstance({BASE64:I}),M.push(de),w=de,de=(0,v.default)(L).getInstance({BASE64:I,debug:x}),M.push(de),k=de}function Y(){return M}function J(de){M=de}function ee(de){for(var xe=0;xe<M.length;xe++)if(M[xe].systemString===de)return M[xe];return null}function ue(de){return de===w||de===k}function ie(de,xe){if(de.byteLength===xe.byteLength){for(var Fe=new Uint8Array(de),Le=new Uint8Array(xe),De=0;De<Fe.length;De++)if(Fe[De]!==Le[De])return!1;return!0}return!1}function Q(de,xe,Fe){var Le,De,Ae,ge,pe=[];if(de){var Re=m.default.findCencContentProtection(de);for(Ae=0;Ae<M.length;++Ae){De=M[Ae];var me=Ee(De.systemString,xe);for(ge=0;ge<de.length;++ge)if(Le=de[ge],Le.schemeIdUri.toLowerCase()===De.schemeIdURI){var V=De.getInitData(Le,Re);pe.push({ks:M[Ae],keyId:Le.keyId,initData:V,protData:me,cdmData:De.getCDMData(me?me.cdmData:null),sessionId:Se(me,Le),sessionType:Me(me,Fe)})}}}return pe}function se(de,xe,Fe){for(var Le=[],De=m.default.parsePSSHList(de),Ae,ge,pe=0;pe<M.length;++pe){Ae=M[pe],ge=Ae.systemString;var Re=Ee(ge,xe);Ae.uuid in De&&Le.push({ks:Ae,initData:De[Ae.uuid],protData:Re,cdmData:Ae.getCDMData(Re?Re.cdmData:null),sessionId:Se(Re),sessionType:Me(Re,Fe)})}return Le}function ve(de,xe,Fe){if(Fe==="license-release"||Fe==="individualization-request")return null;var Le=null;return xe&&xe.hasOwnProperty("drmtoday")?Le=(0,E.default)(L).getInstance({BASE64:I}):de.systemString===b.default.WIDEVINE_KEYSTEM_STRING?Le=(0,C.default)(L).getInstance():de.systemString===b.default.PLAYREADY_KEYSTEM_STRING?Le=(0,T.default)(L).getInstance():de.systemString===b.default.CLEARKEY_KEYSTEM_STRING&&(Le=(0,R.default)(L).getInstance()),Le}function _e(de,xe,Fe){try{return de.getClearKeysFromProtectionData(xe,Fe)}catch{return B.error("Failed to retrieve clearkeys from ProtectionData"),null}}function Z(de){for(var xe=function(Ae){var ge=null;return de&&(ge=Ae in de?de[Ae]:null),ge},Fe=0;Fe<M.length;Fe++){var Le=M[Fe];Le.hasOwnProperty("init")&&Le.init(xe(Le.systemString))}}function Ee(de,xe){return xe&&de in xe?xe[de]:null}function Se(de,xe){return de&&de.sessionId?de.sessionId:xe&&xe.sessionId?xe.sessionId:null}function Me(de,xe){return de&&de.sessionType?de.sessionType:xe}return D={initialize:W,setProtectionData:Z,isClearKey:ue,initDataEquals:ie,getKeySystems:Y,setKeySystems:J,getKeySystemBySystemString:ee,getSupportedKeySystemsFromContentProtection:Q,getSupportedKeySystemsFromSegmentPssh:se,getLicenseServerModelInstance:ve,processClearKeyLicenseRequest:_e,setConfig:K},D}F.__dashjs_factory_name="ProtectionKeyController";const O=dashjs.FactoryMaker.getSingletonFactory(F)},"./src/streaming/protection/drm/KeySystemClearKey.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>R});var m=d("./src/streaming/protection/vo/KeyPair.js"),g=d("./src/streaming/protection/vo/ClearKeyKeySet.js"),v=d("./src/streaming/protection/CommonEncryption.js"),_=d("./src/streaming/constants/ProtectionConstants.js"),S="e2719d58-a985-b3c9-781a-b030af78d30e",E=_.default.CLEARKEY_KEYSTEM_STRING,T="urn:uuid:"+S;function C(b){b=b||{};var F,O=b.BASE64;function L(w,k){var K=null;if(w){for(var W=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(k))),Y=[],J=0;J<W.kids.length;J++){var ee=W.kids[J],ue=w.clearkeys&&w.clearkeys.hasOwnProperty(ee)?w.clearkeys[ee]:null;if(!ue)throw new Error("DRM: ClearKey keyID ("+ee+") is not known!");Y.push(new m.default(ee,ue))}K=new g.default(Y)}return K}function D(w,k){try{var K=v.default.parseInitDataFromContentProtection(w,O);if(!K&&k){var W=x(k["cenc:default_KID"]),Y={kids:[W]};K=new TextEncoder().encode(JSON.stringify(Y))}return K}catch{return null}}function x(w){try{var k=w.replace(/-/g,"");return k=btoa(k.match(/\w{2}/g).map(function(K){return String.fromCharCode(parseInt(K,16))}).join("")),k.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}catch{return null}}function B(){return{"Content-Type":"application/json"}}function M(w){return JSON.stringify(JSON.parse(String.fromCharCode.apply(null,new Uint8Array(w))))}function I(){return null}function U(){return null}return F={uuid:S,schemeIdURI:T,systemString:E,getInitData:D,getRequestHeadersFromMessage:B,getLicenseRequestFromMessage:M,getLicenseServerURLFromInitData:I,getCDMData:U,getClearKeysFromProtectionData:L},F}C.__dashjs_factory_name="KeySystemClearKey";const R=dashjs.FactoryMaker.getSingletonFactory(C)},"./src/streaming/protection/drm/KeySystemPlayReady.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>C});var m=d("./src/streaming/protection/CommonEncryption.js"),g=d("./src/streaming/constants/ProtectionConstants.js"),v="9a04f079-9840-4286-ab92-e65be0885f95",_=g.default.PLAYREADY_KEYSTEM_STRING,S="urn:uuid:"+v,E='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>';function T(R){R=R||{};var b,F="utf-16",O=R.BASE64,L=R.settings;function D(){if(!O||!O.hasOwnProperty("decodeArray")||!O.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}function x(k){var K,W,Y={},J=new DOMParser;if(L&&L.get().streaming.protection.detectPlayreadyMessageFormat&&F==="utf-16"&&k&&k.byteLength%2===1)return Y["Content-Type"]="text/xml; charset=utf-8",Y;var ee=F==="utf-16"?new Uint16Array(k):new Uint8Array(k);K=String.fromCharCode.apply(null,ee),W=J.parseFromString(K,"application/xml");for(var ue=W.getElementsByTagName("name"),ie=W.getElementsByTagName("value"),Q=0;Q<ue.length;Q++)Y[ue[Q].childNodes[0].nodeValue]=ie[Q].childNodes[0].nodeValue;return Y.hasOwnProperty("Content")&&(Y["Content-Type"]=Y.Content,delete Y.Content),Y.hasOwnProperty("Content-Type")||(Y["Content-Type"]="text/xml; charset=utf-8"),Y}function B(k){var K=null,W=new DOMParser;if(L&&L.get().streaming.protection.detectPlayreadyMessageFormat&&F==="utf-16"&&k&&k.byteLength%2===1)return k;var Y=F==="utf-16"?new Uint16Array(k):new Uint8Array(k);D();var J=String.fromCharCode.apply(null,Y),ee=W.parseFromString(J,"application/xml");if(ee.getElementsByTagName("PlayReadyKeyMessage")[0]){var ue=ee.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;ue&&(K=O.decode(ue))}else return k;return K}function M(k){if(k)for(var K=new DataView(k),W=K.getUint16(4,!0),Y=6,J=new DOMParser,ee=0;ee<W;ee++){var ue=K.getUint16(Y,!0);Y+=2;var ie=K.getUint16(Y,!0);if(Y+=2,ue!==1){Y+=ie;continue}var Q=k.slice(Y,Y+ie),se=String.fromCharCode.apply(null,new Uint16Array(Q)),ve=J.parseFromString(se,"application/xml");if(ve.getElementsByTagName("LA_URL")[0]){var _e=ve.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(_e)return _e}if(ve.getElementsByTagName("LUI_URL")[0]){var Z=ve.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(Z)return Z}}return null}function I(k){var K=new Uint8Array([112,115,115,104,0,0,0,0]),W=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),Y=0,J=null,ee,ue,ie,Q,se;if(D(),!k)return null;if("pssh"in k)return m.default.parseInitDataFromContentProtection(k,O);if("pro"in k)J=O.decodeArray(k.pro.__text);else if("prheader"in k)J=O.decodeArray(k.prheader.__text);else return null;return ee=J.length,ue=4+K.length+W.length+4+ee,ie=new ArrayBuffer(ue),Q=new Uint8Array(ie),se=new DataView(ie),se.setUint32(Y,ue),Y+=4,Q.set(K,Y),Y+=K.length,Q.set(W,Y),Y+=W.length,se.setUint32(Y,ee),Y+=4,Q.set(J,Y),Y+=ee,Q.buffer}function U(k){if(k!=="utf-8"&&k!=="utf-16")throw new Error('Specified message format is not one of "utf-8" or "utf-16"');F=k}function w(k){var K,W,Y,J;if(D(),!k)return null;for(K=[],J=0;J<k.length;++J)K.push(k.charCodeAt(J)),K.push(0);for(K=String.fromCharCode.apply(null,K),K=O.encode(K),W=E.replace("%CUSTOMDATA%",K),Y=[],J=0;J<W.length;++J)Y.push(W.charCodeAt(J)),Y.push(0);return new Uint8Array(Y).buffer}return b={uuid:v,schemeIdURI:S,systemString:_,getInitData:I,getRequestHeadersFromMessage:x,getLicenseRequestFromMessage:B,getLicenseServerURLFromInitData:M,getCDMData:w,setPlayReadyMessageFormat:U},b}T.__dashjs_factory_name="KeySystemPlayReady";const C=dashjs.FactoryMaker.getSingletonFactory(T)},"./src/streaming/protection/drm/KeySystemW3CClearKey.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>R});var m=d("./src/streaming/protection/vo/KeyPair.js"),g=d("./src/streaming/protection/vo/ClearKeyKeySet.js"),v=d("./src/streaming/protection/CommonEncryption.js"),_=d("./src/streaming/constants/ProtectionConstants.js"),S="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",E=_.default.CLEARKEY_KEYSTEM_STRING,T="urn:uuid:"+S;function C(b){var F,O=b.BASE64,L=b.debug.getLogger(F);function D(w,k){var K=null;if(w){for(var W=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(k))),Y=[],J=0;J<W.kids.length;J++){var ee=W.kids[J],ue=w.clearkeys&&w.clearkeys.hasOwnProperty(ee)?w.clearkeys[ee]:null;if(!ue)throw new Error("DRM: ClearKey keyID ("+ee+") is not known!");Y.push(new m.default(ee,ue))}K=new g.default(Y),L.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return K}function x(w){return v.default.parseInitDataFromContentProtection(w,O)}function B(){return null}function M(w){return new Uint8Array(w)}function I(){return null}function U(){return null}return F={uuid:S,schemeIdURI:T,systemString:E,getInitData:x,getRequestHeadersFromMessage:B,getLicenseRequestFromMessage:M,getLicenseServerURLFromInitData:I,getCDMData:U,getClearKeysFromProtectionData:D},F}C.__dashjs_factory_name="KeySystemW3CClearKey";const R=dashjs.FactoryMaker.getSingletonFactory(C)},"./src/streaming/protection/drm/KeySystemWidevine.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>T});var m=d("./src/streaming/protection/CommonEncryption.js"),g=d("./src/streaming/constants/ProtectionConstants.js"),v="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",_=g.default.WIDEVINE_KEYSTEM_STRING,S="urn:uuid:"+v;function E(C){C=C||{};var R,b=C.BASE64;function F(B){return m.default.parseInitDataFromContentProtection(B,b)}function O(){return null}function L(B){return new Uint8Array(B)}function D(){return null}function x(){return null}return R={uuid:v,schemeIdURI:S,systemString:_,getInitData:F,getRequestHeadersFromMessage:O,getLicenseRequestFromMessage:L,getLicenseServerURLFromInitData:D,getCDMData:x},R}E.__dashjs_factory_name="KeySystemWidevine";const T=dashjs.FactoryMaker.getSingletonFactory(E)},"./src/streaming/protection/errors/ProtectionErrors.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/core/errors/ErrorsBase.js");function g(D){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(B){return typeof B}:g=function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},g(D)}function v(D,x){if(!(D instanceof x))throw new TypeError("Cannot call a class as a function")}function _(D,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");D.prototype=Object.create(x&&x.prototype,{constructor:{value:D,writable:!0,configurable:!0}}),x&&S(D,x)}function S(D,x){return S=Object.setPrototypeOf||function(M,I){return M.__proto__=I,M},S(D,x)}function E(D){var x=R();return function(){var M=b(D),I;if(x){var U=b(this).constructor;I=Reflect.construct(M,arguments,U)}else I=M.apply(this,arguments);return T(this,I)}}function T(D,x){return x&&(g(x)==="object"||typeof x=="function")?x:C(D)}function C(D){if(D===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D}function R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(D){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)},b(D)}var F=function(D){_(B,D);var x=E(B);function B(){var M;return v(this,B),M=x.call(this),M.MEDIA_KEYERR_CODE=100,M.MEDIA_KEYERR_UNKNOWN_CODE=101,M.MEDIA_KEYERR_CLIENT_CODE=102,M.MEDIA_KEYERR_SERVICE_CODE=103,M.MEDIA_KEYERR_OUTPUT_CODE=104,M.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,M.MEDIA_KEYERR_DOMAIN_CODE=106,M.MEDIA_KEY_MESSAGE_ERROR_CODE=107,M.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,M.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,M.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,M.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,M.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,M.KEY_SESSION_CREATED_ERROR_CODE=113,M.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,M.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",M.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",M.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",M.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",M.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",M.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",M.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",M.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",M.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",M.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",M.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",M.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",M.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",M.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",M}return B}(m.default),O=new F;const L=O},"./src/streaming/protection/models/ProtectionModel_01b.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>R});var m=d("./src/streaming/protection/controllers/ProtectionKeyController.js"),g=d("./src/streaming/protection/vo/NeedKey.js"),v=d("./src/streaming/vo/DashJSError.js"),_=d("./src/streaming/protection/vo/KeyMessage.js"),S=d("./src/streaming/protection/vo/KeySystemConfiguration.js"),E=d("./src/streaming/protection/vo/KeySystemAccess.js"),T=d("./src/streaming/protection/errors/ProtectionErrors.js");function C(b){b=b||{};var F=this.context,O=b.eventBus,L=b.events,D=b.debug,x=b.api,B=b.errHandler,M,I,U,w,k,K,W,Y,J;function ee(){I=D.getLogger(M),U=null,w=null,K=[],W=[],k=(0,m.default)(F).getInstance(),J=Fe()}function ue(){U&&De();for(var Ae=0;Ae<W.length;Ae++)Se(W[Ae]);O.trigger(L.TEARDOWN_COMPLETE)}function ie(){for(var Ae=[],ge=0;ge<K.length;ge++)Ae.push(K[ge].initData);for(var pe=0;pe<W.length;pe++)Ae.push(W[pe].initData);return Ae}function Q(){return W.concat(K)}function se(Ae){return new Promise(function(ge,pe){var Re=U;Re||(Re=document.createElement("video"));for(var me=!1,V=0;V<Ae.length;V++)for(var j=Ae[V].ks.systemString,$=Ae[V].configs,re=null,oe=null,X=0;X<$.length;X++){var z=$[X].videoCapabilities;if(z&&z.length!==0){oe=[];for(var ne=0;ne<z.length;ne++)Re.canPlayType(z[ne].contentType,j)!==""&&oe.push(z[ne])}if(!(!re&&!oe||re&&re.length===0||oe&&oe.length===0)){me=!0;var fe=new S.default(re,oe),Ce=k.getKeySystemBySystemString(j),Pe=new E.default(Ce,fe);O.trigger(L.KEY_SYSTEM_ACCESS_COMPLETE,{data:Pe}),ge({data:Pe});break}}if(!me){var he="Key system access denied! -- No valid audio/video content configurations detected!";O.trigger(L.KEY_SYSTEM_ACCESS_COMPLETE,{error:he}),pe({error:he})}})}function ve(Ae){return w=Ae.keySystem,Promise.resolve(w)}function _e(Ae){if(U!==Ae){if(U){De();for(var ge=0;ge<W.length;ge++)Se(W[ge]);W=[]}U=Ae,U&&(U.addEventListener(x.keyerror,J),U.addEventListener(x.needkey,J),U.addEventListener(x.keymessage,J),U.addEventListener(x.keyadded,J),O.trigger(L.VIDEO_ELEMENT_SELECTED))}}function Z(Ae){if(!w)throw new Error("Can not create sessions until you have selected a key system");if(Y||W.length===0){var ge={sessionId:null,keyId:Ae.keyId,initData:Ae.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return K.push(ge),U[x.generateKeyRequest](w.systemString,new Uint8Array(Ae.initData)),ge}else throw new Error("Multiple sessions not allowed!")}function Ee(Ae,ge){var pe=Ae.sessionId;if(!k.isClearKey(w))U[x.addKey](w.systemString,new Uint8Array(ge),new Uint8Array(Ae.initData),pe);else for(var Re=0;Re<ge.keyPairs.length;Re++)U[x.addKey](w.systemString,ge.keyPairs[Re].key,ge.keyPairs[Re].keyID,pe);O.trigger(L.KEY_SESSION_UPDATED)}function Se(Ae){try{U[x.cancelKeyRequest](w.systemString,Ae.sessionId)}catch(ge){O.trigger(L.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+Ae.sessionId+") "+ge.message})}}function Me(){}function de(){}function xe(){}function Fe(){return{handleEvent:function(ge){var pe=null;switch(ge.type){case x.needkey:var Re=ArrayBuffer.isView(ge.initData)?ge.initData.buffer:ge.initData;O.trigger(L.NEED_KEY,{key:new g.default(Re,"cenc")});break;case x.keyerror:if(pe=Le(W,ge.sessionId),pe||(pe=Le(K,ge.sessionId)),pe){var me=T.default.MEDIA_KEYERR_CODE,V="";switch(ge.errorCode.code){case 1:me=T.default.MEDIA_KEYERR_UNKNOWN_CODE,V+="MEDIA_KEYERR_UNKNOWN - "+T.default.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:me=T.default.MEDIA_KEYERR_CLIENT_CODE,V+="MEDIA_KEYERR_CLIENT - "+T.default.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:me=T.default.MEDIA_KEYERR_SERVICE_CODE,V+="MEDIA_KEYERR_SERVICE - "+T.default.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:me=T.default.MEDIA_KEYERR_OUTPUT_CODE,V+="MEDIA_KEYERR_OUTPUT - "+T.default.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:me=T.default.MEDIA_KEYERR_HARDWARECHANGE_CODE,V+="MEDIA_KEYERR_HARDWARECHANGE - "+T.default.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:me=T.default.MEDIA_KEYERR_DOMAIN_CODE,V+="MEDIA_KEYERR_DOMAIN - "+T.default.MEDIA_KEYERR_DOMAIN_MESSAGE;break}V+="  System Code = "+ge.systemCode,O.trigger(L.KEY_ERROR,{error:new v.default(me,V,pe)})}else I.error("No session token found for key error");break;case x.keyadded:pe=Le(W,ge.sessionId),pe||(pe=Le(K,ge.sessionId)),pe?(I.debug("DRM: Key added."),O.trigger(L.KEY_ADDED,{data:pe})):I.debug("No session token found for key added");break;case x.keymessage:if(Y=ge.sessionId!==null&&ge.sessionId!==void 0,Y?(pe=Le(W,ge.sessionId),!pe&&K.length>0&&(pe=K.shift(),W.push(pe),pe.sessionId=ge.sessionId,O.trigger(L.KEY_SESSION_CREATED,{data:pe}))):K.length>0&&(pe=K.shift(),W.push(pe),K.length!==0&&B.error(new v.default(T.default.MEDIA_KEY_MESSAGE_ERROR_CODE,T.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),pe){var j=ArrayBuffer.isView(ge.message)?ge.message.buffer:ge.message;pe.keyMessage=j,O.trigger(L.INTERNAL_KEY_MESSAGE,{data:new _.default(pe,j,ge.defaultURL)})}else I.warn("No session token found for key message");break}}}}function Le(Ae,ge){if(!ge||!Ae)return null;for(var pe=Ae.length,Re=0;Re<pe;Re++)if(Ae[Re].sessionId==ge)return Ae[Re];return null}function De(){U.removeEventListener(x.keyerror,J),U.removeEventListener(x.needkey,J),U.removeEventListener(x.keymessage,J),U.removeEventListener(x.keyadded,J)}return M={getAllInitData:ie,getSessions:Q,requestKeySystemAccess:se,selectKeySystem:ve,setMediaElement:_e,createKeySession:Z,updateKeySession:Ee,closeKeySession:Se,setServerCertificate:Me,loadKeySession:de,removeKeySession:xe,stop:ue,reset:ue},ee(),M}C.__dashjs_factory_name="ProtectionModel_01b";const R=dashjs.FactoryMaker.getClassFactory(C)},"./src/streaming/protection/models/ProtectionModel_21Jan2015.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>b});var m=d("./src/streaming/protection/controllers/ProtectionKeyController.js"),g=d("./src/streaming/protection/vo/NeedKey.js"),v=d("./src/streaming/protection/errors/ProtectionErrors.js"),_=d("./src/streaming/vo/DashJSError.js"),S=d("./src/streaming/protection/vo/KeyMessage.js"),E=d("./src/streaming/protection/vo/KeySystemAccess.js"),T=d("./src/streaming/constants/ProtectionConstants.js"),C={};C[T.default.PLAYREADY_KEYSTEM_STRING]=[T.default.PLAYREADY_KEYSTEM_STRING,T.default.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING],C[T.default.WIDEVINE_KEYSTEM_STRING]=[T.default.WIDEVINE_KEYSTEM_STRING],C[T.default.CLEARKEY_KEYSTEM_STRING]=[T.default.CLEARKEY_KEYSTEM_STRING];function R(F){F=F||{};var O=this.context,L=F.eventBus,D=F.events,x=F.debug,B,M,I,U,w,k,K,W;function Y(){M=x.getLogger(B),I=null,U=null,w=null,k=[],W=(0,m.default)(O).getInstance(),K=Ae()}function J(){var me=k.length,V;me!==0?function(){for(var j=function(oe){ge(oe),k.length===0&&(U?(U.removeEventListener("encrypted",K),U.setMediaKeys(null).then(function(){L.trigger(D.TEARDOWN_COMPLETE)})):L.trigger(D.TEARDOWN_COMPLETE))},$=0;$<me;$++)V=k[$],function(re){V.session.closed.then(function(){j(re)}),De(V).catch(function(){j(re)})}(V)}():L.trigger(D.TEARDOWN_COMPLETE)}function ee(){for(var me,V=0;V<k.length;V++)me=k[V],me.getUsable()||De(me).catch(function(){ge(me)})}function ue(){for(var me=[],V=0;V<k.length;V++)k[V].initData&&me.push(k[V].initData);return me}function ie(){return k}function Q(me){return new Promise(function(V,j){se(me,0,V,j)})}function se(me,V,j,$){if(navigator.requestMediaKeySystemAccess===void 0||typeof navigator.requestMediaKeySystemAccess!="function"){var re="Insecure origins are not allowed";L.trigger(D.KEY_SYSTEM_ACCESS_COMPLETE,{error:re}),$({error:re});return}var oe=me[V].protData&&me[V].protData.systemStringPriority?me[V].protData.systemStringPriority:null,X=me[V].configs,z=me[V].ks,ne=z.systemString,fe=oe||(C[ne]?C[ne]:[ne]);ve(fe,X).then(function(Ce){var Pe=typeof Ce.getConfiguration=="function"?Ce.getConfiguration():null,he=new E.default(z,Pe);he.mksa=Ce,L.trigger(D.KEY_SYSTEM_ACCESS_COMPLETE,{data:he}),j({data:he})}).catch(function(Ce){if(V+1<me.length)se(me,V+1,j,$);else{var Pe="Key system access denied! ";L.trigger(D.KEY_SYSTEM_ACCESS_COMPLETE,{error:Pe+Ce.message}),$({error:Pe+Ce.message})}})}function ve(me,V){return new Promise(function(j,$){_e(me,V,0,j,$)})}function _e(me,V,j,$,re){var oe=me[j];M.debug("Requesting key system access for system string ".concat(oe)),navigator.requestMediaKeySystemAccess(oe,V).then(function(X){X.selectedSystemString=oe,$(X)}).catch(function(X){j+1<me.length?_e(me,V,j+1,$,re):re(X)})}function Z(me){return new Promise(function(V,j){me.mksa.createMediaKeys().then(function($){return I=me.keySystem,w=$,U?U.setMediaKeys(w):Promise.resolve()}).then(function(){V(I)}).catch(function(){j({error:"Error selecting keys system ("+me.keySystem.systemString+")! Could not create MediaKeys -- TODO"})})})}function Ee(me){U!==me&&(U&&(U.removeEventListener("encrypted",K),U.setMediaKeys&&U.setMediaKeys(null)),U=me,U&&(U.addEventListener("encrypted",K),U.setMediaKeys&&w&&U.setMediaKeys(w)))}function Se(me){if(!I||!w)throw new Error("Can not set server certificate until you have selected a key system");w.setServerCertificate(me).then(function(){M.info("DRM: License server certificate successfully updated."),L.trigger(D.SERVER_CERTIFICATE_UPDATED)}).catch(function(V){L.trigger(D.SERVER_CERTIFICATE_UPDATED,{error:new _.default(v.default.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,v.default.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+V.name)})})}function Me(me){if(!I||!w)throw new Error("Can not create sessions until you have selected a key system");var V=w.createSession(me.sessionType),j=Re(V,me),$=I.systemString===T.default.CLEARKEY_KEYSTEM_STRING&&(me.initData||me.protData&&me.protData.clearkeys)?T.default.INITIALIZATION_DATA_TYPE_KEYIDS:T.default.INITIALIZATION_DATA_TYPE_CENC;V.generateRequest($,me.initData).then(function(){M.debug("DRM: Session created.  SessionID = "+j.getSessionId()),L.trigger(D.KEY_SESSION_CREATED,{data:j})}).catch(function(re){ge(j),L.trigger(D.KEY_SESSION_CREATED,{data:null,error:new _.default(v.default.KEY_SESSION_CREATED_ERROR_CODE,v.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+re.name)})})}function de(me,V){var j=me.session;W.isClearKey(I)&&(V=V.toJWK()),j.update(V).then(function(){L.trigger(D.KEY_SESSION_UPDATED)}).catch(function($){L.trigger(D.KEY_ERROR,{error:new _.default(v.default.MEDIA_KEYERR_CODE,"Error sending update() message! "+$.name,me)})})}function xe(me){if(!I||!w)throw new Error("Can not load sessions until you have selected a key system");for(var V=me.sessionId,j=0;j<k.length;j++)if(V===k[j].sessionId){M.warn("DRM: Ignoring session ID because we have already seen it!");return}var $=w.createSession(me.sessionType),re=Re($,me);$.load(V).then(function(oe){oe?(M.debug("DRM: Session loaded.  SessionID = "+re.getSessionId()),L.trigger(D.KEY_SESSION_CREATED,{data:re})):(ge(re),L.trigger(D.KEY_SESSION_CREATED,{data:null,error:new _.default(v.default.KEY_SESSION_CREATED_ERROR_CODE,v.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+V+")")}))}).catch(function(oe){ge(re),L.trigger(D.KEY_SESSION_CREATED,{data:null,error:new _.default(v.default.KEY_SESSION_CREATED_ERROR_CODE,v.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+V+")! "+oe.name)})})}function Fe(me){var V=me.session;V.remove().then(function(){M.debug("DRM: Session removed.  SessionID = "+me.getSessionId()),L.trigger(D.KEY_SESSION_REMOVED,{data:me.getSessionId()})},function(j){L.trigger(D.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+me.getSessionId()+"). "+j.name})})}function Le(me){De(me).catch(function(V){ge(me),L.trigger(D.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+me.getSessionId()+") "+V.name})})}function De(me){var V=me.session;return V.removeEventListener("keystatuseschange",me),V.removeEventListener("message",me),V.close()}function Ae(){return{handleEvent:function(V){switch(V.type){case"encrypted":if(V.initData){var j=ArrayBuffer.isView(V.initData)?V.initData.buffer:V.initData;L.trigger(D.NEED_KEY,{key:new g.default(j,V.initDataType)})}break}}}}function ge(me){for(var V=0;V<k.length;V++)if(k[V]===me){k.splice(V,1);break}}function pe(me){var V,j;return me&&me.length>0&&(me[0]&&(typeof me[0]=="string"?V=me[0]:j=me[0]),me[1]&&(typeof me[1]=="string"?V=me[1]:j=me[1])),{status:V,keyId:j}}function Re(me,V){var j={session:me,keyId:V.keyId,initData:V.initData,sessionId:V.sessionId,sessionType:V.sessionType,handleEvent:function(re){switch(re.type){case"keystatuseschange":L.trigger(D.KEY_STATUSES_CHANGED,{data:this}),re.target.keyStatuses.forEach(function(){var X=pe(arguments);switch(X.status){case"expired":L.trigger(D.INTERNAL_KEY_STATUS_CHANGED,{error:new _.default(v.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,v.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)});break;default:L.trigger(D.INTERNAL_KEY_STATUS_CHANGED,X);break}});break;case"message":var oe=ArrayBuffer.isView(re.message)?re.message.buffer:re.message;L.trigger(D.INTERNAL_KEY_MESSAGE,{data:new S.default(this,oe,void 0,re.messageType)});break}},getKeyId:function(){return this.keyId},getSessionId:function(){return me.sessionId},getSessionType:function(){return this.sessionType},getExpirationTime:function(){return me.expiration},getKeyStatuses:function(){return me.keyStatuses},getUsable:function(){var re=!1;return me.keyStatuses.forEach(function(){var oe=pe(arguments);oe.status==="usable"&&(re=!0)}),re}};return me.addEventListener("keystatuseschange",j),me.addEventListener("message",j),me.closed.then(function(){ge(j),M.debug("DRM: Session closed.  SessionID = "+j.getSessionId()),L.trigger(D.KEY_SESSION_CLOSED,{data:j.getSessionId()})}),k.push(j),j}return B={getAllInitData:ue,getSessions:ie,requestKeySystemAccess:Q,selectKeySystem:Z,setMediaElement:Ee,setServerCertificate:Se,createKeySession:Me,updateKeySession:de,loadKeySession:xe,removeKeySession:Fe,closeKeySession:Le,stop:ee,reset:J},Y(),B}R.__dashjs_factory_name="ProtectionModel_21Jan2015";const b=dashjs.FactoryMaker.getClassFactory(R)},"./src/streaming/protection/models/ProtectionModel_3Feb2014.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>R});var m=d("./src/streaming/protection/controllers/ProtectionKeyController.js"),g=d("./src/streaming/protection/vo/NeedKey.js"),v=d("./src/streaming/vo/DashJSError.js"),_=d("./src/streaming/protection/errors/ProtectionErrors.js"),S=d("./src/streaming/protection/vo/KeyMessage.js"),E=d("./src/streaming/protection/vo/KeySystemConfiguration.js"),T=d("./src/streaming/protection/vo/KeySystemAccess.js");function C(b){b=b||{};var F=this.context,O=b.eventBus,L=b.events,D=b.debug,x=b.api,B,M,I,U,w,k,K,W,Y;function J(){M=D.getLogger(B),I=null,U=null,w=null,k=null,K=[],Y=(0,m.default)(F).getInstance(),W=xe()}function ee(){try{for(var De=0;De<K.length;De++)Ee(K[De]);I&&I.removeEventListener(x.needkey,W),O.trigger(L.TEARDOWN_COMPLETE)}catch(Ae){O.trigger(L.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+Ae.message})}}function ue(){for(var De=[],Ae=0;Ae<K.length;Ae++)De.push(K[Ae].initData);return De}function ie(){return K}function Q(De){return new Promise(function(Ae,ge){for(var pe=!1,Re=0;Re<De.length;Re++)for(var me=De[Re].ks.systemString,V=De[Re].configs,j=null,$=null,re=0;re<V.length;re++){var oe=V[re].audioCapabilities,X=V[re].videoCapabilities;if(oe&&oe.length!==0){j=[];for(var z=0;z<oe.length;z++)window[x.MediaKeys].isTypeSupported(me,oe[z].contentType)&&j.push(oe[z])}if(X&&X.length!==0){$=[];for(var ne=0;ne<X.length;ne++)window[x.MediaKeys].isTypeSupported(me,X[ne].contentType)&&$.push(X[ne])}if(!(!j&&!$||j&&j.length===0||$&&$.length===0)){pe=!0;var fe=new E.default(j,$),Ce=Y.getKeySystemBySystemString(me),Pe=new T.default(Ce,fe);O.trigger(L.KEY_SYSTEM_ACCESS_COMPLETE,{data:Pe}),Ae({data:Pe});break}}if(!pe){var he="Key system access denied! -- No valid audio/video content configurations detected!";O.trigger(L.KEY_SYSTEM_ACCESS_COMPLETE,{error:he}),ge({error:he})}})}function se(De){return new Promise(function(Ae,ge){try{w=De.mediaKeys=new window[x.MediaKeys](De.keySystem.systemString),U=De.keySystem,k=De,I&&Fe(),Ae(U)}catch{ge({error:"Error selecting keys system ("+U.systemString+")! Could not create MediaKeys -- TODO"})}})}function ve(De){I!==De&&(I&&I.removeEventListener(x.needkey,W),I=De,I&&(I.addEventListener(x.needkey,W),w&&Fe()))}function _e(De){if(!U||!w||!k)throw new Error("Can not create sessions until you have selected a key system");var Ae=null;if(k.ksConfiguration.videoCapabilities&&k.ksConfiguration.videoCapabilities.length>0&&(Ae=k.ksConfiguration.videoCapabilities[0]),Ae===null&&k.ksConfiguration.audioCapabilities&&k.ksConfiguration.audioCapabilities.length>0&&(Ae=k.ksConfiguration.audioCapabilities[0]),Ae===null)throw new Error("Can not create sessions for unknown content types.");var ge=Ae.contentType,pe=w.createSession(ge,new Uint8Array(De.initData),De.cdmData?new Uint8Array(De.cdmData):null),Re=Le(pe,De);pe.addEventListener(x.error,Re),pe.addEventListener(x.message,Re),pe.addEventListener(x.ready,Re),pe.addEventListener(x.close,Re),K.push(Re),M.debug("DRM: Session created.  SessionID = "+Re.getSessionId()),O.trigger(L.KEY_SESSION_CREATED,{data:Re})}function Z(De,Ae){var ge=De.session;Y.isClearKey(U)?ge.update(new Uint8Array(Ae.toJWK())):ge.update(new Uint8Array(Ae)),O.trigger(L.KEY_SESSION_UPDATED)}function Ee(De){var Ae=De.session;Ae.removeEventListener(x.error,De),Ae.removeEventListener(x.message,De),Ae.removeEventListener(x.ready,De),Ae.removeEventListener(x.close,De);for(var ge=0;ge<K.length;ge++)if(K[ge]===De){K.splice(ge,1);break}Ae[x.release]()}function Se(){}function Me(){}function de(){}function xe(){return{handleEvent:function(Ae){switch(Ae.type){case x.needkey:if(Ae.initData){var ge=ArrayBuffer.isView(Ae.initData)?Ae.initData.buffer:Ae.initData;O.trigger(L.NEED_KEY,{key:new g.default(ge,"cenc")})}break}}}}function Fe(){var De=null,Ae=function(){I.removeEventListener("loadedmetadata",De),I[x.setMediaKeys](w),O.trigger(L.VIDEO_ELEMENT_SELECTED)};I.readyState>=1?Ae():(De=Ae.bind(this),I.addEventListener("loadedmetadata",De))}function Le(De,Ae){return{session:De,keyId:Ae.keyId,initData:Ae.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(pe){switch(pe.type){case x.error:var Re="KeyError";O.trigger(L.KEY_ERROR,{error:new v.default(_.default.MEDIA_KEYERR_CODE,Re,this)});break;case x.message:var me=ArrayBuffer.isView(pe.message)?pe.message.buffer:pe.message;O.trigger(L.INTERNAL_KEY_MESSAGE,{data:new S.default(this,me,pe.destinationURL)});break;case x.ready:M.debug("DRM: Key added."),O.trigger(L.KEY_ADDED);break;case x.close:M.debug("DRM: Session closed.  SessionID = "+this.getSessionId()),O.trigger(L.KEY_SESSION_CLOSED,{data:this.getSessionId()});break}}}}return B={getAllInitData:ue,getSessions:ie,requestKeySystemAccess:Q,selectKeySystem:se,setMediaElement:ve,createKeySession:_e,updateKeySession:Z,closeKeySession:Ee,setServerCertificate:Se,loadKeySession:Me,removeKeySession:de,stop:ee,reset:ee},J(),B}C.__dashjs_factory_name="ProtectionModel_3Feb2014";const R=dashjs.FactoryMaker.getClassFactory(C)},"./src/streaming/protection/servers/ClearKey.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});var m=d("./src/streaming/protection/vo/KeyPair.js"),g=d("./src/streaming/protection/vo/ClearKeyKeySet.js");function v(){var S;function E(F){return F}function T(){return"POST"}function C(){return"json"}function R(F){if(!F.hasOwnProperty("keys"))return null;for(var O=[],L=0;L<F.keys.length;L++){var D=F.keys[L],x=D.kid.replace(/=/g,""),B=D.k.replace(/=/g,"");O.push(new m.default(x,B))}return new g.default(O)}function b(F){return String.fromCharCode.apply(null,new Uint8Array(F))}return S={getServerURLFromMessage:E,getHTTPMethod:T,getResponseType:C,getLicenseMessage:R,getErrorResponse:b},S}v.__dashjs_factory_name="ClearKey";const _=dashjs.FactoryMaker.getSingletonFactory(v)},"./src/streaming/protection/servers/DRMToday.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/streaming/constants/ProtectionConstants.js");function g(_){_=_||{};var S=_.BASE64,E={};E[m.default.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(x){return S.decodeArray(x.license)},getErrorResponse:function(x){return x}},E[m.default.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(x){return x},getErrorResponse:function(x){return String.fromCharCode.apply(null,new Uint8Array(x))}};var T;function C(){if(!S||!S.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}function R(D){return D}function b(){return"POST"}function F(D){return E[D].responseType}function O(D,x){return C(),E[x].getLicenseMessage(D)}function L(D,x){return E[x].getErrorResponse(D)}return T={getServerURLFromMessage:R,getHTTPMethod:b,getResponseType:F,getLicenseMessage:O,getErrorResponse:L},T}g.__dashjs_factory_name="DRMToday";const v=dashjs.FactoryMaker.getSingletonFactory(g)},"./src/streaming/protection/servers/PlayReady.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/core/FactoryMaker.js");function g(){var _,S="http://schemas.xmlsoap.org/soap/envelope/";function E(D){var x=String.fromCharCode.apply(null,new Uint8Array(D)),B=decodeURIComponent(escape(x));return B}function T(D){if(window.DOMParser){var x=E(D),B=new window.DOMParser,M=B.parseFromString(x,"text/xml"),I=M?M.getElementsByTagNameNS(S,"Envelope")[0]:null,U=I?I.getElementsByTagNameNS(S,"Body")[0]:null,w=U?U.getElementsByTagNameNS(S,"Fault")[0]:null;if(w)return null}return D}function C(D){var x="",B="",M="",I=-1,U=-1;if(window.DOMParser){var w=E(D),k=new window.DOMParser,K=k.parseFromString(w,"text/xml"),W=K?K.getElementsByTagNameNS(S,"Envelope")[0]:null,Y=W?W.getElementsByTagNameNS(S,"Body")[0]:null,J=Y?Y.getElementsByTagNameNS(S,"Fault")[0]:null,ee=J?J.getElementsByTagName("detail")[0]:null,ue=ee?ee.getElementsByTagName("Exception")[0]:null,ie=null;if(J===null)return w;ie=J.getElementsByTagName("faultstring")[0].firstChild,x=ie?ie.nodeValue:null,ue!==null&&(ie=ue.getElementsByTagName("StatusCode")[0],B=ie?ie.firstChild.nodeValue:null,ie=ue.getElementsByTagName("Message")[0],M=ie?ie.firstChild.nodeValue:null,I=M?M.lastIndexOf("[")+1:-1,U=M?M.indexOf("]"):-1,M=M?M.substring(I,U):"")}var Q="code: ".concat(B,", name: ").concat(x);return M&&(Q+=", message: ".concat(M)),Q}function R(D){return D}function b(){return"POST"}function F(){return"arraybuffer"}function O(D){return T.call(this,D)}function L(D){return C.call(this,D)}return _={getServerURLFromMessage:R,getHTTPMethod:b,getResponseType:F,getLicenseMessage:O,getErrorResponse:L},_}g.__dashjs_factory_name="PlayReady";const v=m.default.getSingletonFactory(g)},"./src/streaming/protection/servers/Widevine.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>g});function m(){var v;function _(R){return R}function S(){return"POST"}function E(){return"arraybuffer"}function T(R){return R}function C(R){return String.fromCharCode.apply(null,new Uint8Array(R))}return v={getServerURLFromMessage:_,getHTTPMethod:S,getResponseType:E,getLicenseMessage:T,getErrorResponse:C},v}m.__dashjs_factory_name="Widevine";const g=dashjs.FactoryMaker.getSingletonFactory(m)},"./src/streaming/protection/vo/ClearKeyKeySet.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});function m(E,T){if(!(E instanceof T))throw new TypeError("Cannot call a class as a function")}function g(E,T){for(var C=0;C<T.length;C++){var R=T[C];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(E,R.key,R)}}function v(E,T,C){return T&&g(E.prototype,T),C&&g(E,C),E}var _=function(){function E(T,C){if(m(this,E),C&&C!=="persistent"&&C!=="temporary")throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=T,this.type=C}return v(E,[{key:"toJWK",value:function(){var C,R=this.keyPairs.length,b={keys:[]};for(C=0;C<R;C++){var F={kty:"oct",alg:"A128KW",kid:this.keyPairs[C].keyID,k:this.keyPairs[C].key};b.keys.push(F)}this.type&&(b.type=this.type);var O=JSON.stringify(b),L=O.length,D=new ArrayBuffer(L),x=new Uint8Array(D);for(C=0;C<L;C++)x[C]=O.charCodeAt(C);return D}}]),E}();const S=_},"./src/streaming/protection/vo/KeyMessage.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(S,E,T,C){m(this,_),this.sessionToken=S,this.message=E,this.defaultURL=T,this.messageType=C||"license-request"};const v=g},"./src/streaming/protection/vo/KeyPair.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(S,E){m(this,_),this.keyID=S,this.key=E};const v=g},"./src/streaming/protection/vo/KeySystemAccess.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(S,E){m(this,_),this.keySystem=S,this.ksConfiguration=E};const v=g},"./src/streaming/protection/vo/KeySystemConfiguration.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(S,E,T,C,R){m(this,_),this.initDataTypes=["cenc"],S&&S.length&&(this.audioCapabilities=S),E&&E.length&&(this.videoCapabilities=E),this.distinctiveIdentifier=T,this.persistentState=C,this.sessionTypes=R};const v=g},"./src/streaming/protection/vo/LicenseRequest.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(S,E,T,C,R,b,F,O){m(this,_),this.url=S,this.method=E,this.responseType=T,this.headers=C,this.withCredentials=R,this.messageType=b,this.sessionId=F,this.data=O};const v=g},"./src/streaming/protection/vo/LicenseResponse.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(S,E,T){m(this,_),this.url=S,this.headers=E,this.data=T};const v=g},"./src/streaming/protection/vo/MediaCapability.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(S,E){m(this,_),this.contentType=S,this.robustness=E};const v=g},"./src/streaming/protection/vo/NeedKey.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(S,E){m(this,_),this.initData=S,this.initDataType=E};const v=g},"./src/streaming/rules/DroppedFramesHistory.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});var m=d("./src/core/FactoryMaker.js");function g(){var S={},E={},T={};function C(O,L,D){if(L){S[O]||(S[O]=[],E[O]=0,T[O]=0);var x=D&&D.droppedVideoFrames?D.droppedVideoFrames:0,B=D&&D.totalVideoFrames?D.totalVideoFrames:0,M=x-E[O];E[O]=x;var I=B-T[O];T[O]=B;var U=S[O];isNaN(L)||(U[L]?(U[L].droppedVideoFrames+=M,U[L].totalVideoFrames+=I):U[L]={droppedVideoFrames:M,totalVideoFrames:I})}}function R(O){return S[O]}function b(O){try{delete S[O],delete E[O],delete T[O]}catch{}}function F(){S={},E={},T={}}return{push:C,getFrameHistory:R,clearForStream:b,reset:F}}g.__dashjs_factory_name="DroppedFramesHistory";var v=m.default.getClassFactory(g);const _=v},"./src/streaming/rules/RulesContext.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/core/FactoryMaker.js");function g(_){_=_||{};var S,E=_.abrController,T=_.switchHistory,C=_.droppedFramesHistory,R=_.currentRequest,b=_.useBufferOccupancyABR,F=_.useL2AABR,O=_.useLoLPABR,L=_.streamProcessor?_.streamProcessor.getScheduleController():null,D=_.streamProcessor?_.streamProcessor.getRepresentationInfo():null,x=_.videoModel?_.videoModel:null;function B(){var Q=I();return Q?Q.type:null}function M(){var Q=I();return Q?Q.streamInfo:null}function I(){return D?D.mediaInfo:null}function U(){return D}function w(){return L}function k(){return E}function K(){return T}function W(){return x}function Y(){return C}function J(){return R}function ee(){return b}function ue(){return F}function ie(){return O}return S={getMediaType:B,getMediaInfo:I,getDroppedFramesHistory:Y,getCurrentRequest:J,getSwitchHistory:K,getStreamInfo:M,getScheduleController:w,getAbrController:k,getRepresentationInfo:U,useBufferOccupancyABR:ee,useL2AABR:ue,useLoLPABR:ie,getVideoModel:W},S}g.__dashjs_factory_name="RulesContext";const v=m.default.getClassFactory(g)},"./src/streaming/rules/SwitchRequest.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});var m=d("./src/core/FactoryMaker.js"),g=-1,v={DEFAULT:.5,STRONG:1,WEAK:0};function _(T,C,R){var b,F,O,L;function D(x){var B=v.DEFAULT;return(x===v.DEFAULT||x===v.STRONG||x===v.WEAK)&&(B=x),B}return F=T===void 0?g:T,O=D(R),L=C===void 0?null:C,b={quality:F,reason:L,priority:O},b}_.__dashjs_factory_name="SwitchRequest";var S=m.default.getClassFactory(_);S.NO_CHANGE=g,S.PRIORITY=v,m.default.updateClassFactory(_.__dashjs_factory_name,S);const E=S},"./src/streaming/rules/SwitchRequestHistory.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/rules/SwitchRequest.js"),v=8;function _(){var T=[],C=[];function R(O){O.newValue===g.default.NO_CHANGE&&(O.newValue=O.oldValue),T[O.oldValue]||(T[O.oldValue]={noDrops:0,drops:0,dropSize:0});var L=O.newValue-O.oldValue,D=L<0?1:0,x=D?-L:0,B=D?0:1;if(T[O.oldValue].drops+=D,T[O.oldValue].dropSize+=x,T[O.oldValue].noDrops+=B,C.push({idx:O.oldValue,noDrop:B,drop:D,dropSize:x}),C.length>v){var M=C.shift();T[M.idx].drops-=M.drop,T[M.idx].dropSize-=M.dropSize,T[M.idx].noDrops-=M.noDrop}}function b(){return T}function F(){T=[],C=[]}return{push:R,getSwitchRequests:b,reset:F}}_.__dashjs_factory_name="SwitchRequestHistory";var S=m.default.getClassFactory(_);const E=S},"./src/streaming/rules/ThroughputHistory.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/core/FactoryMaker.js");function v(S){S=S||{};var E=20,T=3,C=4,R=4,b=1.3,F=1.3,O=8,L=3,D=2,x=1,B=S.settings,M,I,U,w,k;function K(){k={throughputHalfLife:{fast:L,slow:O},latencyHalfLife:{fast:x,slow:D}},Se()}function W(de,xe,Fe){if(de===m.default.VIDEO)return Fe<B.get().streaming.cacheLoadThresholds[m.default.VIDEO];if(de===m.default.AUDIO)return Fe<B.get().streaming.cacheLoadThresholds[m.default.AUDIO]}function Y(de,xe,Fe){if(!(!xe.trace||!xe.trace.length)){var Le=xe.tresponse.getTime()-xe.trequest.getTime()||1,De=xe._tfinish.getTime()-xe.tresponse.getTime()||1,Ae=xe.trace.reduce(function(V,j){return V+j.b[0]},0),ge=0,pe=0;if(xe._fileLoaderType&&xe._fileLoaderType===m.default.FILE_LOADER_TYPES.FETCH?ge=xe.trace.reduce(function(V,j){return V+j.d},0):ge=Fe?De:Le+De,ge!==0&&(pe=Math.round(8*Ae/ge)),xe.cmsd){var Re=xe.cmsd.dynamic&&xe.cmsd.dynamic.etp?xe.cmsd.dynamic.etp:null;if(Re){var me=B.get().streaming.cmsd.abr.etpWeightRatio;me>0&&me<=1&&(pe=pe*(1-me)+Re*me)}}if(Z(de),W(de,Le,De)){if(M[de].length>0&&!M[de].hasCachedEntries)return;M[de].hasCachedEntries=!0}else M[de]&&M[de].hasCachedEntries&&Ee(de);M[de].push(pe),M[de].length>E&&M[de].shift(),I[de].push(Le),I[de].length>E&&I[de].shift(),J(U[de],pe,.001*De,k.throughputHalfLife),J(w[de],Le,1,k.latencyHalfLife)}}function J(de,xe,Fe,Le){var De=Math.pow(.5,Fe/Le.fast);de.fastEstimate=(1-De)*xe+De*de.fastEstimate;var Ae=Math.pow(.5,Fe/Le.slow);de.slowEstimate=(1-Ae)*xe+Ae*de.slowEstimate,de.totalWeight+=Fe}function ee(de,xe,Fe){var Le,De;if(de?(Le=M[xe],De=Fe?T:C):(Le=I[xe],De=R),!Le)De=0;else if(De>=Le.length)De=Le.length;else if(de)for(var Ae=1;Ae<De;++Ae){var ge=Le[Le.length-Ae]/Le[Le.length-Ae-1];if((ge>=F||ge<=1/b)&&(De+=1,De===Le.length))break}return De}function ue(de,xe,Fe){return B.get().streaming.abr.movingAverageMethod!==m.default.MOVING_AVERAGE_SLIDING_WINDOW?Q(de,xe):ie(de,xe,Fe)}function ie(de,xe,Fe){var Le=ee(de,xe,Fe),De=de?M:I,Ae=De[xe];return Le===0||!Ae||Ae.length===0?NaN:(Ae=Ae.slice(-Le),Ae.reduce(function(ge,pe){return ge+pe})/Ae.length)}function Q(de,xe){var Fe=de?k.throughputHalfLife:k.latencyHalfLife,Le=de?U[xe]:w[xe];if(!Le||Le.totalWeight<=0)return NaN;var De=Le.fastEstimate/(1-Math.pow(.5,Le.totalWeight/Fe.fast)),Ae=Le.slowEstimate/(1-Math.pow(.5,Le.totalWeight/Fe.slow));return de?Math.min(De,Ae):Math.max(De,Ae)}function se(de,xe){return ue(!0,de,xe)}function ve(de,xe){var Fe=se(de,xe);return isNaN(Fe)||(Fe*=B.get().streaming.abr.bandwidthSafetyFactor),Fe}function _e(de){return ue(!1,de)}function Z(de){M[de]=M[de]||[],I[de]=I[de]||[],U[de]=U[de]||{fastEstimate:0,slowEstimate:0,totalWeight:0},w[de]=w[de]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function Ee(de){delete M[de],delete I[de],delete U[de],delete w[de],Z(de)}function Se(){M={},I={},U={},w={}}var Me={push:Y,getAverageThroughput:se,getSafeAverageThroughput:ve,getAverageLatency:_e,reset:Se};return K(),Me}v.__dashjs_factory_name="ThroughputHistory";const _=g.default.getClassFactory(v)},"./src/streaming/rules/abr/ABRRulesCollection.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>B});var m=d("./src/streaming/rules/abr/ThroughputRule.js"),g=d("./src/streaming/rules/abr/InsufficientBufferRule.js"),v=d("./src/streaming/rules/abr/AbandonRequestsRule.js"),_=d("./src/streaming/rules/abr/DroppedFramesRule.js"),S=d("./src/streaming/rules/abr/SwitchHistoryRule.js"),E=d("./src/streaming/rules/abr/BolaRule.js"),T=d("./src/streaming/rules/abr/L2ARule.js"),C=d("./src/streaming/rules/abr/lolp/LoLpRule.js"),R=d("./src/core/FactoryMaker.js"),b=d("./src/streaming/rules/SwitchRequest.js"),F=d("./src/streaming/constants/Constants.js"),O="qualitySwitchRules",L="abandonFragmentRules";function D(M){M=M||{};var I=this.context,U=M.mediaPlayerModel,w=M.customParametersModel,k=M.dashMetrics,K=M.settings,W,Y,J;function ee(){Y=[],J=[],K.get().streaming.abr.useDefaultABRRules&&(K.get().streaming.abr.ABRStrategy===F.default.ABR_STRATEGY_L2A?Y.push((0,T.default)(I).create({dashMetrics:k,settings:K})):K.get().streaming.abr.ABRStrategy===F.default.ABR_STRATEGY_LoLP?Y.push((0,C.default)(I).create({dashMetrics:k})):(Y.push((0,E.default)(I).create({dashMetrics:k,mediaPlayerModel:U,settings:K})),Y.push((0,m.default)(I).create({dashMetrics:k})),K.get().streaming.abr.additionalAbrRules.insufficientBufferRule&&Y.push((0,g.default)(I).create({dashMetrics:k,settings:K})),K.get().streaming.abr.additionalAbrRules.switchHistoryRule&&Y.push((0,S.default)(I).create()),K.get().streaming.abr.additionalAbrRules.droppedFramesRule&&Y.push((0,_.default)(I).create()),K.get().streaming.abr.additionalAbrRules.abandonRequestsRule&&J.push((0,v.default)(I).create({dashMetrics:k,mediaPlayerModel:U,settings:K}))));var Z=w.getAbrCustomRules();Z.forEach(function(Ee){Ee.type===O&&Y.push(Ee.rule(I).create()),Ee.type===L&&J.push(Ee.rule(I).create())})}function ue(Z){return Z.filter(function(Ee){return Ee.quality>b.default.NO_CHANGE})}function ie(Z){var Ee={},Se=null,Me,de,xe,Fe,Le;if(Z.length!==0){for(Ee[b.default.PRIORITY.STRONG]={quality:b.default.NO_CHANGE,reason:null},Ee[b.default.PRIORITY.WEAK]={quality:b.default.NO_CHANGE,reason:null},Ee[b.default.PRIORITY.DEFAULT]={quality:b.default.NO_CHANGE,reason:null},Me=0,de=Z.length;Me<de;Me+=1)xe=Z[Me],xe.quality!==b.default.NO_CHANGE&&(Ee[xe.priority].quality===b.default.NO_CHANGE||Ee[xe.priority].quality>xe.quality)&&(Ee[xe.priority].quality=xe.quality,Ee[xe.priority].reason=xe.reason||null);return Ee[b.default.PRIORITY.WEAK].quality!==b.default.NO_CHANGE&&(Se=Ee[b.default.PRIORITY.WEAK]),Ee[b.default.PRIORITY.DEFAULT].quality!==b.default.NO_CHANGE&&(Se=Ee[b.default.PRIORITY.DEFAULT]),Ee[b.default.PRIORITY.STRONG].quality!==b.default.NO_CHANGE&&(Se=Ee[b.default.PRIORITY.STRONG]),Se&&(Fe=Se.quality,Le=Se.reason),(0,b.default)(I).create(Fe,Le)}}function Q(Z){var Ee=Y.map(function(de){return de.getMaxIndex(Z)}),Se=ue(Ee),Me=ie(Se);return Me||(0,b.default)(I).create()}function se(Z,Ee){var Se=J.map(function(xe){return xe.shouldAbandon(Z,Ee)}),Me=ue(Se),de=ie(Me);return de||(0,b.default)(I).create()}function ve(){[Y,J].forEach(function(Z){Z&&Z.length&&Z.forEach(function(Ee){return Ee.reset&&Ee.reset()})}),Y=[],J=[]}function _e(){return Y}return W={initialize:ee,reset:ve,getMaxQuality:Q,getMinSwitchRequest:ie,shouldAbandonFragment:se,getQualitySwitchRules:_e},W}D.__dashjs_factory_name="ABRRulesCollection";var x=R.default.getClassFactory(D);x.QUALITY_SWITCH_RULES=O,x.ABANDON_FRAGMENT_RULES=L,R.default.updateSingletonFactory(D.__dashjs_factory_name,x);const B=x},"./src/streaming/rules/abr/AbandonRequestsRule.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/streaming/rules/SwitchRequest.js"),g=d("./src/core/FactoryMaker.js"),v=d("./src/core/Debug.js");function _(E){E=E||{};var T=1.8,C=500,R=5,b=this.context,F=E.mediaPlayerModel,O=E.dashMetrics,L=E.settings,D,x,B,M,I;function U(){x=(0,v.default)(b).getInstance().getLogger(D),W()}function w(Y,J){B[Y]=B[Y]||{},B[Y][J]=B[Y][J]||{}}function k(Y,J){I[Y]=I[Y]||[],I[Y].push(J)}function K(Y){var J=(0,m.default)(b).create(m.default.NO_CHANGE,{name:_.__dashjs_factory_name});if(!Y||!Y.hasOwnProperty("getMediaInfo")||!Y.hasOwnProperty("getMediaType")||!Y.hasOwnProperty("getCurrentRequest")||!Y.hasOwnProperty("getRepresentationInfo")||!Y.hasOwnProperty("getAbrController"))return J;var ee=Y.getMediaInfo(),ue=Y.getMediaType(),ie=Y.getStreamInfo(),Q=ie?ie.id:null,se=Y.getCurrentRequest();if(!isNaN(se.index)){w(ue,se.index);var ve=F.getStableBufferTime(),_e=O.getCurrentBufferLevel(ue);if(_e>ve)return J;var Z=B[ue][se.index];if(Z===null||se.firstByteDate===null||M.hasOwnProperty(Z.id))return J;if(Z.firstByteTime===void 0&&(I[ue]=[],Z.firstByteTime=se.firstByteDate.getTime(),Z.segmentDuration=se.duration,Z.bytesTotal=se.bytesTotal,Z.id=se.index),Z.bytesLoaded=se.bytesLoaded,Z.elapsedTime=new Date().getTime()-Z.firstByteTime,Z.bytesLoaded>0&&Z.elapsedTime>0&&k(ue,Math.round(Z.bytesLoaded*8/Z.elapsedTime)),I[ue].length>=R&&Z.elapsedTime>C&&Z.bytesLoaded<Z.bytesTotal){var Ee=I[ue].reduce(function(Ae,ge){return Ae+ge},0);if(Z.measuredBandwidthInKbps=Math.round(Ee/I[ue].length),Z.estimatedTimeOfDownload=+(Z.bytesTotal*8/Z.measuredBandwidthInKbps/1e3).toFixed(2),Z.estimatedTimeOfDownload<Z.segmentDuration*T||Y.getRepresentationInfo().quality===0)return J;if(!M.hasOwnProperty(Z.id)){var Se=Y.getAbrController(),Me=Z.bytesTotal-Z.bytesLoaded,de=Se.getBitrateList(ee),xe=Se.getQualityForBitrate(ee,Z.measuredBandwidthInKbps*L.get().streaming.abr.bandwidthSafetyFactor,Q),Fe=Se.getMinAllowedIndexFor(ue,Q),Le=Fe!==void 0?Math.max(Fe,xe):xe,De=Z.bytesTotal*de[Le].bitrate/de[Se.getQualityFor(ue,Q)].bitrate;Me>De&&(J.quality=Le,J.reason.throughput=Z.measuredBandwidthInKbps,J.reason.fragmentID=Z.id,M[Z.id]=Z,x.debug("["+ue+"] frag id",Z.id," is asking to abandon and switch to quality to ",Le," measured bandwidth was",Z.measuredBandwidthInKbps),delete B[ue][Z.id])}}else Z.bytesLoaded===Z.bytesTotal&&delete B[ue][Z.id]}return J}function W(){B={},M={},I=[]}return D={shouldAbandon:K,reset:W},U(),D}_.__dashjs_factory_name="AbandonRequestsRule";const S=g.default.getClassFactory(_)},"./src/streaming/rules/abr/BolaRule.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>M});var m=d("./src/streaming/constants/MetricsConstants.js"),g=d("./src/streaming/rules/SwitchRequest.js"),v=d("./src/core/FactoryMaker.js"),_=d("./src/streaming/vo/metrics/HTTPRequest.js"),S=d("./src/core/EventBus.js"),E=d("./src/core/events/Events.js"),T=d("./src/core/Debug.js"),C=d("./src/streaming/MediaPlayerEvents.js"),R=d("./src/streaming/constants/Constants.js"),b=0,F=1,O=2,L=10,D=2,x=.99;function B(I){I=I||{};var U=this.context,w=I.dashMetrics,k=I.mediaPlayerModel,K=(0,S.default)(U).getInstance(),W,Y,J;function ee(){Y=(0,T.default)(U).getInstance().getLogger(W),Re(),K.on(C.default.BUFFER_EMPTY,de,W),K.on(C.default.PLAYBACK_SEEKING,xe,W),K.on(C.default.METRIC_ADDED,Le,W),K.on(C.default.QUALITY_CHANGE_REQUESTED,Ae,W),K.on(C.default.FRAGMENT_LOADING_ABANDONED,ge,W),K.on(E.default.MEDIA_FRAGMENT_LOADED,Fe,W)}function ue(V){return V.map(function(j){return Math.log(j)})}function ie(V,j,$){var re=$.reduce(function(ne,fe,Ce){return fe>$[ne]?Ce:ne},0);if(re===0)return null;var oe=Math.max(V,L+D*j.length),X=($[re]-1)/(oe/L-1),z=L/X;return{gp:X,Vp:z}}function Q(V){var j={},$=V.getMediaInfo(),re=$.bitrateList.map(function(ne){return ne.bandwidth}),oe=ue(re);oe=oe.map(function(ne){return ne-oe[0]+1});var X=k.getStableBufferTime(),z=ie(X,re,oe);return z?(j.state=F,j.bitrates=re,j.utilities=oe,j.stableBufferTime=X,j.Vp=z.Vp,j.gp=z.gp,j.lastQuality=0,se(j)):j.state=b,j}function se(V){V.placeholderBuffer=0,V.mostAdvancedSegmentStart=NaN,V.lastSegmentWasReplacement=!1,V.lastSegmentStart=NaN,V.lastSegmentDurationS=NaN,V.lastSegmentRequestTimeMs=NaN,V.lastSegmentFinishTimeMs=NaN}function ve(V,j){var $=k.getStableBufferTime();if(V.stableBufferTime!==$){var re=ie($,V.bitrates,V.utilities);if(re.Vp!==V.Vp||re.gp!==V.gp){var oe=w.getCurrentBufferLevel(j),X=oe+V.placeholderBuffer;X-=L,X*=re.Vp/V.Vp,X+=L,V.stableBufferTime=$,V.Vp=re.Vp,V.gp=re.gp,V.placeholderBuffer=Math.max(0,X-oe)}}}function _e(V){var j=V.getMediaType(),$=J[j];return $?$.state!==b&&ve($,j):($=Q(V),J[j]=$),$}function Z(V,j){for(var $=V.bitrates.length,re=NaN,oe=NaN,X=0;X<$;++X){var z=(V.Vp*(V.utilities[X]+V.gp)-j)/V.bitrates[X];(isNaN(oe)||z>=oe)&&(oe=z,re=X)}return re}function Ee(V,j){return V.Vp*(V.utilities[j]+V.gp)}function Se(V,j){for(var $=V.bitrates[j],re=V.utilities[j],oe=0,X=j-1;X>=0;--X)if(V.utilities[X]<V.utilities[j]){var z=V.bitrates[X],ne=V.utilities[X],fe=V.Vp*(V.gp+($*ne-z*re)/($-z));oe=Math.max(oe,fe)}return oe}function Me(V,j){var $=Date.now();if(isNaN(V.lastSegmentFinishTimeMs)){if(!isNaN(V.lastCallTimeMs)){var oe=.001*($-V.lastCallTimeMs);V.placeholderBuffer+=Math.max(0,oe)}}else{var re=.001*($-V.lastSegmentFinishTimeMs);V.placeholderBuffer+=Math.max(0,re)}V.lastCallTimeMs=$,V.lastSegmentStart=NaN,V.lastSegmentRequestTimeMs=NaN,V.lastSegmentFinishTimeMs=NaN,ve(V,j)}function de(V){var j=V.mediaType,$=j===R.default.AUDIO?[R.default.AUDIO]:J;for(var re in $)J.hasOwnProperty(re)&&J[re].state===O&&(J[re].placeholderBuffer=0)}function xe(){for(var V in J)if(J.hasOwnProperty(V)){var j=J[V];j.state!==b&&(j.state=F,se(j))}}function Fe(V){if(V&&V.chunk&&V.chunk.mediaInfo){var j=J[V.chunk.mediaInfo.type];if(j&&j.state!==b){var $=V.chunk.start;isNaN(j.mostAdvancedSegmentStart)||$>j.mostAdvancedSegmentStart?(j.mostAdvancedSegmentStart=$,j.lastSegmentWasReplacement=!1):j.lastSegmentWasReplacement=!0,j.lastSegmentStart=$,j.lastSegmentDurationS=V.chunk.duration,j.lastQuality=V.chunk.quality,De(j,V.chunk.mediaInfo.type)}}}function Le(V){if(V&&V.metric===m.default.HTTP_REQUEST&&V.value&&V.value.type===_.HTTPRequest.MEDIA_SEGMENT_TYPE&&V.value.trace&&V.value.trace.length){var j=J[V.mediaType];j&&j.state!==b&&(j.lastSegmentRequestTimeMs=V.value.trequest.getTime(),j.lastSegmentFinishTimeMs=V.value._tfinish.getTime(),De(j,V.mediaType))}}function De(V,j){if(!isNaN(V.lastSegmentStart)&&!isNaN(V.lastSegmentRequestTimeMs)&&!isNaN(V.placeholderBuffer)){if(V.placeholderBuffer*=x,!isNaN(V.lastSegmentFinishTimeMs)){var $=w.getCurrentBufferLevel(j),re=$+.001*(V.lastSegmentFinishTimeMs-V.lastSegmentRequestTimeMs),oe=Ee(V,V.lastQuality),X=Math.max(0,oe-re);V.placeholderBuffer=Math.min(X,V.placeholderBuffer)}V.lastSegmentWasReplacement&&!isNaN(V.lastSegmentDurationS)&&(V.placeholderBuffer+=V.lastSegmentDurationS),V.lastSegmentStart=NaN,V.lastSegmentRequestTimeMs=NaN}}function Ae(V){if(V){var j=J[V.mediaType];j&&j.state!==b&&(j.abrQuality=V.newQuality)}}function ge(V){if(V){var j=J[V.mediaType];if(j&&j.state!==b){var $=w.getCurrentBufferLevel(V.mediaType),re;j.abrQuality>0?re=Se(j,j.abrQuality):re=L;var oe=Math.max(0,re-$);j.placeholderBuffer=Math.min(j.placeholderBuffer,oe)}}}function pe(V){var j=(0,g.default)(U).create();if(!V||!V.hasOwnProperty("getMediaInfo")||!V.hasOwnProperty("getMediaType")||!V.hasOwnProperty("getScheduleController")||!V.hasOwnProperty("getStreamInfo")||!V.hasOwnProperty("getAbrController")||!V.hasOwnProperty("useBufferOccupancyABR"))return j;var $=V.getMediaInfo(),re=V.getMediaType(),oe=V.getScheduleController(),X=V.getStreamInfo(),z=V.getAbrController(),ne=z.getThroughputHistory(),fe=X?X.id:null,Ce=X&&X.manifestInfo&&X.manifestInfo.isDynamic,Pe=V.useBufferOccupancyABR();if(j.reason=j.reason||{},!Pe)return j;oe.setTimeToLoadDelay(0);var he=_e(V);if(he.state===b)return j;var Ue=w.getCurrentBufferLevel(re),we=ne.getAverageThroughput(re,Ce),$e=ne.getSafeAverageThroughput(re,Ce),it=ne.getAverageLatency(re),mt;if(j.reason.state=he.state,j.reason.throughput=we,j.reason.latency=it,isNaN(we))return j;switch(he.state){case F:mt=z.getQualityForBitrate($,$e,fe,it),j.quality=mt,j.reason.throughput=$e,he.placeholderBuffer=Math.max(0,Se(he,mt)-Ue),he.lastQuality=mt,!isNaN(he.lastSegmentDurationS)&&Ue>=he.lastSegmentDurationS&&(he.state=O);break;case O:Me(he,re),mt=Z(he,Ue+he.placeholderBuffer);var pt=z.getQualityForBitrate($,$e,fe,it);mt>he.lastQuality&&mt>pt&&(mt=Math.max(pt,he.lastQuality));var Pt=Math.max(0,Ue+he.placeholderBuffer-Ee(he,mt));Pt<=he.placeholderBuffer?(he.placeholderBuffer-=Pt,Pt=0):(Pt-=he.placeholderBuffer,he.placeholderBuffer=0,mt<z.getMaxAllowedIndexFor(re,fe)?oe.setTimeToLoadDelay(1e3*Pt):Pt=0),j.quality=mt,j.reason.throughput=we,j.reason.latency=it,j.reason.bufferLevel=Ue,j.reason.placeholderBuffer=he.placeholderBuffer,j.reason.delay=Pt,he.lastQuality=mt;break;default:Y.debug("BOLA ABR rule invoked in bad state."),j.quality=z.getQualityForBitrate($,$e,fe,it),j.reason.state=he.state,j.reason.throughput=$e,j.reason.latency=it,he.state=F,se(he)}return j}function Re(){J={}}function me(){Re(),K.off(C.default.BUFFER_EMPTY,de,W),K.off(C.default.PLAYBACK_SEEKING,xe,W),K.off(C.default.METRIC_ADDED,Le,W),K.off(C.default.QUALITY_CHANGE_REQUESTED,Ae,W),K.off(C.default.FRAGMENT_LOADING_ABANDONED,ge,W),K.off(E.default.MEDIA_FRAGMENT_LOADED,Fe,W)}return W={getMaxIndex:pe,reset:me},ee(),W}B.__dashjs_factory_name="BolaRule";const M=v.default.getClassFactory(B)},"./src/streaming/rules/abr/DroppedFramesRule.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/rules/SwitchRequest.js"),v=d("./src/core/Debug.js");function _(){var E=this.context,T,C,R=.15,b=375;function F(){C=(0,v.default)(E).getInstance().getLogger(T)}function O(L){var D=(0,g.default)(E).create();if(!L||!L.hasOwnProperty("getDroppedFramesHistory"))return D;var x=L.getDroppedFramesHistory(),B=L.getStreamInfo().id;if(x){var M=x.getFrameHistory(B);if(!M||M.length===0)return D;for(var I=0,U=0,w=g.default.NO_CHANGE,k=1;k<M.length;k++)if(M[k]&&(I=M[k].droppedVideoFrames,U=M[k].totalVideoFrames,U>b&&I/U>R)){w=k-1,C.debug("index: "+w+" Dropped Frames: "+I+" Total Frames: "+U);break}return(0,g.default)(E).create(w,{droppedFrames:I})}return D}return T={getMaxIndex:O},F(),T}_.__dashjs_factory_name="DroppedFramesRule";const S=m.default.getClassFactory(_)},"./src/streaming/rules/abr/InsufficientBufferRule.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>b});var m=d("./src/core/EventBus.js"),g=d("./src/core/events/Events.js"),v=d("./src/core/FactoryMaker.js"),_=d("./src/core/Debug.js"),S=d("./src/streaming/rules/SwitchRequest.js"),E=d("./src/streaming/constants/Constants.js"),T=d("./src/streaming/constants/MetricsConstants.js"),C=d("./src/streaming/MediaPlayerEvents.js");function R(F){F=F||{};var O=.5,L=2,D=this.context,x=(0,m.default)(D).getInstance(),B=F.dashMetrics,M,I,U;function w(){I=(0,_.default)(D).getInstance().getLogger(M),Y(),x.on(C.default.PLAYBACK_SEEKING,J,M),x.on(g.default.BYTES_APPENDED_END_FRAGMENT,ee,M)}function k(){if(!B||!B.hasOwnProperty("getCurrentBufferLevel")||!B.hasOwnProperty("getCurrentBufferState"))throw new Error(E.default.MISSING_CONFIG_ERROR)}function K(ie){var Q=(0,S.default)(D).create();if(!ie||!ie.hasOwnProperty("getMediaType"))return Q;k();var se=ie.getMediaType(),ve=B.getCurrentBufferState(se),_e=ie.getRepresentationInfo(),Z=_e.fragmentDuration,Ee=ie.getStreamInfo(),Se=Ee?Ee.id:null,Me=ie.getScheduleController(),de=Ee&&Ee.manifestInfo&&Ee.manifestInfo.isDynamic,xe=Me.getPlaybackController(),Fe=xe.getLowLatencyModeEnabled();if(W(Fe,se)||!Z)return Q;if(ve&&ve.state===T.default.BUFFER_EMPTY)I.debug("["+se+"] Switch to index 0; buffer is empty."),Q.quality=0,Q.reason="InsufficientBufferRule: Buffer is empty";else{var Le=ie.getMediaInfo(),De=ie.getAbrController(),Ae=De.getThroughputHistory(),ge=B.getCurrentBufferLevel(se),pe=Ae.getAverageThroughput(se,de),Re=Ae.getAverageLatency(se),me=pe*(ge/Z)*O;Q.quality=De.getQualityForBitrate(Le,me,Se,Re),Q.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return Q}function W(ie,Q){return!ie&&U[Q].ignoreCount>0}function Y(){U={},U[E.default.VIDEO]={ignoreCount:L},U[E.default.AUDIO]={ignoreCount:L}}function J(){Y()}function ee(ie){!isNaN(ie.startTime)&&(ie.mediaType===E.default.AUDIO||ie.mediaType===E.default.VIDEO)&&U[ie.mediaType].ignoreCount>0&&U[ie.mediaType].ignoreCount--}function ue(){Y(),x.off(C.default.PLAYBACK_SEEKING,J,M),x.off(g.default.BYTES_APPENDED_END_FRAGMENT,ee,M)}return M={getMaxIndex:K,reset:ue},w(),M}R.__dashjs_factory_name="InsufficientBufferRule";const b=v.default.getClassFactory(R)},"./src/streaming/rules/abr/L2ARule.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/streaming/constants/MetricsConstants.js"),g=d("./src/streaming/rules/SwitchRequest.js"),v=d("./src/core/FactoryMaker.js"),_=d("./src/streaming/vo/metrics/HTTPRequest.js"),S=d("./src/core/EventBus.js"),E=d("./src/core/events/Events.js"),T=d("./src/core/Debug.js"),C=d("./src/streaming/constants/Constants.js"),R=0,b=1,F=2;function O(D){D=D||{};var x=this.context,B=D.dashMetrics,M=(0,S.default)(x).getInstance(),I,U,w,k;function K(){k=(0,T.default)(x).getInstance().getLogger(I),Se(),M.on(E.default.PLAYBACK_SEEKING,ue,I),M.on(E.default.MEDIA_FRAGMENT_LOADED,ie,I),M.on(E.default.METRIC_ADDED,Q,I),M.on(E.default.QUALITY_CHANGE_REQUESTED,ve,I)}function W(de){var xe={},Fe=de.getMediaInfo(),Le=Fe.bitrateList.map(function(De){return De.bandwidth/1e3});return xe.state=b,xe.bitrates=Le,xe.lastQuality=0,Y(Fe),J(xe),xe}function Y(de){!de||!de.type||(w[de.type]={},w[de.type].w=[],w[de.type].prev_w=[],w[de.type].Q=0,w[de.type].segment_request_start_s=0,w[de.type].segment_download_finish_s=0,w[de.type].B_target=1.5)}function J(de){de.placeholderBuffer=0,de.mostAdvancedSegmentStart=NaN,de.lastSegmentWasReplacement=!1,de.lastSegmentStart=NaN,de.lastSegmentDurationS=NaN,de.lastSegmentRequestTimeMs=NaN,de.lastSegmentFinishTimeMs=NaN}function ee(de){var xe=de.getMediaType(),Fe=U[xe];return Fe||(Fe=W(de),U[xe]=Fe),Fe}function ue(){for(var de in U)if(U.hasOwnProperty(de)){var xe=U[de];xe.state!==R&&(xe.state=b,J(xe))}}function ie(de){if(de&&de.chunk&&de.chunk.mediaInfo){var xe=U[de.chunk.mediaInfo.type],Fe=w[de.chunk.mediaInfo.type];if(xe&&xe.state!==R){var Le=de.chunk.start;isNaN(xe.mostAdvancedSegmentStart)||Le>xe.mostAdvancedSegmentStart?(xe.mostAdvancedSegmentStart=Le,xe.lastSegmentWasReplacement=!1):xe.lastSegmentWasReplacement=!0,xe.lastSegmentStart=Le,xe.lastSegmentDurationS=de.chunk.duration,xe.lastQuality=de.chunk.quality,se(xe,Fe)}}}function Q(de){if(de&&de.metric===m.default.HTTP_REQUEST&&de.value&&de.value.type===_.HTTPRequest.MEDIA_SEGMENT_TYPE&&de.value.trace&&de.value.trace.length){var xe=U[de.mediaType],Fe=w[de.mediaType];xe&&xe.state!==R&&(xe.lastSegmentRequestTimeMs=de.value.trequest.getTime(),xe.lastSegmentFinishTimeMs=de.value._tfinish.getTime(),se(xe,Fe))}}function se(de,xe){!isNaN(de.lastSegmentStart)&&!isNaN(de.lastSegmentRequestTimeMs)&&(xe.segment_request_start_s=.001*de.lastSegmentRequestTimeMs,xe.segment_download_finish_s=.001*de.lastSegmentFinishTimeMs,de.lastSegmentStart=NaN,de.lastSegmentRequestTimeMs=NaN)}function ve(de){if(de&&de.mediaType){var xe=U[de.mediaType];xe&&xe.state!==R&&(xe.abrQuality=de.newQuality)}}function _e(de,xe){if(de.length!==xe.length)return-1;for(var Fe=0,Le=0;Le<de.length;Le++)Fe=Fe+de[Le]*xe[Le];return Fe}function Z(de){for(var xe=de.length,Fe=!1,Le=[],De=0;De<xe;++De)Le[De]=de[De];for(var Ae=de.sort(function(j,$){return $-j}),ge=0,pe=0,Re=[],me=0;me<xe-1;++me)if(ge=ge+Ae[me],pe=(ge-1)/(me+1),pe>=Ae[me+1]){Fe=!0;break}Fe||(pe=(ge+Ae[xe-1]-1)/xe);for(var V=0;V<xe;++V)Re[V]=Math.max(Le[V]-pe,0);return Re}function Ee(de){var xe=(0,g.default)(x).create(),Fe=4,Le=Math.pow(Fe,.99),De=Math.max(Math.pow(Fe,1),Le*Math.sqrt(Fe)),Ae=de.getMediaInfo(),ge=de.getMediaType(),pe=Ae.bitrateList.map(function(Et){return Et.bandwidth}),Re=pe.length,me=de.getScheduleController(),V=de.getStreamInfo(),j=de.getAbrController(),$=j.getThroughputHistory(),re=V&&V.manifestInfo&&V.manifestInfo.isDynamic,oe=de.useL2AABR(),X=B.getCurrentBufferLevel(ge,!0),z=$.getSafeAverageThroughput(ge,re),ne=$.getAverageThroughput(ge,re),fe=2,Ce=$.getAverageLatency(ge),Pe=de.getVideoModel(),he,Ue=Pe.getPlaybackRate();if(!de||!de.hasOwnProperty("getMediaInfo")||!de.hasOwnProperty("getMediaType")||!de.hasOwnProperty("getScheduleController")||!de.hasOwnProperty("getStreamInfo")||!de.hasOwnProperty("getAbrController")||!de.hasOwnProperty("useL2AABR")||(xe.reason=xe.reason||{},!oe||ge===C.default.AUDIO))return xe;me.setTimeToLoadDelay(0);var we=ee(de);if(we.state===R)return xe;var $e=w[ge];if(!$e||(xe.reason.state=we.state,xe.reason.throughput=ne,xe.reason.latency=Ce,isNaN(ne)))return xe;switch(we.state){case b:if(he=j.getQualityForBitrate(Ae,z,V.id,Ce),xe.quality=he,xe.reason.throughput=z,we.lastQuality=he,!isNaN(we.lastSegmentDurationS)&&X>=$e.B_target){we.state=F,$e.Q=Le;for(var it=0;it<Re;++it)it===we.lastQuality?$e.prev_w[it]=1:$e.prev_w[it]=0}break;case F:var mt=[],pt=B.getCurrentHttpRequest(ge).trace.reduce(function(Et,St){return Et+St.d},0),Pt=B.getCurrentHttpRequest(ge).trace.reduce(function(Et,St){return Et+St.b[0]},0),lt=Math.round(8*Pt/pt);lt<1&&(lt=1);for(var Ye=we.lastSegmentDurationS,st=1,Nt=0;Nt<Re;++Nt)pe[Nt]=pe[Nt]/1e3,Ue*pe[Nt]>lt&&(st=-1),$e.w[Nt]=$e.prev_w[Nt]+st*(Ye/(2*De))*(($e.Q+Le)*(Ue*pe[Nt]/lt));$e.w=Z($e.w);for(var Wt=0;Wt<Re;++Wt)mt[Wt]=$e.w[Wt]-$e.prev_w[Wt],$e.prev_w[Wt]=$e.w[Wt];$e.Q=Math.max(0,$e.Q-Ye+Ye*Ue*((_e(pe,$e.prev_w)+_e(pe,mt))/lt));for(var Ht=[],nt=0;nt<Re;++nt)Ht[nt]=Math.abs(pe[nt]-_e($e.w,pe));he=Ht.indexOf(Math.min.apply(Math,Ht)),he>we.lastQuality&&pe[we.lastQuality+1]<=lt&&(he=we.lastQuality+1),pe[he]>=lt&&($e.Q=fe*Math.max(Le,$e.Q)),xe.quality=he,xe.reason.throughput=ne,xe.reason.latency=Ce,xe.reason.bufferLevel=X,we.lastQuality=xe.quality;break;default:k.debug("L2A ABR rule invoked in bad state."),xe.quality=j.getQualityForBitrate(Ae,z,V.id,Ce),xe.reason.state=we.state,xe.reason.throughput=z,xe.reason.latency=Ce,we.state=b,J(we)}return xe}function Se(){U={},w={}}function Me(){Se(),M.off(E.default.PLAYBACK_SEEKING,ue,I),M.off(E.default.MEDIA_FRAGMENT_LOADED,ie,I),M.off(E.default.METRIC_ADDED,Q,I),M.off(E.default.QUALITY_CHANGE_REQUESTED,ve,I)}return I={getMaxIndex:Ee,reset:Me},K(),I}O.__dashjs_factory_name="L2ARule";const L=v.default.getClassFactory(O)},"./src/streaming/rules/abr/SwitchHistoryRule.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/Debug.js"),v=d("./src/streaming/rules/SwitchRequest.js");function _(){var E=this.context,T,C,R=.075,b=6;function F(){C=(0,g.default)(E).getInstance().getLogger(T)}function O(L){for(var D=L?L.getSwitchHistory():null,x=D?D.getSwitchRequests():[],B=0,M=0,I=0,U=(0,v.default)(E).create(),w=0;w<x.length;w++)if(x[w]!==void 0&&(B+=x[w].drops,M+=x[w].noDrops,I+=x[w].dropSize,B+M>=b&&B/M>R)){U.quality=w>0&&x[w].drops>0?w-1:w,U.reason={index:U.quality,drops:B,noDrops:M,dropSize:I},C.debug("Switch history rule index: "+U.quality+" samples: "+(B+M)+" drops: "+B);break}return U}return T={getMaxIndex:O},F(),T}_.__dashjs_factory_name="SwitchHistoryRule";const S=m.default.getClassFactory(_)},"./src/streaming/rules/abr/ThroughputRule.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/rules/SwitchRequest.js"),v=d("./src/streaming/constants/Constants.js"),_=d("./src/streaming/constants/MetricsConstants.js");function S(T){T=T||{};var C=this.context,R=T.dashMetrics,b;function F(){if(!R||!R.hasOwnProperty("getCurrentBufferState"))throw new Error(v.default.MISSING_CONFIG_ERROR)}function O(D){var x=(0,g.default)(C).create();if(!D||!D.hasOwnProperty("getMediaInfo")||!D.hasOwnProperty("getMediaType")||!D.hasOwnProperty("useBufferOccupancyABR")||!D.hasOwnProperty("getAbrController")||!D.hasOwnProperty("getScheduleController"))return x;F();var B=D.getMediaInfo(),M=D.getMediaType(),I=R.getCurrentBufferState(M),U=D.getScheduleController(),w=D.getAbrController(),k=D.getStreamInfo(),K=k?k.id:null,W=k&&k.manifestInfo?k.manifestInfo.isDynamic:null,Y=w.getThroughputHistory(),J=Y.getSafeAverageThroughput(M,W),ee=Y.getAverageLatency(M),ue=D.useBufferOccupancyABR();return isNaN(J)||!I||ue||w.getAbandonmentStateFor(K,M)!==_.default.ABANDON_LOAD&&(I.state===_.default.BUFFER_LOADED||W)&&(x.quality=w.getQualityForBitrate(B,J,K,ee),U.setTimeToLoadDelay(0),x.reason={throughput:J,latency:ee}),x}function L(){}return b={getMaxIndex:O,reset:L},b}S.__dashjs_factory_name="ThroughputRule";const E=m.default.getClassFactory(S)},"./src/streaming/rules/abr/lolp/LearningAbrController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/Debug.js"),v={MANUAL:"manual_weight_selection",RANDOM:"random_weight_selection",DYNAMIC:"dynamic_weight_selection"};function _(){var E=this.context,T,C,R,b,F,O,L,D,x;function B(){C=(0,g.default)(E).getInstance().getLogger(T),I()}function M(){I()}function I(){R=null,b=1,F=100,O=0,L=null,D=null,x=v.DYNAMIC}function U(){var Ee=0;if(R)for(var Se=0;Se<R.length;Se++){var Me=R[Se];Me.state.throughput>Ee&&(Ee=Me.state.throughput)}return Ee}function w(Ee){var Se=Ee.map(function(Me){return Math.pow(Me,2)}).reduce(function(Me,de){return Me+de});return Math.sqrt(Se)}function k(Ee,Se,Me){var de=Ee.map(function(Fe,Le){return Me[Le]*Math.pow(Fe-Se[Le],2)}).reduce(function(Fe,Le){return Fe+Le}),xe=de<0?-1:1;return xe*Math.sqrt(Math.abs(de))}function K(Ee,Se){var Me=[Ee.state.throughput,Ee.state.latency,Ee.state.rebuffer,Ee.state.switch],de=[Se.state.throughput,Se.state.latency,Se.state.rebuffer,Se.state.switch];return k(Me,de,[1,1,1,1])}function W(Ee,Se,Me){for(var de=0;de<Se.length;de++){var xe=Se[de],Fe=.1,Le=K(xe,Ee),De=Math.exp(-1*Math.pow(Le,2)/(2*Math.pow(Fe,2)));Y(xe,Me,De)}}function Y(Ee,Se,Me){var de=Ee.state,xe=[.01,.01,.01,.01];de.throughput=de.throughput+(Se[0]-de.throughput)*xe[0]*Me,de.latency=de.latency+(Se[1]-de.latency)*xe[1]*Me,de.rebuffer=de.rebuffer+(Se[2]-de.rebuffer)*xe[2]*Me,de.switch=de.switch+(Se[3]-de.switch)*xe[3]*Me}function J(Ee,Se){var Me=0,de=Ee;if(R)for(var xe=0;xe<R.length;xe++){var Fe=R[xe];Fe.bitrate<Ee.bitrate&&Fe.bitrate>Me&&Se>Fe.bitrate&&(Me=Fe.bitrate,de=Fe)}return de}function ee(Ee,Se,Me,de,xe,Fe,Le){var De=Me,Ae=de,ge=Se,pe=ve(Ee),Re=Se/b;Re>1&&(Re=U()),Me=Me/F;var me=0,V=0,j=0,$=1e4;C.debug("getNextQuality called throughput:".concat(Re," latency:").concat(Me," bufferSize:").concat(de," currentQualityIndex:").concat(Fe," playbackRate:").concat(xe));var re=pe[Fe],oe=re.bitrate*Le.getSegmentDuration()/ge,X=Math.max(0,oe-Ae);if(Ae-oe<Le.getMinBuffer())return C.debug("Buffer is low for bitrate= ".concat(re.bitrate," downloadTime=").concat(oe," currentBuffer=").concat(Ae," rebuffer=").concat(X)),J(re,ge).qualityIndex;switch(x){case v.MANUAL:ue();break;case v.RANDOM:ie(pe);break;case v.DYNAMIC:Q(Le,pe,De,Ae,X,ge,xe);break;default:Q(Le,pe,De,Ae,X,ge,xe)}for(var z=null,ne=null,fe=null,Ce=0;Ce<pe.length;Ce++){var Pe=pe[Ce],he=Pe.state,Ue=[he.throughput,he.latency,he.rebuffer,he.switch],we=L.slice(),$e=Le.getNextBufferWithBitrate(Pe.bitrate,Ae,ge),it=$e<Le.getMinBuffer();it&&C.debug("Buffer is low for bitrate=".concat(Pe.bitrate," downloadTime=").concat(oe," currentBuffer=").concat(Ae," nextBuffer=").concat($e)),(Pe.bitrate>Se-$||it)&&Pe.bitrate!==O&&(we[0]=100);var mt=k(Ue,[Re,me,V,j],we);(z===null||mt<z)&&(z=mt,ne=Pe.qualityIndex,fe=Pe)}var pt=Math.abs(re.bitrate-fe.bitrate)/b;return W(re,pe,[Re,Me,X,pt]),W(fe,pe,[Re,me,V,pt]),ne}function ue(){var Ee=.4,Se=.4,Me=.4,de=.4;L=[Ee,Se,Me,de]}function ie(Ee){L=se(Ee.length,4)}function Q(Ee,Se,Me,de,xe,Fe,Le){L||(L=D[D.length-1]);var De=Ee.findWeightVector(Se,Me,de,xe,Fe,Le);De!==null&&De!==-1&&(L=De)}function se(Ee,Se){for(var Me=[],de=Math.sqrt(2/Ee),xe=0;xe<Se;xe++)Me.push(Math.random()*de);return L=Me,L}function ve(Ee){if(!R){R=[];var Se=Ee.bitrateList,Me=[];O=Se[0].bandwidth,Se.forEach(function(Fe){Me.push(Fe.bandwidth),Fe.bandwidth<O&&(O=Fe.bandwidth)}),b=w(Me);for(var de=0;de<Se.length;de++){var xe={qualityIndex:de,bitrate:Se[de].bandwidth,state:{throughput:Se[de].bandwidth/b,latency:0,rebuffer:0,switch:0}};R.push(xe)}D=Z(R)}return R}function _e(Ee){for(var Se=[],Me=0;Me<Ee;Me++){var de=[Math.random()*U(),Math.random(),Math.random(),Math.random()];Se.push(de)}return Se}function Z(Ee){var Se=[],Me=_e(Math.pow(Ee.length,2));Se.push(Me[0]);for(var de=[1,1,1,1],xe=1;xe<Ee.length;xe++){for(var Fe=null,Le=null,De=0;De<Me.length;De++){for(var Ae=Me[De],ge=null,pe=0;pe<Se.length;pe++){var Re=k(Ae,Se[pe],de);(ge===null||Re<ge)&&(ge=Re)}(Le===null||ge>Le)&&(Fe=Ae,Le=ge)}Se.push(Fe)}for(var me=null,V=null,j=0;j<Se.length;j++){for(var $=0,re=0;re<Se.length;re++)j!==re&&($+=k(Se[j],Se[re],de));(me===null||$>me)&&(me=$,V=j)}var oe=[];for(oe.push(Se[V]),Se.splice(V,1);Se.length>0;){for(var X=null,z=null,ne=0;ne<Se.length;ne++){var fe=k(oe[0],Se[ne],de);(X===null||fe<X)&&(X=fe,z=ne)}oe.push(Se[z]),Se.splice(z,1)}return oe}return T={getNextQuality:ee,reset:M},B(),T}_.__dashjs_factory_name="LearningAbrController";const S=m.default.getClassFactory(_)},"./src/streaming/rules/abr/lolp/LoLpQoEEvaluator.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/rules/abr/lolp/QoeInfo.js");function v(){var S,E,T,C,R;function b(){F()}function F(){E=null,T=null,C=null,R=null}function O(U,w,k){E=L("segment",U,w,k),T=U,C=w,R=k}function L(U,w,k,K){var W=new g.default;return W.type=U,w?W.weights.bitrateReward=w:W.weights.bitrateReward=1,W.weights.bitrateSwitchPenalty=1,k?W.weights.rebufferPenalty=k:W.weights.rebufferPenalty=1e3,W.weights.latencyPenalty=[],W.weights.latencyPenalty.push({threshold:1.1,penalty:K*.05}),W.weights.latencyPenalty.push({threshold:1e8,penalty:k*.1}),K?W.weights.playbackSpeedPenalty=K:W.weights.playbackSpeedPenalty=200,W}function D(U,w,k,K){E&&x(U,w,k,K,E)}function x(U,w,k,K,W){W.bitrateWSum+=W.weights.bitrateReward*U,W.lastBitrate&&(W.bitrateSwitchWSum+=W.weights.bitrateSwitchPenalty*Math.abs(U-W.lastBitrate)),W.lastBitrate=U,W.rebufferWSum+=W.weights.rebufferPenalty*w;for(var Y=0;Y<W.weights.latencyPenalty.length;Y++){var J=W.weights.latencyPenalty[Y];if(k<=J.threshold){W.latencyWSum+=J.penalty*k;break}}W.playbackSpeedWSum+=W.weights.playbackSpeedPenalty*Math.abs(1-K),W.totalQoe=W.bitrateWSum-W.bitrateSwitchWSum-W.rebufferWSum-W.latencyWSum-W.playbackSpeedWSum}function B(){return E}function M(U,w,k,K){var W=null;return T&&C&&R&&(W=L("segment",T,C,R)),W?(x(U,w,k,K,W),W.totalQoe):0}function I(){F()}return S={setupPerSegmentQoe:O,logSegmentMetrics:D,getPerSegmentQoe:B,calculateSingleUseQoe:M,reset:I},b(),S}v.__dashjs_factory_name="LoLpQoeEvaluator";const _=m.default.getClassFactory(v)},"./src/streaming/rules/abr/lolp/LoLpRule.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>O});var m=d("./src/core/Debug.js"),g=d("./src/core/FactoryMaker.js"),v=d("./src/streaming/rules/abr/lolp/LearningAbrController.js"),_=d("./src/streaming/rules/abr/lolp/LoLpQoEEvaluator.js"),S=d("./src/streaming/rules/SwitchRequest.js"),E=d("./src/streaming/constants/MetricsConstants.js"),T=d("./src/streaming/rules/abr/lolp/LoLpWeightSelector.js"),C=d("./src/streaming/constants/Constants.js"),R=1.5,b=.3;function F(L){L=L||{};var D=L.dashMetrics,x=this.context,B,M,I,U;function w(){B=(0,m.default)(x).getInstance().getLogger(M),I=(0,v.default)(x).create(),U=(0,_.default)(x).create()}function k(Y){try{var J=(0,S.default)(x).create(),ee=Y.getMediaInfo().type,ue=Y.getAbrController(),ie=Y.getStreamInfo(),Q=ue.getQualityFor(ee,ie.id),se=Y.getMediaInfo(),ve=D.getCurrentBufferState(ee),_e=Y.getScheduleController(),Z=D.getCurrentBufferLevel(ee,!0),Ee=ie&&ie.manifestInfo?ie.manifestInfo.isDynamic:null,Se=_e.getPlaybackController(),Me=Se.getCurrentLiveLatency();if(!Y.useLoLPABR()||ee===C.default.AUDIO)return J;Me||(Me=0);var de=Se.getPlaybackRate(),xe=ue.getThroughputHistory(),Fe=xe.getSafeAverageThroughput(ee,Ee);if(B.debug("Throughput ".concat(Math.round(Fe)," kbps")),isNaN(Fe)||!ve||ue.getAbandonmentStateFor(ie.id,ee)===E.default.ABANDON_LOAD)return J;for(var Le=se.bitrateList,De=Y.getRepresentationInfo().fragmentDuration,Ae=Le[0].bandwidth/1e3,ge=Le[Le.length-1].bandwidth/1e3,pe=0;pe<Le.length;pe++){var Re=Le[pe].bandwidth/1e3;Re>ge?ge=Re:Re<Ae&&(Ae=Re)}var me=Le[Q].bandwidth,V=me/1e3,j=D.getCurrentHttpRequest(ee,!0),$=(j.tresponse.getTime()-j.trequest.getTime())/1e3,re=$>De?$-De:0;U.setupPerSegmentQoe(De,ge,Ae),U.logSegmentMetrics(V,re,Me,de);var oe=(0,T.default)(x).create({targetLatency:R,bufferMin:b,segmentDuration:De,qoeEvaluator:U});return J.quality=I.getNextQuality(se,Fe*1e3,Me,Z,de,Q,oe),J.reason={throughput:Fe,latency:Me},J.priority=S.default.PRIORITY.STRONG,_e.setTimeToLoadDelay(0),J.quality!==Q&&console.log("[TgcLearningRule]["+ee+"] requesting switch to index: ",J.quality,"Average throughput",Math.round(Fe),"kbps"),J}catch(X){throw X}}function K(){I.reset(),U.reset()}function W(){K()}return M={getMaxIndex:k,reset:W},w(),M}F.__dashjs_factory_name="LoLPRule";const O=g.default.getClassFactory(F)},"./src/streaming/rules/abr/lolp/LoLpWeightSelector.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/core/FactoryMaker.js");function g(_){var S=_.targetLatency,E=_.bufferMin,T=_.segmentDuration,C=_.qoeEvaluator,R,b,F,O,L;function D(){x()}function x(){b=[.2,.4,.6,.8,1],F=4,O=I(b,F),L=0}function B(W,Y,J,ee,ue,ie){var Q=null,se=null,ve=null,_e=Math.abs(Y-L);return W.forEach(function(Z){O.forEach(function(Ee){var Se={throughput:Ee[0],latency:Ee[1],buffer:Ee[2],switch:Ee[3]},Me=Z.bitrate*T/ue,de=K(J,Me),xe=Math.max(1e-5,Me-de),Fe;Se.buffer===0?Fe=10:Fe=1/Se.buffer;var Le=Fe*xe;Se.latency===0?Fe=10:Fe=1/Se.latency;var De=Fe*Z.state.latency,Ae=C.calculateSingleUseQoe(Z.bitrate,Le,De,ie);(Q===null||Ae>Q)&&M(Y,de,_e)&&(Q=Ae,se=Ee,ve=Z.bitrate)})}),se===null&&ve===null&&(se=-1),L=Y,se}function M(W,Y,J){return W>S+J?!1:Y>=E}function I(W,Y){var J=W.map(function(ue){return[ue]}),ee=function ue(ie,Q,se){if(se===Q)return ie;for(var ve=ie.length,_e=0;_e<ve;_e++)for(var Z=ie.shift(),Ee=0;Ee<W.length;Ee++)ie.push(Z.concat(W[Ee]));return ue(ie,Q,se+1)};return ee(J,Y,1)}function U(){return E}function w(){return T}function k(W,Y,J){var ee=W*T/J;return K(Y,ee)}function K(W,Y){var J=w(),ee;return Y>J?ee=W-J:ee=W+J-Y,ee}return R={getMinBuffer:U,getSegmentDuration:w,getNextBufferWithBitrate:k,getNextBuffer:K,findWeightVector:B},D(),R}g.__dashjs_factory_name="LoLpWeightSelector";const v=m.default.getClassFactory(g)},"./src/streaming/rules/abr/lolp/QoeInfo.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.type=null,this.lastBitrate=null,this.weights={},this.weights.bitrateReward=null,this.weights.bitrateSwitchPenalty=null,this.weights.rebufferPenalty=null,this.weights.latencyPenalty=null,this.weights.playbackSpeedPenalty=null,this.bitrateWSum=0,this.bitrateSwitchWSum=0,this.rebufferWSum=0,this.latencyWSum=0,this.playbackSpeedWSum=0,this.totalQoe=0};const v=g},"./src/streaming/text/EmbeddedTextHtmlRender.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/core/FactoryMaker.js");function g(){var _=0,S;function E(L){for(var D="",x=0;x<L.length;++x){var B=L[x];D+=B.uchar}var M=D.length,I=D.replace(/^\s+/,"").length;return M-I}function T(L){return"left: "+L.x*3.125+"%; top: "+L.y1*6.66+"%; width: "+(100-L.x*3.125)+"%; height: "+Math.max(L.y2-1-L.y1,1)*6.66+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function C(L){return L==="red"?"rgb(255, 0, 0)":L==="green"?"rgb(0, 255, 0)":L==="blue"?"rgb(0, 0, 255)":L==="cyan"?"rgb(0, 255, 255)":L==="magenta"?"rgb(255, 0, 255)":L==="yellow"?"rgb(255, 255, 0)":L==="white"?"rgb(255, 255, 255)":L==="black"?"rgb(0, 0, 0)":L}function R(L,D){var x=L.videoHeight/15;return D?"font-size: "+x+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(D.foreground?C(D.foreground):"rgb(255, 255, 255)")+"; font-style: "+(D.italics?"italic":"normal")+"; text-decoration: "+(D.underline?"underline":"none")+"; white-space: pre; background-color: "+(D.background?C(D.background):"transparent")+";":"font-size: "+x+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function b(L){return L.replace(/^\s+/g,"")}function F(L){return L.replace(/\s+$/g,"")}function O(L,D,x,B){var M=null,I=null,U=!1,w=-1,k={start:D,end:x,spans:[]},K="style_cea608_white_black",W={},Y={},J=[],ee,ue;for(ee=0;ee<15;++ee){var ie=B.rows[ee],Q="",se=null;if(ie.isEmpty()===!1){var ve=E(ie.chars);M===null&&(M={x:ve,y1:ee,y2:ee+1,p:[]}),ve!==w&&U&&(M.p.push(k),k={start:D,end:x,spans:[]},M.y2=ee,M.name="region_"+M.x+"_"+M.y1+"_"+M.y2,W.hasOwnProperty(M.name)===!1?(J.push(M),W[M.name]=M):(I=W[M.name],I.p.contat(M.p)),M={x:ve,y1:ee,y2:ee+1,p:[]});for(var _e=0;_e<ie.chars.length;++_e){var Z=ie.chars[_e],Ee=Z.penState;if(se===null||!Ee.equals(se)){Q.trim().length>0&&(k.spans.push({name:K,line:Q,row:ee}),Q="");var Se="style_cea608_"+Ee.foreground+"_"+Ee.background;Ee.underline&&(Se+="_underline"),Ee.italics&&(Se+="_italics"),Y.hasOwnProperty(Se)||(Y[Se]=JSON.parse(JSON.stringify(Ee))),se=Ee,K=Se}Q+=Z.uchar}Q.trim().length>0&&k.spans.push({name:K,line:Q,row:ee}),U=!0,w=ve}else U=!1,w=-1,M&&(M.p.push(k),k={start:D,end:x,spans:[]},M.y2=ee,M.name="region_"+M.x+"_"+M.y1+"_"+M.y2,W.hasOwnProperty(M.name)===!1?(J.push(M),W[M.name]=M):(I=W[M.name],I.p.contat(M.p)),M=null)}M&&(M.p.push(k),M.y2=ee+1,M.name="region_"+M.x+"_"+M.y1+"_"+M.y2,W.hasOwnProperty(M.name)===!1?(J.push(M),W[M.name]=M):(I=W[M.name],I.p.contat(M.p)),M=null);var Me=[];for(ee=0;ee<J.length;++ee){var de=J[ee],xe="sub_cea608_"+_++,Fe=document.createElement("div");Fe.id=xe;var Le=T(de);Fe.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+Le;var De=document.createElement("div");De.className="paragraph bodyStyle",De.style.cssText=R(L);var Ae=document.createElement("div");Ae.className="cueUniWrapper",Ae.style.cssText="unicode-bidi: normal; direction: ltr;";for(var ge=0;ge<de.p.length;++ge){var pe=de.p[ge],Re=0;for(ue=0;ue<pe.spans.length;++ue){var me=pe.spans[ue];if(me.line.length>0){if(ue!==0&&Re!=me.row){var V=document.createElement("br");V.className="lineBreak",Ae.appendChild(V)}var j=!1;Re===me.row&&(j=!0),Re=me.row;var $=Y[me.name],re=document.createElement("span");re.className="spanPadding "+me.name+" customSpanColor",re.style.cssText=R(L,$),ue!==0&&j?ue===pe.spans.length-1?re.textContent=F(me.line):re.textContent=me.line:pe.spans.length>1&&ue<pe.spans.length-1&&me.row===pe.spans[ue+1].row?re.textContent=b(me.line):re.textContent=me.line.trim(),Ae.appendChild(re)}}}De.appendChild(Ae),Fe.appendChild(De);var oe={bodyStyle:["%",90]};for(var X in Y)Y.hasOwnProperty(X)&&(oe[X]=["%",90]);Me.push({type:"html",start:D,end:x,cueHTMLElement:Fe,cueID:xe,cellResolution:[32,15],isFromCEA608:!0,fontSize:oe,lineHeight:{},linePadding:{}})}return Me}return S={createHTMLCaptionsFromScreen:O},S}g.__dashjs_factory_name="EmbeddedTextHtmlRender";const v=m.default.getSingletonFactory(g)},"./src/streaming/text/NotFragmentedTextBufferController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>b});var m=d("./src/core/EventBus.js"),g=d("./src/core/events/Events.js"),v=d("./src/core/FactoryMaker.js"),_=d("./src/streaming/utils/InitCache.js"),S=d("./src/streaming/SourceBufferSink.js"),E=d("./src/streaming/vo/DashJSError.js"),T=d("./src/core/errors/Errors.js"),C="NotFragmentedTextBufferController";function R(F){F=F||{};var O=this.context,L=(0,m.default)(O).getInstance(),D=F.textController,x=F.errHandler,B=F.streamInfo,M=F.type,I,U,w,k,K,W;function Y(){w=!1,k=null,U=!1,W=(0,_.default)(O).getInstance(),L.on(g.default.INIT_FRAGMENT_LOADED,Le,I)}function J(){return C}function ee(fe){ve(fe)}function ue(fe){return new Promise(function(Ce,Pe){try{K=(0,S.default)(O).create({mediaSource:k,textController:D,eventBus:L}),K.initializeForFirstUse(B,fe),w||(K.getBuffer()&&typeof K.getBuffer().initialize=="function"&&K.getBuffer().initialize(),w=!0),Ce(K)}catch(he){x.error(new E.default(T.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,T.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+M)),Pe(he)}})}function ie(){return B.id}function Q(){return M}function se(){return K}function ve(fe){k=fe}function _e(){return k}function Z(){return!1}function Ee(){}function Se(){return 0}function Me(){return U}function de(fe){U!==fe&&(U=fe,U&&ne(g.default.BUFFERING_COMPLETED))}function xe(fe){L.off(g.default.INIT_FRAGMENT_LOADED,Le,I),!fe&&K&&(K.abort(),K.reset(),K=null)}function Fe(fe){return W.extract(B.id,fe)!==null}function Le(fe){!fe.chunk.bytes||U||(W.save(fe.chunk),K.append(fe.chunk),de(!0))}function De(){return null}function Ae(){return!0}function ge(){return[]}function pe(){return Number.POSITIVE_INFINITY}function Re(){return Promise.resolve()}function me(){}function V(){return Promise.resolve()}function j(){return Promise.resolve()}function $(){return U=!1,Promise.resolve()}function re(){return Promise.resolve()}function oe(){}function X(){}function z(){return Promise.resolve()}function ne(fe,Ce){var Pe=Ce||{};L.trigger(fe,Pe,{streamId:B.id,mediaType:M})}return I={initialize:ee,getStreamId:ie,getType:Q,getBufferControllerType:J,createBufferSink:ue,dischargePreBuffer:Ee,getBuffer:se,getBufferLevel:Se,getRangeAt:De,pruneBuffer:me,hasBufferAtTime:Ae,getAllRangesWithSafetyFactor:ge,getContinuousBufferTimeForTargetTime:pe,setMediaSource:ve,getMediaSource:_e,appendInitSegmentFromCache:Fe,getIsBufferingCompleted:Me,setIsBufferingCompleted:de,getIsPruningInProgress:Z,reset:xe,clearBuffers:Re,prepareForPlaybackSeek:j,prepareForReplacementTrackSwitch:$,setSeekTarget:oe,updateAppendWindow:re,pruneAllSafely:z,updateBufferTimestampOffset:V,segmentRequestingCompleted:X},Y(),I}R.__dashjs_factory_name=C;const b=v.default.getClassFactory(R)},"./src/streaming/text/TextController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/core/FactoryMaker.js"),v=d("./src/streaming/text/TextSourceBuffer.js"),_=d("./src/streaming/text/TextTracks.js"),S=d("./src/streaming/utils/VTTParser.js"),E=d("./src/streaming/utils/VttCustomRenderingParser.js"),T=d("./src/streaming/utils/TTMLParser.js"),C=d("./src/core/EventBus.js"),R=d("./src/core/events/Events.js"),b=d("./src/streaming/MediaPlayerEvents.js"),F=d("./src/streaming/utils/SupervisorTools.js");function O(D){var x=this.context,B=D.adapter,M=D.errHandler,I=D.manifestModel,U=D.mediaController,w=D.videoModel,k=D.settings,K,W,Y,J,ee,ue,ie,Q,se,ve,_e,Z;function Ee(){ve=!1,_e=!1,Z=!1,ee=(0,S.default)(x).getInstance(),ue=(0,E.default)(x).getInstance(),ie=(0,T.default)(x).getInstance(),Q=(0,C.default)(x).getInstance(),z()}function Se(){Q.on(R.default.TEXT_TRACKS_QUEUE_INITIALIZED,Ae,K),k.get().streaming.text.webvtt.customRenderingEnabled&&(Q.on(R.default.PLAYBACK_TIME_UPDATED,ge,K),Q.on(R.default.PLAYBACK_SEEKING,pe,K))}function Me(fe){var Ce=fe.id,Pe=(0,_.default)(x).create({videoModel:w,settings:k,streamInfo:fe});Pe.initialize(),J[Ce]=Pe;var he=(0,v.default)(x).create({errHandler:M,adapter:B,manifestModel:I,mediaController:U,videoModel:w,textTracks:Pe,vttParser:ee,vttCustomRenderingParser:ue,ttmlParser:ie,streamInfo:fe,settings:k});he.initialize(),Y[Ce]=he,W[Ce]={},W[Ce].lastEnabledIndex=-1}function de(fe){var Ce=fe.id;J[Ce]&&J[Ce].createTracks()}function xe(fe,Ce,Pe){var he=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,Ue=fe.id;Y[Ue]&&Y[Ue].addMediaInfos(Ce,Pe,he)}function Fe(fe){var Ce=fe.id;if(Y&&Y[Ce])return Y[Ce]}function Le(){return se}function De(fe,Ce){var Pe=fe.id;Y[Pe]&&Y[Pe].addEmbeddedTrack(Ce)}function Ae(fe){var Ce=fe.tracks,Pe=fe.index,he=fe.streamId,Ue=k.get().streaming.text.defaultEnabled;if(Ue===!1&&!me()||Z)j(he,-1);else{var we=U.getCurrentTrackFor(m.default.TEXT,he);if(we){var $e={lang:we.lang,role:we.roles[0],index:we.index,codec:we.codec,accessibility:we.accessibility[0]};Ce.some(function(it,mt){if(U.matchSettings($e,it))return j(he,mt),Pe=mt,!0})}se=!1}W[he].lastEnabledIndex=Pe,Q.trigger(b.default.TEXT_TRACKS_ADDED,{enabled:me(),index:Pe,tracks:Ce,streamId:he}),_e=!0}function ge(fe){try{var Ce=fe.streamId;if(!J[Ce]||isNaN(fe.time))return;J[Ce].manualCueProcessing(fe.time)}catch{}}function pe(fe){try{var Ce=fe.streamId;if(!J[Ce])return;J[Ce].disableManualTracks()}catch{}}function Re(fe,Ce){(0,F.checkParameterType)(Ce,"boolean"),me()!==Ce&&(Ce&&j(fe,W[fe].lastEnabledIndex),Ce||(W[fe].lastEnabledIndex=oe(fe),_e?j(fe,-1):Z=!0))}function me(){var fe=!0;return se&&!ve&&(fe=!1),fe}function V(fe){(0,F.checkParameterType)(fe,"boolean"),ve=fe}function j(fe,Ce){se=Ce===-1,se&&U&&U.saveTextSettingsDisabled();var Pe=oe(fe);if(!(Pe===Ce||!J[fe])){J[fe].disableManualTracks(),J[fe].setModeForTrackIdx(Pe,m.default.TEXT_HIDDEN),J[fe].setCurrentTrackIdx(Ce),J[fe].setModeForTrackIdx(Ce,m.default.TEXT_SHOWING);var he=J[fe].getCurrentTrackInfo();he&&he.isFragmented&&!he.isEmbedded?$(fe,he,Pe):he&&!he.isFragmented&&re(fe,he),U.setTrack(he)}}function $(fe,Ce,Pe){if(Y[fe])for(var he=Y[fe].getConfig(),Ue=he.fragmentedTracks,we=0;we<Ue.length;we++){var $e=Ue[we];if(Ce.lang===$e.lang&&($e.id?Ce.id===$e.id:Ce.index===$e.index)){var it=U.getCurrentTrackFor(m.default.TEXT,fe);($e.id?it.id!==$e.id:it.index!==$e.index)?(J[fe].deleteCuesFromTrackIdx(Pe),Y[fe].setCurrentFragmentedTrackIdx(we)):Pe===-1&&Q.trigger(R.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,{},{streamId:fe,mediaType:m.default.TEXT})}}}function re(fe,Ce){Q.trigger(R.default.SET_NON_FRAGMENTED_TEXT,{currentTrackInfo:Ce},{streamId:fe,mediaType:m.default.TEXT})}function oe(fe){return J[fe].getCurrentTrackIdx()}function X(fe){if(fe){var Ce=fe.id;Y[Ce]&&Y[Ce].resetMediaInfos(),J[Ce]&&J[Ce].deleteAllTextTracks()}}function z(){Y={},J={},W={},se=!0,_e=!1,Z=!1}function ne(){z(),Q.off(R.default.TEXT_TRACKS_QUEUE_INITIALIZED,Ae,K),k.get().streaming.text.webvtt.customRenderingEnabled&&(Q.off(R.default.PLAYBACK_TIME_UPDATED,ge,K),Q.off(R.default.PLAYBACK_SEEKING,pe,K)),Object.keys(Y).forEach(function(fe){Y[fe].resetEmbedded(),Y[fe].reset()})}return K={deactivateStream:X,initialize:Se,initializeForStream:Me,createTracks:de,getTextSourceBuffer:Fe,getAllTracksAreDisabled:Le,addEmbeddedTrack:De,enableText:Re,isTextEnabled:me,setTextTrack:j,getCurrentTrackIdx:oe,enableForcedTextStreaming:V,addMediaInfosToBuffer:xe,reset:ne},Ee(),K}O.__dashjs_factory_name="TextController";const L=g.default.getClassFactory(O)},"./src/streaming/text/TextSourceBuffer.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>M});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/streaming/vo/metrics/HTTPRequest.js"),v=d("./src/streaming/vo/TextTrackInfo.js"),_=d("./src/streaming/utils/BoxParser.js"),S=d("./src/streaming/utils/CustomTimeRanges.js"),E=d("./src/core/FactoryMaker.js"),T=d("./src/core/Debug.js"),C=d("./src/streaming/text/EmbeddedTextHtmlRender.js"),R=d("./node_modules/codem-isoboxer/dist/iso_boxer.js"),b=d("./externals/cea608-parser.js"),F=d.n(b),O=d("./src/core/EventBus.js"),L=d("./src/core/events/Events.js"),D=d("./src/streaming/vo/DashJSError.js"),x=d("./src/core/errors/Errors.js");function B(I){var U=I.errHandler,w=I.manifestModel,k=I.mediaController,K=I.videoModel,W=I.textTracks,Y=I.vttParser,J=I.vttCustomRenderingParser,ee=I.ttmlParser,ue=I.streamInfo,ie=I.settings,Q=this.context,se=(0,O.default)(Q).getInstance(),ve=!1,_e,Z,Ee,Se,Me,de,xe,Fe,Le,De,Ae,ge,pe,Re,me,V;function j(){Z=(0,T.default)(Q).getInstance().getLogger(_e),Ee=(0,_.default)(Q).getInstance(),oe()}function $(){return ue.id}function re(){de=null,Fe=NaN,Le=[],De=null,xe=!1}function oe(){re(),Me=[],Se=null}function X(){ve||he()}function z(Ct,je,Oe){if(Me=Me.concat(je),Ct===m.default.TEXT&&je[0].isFragmented&&!je[0].isEmbedded){de=Oe,_e.buffered=(0,S.default)(Q).create(),Le=k.getTracksFor(m.default.TEXT,ue.id).filter(function(bt){return bt.isFragmented});for(var ze=k.getCurrentTrackFor(m.default.TEXT,ue.id),ct=0;ct<Le.length;ct++)if(Le[ct]===ze){it(ct);break}}for(var dt=0;dt<je.length;dt++)ne(je[dt])}function ne(Ct){var je=new v.default,Oe={subtitle:"subtitles",caption:"captions"};for(var ze in Ct)je[ze]=Ct[ze];je.labels=Ct.labels,je.defaultTrack=Ut(Ct),je.isFragmented=Ct.isFragmented,je.isEmbedded=!!Ct.isEmbedded,je.isTTML=mt(Ct),je.kind=pt(Ct,Oe),W.addTextTrack(je)}function fe(){}function Ce(){oe(),Me=[],Ee=null}function Pe(Ct){var je=Ct.chunk;je.mediaInfo.embeddedCaptions&&Pt(je.bytes,je)}function he(){ge=[],Ae=null,pe=0,me=[],Re=null,ve=!0,V=(0,C.default)(Q).getInstance(),se.on(L.default.VIDEO_CHUNK_RECEIVED,Pe,_e),se.on(L.default.BUFFER_CLEARED,We,_e)}function Ue(){se.off(L.default.VIDEO_CHUNK_RECEIVED,Pe,_e),se.off(L.default.BUFFER_CLEARED,We,_e),W&&W.deleteAllTextTracks(),ve=!1,ge=[],me=[null,null],Re=null}function we(Ct){if(ve&&Ct)if(Ct.id===m.default.CC1||Ct.id===m.default.CC3){for(var je=0;je<ge.length;je++)if(ge[je].id===Ct.id)return;ge.push(Ct)}else Z.warn("Embedded track "+Ct.id+" not supported!")}function $e(){var Ct={fragmentModel:de,fragmentedTracks:Le,videoModel:K};return Ct}function it(Ct){Ae=Ct}function mt(Ct){return Ct.codec&&Ct.codec.search(m.default.STPP)>=0||Ct.mimeType&&Ct.mimeType.search(m.default.TTML)>=0}function pt(Ct,je){var Oe=Ct.roles&&Ct.roles.length>0?je[Ct.roles[0]]:je.caption;return Oe=Oe===je.caption||Oe===je.subtitle?Oe:je.caption,Oe}function Pt(Ct,je){var Oe=je.mediaInfo,ze=Oe.type,ct=Oe.mimeType,dt=Oe.codec||ct;if(!dt){Z.error("No text type defined");return}Oe.codec.indexOf("application/mp4")!==-1?lt(Ct,je,dt):ze===m.default.VIDEO?Wt(Ct,je):Nt(Ct,je,dt)}function lt(Ct,je,Oe){var ze,ct;if(je.segmentType==="InitializationSegment")xe=!0,Fe=Ee.getMediaTimescaleFromMoov(Ct);else{if(!xe)return;ct=Ee.getSamplesInfo(Ct),ze=ct.sampleList,ze.length>0&&(De=ze[0].cts-je.start*Fe),Oe.search(m.default.STPP)>=0?Ye(Ct,ze,Oe):st(Ct,ze)}}function Ye(Ct,je,Oe){var ze,ct;for(Se=Se!==null?Se:Vt(Oe),ze=0;ze<je.length;ze++){var dt=je[ze],bt=dt.cts,Ft=St(),Dt=Ft+bt/Fe,Kt=Dt+dt.duration/Fe;_e.buffered.add(Dt,Kt);var on=new DataView(Ct,dt.offset,dt.subSizes[0]),Tn=R.Utils.dataViewToString(on,m.default.UTF8),Ke=[],ut=dt.offset+dt.subSizes[0];for(ct=1;ct<dt.subSizes.length;ct++){var wt=new Uint8Array(Ct,ut,dt.subSizes[ct]),Gt=String.fromCharCode.apply(null,wt);Ke.push(Gt),ut+=dt.subSizes[ct]}try{var Qt=w.getValue(),sn=Qt.ttmlTimeIsRelative?bt/Fe:0,Dn=Se.parse(Tn,sn,bt/Fe,(bt+dt.duration)/Fe,Ke);W.addCaptions(Ae,Ft,Dn)}catch(pn){de.removeExecutedRequestsBeforeTime(),this.remove(),Z.error("TTML parser error: "+pn.message)}}}function st(Ct,je){var Oe,ze,ct,dt=[];for(Oe=0;Oe<je.length;Oe++){var bt=je[Oe];bt.cts-=De;var Ft=St(),Dt=Ft+bt.cts/Fe,Kt=Dt+bt.duration/Fe;_e.buffered.add(Dt,Kt);var on=Ct.slice(bt.offset,bt.offset+bt.size),Tn=R.parseBuffer(on);for(ze=0;ze<Tn.boxes.length;ze++){var Ke=Tn.boxes[ze];if(Z.debug("VTT box1: "+Ke.type),Ke.type!=="vtte"&&Ke.type==="vttc")for(Z.debug("VTT vttc boxes.length = "+Ke.boxes.length),ct=0;ct<Ke.boxes.length;ct++){var ut=Ke.boxes[ct];if(Z.debug("VTT box2: "+ut.type),ut.type==="payl"){var wt=ut.cue_text;Z.debug("VTT cue_text = "+wt);var Gt=bt.cts/Fe,Qt=(bt.cts+bt.duration)/Fe;dt.push({start:Gt,end:Qt,data:wt,styles:{}}),Z.debug("VTT "+Gt+"-"+Qt+" : "+wt)}}}}dt.length>0&&W.addCaptions(Ae,0,dt)}function Nt(Ct,je,Oe){var ze,ct,dt=new DataView(Ct,0,Ct.byteLength);ct=R.Utils.dataViewToString(dt,m.default.UTF8);try{ze=Vt(Oe).parse(ct,0),W.addCaptions(W.getCurrentTrackIdx(),0,ze),_e.buffered&&_e.buffered.add(je.start,je.end)}catch(bt){U.error(new D.default(x.default.TIMED_TEXT_ERROR_ID_PARSE_CODE,x.default.TIMED_TEXT_ERROR_MESSAGE_PARSE+bt.message,ct))}}function Wt(Ct,je){var Oe,ze;if(je.segmentType===g.HTTPRequest.INIT_SEGMENT_TYPE)pe===0&&(pe=Ee.getMediaTimescaleFromMoov(Ct));else if(je.segmentType===g.HTTPRequest.MEDIA_SEGMENT_TYPE){if(pe===0){Z.warn("CEA-608: No timescale for embeddedTextTrack yet");return}ze=Ee.getSamplesInfo(Ct);var ct=ze.lastSequenceNumber;if(!me[0]&&!me[1]&&Ht(),pe){if(Re!==null&&ct!==Re+ze.numSequences)for(Oe=0;Oe<me.length;Oe++)me[Oe]&&me[Oe].reset();for(var dt=Et(Ct,ze.sampleList),bt=0;bt<me.length;bt++){var Ft=dt.fields[bt],Dt=me[bt];if(Dt)for(Oe=0;Oe<Ft.length;Oe++)Dt.addData(Ft[Oe][0]/pe,Ft[Oe][1])}Re=ct}}}function Ht(){for(var Ct,je=0;je<ge.length;je++){if(Ct=W.getTrackIdxForId(ge[je].id),Ct===-1){Z.warn("CEA-608: data before track is ready.");return}var Oe=nt(Ct);me[je]=new(F()).Cea608Parser(je+1,{newCue:Oe},null)}}function nt(Ct){function je(Oe,ze,ct){var dt;if(K.getTTMLRenderingDiv())dt=V.createHTMLCaptionsFromScreen(K.getElement(),Oe,ze,ct);else{var bt=ct.getDisplayText();dt=[{start:Oe,end:ze,data:bt,styles:{}}]}dt&&W.addCaptions(Ct,0,dt)}return je}function Et(Ct,je){if(je.length===0)return null;for(var Oe={splits:[],fields:[[],[]]},ze=new DataView(Ct),ct=0;ct<je.length;ct++)for(var dt=je[ct],bt=F().findCea608Nalus(ze,dt.offset,dt.size),Ft=null,Dt=0,Kt=0;Kt<bt.length;Kt++)for(var on=F().extractCea608DataFromRange(ze,bt[Kt]),Tn=0;Tn<2;Tn++)if(on[Tn].length>0){dt.cts!==Ft?Dt=0:Dt+=1;var Ke=St();Oe.fields[Tn].push([dt.cts+Ke*pe,on[Tn],Dt]),Ft=dt.cts}return Oe.fields.forEach(function(wt){wt.sort(function(Gt,Qt){return Gt[0]===Qt[0]?Gt[2]-Qt[2]:Gt[0]-Qt[0]})}),Oe}function St(){return isNaN(_e.timestampOffset)?0:_e.timestampOffset}function Ut(Ct){var je=!1;return ge.length>1&&Ct.isEmbedded?je=Ct.id&&Ct.id===m.default.CC1:ge.length===1?Ct.id&&typeof Ct.id=="string"&&Ct.id.substring(0,2)==="CC"&&(je=!0):ge.length===0&&(je=Ct.index===Me[0].index),je}function Vt(Ct){var je;return Ct.search(m.default.VTT)>=0?je=ie.get().streaming.text.webvtt.customRenderingEnabled&&J?J:Y:(Ct.search(m.default.TTML)>=0||Ct.search(m.default.STPP)>=0)&&(je=ee),je}function Zt(Ct,je){Ct===void 0&&Ct===je&&(Ct=_e.buffered.start(0),je=_e.buffered.end(_e.buffered.length-1)),_e.buffered.remove(Ct,je),W.deleteCuesFromTrackIdx(Ae,Ct,je)}function We(Ct){ge.forEach(function(je){var Oe=W.getTrackIdxForId(je.id);Oe>=0&&W.deleteCuesFromTrackIdx(Oe,Ct.from,Ct.to)})}function In(){Me=[]}return _e={initialize:X,addMediaInfos:z,resetMediaInfos:In,getStreamId:$,append:Pt,abort:fe,addEmbeddedTrack:we,resetEmbedded:Ue,getConfig:$e,setCurrentFragmentedTrackIdx:it,remove:Zt,reset:Ce},j(),_e}B.__dashjs_factory_name="TextSourceBuffer";const M=E.default.getClassFactory(B)},"./src/streaming/text/TextTracks.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/core/EventBus.js"),v=d("./src/core/events/Events.js"),_=d("./src/streaming/MediaPlayerEvents.js"),S=d("./src/core/FactoryMaker.js"),E=d("./src/core/Debug.js"),T=d("./node_modules/imsc/src/main/js/main.js");function C(D,x){var B;if(typeof Symbol>"u"||D[Symbol.iterator]==null){if(Array.isArray(D)||(B=R(D))||x&&D&&typeof D.length=="number"){B&&(D=B);var M=0,I=function(){};return{s:I,n:function(){return M>=D.length?{done:!0}:{done:!1,value:D[M++]}},e:function(W){throw W},f:I}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var U=!0,w=!1,k;return{s:function(){B=D[Symbol.iterator]()},n:function(){var W=B.next();return U=W.done,W},e:function(W){w=!0,k=W},f:function(){try{!U&&B.return!=null&&B.return()}finally{if(w)throw k}}}}function R(D,x){if(D){if(typeof D=="string")return b(D,x);var B=Object.prototype.toString.call(D).slice(8,-1);if(B==="Object"&&D.constructor&&(B=D.constructor.name),B==="Map"||B==="Set")return Array.from(D);if(B==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(B))return b(D,x)}}function b(D,x){(x==null||x>D.length)&&(x=D.length);for(var B=0,M=new Array(x);B<x;B++)M[B]=D[B];return M}var F=["text","images","embeddedImages","align","fontSize","id","isd","line","lineAlign","lineHeight","linePadding","position","positionAlign","region","size","snapToLines","vertical"];function O(D){var x=this.context,B=(0,g.default)(x).getInstance(),M=D.videoModel,I=D.streamInfo,U=D.settings,w,k,K,W,Y,J,ee,ue,ie,Q,se,ve,_e,Z,Ee,Se,Me,de;function xe(){k=(0,E.default)(x).getInstance().getLogger(w)}function Fe(){typeof window>"u"||typeof navigator>"u"||(K=window.VTTCue||window.TextTrackCue,W=[],Y=[],J=-1,ee=0,ue=0,ie=0,Q=0,se=null,ve=null,_e=null,Ee=!1,Me=2147483647,Se=null,document.fullscreenElement!==void 0?Z="fullscreenElement":document.webkitIsFullScreen!==void 0?Z="webkitIsFullScreen":document.msFullscreenElement?Z="msFullscreenElement":document.mozFullScreen&&(Z="mozFullScreen"))}function Le(){return I.id}function De(nt){var Et=nt.kind,St=nt.id!==void 0?nt.id:nt.lang,Ut=nt.lang,Vt=nt.isTTML,Zt=nt.isEmbedded,We=M.addTextTrack(Et,St,Ut,Vt,Zt);return We}function Ae(nt){W.push(nt)}function ge(){W.sort(function(In,Ct){return In.index-Ct.index}),se=M.getTTMLRenderingDiv(),ve=M.getVttRenderingDiv();for(var nt=-1,Et=0;Et<W.length;Et++){var St=De(W[Et]);Y.push(St),W[Et].defaultTrack&&(St.default=!0,nt=Et);var Ut=Ce(Et);Ut&&(Ut.mode=m.default.TEXT_SHOWING,se&&(W[Et].isTTML||W[Et].isEmbedded)?Ut.renderingType="html":Ut.renderingType="default"),re(Et,0,W[Et].captionData),B.trigger(_.default.TEXT_TRACK_ADDED)}if(Ue.call(this,nt),nt>=0){var Vt=function In(){var Ct=Ce(nt);Ct&&Ct.renderingType==="html"&&Re.call(this,Ct,!0),B.off(_.default.PLAYBACK_METADATA_LOADED,In,this)};B.on(_.default.PLAYBACK_METADATA_LOADED,Vt,this);for(var Zt=0;Zt<W.length;Zt++){var We=Ce(Zt);We&&(We.mode=Zt===nt?m.default.TEXT_SHOWING:m.default.TEXT_HIDDEN,We.manualMode=Zt===nt?m.default.TEXT_SHOWING:m.default.TEXT_HIDDEN)}}B.trigger(v.default.TEXT_TRACKS_QUEUE_INITIALIZED,{index:J,tracks:W,streamId:I.id})}function pe(nt,Et,St,Ut,Vt,Zt){var We=nt/Et,In=St/Ut,Ct=0,je=0;We>In?(je=Et,Ct=je/Ut*St):(Ct=nt,je=Ct/St*Ut);var Oe=0,ze=0,ct=0,dt=0,bt=Ct/je;return bt>Vt?(dt=je,ct=je*Vt):(ct=Ct,dt=Ct/Vt),Oe=(nt-ct)/2,ze=(Et-dt)/2,Zt?{x:Oe+ct*.1,y:ze+dt*.1,w:ct*.8,h:dt*.8}:{x:Oe,y:ze,w:ct,h:dt}}function Re(nt,Et){var St=M.getClientWidth(),Ut=M.getClientHeight(),Vt=M.getVideoWidth(),Zt=M.getVideoHeight(),We=M.getVideoRelativeOffsetTop(),In=M.getVideoRelativeOffsetLeft();if(Vt!==0&&Zt!==0){var Ct=Vt/Zt,je=!1;nt.isFromCEA608&&(Ct=1.1666666666666667,je=!0);var Oe=pe.call(this,St,Ut,Vt,Zt,Ct,je),ze=Oe.w,ct=Oe.h,dt=Oe.x,bt=Oe.y;if(ze!=ie||ct!=Q||dt!=ee||bt!=ue||Et){if(ee=dt+In,ue=bt+We,ie=ze,Q=ct,se){var Ft=se.style;Ft&&(Ft.left=ee+"px",Ft.top=ue+"px",Ft.width=ie+"px",Ft.height=Q+"px",Ft.zIndex=Z&&document[Z]||Ee?Me:null,B.trigger(_.default.CAPTION_CONTAINER_RESIZE))}var Dt=nt.activeCues;if(Dt)for(var Kt=Dt.length,on=0;on<Kt;++on){var Tn=Dt[on];Tn.scaleCue(Tn)}}}}function me(nt){var Et=ie,St=Q,Ut,Vt,Zt,We,In;if(nt.cellResolution){var Ct=[Et/nt.cellResolution[0],St/nt.cellResolution[1]];if(nt.linePadding){for(Ut in nt.linePadding)if(nt.linePadding.hasOwnProperty(Ut)){var je=nt.linePadding[Ut];Vt=(je*Ct[0]).toString();for(var Oe=document.getElementsByClassName("spanPadding"),ze=0;ze<Oe.length;ze++)Oe[ze].style.cssText=Oe[ze].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Vt),Oe[ze].style.cssText=Oe[ze].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Vt)}}if(nt.fontSize){for(Ut in nt.fontSize)if(nt.fontSize.hasOwnProperty(Ut)){nt.fontSize[Ut][0]==="%"?Zt=nt.fontSize[Ut][1]/100:nt.fontSize[Ut][0]==="c"&&(Zt=nt.fontSize[Ut][1]),Vt=(Zt*Ct[1]).toString(),Ut!=="defaultFontSize"?In=document.getElementsByClassName(Ut):In=document.getElementsByClassName("paragraph");for(var ct=0;ct<In.length;ct++)In[ct].style.cssText=In[ct].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Vt)}if(nt.lineHeight){for(Ut in nt.lineHeight)if(nt.lineHeight.hasOwnProperty(Ut)){nt.lineHeight[Ut][0]==="%"?We=nt.lineHeight[Ut][1]/100:nt.fontSize[Ut][0]==="c"&&(We=nt.lineHeight[Ut][1]),Vt=(We*Ct[1]).toString(),In=document.getElementsByClassName(Ut);for(var dt=0;dt<In.length;dt++)In[dt].style.cssText=In[dt].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Vt)}}}}if(nt.isd){var bt=document.getElementById(nt.cueID);bt&&se.removeChild(bt),V(nt)}}function V(nt){if(se){var Et=document.createElement("div");se.appendChild(Et),Se=(0,T.renderHTML)(nt.isd,Et,function(St){var Ut=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,Vt=/^#(.*)$/;if(Ut.test(St)){var Zt=Ut.exec(St),We=parseInt(Zt[4],10)-1,In=btoa(nt.images[We]),Ct="data:image/png;base64,"+In;return Ct}else if(Vt.test(St)){var je=Vt.exec(St),Oe=je[1],ze="data:image/png;base64,"+nt.embeddedImages[Oe];return ze}else return null},se.clientHeight,se.clientWidth,!1,function(St){k.info("renderCaption :",St)},Se,!0),Et.id=nt.cueID,B.trigger(_.default.CAPTION_RENDERED,{captionDiv:Et,currentTrackIdx:J})}}function j(nt,Et){if(!U.get().streaming.text.extendSegmentedCues||!Et.cues||Et.cues.length===0)return!1;var St=Et.cues[Et.cues.length-1];return St.endTime!==nt.startTime||!$(St,nt,F)?!1:(St.endTime=nt.endTime,!0)}function $(nt,Et,St){for(var Ut=0;Ut<St.length;Ut++){var Vt=St[Ut];if(JSON.stringify(nt[Vt])!==JSON.stringify(Et[Vt]))return!1}return!0}function re(nt,Et,St){var Ut=Ce(nt);if(Ut&&!(!Array.isArray(St)||St.length===0))for(var Vt=0;Vt<St.length;Vt++){var Zt=void 0,We=St[Vt];Ut.cellResolution=We.cellResolution,Ut.isFromCEA608=We.isFromCEA608,!isNaN(We.start)&&!isNaN(We.end)&&(Zt=We.type==="html"&&se?oe(We,Et,Ut):We.data?X(We,Et,Ut):null);try{Zt?$e(Ut,Zt)||(U.get().streaming.text.webvtt.customRenderingEnabled?(Ut.manualCueList||(Ut.manualCueList=[]),Ut.manualCueList.push(Zt)):j(Zt,Ut)||Ut.addCue(Zt)):k.error("Impossible to display subtitles. You might have missed setting a TTML rendering div via player.attachTTMLRenderingDiv(TTMLRenderingDiv)")}catch(In){throw mt(Ut),Ut.addCue(Zt),In}}}function oe(nt,Et,St){var Ut=this,Vt=new K(nt.start+Et,nt.end+Et,"");return Vt.cueHTMLElement=nt.cueHTMLElement,Vt.isd=nt.isd,Vt.images=nt.images,Vt.embeddedImages=nt.embeddedImages,Vt.cueID=nt.cueID,Vt.scaleCue=me.bind(Ut),Vt.cellResolution=nt.cellResolution,Vt.lineHeight=nt.lineHeight,Vt.linePadding=nt.linePadding,Vt.fontSize=nt.fontSize,se.style.left=ee+"px",se.style.top=ue+"px",se.style.width=ie+"px",se.style.height=Q+"px",Vt.onenter=function(){St.mode===m.default.TEXT_SHOWING&&(this.isd?(V(this),k.debug("Cue enter id:"+this.cueID)):(se.appendChild(this.cueHTMLElement),me.call(Ut,this),B.trigger(_.default.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:J})))},Vt.onexit=function(){if(se)for(var Zt=se.childNodes,We=0;We<Zt.length;++We)Zt[We].id===this.cueID&&(k.debug("Cue exit id:"+Zt[We].id),se.removeChild(Zt[We]),--We)},Vt}function X(nt,Et,St){var Ut=new K(nt.start-Et,nt.end-Et,nt.data);if(Ut.cueID="".concat(Ut.startTime,"_").concat(Ut.endTime),Ut.isActive=!1,nt.styles)try{nt.styles.align!==void 0&&"align"in Ut&&(Ut.align=nt.styles.align),nt.styles.line!==void 0&&"line"in Ut&&(Ut.line=nt.styles.line),nt.styles.position!==void 0&&"position"in Ut&&(Ut.position=nt.styles.position),nt.styles.size!==void 0&&"size"in Ut&&(Ut.size=nt.styles.size)}catch(Vt){k.error(Vt)}return Ut.onenter=function(){St.mode===m.default.TEXT_SHOWING&&B.trigger(_.default.CAPTION_RENDERED,{currentTrackIdx:J})},Ut}function z(nt){var Et=fe();if(Et&&Et.length>0){var St=Et[0],Ut=St.manualCueList;Ut&&Ut.length>0&&Ut.forEach(function(Vt){if(Vt.startTime<=nt&&Vt.endTime>=nt&&!Vt.isActive)Vt.isActive=!0,WebVTT.processCues(window,[Vt],ve,Vt.cueID);else if(Vt.isActive&&(Vt.startTime>nt||Vt.endTime<nt)&&(Vt.isActive=!1,ve))for(var Zt=ve.childNodes,We=0;We<Zt.length;++We)Zt[We].id===Vt.cueID&&(ve.removeChild(Zt[We]),--We)})}}function ne(){var nt=fe();if(nt&&nt.length>0){var Et=nt[0],St=Et.manualCueList;St&&St.length>0&&St.forEach(function(Ut){if(Ut.isActive&&(Ut.isActive=!1,ve))for(var Vt=ve.childNodes,Zt=0;Zt<Vt.length;++Zt)Vt[Zt].id===Ut.cueID&&(ve.removeChild(Vt[Zt]),--Zt)})}}function fe(){var nt=M.getTextTracks(),Et=[],St=C(nt),Ut;try{for(St.s();!(Ut=St.n()).done;){var Vt=Ut.value;Vt.manualMode===m.default.TEXT_SHOWING&&Et.push(Vt)}}catch(Zt){St.e(Zt)}finally{St.f()}return Et}function Ce(nt){return nt>=0&&W[nt]?M.getTextTrack(W[nt].kind,W[nt].id,W[nt].lang,W[nt].isTTML,W[nt].isEmbedded):null}function Pe(){return J}function he(nt){for(var Et=-1,St=0;St<W.length;St++)if(W[St].id===nt){Et=St;break}return Et}function Ue(nt){var Et=this;if(nt!==J){J=nt;var St=Ce(J);we.call(this,St),_e&&(clearInterval(_e),_e=null),St&&St.renderingType==="html"&&(Re.call(this,St,!0),window.ResizeObserver?(de=new window.ResizeObserver(function(){Re.call(Et,St,!0)}),de.observe(M.getElement())):_e=setInterval(Re.bind(this,St),500))}}function we(nt){Nt.call(this),nt?nt.renderingType==="html"?Ye.call(this):st.call(this):st.call(this)}function $e(nt,Et){if(!nt.cues)return!1;for(var St=0;St<nt.cues.length;St++)if(nt.cues[St].startTime===Et.startTime&&nt.cues[St].endTime===Et.endTime)return!0;return!1}function it(nt,Et,St){var Ut=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return(isNaN(Et)||(Ut?nt.startTime:nt.endTime)>=Et)&&(isNaN(St)||(Ut?nt.endTime:nt.startTime)<=St)}function mt(nt,Et,St){var Ut=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;if(nt.cues)for(var Vt=nt.cues,Zt=Vt.length-1,We=Zt;We>=0;We--)it(Vt[We],Et,St,Ut)&&(Vt[We].onexit&&Vt[We].onexit(),nt.removeCue(Vt[We]))}function pt(nt,Et,St){var Ut=Ce(nt);Ut&&mt(Ut,Et,St)}function Pt(){for(var nt=Y?Y.length:0,Et=0;Et<nt;Et++){var St=Ce(Et);St&&mt.call(this,St,I.start,I.start+I.duration,!1)}Y=[],W=[],_e&&(clearInterval(_e),_e=null),de&&M&&(de.unobserve(M.getElement()),de=null),J=-1,Nt.call(this)}function lt(nt){M.removeChild(Y[nt]),Y.splice(nt,1)}function Ye(){var nt=document.getElementById("native-cue-style");if(!nt){nt=document.createElement("style"),nt.id="native-cue-style",document.head.appendChild(nt);var Et=nt.sheet,St=M.getElement();try{St&&(St.id?Et.insertRule("#"+St.id+"::cue {background: transparent}",0):St.classList.length!==0?Et.insertRule("."+St.className+"::cue {background: transparent}",0):Et.insertRule("video::cue {background: transparent}",0))}catch(Ut){k.info(""+Ut.message)}}}function st(){var nt=document.getElementById("native-cue-style");nt&&document.head.removeChild(nt)}function Nt(){if(se)for(;se.firstChild;)se.removeChild(se.firstChild)}function Wt(nt,Et){var St=Ce(nt);St&&St.mode!==Et&&(St.mode=Et),St&&St.manualMode!==Et&&(St.manualMode=Et)}function Ht(){return W[J]}return w={initialize:Fe,getStreamId:Le,addTextTrack:Ae,addCaptions:re,createTracks:ge,getCurrentTrackIdx:Pe,setCurrentTrackIdx:Ue,getTrackIdxForId:he,getCurrentTrackInfo:Ht,setModeForTrackIdx:Wt,deleteCuesFromTrackIdx:pt,deleteAllTextTracks:Pt,deleteTextTrack:lt,manualCueProcessing:z,disableManualTracks:ne},xe(),w}O.__dashjs_factory_name="TextTracks";const L=S.default.getClassFactory(O)},"./src/streaming/thumbnail/ThumbnailController.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>C});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/constants/Constants.js"),v=d("./src/streaming/vo/Thumbnail.js"),_=d("./src/streaming/thumbnail/ThumbnailTracks.js"),S=d("./src/streaming/vo/BitrateInfo.js"),E=d("./src/dash/utils/SegmentsUtils.js");function T(R){var b=this.context,F=R.streamInfo,O,L;function D(){K(),L=(0,_.default)(b).create({streamInfo:F,adapter:R.adapter,baseURLController:R.baseURLController,timelineConverter:R.timelineConverter,debug:R.debug,eventBus:R.eventBus,events:R.events,dashConstants:R.dashConstants,dashMetrics:R.dashMetrics,segmentBaseController:R.segmentBaseController})}function x(){L.addTracks();var W=L.getTracks();W&&W.length>0&&U(0)}function B(){return F.id}function M(W,Y){if(typeof Y=="function"){var J=L.getCurrentTrack(),ee,ue;if(!J||J.segmentDuration<=0||W===void 0||W===null){Y(null);return}ue=L.getThumbnailRequestForTime(W),ue&&(J.segmentDuration=ue.duration),ee=W%J.segmentDuration;var ie=Math.floor(ee*J.tilesHor*J.tilesVert/J.segmentDuration),Q=new v.default;if(Q.width=Math.floor(J.widthPerTile),Q.height=Math.floor(J.heightPerTile),Q.x=Math.floor(ie%J.tilesHor)*J.widthPerTile,Q.y=Math.floor(ie/J.tilesHor)*J.heightPerTile,"readThumbnail"in J)return J.readThumbnail(W,function(ve){Q.url=ve,Y(Q)});if(ue)Q.url=ue.url,J.segmentDuration=NaN;else{var se=Math.floor(W/J.segmentDuration);Q.url=I(J,se)}Y(Q)}}function I(W,Y){var J=Y+W.startNumber,ee=(0,E.replaceTokenForTemplate)(W.templateUrl,"Number",J);return ee=(0,E.replaceTokenForTemplate)(ee,"Time",(J-1)*W.segmentDuration*W.timescale),ee=(0,E.replaceTokenForTemplate)(ee,"Bandwidth",W.bandwidth),(0,E.unescapeDollarsInTemplate)(ee)}function U(W){L.setTrackByIndex(W)}function w(){return L.getCurrentTrackIndex()}function k(){var W=L.getTracks(),Y=0;return W.map(function(J){var ee=new S.default;return ee.mediaType=g.default.IMAGE,ee.qualityIndex=Y++,ee.bitrate=J.bitrate,ee.width=J.width,ee.height=J.height,ee})}function K(){L&&L.reset()}return O={getStreamId:B,initialize:x,provide:M,setTrackByIndex:U,getCurrentTrackIndex:w,getBitrateList:k,reset:K},D(),O}T.__dashjs_factory_name="ThumbnailController";const C=m.default.getClassFactory(T)},"./src/streaming/thumbnail/ThumbnailTracks.js":(h,f,d)=>{d.r(f),d.d(f,{THUMBNAILS_SCHEME_ID_URIS:()=>F,default:()=>L});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/dash/constants/DashConstants.js"),v=d("./src/core/FactoryMaker.js"),_=d("./src/streaming/vo/ThumbnailTrackInfo.js"),S=d("./src/streaming/utils/URLUtils.js"),E=d("./src/dash/utils/SegmentsUtils.js"),T=d("./src/streaming/utils/BoxParser.js"),C=d("./src/streaming/net/XHRLoader.js"),R=d("./src/dash/DashHandler.js"),b=d("./src/dash/controllers/SegmentsController.js"),F=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function O(D){var x=this.context,B=D.adapter,M=D.baseURLController,I=D.streamInfo,U=D.timelineConverter,w=D.debug,k=D.eventBus,K=D.events,W=D.dashConstants,Y=(0,S.default)(x).getInstance(),J,ee,ue,ie,Q,se,ve,_e;function Z(){pe(),ve=(0,C.default)(x).create({}),_e=(0,T.default)(x).getInstance(),se=(0,b.default)(x).create({events:K,eventBus:k,streamInfo:I,timelineConverter:U,dashConstants:W,dashMetrics:D.dashMetrics,segmentBaseController:D.segmentBaseController,type:m.default.IMAGE}),ue=(0,R.default)(x).create({streamInfo:I,type:m.default.IMAGE,timelineConverter:U,segmentsController:se,baseURLController:M,debug:w,eventBus:k,events:K,dashConstants:W,urlUtils:Y}),ue.initialize(B?B.getIsDynamic():!1)}function Ee(){if(!(!I||!B)&&(Q=B.getMediaInfoForType(I,m.default.IMAGE),!!Q)){var Re=B.getVoRepresentations(Q);Re&&Re.length>0&&Re.forEach(function(me){(me.segmentInfoType===g.default.SEGMENT_TEMPLATE&&me.segmentDuration>0&&me.media||me.segmentInfoType===g.default.SEGMENT_TIMELINE)&&Se(me),me.segmentInfoType===g.default.SEGMENT_BASE&&Se(me,!0)}),ee.length>0&&ee.sort(function(me,V){return me.bitrate-V.bitrate})}}function Se(Re,me){var V=new _.default;V.id=Re.id,V.bitrate=Re.bandwidth,V.width=Re.width,V.height=Re.height,V.tilesHor=1,V.tilesVert=1,Re.essentialProperties&&Re.essentialProperties.forEach(function(j){if(F.indexOf(j.schemeIdUri)>=0&&j.value){var $=j.value.split("x");$.length===2&&!isNaN($[0])&&!isNaN($[1])&&(V.tilesHor=parseInt($[0],10),V.tilesVert=parseInt($[1],10))}}),me?se.updateSegmentData(Re).then(function(j){Me(V,Re,j)}):(V.startNumber=Re.startNumber,V.segmentDuration=Re.segmentDuration,V.timescale=Re.timescale,V.templateUrl=xe(Re)),V.tilesHor>0&&V.tilesVert>0&&(V.widthPerTile=V.width/V.tilesHor,V.heightPerTile=V.height/V.tilesVert,ee.push(V))}function Me(Re,me,V){var j=[],$=de(V,me);me.segments=$,Re.segmentDuration=me.segments[0].duration,Re.readThumbnail=function(re,oe){var X=null;j.some(function(z){if(z.start<=re&&z.end>re)return X=z.url,!0}),X?oe(X):me.segments.some(function(z){if(z.mediaStartTime<=re&&z.mediaStartTime+z.duration>re){var ne=M.resolve(me.path);return ve.load({method:"get",url:ne.url,request:{range:z.mediaRange,responseType:"arraybuffer"},onload:function(Ce){var Pe=_e.getSamplesInfo(Ce.target.response),he=new Blob([Ce.target.response.slice(Pe.sampleList[0].offset,Pe.sampleList[0].offset+Pe.sampleList[0].size)],{type:"image/jpeg"}),Ue=window.URL.createObjectURL(he);j.push({start:z.mediaStartTime,end:z.mediaStartTime+z.duration,url:Ue}),oe&&oe(Ue)}}),!0}})}}function de(Re,me){var V=[],j=0,$,re,oe,X;for($=0,re=Re.segments.length;$<re;$++)oe=Re.segments[$],X=(0,E.getTimeBasedSegment)(U,B.getIsDynamic(),me,oe.startTime,oe.duration,oe.timescale,oe.media,oe.mediaRange,j),X&&(V.push(X),X=null,j++);return V}function xe(Re){var me=Y.isRelative(Re.media)?Y.resolve(Re.media,M.resolve(Re.path).url):Re.media;return me?(0,E.replaceIDForTemplate)(me,Re.id):""}function Fe(){return ee}function Le(){return ie}function De(){return ie<0?null:ee[ie]}function Ae(Re){!ee||ee.length===0||(Re>=ee.length&&(Re=ee.length-1),ie=Re)}function ge(Re){for(var me,V=B.getVoRepresentations(Q),j=0;j<V.length;j++)if(ee[ie].id===V[j].id){me=V[j];break}return ue.getSegmentRequestForTime(Q,me,Re)}function pe(){ee=[],ie=-1,Q=null}return J={getTracks:Fe,addTracks:Ee,reset:pe,setTrackByIndex:Ae,getCurrentTrack:De,getCurrentTrackIndex:Le,getThumbnailRequestForTime:ge},Z(),J}O.__dashjs_factory_name="ThumbnailTracks";const L=v.default.getClassFactory(O)},"./src/streaming/utils/BaseURLSelector.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/core/errors/Errors.js"),g=d("./src/core/EventBus.js"),v=d("./src/core/events/Events.js"),_=d("./src/streaming/controllers/BlacklistController.js"),S=d("./src/streaming/utils/baseUrlResolution/DVBSelector.js"),E=d("./src/streaming/utils/baseUrlResolution/BasicSelector.js"),T=d("./src/core/FactoryMaker.js"),C=d("./src/streaming/vo/DashJSError.js"),R=d("./src/streaming/utils/SupervisorTools.js"),b=d("./src/streaming/utils/baseUrlResolution/ContentSteeringSelector.js"),F=d("./src/core/Settings.js");function O(){var D=this.context,x=(0,g.default)(D).getInstance(),B=(0,F.default)(D).getInstance(),M,I,U,w,k,K;function W(){I=(0,_.default)(D).create({updateEventName:v.default.SERVICE_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:v.default.SERVICE_LOCATION_BLACKLIST_ADD}),U=(0,E.default)(D).create({blacklistController:I}),w=(0,S.default)(D).create({blacklistController:I}),k=(0,b.default)(D).create(),k.setConfig({blacklistController:I}),K=U}function Y(ie){ie.selector&&(K=ie.selector),ie.contentSteeringSelector&&(k=ie.contentSteeringSelector)}function J(ie){(0,R.checkParameterType)(ie,"boolean"),K=ie?w:U}function ee(ie){if(ie){if(B.get().streaming.applyContentSteering){var Q=k.selectBaseUrlIndex(ie);!isNaN(Q)&&Q!==-1&&(ie.selectedIdx=Q)}if(!isNaN(ie.selectedIdx))return ie.baseUrls[ie.selectedIdx];var se=K.select(ie.baseUrls);if(!se){x.trigger(v.default.URL_RESOLUTION_FAILED,{error:new C.default(m.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,m.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),K===U&&ue();return}return ie.selectedIdx=ie.baseUrls.indexOf(se),se}}function ue(){I.reset()}return M={chooseSelector:J,select:ee,reset:ue,setConfig:Y},W(),M}O.__dashjs_factory_name="BaseURLSelector";const L=T.default.getClassFactory(O)},"./src/streaming/utils/BoxParser.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>T});var m=d("./src/core/Debug.js"),g=d("./src/streaming/utils/IsoFile.js"),v=d("./src/core/FactoryMaker.js"),_=d("./node_modules/codem-isoboxer/dist/iso_boxer.js"),S=d("./src/streaming/vo/IsoBoxSearchInfo.js");function E(){var C,R,b=this.context;function F(){C=(0,m.default)(b).getInstance().getLogger(R)}function O(w){if(!w)return null;w.fileStart===void 0&&(w.fileStart=0);var k=_.parseBuffer(w),K=(0,g.default)(b).create();return K.setData(k),K}function L(w,k,K){if(K===void 0&&(K=0),!k||K+8>=k.byteLength)return new S.default(0,!1);for(var W=k instanceof ArrayBuffer?new Uint8Array(k):k,Y,J=0;K<W.byteLength;){var ee=B(W,K),ue=M(W,K+4);if(ee===0)break;K+ee<=W.byteLength&&(w.indexOf(ue)>=0?Y=new S.default(K,!0,ee):J=K+ee),K+=ee}return Y||new S.default(J,!1)}function D(w){if(!w||w.byteLength===0)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var k=O(w),K=k.getBoxes("moof"),W=k.getBoxes("mfhd"),Y,J,ee,ue,ie,Q,se,ve,_e,Z,Ee,Se,Me,de,xe,Fe,Le;Fe=k.getBoxes("moof").length,xe=W[W.length-1].sequence_number,ee=0,Q=[];var De=-1,Ae=-1;for(Ee=0;Ee<K.length;Ee++){var ge=K[Ee],pe=ge.getChildBoxes("traf");for(_e=0;_e<pe.length;_e++){var Re=pe[_e],me=Re.getChildBox("tfhd"),V=Re.getChildBox("tfdt");ie=V.baseMediaDecodeTime;var j=Re.getChildBoxes("trun"),$=Re.getChildBoxes("subs");for(Z=0;Z<j.length;Z++){var re=j[Z];for(ee=re.sample_count,de=(me.base_data_offset||0)+(re.data_offset||0),ve=0;ve<ee;ve++){se=re.samples[ve],Y=se.sample_duration!==void 0?se.sample_duration:me.default_sample_duration,ue=se.sample_size!==void 0?se.sample_size:me.default_sample_size,J=se.sample_composition_time_offset!==void 0?se.sample_composition_time_offset:0;var oe={dts:ie,cts:ie+J,duration:Y,offset:ge.offset+de,size:ue,subSizes:[ue]};if($)for(Se=0;Se<$.length;Se++){var X=$[Se];if(De<X.entry_count-1&&ve>Ae&&(De++,Ae+=X.entries[De].sample_delta),ve==Ae){oe.subSizes=[];var z=X.entries[De];for(Me=0;Me<z.subsample_count;Me++)oe.subSizes.push(z.subsamples[Me].subsample_size)}}Q.push(oe),de+=ue,ie+=Y}}Le=ie-V.baseMediaDecodeTime}}return{sampleList:Q,lastSequenceNumber:xe,totalDuration:Le,numSequences:Fe}}function x(w){var k=O(w),K=k?k.getBox("mdhd"):void 0;return K?K.timescale:NaN}function B(w,k){return w[k+3]>>>0|w[k+2]<<8>>>0|w[k+1]<<16>>>0|w[k]<<24>>>0}function M(w,k){return String.fromCharCode(w[k++])+String.fromCharCode(w[k++])+String.fromCharCode(w[k++])+String.fromCharCode(w[k])}function I(w){var k=null,K,W,Y=O(w);if(!Y)return k;var J=Y.getBox("ftyp"),ee=Y.getBox("moov");return C.debug("Searching for initialization."),ee&&ee.isComplete&&(K=J?J.offset:ee.offset,W=ee.offset+ee.size-1,k=K+"-"+W,C.debug("Found the initialization.  Range: "+k)),k}function U(w,k,K){if(K===void 0&&(K=0),!k||K+8>=k.byteLength)return new S.default(0,!1);for(var W=k instanceof ArrayBuffer?new Uint8Array(k):k,Y,J=0;K<W.byteLength;){var ee=B(W,K),ue=M(W,K+4);if(ee===0)break;K+ee<=W.byteLength&&(w.indexOf(ue)>=0?Y=new S.default(K,!0,ee,ue):J=K+ee),K+=ee}return Y||new S.default(J,!1)}return R={parse:O,findLastTopIsoBoxCompleted:L,getMediaTimescaleFromMoov:x,getSamplesInfo:D,findInitRange:I,parsePayload:U},F(),R}E.__dashjs_factory_name="BoxParser";const T=v.default.getSingletonFactory(E)},"./src/streaming/utils/Capabilities.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>T,supportsMediaSource:()=>S});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/thumbnail/ThumbnailTracks.js"),v=d("./src/streaming/constants/Constants.js"),_=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function S(){var C="WebKitMediaSource"in window,R="MediaSource"in window;return C||R}function E(){var C,R,b;function F(){b=!1}function O(k){k&&k.settings&&(R=k.settings)}function L(){return b}function D(k){b=k}function x(k,K){return K!==v.default.AUDIO&&K!==v.default.VIDEO?Promise.resolve(!0):B(k,K)?I(k,K):M(k)}function B(k,K){return R.get().streaming.capabilities.useMediaCapabilitiesApi&&navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo&&(k.codec&&K===v.default.AUDIO||K===v.default.VIDEO&&k.codec&&k.width&&k.height&&k.bitrate&&k.framerate)}function M(k){return new Promise(function(K){if(!k||!k.codec){K(!1);return}var W=k.codec;if(k.width&&k.height&&(W+=';width="'+k.width+'";height="'+k.height+'"'),"MediaSource"in window&&MediaSource.isTypeSupported(W)){K(!0);return}else if("WebKitMediaSource"in window&&WebKitMediaSource.isTypeSupported(W)){K(!0);return}K(!1)})}function I(k,K){return new Promise(function(W){if(!k||!k.codec){W(!1);return}var Y={type:"media-source"};Y[K]={},Y[K].contentType=k.codec,Y[K].width=k.width,Y[K].height=k.height,Y[K].bitrate=parseInt(k.bitrate),Y[K].framerate=parseFloat(k.framerate),navigator.mediaCapabilities.decodingInfo(Y).then(function(J){W(J.supported)}).catch(function(){W(!1)})})}function U(k){try{return g.THUMBNAILS_SCHEME_ID_URIS.indexOf(k.schemeIdUri)!==-1}catch{return!0}}function w(k,K){for(var W=k.split(".")[0],Y=K.indexOf(W)===0,J,ee=0;ee<_.length;ee++)if(_[ee].codec===W){J=_[ee];break}return J?Y||J.compatibleCodecs.some(function(ue){return K.indexOf(ue)===0}):Y}return C={setConfig:O,supportsMediaSource:S,supportsEncryptedMedia:L,supportsCodec:x,setEncryptedMediaSupported:D,supportsEssentialProperty:U,codecRootCompatibleWithCodec:w},F(),C}E.__dashjs_factory_name="Capabilities";const T=m.default.getSingletonFactory(E)},"./src/streaming/utils/CapabilitiesFilter.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>T});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/Debug.js"),v=d("./src/streaming/constants/Constants.js"),_=d("./src/core/EventBus.js"),S=d("./src/core/events/Events.js");function E(){var C=this.context,R=(0,_.default)(C).getInstance(),b,F,O,L,D,x;function B(){x=(0,g.default)(C).getInstance().getLogger(b)}function M(ue){ue&&(ue.adapter&&(F=ue.adapter),ue.capabilities&&(O=ue.capabilities),ue.settings&&(L=ue.settings),ue.customParametersModel&&(D=ue.customParametersModel))}function I(ue){return new Promise(function(ie){var Q=[];Q.push(U(v.default.VIDEO,ue)),Q.push(U(v.default.AUDIO,ue)),Promise.all(Q).then(function(){L.get().streaming.capabilities.filterUnsupportedEssentialProperties&&J(ue),ee(ue),ie()}).catch(function(){ie()})})}function U(ue,ie){if(!ie||!ie.Period_asArray||ie.Period_asArray.length===0)return Promise.resolve();var Q=[];return ie.Period_asArray.forEach(function(se){Q.push(w(se,ue))}),Promise.all(Q)}function w(ue,ie){return new Promise(function(Q){if(!ue||!ue.AdaptationSet_asArray||ue.AdaptationSet_asArray.length===0){Q();return}var se=[];ue.AdaptationSet_asArray.forEach(function(ve){F.getIsTypeOf(ve,ie)&&se.push(k(ve,ie))}),Promise.all(se).then(function(){ue.AdaptationSet_asArray=ue.AdaptationSet_asArray.filter(function(ve){var _e=ve.Representation_asArray&&ve.Representation_asArray.length>0;return _e||(R.trigger(S.default.ADAPTATION_SET_REMOVED_NO_CAPABILITIES,{adaptationSet:ve}),x.warn("AdaptationSet has been removed because of no supported Representation")),_e}),Q()}).catch(function(){Q()})})}function k(ue,ie){return new Promise(function(Q){if(!ue.Representation_asArray||ue.Representation_asArray.length===0){Q();return}var se=[],ve=[];ue.Representation_asArray.forEach(function(_e,Z){var Ee=F.getCodec(ue,Z,!1),Se=K(ie,_e,Ee);ve.push(Se),se.push(O.supportsCodec(Se,ie))}),Promise.all(se).then(function(_e){ue.Representation_asArray=ue.Representation_asArray.filter(function(Z,Ee){return _e[Ee]||x.debug("[Stream] Codec ".concat(ve[Ee].codec," not supported ")),_e[Ee]}),Q()}).catch(function(){Q()})})}function K(ue,ie,Q){switch(ue){case v.default.VIDEO:return W(ie,Q);case v.default.AUDIO:return Y(ie,Q);default:return null}}function W(ue,ie){var Q=ue.width||null,se=ue.height||null,ve=ue.frameRate||null,_e=ue.bandwidth||null;return{codec:ie,width:Q,height:se,framerate:ve,bitrate:_e}}function Y(ue,ie){var Q=ue.audioSamplingRate||null,se=ue.bandwidth||null;return{codec:ie,bitrate:se,samplerate:Q}}function J(ue){!ue||!ue.Period_asArray||ue.Period_asArray.length===0||ue.Period_asArray.forEach(function(ie){ie.AdaptationSet_asArray=ie.AdaptationSet_asArray.filter(function(Q){return!Q.Representation_asArray||Q.Representation_asArray.length===0?!0:(Q.Representation_asArray=Q.Representation_asArray.filter(function(se){var ve=F.getEssentialPropertiesForRepresentation(se);if(ve&&ve.length>0)for(var _e=0;_e<ve.length;){if(!O.supportsEssentialProperty(ve[_e]))return x.debug("[Stream] EssentialProperty not supported: "+ve[_e].schemeIdUri),!1;_e+=1}return!0}),Q.Representation_asArray&&Q.Representation_asArray.length>0)})})}function ee(ue){var ie=D.getCustomCapabilitiesFilters();!ie||ie.length===0||!ue||!ue.Period_asArray||ue.Period_asArray.length===0||ue.Period_asArray.forEach(function(Q){Q.AdaptationSet_asArray=Q.AdaptationSet_asArray.filter(function(se){return!se.Representation_asArray||se.Representation_asArray.length===0?!0:(se.Representation_asArray=se.Representation_asArray.filter(function(ve){return!ie.some(function(_e){return!_e(ve)})}),se.Representation_asArray&&se.Representation_asArray.length>0)})})}return b={setConfig:M,filterUnsupportedFeatures:I},B(),b}E.__dashjs_factory_name="CapabilitiesFilter";const T=m.default.getSingletonFactory(E)},"./src/streaming/utils/CustomTimeRanges.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/utils/SupervisorTools.js");function v(){var S=[],E=0;function T(L,D){var x=0;for(x=0;x<this.customTimeRangeArray.length&&L>this.customTimeRangeArray[x].start;x++);for(this.customTimeRangeArray.splice(x,0,{start:L,end:D}),x=0;x<this.customTimeRangeArray.length-1;x++)this.mergeRanges(x,x+1)&&x--;this.length=this.customTimeRangeArray.length}function C(){this.customTimeRangeArray=[],this.length=0}function R(L,D){for(var x=0;x<this.customTimeRangeArray.length;x++)if(L<=this.customTimeRangeArray[x].start&&D>=this.customTimeRangeArray[x].end)this.customTimeRangeArray.splice(x,1),x--;else if(L>this.customTimeRangeArray[x].start&&D<this.customTimeRangeArray[x].end){this.customTimeRangeArray.splice(x+1,0,{start:D,end:this.customTimeRangeArray[x].end}),this.customTimeRangeArray[x].end=L;break}else L>this.customTimeRangeArray[x].start&&L<this.customTimeRangeArray[x].end?this.customTimeRangeArray[x].end=L:D>this.customTimeRangeArray[x].start&&D<this.customTimeRangeArray[x].end&&(this.customTimeRangeArray[x].start=D);this.length=this.customTimeRangeArray.length}function b(L,D){var x=this.customTimeRangeArray[L],B=this.customTimeRangeArray[D];return x.start<=B.start&&B.start<=x.end&&x.end<=B.end?(x.end=B.end,this.customTimeRangeArray.splice(D,1),!0):B.start<=x.start&&x.start<=B.end&&B.end<=x.end?(x.start=B.start,this.customTimeRangeArray.splice(D,1),!0):B.start<=x.start&&x.start<=B.end&&x.end<=B.end?(this.customTimeRangeArray.splice(L,1),!0):x.start<=B.start&&B.start<=x.end&&B.end<=x.end?(this.customTimeRangeArray.splice(D,1),!0):!1}function F(L){return(0,g.checkInteger)(L),L>=this.customTimeRangeArray.length||L<0?NaN:this.customTimeRangeArray[L].start}function O(L){return(0,g.checkInteger)(L),L>=this.customTimeRangeArray.length||L<0?NaN:this.customTimeRangeArray[L].end}return{customTimeRangeArray:S,length:E,add:T,clear:C,remove:R,mergeRanges:b,start:F,end:O}}v.__dashjs_factory_name="CustomTimeRanges";const _=m.default.getClassFactory(v)},"./src/streaming/utils/DOMStorage.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/Debug.js"),v=d("./src/streaming/constants/Constants.js"),_=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],S="dashjs_?_bitrate",E="dashjs_?_settings",T="localStorage",C="sessionStorage",R="lastBitrate",b="lastMediaSettings";function F(D){D=D||{};var x=this.context,B=D.settings,M,I,U;function w(){I=(0,g.default)(x).getInstance().getLogger(M),K()}function k(se){if(U!==void 0)return U;U=!1;var ve="1",_e="1",Z;try{typeof window<"u"&&(Z=window[se])}catch(Ee){return I.warn("DOMStorage access denied: "+Ee.message),U}if(!Z||se!==T&&se!==C)return U;try{Z.setItem(ve,_e),Z.removeItem(ve),U=!0}catch(Ee){I.warn("DOMStorage is supported, but cannot be used: "+Ee.message)}return U}function K(){k(T)&&_.forEach(function(se){var ve=localStorage.getItem(se.oldKey);if(ve){localStorage.removeItem(se.oldKey);try{localStorage.setItem(se.newKey,ve)}catch(_e){I.error(_e.message)}}})}function W(){var se=6e5;return Math.round(new Date().getTime()/se)*se}function Y(se,ve){return k(se)&&B.get().streaming[ve+"CachingInfo"].enabled}function J(){if(!B)throw new Error(v.default.MISSING_CONFIG_ERROR)}function ee(se){if(J(),!B.get().streaming.lastMediaSettingsCachingInfo.enabled)return null;var ve=null;if(Y(T,b)){var _e=E.replace(/\?/,se);try{var Z=JSON.parse(localStorage.getItem(_e))||{},Ee=new Date().getTime()-parseInt(Z.timestamp,10)>=B.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;ve=Z.settings,Ee&&(localStorage.removeItem(_e),ve=null)}catch{return null}}return ve}function ue(se){if(J(),!B.get().streaming.lastBitrateCachingInfo.enabled)return NaN;var ve=NaN;if(Y(T,R)){var _e=S.replace(/\?/,se);try{var Z=JSON.parse(localStorage.getItem(_e))||{},Ee=new Date().getTime()-parseInt(Z.timestamp,10)>=B.get().streaming.lastBitrateCachingInfo.ttl||!1,Se=parseFloat(Z.bitrate);!isNaN(Se)&&!Ee?(ve=Se,I.debug("Last saved bitrate for "+se+" was "+Se)):Ee&&localStorage.removeItem(_e)}catch{return null}}return ve}function ie(se,ve){if(Y(T,b)){var _e=E.replace(/\?/,se);try{localStorage.setItem(_e,JSON.stringify({settings:ve,timestamp:W()}))}catch(Z){I.error(Z.message)}}}function Q(se,ve){if(Y(T,R)&&ve){var _e=S.replace(/\?/,se);try{localStorage.setItem(_e,JSON.stringify({bitrate:ve.toFixed(3),timestamp:W()}))}catch(Z){I.error(Z.message)}}}return M={getSavedBitrateSettings:ue,setSavedBitrateSettings:Q,getSavedMediaSettings:ee,setSavedMediaSettings:ie},w(),M}F.__dashjs_factory_name="DOMStorage";var O=m.default.getSingletonFactory(F);const L=O},"./src/streaming/utils/DefaultURLUtils.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/core/FactoryMaker.js");function g(){var _,S=/^[a-z][a-z0-9+\-_.]*:/i,E=/^https?:\/\//i,T=/^https:\/\//i,C=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i,R=function(Y,J){try{return new window.URL(Y,J).toString()}catch{return Y}},b=function(Y,J){var ee=O;if(!J||!B(Y))return Y;M(Y)&&(ee=L),I(Y)&&(ee=x);var ue=ee(J),ie=ue.charAt(ue.length-1)!=="/"&&Y.charAt(0)!=="/"?"/":"";return[ue,Y].join(ie)};function F(){try{var W=new window.URL("x","http://y");_=R}catch{}finally{_=_||b}}function O(W){var Y=W.indexOf("/"),J=W.lastIndexOf("/");return Y!==-1?J===Y+1?W:(W.indexOf("?")!==-1&&(W=W.substring(0,W.indexOf("?"))),W.substring(0,J+1)):""}function L(W){var Y=W.match(C);return Y?Y[1]:""}function D(W){var Y=/^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(W);return Y[2].substring(1)}function x(W){var Y=W.match(S);return Y?Y[0]:""}function B(W){return!S.test(W)}function M(W){return B(W)&&W.charAt(0)==="/"}function I(W){return W.indexOf("//")===0}function U(W){return E.test(W)}function w(W){return T.test(W)}function k(W,Y){return _(W,Y)}F();var K={parseBaseUrl:O,parseOrigin:L,parseScheme:x,isRelative:B,isPathAbsolute:M,isSchemeRelative:I,isHTTPURL:U,isHTTPS:w,removeHostname:D,resolve:k};return K}g.__dashjs_factory_name="DefaultURLUtils";const v=m.default.getSingletonFactory(g)},"./src/streaming/utils/EBMLParser.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/core/FactoryMaker.js");function g(_){_=_||{};var S,E=new DataView(_.data),T=0;function C(){return T}function R(I){T=I}function b(I,U){var w=!0,k=0,K,W;if(U===void 0&&(U=!1),I.tag>16777215?(E.getUint32(T)!==I.tag&&(w=!1),k=4):I.tag>65535?(K=E.getUint16(T),W=E.getUint8(T+2),K*256+W!==I.tag&&(w=!1),k=3):I.tag>255?(E.getUint16(T)!==I.tag&&(w=!1),k=2):(E.getUint8(T)!==I.tag&&(w=!1),k=1),!w&&I.required&&!U)throw new Error("required tag not found");return w&&(T+=k),w}function F(I,U){var w=b(I,U);return w&&D(),w}function O(I){var U;return b(I),U=D(),S[I.parse](U)}function L(I,U){var w=b(I,U),k;return w&&(k=D(),T+=k),w}function D(I){var U=1,w=128,k=8,K=-1,W=0,Y=E.getUint8(T),J=0;for(J=0;J<k;J+=1){if((Y&w)===w){W=I===void 0?Y&~w:Y,K=J;break}w>>=1}for(J=0;J<K;J+=1,U+=1)W=W<<8|255&E.getUint8(T+U);return T+=U,W}function x(I){var U;switch(I){case 4:U=E.getFloat32(T),T+=4;break;case 8:U=E.getFloat64(T),T+=8;break}return U}function B(I){for(var U=0,w=0;w<I;w+=1)U<<=8,U|=E.getUint8(T+w)&255;return T+=I,U}function M(){return T<E.byteLength}return S={getPos:C,setPos:R,consumeTag:b,consumeTagAndSize:F,parseTag:O,skipOverElement:L,getMatroskaCodedNum:D,getMatroskaFloat:x,getMatroskaUint:B,moreData:M},S}g.__dashjs_factory_name="EBMLParser";const v=m.default.getClassFactory(g)},"./src/streaming/utils/ErrorHandler.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/core/EventBus.js"),g=d("./src/core/events/Events.js"),v=d("./src/core/FactoryMaker.js");function _(){var E,T=this.context,C=(0,m.default)(T).getInstance();function R(b){C.trigger(g.default.ERROR,{error:b})}return E={error:R},E}_.__dashjs_factory_name="ErrorHandler";const S=v.default.getSingletonFactory(_)},"./src/streaming/utils/InitCache.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/core/FactoryMaker.js");function g(){var _={};function S(R){var b=R.streamId,F=R.representationId;_[b]=_[b]||{},_[b][F]=R}function E(R,b){return _&&_[R]&&_[R][b]?_[R][b]:null}function T(){_={}}var C={save:S,extract:E,reset:T};return C}g.__dashjs_factory_name="InitCache";const v=m.default.getSingletonFactory(g)},"./src/streaming/utils/IsoFile.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});var m=d("./src/streaming/vo/IsoBox.js"),g=d("./src/core/FactoryMaker.js");function v(){var S,E;function T(O){return!O||!E||!E.boxes||E.boxes.length===0||typeof E.fetch!="function"?null:F(E.fetch(O))}function C(O){var L=[];if(!O||!E||typeof E.fetchAll!="function")return L;for(var D=E.fetchAll(O),x,B=0,M=D.length;B<M;B++)x=F(D[B]),x&&L.push(x);return L}function R(O){E=O}function b(){if(!E||!E.boxes||!E.boxes.length)return null;var O=E.boxes[E.boxes.length-1].type,L=C(O);return L.length>0?L[L.length-1]:null}function F(O){if(!O)return null;var L=new m.default(O);return O.hasOwnProperty("_incomplete")&&(L.isComplete=!O._incomplete),L}return S={getBox:T,getBoxes:C,setData:R,getLastBox:b},S}v.__dashjs_factory_name="IsoFile";const _=g.default.getClassFactory(v)},"./src/streaming/utils/ObjectUtils.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/core/FactoryMaker.js"),g=d("./node_modules/fast-deep-equal/index.js"),v=d.n(g);function _(){var E;function T(C,R){return v()(C,R)}return E={areEqual:T},E}_.__dashjs_factory_name="ObjectUtils";const S=m.default.getSingletonFactory(_)},"./src/streaming/utils/RequestModifier.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_,modifyRequest:()=>g});var m=d("./src/core/FactoryMaker.js");function g(S,E){var T={url:S.url,method:S.method,headers:Object.assign({},S.headers),credentials:S.withCredentials?"include":void 0};return Promise.resolve(E.modifyRequest(T)).then(function(){return Object.assign(S,T,{withCredentials:T.credentials==="include"})})}function v(){var S;function E(C){return C}function T(C,R){return R.url,C}return S={modifyRequest:null,modifyRequestURL:E,modifyRequestHeader:T},S}v.__dashjs_factory_name="RequestModifier";const _=m.default.getSingletonFactory(v)},"./src/streaming/utils/SegmentResponseModifier.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/core/FactoryMaker.js");function g(){var _;function S(E){return Promise.resolve(E)}return _={modifyResponseAsync:S},_}g.__dashjs_factory_name="SegmentResponseModifier";const v=m.default.getSingletonFactory(g)},"./src/streaming/utils/SupervisorTools.js":(h,f,d)=>{d.r(f),d.d(f,{checkInteger:()=>_,checkIsVideoOrAudioType:()=>E,checkParameterType:()=>v,checkRange:()=>S});var m=d("./src/streaming/constants/Constants.js");function g(T){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(R){return typeof R}:g=function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},g(T)}function v(T,C){if(g(T)!==C)throw m.default.BAD_ARGUMENT_ERROR}function _(T){var C=T!==null&&!isNaN(T)&&T%1===0;if(!C)throw m.default.BAD_ARGUMENT_ERROR+" : argument is not an integer"}function S(T,C,R){if(T<C||T>R)throw m.default.BAD_ARGUMENT_ERROR+" : argument out of range"}function E(T){if(typeof T!="string"||T!==m.default.AUDIO&&T!==m.default.VIDEO)throw m.default.BAD_ARGUMENT_ERROR}},"./src/streaming/utils/TTMLParser.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>R});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/Debug.js"),v=d("./src/core/EventBus.js"),_=d("./src/core/events/Events.js"),S=d("./node_modules/imsc/src/main/js/main.js"),E=d("./src/streaming/MediaPlayerEvents.js"),T=d("./src/streaming/constants/ConformanceViolationConstants.js");function C(){var b=this.context,F=(0,v.default)(b).getInstance(),O,L,D=0;function x(){L=(0,g.default)(b).getInstance().getLogger(O)}function B(){var I="cue_TTML_"+D;return D++,I}function M(I,U,w,k,K){var W="",Y=[],J,ee,ue,ie={},Q={},se="",ve="",_e={onOpenTag:function(de,xe,Fe){if(Fe[" imagetype"]&&!Fe[" imageType"]&&(F.trigger(E.default.CONFORMANCE_VIOLATION,{level:T.default.LEVELS.ERROR,event:T.default.EVENTS.NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE}),Fe[" imageType"]=Fe[" imagetype"]),xe==="image"&&(de==="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"||de==="http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt")){if(!Fe[" imageType"]||Fe[" imageType"].value!=="PNG"){L.warn("smpte-tt imageType != PNG. Discarded");return}se=Fe["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){se&&(Q[se]=ve.trim()),ve="",se=""},onText:function(de){se&&(ve=ve+de)}};if(!I)throw W="no ttml data to parse",new Error(W);ie.data=I,F.trigger(_.default.TTML_TO_PARSE,ie);var Z=(0,S.fromXML)(ie.data,function(Me){W=Me},_e);F.trigger(_.default.TTML_PARSED,{ttmlString:ie.data,ttmlDoc:Z});var Ee=Z.getMediaTimeEvents();for(ue=0;ue<Ee.length;ue++){var Se=(0,S.generateISD)(Z,Ee[ue],function(Me){W=Me});Se.contents.some(function(Me){return Me.contents.length})&&(J=Ee[ue]+U<w?w:Ee[ue]+U,ee=Ee[ue+1]+U>k?k:Ee[ue+1]+U,J<ee&&Y.push({start:J,end:ee,type:"html",cueID:B(),isd:Se,images:K,embeddedImages:Q}))}if(W!=="")throw L.error(W),new Error(W);return Y}return O={parse:M},x(),O}C.__dashjs_factory_name="TTMLParser";const R=m.default.getSingletonFactory(C)},"./src/streaming/utils/URLUtils.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/core/FactoryMaker.js"),g=d("./src/streaming/utils/DefaultURLUtils.js");function v(){var E,T,C=[],R=this.context;function b(Y){var J;for(J=0;J<C.length;J++){var ee=C[J].regex;if(ee.test(Y))return C[J].utils}return T}function F(){T=(0,g.default)(R).getInstance()}function O(Y,J){C.push({regex:Y,utils:J})}function L(Y,J,ee){var ue=b(ee||J);return ue&&typeof ue[Y]=="function"?ue[Y](J,ee):T[Y](J,ee)}function D(Y){return L("parseBaseUrl",Y)}function x(Y){return L("parseOrigin",Y)}function B(Y){return L("removeHostname",Y)}function M(Y){return L("parseScheme",Y)}function I(Y){return L("isRelative",Y)}function U(Y){return L("isPathAbsolute",Y)}function w(Y){return L("isSchemeRelative",Y)}function k(Y){return L("isHTTPURL",Y)}function K(Y){return L("isHTTPS",Y)}function W(Y,J){return L("resolve",Y,J)}return F(),E={registerUrlRegex:O,parseBaseUrl:D,parseOrigin:x,parseScheme:M,isRelative:I,isPathAbsolute:U,isSchemeRelative:w,isHTTPURL:k,isHTTPS:K,removeHostname:B,resolve:W},E}v.__dashjs_factory_name="URLUtils";var _=m.default.getSingletonFactory(v);const S=_},"./src/streaming/utils/VTTParser.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});var m=d("./src/core/FactoryMaker.js"),g=d("./src/core/Debug.js"),v="WEBVTT";function _(){var E=this.context,T,C,R,b,F,O;function L(){C=(0,g.default)(E).getInstance().getLogger(T),R=/(?:\r\n|\r|\n)/gm,b=/-->/,F=/(^[\s]+|[\s]+$)/g,O=/\s\b/g}function D(U){var w=[],k,K;if(!U)return w;U=U.split(R),k=U.length,K=-1;for(var W=0;W<k;W++){var Y=U[W];if(Y.length>0&&Y!==v&&Y.match(b)){var J=B(Y),ee=J.cuePoints,ue=J.styles,ie=I(U,W+1),Q=x(ee[0].replace(F,"")),se=x(ee[1].replace(F,""));!isNaN(Q)&&!isNaN(se)&&Q>=K&&se>Q?ie!==""?(K=Q,w.push({start:Q,end:se,data:ie,styles:ue})):C.error("Skipping cue due to empty/malformed cue text"):C.error("Skipping cue due to incorrect cue timing")}}return w}function x(U){var w=U.split(":"),k=w.length-1;return U=parseInt(w[k-1],10)*60+parseFloat(w[k]),k===2&&(U+=parseInt(w[0],10)*3600),U}function B(U){var w=U.split(b),k=w[1].split(O);return k.shift(),w[1]=k[0],k.shift(),{cuePoints:w,styles:M(k)}}function M(U){var w={};return U.forEach(function(k){if(k.split(/:/).length>1){var K=k.split(/:/)[1];K&&K.search(/%/)!=-1&&(K=parseInt(K.replace(/%/,""),10)),(k.match(/align/)||k.match(/A/))&&(w.align=K),(k.match(/line/)||k.match(/L/))&&(w.line=K),(k.match(/position/)||k.match(/P/))&&(w.position=K),(k.match(/size/)||k.match(/S/))&&(w.size=K)}}),w}function I(U,w){for(var k=w,K="",W="",Y;U[k]!==""&&k<U.length;)k++;if(Y=k-w,Y>1)for(var J=0;J<Y;J++)if(W=U[w+J],!W.match(b))K+=W,J!==Y-1&&(K+=`
`);else{K="";break}else W=U[w],W.match(b)||(K=W);return K}return T={parse:D},L(),T}_.__dashjs_factory_name="VTTParser";const S=m.default.getSingletonFactory(_)},"./src/streaming/utils/VttCustomRenderingParser.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/core/FactoryMaker.js");function g(){var _,S;function E(){try{window&&window.WebVTT&&window.WebVTT.Parser&&(S=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder()))}catch{}}function T(C){var R=[];return S.oncue=function(b){b.start=b.startTime,b.end=b.endTime,b.data=b.text,b.styles={align:b.align,line:b.line,position:b.position,size:b.size},R.push(b)},S.parse(C),R}return _={parse:T},E(),_}g.__dashjs_factory_name="VttCustomRenderingParser";const v=m.default.getSingletonFactory(g)},"./src/streaming/utils/baseUrlResolution/BasicSelector.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/core/FactoryMaker.js");function g(_){_=_||{};var S,E=_.blacklistController;function T(C){var R=0,b;return C&&C.some(function(F,O){return R=O,!E.contains(F.serviceLocation)})&&(b=C[R]),b}return S={select:T},S}g.__dashjs_factory_name="BasicSelector";const v=m.default.getClassFactory(g)},"./src/streaming/utils/baseUrlResolution/ContentSteeringSelector.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});var m=d("./src/core/FactoryMaker.js"),g=d("./src/dash/controllers/ContentSteeringController.js");function v(){var S=this.context,E,T,C;function R(){T=(0,g.default)(S).getInstance()}function b(L){L.blacklistController&&(C=L.blacklistController),L.contentSteeringController&&(T=L.contentSteeringController)}function F(L){var D=NaN;if(isNaN(L.selectedIdx)){var x=T.getSteeringDataFromManifest();x&&x.defaultServiceLocation&&(D=O([x.defaultServiceLocation],L.baseUrls))}var B=T.getCurrentSteeringResponseData();return L.baseUrls&&L.baseUrls.length&&B&&B.serviceLocationPriority&&B.serviceLocationPriority.length&&(D=O(B.serviceLocationPriority,L.baseUrls)),D}function O(){for(var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],x=0,B=NaN,M=function(){var w=L[x],k=D.findIndex(function(K){return K.serviceLocation&&K.serviceLocation===w});if(k!==-1&&!C.contains(D[k].serviceLocation))return B=k,"break";x+=1};x<L.length;){var I=M();if(I==="break")break}return B}return E={selectBaseUrlIndex:F,setConfig:b},R(),E}v.__dashjs_factory_name="ContentSteeringSelector";const _=m.default.getClassFactory(v)},"./src/streaming/utils/baseUrlResolution/DVBSelector.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});var m=d("./src/core/FactoryMaker.js");function g(_){_=_||{};var S,E=_.blacklistController;function T(b){var F=[],O=function(x){return!(F.length&&x.dvb_priority&&F.indexOf(x.dvb_priority)!==-1)},L=function(x){return E.contains(x.serviceLocation)?(x.dvb_priority&&F.push(x.dvb_priority),!1):!0};return b.filter(L).filter(O)}function C(b){var F=function(U,w){var k=U.dvb_priority-w.dvb_priority;return isNaN(k)?0:k},O=function(U,w,k){return!w||k[0].dvb_priority&&U.dvb_priority&&k[0].dvb_priority===U.dvb_priority},L=0,D=[],x=0,B,M;if(M=b.sort(F).filter(O),M.length)return M.length>1&&(M.forEach(function(I){L+=I.dvb_weight,D.push(L)}),B=Math.floor(Math.random()*(L-1)),D.every(function(I,U){return x=U,!(B<I)})),M[x]}function R(b){return b&&C(T(b))}return S={select:R},S}g.__dashjs_factory_name="DVBSelector";const v=m.default.getClassFactory(g)},"./src/streaming/vo/BitrateInfo.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN};const v=g},"./src/streaming/vo/DashJSError.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(S,E,T){m(this,_),this.code=S||null,this.message=E||null,this.data=T||null};const v=g},"./src/streaming/vo/DataChunk.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null};const v=g},"./src/streaming/vo/FragmentRequest.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>E});var m=d("./src/streaming/vo/metrics/HTTPRequest.js");function g(T,C){if(!(T instanceof C))throw new TypeError("Cannot call a class as a function")}function v(T,C){for(var R=0;R<C.length;R++){var b=C[R];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(T,b.key,b)}}function _(T,C,R){return C&&v(T.prototype,C),R&&v(T,R),T}var S=function(){function T(C){g(this,T),this.action=T.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaStartTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=C||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}return _(T,[{key:"isInitializationRequest",value:function(){return this.type&&this.type===m.HTTPRequest.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(R){this.type=R&&R.init?m.HTTPRequest.INIT_SEGMENT_TYPE:m.HTTPRequest.MEDIA_SEGMENT_TYPE,this.url=R&&R.url?R.url:null,this.range=R&&R.range?R.range.start+"-"+R.range.end:null,this.mediaType=R&&R.mediaType?R.mediaType:null}}]),T}();S.ACTION_DOWNLOAD="download",S.ACTION_COMPLETE="complete";const E=S},"./src/streaming/vo/HeadRequest.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>O});var m=d("./src/streaming/vo/FragmentRequest.js");function g(L){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(x){return typeof x}:g=function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},g(L)}function v(L,D){if(!(L instanceof D))throw new TypeError("Cannot call a class as a function")}function _(L,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function");L.prototype=Object.create(D&&D.prototype,{constructor:{value:L,writable:!0,configurable:!0}}),D&&S(L,D)}function S(L,D){return S=Object.setPrototypeOf||function(B,M){return B.__proto__=M,B},S(L,D)}function E(L){var D=R();return function(){var B=b(L),M;if(D){var I=b(this).constructor;M=Reflect.construct(B,arguments,I)}else M=B.apply(this,arguments);return T(this,M)}}function T(L,D){return D&&(g(D)==="object"||typeof D=="function")?D:C(L)}function C(L){if(L===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L}function R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(L){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)},b(L)}var F=function(L){_(x,L);var D=E(x);function x(B){var M;return v(this,x),M=D.call(this,B),M.checkForExistenceOnly=!0,M}return x}(m.default);const O=F},"./src/streaming/vo/IsoBox.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>S});function m(E,T){if(!(E instanceof T))throw new TypeError("Cannot call a class as a function")}function g(E,T){for(var C=0;C<T.length;C++){var R=T[C];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(E,R.key,R)}}function v(E,T,C){return T&&g(E.prototype,T),C&&g(E,C),E}var _=function(){function E(T){if(m(this,E),this.offset=T._offset,this.type=T.type,this.size=T.size,this.boxes=[],T.boxes)for(var C=0;C<T.boxes.length;C++)this.boxes.push(new E(T.boxes[C]));switch(this.isComplete=!0,T.type){case"sidx":if(this.timescale=T.timescale,this.earliest_presentation_time=T.earliest_presentation_time,this.first_offset=T.first_offset,this.references=T.references,T.references){this.references=[];for(var R=0;R<T.references.length;R++){var b={reference_type:T.references[R].reference_type,referenced_size:T.references[R].referenced_size,subsegment_duration:T.references[R].subsegment_duration};this.references.push(b)}}break;case"emsg":this.id=T.id,this.version=T.version===1?1:0,this.value=T.value,this.timescale=T.timescale,this.scheme_id_uri=T.scheme_id_uri,this.presentation_time_delta=T.version===1?T.presentation_time:T.presentation_time_delta,this.event_duration=T.event_duration,this.message_data=T.message_data;break;case"mdhd":this.timescale=T.timescale;break;case"mfhd":this.sequence_number=T.sequence_number;break;case"subs":this.entry_count=T.entry_count,this.entries=T.entries;break;case"tfhd":this.base_data_offset=T.base_data_offset,this.sample_description_index=T.sample_description_index,this.default_sample_duration=T.default_sample_duration,this.default_sample_size=T.default_sample_size,this.default_sample_flags=T.default_sample_flags,this.flags=T.flags;break;case"tfdt":this.version=T.version,this.baseMediaDecodeTime=T.baseMediaDecodeTime,this.flags=T.flags;break;case"trun":if(this.sample_count=T.sample_count,this.first_sample_flags=T.first_sample_flags,this.data_offset=T.data_offset,this.flags=T.flags,this.samples=T.samples,T.samples){this.samples=[];for(var F=0,O=T.samples.length;F<O;F++){var L={sample_size:T.samples[F].sample_size,sample_duration:T.samples[F].sample_duration,sample_composition_time_offset:T.samples[F].sample_composition_time_offset};this.samples.push(L)}}break}}return v(E,[{key:"getChildBox",value:function(C){for(var R=0;R<this.boxes.length;R++)if(this.boxes[R].type===C)return this.boxes[R]}},{key:"getChildBoxes",value:function(C){for(var R=[],b=0;b<this.boxes.length;b++)this.boxes[b].type===C&&R.push(this.boxes[b]);return R}}]),E}();const S=_},"./src/streaming/vo/IsoBoxSearchInfo.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(S,E,T){m(this,_),this.lastCompletedOffset=S,this.found=E,this.size=T};const v=g},"./src/streaming/vo/MetricsList.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]};const v=g},"./src/streaming/vo/TextRequest.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>L});var m=d("./src/streaming/constants/Constants.js"),g=d("./src/streaming/vo/FragmentRequest.js");function v(D){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?v=function(B){return typeof B}:v=function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},v(D)}function _(D,x){if(!(D instanceof x))throw new TypeError("Cannot call a class as a function")}function S(D,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");D.prototype=Object.create(x&&x.prototype,{constructor:{value:D,writable:!0,configurable:!0}}),x&&E(D,x)}function E(D,x){return E=Object.setPrototypeOf||function(M,I){return M.__proto__=I,M},E(D,x)}function T(D){var x=b();return function(){var M=F(D),I;if(x){var U=F(this).constructor;I=Reflect.construct(M,arguments,U)}else I=M.apply(this,arguments);return C(this,I)}}function C(D,x){return x&&(v(x)==="object"||typeof x=="function")?x:R(D)}function R(D){if(D===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D}function b(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function F(D){return F=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)},F(D)}var O=function(D){S(B,D);var x=T(B);function B(M,I){var U;return _(this,B),U=x.call(this),U.url=M||null,U.type=I||null,U.mediaType=m.default.STREAM,U.responseType="",U}return B}(g.default);const L=O},"./src/streaming/vo/TextTrackInfo.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>O});var m=d("./src/dash/vo/MediaInfo.js");function g(L){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(x){return typeof x}:g=function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},g(L)}function v(L,D){if(!(L instanceof D))throw new TypeError("Cannot call a class as a function")}function _(L,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function");L.prototype=Object.create(D&&D.prototype,{constructor:{value:L,writable:!0,configurable:!0}}),D&&S(L,D)}function S(L,D){return S=Object.setPrototypeOf||function(B,M){return B.__proto__=M,B},S(L,D)}function E(L){var D=R();return function(){var B=b(L),M;if(D){var I=b(this).constructor;M=Reflect.construct(B,arguments,I)}else M=B.apply(this,arguments);return T(this,M)}}function T(L,D){return D&&(g(D)==="object"||typeof D=="function")?D:C(L)}function C(L){if(L===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L}function R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(L){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)},b(L)}var F=function(L){_(x,L);var D=E(x);function x(){var B;return v(this,x),B=D.call(this),B.captionData=null,B.label=null,B.defaultTrack=!1,B.kind=null,B.isFragmented=!1,B.isEmbedded=!1,B.isTTML=null,B}return x}(m.default);const O=F},"./src/streaming/vo/Thumbnail.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null};const v=g},"./src/streaming/vo/ThumbnailTrackInfo.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""};const v=g},"./src/streaming/vo/URIFragmentData.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null};const v=g},"./src/streaming/vo/metrics/BufferLevel.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.t=null,this.level=null};const v=g},"./src/streaming/vo/metrics/BufferState.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>_});var m=d("./src/streaming/constants/MetricsConstants.js");function g(S,E){if(!(S instanceof E))throw new TypeError("Cannot call a class as a function")}var v=function S(){g(this,S),this.target=null,this.state=m.default.BUFFER_EMPTY};const _=v},"./src/streaming/vo/metrics/DVRInfo.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.time=null,this.range=null,this.manifestInfo=null};const v=g},"./src/streaming/vo/metrics/DroppedFrames.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.time=null,this.droppedFrames=null};const v=g},"./src/streaming/vo/metrics/HTTPRequest.js":(h,f,d)=>{d.r(f),d.d(f,{HTTPRequest:()=>g,HTTPRequestTrace:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this.cmsd=null,this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null,this._fileLoaderType=null},v=function _(){m(this,_),this.s=null,this.d=null,this.b=[]};g.GET="GET",g.HEAD="HEAD",g.MPD_TYPE="MPD",g.XLINK_EXPANSION_TYPE="XLinkExpansion",g.INIT_SEGMENT_TYPE="InitializationSegment",g.INDEX_SEGMENT_TYPE="IndexSegment",g.MEDIA_SEGMENT_TYPE="MediaSegment",g.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",g.MSS_FRAGMENT_INFO_SEGMENT_TYPE="FragmentInfoSegment",g.DVB_REPORTING_TYPE="DVBReporting",g.LICENSE="license",g.CONTENT_STEERING_TYPE="ContentSteering",g.OTHER_TYPE="other"},"./src/streaming/vo/metrics/ManifestUpdate.js":(h,f,d)=>{d.r(f),d.d(f,{ManifestUpdate:()=>g,ManifestUpdateRepresentationInfo:()=>_,ManifestUpdateStreamInfo:()=>v});function m(S,E){if(!(S instanceof E))throw new TypeError("Cannot call a class as a function")}var g=function S(){m(this,S),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},v=function S(){m(this,S),this.id=null,this.index=null,this.start=null,this.duration=null},_=function S(){m(this,S),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null}},"./src/streaming/vo/metrics/PlayList.js":(h,f,d)=>{d.r(f),d.d(f,{PlayList:()=>g,PlayListTrace:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};g.INITIAL_PLAYOUT_START_REASON="initial_playout",g.SEEK_START_REASON="seek",g.RESUME_FROM_PAUSE_START_REASON="resume",g.METRICS_COLLECTION_START_REASON="metrics_collection_start";var v=function _(){m(this,_),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};v.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",v.REBUFFERING_REASON="rebuffering",v.USER_REQUEST_STOP_REASON="user_request",v.END_OF_PERIOD_STOP_REASON="end_of_period",v.END_OF_CONTENT_STOP_REASON="end_of_content",v.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",v.FAILURE_STOP_REASON="failure"},"./src/streaming/vo/metrics/RepresentationSwitch.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.t=null,this.mt=null,this.to=null,this.lto=null};const v=g},"./src/streaming/vo/metrics/RequestsQueue.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.loadingRequests=[],this.executedRequests=[]};const v=g},"./src/streaming/vo/metrics/SchedulingInfo.js":(h,f,d)=>{d.r(f),d.d(f,{default:()=>v});function m(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}var g=function _(){m(this,_),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null};const v=g},"./node_modules/bcp-47-match/index.js":(h,f)=>{f.basicFilter=v(d,!0),f.extendedFilter=v(m,!0),f.lookup=v(g);function d(S,E){return E==="*"||S===E||S.indexOf(E+"-")>-1}function m(S,E){var T=S.split("-"),C=E.split("-"),R=0,b=0;if(C[b]!=="*"&&T[R]!==C[b])return!1;for(R++,b++;b<C.length;){if(C[b]==="*"){b++;continue}if(!T[R])return!1;if(T[R]===C[b]){R++,b++;continue}if(T[R].length===1)return!1;R++}return!0}function g(S,E){for(var T=E,C;;){if(T==="*"||S===T)return!0;if(C=T.lastIndexOf("-"),C<0)return!1;T.charAt(C-2)==="-"&&(C-=2),T=T.slice(0,C)}}function v(S,E){return T;function T(C,R){for(var b=_(C,"tag"),F=_(R??"*","range"),O=[],L=-1,D,x,B;++L<F.length;)if(D=F[L].toLowerCase(),!(!E&&D==="*")){for(x=-1,B=[];++x<b.length;)if(S(b[x].toLowerCase(),D)){if(!E)return b[x];O.push(b[x])}else B.push(b[x]);b=B}return E?O:void 0}}function _(S,E){var T=S&&typeof S=="string"?[S]:S;if(!T||typeof T!="object"||!("length"in T))throw new Error("Invalid "+E+" `"+T+"`, expected non-empty string");return T}},"./node_modules/bcp-47-normalize/index.js":(h,f,d)=>{h.exports=d("./node_modules/bcp-47-normalize/lib/index.js")},"./node_modules/bcp-47-normalize/lib/index.js":(h,f,d)=>{var m=d("./node_modules/bcp-47/index.js"),g=d("./node_modules/bcp-47-match/index.js"),v=d("./node_modules/bcp-47-normalize/lib/matches.json"),_=d("./node_modules/bcp-47-normalize/lib/fields.json"),S=d("./node_modules/bcp-47-normalize/lib/defaults.json"),E=d("./node_modules/bcp-47-normalize/lib/many.json");h.exports=b;var T={}.hasOwnProperty,C=new Intl.Collator,R={variants:[],extensions:[],privateuse:[],irregular:null,regular:null};function b(x,B){var M=B||{},I=m.parse(String(x||"").toLowerCase(),M),U=m.stringify(I),w=-1,k;if(!U)return U;for(;++w<v.length;)g.extendedFilter(U,v[w].from).length&&(F(I,v[w].from,v[w].to),U=m.stringify(I));for(w=-1;++w<_.length;)O(I,_[w].from.field,_[w].from.value)&&L(I,_[w].to.field,_[w].to.value);for(U=m.stringify(Object.assign({},I,R)),w=-1;++w<S.length;)U===S[w]&&(F(I,S[w],S[w].split("-").slice(0,-1).join("-")),U=m.stringify(Object.assign({},I,R)));if(I.extensions.sort(D),M.warning)for(k in E)T.call(E[k],I[k])&&M.warning("Deprecated "+k+" `"+I[k]+"`, expected one of `"+E[k][I[k]].join("`, `")+"`",null,7);return I.script&&(I.script=I.script.charAt(0).toUpperCase()+I.script.slice(1)),I.region&&(I.region=I.region.toUpperCase()),m.stringify(I)}function F(x,B,M){var I=m.parse(B),U=m.parse(M),w=[],k;for(k in I)I[k]&&I[k].length&&O(x,k,I[k])&&w.push(k);for(k in U)U[k]&&U[k].length&&(w.indexOf(k)>-1||!x[k]||!x[k].length)&&L(x,k,U[k])}function O(x,B,M){var I=!1,U,w,k,K;if(M){if(U=x[B],w=U,U&&typeof U=="object")for(w=[],k=-1;++k<U.length;)K=U[k],M.indexOf(K)<0?w.push(K):I=!0;else U===M&&(w=null,I=!0);x[B]=w}return I}function L(x,B,M){var I=x[B],U,w,k;if(I&&typeof I=="object")for(U=[].concat(M),w=-1;++w<U.length;)k=U[w],I.indexOf(k)<0&&I.push(k);else x[B]=M}function D(x,B){return C.compare(x.singleton,B.singleton)}},"./node_modules/bcp-47/index.js":(h,f,d)=>{f.parse=d("./node_modules/bcp-47/lib/parse.js"),f.stringify=d("./node_modules/bcp-47/lib/stringify.js")},"./node_modules/bcp-47/lib/parse.js":(h,f,d)=>{var m=d("./node_modules/is-alphanumerical/index.js"),g=d("./node_modules/is-alphabetical/index.js"),v=d("./node_modules/is-decimal/index.js"),_=d("./node_modules/bcp-47/lib/regular.json"),S=d("./node_modules/bcp-47/lib/normalize.json");h.exports=T;var E={}.hasOwnProperty;function T(R,b){var F=b||{},O=C(),L=String(R),D=L.toLowerCase(),x=0,B,M,I;if(R==null)throw new Error("Expected string, got `"+R+"`");if(E.call(S,D))return(F.normalize==null||F.normalize)&&S[D]?T(S[D]):(O[_.indexOf(D)===-1?"irregular":"regular"]=L,O);for(;g(D.charCodeAt(x))&&x<9;)x++;if(x>1&&x<9){if(O.language=L.slice(0,x),x<4)for(M=0;D.charCodeAt(x)===45&&g(D.charCodeAt(x+1))&&g(D.charCodeAt(x+2))&&g(D.charCodeAt(x+3))&&!g(D.charCodeAt(x+4));){if(M>2)return U(x,3,"Too many extended language subtags, expected at most 3 subtags");O.extendedLanguageSubtags.push(L.slice(x+1,x+4)),x+=4,M++}for(D.charCodeAt(x)===45&&g(D.charCodeAt(x+1))&&g(D.charCodeAt(x+2))&&g(D.charCodeAt(x+3))&&g(D.charCodeAt(x+4))&&!g(D.charCodeAt(x+5))&&(O.script=L.slice(x+1,x+5),x+=5),D.charCodeAt(x)===45&&(g(D.charCodeAt(x+1))&&g(D.charCodeAt(x+2))&&!g(D.charCodeAt(x+3))?(O.region=L.slice(x+1,x+3),x+=3):v(D.charCodeAt(x+1))&&v(D.charCodeAt(x+2))&&v(D.charCodeAt(x+3))&&!v(D.charCodeAt(x+4))&&(O.region=L.slice(x+1,x+4),x+=4));D.charCodeAt(x)===45;){for(I=B=x+1;m(D.charCodeAt(I));){if(I-B>7)return U(I,1,"Too long variant, expected at most 8 characters");I++}if(I-B>4||I-B>3&&v(D.charCodeAt(B)))O.variants.push(L.slice(B,I)),x=I;else break}for(;D.charCodeAt(x)===45&&!(D.charCodeAt(x+1)===120||!m(D.charCodeAt(x+1))||D.charCodeAt(x+2)!==45||!m(D.charCodeAt(x+3)));){for(I=x+2,M=0;D.charCodeAt(I)===45&&m(D.charCodeAt(I+1))&&m(D.charCodeAt(I+2));)for(B=I+1,I=B+2,M++;m(D.charCodeAt(I));){if(I-B>7)return U(I,2,"Too long extension, expected at most 8 characters");I++}if(!M)return U(I,4,"Empty extension, extensions must have at least 2 characters of content");O.extensions.push({singleton:L.charAt(x+1),extensions:L.slice(x+3,I).split("-")}),x=I}}else x=0;if(x===0&&D.charCodeAt(x)===120||D.charCodeAt(x)===45&&D.charCodeAt(x+1)===120)for(I=x=x?x+2:1;D.charCodeAt(I)===45&&m(D.charCodeAt(I+1));){for(I=B=x+1;m(D.charCodeAt(I));){if(I-B>7)return U(I,5,"Too long private-use area, expected at most 8 characters");I++}O.privateuse.push(L.slice(x+1,I)),x=I}if(x!==L.length)return U(x,6,"Found superfluous content after tag");return O;function U(w,k,K){return F.warning&&F.warning(K,k,w),F.forgiving?O:C()}}function C(){return{language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null}}},"./node_modules/bcp-47/lib/stringify.js":h=>{h.exports=f;function f(d){var m=d||{},g=[],v,_,S;if(m.irregular||m.regular)return m.irregular||m.regular;if(m.language)for(g=g.concat(m.language,m.extendedLanguageSubtags||[],m.script||[],m.region||[],m.variants||[]),v=m.extensions||[],_=-1;++_<v.length;)S=v[_],S.singleton&&S.extensions&&S.extensions.length&&(g=g.concat(S.singleton,S.extensions));return m.privateuse&&m.privateuse.length&&(g=g.concat("x",m.privateuse)),g.join("-")}},"./node_modules/buffer/index.js":(h,f,d)=>{/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var m=d("./node_modules/buffer/node_modules/base64-js/index.js"),g=d("./node_modules/buffer/node_modules/ieee754/index.js"),v=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;f.Buffer=T,f.SlowBuffer=I,f.INSPECT_MAX_BYTES=50;var _=2147483647;f.kMaxLength=_,T.TYPED_ARRAY_SUPPORT=S(),!T.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function S(){try{var X=new Uint8Array(1),z={foo:function(){return 42}};return Object.setPrototypeOf(z,Uint8Array.prototype),Object.setPrototypeOf(X,z),X.foo()===42}catch{return!1}}Object.defineProperty(T.prototype,"parent",{enumerable:!0,get:function(){if(T.isBuffer(this))return this.buffer}}),Object.defineProperty(T.prototype,"offset",{enumerable:!0,get:function(){if(T.isBuffer(this))return this.byteOffset}});function E(X){if(X>_)throw new RangeError('The value "'+X+'" is invalid for option "size"');var z=new Uint8Array(X);return Object.setPrototypeOf(z,T.prototype),z}function T(X,z,ne){if(typeof X=="number"){if(typeof z=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return F(X)}return C(X,z,ne)}T.poolSize=8192;function C(X,z,ne){if(typeof X=="string")return O(X,z);if(ArrayBuffer.isView(X))return D(X);if(X==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof X);if($(X,ArrayBuffer)||X&&$(X.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&($(X,SharedArrayBuffer)||X&&$(X.buffer,SharedArrayBuffer)))return x(X,z,ne);if(typeof X=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var fe=X.valueOf&&X.valueOf();if(fe!=null&&fe!==X)return T.from(fe,z,ne);var Ce=B(X);if(Ce)return Ce;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof X[Symbol.toPrimitive]=="function")return T.from(X[Symbol.toPrimitive]("string"),z,ne);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof X)}T.from=function(X,z,ne){return C(X,z,ne)},Object.setPrototypeOf(T.prototype,Uint8Array.prototype),Object.setPrototypeOf(T,Uint8Array);function R(X){if(typeof X!="number")throw new TypeError('"size" argument must be of type number');if(X<0)throw new RangeError('The value "'+X+'" is invalid for option "size"')}function b(X,z,ne){return R(X),X<=0?E(X):z!==void 0?typeof ne=="string"?E(X).fill(z,ne):E(X).fill(z):E(X)}T.alloc=function(X,z,ne){return b(X,z,ne)};function F(X){return R(X),E(X<0?0:M(X)|0)}T.allocUnsafe=function(X){return F(X)},T.allocUnsafeSlow=function(X){return F(X)};function O(X,z){if((typeof z!="string"||z==="")&&(z="utf8"),!T.isEncoding(z))throw new TypeError("Unknown encoding: "+z);var ne=U(X,z)|0,fe=E(ne),Ce=fe.write(X,z);return Ce!==ne&&(fe=fe.slice(0,Ce)),fe}function L(X){for(var z=X.length<0?0:M(X.length)|0,ne=E(z),fe=0;fe<z;fe+=1)ne[fe]=X[fe]&255;return ne}function D(X){if($(X,Uint8Array)){var z=new Uint8Array(X);return x(z.buffer,z.byteOffset,z.byteLength)}return L(X)}function x(X,z,ne){if(z<0||X.byteLength<z)throw new RangeError('"offset" is outside of buffer bounds');if(X.byteLength<z+(ne||0))throw new RangeError('"length" is outside of buffer bounds');var fe;return z===void 0&&ne===void 0?fe=new Uint8Array(X):ne===void 0?fe=new Uint8Array(X,z):fe=new Uint8Array(X,z,ne),Object.setPrototypeOf(fe,T.prototype),fe}function B(X){if(T.isBuffer(X)){var z=M(X.length)|0,ne=E(z);return ne.length===0||X.copy(ne,0,0,z),ne}if(X.length!==void 0)return typeof X.length!="number"||re(X.length)?E(0):L(X);if(X.type==="Buffer"&&Array.isArray(X.data))return L(X.data)}function M(X){if(X>=_)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+_.toString(16)+" bytes");return X|0}function I(X){return+X!=X&&(X=0),T.alloc(+X)}T.isBuffer=function(z){return z!=null&&z._isBuffer===!0&&z!==T.prototype},T.compare=function(z,ne){if($(z,Uint8Array)&&(z=T.from(z,z.offset,z.byteLength)),$(ne,Uint8Array)&&(ne=T.from(ne,ne.offset,ne.byteLength)),!T.isBuffer(z)||!T.isBuffer(ne))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(z===ne)return 0;for(var fe=z.length,Ce=ne.length,Pe=0,he=Math.min(fe,Ce);Pe<he;++Pe)if(z[Pe]!==ne[Pe]){fe=z[Pe],Ce=ne[Pe];break}return fe<Ce?-1:Ce<fe?1:0},T.isEncoding=function(z){switch(String(z).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},T.concat=function(z,ne){if(!Array.isArray(z))throw new TypeError('"list" argument must be an Array of Buffers');if(z.length===0)return T.alloc(0);var fe;if(ne===void 0)for(ne=0,fe=0;fe<z.length;++fe)ne+=z[fe].length;var Ce=T.allocUnsafe(ne),Pe=0;for(fe=0;fe<z.length;++fe){var he=z[fe];if($(he,Uint8Array))Pe+he.length>Ce.length?T.from(he).copy(Ce,Pe):Uint8Array.prototype.set.call(Ce,he,Pe);else if(T.isBuffer(he))he.copy(Ce,Pe);else throw new TypeError('"list" argument must be an Array of Buffers');Pe+=he.length}return Ce};function U(X,z){if(T.isBuffer(X))return X.length;if(ArrayBuffer.isView(X)||$(X,ArrayBuffer))return X.byteLength;if(typeof X!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof X);var ne=X.length,fe=arguments.length>2&&arguments[2]===!0;if(!fe&&ne===0)return 0;for(var Ce=!1;;)switch(z){case"ascii":case"latin1":case"binary":return ne;case"utf8":case"utf-8":return pe(X).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ne*2;case"hex":return ne>>>1;case"base64":return V(X).length;default:if(Ce)return fe?-1:pe(X).length;z=(""+z).toLowerCase(),Ce=!0}}T.byteLength=U;function w(X,z,ne){var fe=!1;if((z===void 0||z<0)&&(z=0),z>this.length||((ne===void 0||ne>this.length)&&(ne=this.length),ne<=0)||(ne>>>=0,z>>>=0,ne<=z))return"";for(X||(X="utf8");;)switch(X){case"hex":return Se(this,z,ne);case"utf8":case"utf-8":return se(this,z,ne);case"ascii":return Z(this,z,ne);case"latin1":case"binary":return Ee(this,z,ne);case"base64":return Q(this,z,ne);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Me(this,z,ne);default:if(fe)throw new TypeError("Unknown encoding: "+X);X=(X+"").toLowerCase(),fe=!0}}T.prototype._isBuffer=!0;function k(X,z,ne){var fe=X[z];X[z]=X[ne],X[ne]=fe}T.prototype.swap16=function(){var z=this.length;if(z%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var ne=0;ne<z;ne+=2)k(this,ne,ne+1);return this},T.prototype.swap32=function(){var z=this.length;if(z%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var ne=0;ne<z;ne+=4)k(this,ne,ne+3),k(this,ne+1,ne+2);return this},T.prototype.swap64=function(){var z=this.length;if(z%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var ne=0;ne<z;ne+=8)k(this,ne,ne+7),k(this,ne+1,ne+6),k(this,ne+2,ne+5),k(this,ne+3,ne+4);return this},T.prototype.toString=function(){var z=this.length;return z===0?"":arguments.length===0?se(this,0,z):w.apply(this,arguments)},T.prototype.toLocaleString=T.prototype.toString,T.prototype.equals=function(z){if(!T.isBuffer(z))throw new TypeError("Argument must be a Buffer");return this===z?!0:T.compare(this,z)===0},T.prototype.inspect=function(){var z="",ne=f.INSPECT_MAX_BYTES;return z=this.toString("hex",0,ne).replace(/(.{2})/g,"$1 ").trim(),this.length>ne&&(z+=" ... "),"<Buffer "+z+">"},v&&(T.prototype[v]=T.prototype.inspect),T.prototype.compare=function(z,ne,fe,Ce,Pe){if($(z,Uint8Array)&&(z=T.from(z,z.offset,z.byteLength)),!T.isBuffer(z))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof z);if(ne===void 0&&(ne=0),fe===void 0&&(fe=z?z.length:0),Ce===void 0&&(Ce=0),Pe===void 0&&(Pe=this.length),ne<0||fe>z.length||Ce<0||Pe>this.length)throw new RangeError("out of range index");if(Ce>=Pe&&ne>=fe)return 0;if(Ce>=Pe)return-1;if(ne>=fe)return 1;if(ne>>>=0,fe>>>=0,Ce>>>=0,Pe>>>=0,this===z)return 0;for(var he=Pe-Ce,Ue=fe-ne,we=Math.min(he,Ue),$e=this.slice(Ce,Pe),it=z.slice(ne,fe),mt=0;mt<we;++mt)if($e[mt]!==it[mt]){he=$e[mt],Ue=it[mt];break}return he<Ue?-1:Ue<he?1:0};function K(X,z,ne,fe,Ce){if(X.length===0)return-1;if(typeof ne=="string"?(fe=ne,ne=0):ne>2147483647?ne=2147483647:ne<-2147483648&&(ne=-2147483648),ne=+ne,re(ne)&&(ne=Ce?0:X.length-1),ne<0&&(ne=X.length+ne),ne>=X.length){if(Ce)return-1;ne=X.length-1}else if(ne<0)if(Ce)ne=0;else return-1;if(typeof z=="string"&&(z=T.from(z,fe)),T.isBuffer(z))return z.length===0?-1:W(X,z,ne,fe,Ce);if(typeof z=="number")return z=z&255,typeof Uint8Array.prototype.indexOf=="function"?Ce?Uint8Array.prototype.indexOf.call(X,z,ne):Uint8Array.prototype.lastIndexOf.call(X,z,ne):W(X,[z],ne,fe,Ce);throw new TypeError("val must be string, number or Buffer")}function W(X,z,ne,fe,Ce){var Pe=1,he=X.length,Ue=z.length;if(fe!==void 0&&(fe=String(fe).toLowerCase(),fe==="ucs2"||fe==="ucs-2"||fe==="utf16le"||fe==="utf-16le")){if(X.length<2||z.length<2)return-1;Pe=2,he/=2,Ue/=2,ne/=2}function we(Pt,lt){return Pe===1?Pt[lt]:Pt.readUInt16BE(lt*Pe)}var $e;if(Ce){var it=-1;for($e=ne;$e<he;$e++)if(we(X,$e)===we(z,it===-1?0:$e-it)){if(it===-1&&(it=$e),$e-it+1===Ue)return it*Pe}else it!==-1&&($e-=$e-it),it=-1}else for(ne+Ue>he&&(ne=he-Ue),$e=ne;$e>=0;$e--){for(var mt=!0,pt=0;pt<Ue;pt++)if(we(X,$e+pt)!==we(z,pt)){mt=!1;break}if(mt)return $e}return-1}T.prototype.includes=function(z,ne,fe){return this.indexOf(z,ne,fe)!==-1},T.prototype.indexOf=function(z,ne,fe){return K(this,z,ne,fe,!0)},T.prototype.lastIndexOf=function(z,ne,fe){return K(this,z,ne,fe,!1)};function Y(X,z,ne,fe){ne=Number(ne)||0;var Ce=X.length-ne;fe?(fe=Number(fe),fe>Ce&&(fe=Ce)):fe=Ce;var Pe=z.length;fe>Pe/2&&(fe=Pe/2);for(var he=0;he<fe;++he){var Ue=parseInt(z.substr(he*2,2),16);if(re(Ue))return he;X[ne+he]=Ue}return he}function J(X,z,ne,fe){return j(pe(z,X.length-ne),X,ne,fe)}function ee(X,z,ne,fe){return j(Re(z),X,ne,fe)}function ue(X,z,ne,fe){return j(V(z),X,ne,fe)}function ie(X,z,ne,fe){return j(me(z,X.length-ne),X,ne,fe)}T.prototype.write=function(z,ne,fe,Ce){if(ne===void 0)Ce="utf8",fe=this.length,ne=0;else if(fe===void 0&&typeof ne=="string")Ce=ne,fe=this.length,ne=0;else if(isFinite(ne))ne=ne>>>0,isFinite(fe)?(fe=fe>>>0,Ce===void 0&&(Ce="utf8")):(Ce=fe,fe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Pe=this.length-ne;if((fe===void 0||fe>Pe)&&(fe=Pe),z.length>0&&(fe<0||ne<0)||ne>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ce||(Ce="utf8");for(var he=!1;;)switch(Ce){case"hex":return Y(this,z,ne,fe);case"utf8":case"utf-8":return J(this,z,ne,fe);case"ascii":case"latin1":case"binary":return ee(this,z,ne,fe);case"base64":return ue(this,z,ne,fe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ie(this,z,ne,fe);default:if(he)throw new TypeError("Unknown encoding: "+Ce);Ce=(""+Ce).toLowerCase(),he=!0}},T.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Q(X,z,ne){return z===0&&ne===X.length?m.fromByteArray(X):m.fromByteArray(X.slice(z,ne))}function se(X,z,ne){ne=Math.min(X.length,ne);for(var fe=[],Ce=z;Ce<ne;){var Pe=X[Ce],he=null,Ue=Pe>239?4:Pe>223?3:Pe>191?2:1;if(Ce+Ue<=ne){var we,$e,it,mt;switch(Ue){case 1:Pe<128&&(he=Pe);break;case 2:we=X[Ce+1],(we&192)===128&&(mt=(Pe&31)<<6|we&63,mt>127&&(he=mt));break;case 3:we=X[Ce+1],$e=X[Ce+2],(we&192)===128&&($e&192)===128&&(mt=(Pe&15)<<12|(we&63)<<6|$e&63,mt>2047&&(mt<55296||mt>57343)&&(he=mt));break;case 4:we=X[Ce+1],$e=X[Ce+2],it=X[Ce+3],(we&192)===128&&($e&192)===128&&(it&192)===128&&(mt=(Pe&15)<<18|(we&63)<<12|($e&63)<<6|it&63,mt>65535&&mt<1114112&&(he=mt))}}he===null?(he=65533,Ue=1):he>65535&&(he-=65536,fe.push(he>>>10&1023|55296),he=56320|he&1023),fe.push(he),Ce+=Ue}return _e(fe)}var ve=4096;function _e(X){var z=X.length;if(z<=ve)return String.fromCharCode.apply(String,X);for(var ne="",fe=0;fe<z;)ne+=String.fromCharCode.apply(String,X.slice(fe,fe+=ve));return ne}function Z(X,z,ne){var fe="";ne=Math.min(X.length,ne);for(var Ce=z;Ce<ne;++Ce)fe+=String.fromCharCode(X[Ce]&127);return fe}function Ee(X,z,ne){var fe="";ne=Math.min(X.length,ne);for(var Ce=z;Ce<ne;++Ce)fe+=String.fromCharCode(X[Ce]);return fe}function Se(X,z,ne){var fe=X.length;(!z||z<0)&&(z=0),(!ne||ne<0||ne>fe)&&(ne=fe);for(var Ce="",Pe=z;Pe<ne;++Pe)Ce+=oe[X[Pe]];return Ce}function Me(X,z,ne){for(var fe=X.slice(z,ne),Ce="",Pe=0;Pe<fe.length-1;Pe+=2)Ce+=String.fromCharCode(fe[Pe]+fe[Pe+1]*256);return Ce}T.prototype.slice=function(z,ne){var fe=this.length;z=~~z,ne=ne===void 0?fe:~~ne,z<0?(z+=fe,z<0&&(z=0)):z>fe&&(z=fe),ne<0?(ne+=fe,ne<0&&(ne=0)):ne>fe&&(ne=fe),ne<z&&(ne=z);var Ce=this.subarray(z,ne);return Object.setPrototypeOf(Ce,T.prototype),Ce};function de(X,z,ne){if(X%1!==0||X<0)throw new RangeError("offset is not uint");if(X+z>ne)throw new RangeError("Trying to access beyond buffer length")}T.prototype.readUintLE=T.prototype.readUIntLE=function(z,ne,fe){z=z>>>0,ne=ne>>>0,fe||de(z,ne,this.length);for(var Ce=this[z],Pe=1,he=0;++he<ne&&(Pe*=256);)Ce+=this[z+he]*Pe;return Ce},T.prototype.readUintBE=T.prototype.readUIntBE=function(z,ne,fe){z=z>>>0,ne=ne>>>0,fe||de(z,ne,this.length);for(var Ce=this[z+--ne],Pe=1;ne>0&&(Pe*=256);)Ce+=this[z+--ne]*Pe;return Ce},T.prototype.readUint8=T.prototype.readUInt8=function(z,ne){return z=z>>>0,ne||de(z,1,this.length),this[z]},T.prototype.readUint16LE=T.prototype.readUInt16LE=function(z,ne){return z=z>>>0,ne||de(z,2,this.length),this[z]|this[z+1]<<8},T.prototype.readUint16BE=T.prototype.readUInt16BE=function(z,ne){return z=z>>>0,ne||de(z,2,this.length),this[z]<<8|this[z+1]},T.prototype.readUint32LE=T.prototype.readUInt32LE=function(z,ne){return z=z>>>0,ne||de(z,4,this.length),(this[z]|this[z+1]<<8|this[z+2]<<16)+this[z+3]*16777216},T.prototype.readUint32BE=T.prototype.readUInt32BE=function(z,ne){return z=z>>>0,ne||de(z,4,this.length),this[z]*16777216+(this[z+1]<<16|this[z+2]<<8|this[z+3])},T.prototype.readIntLE=function(z,ne,fe){z=z>>>0,ne=ne>>>0,fe||de(z,ne,this.length);for(var Ce=this[z],Pe=1,he=0;++he<ne&&(Pe*=256);)Ce+=this[z+he]*Pe;return Pe*=128,Ce>=Pe&&(Ce-=Math.pow(2,8*ne)),Ce},T.prototype.readIntBE=function(z,ne,fe){z=z>>>0,ne=ne>>>0,fe||de(z,ne,this.length);for(var Ce=ne,Pe=1,he=this[z+--Ce];Ce>0&&(Pe*=256);)he+=this[z+--Ce]*Pe;return Pe*=128,he>=Pe&&(he-=Math.pow(2,8*ne)),he},T.prototype.readInt8=function(z,ne){return z=z>>>0,ne||de(z,1,this.length),this[z]&128?(255-this[z]+1)*-1:this[z]},T.prototype.readInt16LE=function(z,ne){z=z>>>0,ne||de(z,2,this.length);var fe=this[z]|this[z+1]<<8;return fe&32768?fe|4294901760:fe},T.prototype.readInt16BE=function(z,ne){z=z>>>0,ne||de(z,2,this.length);var fe=this[z+1]|this[z]<<8;return fe&32768?fe|4294901760:fe},T.prototype.readInt32LE=function(z,ne){return z=z>>>0,ne||de(z,4,this.length),this[z]|this[z+1]<<8|this[z+2]<<16|this[z+3]<<24},T.prototype.readInt32BE=function(z,ne){return z=z>>>0,ne||de(z,4,this.length),this[z]<<24|this[z+1]<<16|this[z+2]<<8|this[z+3]},T.prototype.readFloatLE=function(z,ne){return z=z>>>0,ne||de(z,4,this.length),g.read(this,z,!0,23,4)},T.prototype.readFloatBE=function(z,ne){return z=z>>>0,ne||de(z,4,this.length),g.read(this,z,!1,23,4)},T.prototype.readDoubleLE=function(z,ne){return z=z>>>0,ne||de(z,8,this.length),g.read(this,z,!0,52,8)},T.prototype.readDoubleBE=function(z,ne){return z=z>>>0,ne||de(z,8,this.length),g.read(this,z,!1,52,8)};function xe(X,z,ne,fe,Ce,Pe){if(!T.isBuffer(X))throw new TypeError('"buffer" argument must be a Buffer instance');if(z>Ce||z<Pe)throw new RangeError('"value" argument is out of bounds');if(ne+fe>X.length)throw new RangeError("Index out of range")}T.prototype.writeUintLE=T.prototype.writeUIntLE=function(z,ne,fe,Ce){if(z=+z,ne=ne>>>0,fe=fe>>>0,!Ce){var Pe=Math.pow(2,8*fe)-1;xe(this,z,ne,fe,Pe,0)}var he=1,Ue=0;for(this[ne]=z&255;++Ue<fe&&(he*=256);)this[ne+Ue]=z/he&255;return ne+fe},T.prototype.writeUintBE=T.prototype.writeUIntBE=function(z,ne,fe,Ce){if(z=+z,ne=ne>>>0,fe=fe>>>0,!Ce){var Pe=Math.pow(2,8*fe)-1;xe(this,z,ne,fe,Pe,0)}var he=fe-1,Ue=1;for(this[ne+he]=z&255;--he>=0&&(Ue*=256);)this[ne+he]=z/Ue&255;return ne+fe},T.prototype.writeUint8=T.prototype.writeUInt8=function(z,ne,fe){return z=+z,ne=ne>>>0,fe||xe(this,z,ne,1,255,0),this[ne]=z&255,ne+1},T.prototype.writeUint16LE=T.prototype.writeUInt16LE=function(z,ne,fe){return z=+z,ne=ne>>>0,fe||xe(this,z,ne,2,65535,0),this[ne]=z&255,this[ne+1]=z>>>8,ne+2},T.prototype.writeUint16BE=T.prototype.writeUInt16BE=function(z,ne,fe){return z=+z,ne=ne>>>0,fe||xe(this,z,ne,2,65535,0),this[ne]=z>>>8,this[ne+1]=z&255,ne+2},T.prototype.writeUint32LE=T.prototype.writeUInt32LE=function(z,ne,fe){return z=+z,ne=ne>>>0,fe||xe(this,z,ne,4,4294967295,0),this[ne+3]=z>>>24,this[ne+2]=z>>>16,this[ne+1]=z>>>8,this[ne]=z&255,ne+4},T.prototype.writeUint32BE=T.prototype.writeUInt32BE=function(z,ne,fe){return z=+z,ne=ne>>>0,fe||xe(this,z,ne,4,4294967295,0),this[ne]=z>>>24,this[ne+1]=z>>>16,this[ne+2]=z>>>8,this[ne+3]=z&255,ne+4},T.prototype.writeIntLE=function(z,ne,fe,Ce){if(z=+z,ne=ne>>>0,!Ce){var Pe=Math.pow(2,8*fe-1);xe(this,z,ne,fe,Pe-1,-Pe)}var he=0,Ue=1,we=0;for(this[ne]=z&255;++he<fe&&(Ue*=256);)z<0&&we===0&&this[ne+he-1]!==0&&(we=1),this[ne+he]=(z/Ue>>0)-we&255;return ne+fe},T.prototype.writeIntBE=function(z,ne,fe,Ce){if(z=+z,ne=ne>>>0,!Ce){var Pe=Math.pow(2,8*fe-1);xe(this,z,ne,fe,Pe-1,-Pe)}var he=fe-1,Ue=1,we=0;for(this[ne+he]=z&255;--he>=0&&(Ue*=256);)z<0&&we===0&&this[ne+he+1]!==0&&(we=1),this[ne+he]=(z/Ue>>0)-we&255;return ne+fe},T.prototype.writeInt8=function(z,ne,fe){return z=+z,ne=ne>>>0,fe||xe(this,z,ne,1,127,-128),z<0&&(z=255+z+1),this[ne]=z&255,ne+1},T.prototype.writeInt16LE=function(z,ne,fe){return z=+z,ne=ne>>>0,fe||xe(this,z,ne,2,32767,-32768),this[ne]=z&255,this[ne+1]=z>>>8,ne+2},T.prototype.writeInt16BE=function(z,ne,fe){return z=+z,ne=ne>>>0,fe||xe(this,z,ne,2,32767,-32768),this[ne]=z>>>8,this[ne+1]=z&255,ne+2},T.prototype.writeInt32LE=function(z,ne,fe){return z=+z,ne=ne>>>0,fe||xe(this,z,ne,4,2147483647,-2147483648),this[ne]=z&255,this[ne+1]=z>>>8,this[ne+2]=z>>>16,this[ne+3]=z>>>24,ne+4},T.prototype.writeInt32BE=function(z,ne,fe){return z=+z,ne=ne>>>0,fe||xe(this,z,ne,4,2147483647,-2147483648),z<0&&(z=4294967295+z+1),this[ne]=z>>>24,this[ne+1]=z>>>16,this[ne+2]=z>>>8,this[ne+3]=z&255,ne+4};function Fe(X,z,ne,fe,Ce,Pe){if(ne+fe>X.length)throw new RangeError("Index out of range");if(ne<0)throw new RangeError("Index out of range")}function Le(X,z,ne,fe,Ce){return z=+z,ne=ne>>>0,Ce||Fe(X,z,ne,4),g.write(X,z,ne,fe,23,4),ne+4}T.prototype.writeFloatLE=function(z,ne,fe){return Le(this,z,ne,!0,fe)},T.prototype.writeFloatBE=function(z,ne,fe){return Le(this,z,ne,!1,fe)};function De(X,z,ne,fe,Ce){return z=+z,ne=ne>>>0,Ce||Fe(X,z,ne,8),g.write(X,z,ne,fe,52,8),ne+8}T.prototype.writeDoubleLE=function(z,ne,fe){return De(this,z,ne,!0,fe)},T.prototype.writeDoubleBE=function(z,ne,fe){return De(this,z,ne,!1,fe)},T.prototype.copy=function(z,ne,fe,Ce){if(!T.isBuffer(z))throw new TypeError("argument should be a Buffer");if(fe||(fe=0),!Ce&&Ce!==0&&(Ce=this.length),ne>=z.length&&(ne=z.length),ne||(ne=0),Ce>0&&Ce<fe&&(Ce=fe),Ce===fe||z.length===0||this.length===0)return 0;if(ne<0)throw new RangeError("targetStart out of bounds");if(fe<0||fe>=this.length)throw new RangeError("Index out of range");if(Ce<0)throw new RangeError("sourceEnd out of bounds");Ce>this.length&&(Ce=this.length),z.length-ne<Ce-fe&&(Ce=z.length-ne+fe);var Pe=Ce-fe;return this===z&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(ne,fe,Ce):Uint8Array.prototype.set.call(z,this.subarray(fe,Ce),ne),Pe},T.prototype.fill=function(z,ne,fe,Ce){if(typeof z=="string"){if(typeof ne=="string"?(Ce=ne,ne=0,fe=this.length):typeof fe=="string"&&(Ce=fe,fe=this.length),Ce!==void 0&&typeof Ce!="string")throw new TypeError("encoding must be a string");if(typeof Ce=="string"&&!T.isEncoding(Ce))throw new TypeError("Unknown encoding: "+Ce);if(z.length===1){var Pe=z.charCodeAt(0);(Ce==="utf8"&&Pe<128||Ce==="latin1")&&(z=Pe)}}else typeof z=="number"?z=z&255:typeof z=="boolean"&&(z=Number(z));if(ne<0||this.length<ne||this.length<fe)throw new RangeError("Out of range index");if(fe<=ne)return this;ne=ne>>>0,fe=fe===void 0?this.length:fe>>>0,z||(z=0);var he;if(typeof z=="number")for(he=ne;he<fe;++he)this[he]=z;else{var Ue=T.isBuffer(z)?z:T.from(z,Ce),we=Ue.length;if(we===0)throw new TypeError('The value "'+z+'" is invalid for argument "value"');for(he=0;he<fe-ne;++he)this[he+ne]=Ue[he%we]}return this};var Ae=/[^+/0-9A-Za-z-_]/g;function ge(X){if(X=X.split("=")[0],X=X.trim().replace(Ae,""),X.length<2)return"";for(;X.length%4!==0;)X=X+"=";return X}function pe(X,z){z=z||1/0;for(var ne,fe=X.length,Ce=null,Pe=[],he=0;he<fe;++he){if(ne=X.charCodeAt(he),ne>55295&&ne<57344){if(!Ce){if(ne>56319){(z-=3)>-1&&Pe.push(239,191,189);continue}else if(he+1===fe){(z-=3)>-1&&Pe.push(239,191,189);continue}Ce=ne;continue}if(ne<56320){(z-=3)>-1&&Pe.push(239,191,189),Ce=ne;continue}ne=(Ce-55296<<10|ne-56320)+65536}else Ce&&(z-=3)>-1&&Pe.push(239,191,189);if(Ce=null,ne<128){if((z-=1)<0)break;Pe.push(ne)}else if(ne<2048){if((z-=2)<0)break;Pe.push(ne>>6|192,ne&63|128)}else if(ne<65536){if((z-=3)<0)break;Pe.push(ne>>12|224,ne>>6&63|128,ne&63|128)}else if(ne<1114112){if((z-=4)<0)break;Pe.push(ne>>18|240,ne>>12&63|128,ne>>6&63|128,ne&63|128)}else throw new Error("Invalid code point")}return Pe}function Re(X){for(var z=[],ne=0;ne<X.length;++ne)z.push(X.charCodeAt(ne)&255);return z}function me(X,z){for(var ne,fe,Ce,Pe=[],he=0;he<X.length&&!((z-=2)<0);++he)ne=X.charCodeAt(he),fe=ne>>8,Ce=ne%256,Pe.push(Ce),Pe.push(fe);return Pe}function V(X){return m.toByteArray(ge(X))}function j(X,z,ne,fe){for(var Ce=0;Ce<fe&&!(Ce+ne>=z.length||Ce>=X.length);++Ce)z[Ce+ne]=X[Ce];return Ce}function $(X,z){return X instanceof z||X!=null&&X.constructor!=null&&X.constructor.name!=null&&X.constructor.name===z.name}function re(X){return X!==X}var oe=function(){for(var X="0123456789abcdef",z=new Array(256),ne=0;ne<16;++ne)for(var fe=ne*16,Ce=0;Ce<16;++Ce)z[fe+Ce]=X[ne]+X[Ce];return z}()},"./node_modules/buffer/node_modules/base64-js/index.js":(h,f)=>{f.byteLength=T,f.toByteArray=R,f.fromByteArray=O;for(var d=[],m=[],g=typeof Uint8Array<"u"?Uint8Array:Array,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_=0,S=v.length;_<S;++_)d[_]=v[_],m[v.charCodeAt(_)]=_;m["-".charCodeAt(0)]=62,m["_".charCodeAt(0)]=63;function E(L){var D=L.length;if(D%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var x=L.indexOf("=");x===-1&&(x=D);var B=x===D?0:4-x%4;return[x,B]}function T(L){var D=E(L),x=D[0],B=D[1];return(x+B)*3/4-B}function C(L,D,x){return(D+x)*3/4-x}function R(L){var D,x=E(L),B=x[0],M=x[1],I=new g(C(L,B,M)),U=0,w=M>0?B-4:B,k;for(k=0;k<w;k+=4)D=m[L.charCodeAt(k)]<<18|m[L.charCodeAt(k+1)]<<12|m[L.charCodeAt(k+2)]<<6|m[L.charCodeAt(k+3)],I[U++]=D>>16&255,I[U++]=D>>8&255,I[U++]=D&255;return M===2&&(D=m[L.charCodeAt(k)]<<2|m[L.charCodeAt(k+1)]>>4,I[U++]=D&255),M===1&&(D=m[L.charCodeAt(k)]<<10|m[L.charCodeAt(k+1)]<<4|m[L.charCodeAt(k+2)]>>2,I[U++]=D>>8&255,I[U++]=D&255),I}function b(L){return d[L>>18&63]+d[L>>12&63]+d[L>>6&63]+d[L&63]}function F(L,D,x){for(var B,M=[],I=D;I<x;I+=3)B=(L[I]<<16&16711680)+(L[I+1]<<8&65280)+(L[I+2]&255),M.push(b(B));return M.join("")}function O(L){for(var D,x=L.length,B=x%3,M=[],I=16383,U=0,w=x-B;U<w;U+=I)M.push(F(L,U,U+I>w?w:U+I));return B===1?(D=L[x-1],M.push(d[D>>2]+d[D<<4&63]+"==")):B===2&&(D=(L[x-2]<<8)+L[x-1],M.push(d[D>>10]+d[D>>4&63]+d[D<<2&63]+"=")),M.join("")}},"./node_modules/buffer/node_modules/ieee754/index.js":(h,f)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */f.read=function(d,m,g,v,_){var S,E,T=_*8-v-1,C=(1<<T)-1,R=C>>1,b=-7,F=g?_-1:0,O=g?-1:1,L=d[m+F];for(F+=O,S=L&(1<<-b)-1,L>>=-b,b+=T;b>0;S=S*256+d[m+F],F+=O,b-=8);for(E=S&(1<<-b)-1,S>>=-b,b+=v;b>0;E=E*256+d[m+F],F+=O,b-=8);if(S===0)S=1-R;else{if(S===C)return E?NaN:(L?-1:1)*(1/0);E=E+Math.pow(2,v),S=S-R}return(L?-1:1)*E*Math.pow(2,S-v)},f.write=function(d,m,g,v,_,S){var E,T,C,R=S*8-_-1,b=(1<<R)-1,F=b>>1,O=_===23?Math.pow(2,-24)-Math.pow(2,-77):0,L=v?0:S-1,D=v?1:-1,x=m<0||m===0&&1/m<0?1:0;for(m=Math.abs(m),isNaN(m)||m===1/0?(T=isNaN(m)?1:0,E=b):(E=Math.floor(Math.log(m)/Math.LN2),m*(C=Math.pow(2,-E))<1&&(E--,C*=2),E+F>=1?m+=O/C:m+=O*Math.pow(2,1-F),m*C>=2&&(E++,C/=2),E+F>=b?(T=0,E=b):E+F>=1?(T=(m*C-1)*Math.pow(2,_),E=E+F):(T=m*Math.pow(2,F-1)*Math.pow(2,_),E=0));_>=8;d[g+L]=T&255,L+=D,T/=256,_-=8);for(E=E<<_|T,R+=_;R>0;d[g+L]=E&255,L+=D,E/=256,R-=8);d[g+L-D]|=x*128}},"./node_modules/codem-isoboxer/dist/iso_boxer.js":(h,f)=>{/*! codem-isoboxer v0.3.6 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */var d={};d.parseBuffer=function(v){return new m(v).parse()},d.addBoxProcessor=function(v,_){typeof v!="string"||typeof _!="function"||(g.prototype._boxProcessors[v]=_)},d.createFile=function(){return new m},d.createBox=function(v,_,S){var E=g.create(v);return _&&_.append(E,S),E},d.createFullBox=function(v,_,S){var E=d.createBox(v,_,S);return E.version=0,E.flags=0,E},d.Utils={},d.Utils.dataViewToString=function(v,_){var S=_||"utf-8";if(typeof TextDecoder<"u")return new TextDecoder(S).decode(v);var E=[],T=0;if(S==="utf-8")for(;T<v.byteLength;){var C=v.getUint8(T++);C<128||(C<224?(C=(C&31)<<6,C|=v.getUint8(T++)&63):C<240?(C=(C&15)<<12,C|=(v.getUint8(T++)&63)<<6,C|=v.getUint8(T++)&63):(C=(C&7)<<18,C|=(v.getUint8(T++)&63)<<12,C|=(v.getUint8(T++)&63)<<6,C|=v.getUint8(T++)&63)),E.push(String.fromCharCode(C))}else for(;T<v.byteLength;)E.push(String.fromCharCode(v.getUint8(T++)));return E.join("")},d.Utils.utf8ToByteArray=function(v){var _,S;if(typeof TextEncoder<"u")_=new TextEncoder().encode(v);else for(_=[],S=0;S<v.length;++S){var E=v.charCodeAt(S);E<128?_.push(E):E<2048?(_.push(192|E>>6),_.push(128|63&E)):E<65536?(_.push(224|E>>12),_.push(128|63&E>>6),_.push(128|63&E)):(_.push(240|E>>18),_.push(128|63&E>>12),_.push(128|63&E>>6),_.push(128|63&E))}return _},d.Utils.appendBox=function(v,_,S){if(_._offset=v._cursor.offset,_._root=v._root?v._root:v,_._raw=v._raw,_._parent=v,S!==-1){if(S==null){v.boxes.push(_);return}var E=-1,T;if(typeof S=="number")E=S;else{if(typeof S=="string")T=S;else if(typeof S=="object"&&S.type)T=S.type;else{v.boxes.push(_);return}for(var C=0;C<v.boxes.length;C++)if(T===v.boxes[C].type){E=C+1;break}}v.boxes.splice(E,0,_)}},f.parseBuffer=d.parseBuffer,f.addBoxProcessor=d.addBoxProcessor,f.createFile=d.createFile,f.createBox=d.createBox,f.createFullBox=d.createFullBox,f.Utils=d.Utils,d.Cursor=function(v){this.offset=typeof v>"u"?0:v};var m=function(v){this._cursor=new d.Cursor,this.boxes=[],v&&(this._raw=new DataView(v))};m.prototype.fetch=function(v){var _=this.fetchAll(v,!0);return _.length?_[0]:null},m.prototype.fetchAll=function(v,_){var S=[];return m._sweep.call(this,v,S,_),S},m.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var v=g.parse(this);if(typeof v.type>"u")break;this.boxes.push(v)}return this},m._sweep=function(v,_,S){this.type&&this.type==v&&_.push(this);for(var E in this.boxes){if(_.length&&S)return;m._sweep.call(this.boxes[E],v,_,S)}},m.prototype.write=function(){var v=0,_;for(_=0;_<this.boxes.length;_++)v+=this.boxes[_].getLength(!1);var S=new Uint8Array(v);for(this._rawo=new DataView(S.buffer),this.bytes=S,this._cursor.offset=0,_=0;_<this.boxes.length;_++)this.boxes[_].write();return S.buffer},m.prototype.append=function(v,_){d.Utils.appendBox(this,v,_)};var g=function(){this._cursor=new d.Cursor};g.parse=function(v){var _=new g;return _._offset=v._cursor.offset,_._root=v._root?v._root:v,_._raw=v._raw,_._parent=v,_._parseBox(),v._cursor.offset=_._raw.byteOffset+_._raw.byteLength,_},g.create=function(v){var _=new g;return _.type=v,_.boxes=[],_},g.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],g.prototype._boxProcessors={},g.prototype._procField=function(v,_,S){this._parsing?this[v]=this._readField(_,S):this._writeField(_,S,this[v])},g.prototype._procFieldArray=function(v,_,S,E){var T;if(this._parsing)for(this[v]=[],T=0;T<_;T++)this[v][T]=this._readField(S,E);else for(T=0;T<this[v].length;T++)this._writeField(S,E,this[v][T])},g.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},g.prototype._procEntries=function(v,_,S){var E;if(this._parsing)for(this[v]=[],E=0;E<_;E++)this[v].push({}),S.call(this,this[v][E]);else for(E=0;E<_;E++)S.call(this,this[v][E])},g.prototype._procSubEntries=function(v,_,S,E){var T;if(this._parsing)for(v[_]=[],T=0;T<S;T++)v[_].push({}),E.call(this,v[_][T]);else for(T=0;T<S;T++)E.call(this,v[_][T])},g.prototype._procEntryField=function(v,_,S,E){this._parsing?v[_]=this._readField(S,E):this._writeField(S,E,v[_])},g.prototype._procSubBoxes=function(v,_){var S;if(this._parsing)for(this[v]=[],S=0;S<_;S++)this[v].push(g.parse(this));else for(S=0;S<_;S++)this._rawo?this[v][S].write():this.size+=this[v][S].getLength()},g.prototype._readField=function(v,_){switch(v){case"uint":return this._readUint(_);case"int":return this._readInt(_);case"template":return this._readTemplate(_);case"string":return _===-1?this._readTerminatedString():this._readString(_);case"data":return this._readData(_);case"utf8":return this._readUTF8String();default:return-1}},g.prototype._readInt=function(v){var _=null,S=this._cursor.offset-this._raw.byteOffset;switch(v){case 8:_=this._raw.getInt8(S);break;case 16:_=this._raw.getInt16(S);break;case 32:_=this._raw.getInt32(S);break;case 64:var E=this._raw.getInt32(S),T=this._raw.getInt32(S+4);_=E*Math.pow(2,32)+T;break}return this._cursor.offset+=v>>3,_},g.prototype._readUint=function(v){var _=null,S=this._cursor.offset-this._raw.byteOffset,E,T;switch(v){case 8:_=this._raw.getUint8(S);break;case 16:_=this._raw.getUint16(S);break;case 24:E=this._raw.getUint16(S),T=this._raw.getUint8(S+2),_=(E<<8)+T;break;case 32:_=this._raw.getUint32(S);break;case 64:E=this._raw.getUint32(S),T=this._raw.getUint32(S+4),_=E*Math.pow(2,32)+T;break}return this._cursor.offset+=v>>3,_},g.prototype._readString=function(v){for(var _="",S=0;S<v;S++){var E=this._readUint(8);_+=String.fromCharCode(E)}return _},g.prototype._readTemplate=function(v){var _=this._readUint(v/2),S=this._readUint(v/2);return _+S/Math.pow(2,v/2)},g.prototype._readTerminatedString=function(){for(var v="";this._cursor.offset-this._offset<this._raw.byteLength;){var _=this._readUint(8);if(_===0)break;v+=String.fromCharCode(_)}return v},g.prototype._readData=function(v){var _=v>0?v:this._raw.byteLength-(this._cursor.offset-this._offset);if(_>0){var S=new Uint8Array(this._raw.buffer,this._cursor.offset,_);return this._cursor.offset+=_,S}else return null},g.prototype._readUTF8String=function(){var v=this._raw.byteLength-(this._cursor.offset-this._offset),_=null;return v>0&&(_=new DataView(this._raw.buffer,this._cursor.offset,v),this._cursor.offset+=v),_&&d.Utils.dataViewToString(_)},g.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength){this._root._incomplete=!0;return}switch(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1?this._parseContainerBox():this._data=this._readData())},g.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},g.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(g.parse(this))},g.prototype.append=function(v,_){d.Utils.appendBox(this,v,_)},g.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var v=0;v<this.boxes.length;v++)this.size+=this.boxes[v].getLength();return this._data&&this._writeData(this._data),this.size},g.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var v=0;v<this.boxes.length;v++)this.boxes[v].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},g.prototype._writeInt=function(v,_){if(this._rawo){var S=this._cursor.offset-this._rawo.byteOffset;switch(v){case 8:this._rawo.setInt8(S,_);break;case 16:this._rawo.setInt16(S,_);break;case 32:this._rawo.setInt32(S,_);break;case 64:var E=Math.floor(_/Math.pow(2,32)),T=_-E*Math.pow(2,32);this._rawo.setUint32(S,E),this._rawo.setUint32(S+4,T);break}this._cursor.offset+=v>>3}else this.size+=v>>3},g.prototype._writeUint=function(v,_){if(this._rawo){var S=this._cursor.offset-this._rawo.byteOffset,E,T;switch(v){case 8:this._rawo.setUint8(S,_);break;case 16:this._rawo.setUint16(S,_);break;case 24:E=(_&16776960)>>8,T=_&255,this._rawo.setUint16(S,E),this._rawo.setUint8(S+2,T);break;case 32:this._rawo.setUint32(S,_);break;case 64:E=Math.floor(_/Math.pow(2,32)),T=_-E*Math.pow(2,32),this._rawo.setUint32(S,E),this._rawo.setUint32(S+4,T);break}this._cursor.offset+=v>>3}else this.size+=v>>3},g.prototype._writeString=function(v,_){for(var S=0;S<v;S++)this._writeUint(8,_.charCodeAt(S))},g.prototype._writeTerminatedString=function(v){if(v.length!==0){for(var _=0;_<v.length;_++)this._writeUint(8,v.charCodeAt(_));this._writeUint(8,0)}},g.prototype._writeTemplate=function(v,_){var S=Math.floor(_),E=(_-S)*Math.pow(2,v/2);this._writeUint(v/2,S),this._writeUint(v/2,E)},g.prototype._writeData=function(v){var _;if(v)if(this._rawo){if(v instanceof Array){for(var S=this._cursor.offset-this._rawo.byteOffset,_=0;_<v.length;_++)this._rawo.setInt8(S+_,v[_]);this._cursor.offset+=v.length}v instanceof Uint8Array&&(this._root.bytes.set(v,this._cursor.offset),this._cursor.offset+=v.length)}else this.size+=v.length},g.prototype._writeUTF8String=function(v){var _=d.Utils.utf8ToByteArray(v);if(this._rawo)for(var S=new DataView(this._rawo.buffer,this._cursor.offset,_.length),E=0;E<_.length;E++)S.setUint8(E,_[E]);else this.size+=_.length},g.prototype._writeField=function(v,_,S){switch(v){case"uint":this._writeUint(_,S);break;case"int":this._writeInt(_,S);break;case"template":this._writeTemplate(_,S);break;case"string":_==-1?this._writeTerminatedString(S):this._writeString(_,S);break;case"data":this._writeData(S);break;case"utf8":this._writeUTF8String(S);break}},g.prototype._boxProcessors.avc1=g.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},g.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},g.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(v){this._procEntryField(v,"segment_duration","uint",this.version===1?64:32),this._procEntryField(v,"media_time","int",this.version===1?64:32),this._procEntryField(v,"media_rate_integer","int",16),this._procEntryField(v,"media_rate_fraction","int",16)})},g.prototype._boxProcessors.emsg=function(){this._procFullBox(),this.version==1?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},g.prototype._boxProcessors.free=g.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},g.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},g.prototype._boxProcessors.ftyp=g.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var v=-1;this._parsing&&(v=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",v,"string",4)},g.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},g.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},g.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),!this._parsing&&typeof this.language=="string"&&(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode((this.language>>10&31)+96,(this.language>>5&31)+96,(this.language&31)+96)),this._procField("pre_defined","uint",16)},g.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",this.version==1?64:32)},g.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},g.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},g.prototype._boxProcessors.mp4a=g.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},g.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},g.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},g.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},g.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),this.flags&1&&this._procField("scheme_uri","string",-1)},g.prototype._boxProcessors.sdtp=function(){this._procFullBox();var v=-1;this._parsing&&(v=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",v,"uint",8)},g.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",this.version==1?64:32),this._procField("first_offset","uint",this.version==1?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(v){this._parsing||(v.reference=(v.reference_type&1)<<31,v.reference|=v.referenced_size&2147483647,v.sap=(v.starts_with_SAP&1)<<31,v.sap|=(v.SAP_type&3)<<28,v.sap|=v.SAP_delta_time&268435455),this._procEntryField(v,"reference","uint",32),this._procEntryField(v,"subsegment_duration","uint",32),this._procEntryField(v,"sap","uint",32),this._parsing&&(v.reference_type=v.reference>>31&1,v.referenced_size=v.reference&2147483647,v.starts_with_SAP=v.sap>>31&1,v.SAP_type=v.sap>>28&7,v.SAP_delta_time=v.sap&268435455)})},g.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},g.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(v){this._procEntryField(v,"ranges_count","uint",32),this._procSubEntries(v,"ranges",v.ranges_count,function(_){this._procEntryField(_,"level","uint",8),this._procEntryField(_,"range_size","uint",24)})})},g.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},g.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(v){this._procEntryField(v,"sample_delta","uint",32),this._procEntryField(v,"subsample_count","uint",16),this._procSubEntries(v,"subsamples",v.subsample_count,function(_){this._procEntryField(_,"subsample_size","uint",this.version===1?32:16),this._procEntryField(_,"subsample_priority","uint",8),this._procEntryField(_,"discardable","uint",8),this._procEntryField(_,"codec_specific_parameters","uint",32)})})},g.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},g.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",this.version==1?64:32)},g.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),this.flags&1&&this._procField("base_data_offset","uint",64),this.flags&2&&this._procField("sample_description_offset","uint",32),this.flags&8&&this._procField("default_sample_duration","uint",32),this.flags&16&&this._procField("default_sample_size","uint",32),this.flags&32&&this._procField("default_sample_flags","uint",32)},g.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(this.length_size_of_traf_num&48)<<4,this.reserved|=(this.length_size_of_trun_num&12)<<2,this.reserved|=this.length_size_of_sample_num&3),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(this.reserved&48)>>4,this.length_size_of_trun_num=(this.reserved&12)>>2,this.length_size_of_sample_num=this.reserved&3),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(v){this._procEntryField(v,"time","uint",this.version===1?64:32),this._procEntryField(v,"moof_offset","uint",this.version===1?64:32),this._procEntryField(v,"traf_number","uint",(this.length_size_of_traf_num+1)*8),this._procEntryField(v,"trun_number","uint",(this.length_size_of_trun_num+1)*8),this._procEntryField(v,"sample_number","uint",(this.length_size_of_sample_num+1)*8)})},g.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},g.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},g.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),this.flags&1&&this._procField("data_offset","int",32),this.flags&4&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(v){this.flags&256&&this._procEntryField(v,"sample_duration","uint",32),this.flags&512&&this._procEntryField(v,"sample_size","uint",32),this.flags&1024&&this._procEntryField(v,"sample_flags","uint",32),this.flags&2048&&this._procEntryField(v,"sample_composition_time_offset",this.version===1?"int":"uint",32)})},g.prototype._boxProcessors["url "]=g.prototype._boxProcessors["urn "]=function(){this._procFullBox(),this.type==="urn "&&this._procField("name","string",-1),this._procField("location","string",-1)},g.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},g.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},g.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},g.prototype._boxProcessors.vtte=function(){}},"./node_modules/es6-promise/auto.js":(h,f,d)=>{h.exports=d("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},"./node_modules/es6-promise/dist/es6-promise.js":function(h,f,d){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(m,g){h.exports=g()})(this,function(){function m(he){var Ue=typeof he;return he!==null&&(Ue==="object"||Ue==="function")}function g(he){return typeof he=="function"}var v=void 0;Array.isArray?v=Array.isArray:v=function(he){return Object.prototype.toString.call(he)==="[object Array]"};var _=v,S=0,E=void 0,T=void 0,C=function(Ue,we){k[S]=Ue,k[S+1]=we,S+=2,S===2&&(T?T(K):Y())};function R(he){T=he}function b(he){C=he}var F=typeof window<"u"?window:void 0,O=F||{},L=O.MutationObserver||O.WebKitMutationObserver,D=typeof self>"u"&&typeof process<"u"&&{}.toString.call(process)==="[object process]",x=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function B(){return function(){return process.nextTick(K)}}function M(){return typeof E<"u"?function(){E(K)}:w()}function I(){var he=0,Ue=new L(K),we=document.createTextNode("");return Ue.observe(we,{characterData:!0}),function(){we.data=he=++he%2}}function U(){var he=new MessageChannel;return he.port1.onmessage=K,function(){return he.port2.postMessage(0)}}function w(){var he=setTimeout;return function(){return he(K,1)}}var k=new Array(1e3);function K(){for(var he=0;he<S;he+=2){var Ue=k[he],we=k[he+1];Ue(we),k[he]=void 0,k[he+1]=void 0}S=0}function W(){try{var he=Function("return this")().require("vertx");return E=he.runOnLoop||he.runOnContext,M()}catch{return w()}}var Y=void 0;D?Y=B():L?Y=I():x?Y=U():F===void 0?Y=W():Y=w();function J(he,Ue){var we=this,$e=new this.constructor(ie);$e[ue]===void 0&&j($e);var it=we._state;if(it){var mt=arguments[it-1];C(function(){return pe(it,$e,mt,we._result)})}else Ae(we,$e,he,Ue);return $e}function ee(he){var Ue=this;if(he&&typeof he=="object"&&he.constructor===Ue)return he;var we=new Ue(ie);return xe(we,he),we}var ue=Math.random().toString(36).substring(2);function ie(){}var Q=void 0,se=1,ve=2;function _e(){return new TypeError("You cannot resolve a promise with itself")}function Z(){return new TypeError("A promises callback cannot return that same promise.")}function Ee(he,Ue,we,$e){try{he.call(Ue,we,$e)}catch(it){return it}}function Se(he,Ue,we){C(function($e){var it=!1,mt=Ee(we,Ue,function(pt){it||(it=!0,Ue!==pt?xe($e,pt):Le($e,pt))},function(pt){it||(it=!0,De($e,pt))},"Settle: "+($e._label||" unknown promise"));!it&&mt&&(it=!0,De($e,mt))},he)}function Me(he,Ue){Ue._state===se?Le(he,Ue._result):Ue._state===ve?De(he,Ue._result):Ae(Ue,void 0,function(we){return xe(he,we)},function(we){return De(he,we)})}function de(he,Ue,we){Ue.constructor===he.constructor&&we===J&&Ue.constructor.resolve===ee?Me(he,Ue):we===void 0?Le(he,Ue):g(we)?Se(he,Ue,we):Le(he,Ue)}function xe(he,Ue){if(he===Ue)De(he,_e());else if(m(Ue)){var we=void 0;try{we=Ue.then}catch($e){De(he,$e);return}de(he,Ue,we)}else Le(he,Ue)}function Fe(he){he._onerror&&he._onerror(he._result),ge(he)}function Le(he,Ue){he._state===Q&&(he._result=Ue,he._state=se,he._subscribers.length!==0&&C(ge,he))}function De(he,Ue){he._state===Q&&(he._state=ve,he._result=Ue,C(Fe,he))}function Ae(he,Ue,we,$e){var it=he._subscribers,mt=it.length;he._onerror=null,it[mt]=Ue,it[mt+se]=we,it[mt+ve]=$e,mt===0&&he._state&&C(ge,he)}function ge(he){var Ue=he._subscribers,we=he._state;if(Ue.length!==0){for(var $e=void 0,it=void 0,mt=he._result,pt=0;pt<Ue.length;pt+=3)$e=Ue[pt],it=Ue[pt+we],$e?pe(we,$e,it,mt):it(mt);he._subscribers.length=0}}function pe(he,Ue,we,$e){var it=g(we),mt=void 0,pt=void 0,Pt=!0;if(it){try{mt=we($e)}catch(lt){Pt=!1,pt=lt}if(Ue===mt){De(Ue,Z());return}}else mt=$e;Ue._state!==Q||(it&&Pt?xe(Ue,mt):Pt===!1?De(Ue,pt):he===se?Le(Ue,mt):he===ve&&De(Ue,mt))}function Re(he,Ue){try{Ue(function($e){xe(he,$e)},function($e){De(he,$e)})}catch(we){De(he,we)}}var me=0;function V(){return me++}function j(he){he[ue]=me++,he._state=void 0,he._result=void 0,he._subscribers=[]}function $(){return new Error("Array Methods must be provided an Array")}var re=function(){function he(Ue,we){this._instanceConstructor=Ue,this.promise=new Ue(ie),this.promise[ue]||j(this.promise),_(we)?(this.length=we.length,this._remaining=we.length,this._result=new Array(this.length),this.length===0?Le(this.promise,this._result):(this.length=this.length||0,this._enumerate(we),this._remaining===0&&Le(this.promise,this._result))):De(this.promise,$())}return he.prototype._enumerate=function(we){for(var $e=0;this._state===Q&&$e<we.length;$e++)this._eachEntry(we[$e],$e)},he.prototype._eachEntry=function(we,$e){var it=this._instanceConstructor,mt=it.resolve;if(mt===ee){var pt=void 0,Pt=void 0,lt=!1;try{pt=we.then}catch(st){lt=!0,Pt=st}if(pt===J&&we._state!==Q)this._settledAt(we._state,$e,we._result);else if(typeof pt!="function")this._remaining--,this._result[$e]=we;else if(it===Ce){var Ye=new it(ie);lt?De(Ye,Pt):de(Ye,we,pt),this._willSettleAt(Ye,$e)}else this._willSettleAt(new it(function(st){return st(we)}),$e)}else this._willSettleAt(mt(we),$e)},he.prototype._settledAt=function(we,$e,it){var mt=this.promise;mt._state===Q&&(this._remaining--,we===ve?De(mt,it):this._result[$e]=it),this._remaining===0&&Le(mt,this._result)},he.prototype._willSettleAt=function(we,$e){var it=this;Ae(we,void 0,function(mt){return it._settledAt(se,$e,mt)},function(mt){return it._settledAt(ve,$e,mt)})},he}();function oe(he){return new re(this,he).promise}function X(he){var Ue=this;return _(he)?new Ue(function(we,$e){for(var it=he.length,mt=0;mt<it;mt++)Ue.resolve(he[mt]).then(we,$e)}):new Ue(function(we,$e){return $e(new TypeError("You must pass an array to race."))})}function z(he){var Ue=this,we=new Ue(ie);return De(we,he),we}function ne(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function fe(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var Ce=function(){function he(Ue){this[ue]=V(),this._result=this._state=void 0,this._subscribers=[],ie!==Ue&&(typeof Ue!="function"&&ne(),this instanceof he?Re(this,Ue):fe())}return he.prototype.catch=function(we){return this.then(null,we)},he.prototype.finally=function(we){var $e=this,it=$e.constructor;return g(we)?$e.then(function(mt){return it.resolve(we()).then(function(){return mt})},function(mt){return it.resolve(we()).then(function(){throw mt})}):$e.then(we,we)},he}();Ce.prototype.then=J,Ce.all=oe,Ce.race=X,Ce.resolve=ee,Ce.reject=z,Ce._setScheduler=R,Ce._setAsap=b,Ce._asap=C;function Pe(){var he=void 0;if(typeof d.g<"u")he=d.g;else if(typeof self<"u")he=self;else try{he=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var Ue=he.Promise;if(Ue){var we=null;try{we=Object.prototype.toString.call(Ue.resolve())}catch{}if(we==="[object Promise]"&&!Ue.cast)return}he.Promise=Ce}return Ce.polyfill=Pe,Ce.Promise=Ce,Ce})},"./node_modules/events/events.js":h=>{var f=typeof Reflect=="object"?Reflect:null,d=f&&typeof f.apply=="function"?f.apply:function(w,k,K){return Function.prototype.apply.call(w,k,K)},m;f&&typeof f.ownKeys=="function"?m=f.ownKeys:Object.getOwnPropertySymbols?m=function(w){return Object.getOwnPropertyNames(w).concat(Object.getOwnPropertySymbols(w))}:m=function(w){return Object.getOwnPropertyNames(w)};function g(U){console&&console.warn&&console.warn(U)}var v=Number.isNaN||function(w){return w!==w};function _(){_.init.call(this)}h.exports=_,h.exports.once=B,_.EventEmitter=_,_.prototype._events=void 0,_.prototype._eventsCount=0,_.prototype._maxListeners=void 0;var S=10;function E(U){if(typeof U!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof U)}Object.defineProperty(_,"defaultMaxListeners",{enumerable:!0,get:function(){return S},set:function(U){if(typeof U!="number"||U<0||v(U))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+U+".");S=U}}),_.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},_.prototype.setMaxListeners=function(w){if(typeof w!="number"||w<0||v(w))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+w+".");return this._maxListeners=w,this};function T(U){return U._maxListeners===void 0?_.defaultMaxListeners:U._maxListeners}_.prototype.getMaxListeners=function(){return T(this)},_.prototype.emit=function(w){for(var k=[],K=1;K<arguments.length;K++)k.push(arguments[K]);var W=w==="error",Y=this._events;if(Y!==void 0)W=W&&Y.error===void 0;else if(!W)return!1;if(W){var J;if(k.length>0&&(J=k[0]),J instanceof Error)throw J;var ee=new Error("Unhandled error."+(J?" ("+J.message+")":""));throw ee.context=J,ee}var ue=Y[w];if(ue===void 0)return!1;if(typeof ue=="function")d(ue,this,k);else for(var ie=ue.length,Q=L(ue,ie),K=0;K<ie;++K)d(Q[K],this,k);return!0};function C(U,w,k,K){var W,Y,J;if(E(k),Y=U._events,Y===void 0?(Y=U._events=Object.create(null),U._eventsCount=0):(Y.newListener!==void 0&&(U.emit("newListener",w,k.listener?k.listener:k),Y=U._events),J=Y[w]),J===void 0)J=Y[w]=k,++U._eventsCount;else if(typeof J=="function"?J=Y[w]=K?[k,J]:[J,k]:K?J.unshift(k):J.push(k),W=T(U),W>0&&J.length>W&&!J.warned){J.warned=!0;var ee=new Error("Possible EventEmitter memory leak detected. "+J.length+" "+String(w)+" listeners added. Use emitter.setMaxListeners() to increase limit");ee.name="MaxListenersExceededWarning",ee.emitter=U,ee.type=w,ee.count=J.length,g(ee)}return U}_.prototype.addListener=function(w,k){return C(this,w,k,!1)},_.prototype.on=_.prototype.addListener,_.prototype.prependListener=function(w,k){return C(this,w,k,!0)};function R(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function b(U,w,k){var K={fired:!1,wrapFn:void 0,target:U,type:w,listener:k},W=R.bind(K);return W.listener=k,K.wrapFn=W,W}_.prototype.once=function(w,k){return E(k),this.on(w,b(this,w,k)),this},_.prototype.prependOnceListener=function(w,k){return E(k),this.prependListener(w,b(this,w,k)),this},_.prototype.removeListener=function(w,k){var K,W,Y,J,ee;if(E(k),W=this._events,W===void 0)return this;if(K=W[w],K===void 0)return this;if(K===k||K.listener===k)--this._eventsCount===0?this._events=Object.create(null):(delete W[w],W.removeListener&&this.emit("removeListener",w,K.listener||k));else if(typeof K!="function"){for(Y=-1,J=K.length-1;J>=0;J--)if(K[J]===k||K[J].listener===k){ee=K[J].listener,Y=J;break}if(Y<0)return this;Y===0?K.shift():D(K,Y),K.length===1&&(W[w]=K[0]),W.removeListener!==void 0&&this.emit("removeListener",w,ee||k)}return this},_.prototype.off=_.prototype.removeListener,_.prototype.removeAllListeners=function(w){var k,K,W;if(K=this._events,K===void 0)return this;if(K.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):K[w]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete K[w]),this;if(arguments.length===0){var Y=Object.keys(K),J;for(W=0;W<Y.length;++W)J=Y[W],J!=="removeListener"&&this.removeAllListeners(J);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(k=K[w],typeof k=="function")this.removeListener(w,k);else if(k!==void 0)for(W=k.length-1;W>=0;W--)this.removeListener(w,k[W]);return this};function F(U,w,k){var K=U._events;if(K===void 0)return[];var W=K[w];return W===void 0?[]:typeof W=="function"?k?[W.listener||W]:[W]:k?x(W):L(W,W.length)}_.prototype.listeners=function(w){return F(this,w,!0)},_.prototype.rawListeners=function(w){return F(this,w,!1)},_.listenerCount=function(U,w){return typeof U.listenerCount=="function"?U.listenerCount(w):O.call(U,w)},_.prototype.listenerCount=O;function O(U){var w=this._events;if(w!==void 0){var k=w[U];if(typeof k=="function")return 1;if(k!==void 0)return k.length}return 0}_.prototype.eventNames=function(){return this._eventsCount>0?m(this._events):[]};function L(U,w){for(var k=new Array(w),K=0;K<w;++K)k[K]=U[K];return k}function D(U,w){for(;w+1<U.length;w++)U[w]=U[w+1];U.pop()}function x(U){for(var w=new Array(U.length),k=0;k<w.length;++k)w[k]=U[k].listener||U[k];return w}function B(U,w){return new Promise(function(k,K){function W(J){U.removeListener(w,Y),K(J)}function Y(){typeof U.removeListener=="function"&&U.removeListener("error",W),k([].slice.call(arguments))}I(U,w,Y,{once:!0}),w!=="error"&&M(U,W,{once:!0})})}function M(U,w,k){typeof U.on=="function"&&I(U,"error",w,k)}function I(U,w,k,K){if(typeof U.on=="function")K.once?U.once(w,k):U.on(w,k);else if(typeof U.addEventListener=="function")U.addEventListener(w,function W(Y){K.once&&U.removeEventListener(w,W),k(Y)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof U)}},"./node_modules/fast-deep-equal/index.js":h=>{var f=Array.isArray,d=Object.keys,m=Object.prototype.hasOwnProperty;h.exports=function g(v,_){if(v===_)return!0;if(v&&_&&typeof v=="object"&&typeof _=="object"){var S=f(v),E=f(_),T,C,R;if(S&&E){if(C=v.length,C!=_.length)return!1;for(T=C;T--!==0;)if(!g(v[T],_[T]))return!1;return!0}if(S!=E)return!1;var b=v instanceof Date,F=_ instanceof Date;if(b!=F)return!1;if(b&&F)return v.getTime()==_.getTime();var O=v instanceof RegExp,L=_ instanceof RegExp;if(O!=L)return!1;if(O&&L)return v.toString()==_.toString();var D=d(v);if(C=D.length,C!==d(_).length)return!1;for(T=C;T--!==0;)if(!m.call(_,D[T]))return!1;for(T=C;T--!==0;)if(R=D[T],!g(v[R],_[R]))return!1;return!0}return v!==v&&_!==_}},"./node_modules/imsc/src/main/js/doc.js":(h,f,d)=>{(function(m,g,v,_,S){m.fromXML=function(V,j,$){var re=g.parser(!0,{xmlns:!0}),oe=[],X=[],z=[],ne=0,fe=null;re.onclosetag=function(we){if(oe[0]instanceof b)for(var $e in oe[0].styles)Le(oe[0],oe[0].styles[$e],j);else if(oe[0]instanceof K||oe[0]instanceof W){if(oe[0].contents.length>1){var it=[oe[0].contents[0]],mt;for(mt=1;mt<oe[0].contents.length;mt++)oe[0].contents[mt]instanceof Y&&it[it.length-1]instanceof Y?it[it.length-1].text+=oe[0].contents[mt].text:it.push(oe[0].contents[mt]);oe[0].contents=it}oe[0]instanceof W&&oe[0].contents.length===1&&oe[0].contents[0]instanceof Y&&(oe[0].text=oe[0].contents[0].text,delete oe[0].contents)}else oe[0]instanceof T&&(oe[0].node.uri===v.ns_tt&&oe[0].node.local==="metadata"?ne--:ne>0&&$&&"onCloseTag"in $&&$.onCloseTag());z.shift(),X.shift(),oe.shift()},re.ontext=function(we){if(oe[0]!==void 0)if(oe[0]instanceof W||oe[0]instanceof K){var $e=new Y;$e.initFromText(fe,oe[0],we,z[0],j),oe[0].contents.push($e)}else oe[0]instanceof T&&ne>0&&$&&"onText"in $&&$.onText(we)},re.onopentag=function(we){var $e=we.attributes["xml:space"];$e?z.unshift($e.value):z.length===0?z.unshift("default"):z.unshift(z[0]);var it=we.attributes["xml:lang"];if(it?X.unshift(it.value):X.length===0?X.unshift(""):X.unshift(X[0]),we.uri===v.ns_tt)if(we.local==="tt")fe!==null&&Re(j,"Two <tt> elements at ("+this.line+","+this.column+")"),fe=new C,fe.initFromNode(we,j),oe.unshift(fe);else if(we.local==="head")oe[0]instanceof C||Re(j,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),fe.head!==null&&Re("Second <head> element at ("+this.line+","+this.column+")"),fe.head=new R,oe.unshift(fe.head);else if(we.local==="styling")oe[0]instanceof R||Re(j,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),fe.head.styling!==null&&Re("Second <styling> element at ("+this.line+","+this.column+")"),fe.head.styling=new b,oe.unshift(fe.head.styling);else if(we.local==="style"){var mt;oe[0]instanceof b?(mt=new F,mt.initFromNode(we,j),mt.id?fe.head.styling.styles[mt.id]=mt:pe(j,"<style> element missing @id attribute"),oe.unshift(mt)):oe[0]instanceof ee?(mt=new F,mt.initFromNode(we,j),Ae(mt.styleAttrs,oe[0].styleAttrs),oe.unshift(mt)):Re(j,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if(we.local==="layout")oe[0]instanceof R||Re(j,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),fe.head.layout!==null&&Re(j,"Second <layout> element at "+this.line+","+this.column+")"),fe.head.layout=new O,oe.unshift(fe.head.layout);else if(we.local==="region"){oe[0]instanceof O||Re(j,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var pt=new ee;pt.initFromNode(fe,we,j),!pt.id||pt.id in fe.head.layout.regions?pe(j,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):fe.head.layout.regions[pt.id]=pt,oe.unshift(pt)}else if(we.local==="body"){oe[0]instanceof C||Re(j,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),fe.body!==null&&Re(j,"Second <body> element at "+this.line+","+this.column+")");var Pt=new w;Pt.initFromNode(fe,we,j),fe.body=Pt,oe.unshift(Pt)}else if(we.local==="div"){oe[0]instanceof k||oe[0]instanceof w||Re(j,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var lt=new k;lt.initFromNode(fe,oe[0],we,j),oe[0].contents.push(lt),oe.unshift(lt)}else if(we.local==="p"){oe[0]instanceof k||Re(j,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var Ye=new K;Ye.initFromNode(fe,oe[0],we,j),oe[0].contents.push(Ye),oe.unshift(Ye)}else if(we.local==="span"){oe[0]instanceof W||oe[0]instanceof K||Re(j,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var st=new W;st.initFromNode(fe,oe[0],we,z[0],j),oe[0].contents.push(st),oe.unshift(st)}else if(we.local==="br"){oe[0]instanceof W||oe[0]instanceof K||Re(j,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var Nt=new J;Nt.initFromNode(fe,oe[0],we,j),oe[0].contents.push(Nt),oe.unshift(Nt)}else if(we.local==="set"){oe[0]instanceof W||oe[0]instanceof K||oe[0]instanceof k||oe[0]instanceof w||oe[0]instanceof ee||oe[0]instanceof J||Re(j,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var Wt=new ue;Wt.initFromNode(fe,oe[0],we,j),oe[0].sets.push(Wt),oe.unshift(Wt)}else oe.unshift(new T(we));else oe.unshift(new T(we));if(oe[0]instanceof T){if(we.uri===v.ns_tt&&we.local==="metadata")ne++;else if(ne>0&&$&&"onOpenTag"in $){var Ht=[];for(var nt in we.attributes)Ht[we.attributes[nt].uri+" "+we.attributes[nt].local]={uri:we.attributes[nt].uri,local:we.attributes[nt].local,value:we.attributes[nt].value};$.onOpenTag(we.uri,we.local,Ht)}}},re.write(V).close(),fe.head!==null?delete fe.head.styling:fe.head=new R,fe.head.layout===null&&(fe.head.layout=new O);var Ce=!1;for(var Pe in fe.head.layout.regions){Ce=!0;break}if(!Ce){var he=ee.prototype.createDefaultRegion();fe.head.layout.regions[he.id]=he}for(var Ue in fe.head.layout.regions)E(fe,fe.head.layout.regions[Ue],null,null);return fe.body&&E(fe,fe.body,null,null),fe};function E(V,j,$,re){var oe=re&&re.timeContainer==="seq",X=0;re&&(oe&&$?X=$.end:X=re.begin),j.begin=j.explicit_begin?j.explicit_begin+X:X;var z=j.begin,ne=null;for(var fe in j.sets)E(V,j.sets[fe],ne,j),j.timeContainer==="seq"?z=j.sets[fe].end:z=Math.max(z,j.sets[fe].end),ne=j.sets[fe];if(!("contents"in j))oe?z=j.begin:z=Number.POSITIVE_INFINITY;else for(var Ce in j.contents)E(V,j.contents[Ce],ne,j),j.timeContainer==="seq"?z=j.contents[Ce].end:z=Math.max(z,j.contents[Ce].end),ne=j.contents[Ce];j.explicit_end!==null&&j.explicit_dur!==null?j.end=Math.min(j.begin+j.explicit_dur,X+j.explicit_end):j.explicit_end===null&&j.explicit_dur!==null?j.end=j.begin+j.explicit_dur:j.explicit_end!==null&&j.explicit_dur===null?j.end=X+j.explicit_end:j.end=z,delete j.explicit_begin,delete j.explicit_dur,delete j.explicit_end,V._registerEvent(j)}function T(V){this.node=V}function C(){this.events=[],this.head=null,this.body=null}C.prototype.initFromNode=function(V,j){this.cellResolution=Se(V,j);var $=Me(V,j);this.effectiveFrameRate=$.effectiveFrameRate,this.tickRate=$.tickRate,this.aspectRatio=Ee(V,j);var re=Z(V,v.ns_ttp,"timeBase");re!==null&&re!=="media"&&Re(j,"Unsupported time base");var oe=de(V,j);oe===null?this.pxDimensions={h:480,w:640}:((oe.h.unit!=="px"||oe.w.unit!=="px")&&Re(j,"Extent on TT must be in px or absent"),this.pxDimensions={h:oe.h.value,w:oe.w.value})},C.prototype._registerEvent=function(V){if(!(V.end<=V.begin)){var j=me(this.events,V.begin);if(j.found||this.events.splice(j.index,0,V.begin),V.end!==Number.POSITIVE_INFINITY){var $=me(this.events,V.end);$.found||this.events.splice($.index,0,V.end)}}},C.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},C.prototype.getMediaTimeEvents=function(){return this.events};function R(){this.styling=null,this.layout=null}function b(){this.styles={}}function F(){this.id=null,this.styleAttrs=null,this.styleRefs=null}F.prototype.initFromNode=function(V,j){this.id=ie(V),this.styleAttrs=_e(V,j),this.styleRefs=ve(V)};function O(){this.regions={}}function L(V){this.kind=V}function D(V){this.id=V}D.prototype.initFromNode=function(V,j,$,re){this.id=ie($)};function x(V){this.regionID=V}x.prototype.initFromNode=function(V,j,$,re){this.regionID=Q($)};function B(V){this.styleAttrs=V}B.prototype.initFromNode=function(V,j,$,re){this.styleAttrs=_e($,re),V.head!==null&&V.head.styling!==null&&De(V.head.styling,ve($),this.styleAttrs,re)};function M(V){this.sets=V}M.prototype.initFromNode=function(V,j,$,re){this.sets=[]};function I(V){this.contents=V}I.prototype.initFromNode=function(V,j,$,re){this.contents=[]};function U(V,j,$){this.explicit_begin=V,this.explicit_end=j,this.explicit_dur=$}U.prototype.initFromNode=function(V,j,$,re){var oe=Fe(V,j,$,re);this.explicit_begin=oe.explicit_begin,this.explicit_end=oe.explicit_end,this.explicit_dur=oe.explicit_dur,this.timeContainer=se($,re)};function w(){L.call(this,"body")}w.prototype.initFromNode=function(V,j,$){B.prototype.initFromNode.call(this,V,null,j,$),U.prototype.initFromNode.call(this,V,null,j,$),M.prototype.initFromNode.call(this,V,null,j,$),x.prototype.initFromNode.call(this,V,null,j,$),I.prototype.initFromNode.call(this,V,null,j,$)};function k(){L.call(this,"div")}k.prototype.initFromNode=function(V,j,$,re){B.prototype.initFromNode.call(this,V,j,$,re),U.prototype.initFromNode.call(this,V,j,$,re),M.prototype.initFromNode.call(this,V,j,$,re),x.prototype.initFromNode.call(this,V,j,$,re),I.prototype.initFromNode.call(this,V,j,$,re)};function K(){L.call(this,"p")}K.prototype.initFromNode=function(V,j,$,re){B.prototype.initFromNode.call(this,V,j,$,re),U.prototype.initFromNode.call(this,V,j,$,re),M.prototype.initFromNode.call(this,V,j,$,re),x.prototype.initFromNode.call(this,V,j,$,re),I.prototype.initFromNode.call(this,V,j,$,re)};function W(){L.call(this,"span")}W.prototype.initFromNode=function(V,j,$,re,oe){B.prototype.initFromNode.call(this,V,j,$,oe),U.prototype.initFromNode.call(this,V,j,$,oe),M.prototype.initFromNode.call(this,V,j,$,oe),x.prototype.initFromNode.call(this,V,j,$,oe),I.prototype.initFromNode.call(this,V,j,$,oe),this.space=re};function Y(){L.call(this,"span")}Y.prototype.initFromText=function(V,j,$,re,oe){U.prototype.initFromNode.call(this,V,j,null,oe),this.text=$,this.space=re};function J(){L.call(this,"br")}J.prototype.initFromNode=function(V,j,$,re){x.prototype.initFromNode.call(this,V,j,$,re),U.prototype.initFromNode.call(this,V,j,$,re)};function ee(){}ee.prototype.createDefaultRegion=function(){var V=new ee;return D.call(V,""),B.call(V,{}),M.call(V,[]),U.call(V,0,Number.POSITIVE_INFINITY,null),V},ee.prototype.initFromNode=function(V,j,$){D.prototype.initFromNode.call(this,V,null,j,$),B.prototype.initFromNode.call(this,V,null,j,$),U.prototype.initFromNode.call(this,V,null,j,$),M.prototype.initFromNode.call(this,V,null,j,$),V.head!==null&&V.head.styling!==null&&De(V.head.styling,ve(j),this.styleAttrs,$)};function ue(){}ue.prototype.initFromNode=function(V,j,$,re){U.prototype.initFromNode.call(this,V,j,$,re);var oe=_e($,re);this.qname=null,this.value=null;for(var X in oe){if(this.qname){pe(re,"More than one style specified on set");break}this.qname=X,this.value=oe[X]}};function ie(V){return V&&"xml:id"in V.attributes&&V.attributes["xml:id"].value||null}function Q(V){return V&&"region"in V.attributes?V.attributes.region.value:""}function se(V,j){var $=V&&"timeContainer"in V.attributes?V.attributes.timeContainer.value:null;return!$||$==="par"?"par":$==="seq"?"seq":(pe(j,"Illegal value of timeContainer (assuming 'par')"),"par")}function ve(V){return V&&"style"in V.attributes?V.attributes.style.value.split(" "):[]}function _e(V,j){var $={};if(V!==null)for(var re in V.attributes){var oe=V.attributes[re].uri+" "+V.attributes[re].local,X=_.byQName[oe];if(X!==void 0){var z=X.parse(V.attributes[re].value);z!==null?($[oe]=z,X===_.byName.zIndex&&ge(j,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):pe(j,"Cannot parse styling attribute "+oe+" --> "+V.attributes[re].value)}}return $}function Z(V,j,$){for(var re in V.attributes)if(V.attributes[re].uri===j&&V.attributes[re].local===$)return V.attributes[re].value;return null}function Ee(V,j){var $=Z(V,v.ns_ittp,"aspectRatio"),re=null;if($!==null){var oe=/(\d+) (\d+)/,X=oe.exec($);if(X!==null){var z=parseInt(X[1]),ne=parseInt(X[2]);z!==0&&ne!==0?re=z/ne:pe(j,"Illegal aspectRatio values (ignoring)")}else pe(j,"Malformed aspectRatio attribute (ignoring)")}return re}function Se(V,j){var $=Z(V,v.ns_ttp,"cellResolution"),re=15,oe=32;if($!==null){var X=/(\d+) (\d+)/,z=X.exec($);z!==null?(oe=parseInt(z[1]),re=parseInt(z[2])):ge(j,"Malformed cellResolution value (using initial value instead)")}return{w:oe,h:re}}function Me(V,j){var $=Z(V,v.ns_ttp,"frameRate"),re=30,oe;if($!==null){var X=/(\d+)/;oe=X.exec($),oe!==null?re=parseInt(oe[1]):ge(j,"Malformed frame rate attribute (using initial value instead)")}var z=Z(V,v.ns_ttp,"frameRateMultiplier"),ne=1;if(z!==null){var fe=/(\d+) (\d+)/;oe=fe.exec(z),oe!==null?ne=parseInt(oe[1])/parseInt(oe[2]):ge(j,"Malformed frame rate multiplier attribute (using initial value instead)")}var Ce=ne*re,Pe=1,he=Z(V,v.ns_ttp,"tickRate");if(he===null)$!==null&&(Pe=Ce);else{var Ue=/(\d+)/;oe=Ue.exec(he),oe!==null?Pe=parseInt(oe[1]):ge(j,"Malformed tick rate attribute (using initial value instead)")}return{effectiveFrameRate:Ce,tickRate:Pe}}function de(V,j){var $=Z(V,v.ns_tts,"extent");if($===null)return null;var re=$.split(" ");if(re.length!==2)return ge(j,"Malformed extent (ignoring)"),null;var oe=S.parseLength(re[0]),X=S.parseLength(re[1]);return!X||!oe?(ge(j,"Malformed extent values (ignoring)"),null):{h:X,w:oe}}function xe(V,j,$){var re=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/,oe=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/,X=/^(\d+(?:\.\d+)?)f$/,z=/^(\d+(?:\.\d+)?)t$/,ne=/^(\d+(?:\.\d+)?)ms$/,fe=/^(\d+(?:\.\d+)?)s$/,Ce=/^(\d+(?:\.\d+)?)h$/,Pe=/^(\d+(?:\.\d+)?)m$/,he,Ue=null;return(he=X.exec($))!==null?j!==null&&(Ue=parseFloat(he[1])/j):(he=z.exec($))!==null?V!==null&&(Ue=parseFloat(he[1])/V):(he=ne.exec($))!==null?Ue=parseFloat(he[1])/1e3:(he=fe.exec($))!==null?Ue=parseFloat(he[1]):(he=Ce.exec($))!==null?Ue=parseFloat(he[1])*3600:(he=Pe.exec($))!==null?Ue=parseFloat(he[1])*60:(he=re.exec($))!==null?Ue=parseInt(he[1])*3600+parseInt(he[2])*60+parseFloat(he[3]):(he=oe.exec($))!==null&&j!==null&&(Ue=parseInt(he[1])*3600+parseInt(he[2])*60+parseInt(he[3])+(he[4]===null?0:parseInt(he[4])/j)),Ue}function Fe(V,j,$,re){var oe=null;$&&"begin"in $.attributes&&(oe=xe(V.tickRate,V.effectiveFrameRate,$.attributes.begin.value),oe===null&&ge(re,"Malformed begin value "+$.attributes.begin.value+" (using 0)"));var X=null;$&&"dur"in $.attributes&&(X=xe(V.tickRate,V.effectiveFrameRate,$.attributes.dur.value),X===null&&ge(re,"Malformed dur value "+$.attributes.dur.value+" (ignoring)"));var z=null;return $&&"end"in $.attributes&&(z=xe(V.tickRate,V.effectiveFrameRate,$.attributes.end.value),z===null&&ge(re,"Malformed end value (ignoring)")),{explicit_begin:oe,explicit_end:z,explicit_dur:X}}function Le(V,j,$){for(;j.styleRefs.length>0;){var re=j.styleRefs.pop();if(!(re in V.styles)){pe($,"Non-existant style id referenced");continue}Le(V,V.styles[re],$),Ae(V.styles[re].styleAttrs,j.styleAttrs)}}function De(V,j,$,re){for(var oe=j.length-1;oe>=0;oe--){var X=j[oe];if(!(X in V.styles)){pe(re,"Non-existant style id referenced");continue}Ae(V.styles[X].styleAttrs,$)}}function Ae(V,j){for(var $ in V)$ in j||(j[$]=V[$])}function ge(V,j){if(V&&V.warn&&V.warn(j))throw j}function pe(V,j){if(V&&V.error&&V.error(j))throw j}function Re(V,j){throw V&&V.fatal&&V.fatal(j),j}function me(V,j){for(var $=0,re=V.length-1,oe;$<=re;){oe=Math.floor(($+re)/2);var X=V[oe];if(X<j)$=oe+1;else if(X>j)re=oe-1;else return{found:!0,index:oe}}return{found:!1,index:$}}})(f,typeof sax>"u"?d("./node_modules/sax/lib/sax.js"):sax,typeof imscNames>"u"?d("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscStyles>"u"?d("./node_modules/imsc/src/main/js/styles.js"):imscStyles,typeof imscUtils>"u"?d("./node_modules/imsc/src/main/js/utils.js"):imscUtils)},"./node_modules/imsc/src/main/js/html.js":(h,f,d)=>{(function(m,g,v){m.render=function(M,I,U,w,k,K,W,Y,J){var ee=w||I.clientHeight,ue=k||I.clientWidth;if(M.aspectRatio!==null){var ie=ee*M.aspectRatio;ie>ue?ee=Math.round(ue/M.aspectRatio):ue=ie}var Q=document.createElement("div");Q.style.position="relative",Q.style.width=ue+"px",Q.style.height=ee+"px",Q.style.margin="auto",Q.style.top=0,Q.style.bottom=0,Q.style.left=0,Q.style.right=0,Q.style.zIndex=0;var se={h:ee,w:ue,regionH:null,regionW:null,imgResolver:U,displayForcedOnlyMode:K||!1,isd:M,errorHandler:W,previousISDState:Y,enableRollUp:J||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null};I.appendChild(Q);for(var ve in M.contents)_(se,Q,M.contents[ve]);return se.currentISDState};function _(M,I,U){var w;if(U.kind==="region"?(w=document.createElement("div"),w.style.position="absolute"):U.kind==="body"||U.kind==="div"?w=document.createElement("div"):U.kind==="p"?w=document.createElement("p"):U.kind==="span"?w=document.createElement("span"):U.kind==="br"&&(w=document.createElement("br")),!w){B(M.errorHandler,"Error processing ISD element kind: "+U.kind);return}w.style.margin="0";for(var k in L){var K=L[k],W=U.styleAttrs[K.qname];W!==void 0&&K.map!==null&&K.map(M,w,U,W)}var Y=w;if(U.kind==="region"){var J=U.styleAttrs[v.byName.writingMode.qname];J==="lrtb"||J==="lr"?(M.ipd="lr",M.bpd="tb"):J==="rltb"||J==="rl"?(M.ipd="rl",M.bpd="tb"):J==="tblr"?(M.ipd="tb",M.bpd="lr"):(J==="tbrl"||J==="tb")&&(M.ipd="tb",M.bpd="rl")}var ee=U.styleAttrs[v.byName.linePadding.qname];if(ee&&ee>0){var ue=Math.ceil(ee*M.h)+"px";M.bpd==="tb"?(Y.style.paddingLeft=ue,Y.style.paddingRight=ue):(Y.style.paddingTop=ue,Y.style.paddingBottom=ue),M.lp=ee}var ie=U.styleAttrs[v.byName.multiRowAlign.qname];if(ie&&ie!=="auto"){var Q=document.createElement("span");Q.style.display="inline-block",Q.style.textAlign=ie,w.appendChild(Q),Y=Q,M.mra=ie}if(U.styleAttrs[v.byName.fillLineGap.qname]&&(M.flg=!0),U.kind==="span"&&U.text)if(M.lp||M.mra||M.flg)for(var se="",ve=0;ve<U.text.length;ve++){se+=U.text.charAt(ve);var _e=U.text.charCodeAt(ve);if(_e<55296||_e>56319||ve===U.text.length){var Z=document.createElement("span");Z.textContent=se,w.appendChild(Z),se=""}}else w.textContent=U.text;I.appendChild(w);for(var Ee in U.contents)_(M,Y,U.contents[Ee]);var Se=[];if((M.lp||M.mra||M.flg)&&U.kind==="p"&&(b(M,Y,Se,null),M.mra&&(E(Se),M.mra=null),M.lp&&(S(Se,M.lp*M.h,M),M.lp=null),M.flg)){var Me=R(Y.getBoundingClientRect(),M);T(Se,Me.before,Me.after,M),M.flg=null}if(U.kind==="region"&&(b(M,Y,Se),M.bpd==="tb"&&M.enableRollUp&&U.contents.length>0&&U.styleAttrs[v.byName.displayAlign.qname]==="after")){var de=U.id===""?"_":U.id,xe=new C(de,Se);if(M.currentISDState[xe.id]=xe,M.previousISDState&&xe.id in M.previousISDState&&M.previousISDState[xe.id].plist.length>0&&xe.plist.length>1&&xe.plist[xe.plist.length-2].text===M.previousISDState[xe.id].plist[M.previousISDState[xe.id].plist.length-1].text){var Fe=w.firstElementChild,Le=xe.plist[xe.plist.length-1].after-xe.plist[xe.plist.length-1].before;Fe.style.bottom="-"+Le+"px",Fe.style.transition="transform 0.4s",Fe.style.position="relative",Fe.style.transform="translateY(-"+Le+"px)"}}}function S(M,I,U){for(var w in M){var k=M[w].elements.length,K=M[w].elements[M[w].start_elem],W=M[w].elements[M[w].end_elem],Y=Math.ceil(I)+"px",J="-"+Math.ceil(I)+"px";k!==0&&(U.ipd==="lr"?(K.node.style.borderLeftColor=K.bgcolor||"#00000000",K.node.style.borderLeftStyle="solid",K.node.style.borderLeftWidth=Y,K.node.style.marginLeft=J):U.ipd==="rl"?(K.node.style.borderRightColor=K.bgcolor||"#00000000",K.node.style.borderRightStyle="solid",K.node.style.borderRightWidth=Y,K.node.style.marginRight=J):U.ipd==="tb"&&(K.node.style.borderTopColor=K.bgcolor||"#00000000",K.node.style.borderTopStyle="solid",K.node.style.borderTopWidth=Y,K.node.style.marginTop=J),U.ipd==="lr"?(W.node.style.borderRightColor=W.bgcolor||"#00000000",W.node.style.borderRightStyle="solid",W.node.style.borderRightWidth=Y,W.node.style.marginRight=J):U.ipd==="rl"?(W.node.style.borderLeftColor=W.bgcolor||"#00000000",W.node.style.borderLeftStyle="solid",W.node.style.borderLeftWidth=Y,W.node.style.marginLeft=J):U.ipd==="tb"&&(W.node.style.borderBottomColor=W.bgcolor||"#00000000",W.node.style.borderBottomStyle="solid",W.node.style.borderBottomWidth=Y,W.node.style.marginBottom=J))}}function E(M){for(var I=0;I<M.length-1;I++){var U=M[I].elements.length;if(U!==0&&M[I].br===!1){var w=document.createElement("br"),k=M[I].elements[U-1].node;k.parentElement.insertBefore(w,k.nextSibling)}}}function T(M,I,U,w){for(var k=Math.sign(U-I),K=0;K<=M.length;K++){var W;K===0?W=I:K===M.length?W=U:W=(M[K].before+M[K-1].after)/2;var Y,J;if(K>0)for(var ee=0;ee<M[K-1].elements.length;ee++)M[K-1].elements[ee].bgcolor!==null&&(J=M[K-1].elements[ee],k*(J.after-W)<0&&(Y=Math.ceil(Math.abs(W-J.after))+"px",J.node.style.backgroundColor=J.bgcolor,w.bpd==="lr"?J.node.style.paddingRight=Y:w.bpd==="rl"?J.node.style.paddingLeft=Y:w.bpd==="tb"&&(J.node.style.paddingBottom=Y)));if(K<M.length)for(var ue=0;ue<M[K].elements.length;ue++)J=M[K].elements[ue],J.bgcolor!==null&&k*(J.before-W)>0&&(Y=Math.ceil(Math.abs(J.before-W))+"px",J.node.style.backgroundColor=J.bgcolor,w.bpd==="lr"?J.node.style.paddingLeft=Y:w.bpd==="rl"?J.node.style.paddingRight=Y:w.bpd==="tb"&&(J.node.style.paddingTop=Y))}}function C(M,I){this.id=M,this.plist=I}function R(M,I){var U={before:null,after:null,start:null,end:null};return I.bpd==="tb"?(U.before=M.top,U.after=M.bottom,I.ipd==="lr"?(U.start=M.left,U.end=M.right):(U.start=M.right,U.end=M.left)):I.bpd==="lr"?(U.before=M.left,U.after=M.right,U.start=M.top,U.end=M.bottom):I.bpd==="rl"&&(U.before=M.right,U.after=M.left,U.start=M.top,U.end=M.bottom),U}function b(M,I,U,w){var k=I.style.backgroundColor||w;if(I.childElementCount===0)if(I.localName==="span"){var K=I.getBoundingClientRect();if(K.height===0||K.width===0)return;var W=R(K,M);if(U.length===0||!F(W.before,W.after,U[U.length-1].before,U[U.length-1].after))U.push({before:W.before,after:W.after,start:W.start,end:W.end,start_elem:0,end_elem:0,elements:[],text:"",br:!1});else{var Y=Math.sign(W.after-W.before),J=Math.sign(W.end-W.start);Y*(W.before-U[U.length-1].before)<0&&(U[U.length-1].before=W.before),Y*(W.after-U[U.length-1].after)>0&&(U[U.length-1].after=W.after),J*(W.start-U[U.length-1].start)<0&&(U[U.length-1].start=W.start,U[U.length-1].start_elem=U[U.length-1].elements.length),J*(W.end-U[U.length-1].end)>0&&(U[U.length-1].end=W.end,U[U.length-1].end_elem=U[U.length-1].elements.length)}U[U.length-1].text+=I.textContent,U[U.length-1].elements.push({node:I,bgcolor:k,before:W.before,after:W.after})}else I.localName==="br"&&U.length!==0&&(U[U.length-1].br=!0);else for(var ee=I.firstChild;ee;)ee.nodeType===Node.ELEMENT_NODE&&b(M,ee,U,k),ee=ee.nextSibling}function F(M,I,U,w){return I<w&&M>U||w<=I&&U>=M}function O(M,I){this.qname=M,this.map=I}var L=[new O("http://www.w3.org/ns/ttml#styling backgroundColor",function(M,I,U,w){w[3]!==0&&(I.style.backgroundColor="rgba("+w[0].toString()+","+w[1].toString()+","+w[2].toString()+","+(w[3]/255).toString()+")")}),new O("http://www.w3.org/ns/ttml#styling color",function(M,I,U,w){I.style.color="rgba("+w[0].toString()+","+w[1].toString()+","+w[2].toString()+","+(w[3]/255).toString()+")"}),new O("http://www.w3.org/ns/ttml#styling direction",function(M,I,U,w){I.style.direction=w}),new O("http://www.w3.org/ns/ttml#styling display",function(M,I,U,w){}),new O("http://www.w3.org/ns/ttml#styling displayAlign",function(M,I,U,w){I.style.display="flex",I.style.flexDirection="column",w==="before"?I.style.justifyContent="flex-start":w==="center"?I.style.justifyContent="center":w==="after"&&(I.style.justifyContent="flex-end")}),new O("http://www.w3.org/ns/ttml#styling extent",function(M,I,U,w){M.regionH=w.h*M.h,M.regionW=w.w*M.w;var k=0,K=0,W=U.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];W&&(k=(W[0]+W[2])*M.h,K=(W[1]+W[3])*M.w),I.style.height=M.regionH-k+"px",I.style.width=M.regionW-K+"px"}),new O("http://www.w3.org/ns/ttml#styling fontFamily",function(M,I,U,w){var k=[];for(var K in w)w[K]==="monospaceSerif"?(k.push("Courier New"),k.push('"Liberation Mono"'),k.push("Courier"),k.push("monospace")):w[K]==="proportionalSansSerif"?(k.push("Arial"),k.push("Helvetica"),k.push('"Liberation Sans"'),k.push("sans-serif")):w[K]==="monospace"?k.push("monospace"):w[K]==="sansSerif"?k.push("sans-serif"):w[K]==="serif"?k.push("serif"):w[K]==="monospaceSansSerif"?(k.push("Consolas"),k.push("monospace")):w[K]==="proportionalSerif"?k.push("serif"):k.push(w[K]);I.style.fontFamily=k.join(",")}),new O("http://www.w3.org/ns/ttml#styling fontSize",function(M,I,U,w){I.style.fontSize=w*M.h+"px"}),new O("http://www.w3.org/ns/ttml#styling fontStyle",function(M,I,U,w){I.style.fontStyle=w}),new O("http://www.w3.org/ns/ttml#styling fontWeight",function(M,I,U,w){I.style.fontWeight=w}),new O("http://www.w3.org/ns/ttml#styling lineHeight",function(M,I,U,w){w==="normal"?I.style.lineHeight="normal":I.style.lineHeight=w*M.h+"px"}),new O("http://www.w3.org/ns/ttml#styling opacity",function(M,I,U,w){I.style.opacity=w}),new O("http://www.w3.org/ns/ttml#styling origin",function(M,I,U,w){I.style.top=w.h*M.h+"px",I.style.left=w.w*M.w+"px"}),new O("http://www.w3.org/ns/ttml#styling overflow",function(M,I,U,w){I.style.overflow=w}),new O("http://www.w3.org/ns/ttml#styling padding",function(M,I,U,w){var k=[];k[0]=w[0]*M.h+"px",k[1]=w[3]*M.w+"px",k[2]=w[2]*M.h+"px",k[3]=w[1]*M.w+"px",I.style.padding=k.join(" ")}),new O("http://www.w3.org/ns/ttml#styling showBackground",null),new O("http://www.w3.org/ns/ttml#styling textAlign",function(M,I,U,w){var k,K=U.styleAttrs[v.byName.direction.qname];w==="start"?k=K==="rtl"?"right":"left":w==="end"?k=K==="rtl"?"left":"right":k=w,I.style.textAlign=k}),new O("http://www.w3.org/ns/ttml#styling textDecoration",function(M,I,U,w){I.style.textDecoration=w.join(" ").replace("lineThrough","line-through")}),new O("http://www.w3.org/ns/ttml#styling textOutline",function(M,I,U,w){w==="none"?I.style.textShadow="":I.style.textShadow="rgba("+w.color[0].toString()+","+w.color[1].toString()+","+w.color[2].toString()+","+(w.color[3]/255).toString()+") 0px 0px "+w.thickness*M.h+"px"}),new O("http://www.w3.org/ns/ttml#styling unicodeBidi",function(M,I,U,w){var k;w==="bidiOverride"?k="bidi-override":k=w,I.style.unicodeBidi=k}),new O("http://www.w3.org/ns/ttml#styling visibility",function(M,I,U,w){I.style.visibility=w}),new O("http://www.w3.org/ns/ttml#styling wrapOption",function(M,I,U,w){w==="wrap"?U.space==="preserve"?I.style.whiteSpace="pre-wrap":I.style.whiteSpace="normal":U.space==="preserve"?I.style.whiteSpace="pre":I.style.whiteSpace="noWrap"}),new O("http://www.w3.org/ns/ttml#styling writingMode",function(M,I,U,w){w==="lrtb"||w==="lr"||w==="rltb"||w==="rl"?I.style.writingMode="horizontal-tb":w==="tblr"?I.style.writingMode="vertical-lr":(w==="tbrl"||w==="tb")&&(I.style.writingMode="vertical-rl")}),new O("http://www.w3.org/ns/ttml#styling zIndex",function(M,I,U,w){I.style.zIndex=w}),new O("http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt backgroundImage",function(M,I,U,w){if(M.imgResolver!==null&&w!==null){var k=document.createElement("img"),K=M.imgResolver(w,k);K&&(k.src=K),k.height=M.regionH,k.width=M.regionW,I.appendChild(k)}}),new O("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(M,I,U,w){M.displayForcedOnlyMode&&w===!1&&(I.style.visibility="hidden")})],D={};for(var x in L)D[L[x].qname]=L[x];function B(M,I){if(M&&M.error&&M.error(I))throw I}})(f,typeof imscNames>"u"?d("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscStyles>"u"?d("./node_modules/imsc/src/main/js/styles.js"):imscStyles)},"./node_modules/imsc/src/main/js/isd.js":(h,f,d)=>{(function(m,g,v){m.generateISD=function(b,F,O){var L=new T(b),D={};for(var x in b.head.layout.regions){var B=_(b,F,b.head.layout.regions[x],b.body,null,"",b.head.layout.regions[x],O,D);B!==null&&L.contents.push(B.element)}return L};function _(b,F,O,L,D,x,B,M,I){if(F<B.begin||F>=B.end)return null;var U="regionID"in B&&B.regionID!==""?B.regionID:x;if(D!==null&&U!==O.id&&(!("contents"in B)||"contents"in B&&B.contents.length===0||U!==""))return null;var w=new C(B);for(var k in B.sets)F<B.sets[k].begin||F>=B.sets[k].end||(w.styleAttrs[B.sets[k].qname]=B.sets[k].value);var K={};for(var W in w.styleAttrs)if(K[W]=!0,W===v.byName.writingMode.qname&&!(v.byName.direction.qname in w.styleAttrs)){var Y=w.styleAttrs[W];Y==="lrtb"||Y==="lr"?w.styleAttrs[v.byName.direction.qname]="ltr":(Y==="rltb"||Y==="rl")&&(w.styleAttrs[v.byName.direction.qname]="rtl")}if(D!==null)for(var J in v.all){var ee=v.all[J];if(ee.qname===v.byName.textDecoration.qname){var ue=D.styleAttrs[ee.qname],ie=w.styleAttrs[ee.qname],Q=[];ie===void 0?Q=ue:ie.indexOf("none")===-1?((ie.indexOf("noUnderline")===-1&&ue.indexOf("underline")!==-1||ie.indexOf("underline")!==-1)&&Q.push("underline"),(ie.indexOf("noLineThrough")===-1&&ue.indexOf("lineThrough")!==-1||ie.indexOf("lineThrough")!==-1)&&Q.push("lineThrough"),(ie.indexOf("noOverline")===-1&&ue.indexOf("overline")!==-1||ie.indexOf("overline")!==-1)&&Q.push("overline")):Q.push("none"),w.styleAttrs[ee.qname]=Q}else ee.inherit&&ee.qname in D.styleAttrs&&!(ee.qname in w.styleAttrs)&&(w.styleAttrs[ee.qname]=D.styleAttrs[ee.qname])}for(var se in v.all){var ve=v.all[se];ve.qname in w.styleAttrs||(w.kind==="region"||ve.inherit===!1&&ve.initial!==null)&&(w.styleAttrs[ve.qname]=ve.parse(ve.initial),K[ve.qname]=!0)}for(var _e in v.all){var Z=v.all[_e];if(Z.qname in K&&Z.compute!==null){var Ee=Z.compute(b,D,w,w.styleAttrs[Z.qname],I);Ee!==null?w.styleAttrs[Z.qname]=Ee:R(M,"Style '"+Z.qname+"' on element '"+w.kind+"' cannot be computed")}}if(w.styleAttrs[v.byName.display.qname]==="none")return null;var Se;D===null?L===null?Se=[]:Se=[L]:"contents"in B&&(Se=B.contents);for(var Me in Se){var de=_(b,F,O,L,w,U,Se[Me],M,I);de!==null&&w.contents.push(de.element)}for(var xe in w.styleAttrs){var Fe=v.byQName[xe];Fe.applies.indexOf(w.kind)===-1&&delete w.styleAttrs[xe]}if(w.kind==="span"&&w.text&&w.space==="default"){var Le=w.text.replace(/\s+/g," ");w.text=Le}if(w.kind==="p"){var De=[];S(w,De);for(var Ae=0,ge="after_br",pe=0;;)if(ge==="after_br")Ae>=De.length||De[Ae].kind==="br"?(ge="before_br",pe=Ae,Ae--):(De[Ae].space!=="preserve"&&(De[Ae].text=De[Ae].text.replace(/^\s+/g,"")),De[Ae].text.length>0?(ge="looking_br",Ae++):De.splice(Ae,1));else if(ge==="before_br")if(Ae<0||De[Ae].kind==="br"){if(ge="after_br",Ae=pe+1,Ae>=De.length)break}else if(De[Ae].space!=="preserve"&&(De[Ae].text=De[Ae].text.replace(/\s+$/g,"")),De[Ae].text.length>0){if(ge="after_br",Ae=pe+1,Ae>=De.length)break}else De.splice(Ae,1),Ae--;else Ae>=De.length||De[Ae].kind==="br"?(ge="before_br",pe=Ae,Ae--):Ae++;E(w)}return w.kind==="div"&&v.byName.backgroundImage.qname in w.styleAttrs||w.kind==="br"||"contents"in w&&w.contents.length>0||w.kind==="span"&&w.text!==null||w.kind==="region"&&w.styleAttrs[v.byName.showBackground.qname]==="always"?{region_id:U,element:w}:null}function S(b,F){if("contents"in b)for(var O in b.contents)S(b.contents[O],F);else F.push(b)}function E(b){if(b.kind==="br")return!1;if("text"in b)return b.text.length===0;if("contents"in b){for(var F=b.contents.length;F--;)E(b.contents[F])&&b.contents.splice(F,1);return b.contents.length===0}}function T(b){this.contents=[],this.aspectRatio=b.aspectRatio}function C(b){this.kind=b.kind||"region",b.id&&(this.id=b.id),this.styleAttrs={};for(var F in b.styleAttrs)this.styleAttrs[F]=b.styleAttrs[F];"text"in b?this.text=b.text:b.kind!=="br"&&(this.contents=[]),"space"in b&&(this.space=b.space)}function R(b,F){if(b&&b.error&&b.error(F))throw F}})(f,typeof imscNames>"u"?d("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscStyles>"u"?d("./node_modules/imsc/src/main/js/styles.js"):imscStyles)},"./node_modules/imsc/src/main/js/main.js":(h,f,d)=>{f.generateISD=d("./node_modules/imsc/src/main/js/isd.js").generateISD,f.fromXML=d("./node_modules/imsc/src/main/js/doc.js").fromXML,f.renderHTML=d("./node_modules/imsc/src/main/js/html.js").render},"./node_modules/imsc/src/main/js/names.js":(h,f)=>{(function(d){d.ns_tt="http://www.w3.org/ns/ttml",d.ns_tts="http://www.w3.org/ns/ttml#styling",d.ns_ttp="http://www.w3.org/ns/ttml#parameter",d.ns_xml="http://www.w3.org/XML/1998/namespace",d.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",d.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",d.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",d.ns_ebutts="urn:ebu:tt:style"})(f)},"./node_modules/imsc/src/main/js/styles.js":(h,f,d)=>{(function(m,g,v){function _(T,C,R,b,F,O,L,D){this.name=C,this.ns=T,this.qname=T+" "+C,this.inherit=F,this.animatable=O,this.initial=R,this.applies=b,this.parse=L,this.compute=D}m.all=[new _(g.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,v.parseColor,null),new _(g.ns_tts,"color","white",["span"],!0,!0,v.parseColor,null),new _(g.ns_tts,"direction","ltr",["p","span"],!0,!0,function(T){return T},null),new _(g.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(T){return T},null),new _(g.ns_tts,"displayAlign","before",["region"],!1,!0,function(T){return T},null),new _(g.ns_tts,"extent","auto",["tt","region"],!1,!0,function(T){if(T==="auto")return T;var C=T.split(" ");if(C.length!==2)return null;var R=v.parseLength(C[0]),b=v.parseLength(C[1]);return!b||!R?null:{h:b,w:R}},function(T,C,R,b,F){var O,L;if(b==="auto")O=1;else if(b.h.unit==="%")O=b.h.value/100;else if(b.h.unit==="px")O=b.h.value/T.pxDimensions.h;else return null;if(b==="auto")L=1;else if(b.w.unit==="%")L=b.w.value/100;else if(b.w.unit==="px")L=b.w.value/T.pxDimensions.w;else return null;return{h:O,w:L}}),new _(g.ns_tts,"fontFamily","default",["span"],!0,!0,function(T){var C=T.split(","),R=[];for(var b in C)C[b].charAt(0)!=="'"&&C[b].charAt(0)!=='"'&&C[b]==="default"?R.push("monospaceSerif"):R.push(C[b]);return R},null),new _(g.ns_tts,"fontSize","1c",["span"],!0,!0,v.parseLength,function(T,C,R,b,F){var O;if(b.unit==="%")C!==null?O=C.styleAttrs[m.byName.fontSize.qname]*b.value/100:O=b.value/100/T.cellResolution.h;else if(b.unit==="em")C!==null?O=C.styleAttrs[m.byName.fontSize.qname]*b.value:O=b.value/T.cellResolution.h;else if(b.unit==="c")O=b.value/T.cellResolution.h;else if(b.unit==="px")O=b.value/T.pxDimensions.h;else return null;return O}),new _(g.ns_tts,"fontStyle","normal",["span"],!0,!0,function(T){return T},null),new _(g.ns_tts,"fontWeight","normal",["span"],!0,!0,function(T){return T},null),new _(g.ns_tts,"lineHeight","normal",["p"],!0,!0,function(T){return T==="normal"?T:v.parseLength(T)},function(T,C,R,b,F){var O;if(b==="normal")O=b;else if(b.unit==="%")O=R.styleAttrs[m.byName.fontSize.qname]*b.value/100;else if(b.unit==="em")O=R.styleAttrs[m.byName.fontSize.qname]*b.value;else if(b.unit==="c")O=b.value/T.cellResolution.h;else if(b.unit==="px")O=b.value/T.pxDimensions.h;else return null;return O}),new _(g.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new _(g.ns_tts,"origin","auto",["region"],!1,!0,function(T){if(T==="auto")return T;var C=T.split(" ");if(C.length!==2)return null;var R=v.parseLength(C[0]),b=v.parseLength(C[1]);return!b||!R?null:{h:b,w:R}},function(T,C,R,b,F){var O,L;if(b==="auto")O=0;else if(b.h.unit==="%")O=b.h.value/100;else if(b.h.unit==="px")O=b.h.value/T.pxDimensions.h;else return null;if(b==="auto")L=0;else if(b.w.unit==="%")L=b.w.value/100;else if(b.w.unit==="px")L=b.w.value/T.pxDimensions.w;else return null;return{h:O,w:L}}),new _(g.ns_tts,"overflow","hidden",["region"],!1,!0,function(T){return T},null),new _(g.ns_tts,"padding","0px",["region"],!1,!0,function(T){var C=T.split(" ");if(C.length>4)return null;var R=[];for(var b in C){var F=v.parseLength(C[b]);if(!F)return null;R.push(F)}return R},function(T,C,R,b,F){var O;if(b.length===1)O=[b[0],b[0],b[0],b[0]];else if(b.length===2)O=[b[0],b[1],b[0],b[1]];else if(b.length===3)O=[b[0],b[1],b[2],b[1]];else if(b.length===4)O=[b[0],b[1],b[2],b[3]];else return null;var L=R.styleAttrs[m.byName.writingMode.qname];if(L==="lrtb"||L==="lr")O=[O[0],O[3],O[2],O[1]];else if(L==="rltb"||L==="rl")O=[O[0],O[1],O[2],O[3]];else if(L==="tblr")O=[O[3],O[0],O[1],O[2]];else if(L==="tbrl"||L==="tb")O=[O[3],O[2],O[1],O[0]];else return null;var D=[];for(var x in O)if(O[x].value===0)D[x]=0;else if(O[x].unit==="%")x==="0"||x==="2"?D[x]=R.styleAttrs[m.byName.extent.qname].h*O[x].value/100:D[x]=R.styleAttrs[m.byName.extent.qname].w*O[x].value/100;else if(O[x].unit==="em")D[x]=R.styleAttrs[m.byName.fontSize.qname]*O[x].value;else if(O[x].unit==="c")D[x]=O[x].value/T.cellResolution.h;else if(O[x].unit==="px")x==="0"||x==="2"?D[x]=O[x].value/T.pxDimensions.h:D[x]=O[x].value/T.pxDimensions.w;else return null;return D}),new _(g.ns_tts,"showBackground","always",["region"],!1,!0,function(T){return T},null),new _(g.ns_tts,"textAlign","start",["p"],!0,!0,function(T){return T},function(T,C,R,b,F){return b==="left"?"start":b==="right"?"end":b}),new _(g.ns_tts,"textDecoration","none",["span"],!0,!0,function(T){return T.split(" ")},null),new _(g.ns_tts,"textOutline","none",["span"],!0,!0,function(T){if(T==="none")return T;var C={},R=T.split(" ");if(R.length===0||R.length>2)return null;var b=v.parseColor(R[0]);if(C.color=b,b!==null&&R.shift(),R.length!==1)return null;var F=v.parseLength(R[0]);return F?(C.thickness=F,C):null},function(T,C,R,b,F){if(b==="none")return b;var O={};if(b.color===null?O.color=R.styleAttrs[m.byName.color.qname]:O.color=b.color,b.thickness.unit==="%")O.thickness=R.styleAttrs[m.byName.fontSize.qname]*b.thickness.value/100;else if(b.thickness.unit==="em")O.thickness=R.styleAttrs[m.byName.fontSize.qname]*b.thickness.value;else if(b.thickness.unit==="c")O.thickness=b.thickness.value/T.cellResolution.h;else if(b.thickness.unit==="px")O.thickness=b.thickness.value/T.pxDimensions.h;else return null;return O}),new _(g.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(T){return T},null),new _(g.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(T){return T},null),new _(g.ns_tts,"wrapOption","wrap",["span"],!0,!0,function(T){return T},null),new _(g.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(T){return T},null),new _(g.ns_tts,"zIndex","auto",["region"],!1,!0,function(T){var C;return T==="auto"?C=T:(C=parseInt(T),isNaN(C)&&(C=null)),C},null),new _(g.ns_ebutts,"linePadding","0c",["p"],!0,!1,v.parseLength,function(T,C,R,b,F){return b.unit==="c"?b.value/T.cellResolution.h:null}),new _(g.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(T){return T},null),new _(g.ns_smpte,"backgroundImage",null,["div"],!1,!1,function(T){return T},null),new _(g.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(T){return T==="true"},null),new _(g.ns_itts,"fillLineGap","false",["p"],!0,!0,function(T){return T==="true"},null)],m.byQName={};for(var S in m.all)m.byQName[m.all[S].qname]=m.all[S];m.byName={};for(var E in m.all)m.byName[m.all[E].name]=m.all[E]})(f,typeof imscNames>"u"?d("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscUtils>"u"?d("./node_modules/imsc/src/main/js/utils.js"):imscUtils)},"./node_modules/imsc/src/main/js/utils.js":(h,f)=>{(function(d){var m=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,g=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,v=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,_={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};d.parseColor=function(E){var T,C=null,R=_[E.toLowerCase()];return R!==void 0?C=R:(T=m.exec(E))!==null?C=[parseInt(T[1],16),parseInt(T[2],16),parseInt(T[3],16),T[4]!==void 0?parseInt(T[4],16):255]:(T=g.exec(E))!==null?C=[parseInt(T[1]),parseInt(T[2]),parseInt(T[3]),255]:(T=v.exec(E))!==null&&(C=[parseInt(T[1]),parseInt(T[2]),parseInt(T[3]),parseInt(T[4])]),C};var S=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%)$/;d.parseLength=function(E){var T,C=null;return(T=S.exec(E))!==null&&(C={value:parseFloat(T[1]),unit:T[2]}),C}})(f)},"./node_modules/is-alphabetical/index.js":h=>{h.exports=f;function f(d){var m=typeof d=="string"?d.charCodeAt(0):d;return m>=97&&m<=122||m>=65&&m<=90}},"./node_modules/is-alphanumerical/index.js":(h,f,d)=>{var m=d("./node_modules/is-alphabetical/index.js"),g=d("./node_modules/is-decimal/index.js");h.exports=v;function v(_){return m(_)||g(_)}},"./node_modules/is-decimal/index.js":h=>{h.exports=f;function f(d){var m=typeof d=="string"?d.charCodeAt(0):d;return m>=48&&m<=57}},"./node_modules/path-browserify/index.js":h=>{function f(v){if(typeof v!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(v))}function d(v,_){for(var S="",E=0,T=-1,C=0,R,b=0;b<=v.length;++b){if(b<v.length)R=v.charCodeAt(b);else{if(R===47)break;R=47}if(R===47){if(!(T===b-1||C===1))if(T!==b-1&&C===2){if(S.length<2||E!==2||S.charCodeAt(S.length-1)!==46||S.charCodeAt(S.length-2)!==46){if(S.length>2){var F=S.lastIndexOf("/");if(F!==S.length-1){F===-1?(S="",E=0):(S=S.slice(0,F),E=S.length-1-S.lastIndexOf("/")),T=b,C=0;continue}}else if(S.length===2||S.length===1){S="",E=0,T=b,C=0;continue}}_&&(S.length>0?S+="/..":S="..",E=2)}else S.length>0?S+="/"+v.slice(T+1,b):S=v.slice(T+1,b),E=b-T-1;T=b,C=0}else R===46&&C!==-1?++C:C=-1}return S}function m(v,_){var S=_.dir||_.root,E=_.base||(_.name||"")+(_.ext||"");return S?S===_.root?S+E:S+v+E:E}var g={resolve:function(){for(var _="",S=!1,E,T=arguments.length-1;T>=-1&&!S;T--){var C;T>=0?C=arguments[T]:(E===void 0&&(E=process.cwd()),C=E),f(C),C.length!==0&&(_=C+"/"+_,S=C.charCodeAt(0)===47)}return _=d(_,!S),S?_.length>0?"/"+_:"/":_.length>0?_:"."},normalize:function(_){if(f(_),_.length===0)return".";var S=_.charCodeAt(0)===47,E=_.charCodeAt(_.length-1)===47;return _=d(_,!S),_.length===0&&!S&&(_="."),_.length>0&&E&&(_+="/"),S?"/"+_:_},isAbsolute:function(_){return f(_),_.length>0&&_.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var _,S=0;S<arguments.length;++S){var E=arguments[S];f(E),E.length>0&&(_===void 0?_=E:_+="/"+E)}return _===void 0?".":g.normalize(_)},relative:function(_,S){if(f(_),f(S),_===S||(_=g.resolve(_),S=g.resolve(S),_===S))return"";for(var E=1;E<_.length&&_.charCodeAt(E)===47;++E);for(var T=_.length,C=T-E,R=1;R<S.length&&S.charCodeAt(R)===47;++R);for(var b=S.length,F=b-R,O=C<F?C:F,L=-1,D=0;D<=O;++D){if(D===O){if(F>O){if(S.charCodeAt(R+D)===47)return S.slice(R+D+1);if(D===0)return S.slice(R+D)}else C>O&&(_.charCodeAt(E+D)===47?L=D:D===0&&(L=0));break}var x=_.charCodeAt(E+D),B=S.charCodeAt(R+D);if(x!==B)break;x===47&&(L=D)}var M="";for(D=E+L+1;D<=T;++D)(D===T||_.charCodeAt(D)===47)&&(M.length===0?M+="..":M+="/..");return M.length>0?M+S.slice(R+L):(R+=L,S.charCodeAt(R)===47&&++R,S.slice(R))},_makeLong:function(_){return _},dirname:function(_){if(f(_),_.length===0)return".";for(var S=_.charCodeAt(0),E=S===47,T=-1,C=!0,R=_.length-1;R>=1;--R)if(S=_.charCodeAt(R),S===47){if(!C){T=R;break}}else C=!1;return T===-1?E?"/":".":E&&T===1?"//":_.slice(0,T)},basename:function(_,S){if(S!==void 0&&typeof S!="string")throw new TypeError('"ext" argument must be a string');f(_);var E=0,T=-1,C=!0,R;if(S!==void 0&&S.length>0&&S.length<=_.length){if(S.length===_.length&&S===_)return"";var b=S.length-1,F=-1;for(R=_.length-1;R>=0;--R){var O=_.charCodeAt(R);if(O===47){if(!C){E=R+1;break}}else F===-1&&(C=!1,F=R+1),b>=0&&(O===S.charCodeAt(b)?--b===-1&&(T=R):(b=-1,T=F))}return E===T?T=F:T===-1&&(T=_.length),_.slice(E,T)}else{for(R=_.length-1;R>=0;--R)if(_.charCodeAt(R)===47){if(!C){E=R+1;break}}else T===-1&&(C=!1,T=R+1);return T===-1?"":_.slice(E,T)}},extname:function(_){f(_);for(var S=-1,E=0,T=-1,C=!0,R=0,b=_.length-1;b>=0;--b){var F=_.charCodeAt(b);if(F===47){if(!C){E=b+1;break}continue}T===-1&&(C=!1,T=b+1),F===46?S===-1?S=b:R!==1&&(R=1):S!==-1&&(R=-1)}return S===-1||T===-1||R===0||R===1&&S===T-1&&S===E+1?"":_.slice(S,T)},format:function(_){if(_===null||typeof _!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof _);return m("/",_)},parse:function(_){f(_);var S={root:"",dir:"",base:"",ext:"",name:""};if(_.length===0)return S;var E=_.charCodeAt(0),T=E===47,C;T?(S.root="/",C=1):C=0;for(var R=-1,b=0,F=-1,O=!0,L=_.length-1,D=0;L>=C;--L){if(E=_.charCodeAt(L),E===47){if(!O){b=L+1;break}continue}F===-1&&(O=!1,F=L+1),E===46?R===-1?R=L:D!==1&&(D=1):R!==-1&&(D=-1)}return R===-1||F===-1||D===0||D===1&&R===F-1&&R===b+1?F!==-1&&(b===0&&T?S.base=S.name=_.slice(1,F):S.base=S.name=_.slice(b,F)):(b===0&&T?(S.name=_.slice(1,R),S.base=_.slice(1,F)):(S.name=_.slice(b,R),S.base=_.slice(b,F)),S.ext=_.slice(R,F)),b>0?S.dir=_.slice(0,b-1):T&&(S.dir="/"),S},sep:"/",delimiter:":",win32:null,posix:null};g.posix=g,h.exports=g},"./node_modules/safe-buffer/index.js":(h,f,d)=>{var m=d("./node_modules/buffer/index.js"),g=m.Buffer;function v(S,E){for(var T in S)E[T]=S[T]}g.from&&g.alloc&&g.allocUnsafe&&g.allocUnsafeSlow?h.exports=m:(v(m,f),f.Buffer=_);function _(S,E,T){return g(S,E,T)}v(g,_),_.from=function(S,E,T){if(typeof S=="number")throw new TypeError("Argument must not be a number");return g(S,E,T)},_.alloc=function(S,E,T){if(typeof S!="number")throw new TypeError("Argument must be a number");var C=g(S);return E!==void 0?typeof T=="string"?C.fill(E,T):C.fill(E):C.fill(0),C},_.allocUnsafe=function(S){if(typeof S!="number")throw new TypeError("Argument must be a number");return g(S)},_.allocUnsafeSlow=function(S){if(typeof S!="number")throw new TypeError("Argument must be a number");return m.SlowBuffer(S)}},"./node_modules/sax/lib/sax.js":(h,f,d)=>{(function(m){m.parser=function(V,j){return new v(V,j)},m.SAXParser=v,m.SAXStream=b,m.createStream=R,m.MAX_BUFFER_LENGTH=65536;var g=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];m.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function v(V,j){if(!(this instanceof v))return new v(V,j);var $=this;S($),$.q=$.c="",$.bufferCheckPosition=m.MAX_BUFFER_LENGTH,$.opt=j||{},$.opt.lowercase=$.opt.lowercase||$.opt.lowercasetags,$.looseCase=$.opt.lowercase?"toLowerCase":"toUpperCase",$.tags=[],$.closed=$.closedRoot=$.sawRoot=!1,$.tag=$.error=null,$.strict=!!V,$.noscript=!!(V||$.opt.noscript),$.state=Q.BEGIN,$.strictEntities=$.opt.strictEntities,$.ENTITIES=$.strictEntities?Object.create(m.XML_ENTITIES):Object.create(m.ENTITIES),$.attribList=[],$.opt.xmlns&&($.ns=Object.create(w)),$.trackPosition=$.opt.position!==!1,$.trackPosition&&($.position=$.line=$.column=0),ve($,"onready")}Object.create||(Object.create=function(V){function j(){}j.prototype=V;var $=new j;return $}),Object.keys||(Object.keys=function(V){var j=[];for(var $ in V)V.hasOwnProperty($)&&j.push($);return j});function _(V){for(var j=Math.max(m.MAX_BUFFER_LENGTH,10),$=0,re=0,oe=g.length;re<oe;re++){var X=V[g[re]].length;if(X>j)switch(g[re]){case"textNode":Z(V);break;case"cdata":_e(V,"oncdata",V.cdata),V.cdata="";break;case"script":_e(V,"onscript",V.script),V.script="";break;default:Se(V,"Max buffer length exceeded: "+g[re])}$=Math.max($,X)}var z=m.MAX_BUFFER_LENGTH-$;V.bufferCheckPosition=z+V.position}function S(V){for(var j=0,$=g.length;j<$;j++)V[g[j]]=""}function E(V){Z(V),V.cdata!==""&&(_e(V,"oncdata",V.cdata),V.cdata=""),V.script!==""&&(_e(V,"onscript",V.script),V.script="")}v.prototype={end:function(){Me(this)},write:me,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){E(this)}};var T;try{T=d("./node_modules/stream-browserify/index.js").Stream}catch{T=function(){}}var C=m.EVENTS.filter(function(V){return V!=="error"&&V!=="end"});function R(V,j){return new b(V,j)}function b(V,j){if(!(this instanceof b))return new b(V,j);T.apply(this),this._parser=new v(V,j),this.writable=!0,this.readable=!0;var $=this;this._parser.onend=function(){$.emit("end")},this._parser.onerror=function(re){$.emit("error",re),$._parser.error=null},this._decoder=null,C.forEach(function(re){Object.defineProperty($,"on"+re,{get:function(){return $._parser["on"+re]},set:function(oe){if(!oe)return $.removeAllListeners(re),$._parser["on"+re]=oe,oe;$.on(re,oe)},enumerable:!0,configurable:!1})})}b.prototype=Object.create(T.prototype,{constructor:{value:b}}),b.prototype.write=function(V){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(V)){if(!this._decoder){var j=d("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder;this._decoder=new j("utf8")}V=this._decoder.write(V)}return this._parser.write(V.toString()),this.emit("data",V),!0},b.prototype.end=function(V){return V&&V.length&&this.write(V),this._parser.end(),!0},b.prototype.on=function(V,j){var $=this;return!$._parser["on"+V]&&C.indexOf(V)!==-1&&($._parser["on"+V]=function(){var re=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);re.splice(0,0,V),$.emit.apply($,re)}),T.prototype.on.call($,V,j)};var F=`\r
	 `,O="0124356789",L="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",D=`'"`,x=F+">",B="[CDATA[",M="DOCTYPE",I="http://www.w3.org/XML/1998/namespace",U="http://www.w3.org/2000/xmlns/",w={xml:I,xmlns:U};F=J(F),O=J(O),L=J(L);var k=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,K=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,W=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;D=J(D),x=J(x);function J(V){return V.split("").reduce(function(j,$){return j[$]=!0,j},{})}function ee(V){return Object.prototype.toString.call(V)==="[object RegExp]"}function ue(V,j){return ee(V)?!!j.match(V):V[j]}function ie(V,j){return!ue(V,j)}var Q=0;m.STATE={BEGIN:Q++,BEGIN_WHITESPACE:Q++,TEXT:Q++,TEXT_ENTITY:Q++,OPEN_WAKA:Q++,SGML_DECL:Q++,SGML_DECL_QUOTED:Q++,DOCTYPE:Q++,DOCTYPE_QUOTED:Q++,DOCTYPE_DTD:Q++,DOCTYPE_DTD_QUOTED:Q++,COMMENT_STARTING:Q++,COMMENT:Q++,COMMENT_ENDING:Q++,COMMENT_ENDED:Q++,CDATA:Q++,CDATA_ENDING:Q++,CDATA_ENDING_2:Q++,PROC_INST:Q++,PROC_INST_BODY:Q++,PROC_INST_ENDING:Q++,OPEN_TAG:Q++,OPEN_TAG_SLASH:Q++,ATTRIB:Q++,ATTRIB_NAME:Q++,ATTRIB_NAME_SAW_WHITE:Q++,ATTRIB_VALUE:Q++,ATTRIB_VALUE_QUOTED:Q++,ATTRIB_VALUE_CLOSED:Q++,ATTRIB_VALUE_UNQUOTED:Q++,ATTRIB_VALUE_ENTITY_Q:Q++,ATTRIB_VALUE_ENTITY_U:Q++,CLOSE_TAG:Q++,CLOSE_TAG_SAW_WHITE:Q++,SCRIPT:Q++,SCRIPT_ENDING:Q++},m.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},m.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(m.ENTITIES).forEach(function(V){var j=m.ENTITIES[V],$=typeof j=="number"?String.fromCharCode(j):j;m.ENTITIES[V]=$});for(var se in m.STATE)m.STATE[m.STATE[se]]=se;Q=m.STATE;function ve(V,j,$){V[j]&&V[j]($)}function _e(V,j,$){V.textNode&&Z(V),ve(V,j,$)}function Z(V){V.textNode=Ee(V.opt,V.textNode),V.textNode&&ve(V,"ontext",V.textNode),V.textNode=""}function Ee(V,j){return V.trim&&(j=j.trim()),V.normalize&&(j=j.replace(/\s+/g," ")),j}function Se(V,j){return Z(V),V.trackPosition&&(j+=`
Line: `+V.line+`
Column: `+V.column+`
Char: `+V.c),j=new Error(j),V.error=j,ve(V,"onerror",j),V}function Me(V){return V.sawRoot&&!V.closedRoot&&de(V,"Unclosed root tag"),V.state!==Q.BEGIN&&V.state!==Q.BEGIN_WHITESPACE&&V.state!==Q.TEXT&&Se(V,"Unexpected end"),Z(V),V.c="",V.closed=!0,ve(V,"onend"),v.call(V,V.strict,V.opt),V}function de(V,j){if(typeof V!="object"||!(V instanceof v))throw new Error("bad call to strictFail");V.strict&&Se(V,j)}function xe(V){V.strict||(V.tagName=V.tagName[V.looseCase]());var j=V.tags[V.tags.length-1]||V,$=V.tag={name:V.tagName,attributes:{}};V.opt.xmlns&&($.ns=j.ns),V.attribList.length=0,_e(V,"onopentagstart",$)}function Fe(V,j){var $=V.indexOf(":"),re=$<0?["",V]:V.split(":"),oe=re[0],X=re[1];return j&&V==="xmlns"&&(oe="xmlns",X=""),{prefix:oe,local:X}}function Le(V){if(V.strict||(V.attribName=V.attribName[V.looseCase]()),V.attribList.indexOf(V.attribName)!==-1||V.tag.attributes.hasOwnProperty(V.attribName)){V.attribName=V.attribValue="";return}if(V.opt.xmlns){var j=Fe(V.attribName,!0),$=j.prefix,re=j.local;if($==="xmlns")if(re==="xml"&&V.attribValue!==I)de(V,"xml: prefix must be bound to "+I+`
Actual: `+V.attribValue);else if(re==="xmlns"&&V.attribValue!==U)de(V,"xmlns: prefix must be bound to "+U+`
Actual: `+V.attribValue);else{var oe=V.tag,X=V.tags[V.tags.length-1]||V;oe.ns===X.ns&&(oe.ns=Object.create(X.ns)),oe.ns[re]=V.attribValue}V.attribList.push([V.attribName,V.attribValue])}else V.tag.attributes[V.attribName]=V.attribValue,_e(V,"onattribute",{name:V.attribName,value:V.attribValue});V.attribName=V.attribValue=""}function De(V,j){if(V.opt.xmlns){var $=V.tag,re=Fe(V.tagName);$.prefix=re.prefix,$.local=re.local,$.uri=$.ns[re.prefix]||"",$.prefix&&!$.uri&&(de(V,"Unbound namespace prefix: "+JSON.stringify(V.tagName)),$.uri=re.prefix);var oe=V.tags[V.tags.length-1]||V;$.ns&&oe.ns!==$.ns&&Object.keys($.ns).forEach(function(it){_e(V,"onopennamespace",{prefix:it,uri:$.ns[it]})});for(var X=0,z=V.attribList.length;X<z;X++){var ne=V.attribList[X],fe=ne[0],Ce=ne[1],Pe=Fe(fe,!0),he=Pe.prefix,Ue=Pe.local,we=he===""?"":$.ns[he]||"",$e={name:fe,value:Ce,prefix:he,local:Ue,uri:we};he&&he!=="xmlns"&&!we&&(de(V,"Unbound namespace prefix: "+JSON.stringify(he)),$e.uri=he),V.tag.attributes[fe]=$e,_e(V,"onattribute",$e)}V.attribList.length=0}V.tag.isSelfClosing=!!j,V.sawRoot=!0,V.tags.push(V.tag),_e(V,"onopentag",V.tag),j||(!V.noscript&&V.tagName.toLowerCase()==="script"?V.state=Q.SCRIPT:V.state=Q.TEXT,V.tag=null,V.tagName=""),V.attribName=V.attribValue="",V.attribList.length=0}function Ae(V){if(!V.tagName){de(V,"Weird empty close tag."),V.textNode+="</>",V.state=Q.TEXT;return}if(V.script){if(V.tagName!=="script"){V.script+="</"+V.tagName+">",V.tagName="",V.state=Q.SCRIPT;return}_e(V,"onscript",V.script),V.script=""}var j=V.tags.length,$=V.tagName;V.strict||($=$[V.looseCase]());for(var re=$;j--;){var oe=V.tags[j];if(oe.name!==re)de(V,"Unexpected close tag");else break}if(j<0){de(V,"Unmatched closing tag: "+V.tagName),V.textNode+="</"+V.tagName+">",V.state=Q.TEXT;return}V.tagName=$;for(var X=V.tags.length;X-- >j;){var z=V.tag=V.tags.pop();V.tagName=V.tag.name,_e(V,"onclosetag",V.tagName);var ne={};for(var fe in z.ns)ne[fe]=z.ns[fe];var Ce=V.tags[V.tags.length-1]||V;V.opt.xmlns&&z.ns!==Ce.ns&&Object.keys(z.ns).forEach(function(Pe){var he=z.ns[Pe];_e(V,"onclosenamespace",{prefix:Pe,uri:he})})}j===0&&(V.closedRoot=!0),V.tagName=V.attribValue=V.attribName="",V.attribList.length=0,V.state=Q.TEXT}function ge(V){var j=V.entity,$=j.toLowerCase(),re,oe="";return V.ENTITIES[j]?V.ENTITIES[j]:V.ENTITIES[$]?V.ENTITIES[$]:(j=$,j.charAt(0)==="#"&&(j.charAt(1)==="x"?(j=j.slice(2),re=parseInt(j,16),oe=re.toString(16)):(j=j.slice(1),re=parseInt(j,10),oe=re.toString(10))),j=j.replace(/^0+/,""),oe.toLowerCase()!==j?(de(V,"Invalid character entity"),"&"+V.entity+";"):String.fromCodePoint(re))}function pe(V,j){j==="<"?(V.state=Q.OPEN_WAKA,V.startTagPosition=V.position):ie(F,j)&&(de(V,"Non-whitespace before first tag."),V.textNode=j,V.state=Q.TEXT)}function Re(V,j){var $="";return j<V.length&&($=V.charAt(j)),$}function me(V){var j=this;if(this.error)throw this.error;if(j.closed)return Se(j,"Cannot write after close. Assign an onready handler.");if(V===null)return Me(j);typeof V=="object"&&(V=V.toString());for(var $=0,re="";re=Re(V,$++),j.c=re,!!re;)switch(j.trackPosition&&(j.position++,re===`
`?(j.line++,j.column=0):j.column++),j.state){case Q.BEGIN:if(j.state=Q.BEGIN_WHITESPACE,re==="\uFEFF")continue;pe(j,re);continue;case Q.BEGIN_WHITESPACE:pe(j,re);continue;case Q.TEXT:if(j.sawRoot&&!j.closedRoot){for(var oe=$-1;re&&re!=="<"&&re!=="&";)re=Re(V,$++),re&&j.trackPosition&&(j.position++,re===`
`?(j.line++,j.column=0):j.column++);j.textNode+=V.substring(oe,$-1)}re==="<"&&!(j.sawRoot&&j.closedRoot&&!j.strict)?(j.state=Q.OPEN_WAKA,j.startTagPosition=j.position):(ie(F,re)&&(!j.sawRoot||j.closedRoot)&&de(j,"Text data outside of root node."),re==="&"?j.state=Q.TEXT_ENTITY:j.textNode+=re);continue;case Q.SCRIPT:re==="<"?j.state=Q.SCRIPT_ENDING:j.script+=re;continue;case Q.SCRIPT_ENDING:re==="/"?j.state=Q.CLOSE_TAG:(j.script+="<"+re,j.state=Q.SCRIPT);continue;case Q.OPEN_WAKA:if(re==="!")j.state=Q.SGML_DECL,j.sgmlDecl="";else if(!ue(F,re))if(ue(k,re))j.state=Q.OPEN_TAG,j.tagName=re;else if(re==="/")j.state=Q.CLOSE_TAG,j.tagName="";else if(re==="?")j.state=Q.PROC_INST,j.procInstName=j.procInstBody="";else{if(de(j,"Unencoded <"),j.startTagPosition+1<j.position){var X=j.position-j.startTagPosition;re=new Array(X).join(" ")+re}j.textNode+="<"+re,j.state=Q.TEXT}continue;case Q.SGML_DECL:(j.sgmlDecl+re).toUpperCase()===B?(_e(j,"onopencdata"),j.state=Q.CDATA,j.sgmlDecl="",j.cdata=""):j.sgmlDecl+re==="--"?(j.state=Q.COMMENT,j.comment="",j.sgmlDecl=""):(j.sgmlDecl+re).toUpperCase()===M?(j.state=Q.DOCTYPE,(j.doctype||j.sawRoot)&&de(j,"Inappropriately located doctype declaration"),j.doctype="",j.sgmlDecl=""):re===">"?(_e(j,"onsgmldeclaration",j.sgmlDecl),j.sgmlDecl="",j.state=Q.TEXT):(ue(D,re)&&(j.state=Q.SGML_DECL_QUOTED),j.sgmlDecl+=re);continue;case Q.SGML_DECL_QUOTED:re===j.q&&(j.state=Q.SGML_DECL,j.q=""),j.sgmlDecl+=re;continue;case Q.DOCTYPE:re===">"?(j.state=Q.TEXT,_e(j,"ondoctype",j.doctype),j.doctype=!0):(j.doctype+=re,re==="["?j.state=Q.DOCTYPE_DTD:ue(D,re)&&(j.state=Q.DOCTYPE_QUOTED,j.q=re));continue;case Q.DOCTYPE_QUOTED:j.doctype+=re,re===j.q&&(j.q="",j.state=Q.DOCTYPE);continue;case Q.DOCTYPE_DTD:j.doctype+=re,re==="]"?j.state=Q.DOCTYPE:ue(D,re)&&(j.state=Q.DOCTYPE_DTD_QUOTED,j.q=re);continue;case Q.DOCTYPE_DTD_QUOTED:j.doctype+=re,re===j.q&&(j.state=Q.DOCTYPE_DTD,j.q="");continue;case Q.COMMENT:re==="-"?j.state=Q.COMMENT_ENDING:j.comment+=re;continue;case Q.COMMENT_ENDING:re==="-"?(j.state=Q.COMMENT_ENDED,j.comment=Ee(j.opt,j.comment),j.comment&&_e(j,"oncomment",j.comment),j.comment=""):(j.comment+="-"+re,j.state=Q.COMMENT);continue;case Q.COMMENT_ENDED:re!==">"?(de(j,"Malformed comment"),j.comment+="--"+re,j.state=Q.COMMENT):j.state=Q.TEXT;continue;case Q.CDATA:re==="]"?j.state=Q.CDATA_ENDING:j.cdata+=re;continue;case Q.CDATA_ENDING:re==="]"?j.state=Q.CDATA_ENDING_2:(j.cdata+="]"+re,j.state=Q.CDATA);continue;case Q.CDATA_ENDING_2:re===">"?(j.cdata&&_e(j,"oncdata",j.cdata),_e(j,"onclosecdata"),j.cdata="",j.state=Q.TEXT):re==="]"?j.cdata+="]":(j.cdata+="]]"+re,j.state=Q.CDATA);continue;case Q.PROC_INST:re==="?"?j.state=Q.PROC_INST_ENDING:ue(F,re)?j.state=Q.PROC_INST_BODY:j.procInstName+=re;continue;case Q.PROC_INST_BODY:if(!j.procInstBody&&ue(F,re))continue;re==="?"?j.state=Q.PROC_INST_ENDING:j.procInstBody+=re;continue;case Q.PROC_INST_ENDING:re===">"?(_e(j,"onprocessinginstruction",{name:j.procInstName,body:j.procInstBody}),j.procInstName=j.procInstBody="",j.state=Q.TEXT):(j.procInstBody+="?"+re,j.state=Q.PROC_INST_BODY);continue;case Q.OPEN_TAG:ue(K,re)?j.tagName+=re:(xe(j),re===">"?De(j):re==="/"?j.state=Q.OPEN_TAG_SLASH:(ie(F,re)&&de(j,"Invalid character in tag name"),j.state=Q.ATTRIB));continue;case Q.OPEN_TAG_SLASH:re===">"?(De(j,!0),Ae(j)):(de(j,"Forward-slash in opening tag not followed by >"),j.state=Q.ATTRIB);continue;case Q.ATTRIB:if(ue(F,re))continue;re===">"?De(j):re==="/"?j.state=Q.OPEN_TAG_SLASH:ue(k,re)?(j.attribName=re,j.attribValue="",j.state=Q.ATTRIB_NAME):de(j,"Invalid attribute name");continue;case Q.ATTRIB_NAME:re==="="?j.state=Q.ATTRIB_VALUE:re===">"?(de(j,"Attribute without value"),j.attribValue=j.attribName,Le(j),De(j)):ue(F,re)?j.state=Q.ATTRIB_NAME_SAW_WHITE:ue(K,re)?j.attribName+=re:de(j,"Invalid attribute name");continue;case Q.ATTRIB_NAME_SAW_WHITE:if(re==="=")j.state=Q.ATTRIB_VALUE;else{if(ue(F,re))continue;de(j,"Attribute without value"),j.tag.attributes[j.attribName]="",j.attribValue="",_e(j,"onattribute",{name:j.attribName,value:""}),j.attribName="",re===">"?De(j):ue(k,re)?(j.attribName=re,j.state=Q.ATTRIB_NAME):(de(j,"Invalid attribute name"),j.state=Q.ATTRIB)}continue;case Q.ATTRIB_VALUE:if(ue(F,re))continue;ue(D,re)?(j.q=re,j.state=Q.ATTRIB_VALUE_QUOTED):(de(j,"Unquoted attribute value"),j.state=Q.ATTRIB_VALUE_UNQUOTED,j.attribValue=re);continue;case Q.ATTRIB_VALUE_QUOTED:if(re!==j.q){re==="&"?j.state=Q.ATTRIB_VALUE_ENTITY_Q:j.attribValue+=re;continue}Le(j),j.q="",j.state=Q.ATTRIB_VALUE_CLOSED;continue;case Q.ATTRIB_VALUE_CLOSED:ue(F,re)?j.state=Q.ATTRIB:re===">"?De(j):re==="/"?j.state=Q.OPEN_TAG_SLASH:ue(k,re)?(de(j,"No whitespace between attributes"),j.attribName=re,j.attribValue="",j.state=Q.ATTRIB_NAME):de(j,"Invalid attribute name");continue;case Q.ATTRIB_VALUE_UNQUOTED:if(ie(x,re)){re==="&"?j.state=Q.ATTRIB_VALUE_ENTITY_U:j.attribValue+=re;continue}Le(j),re===">"?De(j):j.state=Q.ATTRIB;continue;case Q.CLOSE_TAG:if(j.tagName)re===">"?Ae(j):ue(K,re)?j.tagName+=re:j.script?(j.script+="</"+j.tagName,j.tagName="",j.state=Q.SCRIPT):(ie(F,re)&&de(j,"Invalid tagname in closing tag"),j.state=Q.CLOSE_TAG_SAW_WHITE);else{if(ue(F,re))continue;ie(k,re)?j.script?(j.script+="</"+re,j.state=Q.SCRIPT):de(j,"Invalid tagname in closing tag."):j.tagName=re}continue;case Q.CLOSE_TAG_SAW_WHITE:if(ue(F,re))continue;re===">"?Ae(j):de(j,"Invalid characters in closing tag");continue;case Q.TEXT_ENTITY:case Q.ATTRIB_VALUE_ENTITY_Q:case Q.ATTRIB_VALUE_ENTITY_U:var z,ne;switch(j.state){case Q.TEXT_ENTITY:z=Q.TEXT,ne="textNode";break;case Q.ATTRIB_VALUE_ENTITY_Q:z=Q.ATTRIB_VALUE_QUOTED,ne="attribValue";break;case Q.ATTRIB_VALUE_ENTITY_U:z=Q.ATTRIB_VALUE_UNQUOTED,ne="attribValue";break}re===";"?(j[ne]+=ge(j),j.entity="",j.state=z):ue(j.entity.length?Y:W,re)?j.entity+=re:(de(j,"Invalid character in entity name"),j[ne]+="&"+j.entity+re,j.entity="",j.state=z);continue;default:throw new Error(j,"Unknown state: "+j.state)}return j.position>=j.bufferCheckPosition&&_(j),j}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var V=String.fromCharCode,j=Math.floor,$=function(){var re=16384,oe=[],X,z,ne=-1,fe=arguments.length;if(!fe)return"";for(var Ce="";++ne<fe;){var Pe=Number(arguments[ne]);if(!isFinite(Pe)||Pe<0||Pe>1114111||j(Pe)!==Pe)throw RangeError("Invalid code point: "+Pe);Pe<=65535?oe.push(Pe):(Pe-=65536,X=(Pe>>10)+55296,z=Pe%1024+56320,oe.push(X,z)),(ne+1===fe||oe.length>re)&&(Ce+=V.apply(null,oe),oe.length=0)}return Ce};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:$,configurable:!0,writable:!0}):String.fromCodePoint=$}()})(f)},"./node_modules/stream-browserify/index.js":(h,f,d)=>{h.exports=v;var m=d("./node_modules/events/events.js").EventEmitter,g=d("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js");g(v,m),v.Readable=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_readable.js"),v.Writable=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_writable.js"),v.Duplex=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),v.Transform=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_transform.js"),v.PassThrough=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_passthrough.js"),v.finished=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js"),v.pipeline=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/pipeline.js"),v.Stream=v;function v(){m.call(this)}v.prototype.pipe=function(_,S){var E=this;function T(D){_.writable&&_.write(D)===!1&&E.pause&&E.pause()}E.on("data",T);function C(){E.readable&&E.resume&&E.resume()}_.on("drain",C),!_._isStdio&&(!S||S.end!==!1)&&(E.on("end",b),E.on("close",F));var R=!1;function b(){R||(R=!0,_.end())}function F(){R||(R=!0,typeof _.destroy=="function"&&_.destroy())}function O(D){if(L(),m.listenerCount(this,"error")===0)throw D}E.on("error",O),_.on("error",O);function L(){E.removeListener("data",T),_.removeListener("drain",C),E.removeListener("end",b),E.removeListener("close",F),E.removeListener("error",O),_.removeListener("error",O),E.removeListener("end",L),E.removeListener("close",L),_.removeListener("close",L)}return E.on("end",L),E.on("close",L),_.on("close",L),_.emit("pipe",E),_}},"./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js":h=>{typeof Object.create=="function"?h.exports=function(d,m){m&&(d.super_=m,d.prototype=Object.create(m.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}))}:h.exports=function(d,m){if(m){d.super_=m;var g=function(){};g.prototype=m.prototype,d.prototype=new g,d.prototype.constructor=d}}},"./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js":h=>{function f(E,T){E.prototype=Object.create(T.prototype),E.prototype.constructor=E,E.__proto__=T}var d={};function m(E,T,C){C||(C=Error);function R(F,O,L){return typeof T=="string"?T:T(F,O,L)}var b=function(F){f(O,F);function O(L,D,x){return F.call(this,R(L,D,x))||this}return O}(C);b.prototype.name=C.name,b.prototype.code=E,d[E]=b}function g(E,T){if(Array.isArray(E)){var C=E.length;return E=E.map(function(R){return String(R)}),C>2?"one of ".concat(T," ").concat(E.slice(0,C-1).join(", "),", or ")+E[C-1]:C===2?"one of ".concat(T," ").concat(E[0]," or ").concat(E[1]):"of ".concat(T," ").concat(E[0])}else return"of ".concat(T," ").concat(String(E))}function v(E,T,C){return E.substr(!C||C<0?0:+C,T.length)===T}function _(E,T,C){return(C===void 0||C>E.length)&&(C=E.length),E.substring(C-T.length,C)===T}function S(E,T,C){return typeof C!="number"&&(C=0),C+T.length>E.length?!1:E.indexOf(T,C)!==-1}m("ERR_INVALID_OPT_VALUE",function(E,T){return'The value "'+T+'" is invalid for option "'+E+'"'},TypeError),m("ERR_INVALID_ARG_TYPE",function(E,T,C){var R;typeof T=="string"&&v(T,"not ")?(R="must not be",T=T.replace(/^not /,"")):R="must be";var b;if(_(E," argument"))b="The ".concat(E," ").concat(R," ").concat(g(T,"type"));else{var F=S(E,".")?"property":"argument";b='The "'.concat(E,'" ').concat(F," ").concat(R," ").concat(g(T,"type"))}return b+=". Received type ".concat(typeof C),b},TypeError),m("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),m("ERR_METHOD_NOT_IMPLEMENTED",function(E){return"The "+E+" method is not implemented"}),m("ERR_STREAM_PREMATURE_CLOSE","Premature close"),m("ERR_STREAM_DESTROYED",function(E){return"Cannot call "+E+" after a stream was destroyed"}),m("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),m("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),m("ERR_STREAM_WRITE_AFTER_END","write after end"),m("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),m("ERR_UNKNOWN_ENCODING",function(E){return"Unknown encoding: "+E},TypeError),m("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),h.exports.codes=d},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js":(h,f,d)=>{var m=Object.keys||function(b){var F=[];for(var O in b)F.push(O);return F};h.exports=T;var g=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_readable.js"),v=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_writable.js");d("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(T,g);for(var _=m(v.prototype),S=0;S<_.length;S++){var E=_[S];T.prototype[E]||(T.prototype[E]=v.prototype[E])}function T(b){if(!(this instanceof T))return new T(b);g.call(this,b),v.call(this,b),this.allowHalfOpen=!0,b&&(b.readable===!1&&(this.readable=!1),b.writable===!1&&(this.writable=!1),b.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",C)))}Object.defineProperty(T.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(T.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(T.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function C(){this._writableState.ended||process.nextTick(R,this)}function R(b){b.end()}Object.defineProperty(T.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(F){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=F,this._writableState.destroyed=F)}})},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_passthrough.js":(h,f,d)=>{h.exports=g;var m=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_transform.js");d("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(g,m);function g(v){if(!(this instanceof g))return new g(v);m.call(this,v)}g.prototype._transform=function(v,_,S){S(null,v)}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_readable.js":(h,f,d)=>{h.exports=ee;var m;ee.ReadableState=J,d("./node_modules/events/events.js").EventEmitter;var g=function($,re){return $.listeners(re).length},v=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/stream-browser.js"),_=d("./node_modules/buffer/index.js").Buffer,S=d.g.Uint8Array||function(){};function E(j){return _.from(j)}function T(j){return _.isBuffer(j)||j instanceof S}var C=d("?19e6"),R;C&&C.debuglog?R=C.debuglog("stream"):R=function(){};var b=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/buffer_list.js"),F=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/destroy.js"),O=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/state.js"),L=O.getHighWaterMark,D=d("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,x=D.ERR_INVALID_ARG_TYPE,B=D.ERR_STREAM_PUSH_AFTER_EOF,M=D.ERR_METHOD_NOT_IMPLEMENTED,I=D.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,U,w,k;d("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(ee,v);var K=F.errorOrDestroy,W=["error","close","destroy","pause","resume"];function Y(j,$,re){if(typeof j.prependListener=="function")return j.prependListener($,re);!j._events||!j._events[$]?j.on($,re):Array.isArray(j._events[$])?j._events[$].unshift(re):j._events[$]=[re,j._events[$]]}function J(j,$,re){m=m||d("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),j=j||{},typeof re!="boolean"&&(re=$ instanceof m),this.objectMode=!!j.objectMode,re&&(this.objectMode=this.objectMode||!!j.readableObjectMode),this.highWaterMark=L(this,j,"readableHighWaterMark",re),this.buffer=new b,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=j.emitClose!==!1,this.autoDestroy=!!j.autoDestroy,this.destroyed=!1,this.defaultEncoding=j.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,j.encoding&&(U||(U=d("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder),this.decoder=new U(j.encoding),this.encoding=j.encoding)}function ee(j){if(m=m||d("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),!(this instanceof ee))return new ee(j);var $=this instanceof m;this._readableState=new J(j,this,$),this.readable=!0,j&&(typeof j.read=="function"&&(this._read=j.read),typeof j.destroy=="function"&&(this._destroy=j.destroy)),v.call(this)}Object.defineProperty(ee.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function($){this._readableState&&(this._readableState.destroyed=$)}}),ee.prototype.destroy=F.destroy,ee.prototype._undestroy=F.undestroy,ee.prototype._destroy=function(j,$){$(j)},ee.prototype.push=function(j,$){var re=this._readableState,oe;return re.objectMode?oe=!0:typeof j=="string"&&($=$||re.defaultEncoding,$!==re.encoding&&(j=_.from(j,$),$=""),oe=!0),ue(this,j,$,!1,oe)},ee.prototype.unshift=function(j){return ue(this,j,null,!0,!1)};function ue(j,$,re,oe,X){R("readableAddChunk",$);var z=j._readableState;if($===null)z.reading=!1,Z(j,z);else{var ne;if(X||(ne=Q(z,$)),ne)K(j,ne);else if(z.objectMode||$&&$.length>0)if(typeof $!="string"&&!z.objectMode&&Object.getPrototypeOf($)!==_.prototype&&($=E($)),oe)z.endEmitted?K(j,new I):ie(j,z,$,!0);else if(z.ended)K(j,new B);else{if(z.destroyed)return!1;z.reading=!1,z.decoder&&!re?($=z.decoder.write($),z.objectMode||$.length!==0?ie(j,z,$,!1):Me(j,z)):ie(j,z,$,!1)}else oe||(z.reading=!1,Me(j,z))}return!z.ended&&(z.length<z.highWaterMark||z.length===0)}function ie(j,$,re,oe){$.flowing&&$.length===0&&!$.sync?($.awaitDrain=0,j.emit("data",re)):($.length+=$.objectMode?1:re.length,oe?$.buffer.unshift(re):$.buffer.push(re),$.needReadable&&Ee(j)),Me(j,$)}function Q(j,$){var re;return!T($)&&typeof $!="string"&&$!==void 0&&!j.objectMode&&(re=new x("chunk",["string","Buffer","Uint8Array"],$)),re}ee.prototype.isPaused=function(){return this._readableState.flowing===!1},ee.prototype.setEncoding=function(j){U||(U=d("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder);var $=new U(j);this._readableState.decoder=$,this._readableState.encoding=this._readableState.decoder.encoding;for(var re=this._readableState.buffer.head,oe="";re!==null;)oe+=$.write(re.data),re=re.next;return this._readableState.buffer.clear(),oe!==""&&this._readableState.buffer.push(oe),this._readableState.length=oe.length,this};var se=1073741824;function ve(j){return j>=se?j=se:(j--,j|=j>>>1,j|=j>>>2,j|=j>>>4,j|=j>>>8,j|=j>>>16,j++),j}function _e(j,$){return j<=0||$.length===0&&$.ended?0:$.objectMode?1:j!==j?$.flowing&&$.length?$.buffer.head.data.length:$.length:(j>$.highWaterMark&&($.highWaterMark=ve(j)),j<=$.length?j:$.ended?$.length:($.needReadable=!0,0))}ee.prototype.read=function(j){R("read",j),j=parseInt(j,10);var $=this._readableState,re=j;if(j!==0&&($.emittedReadable=!1),j===0&&$.needReadable&&(($.highWaterMark!==0?$.length>=$.highWaterMark:$.length>0)||$.ended))return R("read: emitReadable",$.length,$.ended),$.length===0&&$.ended?Re(this):Ee(this),null;if(j=_e(j,$),j===0&&$.ended)return $.length===0&&Re(this),null;var oe=$.needReadable;R("need readable",oe),($.length===0||$.length-j<$.highWaterMark)&&(oe=!0,R("length less than watermark",oe)),$.ended||$.reading?(oe=!1,R("reading or ended",oe)):oe&&(R("do read"),$.reading=!0,$.sync=!0,$.length===0&&($.needReadable=!0),this._read($.highWaterMark),$.sync=!1,$.reading||(j=_e(re,$)));var X;return j>0?X=pe(j,$):X=null,X===null?($.needReadable=$.length<=$.highWaterMark,j=0):($.length-=j,$.awaitDrain=0),$.length===0&&($.ended||($.needReadable=!0),re!==j&&$.ended&&Re(this)),X!==null&&this.emit("data",X),X};function Z(j,$){if(R("onEofChunk"),!$.ended){if($.decoder){var re=$.decoder.end();re&&re.length&&($.buffer.push(re),$.length+=$.objectMode?1:re.length)}$.ended=!0,$.sync?Ee(j):($.needReadable=!1,$.emittedReadable||($.emittedReadable=!0,Se(j)))}}function Ee(j){var $=j._readableState;R("emitReadable",$.needReadable,$.emittedReadable),$.needReadable=!1,$.emittedReadable||(R("emitReadable",$.flowing),$.emittedReadable=!0,process.nextTick(Se,j))}function Se(j){var $=j._readableState;R("emitReadable_",$.destroyed,$.length,$.ended),!$.destroyed&&($.length||$.ended)&&(j.emit("readable"),$.emittedReadable=!1),$.needReadable=!$.flowing&&!$.ended&&$.length<=$.highWaterMark,ge(j)}function Me(j,$){$.readingMore||($.readingMore=!0,process.nextTick(de,j,$))}function de(j,$){for(;!$.reading&&!$.ended&&($.length<$.highWaterMark||$.flowing&&$.length===0);){var re=$.length;if(R("maybeReadMore read 0"),j.read(0),re===$.length)break}$.readingMore=!1}ee.prototype._read=function(j){K(this,new M("_read()"))},ee.prototype.pipe=function(j,$){var re=this,oe=this._readableState;switch(oe.pipesCount){case 0:oe.pipes=j;break;case 1:oe.pipes=[oe.pipes,j];break;default:oe.pipes.push(j);break}oe.pipesCount+=1,R("pipe count=%d opts=%j",oe.pipesCount,$);var X=(!$||$.end!==!1)&&j!==process.stdout&&j!==process.stderr,z=X?fe:mt;oe.endEmitted?process.nextTick(z):re.once("end",z),j.on("unpipe",ne);function ne(pt,Pt){R("onunpipe"),pt===re&&Pt&&Pt.hasUnpiped===!1&&(Pt.hasUnpiped=!0,he())}function fe(){R("onend"),j.end()}var Ce=xe(re);j.on("drain",Ce);var Pe=!1;function he(){R("cleanup"),j.removeListener("close",$e),j.removeListener("finish",it),j.removeListener("drain",Ce),j.removeListener("error",we),j.removeListener("unpipe",ne),re.removeListener("end",fe),re.removeListener("end",mt),re.removeListener("data",Ue),Pe=!0,oe.awaitDrain&&(!j._writableState||j._writableState.needDrain)&&Ce()}re.on("data",Ue);function Ue(pt){R("ondata");var Pt=j.write(pt);R("dest.write",Pt),Pt===!1&&((oe.pipesCount===1&&oe.pipes===j||oe.pipesCount>1&&V(oe.pipes,j)!==-1)&&!Pe&&(R("false write response, pause",oe.awaitDrain),oe.awaitDrain++),re.pause())}function we(pt){R("onerror",pt),mt(),j.removeListener("error",we),g(j,"error")===0&&K(j,pt)}Y(j,"error",we);function $e(){j.removeListener("finish",it),mt()}j.once("close",$e);function it(){R("onfinish"),j.removeListener("close",$e),mt()}j.once("finish",it);function mt(){R("unpipe"),re.unpipe(j)}return j.emit("pipe",re),oe.flowing||(R("pipe resume"),re.resume()),j};function xe(j){return function(){var re=j._readableState;R("pipeOnDrain",re.awaitDrain),re.awaitDrain&&re.awaitDrain--,re.awaitDrain===0&&g(j,"data")&&(re.flowing=!0,ge(j))}}ee.prototype.unpipe=function(j){var $=this._readableState,re={hasUnpiped:!1};if($.pipesCount===0)return this;if($.pipesCount===1)return j&&j!==$.pipes?this:(j||(j=$.pipes),$.pipes=null,$.pipesCount=0,$.flowing=!1,j&&j.emit("unpipe",this,re),this);if(!j){var oe=$.pipes,X=$.pipesCount;$.pipes=null,$.pipesCount=0,$.flowing=!1;for(var z=0;z<X;z++)oe[z].emit("unpipe",this,{hasUnpiped:!1});return this}var ne=V($.pipes,j);return ne===-1?this:($.pipes.splice(ne,1),$.pipesCount-=1,$.pipesCount===1&&($.pipes=$.pipes[0]),j.emit("unpipe",this,re),this)},ee.prototype.on=function(j,$){var re=v.prototype.on.call(this,j,$),oe=this._readableState;return j==="data"?(oe.readableListening=this.listenerCount("readable")>0,oe.flowing!==!1&&this.resume()):j==="readable"&&!oe.endEmitted&&!oe.readableListening&&(oe.readableListening=oe.needReadable=!0,oe.flowing=!1,oe.emittedReadable=!1,R("on readable",oe.length,oe.reading),oe.length?Ee(this):oe.reading||process.nextTick(Le,this)),re},ee.prototype.addListener=ee.prototype.on,ee.prototype.removeListener=function(j,$){var re=v.prototype.removeListener.call(this,j,$);return j==="readable"&&process.nextTick(Fe,this),re},ee.prototype.removeAllListeners=function(j){var $=v.prototype.removeAllListeners.apply(this,arguments);return(j==="readable"||j===void 0)&&process.nextTick(Fe,this),$};function Fe(j){var $=j._readableState;$.readableListening=j.listenerCount("readable")>0,$.resumeScheduled&&!$.paused?$.flowing=!0:j.listenerCount("data")>0&&j.resume()}function Le(j){R("readable nexttick read 0"),j.read(0)}ee.prototype.resume=function(){var j=this._readableState;return j.flowing||(R("resume"),j.flowing=!j.readableListening,De(this,j)),j.paused=!1,this};function De(j,$){$.resumeScheduled||($.resumeScheduled=!0,process.nextTick(Ae,j,$))}function Ae(j,$){R("resume",$.reading),$.reading||j.read(0),$.resumeScheduled=!1,j.emit("resume"),ge(j),$.flowing&&!$.reading&&j.read(0)}ee.prototype.pause=function(){return R("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(R("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function ge(j){var $=j._readableState;for(R("flow",$.flowing);$.flowing&&j.read()!==null;);}ee.prototype.wrap=function(j){var $=this,re=this._readableState,oe=!1;j.on("end",function(){if(R("wrapped end"),re.decoder&&!re.ended){var ne=re.decoder.end();ne&&ne.length&&$.push(ne)}$.push(null)}),j.on("data",function(ne){if(R("wrapped data"),re.decoder&&(ne=re.decoder.write(ne)),!(re.objectMode&&ne==null)&&!(!re.objectMode&&(!ne||!ne.length))){var fe=$.push(ne);fe||(oe=!0,j.pause())}});for(var X in j)this[X]===void 0&&typeof j[X]=="function"&&(this[X]=function(fe){return function(){return j[fe].apply(j,arguments)}}(X));for(var z=0;z<W.length;z++)j.on(W[z],this.emit.bind(this,W[z]));return this._read=function(ne){R("wrapped _read",ne),oe&&(oe=!1,j.resume())},this},typeof Symbol=="function"&&(ee.prototype[Symbol.asyncIterator]=function(){return w===void 0&&(w=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/async_iterator.js")),w(this)}),Object.defineProperty(ee.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(ee.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(ee.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function($){this._readableState&&(this._readableState.flowing=$)}}),ee._fromList=pe,Object.defineProperty(ee.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function pe(j,$){if($.length===0)return null;var re;return $.objectMode?re=$.buffer.shift():!j||j>=$.length?($.decoder?re=$.buffer.join(""):$.buffer.length===1?re=$.buffer.first():re=$.buffer.concat($.length),$.buffer.clear()):re=$.buffer.consume(j,$.decoder),re}function Re(j){var $=j._readableState;R("endReadable",$.endEmitted),$.endEmitted||($.ended=!0,process.nextTick(me,$,j))}function me(j,$){if(R("endReadableNT",j.endEmitted,j.length),!j.endEmitted&&j.length===0&&(j.endEmitted=!0,$.readable=!1,$.emit("end"),j.autoDestroy)){var re=$._writableState;(!re||re.autoDestroy&&re.finished)&&$.destroy()}}typeof Symbol=="function"&&(ee.from=function(j,$){return k===void 0&&(k=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/from-browser.js")),k(ee,j,$)});function V(j,$){for(var re=0,oe=j.length;re<oe;re++)if(j[re]===$)return re;return-1}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_transform.js":(h,f,d)=>{h.exports=C;var m=d("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,g=m.ERR_METHOD_NOT_IMPLEMENTED,v=m.ERR_MULTIPLE_CALLBACK,_=m.ERR_TRANSFORM_ALREADY_TRANSFORMING,S=m.ERR_TRANSFORM_WITH_LENGTH_0,E=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js");d("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(C,E);function T(F,O){var L=this._transformState;L.transforming=!1;var D=L.writecb;if(D===null)return this.emit("error",new v);L.writechunk=null,L.writecb=null,O!=null&&this.push(O),D(F);var x=this._readableState;x.reading=!1,(x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}function C(F){if(!(this instanceof C))return new C(F);E.call(this,F),this._transformState={afterTransform:T.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,F&&(typeof F.transform=="function"&&(this._transform=F.transform),typeof F.flush=="function"&&(this._flush=F.flush)),this.on("prefinish",R)}function R(){var F=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(O,L){b(F,O,L)}):b(this,null,null)}C.prototype.push=function(F,O){return this._transformState.needTransform=!1,E.prototype.push.call(this,F,O)},C.prototype._transform=function(F,O,L){L(new g("_transform()"))},C.prototype._write=function(F,O,L){var D=this._transformState;if(D.writecb=L,D.writechunk=F,D.writeencoding=O,!D.transforming){var x=this._readableState;(D.needTransform||x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}},C.prototype._read=function(F){var O=this._transformState;O.writechunk!==null&&!O.transforming?(O.transforming=!0,this._transform(O.writechunk,O.writeencoding,O.afterTransform)):O.needTransform=!0},C.prototype._destroy=function(F,O){E.prototype._destroy.call(this,F,function(L){O(L)})};function b(F,O,L){if(O)return F.emit("error",O);if(L!=null&&F.push(L),F._writableState.length)throw new S;if(F._transformState.transforming)throw new _;return F.push(null)}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_writable.js":(h,f,d)=>{h.exports=J;function m(ge){var pe=this;this.next=null,this.entry=null,this.finish=function(){Ae(pe,ge)}}var g;J.WritableState=W;var v={deprecate:d("./node_modules/util-deprecate/browser.js")},_=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/stream-browser.js"),S=d("./node_modules/buffer/index.js").Buffer,E=d.g.Uint8Array||function(){};function T(ge){return S.from(ge)}function C(ge){return S.isBuffer(ge)||ge instanceof E}var R=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/destroy.js"),b=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/state.js"),F=b.getHighWaterMark,O=d("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,L=O.ERR_INVALID_ARG_TYPE,D=O.ERR_METHOD_NOT_IMPLEMENTED,x=O.ERR_MULTIPLE_CALLBACK,B=O.ERR_STREAM_CANNOT_PIPE,M=O.ERR_STREAM_DESTROYED,I=O.ERR_STREAM_NULL_VALUES,U=O.ERR_STREAM_WRITE_AFTER_END,w=O.ERR_UNKNOWN_ENCODING,k=R.errorOrDestroy;d("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(J,_);function K(){}function W(ge,pe,Re){g=g||d("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),ge=ge||{},typeof Re!="boolean"&&(Re=pe instanceof g),this.objectMode=!!ge.objectMode,Re&&(this.objectMode=this.objectMode||!!ge.writableObjectMode),this.highWaterMark=F(this,ge,"writableHighWaterMark",Re),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var me=ge.decodeStrings===!1;this.decodeStrings=!me,this.defaultEncoding=ge.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(V){Z(pe,V)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=ge.emitClose!==!1,this.autoDestroy=!!ge.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new m(this)}W.prototype.getBuffer=function(){for(var pe=this.bufferedRequest,Re=[];pe;)Re.push(pe),pe=pe.next;return Re},function(){try{Object.defineProperty(W.prototype,"buffer",{get:v.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var Y;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Y=Function.prototype[Symbol.hasInstance],Object.defineProperty(J,Symbol.hasInstance,{value:function(pe){return Y.call(this,pe)?!0:this!==J?!1:pe&&pe._writableState instanceof W}})):Y=function(pe){return pe instanceof this};function J(ge){g=g||d("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js");var pe=this instanceof g;if(!pe&&!Y.call(J,this))return new J(ge);this._writableState=new W(ge,this,pe),this.writable=!0,ge&&(typeof ge.write=="function"&&(this._write=ge.write),typeof ge.writev=="function"&&(this._writev=ge.writev),typeof ge.destroy=="function"&&(this._destroy=ge.destroy),typeof ge.final=="function"&&(this._final=ge.final)),_.call(this)}J.prototype.pipe=function(){k(this,new B)};function ee(ge,pe){var Re=new U;k(ge,Re),process.nextTick(pe,Re)}function ue(ge,pe,Re,me){var V;return Re===null?V=new I:typeof Re!="string"&&!pe.objectMode&&(V=new L("chunk",["string","Buffer"],Re)),V?(k(ge,V),process.nextTick(me,V),!1):!0}J.prototype.write=function(ge,pe,Re){var me=this._writableState,V=!1,j=!me.objectMode&&C(ge);return j&&!S.isBuffer(ge)&&(ge=T(ge)),typeof pe=="function"&&(Re=pe,pe=null),j?pe="buffer":pe||(pe=me.defaultEncoding),typeof Re!="function"&&(Re=K),me.ending?ee(this,Re):(j||ue(this,me,ge,Re))&&(me.pendingcb++,V=Q(this,me,j,ge,pe,Re)),V},J.prototype.cork=function(){this._writableState.corked++},J.prototype.uncork=function(){var ge=this._writableState;ge.corked&&(ge.corked--,!ge.writing&&!ge.corked&&!ge.bufferProcessing&&ge.bufferedRequest&&Me(this,ge))},J.prototype.setDefaultEncoding=function(pe){if(typeof pe=="string"&&(pe=pe.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((pe+"").toLowerCase())>-1))throw new w(pe);return this._writableState.defaultEncoding=pe,this},Object.defineProperty(J.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function ie(ge,pe,Re){return!ge.objectMode&&ge.decodeStrings!==!1&&typeof pe=="string"&&(pe=S.from(pe,Re)),pe}Object.defineProperty(J.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function Q(ge,pe,Re,me,V,j){if(!Re){var $=ie(pe,me,V);me!==$&&(Re=!0,V="buffer",me=$)}var re=pe.objectMode?1:me.length;pe.length+=re;var oe=pe.length<pe.highWaterMark;if(oe||(pe.needDrain=!0),pe.writing||pe.corked){var X=pe.lastBufferedRequest;pe.lastBufferedRequest={chunk:me,encoding:V,isBuf:Re,callback:j,next:null},X?X.next=pe.lastBufferedRequest:pe.bufferedRequest=pe.lastBufferedRequest,pe.bufferedRequestCount+=1}else se(ge,pe,!1,re,me,V,j);return oe}function se(ge,pe,Re,me,V,j,$){pe.writelen=me,pe.writecb=$,pe.writing=!0,pe.sync=!0,pe.destroyed?pe.onwrite(new M("write")):Re?ge._writev(V,pe.onwrite):ge._write(V,j,pe.onwrite),pe.sync=!1}function ve(ge,pe,Re,me,V){--pe.pendingcb,Re?(process.nextTick(V,me),process.nextTick(Le,ge,pe),ge._writableState.errorEmitted=!0,k(ge,me)):(V(me),ge._writableState.errorEmitted=!0,k(ge,me),Le(ge,pe))}function _e(ge){ge.writing=!1,ge.writecb=null,ge.length-=ge.writelen,ge.writelen=0}function Z(ge,pe){var Re=ge._writableState,me=Re.sync,V=Re.writecb;if(typeof V!="function")throw new x;if(_e(Re),pe)ve(ge,Re,me,pe,V);else{var j=de(Re)||ge.destroyed;!j&&!Re.corked&&!Re.bufferProcessing&&Re.bufferedRequest&&Me(ge,Re),me?process.nextTick(Ee,ge,Re,j,V):Ee(ge,Re,j,V)}}function Ee(ge,pe,Re,me){Re||Se(ge,pe),pe.pendingcb--,me(),Le(ge,pe)}function Se(ge,pe){pe.length===0&&pe.needDrain&&(pe.needDrain=!1,ge.emit("drain"))}function Me(ge,pe){pe.bufferProcessing=!0;var Re=pe.bufferedRequest;if(ge._writev&&Re&&Re.next){var me=pe.bufferedRequestCount,V=new Array(me),j=pe.corkedRequestsFree;j.entry=Re;for(var $=0,re=!0;Re;)V[$]=Re,Re.isBuf||(re=!1),Re=Re.next,$+=1;V.allBuffers=re,se(ge,pe,!0,pe.length,V,"",j.finish),pe.pendingcb++,pe.lastBufferedRequest=null,j.next?(pe.corkedRequestsFree=j.next,j.next=null):pe.corkedRequestsFree=new m(pe),pe.bufferedRequestCount=0}else{for(;Re;){var oe=Re.chunk,X=Re.encoding,z=Re.callback,ne=pe.objectMode?1:oe.length;if(se(ge,pe,!1,ne,oe,X,z),Re=Re.next,pe.bufferedRequestCount--,pe.writing)break}Re===null&&(pe.lastBufferedRequest=null)}pe.bufferedRequest=Re,pe.bufferProcessing=!1}J.prototype._write=function(ge,pe,Re){Re(new D("_write()"))},J.prototype._writev=null,J.prototype.end=function(ge,pe,Re){var me=this._writableState;return typeof ge=="function"?(Re=ge,ge=null,pe=null):typeof pe=="function"&&(Re=pe,pe=null),ge!=null&&this.write(ge,pe),me.corked&&(me.corked=1,this.uncork()),me.ending||De(this,me,Re),this},Object.defineProperty(J.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function de(ge){return ge.ending&&ge.length===0&&ge.bufferedRequest===null&&!ge.finished&&!ge.writing}function xe(ge,pe){ge._final(function(Re){pe.pendingcb--,Re&&k(ge,Re),pe.prefinished=!0,ge.emit("prefinish"),Le(ge,pe)})}function Fe(ge,pe){!pe.prefinished&&!pe.finalCalled&&(typeof ge._final=="function"&&!pe.destroyed?(pe.pendingcb++,pe.finalCalled=!0,process.nextTick(xe,ge,pe)):(pe.prefinished=!0,ge.emit("prefinish")))}function Le(ge,pe){var Re=de(pe);if(Re&&(Fe(ge,pe),pe.pendingcb===0&&(pe.finished=!0,ge.emit("finish"),pe.autoDestroy))){var me=ge._readableState;(!me||me.autoDestroy&&me.endEmitted)&&ge.destroy()}return Re}function De(ge,pe,Re){pe.ending=!0,Le(ge,pe),Re&&(pe.finished?process.nextTick(Re):ge.once("finish",Re)),pe.ended=!0,ge.writable=!1}function Ae(ge,pe,Re){var me=ge.entry;for(ge.entry=null;me;){var V=me.callback;pe.pendingcb--,V(Re),me=me.next}pe.corkedRequestsFree.next=ge}Object.defineProperty(J.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(pe){this._writableState&&(this._writableState.destroyed=pe)}}),J.prototype.destroy=R.destroy,J.prototype._undestroy=R.undestroy,J.prototype._destroy=function(ge,pe){pe(ge)}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/async_iterator.js":(h,f,d)=>{var m;function g(I,U,w){return U in I?Object.defineProperty(I,U,{value:w,enumerable:!0,configurable:!0,writable:!0}):I[U]=w,I}var v=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js"),_=Symbol("lastResolve"),S=Symbol("lastReject"),E=Symbol("error"),T=Symbol("ended"),C=Symbol("lastPromise"),R=Symbol("handlePromise"),b=Symbol("stream");function F(I,U){return{value:I,done:U}}function O(I){var U=I[_];if(U!==null){var w=I[b].read();w!==null&&(I[C]=null,I[_]=null,I[S]=null,U(F(w,!1)))}}function L(I){process.nextTick(O,I)}function D(I,U){return function(w,k){I.then(function(){if(U[T]){w(F(void 0,!0));return}U[R](w,k)},k)}}var x=Object.getPrototypeOf(function(){}),B=Object.setPrototypeOf((m={get stream(){return this[b]},next:function(){var U=this,w=this[E];if(w!==null)return Promise.reject(w);if(this[T])return Promise.resolve(F(void 0,!0));if(this[b].destroyed)return new Promise(function(Y,J){process.nextTick(function(){U[E]?J(U[E]):Y(F(void 0,!0))})});var k=this[C],K;if(k)K=new Promise(D(k,this));else{var W=this[b].read();if(W!==null)return Promise.resolve(F(W,!1));K=new Promise(this[R])}return this[C]=K,K}},g(m,Symbol.asyncIterator,function(){return this}),g(m,"return",function(){var U=this;return new Promise(function(w,k){U[b].destroy(null,function(K){if(K){k(K);return}w(F(void 0,!0))})})}),m),x),M=function(U){var w,k=Object.create(B,(w={},g(w,b,{value:U,writable:!0}),g(w,_,{value:null,writable:!0}),g(w,S,{value:null,writable:!0}),g(w,E,{value:null,writable:!0}),g(w,T,{value:U._readableState.endEmitted,writable:!0}),g(w,R,{value:function(W,Y){var J=k[b].read();J?(k[C]=null,k[_]=null,k[S]=null,W(F(J,!1))):(k[_]=W,k[S]=Y)},writable:!0}),w));return k[C]=null,v(U,function(K){if(K&&K.code!=="ERR_STREAM_PREMATURE_CLOSE"){var W=k[S];W!==null&&(k[C]=null,k[_]=null,k[S]=null,W(K)),k[E]=K;return}var Y=k[_];Y!==null&&(k[C]=null,k[_]=null,k[S]=null,Y(F(void 0,!0))),k[T]=!0}),U.on("readable",L.bind(null,k)),k};h.exports=M},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/buffer_list.js":(h,f,d)=>{function m(L,D){var x=Object.keys(L);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(L);D&&(B=B.filter(function(M){return Object.getOwnPropertyDescriptor(L,M).enumerable})),x.push.apply(x,B)}return x}function g(L){for(var D=1;D<arguments.length;D++){var x=arguments[D]!=null?arguments[D]:{};D%2?m(Object(x),!0).forEach(function(B){v(L,B,x[B])}):Object.getOwnPropertyDescriptors?Object.defineProperties(L,Object.getOwnPropertyDescriptors(x)):m(Object(x)).forEach(function(B){Object.defineProperty(L,B,Object.getOwnPropertyDescriptor(x,B))})}return L}function v(L,D,x){return D in L?Object.defineProperty(L,D,{value:x,enumerable:!0,configurable:!0,writable:!0}):L[D]=x,L}function _(L,D){if(!(L instanceof D))throw new TypeError("Cannot call a class as a function")}function S(L,D){for(var x=0;x<D.length;x++){var B=D[x];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(L,B.key,B)}}function E(L,D,x){return D&&S(L.prototype,D),x&&S(L,x),L}var T=d("./node_modules/buffer/index.js"),C=T.Buffer,R=d("?3e83"),b=R.inspect,F=b&&b.custom||"inspect";function O(L,D,x){C.prototype.copy.call(L,D,x)}h.exports=function(){function L(){_(this,L),this.head=null,this.tail=null,this.length=0}return E(L,[{key:"push",value:function(x){var B={data:x,next:null};this.length>0?this.tail.next=B:this.head=B,this.tail=B,++this.length}},{key:"unshift",value:function(x){var B={data:x,next:this.head};this.length===0&&(this.tail=B),this.head=B,++this.length}},{key:"shift",value:function(){if(this.length!==0){var x=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,x}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(x){if(this.length===0)return"";for(var B=this.head,M=""+B.data;B=B.next;)M+=x+B.data;return M}},{key:"concat",value:function(x){if(this.length===0)return C.alloc(0);for(var B=C.allocUnsafe(x>>>0),M=this.head,I=0;M;)O(M.data,B,I),I+=M.data.length,M=M.next;return B}},{key:"consume",value:function(x,B){var M;return x<this.head.data.length?(M=this.head.data.slice(0,x),this.head.data=this.head.data.slice(x)):x===this.head.data.length?M=this.shift():M=B?this._getString(x):this._getBuffer(x),M}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(x){var B=this.head,M=1,I=B.data;for(x-=I.length;B=B.next;){var U=B.data,w=x>U.length?U.length:x;if(w===U.length?I+=U:I+=U.slice(0,x),x-=w,x===0){w===U.length?(++M,B.next?this.head=B.next:this.head=this.tail=null):(this.head=B,B.data=U.slice(w));break}++M}return this.length-=M,I}},{key:"_getBuffer",value:function(x){var B=C.allocUnsafe(x),M=this.head,I=1;for(M.data.copy(B),x-=M.data.length;M=M.next;){var U=M.data,w=x>U.length?U.length:x;if(U.copy(B,B.length-x,0,w),x-=w,x===0){w===U.length?(++I,M.next?this.head=M.next:this.head=this.tail=null):(this.head=M,M.data=U.slice(w));break}++I}return this.length-=I,B}},{key:F,value:function(x,B){return b(this,g({},B,{depth:0,customInspect:!1}))}}]),L}()},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/destroy.js":h=>{function f(S,E){var T=this,C=this._readableState&&this._readableState.destroyed,R=this._writableState&&this._writableState.destroyed;return C||R?(E?E(S):S&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(v,this,S)):process.nextTick(v,this,S)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(S||null,function(b){!E&&b?T._writableState?T._writableState.errorEmitted?process.nextTick(m,T):(T._writableState.errorEmitted=!0,process.nextTick(d,T,b)):process.nextTick(d,T,b):E?(process.nextTick(m,T),E(b)):process.nextTick(m,T)}),this)}function d(S,E){v(S,E),m(S)}function m(S){S._writableState&&!S._writableState.emitClose||S._readableState&&!S._readableState.emitClose||S.emit("close")}function g(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function v(S,E){S.emit("error",E)}function _(S,E){var T=S._readableState,C=S._writableState;T&&T.autoDestroy||C&&C.autoDestroy?S.destroy(E):S.emit("error",E)}h.exports={destroy:f,undestroy:g,errorOrDestroy:_}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js":(h,f,d)=>{var m=d("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes.ERR_STREAM_PREMATURE_CLOSE;function g(E){var T=!1;return function(){if(!T){T=!0;for(var C=arguments.length,R=new Array(C),b=0;b<C;b++)R[b]=arguments[b];E.apply(this,R)}}}function v(){}function _(E){return E.setHeader&&typeof E.abort=="function"}function S(E,T,C){if(typeof T=="function")return S(E,null,T);T||(T={}),C=g(C||v);var R=T.readable||T.readable!==!1&&E.readable,b=T.writable||T.writable!==!1&&E.writable,F=function(){E.writable||L()},O=E._writableState&&E._writableState.finished,L=function(){b=!1,O=!0,R||C.call(E)},D=E._readableState&&E._readableState.endEmitted,x=function(){R=!1,D=!0,b||C.call(E)},B=function(w){C.call(E,w)},M=function(){var w;if(R&&!D)return(!E._readableState||!E._readableState.ended)&&(w=new m),C.call(E,w);if(b&&!O)return(!E._writableState||!E._writableState.ended)&&(w=new m),C.call(E,w)},I=function(){E.req.on("finish",L)};return _(E)?(E.on("complete",L),E.on("abort",M),E.req?I():E.on("request",I)):b&&!E._writableState&&(E.on("end",F),E.on("close",F)),E.on("end",x),E.on("finish",L),T.error!==!1&&E.on("error",B),E.on("close",M),function(){E.removeListener("complete",L),E.removeListener("abort",M),E.removeListener("request",I),E.req&&E.req.removeListener("finish",L),E.removeListener("end",F),E.removeListener("close",F),E.removeListener("finish",L),E.removeListener("end",x),E.removeListener("error",B),E.removeListener("close",M)}}h.exports=S},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/from-browser.js":h=>{h.exports=function(){throw new Error("Readable.from is not available in the browser")}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/pipeline.js":(h,f,d)=>{var m;function g(L){var D=!1;return function(){D||(D=!0,L.apply(void 0,arguments))}}var v=d("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,_=v.ERR_MISSING_ARGS,S=v.ERR_STREAM_DESTROYED;function E(L){if(L)throw L}function T(L){return L.setHeader&&typeof L.abort=="function"}function C(L,D,x,B){B=g(B);var M=!1;L.on("close",function(){M=!0}),m===void 0&&(m=d("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js")),m(L,{readable:D,writable:x},function(U){if(U)return B(U);M=!0,B()});var I=!1;return function(U){if(!M&&!I){if(I=!0,T(L))return L.abort();if(typeof L.destroy=="function")return L.destroy();B(U||new S("pipe"))}}}function R(L){L()}function b(L,D){return L.pipe(D)}function F(L){return!L.length||typeof L[L.length-1]!="function"?E:L.pop()}function O(){for(var L=arguments.length,D=new Array(L),x=0;x<L;x++)D[x]=arguments[x];var B=F(D);if(Array.isArray(D[0])&&(D=D[0]),D.length<2)throw new _("streams");var M,I=D.map(function(U,w){var k=w<D.length-1,K=w>0;return C(U,k,K,function(W){M||(M=W),W&&I.forEach(R),!k&&(I.forEach(R),B(M))})});return D.reduce(b)}h.exports=O},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/state.js":(h,f,d)=>{var m=d("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes.ERR_INVALID_OPT_VALUE;function g(_,S,E){return _.highWaterMark!=null?_.highWaterMark:S?_[E]:null}function v(_,S,E,T){var C=g(S,T,E);if(C!=null){if(!(isFinite(C)&&Math.floor(C)===C)||C<0){var R=T?E:"highWaterMark";throw new m(R,C)}return Math.floor(C)}return _.objectMode?16:16384}h.exports={getHighWaterMark:v}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/stream-browser.js":(h,f,d)=>{h.exports=d("./node_modules/events/events.js").EventEmitter},"./node_modules/string_decoder/lib/string_decoder.js":(h,f,d)=>{var m=d("./node_modules/safe-buffer/index.js").Buffer,g=m.isEncoding||function(I){switch(I=""+I,I&&I.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function v(I){if(!I)return"utf8";for(var U;;)switch(I){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return I;default:if(U)return;I=(""+I).toLowerCase(),U=!0}}function _(I){var U=v(I);if(typeof U!="string"&&(m.isEncoding===g||!g(I)))throw new Error("Unknown encoding: "+I);return U||I}f.StringDecoder=S;function S(I){this.encoding=_(I);var U;switch(this.encoding){case"utf16le":this.text=O,this.end=L,U=4;break;case"utf8":this.fillLast=R,U=4;break;case"base64":this.text=D,this.end=x,U=3;break;default:this.write=B,this.end=M;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=m.allocUnsafe(U)}S.prototype.write=function(I){if(I.length===0)return"";var U,w;if(this.lastNeed){if(U=this.fillLast(I),U===void 0)return"";w=this.lastNeed,this.lastNeed=0}else w=0;return w<I.length?U?U+this.text(I,w):this.text(I,w):U||""},S.prototype.end=F,S.prototype.text=b,S.prototype.fillLast=function(I){if(this.lastNeed<=I.length)return I.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);I.copy(this.lastChar,this.lastTotal-this.lastNeed,0,I.length),this.lastNeed-=I.length};function E(I){return I<=127?0:I>>5===6?2:I>>4===14?3:I>>3===30?4:I>>6===2?-1:-2}function T(I,U,w){var k=U.length-1;if(k<w)return 0;var K=E(U[k]);return K>=0?(K>0&&(I.lastNeed=K-1),K):--k<w||K===-2?0:(K=E(U[k]),K>=0?(K>0&&(I.lastNeed=K-2),K):--k<w||K===-2?0:(K=E(U[k]),K>=0?(K>0&&(K===2?K=0:I.lastNeed=K-3),K):0))}function C(I,U,w){if((U[0]&192)!==128)return I.lastNeed=0,"�";if(I.lastNeed>1&&U.length>1){if((U[1]&192)!==128)return I.lastNeed=1,"�";if(I.lastNeed>2&&U.length>2&&(U[2]&192)!==128)return I.lastNeed=2,"�"}}function R(I){var U=this.lastTotal-this.lastNeed,w=C(this,I);if(w!==void 0)return w;if(this.lastNeed<=I.length)return I.copy(this.lastChar,U,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);I.copy(this.lastChar,U,0,I.length),this.lastNeed-=I.length}function b(I,U){var w=T(this,I,U);if(!this.lastNeed)return I.toString("utf8",U);this.lastTotal=w;var k=I.length-(w-this.lastNeed);return I.copy(this.lastChar,0,k),I.toString("utf8",U,k)}function F(I){var U=I&&I.length?this.write(I):"";return this.lastNeed?U+"�":U}function O(I,U){if((I.length-U)%2===0){var w=I.toString("utf16le",U);if(w){var k=w.charCodeAt(w.length-1);if(k>=55296&&k<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=I[I.length-2],this.lastChar[1]=I[I.length-1],w.slice(0,-1)}return w}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=I[I.length-1],I.toString("utf16le",U,I.length-1)}function L(I){var U=I&&I.length?this.write(I):"";if(this.lastNeed){var w=this.lastTotal-this.lastNeed;return U+this.lastChar.toString("utf16le",0,w)}return U}function D(I,U){var w=(I.length-U)%3;return w===0?I.toString("base64",U):(this.lastNeed=3-w,this.lastTotal=3,w===1?this.lastChar[0]=I[I.length-1]:(this.lastChar[0]=I[I.length-2],this.lastChar[1]=I[I.length-1]),I.toString("base64",U,I.length-w))}function x(I){var U=I&&I.length?this.write(I):"";return this.lastNeed?U+this.lastChar.toString("base64",0,3-this.lastNeed):U}function B(I){return I.toString(this.encoding)}function M(I){return I&&I.length?this.write(I):""}},"./node_modules/ua-parser-js/src/ua-parser.js":function(h,f,d){var m;(function(g,v){var _="1.0.2",S="",E="?",T="function",C="undefined",R="object",b="string",F="major",O="model",L="name",D="type",x="vendor",B="version",M="architecture",I="console",U="mobile",w="tablet",k="smarttv",K="wearable",W="embedded",Y=255,J="Amazon",ee="Apple",ue="ASUS",ie="BlackBerry",Q="Browser",se="Chrome",ve="Edge",_e="Firefox",Z="Google",Ee="Huawei",Se="LG",Me="Microsoft",de="Motorola",xe="Opera",Fe="Samsung",Le="Sony",De="Xiaomi",Ae="Zebra",ge="Facebook",pe=function(he,Ue){var we={};for(var $e in he)Ue[$e]&&Ue[$e].length%2===0?we[$e]=Ue[$e].concat(he[$e]):we[$e]=he[$e];return we},Re=function(he){for(var Ue={},we=0;we<he.length;we++)Ue[he[we].toUpperCase()]=he[we];return Ue},me=function(he,Ue){return typeof he===b?V(Ue).indexOf(V(he))!==-1:!1},V=function(he){return he.toLowerCase()},j=function(he){return typeof he===b?he.replace(/[^\d\.]/g,S).split(".")[0]:v},$=function(he,Ue){if(typeof he===b)return he=he.replace(/^\s\s*/,S).replace(/\s\s*$/,S),typeof Ue===C?he:he.substring(0,Y)},re=function(he,Ue){for(var we=0,$e,it,mt,pt,Pt,lt;we<Ue.length&&!Pt;){var Ye=Ue[we],st=Ue[we+1];for($e=it=0;$e<Ye.length&&!Pt;)if(Pt=Ye[$e++].exec(he),Pt)for(mt=0;mt<st.length;mt++)lt=Pt[++it],pt=st[mt],typeof pt===R&&pt.length>0?pt.length===2?typeof pt[1]==T?this[pt[0]]=pt[1].call(this,lt):this[pt[0]]=pt[1]:pt.length===3?typeof pt[1]===T&&!(pt[1].exec&&pt[1].test)?this[pt[0]]=lt?pt[1].call(this,lt,pt[2]):v:this[pt[0]]=lt?lt.replace(pt[1],pt[2]):v:pt.length===4&&(this[pt[0]]=lt?pt[3].call(this,lt.replace(pt[1],pt[2])):v):this[pt]=lt||v;we+=2}},oe=function(he,Ue){for(var we in Ue)if(typeof Ue[we]===R&&Ue[we].length>0){for(var $e=0;$e<Ue[we].length;$e++)if(me(Ue[we][$e],he))return we===E?v:we}else if(me(Ue[we],he))return we===E?v:we;return he},X={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},z={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},ne={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[B,[L,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[B,[L,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[L,B],[/opios[\/ ]+([\w\.]+)/i],[B,[L,xe+" Mini"]],[/\bopr\/([\w\.]+)/i],[B,[L,xe]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[L,B],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[B,[L,"UC"+Q]],[/\bqbcore\/([\w\.]+)/i],[B,[L,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[B,[L,"WeChat"]],[/konqueror\/([\w\.]+)/i],[B,[L,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[B,[L,"IE"]],[/yabrowser\/([\w\.]+)/i],[B,[L,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[L,/(.+)/,"$1 Secure "+Q],B],[/\bfocus\/([\w\.]+)/i],[B,[L,_e+" Focus"]],[/\bopt\/([\w\.]+)/i],[B,[L,xe+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[B,[L,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[B,[L,"Dolphin"]],[/coast\/([\w\.]+)/i],[B,[L,xe+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[B,[L,"MIUI "+Q]],[/fxios\/([-\w\.]+)/i],[B,[L,_e]],[/\bqihu|(qi?ho?o?|360)browser/i],[[L,"360 "+Q]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[L,/(.+)/,"$1 "+Q],B],[/(comodo_dragon)\/([\w\.]+)/i],[[L,/_/g," "],B],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[L,B],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[L],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[L,ge],B],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[L,B],[/\bgsa\/([\w\.]+) .*safari\//i],[B,[L,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[B,[L,se+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[L,se+" WebView"],B],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[B,[L,"Android "+Q]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[L,B],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[B,[L,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[B,L],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[L,[B,oe,X]],[/(webkit|khtml)\/([\w\.]+)/i],[L,B],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[L,"Netscape"],B],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[B,[L,_e+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[L,B]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[M,"amd64"]],[/(ia32(?=;))/i],[[M,V]],[/((?:i[346]|x)86)[;\)]/i],[[M,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[M,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[M,"armhf"]],[/windows (ce|mobile); ppc;/i],[[M,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[M,/ower/,S,V]],[/(sun4\w)[;\)]/i],[[M,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[M,V]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[O,[x,Fe],[D,w]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[O,[x,Fe],[D,U]],[/\((ip(?:hone|od)[\w ]*);/i],[O,[x,ee],[D,U]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[O,[x,ee],[D,w]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[O,[x,Ee],[D,w]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[O,[x,Ee],[D,U]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[O,/_/g," "],[x,De],[D,U]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[O,/_/g," "],[x,De],[D,w]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[O,[x,"OPPO"],[D,U]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[O,[x,"Vivo"],[D,U]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[O,[x,"Realme"],[D,U]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[O,[x,de],[D,U]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[O,[x,de],[D,w]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[O,[x,Se],[D,w]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[O,[x,Se],[D,U]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[O,[x,"Lenovo"],[D,w]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[O,/_/g," "],[x,"Nokia"],[D,U]],[/(pixel c)\b/i],[O,[x,Z],[D,w]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[O,[x,Z],[D,U]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[O,[x,Le],[D,U]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[O,"Xperia Tablet"],[x,Le],[D,w]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[O,[x,"OnePlus"],[D,U]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[O,[x,J],[D,w]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[O,/(.+)/g,"Fire Phone $1"],[x,J],[D,U]],[/(playbook);[-\w\),; ]+(rim)/i],[O,x,[D,w]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[O,[x,ie],[D,U]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[O,[x,ue],[D,w]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[O,[x,ue],[D,U]],[/(nexus 9)/i],[O,[x,"HTC"],[D,w]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[x,[O,/_/g," "],[D,U]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[O,[x,"Acer"],[D,w]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[O,[x,"Meizu"],[D,U]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[O,[x,"Sharp"],[D,U]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[x,O,[D,U]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[x,O,[D,w]],[/(surface duo)/i],[O,[x,Me],[D,w]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[O,[x,"Fairphone"],[D,U]],[/(u304aa)/i],[O,[x,"AT&T"],[D,U]],[/\bsie-(\w*)/i],[O,[x,"Siemens"],[D,U]],[/\b(rct\w+) b/i],[O,[x,"RCA"],[D,w]],[/\b(venue[\d ]{2,7}) b/i],[O,[x,"Dell"],[D,w]],[/\b(q(?:mv|ta)\w+) b/i],[O,[x,"Verizon"],[D,w]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[O,[x,"Barnes & Noble"],[D,w]],[/\b(tm\d{3}\w+) b/i],[O,[x,"NuVision"],[D,w]],[/\b(k88) b/i],[O,[x,"ZTE"],[D,w]],[/\b(nx\d{3}j) b/i],[O,[x,"ZTE"],[D,U]],[/\b(gen\d{3}) b.+49h/i],[O,[x,"Swiss"],[D,U]],[/\b(zur\d{3}) b/i],[O,[x,"Swiss"],[D,w]],[/\b((zeki)?tb.*\b) b/i],[O,[x,"Zeki"],[D,w]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[x,"Dragon Touch"],O,[D,w]],[/\b(ns-?\w{0,9}) b/i],[O,[x,"Insignia"],[D,w]],[/\b((nxa|next)-?\w{0,9}) b/i],[O,[x,"NextBook"],[D,w]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[x,"Voice"],O,[D,U]],[/\b(lvtel\-)?(v1[12]) b/i],[[x,"LvTel"],O,[D,U]],[/\b(ph-1) /i],[O,[x,"Essential"],[D,U]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[O,[x,"Envizen"],[D,w]],[/\b(trio[-\w\. ]+) b/i],[O,[x,"MachSpeed"],[D,w]],[/\btu_(1491) b/i],[O,[x,"Rotor"],[D,w]],[/(shield[\w ]+) b/i],[O,[x,"Nvidia"],[D,w]],[/(sprint) (\w+)/i],[x,O,[D,U]],[/(kin\.[onetw]{3})/i],[[O,/\./g," "],[x,Me],[D,U]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[O,[x,Ae],[D,w]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[O,[x,Ae],[D,U]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[x,O,[D,I]],[/droid.+; (shield) bui/i],[O,[x,"Nvidia"],[D,I]],[/(playstation [345portablevi]+)/i],[O,[x,Le],[D,I]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[O,[x,Me],[D,I]],[/smart-tv.+(samsung)/i],[x,[D,k]],[/hbbtv.+maple;(\d+)/i],[[O,/^/,"SmartTV"],[x,Fe],[D,k]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[x,Se],[D,k]],[/(apple) ?tv/i],[x,[O,ee+" TV"],[D,k]],[/crkey/i],[[O,se+"cast"],[x,Z],[D,k]],[/droid.+aft(\w)( bui|\))/i],[O,[x,J],[D,k]],[/\(dtv[\);].+(aquos)/i],[O,[x,"Sharp"],[D,k]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[x,$],[O,$],[D,k]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[D,k]],[/((pebble))app/i],[x,O,[D,K]],[/droid.+; (glass) \d/i],[O,[x,Z],[D,K]],[/droid.+; (wt63?0{2,3})\)/i],[O,[x,Ae],[D,K]],[/(quest( 2)?)/i],[O,[x,ge],[D,K]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[x,[D,W]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[O,[D,U]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[O,[D,w]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[D,w]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[D,U]],[/(android[-\w\. ]{0,9});.+buil/i],[O,[x,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[B,[L,ve+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[B,[L,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[L,B],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[B,L]],os:[[/microsoft (windows) (vista|xp)/i],[L,B],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[L,[B,oe,z]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[L,"Windows"],[B,oe,z]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[B,/_/g,"."],[L,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[L,"Mac OS"],[B,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[B,L],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[L,B],[/\(bb(10);/i],[B,[L,ie]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[B,[L,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[B,[L,_e+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[B,[L,"webOS"]],[/crkey\/([\d\.]+)/i],[B,[L,se+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[L,"Chromium OS"],B],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[L,B],[/(sunos) ?([\w\.\d]*)/i],[[L,"Solaris"],B],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[L,B]]},fe=function(he,Ue){if(typeof he===R&&(Ue=he,he=v),!(this instanceof fe))return new fe(he,Ue).getResult();var we=he||(typeof g!==C&&g.navigator&&g.navigator.userAgent?g.navigator.userAgent:S),$e=Ue?pe(ne,Ue):ne;return this.getBrowser=function(){var it={};return it[L]=v,it[B]=v,re.call(it,we,$e.browser),it.major=j(it.version),it},this.getCPU=function(){var it={};return it[M]=v,re.call(it,we,$e.cpu),it},this.getDevice=function(){var it={};return it[x]=v,it[O]=v,it[D]=v,re.call(it,we,$e.device),it},this.getEngine=function(){var it={};return it[L]=v,it[B]=v,re.call(it,we,$e.engine),it},this.getOS=function(){var it={};return it[L]=v,it[B]=v,re.call(it,we,$e.os),it},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return we},this.setUA=function(it){return we=typeof it===b&&it.length>Y?$(it,Y):it,this},this.setUA(we),this};fe.VERSION=_,fe.BROWSER=Re([L,B,F]),fe.CPU=Re([M]),fe.DEVICE=Re([O,x,D,I,U,k,w,K,W]),fe.ENGINE=fe.OS=Re([L,B]),typeof f!==C?(h.exports&&(f=h.exports=fe),f.UAParser=fe):d.amdO?(m=function(){return fe}.call(f,d,f,h),m!==v&&(h.exports=m)):typeof g!==C&&(g.UAParser=fe);var Ce=typeof g!==C&&(g.jQuery||g.Zepto);if(Ce&&!Ce.ua){var Pe=new fe;Ce.ua=Pe.getResult(),Ce.ua.get=function(){return Pe.getUA()},Ce.ua.set=function(he){Pe.setUA(he);var Ue=Pe.getResult();for(var we in Ue)Ce.ua[we]=Ue[we]}}})(typeof window=="object"?window:this)},"./node_modules/util-deprecate/browser.js":(h,f,d)=>{h.exports=m;function m(v,_){if(g("noDeprecation"))return v;var S=!1;function E(){if(!S){if(g("throwDeprecation"))throw new Error(_);g("traceDeprecation")?console.trace(_):console.warn(_),S=!0}return v.apply(this,arguments)}return E}function g(v){try{if(!d.g.localStorage)return!1}catch{return!1}var _=d.g.localStorage[v];return _==null?!1:String(_).toLowerCase()==="true"}},"?3e83":()=>{},"?19e6":()=>{},"./node_modules/bcp-47-normalize/lib/defaults.json":h=>{h.exports=JSON.parse('["mni-beng-in","mni-mtei-in","sat-deva-in","sat-olck-in","shi-latn-ma","shi-tfng-ma","vai-latn-lr","vai-vaii-lr","yue-hans-cn","yue-hant-hk","az-arab-ir","az-cyrl-az","az-latn-az","bm-nkoo-ml","bs-cyrl-ba","bs-latn-ba","en-dsrt-us","ff-adlm-gn","ff-latn-sn","ha-arab-ng","hi-latn-in","iu-latn-ca","ks-arab-in","ks-deva-in","mn-mong-cn","ms-arab-my","pa-arab-pk","pa-guru-in","sd-arab-pk","sd-deva-in","sr-cyrl-rs","sr-latn-rs","su-latn-id","uz-arab-af","uz-cyrl-uz","uz-latn-uz","zh-hans-cn","zh-hant-tw","mni-beng","sat-olck","shi-tfng","vai-vaii","yue-hant","az-latn","bs-latn","ff-latn","jbo-001","ks-arab","pa-guru","prg-001","sd-arab","sr-cyrl","su-latn","uz-latn","zh-hans","agq-cm","ar-001","arn-cl","asa-tz","ast-es","bas-cm","bem-zm","bez-tz","bgn-pk","blt-vn","brx-in","bss-cm","byn-er","cad-us","cch-ng","ccp-bd","ceb-ph","cgg-ug","chr-us","cic-us","ckb-iq","dav-ke","dje-ne","doi-in","dsb-de","dua-cm","dyo-sn","ebu-ke","eo-001","ewo-cm","fil-ph","fur-it","gaa-gh","gez-et","gsw-ch","guz-ke","haw-us","hsb-de","ia-001","ife-tg","io-001","jgo-cm","jmc-tz","kab-dz","kaj-ng","kam-ke","kcg-ng","kde-tz","kea-cv","ken-cm","khq-ml","kkj-cm","kln-ke","kok-in","kpe-lr","ksb-tz","ksf-cm","ksh-de","lag-tz","lkt-us","lrc-ir","luo-ke","luy-ke","mai-in","mas-ke","mer-ke","mfe-mu","mgh-mz","mgo-cm","moh-ca","mua-cm","mus-us","myv-ru","mzn-ir","naq-na","nds-de","nmg-cm","nnh-cm","nqo-gn","nso-za","nus-ss","nyn-ug","osa-us","pcm-ng","quc-gt","rof-tz","rwk-tz","sah-ru","saq-ke","sbp-tz","scn-it","sdh-ir","seh-mz","ses-ml","sid-et","sma-se","smj-se","smn-fi","sms-fi","ssy-er","syr-iq","szl-pl","teo-ug","tig-er","trv-tw","trw-pk","twq-ne","tzm-ma","vo-001","vun-tz","wae-ch","wal-et","wbp-au","xog-ug","yav-cm","yi-001","zgh-ma","aa-et","af-za","ak-gh","am-et","an-es","as-in","ba-ru","be-by","bg-bg","bm-ml","bn-bd","bo-cn","br-fr","ca-es","ce-ru","co-fr","cs-cz","cu-ru","cv-ru","cy-gb","da-dk","de-de","dv-mv","dz-bt","ee-gh","el-gr","en-us","es-es","et-ee","eu-es","fa-ir","fi-fi","fo-fo","fr-fr","fy-nl","ga-ie","gd-gb","gl-es","gn-py","gu-in","gv-im","ha-ng","he-il","hi-in","hr-hr","hu-hu","hy-am","id-id","ig-ng","ii-cn","is-is","it-it","iu-ca","ja-jp","jv-id","ka-ge","ki-ke","kk-kz","kl-gl","km-kh","kn-in","ko-kr","ku-tr","kw-gb","ky-kg","lb-lu","lg-ug","ln-cd","lo-la","lt-lt","lu-cd","lv-lv","mg-mg","mi-nz","mk-mk","ml-in","mn-mn","mr-in","ms-my","mt-mt","my-mm","nb-no","nd-zw","ne-np","nl-nl","nn-no","nr-za","nv-us","ny-mw","oc-fr","om-et","or-in","os-ge","pl-pl","ps-af","pt-br","qu-pe","rm-ch","rn-bi","ro-ro","ru-ru","rw-rw","sa-in","sc-it","se-no","sg-cf","si-lk","sk-sk","sl-si","sn-zw","so-so","sq-al","ss-za","st-za","sv-se","sw-tz","ta-in","te-in","tg-tj","th-th","ti-et","tk-tm","tn-za","to-to","tr-tr","ts-za","tt-ru","ug-cn","uk-ua","ur-pk","ve-za","vi-vn","wa-be","wo-sn","xh-za","yo-ng","zu-za"]')},"./node_modules/bcp-47-normalize/lib/fields.json":h=>{h.exports=JSON.parse('[{"from":{"field":"script","value":"qaai"},"to":{"field":"script","value":"zinh"}},{"from":{"field":"region","value":"bu"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"ct"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"dd"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"dy"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"fx"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"hv"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"jt"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"mi"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"nh"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"nq"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"pu"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"pz"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"qu"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"rh"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"tp"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"uk"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"vd"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"wk"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"yd"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"zr"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"230"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"280"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"736"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"886"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"958"},"to":{"field":"region","value":"aa"}},{"from":{"field":"region","value":"020"},"to":{"field":"region","value":"ad"}},{"from":{"field":"region","value":"784"},"to":{"field":"region","value":"ae"}},{"from":{"field":"region","value":"004"},"to":{"field":"region","value":"af"}},{"from":{"field":"region","value":"028"},"to":{"field":"region","value":"ag"}},{"from":{"field":"region","value":"660"},"to":{"field":"region","value":"ai"}},{"from":{"field":"region","value":"008"},"to":{"field":"region","value":"al"}},{"from":{"field":"region","value":"051"},"to":{"field":"region","value":"am"}},{"from":{"field":"region","value":"024"},"to":{"field":"region","value":"ao"}},{"from":{"field":"region","value":"010"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"032"},"to":{"field":"region","value":"ar"}},{"from":{"field":"region","value":"016"},"to":{"field":"region","value":"as"}},{"from":{"field":"region","value":"040"},"to":{"field":"region","value":"at"}},{"from":{"field":"region","value":"036"},"to":{"field":"region","value":"au"}},{"from":{"field":"region","value":"533"},"to":{"field":"region","value":"aw"}},{"from":{"field":"region","value":"248"},"to":{"field":"region","value":"ax"}},{"from":{"field":"region","value":"031"},"to":{"field":"region","value":"az"}},{"from":{"field":"region","value":"070"},"to":{"field":"region","value":"ba"}},{"from":{"field":"region","value":"052"},"to":{"field":"region","value":"bb"}},{"from":{"field":"region","value":"050"},"to":{"field":"region","value":"bd"}},{"from":{"field":"region","value":"056"},"to":{"field":"region","value":"be"}},{"from":{"field":"region","value":"854"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"100"},"to":{"field":"region","value":"bg"}},{"from":{"field":"region","value":"048"},"to":{"field":"region","value":"bh"}},{"from":{"field":"region","value":"108"},"to":{"field":"region","value":"bi"}},{"from":{"field":"region","value":"204"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"652"},"to":{"field":"region","value":"bl"}},{"from":{"field":"region","value":"060"},"to":{"field":"region","value":"bm"}},{"from":{"field":"region","value":"096"},"to":{"field":"region","value":"bn"}},{"from":{"field":"region","value":"068"},"to":{"field":"region","value":"bo"}},{"from":{"field":"region","value":"535"},"to":{"field":"region","value":"bq"}},{"from":{"field":"region","value":"076"},"to":{"field":"region","value":"br"}},{"from":{"field":"region","value":"044"},"to":{"field":"region","value":"bs"}},{"from":{"field":"region","value":"064"},"to":{"field":"region","value":"bt"}},{"from":{"field":"region","value":"104"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"074"},"to":{"field":"region","value":"bv"}},{"from":{"field":"region","value":"072"},"to":{"field":"region","value":"bw"}},{"from":{"field":"region","value":"112"},"to":{"field":"region","value":"by"}},{"from":{"field":"region","value":"084"},"to":{"field":"region","value":"bz"}},{"from":{"field":"region","value":"124"},"to":{"field":"region","value":"ca"}},{"from":{"field":"region","value":"166"},"to":{"field":"region","value":"cc"}},{"from":{"field":"region","value":"180"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"140"},"to":{"field":"region","value":"cf"}},{"from":{"field":"region","value":"178"},"to":{"field":"region","value":"cg"}},{"from":{"field":"region","value":"756"},"to":{"field":"region","value":"ch"}},{"from":{"field":"region","value":"384"},"to":{"field":"region","value":"ci"}},{"from":{"field":"region","value":"184"},"to":{"field":"region","value":"ck"}},{"from":{"field":"region","value":"152"},"to":{"field":"region","value":"cl"}},{"from":{"field":"region","value":"120"},"to":{"field":"region","value":"cm"}},{"from":{"field":"region","value":"156"},"to":{"field":"region","value":"cn"}},{"from":{"field":"region","value":"170"},"to":{"field":"region","value":"co"}},{"from":{"field":"region","value":"188"},"to":{"field":"region","value":"cr"}},{"from":{"field":"region","value":"192"},"to":{"field":"region","value":"cu"}},{"from":{"field":"region","value":"132"},"to":{"field":"region","value":"cv"}},{"from":{"field":"region","value":"531"},"to":{"field":"region","value":"cw"}},{"from":{"field":"region","value":"162"},"to":{"field":"region","value":"cx"}},{"from":{"field":"region","value":"196"},"to":{"field":"region","value":"cy"}},{"from":{"field":"region","value":"203"},"to":{"field":"region","value":"cz"}},{"from":{"field":"region","value":"278"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"276"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"262"},"to":{"field":"region","value":"dj"}},{"from":{"field":"region","value":"208"},"to":{"field":"region","value":"dk"}},{"from":{"field":"region","value":"212"},"to":{"field":"region","value":"dm"}},{"from":{"field":"region","value":"214"},"to":{"field":"region","value":"do"}},{"from":{"field":"region","value":"012"},"to":{"field":"region","value":"dz"}},{"from":{"field":"region","value":"218"},"to":{"field":"region","value":"ec"}},{"from":{"field":"region","value":"233"},"to":{"field":"region","value":"ee"}},{"from":{"field":"region","value":"818"},"to":{"field":"region","value":"eg"}},{"from":{"field":"region","value":"732"},"to":{"field":"region","value":"eh"}},{"from":{"field":"region","value":"232"},"to":{"field":"region","value":"er"}},{"from":{"field":"region","value":"724"},"to":{"field":"region","value":"es"}},{"from":{"field":"region","value":"231"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"246"},"to":{"field":"region","value":"fi"}},{"from":{"field":"region","value":"242"},"to":{"field":"region","value":"fj"}},{"from":{"field":"region","value":"238"},"to":{"field":"region","value":"fk"}},{"from":{"field":"region","value":"583"},"to":{"field":"region","value":"fm"}},{"from":{"field":"region","value":"234"},"to":{"field":"region","value":"fo"}},{"from":{"field":"region","value":"250"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"249"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"266"},"to":{"field":"region","value":"ga"}},{"from":{"field":"region","value":"826"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"308"},"to":{"field":"region","value":"gd"}},{"from":{"field":"region","value":"268"},"to":{"field":"region","value":"ge"}},{"from":{"field":"region","value":"254"},"to":{"field":"region","value":"gf"}},{"from":{"field":"region","value":"831"},"to":{"field":"region","value":"gg"}},{"from":{"field":"region","value":"288"},"to":{"field":"region","value":"gh"}},{"from":{"field":"region","value":"292"},"to":{"field":"region","value":"gi"}},{"from":{"field":"region","value":"304"},"to":{"field":"region","value":"gl"}},{"from":{"field":"region","value":"270"},"to":{"field":"region","value":"gm"}},{"from":{"field":"region","value":"324"},"to":{"field":"region","value":"gn"}},{"from":{"field":"region","value":"312"},"to":{"field":"region","value":"gp"}},{"from":{"field":"region","value":"226"},"to":{"field":"region","value":"gq"}},{"from":{"field":"region","value":"300"},"to":{"field":"region","value":"gr"}},{"from":{"field":"region","value":"239"},"to":{"field":"region","value":"gs"}},{"from":{"field":"region","value":"320"},"to":{"field":"region","value":"gt"}},{"from":{"field":"region","value":"316"},"to":{"field":"region","value":"gu"}},{"from":{"field":"region","value":"624"},"to":{"field":"region","value":"gw"}},{"from":{"field":"region","value":"328"},"to":{"field":"region","value":"gy"}},{"from":{"field":"region","value":"344"},"to":{"field":"region","value":"hk"}},{"from":{"field":"region","value":"334"},"to":{"field":"region","value":"hm"}},{"from":{"field":"region","value":"340"},"to":{"field":"region","value":"hn"}},{"from":{"field":"region","value":"191"},"to":{"field":"region","value":"hr"}},{"from":{"field":"region","value":"332"},"to":{"field":"region","value":"ht"}},{"from":{"field":"region","value":"348"},"to":{"field":"region","value":"hu"}},{"from":{"field":"region","value":"360"},"to":{"field":"region","value":"id"}},{"from":{"field":"region","value":"372"},"to":{"field":"region","value":"ie"}},{"from":{"field":"region","value":"376"},"to":{"field":"region","value":"il"}},{"from":{"field":"region","value":"833"},"to":{"field":"region","value":"im"}},{"from":{"field":"region","value":"356"},"to":{"field":"region","value":"in"}},{"from":{"field":"region","value":"086"},"to":{"field":"region","value":"io"}},{"from":{"field":"region","value":"368"},"to":{"field":"region","value":"iq"}},{"from":{"field":"region","value":"364"},"to":{"field":"region","value":"ir"}},{"from":{"field":"region","value":"352"},"to":{"field":"region","value":"is"}},{"from":{"field":"region","value":"380"},"to":{"field":"region","value":"it"}},{"from":{"field":"region","value":"832"},"to":{"field":"region","value":"je"}},{"from":{"field":"region","value":"388"},"to":{"field":"region","value":"jm"}},{"from":{"field":"region","value":"400"},"to":{"field":"region","value":"jo"}},{"from":{"field":"region","value":"392"},"to":{"field":"region","value":"jp"}},{"from":{"field":"region","value":"404"},"to":{"field":"region","value":"ke"}},{"from":{"field":"region","value":"417"},"to":{"field":"region","value":"kg"}},{"from":{"field":"region","value":"116"},"to":{"field":"region","value":"kh"}},{"from":{"field":"region","value":"296"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"174"},"to":{"field":"region","value":"km"}},{"from":{"field":"region","value":"659"},"to":{"field":"region","value":"kn"}},{"from":{"field":"region","value":"408"},"to":{"field":"region","value":"kp"}},{"from":{"field":"region","value":"410"},"to":{"field":"region","value":"kr"}},{"from":{"field":"region","value":"414"},"to":{"field":"region","value":"kw"}},{"from":{"field":"region","value":"136"},"to":{"field":"region","value":"ky"}},{"from":{"field":"region","value":"398"},"to":{"field":"region","value":"kz"}},{"from":{"field":"region","value":"418"},"to":{"field":"region","value":"la"}},{"from":{"field":"region","value":"422"},"to":{"field":"region","value":"lb"}},{"from":{"field":"region","value":"662"},"to":{"field":"region","value":"lc"}},{"from":{"field":"region","value":"438"},"to":{"field":"region","value":"li"}},{"from":{"field":"region","value":"144"},"to":{"field":"region","value":"lk"}},{"from":{"field":"region","value":"430"},"to":{"field":"region","value":"lr"}},{"from":{"field":"region","value":"426"},"to":{"field":"region","value":"ls"}},{"from":{"field":"region","value":"440"},"to":{"field":"region","value":"lt"}},{"from":{"field":"region","value":"442"},"to":{"field":"region","value":"lu"}},{"from":{"field":"region","value":"428"},"to":{"field":"region","value":"lv"}},{"from":{"field":"region","value":"434"},"to":{"field":"region","value":"ly"}},{"from":{"field":"region","value":"504"},"to":{"field":"region","value":"ma"}},{"from":{"field":"region","value":"492"},"to":{"field":"region","value":"mc"}},{"from":{"field":"region","value":"498"},"to":{"field":"region","value":"md"}},{"from":{"field":"region","value":"499"},"to":{"field":"region","value":"me"}},{"from":{"field":"region","value":"663"},"to":{"field":"region","value":"mf"}},{"from":{"field":"region","value":"450"},"to":{"field":"region","value":"mg"}},{"from":{"field":"region","value":"584"},"to":{"field":"region","value":"mh"}},{"from":{"field":"region","value":"807"},"to":{"field":"region","value":"mk"}},{"from":{"field":"region","value":"466"},"to":{"field":"region","value":"ml"}},{"from":{"field":"region","value":"496"},"to":{"field":"region","value":"mn"}},{"from":{"field":"region","value":"446"},"to":{"field":"region","value":"mo"}},{"from":{"field":"region","value":"580"},"to":{"field":"region","value":"mp"}},{"from":{"field":"region","value":"474"},"to":{"field":"region","value":"mq"}},{"from":{"field":"region","value":"478"},"to":{"field":"region","value":"mr"}},{"from":{"field":"region","value":"500"},"to":{"field":"region","value":"ms"}},{"from":{"field":"region","value":"470"},"to":{"field":"region","value":"mt"}},{"from":{"field":"region","value":"480"},"to":{"field":"region","value":"mu"}},{"from":{"field":"region","value":"462"},"to":{"field":"region","value":"mv"}},{"from":{"field":"region","value":"454"},"to":{"field":"region","value":"mw"}},{"from":{"field":"region","value":"484"},"to":{"field":"region","value":"mx"}},{"from":{"field":"region","value":"458"},"to":{"field":"region","value":"my"}},{"from":{"field":"region","value":"508"},"to":{"field":"region","value":"mz"}},{"from":{"field":"region","value":"516"},"to":{"field":"region","value":"na"}},{"from":{"field":"region","value":"540"},"to":{"field":"region","value":"nc"}},{"from":{"field":"region","value":"562"},"to":{"field":"region","value":"ne"}},{"from":{"field":"region","value":"574"},"to":{"field":"region","value":"nf"}},{"from":{"field":"region","value":"566"},"to":{"field":"region","value":"ng"}},{"from":{"field":"region","value":"558"},"to":{"field":"region","value":"ni"}},{"from":{"field":"region","value":"528"},"to":{"field":"region","value":"nl"}},{"from":{"field":"region","value":"578"},"to":{"field":"region","value":"no"}},{"from":{"field":"region","value":"524"},"to":{"field":"region","value":"np"}},{"from":{"field":"region","value":"520"},"to":{"field":"region","value":"nr"}},{"from":{"field":"region","value":"570"},"to":{"field":"region","value":"nu"}},{"from":{"field":"region","value":"554"},"to":{"field":"region","value":"nz"}},{"from":{"field":"region","value":"512"},"to":{"field":"region","value":"om"}},{"from":{"field":"region","value":"591"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"604"},"to":{"field":"region","value":"pe"}},{"from":{"field":"region","value":"258"},"to":{"field":"region","value":"pf"}},{"from":{"field":"region","value":"598"},"to":{"field":"region","value":"pg"}},{"from":{"field":"region","value":"608"},"to":{"field":"region","value":"ph"}},{"from":{"field":"region","value":"586"},"to":{"field":"region","value":"pk"}},{"from":{"field":"region","value":"616"},"to":{"field":"region","value":"pl"}},{"from":{"field":"region","value":"666"},"to":{"field":"region","value":"pm"}},{"from":{"field":"region","value":"612"},"to":{"field":"region","value":"pn"}},{"from":{"field":"region","value":"630"},"to":{"field":"region","value":"pr"}},{"from":{"field":"region","value":"275"},"to":{"field":"region","value":"ps"}},{"from":{"field":"region","value":"620"},"to":{"field":"region","value":"pt"}},{"from":{"field":"region","value":"585"},"to":{"field":"region","value":"pw"}},{"from":{"field":"region","value":"600"},"to":{"field":"region","value":"py"}},{"from":{"field":"region","value":"634"},"to":{"field":"region","value":"qa"}},{"from":{"field":"region","value":"959"},"to":{"field":"region","value":"qm"}},{"from":{"field":"region","value":"960"},"to":{"field":"region","value":"qn"}},{"from":{"field":"region","value":"962"},"to":{"field":"region","value":"qp"}},{"from":{"field":"region","value":"963"},"to":{"field":"region","value":"qq"}},{"from":{"field":"region","value":"964"},"to":{"field":"region","value":"qr"}},{"from":{"field":"region","value":"965"},"to":{"field":"region","value":"qs"}},{"from":{"field":"region","value":"966"},"to":{"field":"region","value":"qt"}},{"from":{"field":"region","value":"967"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"968"},"to":{"field":"region","value":"qv"}},{"from":{"field":"region","value":"969"},"to":{"field":"region","value":"qw"}},{"from":{"field":"region","value":"970"},"to":{"field":"region","value":"qx"}},{"from":{"field":"region","value":"971"},"to":{"field":"region","value":"qy"}},{"from":{"field":"region","value":"972"},"to":{"field":"region","value":"qz"}},{"from":{"field":"region","value":"638"},"to":{"field":"region","value":"re"}},{"from":{"field":"region","value":"642"},"to":{"field":"region","value":"ro"}},{"from":{"field":"region","value":"688"},"to":{"field":"region","value":"rs"}},{"from":{"field":"region","value":"643"},"to":{"field":"region","value":"ru"}},{"from":{"field":"region","value":"646"},"to":{"field":"region","value":"rw"}},{"from":{"field":"region","value":"682"},"to":{"field":"region","value":"sa"}},{"from":{"field":"region","value":"090"},"to":{"field":"region","value":"sb"}},{"from":{"field":"region","value":"690"},"to":{"field":"region","value":"sc"}},{"from":{"field":"region","value":"729"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"752"},"to":{"field":"region","value":"se"}},{"from":{"field":"region","value":"702"},"to":{"field":"region","value":"sg"}},{"from":{"field":"region","value":"654"},"to":{"field":"region","value":"sh"}},{"from":{"field":"region","value":"705"},"to":{"field":"region","value":"si"}},{"from":{"field":"region","value":"744"},"to":{"field":"region","value":"sj"}},{"from":{"field":"region","value":"703"},"to":{"field":"region","value":"sk"}},{"from":{"field":"region","value":"694"},"to":{"field":"region","value":"sl"}},{"from":{"field":"region","value":"674"},"to":{"field":"region","value":"sm"}},{"from":{"field":"region","value":"686"},"to":{"field":"region","value":"sn"}},{"from":{"field":"region","value":"706"},"to":{"field":"region","value":"so"}},{"from":{"field":"region","value":"740"},"to":{"field":"region","value":"sr"}},{"from":{"field":"region","value":"728"},"to":{"field":"region","value":"ss"}},{"from":{"field":"region","value":"678"},"to":{"field":"region","value":"st"}},{"from":{"field":"region","value":"222"},"to":{"field":"region","value":"sv"}},{"from":{"field":"region","value":"534"},"to":{"field":"region","value":"sx"}},{"from":{"field":"region","value":"760"},"to":{"field":"region","value":"sy"}},{"from":{"field":"region","value":"748"},"to":{"field":"region","value":"sz"}},{"from":{"field":"region","value":"796"},"to":{"field":"region","value":"tc"}},{"from":{"field":"region","value":"148"},"to":{"field":"region","value":"td"}},{"from":{"field":"region","value":"260"},"to":{"field":"region","value":"tf"}},{"from":{"field":"region","value":"768"},"to":{"field":"region","value":"tg"}},{"from":{"field":"region","value":"764"},"to":{"field":"region","value":"th"}},{"from":{"field":"region","value":"762"},"to":{"field":"region","value":"tj"}},{"from":{"field":"region","value":"772"},"to":{"field":"region","value":"tk"}},{"from":{"field":"region","value":"626"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"795"},"to":{"field":"region","value":"tm"}},{"from":{"field":"region","value":"788"},"to":{"field":"region","value":"tn"}},{"from":{"field":"region","value":"776"},"to":{"field":"region","value":"to"}},{"from":{"field":"region","value":"792"},"to":{"field":"region","value":"tr"}},{"from":{"field":"region","value":"780"},"to":{"field":"region","value":"tt"}},{"from":{"field":"region","value":"798"},"to":{"field":"region","value":"tv"}},{"from":{"field":"region","value":"158"},"to":{"field":"region","value":"tw"}},{"from":{"field":"region","value":"834"},"to":{"field":"region","value":"tz"}},{"from":{"field":"region","value":"804"},"to":{"field":"region","value":"ua"}},{"from":{"field":"region","value":"800"},"to":{"field":"region","value":"ug"}},{"from":{"field":"region","value":"581"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"840"},"to":{"field":"region","value":"us"}},{"from":{"field":"region","value":"858"},"to":{"field":"region","value":"uy"}},{"from":{"field":"region","value":"860"},"to":{"field":"region","value":"uz"}},{"from":{"field":"region","value":"336"},"to":{"field":"region","value":"va"}},{"from":{"field":"region","value":"670"},"to":{"field":"region","value":"vc"}},{"from":{"field":"region","value":"862"},"to":{"field":"region","value":"ve"}},{"from":{"field":"region","value":"092"},"to":{"field":"region","value":"vg"}},{"from":{"field":"region","value":"850"},"to":{"field":"region","value":"vi"}},{"from":{"field":"region","value":"704"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"548"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"876"},"to":{"field":"region","value":"wf"}},{"from":{"field":"region","value":"882"},"to":{"field":"region","value":"ws"}},{"from":{"field":"region","value":"973"},"to":{"field":"region","value":"xa"}},{"from":{"field":"region","value":"974"},"to":{"field":"region","value":"xb"}},{"from":{"field":"region","value":"975"},"to":{"field":"region","value":"xc"}},{"from":{"field":"region","value":"976"},"to":{"field":"region","value":"xd"}},{"from":{"field":"region","value":"977"},"to":{"field":"region","value":"xe"}},{"from":{"field":"region","value":"978"},"to":{"field":"region","value":"xf"}},{"from":{"field":"region","value":"979"},"to":{"field":"region","value":"xg"}},{"from":{"field":"region","value":"980"},"to":{"field":"region","value":"xh"}},{"from":{"field":"region","value":"981"},"to":{"field":"region","value":"xi"}},{"from":{"field":"region","value":"982"},"to":{"field":"region","value":"xj"}},{"from":{"field":"region","value":"983"},"to":{"field":"region","value":"xk"}},{"from":{"field":"region","value":"984"},"to":{"field":"region","value":"xl"}},{"from":{"field":"region","value":"985"},"to":{"field":"region","value":"xm"}},{"from":{"field":"region","value":"986"},"to":{"field":"region","value":"xn"}},{"from":{"field":"region","value":"987"},"to":{"field":"region","value":"xo"}},{"from":{"field":"region","value":"988"},"to":{"field":"region","value":"xp"}},{"from":{"field":"region","value":"989"},"to":{"field":"region","value":"xq"}},{"from":{"field":"region","value":"990"},"to":{"field":"region","value":"xr"}},{"from":{"field":"region","value":"991"},"to":{"field":"region","value":"xs"}},{"from":{"field":"region","value":"992"},"to":{"field":"region","value":"xt"}},{"from":{"field":"region","value":"993"},"to":{"field":"region","value":"xu"}},{"from":{"field":"region","value":"994"},"to":{"field":"region","value":"xv"}},{"from":{"field":"region","value":"995"},"to":{"field":"region","value":"xw"}},{"from":{"field":"region","value":"996"},"to":{"field":"region","value":"xx"}},{"from":{"field":"region","value":"997"},"to":{"field":"region","value":"xy"}},{"from":{"field":"region","value":"998"},"to":{"field":"region","value":"xz"}},{"from":{"field":"region","value":"720"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"887"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"175"},"to":{"field":"region","value":"yt"}},{"from":{"field":"region","value":"710"},"to":{"field":"region","value":"za"}},{"from":{"field":"region","value":"894"},"to":{"field":"region","value":"zm"}},{"from":{"field":"region","value":"716"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"999"},"to":{"field":"region","value":"zz"}},{"from":{"field":"variants","value":"aaland"},"to":{"field":"region","value":"ax"}},{"from":{"field":"variants","value":"polytoni"},"to":{"field":"variants","value":"polyton"}},{"from":{"field":"variants","value":"heploc"},"to":{"field":"variants","value":"alalc97"}},{"from":{"field":"variants","value":"arevela"},"to":{"field":"language","value":"hy"}},{"from":{"field":"variants","value":"arevmda"},"to":{"field":"language","value":"hyw"}}]')},"./node_modules/bcp-47-normalize/lib/many.json":h=>{h.exports=JSON.parse('{"region":{"172":["ru","am","az","by","ge","kg","kz","md","tj","tm","ua","uz"],"200":["cz","sk"],"530":["cw","sx","bq"],"532":["cw","sx","bq"],"536":["sa","iq"],"582":["fm","mh","mp","pw"],"810":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"830":["je","gg"],"890":["rs","me","si","hr","mk","ba"],"891":["rs","me"],"an":["cw","sx","bq"],"cs":["rs","me"],"fq":["aq","tf"],"nt":["sa","iq"],"pc":["fm","mh","mp","pw"],"su":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yu":["rs","me"],"062":["034","143"],"ant":["cw","sx","bq"],"scg":["rs","me"],"ntz":["sa","iq"],"sun":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yug":["rs","me"]}}')},"./node_modules/bcp-47-normalize/lib/matches.json":h=>{h.exports=JSON.parse('[{"from":"in","to":"id"},{"from":"iw","to":"he"},{"from":"ji","to":"yi"},{"from":"jw","to":"jv"},{"from":"mo","to":"ro"},{"from":"scc","to":"sr"},{"from":"scr","to":"hr"},{"from":"aam","to":"aas"},{"from":"adp","to":"dz"},{"from":"aue","to":"ktz"},{"from":"ayx","to":"nun"},{"from":"bgm","to":"bcg"},{"from":"bjd","to":"drl"},{"from":"ccq","to":"rki"},{"from":"cjr","to":"mom"},{"from":"cka","to":"cmr"},{"from":"cmk","to":"xch"},{"from":"coy","to":"pij"},{"from":"cqu","to":"quh"},{"from":"drh","to":"mn"},{"from":"drw","to":"fa-af"},{"from":"gav","to":"dev"},{"from":"gfx","to":"vaj"},{"from":"ggn","to":"gvr"},{"from":"gti","to":"nyc"},{"from":"guv","to":"duz"},{"from":"hrr","to":"jal"},{"from":"ibi","to":"opa"},{"from":"ilw","to":"gal"},{"from":"jeg","to":"oyb"},{"from":"kgc","to":"tdf"},{"from":"kgh","to":"kml"},{"from":"koj","to":"kwv"},{"from":"krm","to":"bmf"},{"from":"ktr","to":"dtp"},{"from":"kvs","to":"gdj"},{"from":"kwq","to":"yam"},{"from":"kxe","to":"tvd"},{"from":"kzj","to":"dtp"},{"from":"kzt","to":"dtp"},{"from":"lii","to":"raq"},{"from":"lmm","to":"rmx"},{"from":"meg","to":"cir"},{"from":"mst","to":"mry"},{"from":"mwj","to":"vaj"},{"from":"myt","to":"mry"},{"from":"nad","to":"xny"},{"from":"ncp","to":"kdz"},{"from":"nnx","to":"ngv"},{"from":"nts","to":"pij"},{"from":"oun","to":"vaj"},{"from":"pcr","to":"adx"},{"from":"pmc","to":"huw"},{"from":"pmu","to":"phr"},{"from":"ppa","to":"bfy"},{"from":"ppr","to":"lcq"},{"from":"pry","to":"prt"},{"from":"puz","to":"pub"},{"from":"sca","to":"hle"},{"from":"skk","to":"oyb"},{"from":"tdu","to":"dtp"},{"from":"thc","to":"tpo"},{"from":"thx","to":"oyb"},{"from":"tie","to":"ras"},{"from":"tkk","to":"twm"},{"from":"tlw","to":"weo"},{"from":"tmp","to":"tyj"},{"from":"tne","to":"kak"},{"from":"tnf","to":"fa-af"},{"from":"tsf","to":"taj"},{"from":"uok","to":"ema"},{"from":"xba","to":"cax"},{"from":"xia","to":"acn"},{"from":"xkh","to":"waw"},{"from":"xsj","to":"suj"},{"from":"ybd","to":"rki"},{"from":"yma","to":"lrr"},{"from":"ymt","to":"mtm"},{"from":"yos","to":"zom"},{"from":"yuu","to":"yug"},{"from":"asd","to":"snz"},{"from":"dit","to":"dif"},{"from":"llo","to":"ngt"},{"from":"myd","to":"aog"},{"from":"nns","to":"nbr"},{"from":"sgn-br","to":"bzs"},{"from":"sgn-co","to":"csn"},{"from":"sgn-de","to":"gsg"},{"from":"sgn-dk","to":"dsl"},{"from":"sgn-fr","to":"fsl"},{"from":"sgn-gb","to":"bfi"},{"from":"sgn-gr","to":"gss"},{"from":"sgn-ie","to":"isg"},{"from":"sgn-it","to":"ise"},{"from":"sgn-jp","to":"jsl"},{"from":"sgn-mx","to":"mfs"},{"from":"sgn-ni","to":"ncs"},{"from":"sgn-nl","to":"dse"},{"from":"sgn-no","to":"nsi"},{"from":"sgn-pt","to":"psr"},{"from":"sgn-se","to":"swl"},{"from":"sgn-us","to":"ase"},{"from":"sgn-za","to":"sfs"},{"from":"no-bokmal","to":"nb"},{"from":"no-nynorsk","to":"nn"},{"from":"aa-saaho","to":"ssy"},{"from":"sh","to":"sr-latn"},{"from":"cnr","to":"sr-me"},{"from":"no","to":"nb"},{"from":"tl","to":"fil"},{"from":"az-az","to":"az-latn-az"},{"from":"bs-ba","to":"bs-latn-ba"},{"from":"ha-latn-gh","to":"ha-gh"},{"from":"ha-latn-ne","to":"ha-ne"},{"from":"ha-latn-ng","to":"ha-ng"},{"from":"kk-cyrl-kz","to":"kk-kz"},{"from":"ky-cyrl-kg","to":"ky-kg"},{"from":"ks-arab-in","to":"ks-in"},{"from":"mn-cyrl-mn","to":"mn-mn"},{"from":"ms-latn-bn","to":"ms-bn"},{"from":"ms-latn-my","to":"ms-my"},{"from":"ms-latn-sg","to":"ms-sg"},{"from":"pa-in","to":"pa-guru-in"},{"from":"pa-pk","to":"pa-arab-pk"},{"from":"shi-ma","to":"shi-tfng-ma"},{"from":"sr-ba","to":"sr-cyrl-ba"},{"from":"sr-me","to":"sr-latn-me"},{"from":"sr-rs","to":"sr-cyrl-rs"},{"from":"sr-xk","to":"sr-cyrl-xk"},{"from":"tzm-latn-ma","to":"tzm-ma"},{"from":"ug-arab-cn","to":"ug-cn"},{"from":"uz-af","to":"uz-arab-af"},{"from":"uz-uz","to":"uz-latn-uz"},{"from":"vai-lr","to":"vai-vaii-lr"},{"from":"yue-cn","to":"yue-hans-cn"},{"from":"yue-hk","to":"yue-hant-hk"},{"from":"zh-cn","to":"zh-hans-cn"},{"from":"zh-hk","to":"zh-hant-hk"},{"from":"zh-mo","to":"zh-hant-mo"},{"from":"zh-sg","to":"zh-hans-sg"},{"from":"zh-tw","to":"zh-hant-tw"},{"from":"aju","to":"jrb"},{"from":"als","to":"sq"},{"from":"arb","to":"ar"},{"from":"ayr","to":"ay"},{"from":"azj","to":"az"},{"from":"bcc","to":"bal"},{"from":"bcl","to":"bik"},{"from":"bxk","to":"luy"},{"from":"bxr","to":"bua"},{"from":"cld","to":"syr"},{"from":"cmn","to":"zh"},{"from":"cwd","to":"cr"},{"from":"dgo","to":"doi"},{"from":"dhd","to":"mwr"},{"from":"dik","to":"din"},{"from":"diq","to":"zza"},{"from":"lbk","to":"bnc"},{"from":"ekk","to":"et"},{"from":"emk","to":"man"},{"from":"esk","to":"ik"},{"from":"fat","to":"ak"},{"from":"fuc","to":"ff"},{"from":"gaz","to":"om"},{"from":"gbo","to":"grb"},{"from":"gno","to":"gon"},{"from":"gug","to":"gn"},{"from":"gya","to":"gba"},{"from":"hdn","to":"hai"},{"from":"hea","to":"hmn"},{"from":"ike","to":"iu"},{"from":"kmr","to":"ku"},{"from":"knc","to":"kr"},{"from":"kng","to":"kg"},{"from":"knn","to":"kok"},{"from":"kpv","to":"kv"},{"from":"lvs","to":"lv"},{"from":"mhr","to":"chm"},{"from":"mup","to":"raj"},{"from":"khk","to":"mn"},{"from":"npi","to":"ne"},{"from":"ojg","to":"oj"},{"from":"ory","to":"or"},{"from":"pbu","to":"ps"},{"from":"pes","to":"fa"},{"from":"plt","to":"mg"},{"from":"pnb","to":"lah"},{"from":"quz","to":"qu"},{"from":"rmy","to":"rom"},{"from":"spy","to":"kln"},{"from":"src","to":"sc"},{"from":"swh","to":"sw"},{"from":"ttq","to":"tmh"},{"from":"tw","to":"ak"},{"from":"umu","to":"del"},{"from":"uzn","to":"uz"},{"from":"xpe","to":"kpe"},{"from":"xsl","to":"den"},{"from":"ydd","to":"yi"},{"from":"zai","to":"zap"},{"from":"zsm","to":"ms"},{"from":"zyb","to":"za"},{"from":"him","to":"srx"},{"from":"mnk","to":"man"},{"from":"bh","to":"bho"},{"from":"prs","to":"fa-af"},{"from":"swc","to":"sw-cd"},{"from":"aar","to":"aa"},{"from":"abk","to":"ab"},{"from":"ave","to":"ae"},{"from":"afr","to":"af"},{"from":"aka","to":"ak"},{"from":"amh","to":"am"},{"from":"arg","to":"an"},{"from":"ara","to":"ar"},{"from":"asm","to":"as"},{"from":"ava","to":"av"},{"from":"aym","to":"ay"},{"from":"aze","to":"az"},{"from":"bak","to":"ba"},{"from":"bel","to":"be"},{"from":"bul","to":"bg"},{"from":"bih","to":"bho"},{"from":"bis","to":"bi"},{"from":"bam","to":"bm"},{"from":"ben","to":"bn"},{"from":"bod","to":"bo"},{"from":"bre","to":"br"},{"from":"bos","to":"bs"},{"from":"cat","to":"ca"},{"from":"che","to":"ce"},{"from":"cha","to":"ch"},{"from":"cos","to":"co"},{"from":"cre","to":"cr"},{"from":"ces","to":"cs"},{"from":"chu","to":"cu"},{"from":"chv","to":"cv"},{"from":"cym","to":"cy"},{"from":"dan","to":"da"},{"from":"deu","to":"de"},{"from":"div","to":"dv"},{"from":"dzo","to":"dz"},{"from":"ewe","to":"ee"},{"from":"ell","to":"el"},{"from":"eng","to":"en"},{"from":"epo","to":"eo"},{"from":"spa","to":"es"},{"from":"est","to":"et"},{"from":"eus","to":"eu"},{"from":"fas","to":"fa"},{"from":"ful","to":"ff"},{"from":"fin","to":"fi"},{"from":"fij","to":"fj"},{"from":"fao","to":"fo"},{"from":"fra","to":"fr"},{"from":"fry","to":"fy"},{"from":"gle","to":"ga"},{"from":"gla","to":"gd"},{"from":"glg","to":"gl"},{"from":"grn","to":"gn"},{"from":"guj","to":"gu"},{"from":"glv","to":"gv"},{"from":"hau","to":"ha"},{"from":"heb","to":"he"},{"from":"hin","to":"hi"},{"from":"hmo","to":"ho"},{"from":"hrv","to":"hr"},{"from":"hat","to":"ht"},{"from":"hun","to":"hu"},{"from":"hye","to":"hy"},{"from":"her","to":"hz"},{"from":"ina","to":"ia"},{"from":"ind","to":"id"},{"from":"ile","to":"ie"},{"from":"ibo","to":"ig"},{"from":"iii","to":"ii"},{"from":"ipk","to":"ik"},{"from":"ido","to":"io"},{"from":"isl","to":"is"},{"from":"ita","to":"it"},{"from":"iku","to":"iu"},{"from":"jpn","to":"ja"},{"from":"jav","to":"jv"},{"from":"kat","to":"ka"},{"from":"kon","to":"kg"},{"from":"kik","to":"ki"},{"from":"kua","to":"kj"},{"from":"kaz","to":"kk"},{"from":"kal","to":"kl"},{"from":"khm","to":"km"},{"from":"kan","to":"kn"},{"from":"kor","to":"ko"},{"from":"kau","to":"kr"},{"from":"kas","to":"ks"},{"from":"kur","to":"ku"},{"from":"kom","to":"kv"},{"from":"cor","to":"kw"},{"from":"kir","to":"ky"},{"from":"lat","to":"la"},{"from":"ltz","to":"lb"},{"from":"lug","to":"lg"},{"from":"lim","to":"li"},{"from":"lin","to":"ln"},{"from":"lao","to":"lo"},{"from":"lit","to":"lt"},{"from":"lub","to":"lu"},{"from":"lav","to":"lv"},{"from":"mlg","to":"mg"},{"from":"mah","to":"mh"},{"from":"mri","to":"mi"},{"from":"mkd","to":"mk"},{"from":"mal","to":"ml"},{"from":"mon","to":"mn"},{"from":"mol","to":"ro"},{"from":"mar","to":"mr"},{"from":"msa","to":"ms"},{"from":"mlt","to":"mt"},{"from":"mya","to":"my"},{"from":"nau","to":"na"},{"from":"nob","to":"nb"},{"from":"nde","to":"nd"},{"from":"nep","to":"ne"},{"from":"ndo","to":"ng"},{"from":"nld","to":"nl"},{"from":"nno","to":"nn"},{"from":"nor","to":"nb"},{"from":"nbl","to":"nr"},{"from":"nav","to":"nv"},{"from":"nya","to":"ny"},{"from":"oci","to":"oc"},{"from":"oji","to":"oj"},{"from":"orm","to":"om"},{"from":"ori","to":"or"},{"from":"oss","to":"os"},{"from":"pan","to":"pa"},{"from":"pli","to":"pi"},{"from":"pol","to":"pl"},{"from":"pus","to":"ps"},{"from":"por","to":"pt"},{"from":"que","to":"qu"},{"from":"roh","to":"rm"},{"from":"run","to":"rn"},{"from":"ron","to":"ro"},{"from":"rus","to":"ru"},{"from":"kin","to":"rw"},{"from":"san","to":"sa"},{"from":"srd","to":"sc"},{"from":"snd","to":"sd"},{"from":"sme","to":"se"},{"from":"sag","to":"sg"},{"from":"hbs","to":"sr-latn"},{"from":"sin","to":"si"},{"from":"slk","to":"sk"},{"from":"slv","to":"sl"},{"from":"smo","to":"sm"},{"from":"sna","to":"sn"},{"from":"som","to":"so"},{"from":"sqi","to":"sq"},{"from":"srp","to":"sr"},{"from":"ssw","to":"ss"},{"from":"sot","to":"st"},{"from":"sun","to":"su"},{"from":"swe","to":"sv"},{"from":"swa","to":"sw"},{"from":"tam","to":"ta"},{"from":"tel","to":"te"},{"from":"tgk","to":"tg"},{"from":"tha","to":"th"},{"from":"tir","to":"ti"},{"from":"tuk","to":"tk"},{"from":"tgl","to":"fil"},{"from":"tsn","to":"tn"},{"from":"ton","to":"to"},{"from":"tur","to":"tr"},{"from":"tso","to":"ts"},{"from":"tat","to":"tt"},{"from":"twi","to":"ak"},{"from":"tah","to":"ty"},{"from":"uig","to":"ug"},{"from":"ukr","to":"uk"},{"from":"urd","to":"ur"},{"from":"uzb","to":"uz"},{"from":"ven","to":"ve"},{"from":"vie","to":"vi"},{"from":"vol","to":"vo"},{"from":"wln","to":"wa"},{"from":"wol","to":"wo"},{"from":"xho","to":"xh"},{"from":"yid","to":"yi"},{"from":"yor","to":"yo"},{"from":"zha","to":"za"},{"from":"zho","to":"zh"},{"from":"zul","to":"zu"},{"from":"alb","to":"sq"},{"from":"arm","to":"hy"},{"from":"baq","to":"eu"},{"from":"bur","to":"my"},{"from":"chi","to":"zh"},{"from":"cze","to":"cs"},{"from":"dut","to":"nl"},{"from":"fre","to":"fr"},{"from":"geo","to":"ka"},{"from":"ger","to":"de"},{"from":"gre","to":"el"},{"from":"ice","to":"is"},{"from":"mac","to":"mk"},{"from":"mao","to":"mi"},{"from":"may","to":"ms"},{"from":"per","to":"fa"},{"from":"rum","to":"ro"},{"from":"slo","to":"sk"},{"from":"tib","to":"bo"},{"from":"wel","to":"cy"}]')},"./node_modules/bcp-47/lib/normalize.json":h=>{h.exports=JSON.parse('{"en-gb-oed":"en-GB-oxendict","i-ami":"ami","i-bnn":"bnn","i-default":null,"i-enochian":null,"i-hak":"hak","i-klingon":"tlh","i-lux":"lb","i-mingo":null,"i-navajo":"nv","i-pwn":"pwn","i-tao":"tao","i-tay":"tay","i-tsu":"tsu","sgn-be-fr":"sfb","sgn-be-nl":"vgt","sgn-ch-de":"sgg","art-lojban":"jbo","cel-gaulish":null,"no-bok":"nb","no-nyn":"nn","zh-guoyu":"cmn","zh-hakka":"hak","zh-min":null,"zh-min-nan":"nan","zh-xiang":"hsn"}')},"./node_modules/bcp-47/lib/regular.json":h=>{h.exports=JSON.parse('["art-lojban","cel-gaulish","no-bok","no-nyn","zh-guoyu","zh-hakka","zh-min","zh-min-nan","zh-xiang"]')}},r={};function o(h){var f=r[h];if(f!==void 0)return f.exports;var d=r[h]={exports:{}};return t[h].call(d.exports,d,d.exports,o),d.exports}o.amdO={},o.n=h=>{var f=h&&h.__esModule?()=>h.default:()=>h;return o.d(f,{a:f}),f},o.d=(h,f)=>{for(var d in f)o.o(f,d)&&!o.o(h,d)&&Object.defineProperty(h,d,{enumerable:!0,get:f[d]})},o.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),o.o=(h,f)=>Object.prototype.hasOwnProperty.call(h,f),o.r=h=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})};var u={};return(()=>{/*!******************!*\
  !*** ./index.js ***!
  \******************/o.r(u),o.d(u,{Debug:()=>v.default,MediaPlayer:()=>h.MediaPlayer,MediaPlayerFactory:()=>g.default,MetricsReporting:()=>d.default,Protection:()=>m.default,default:()=>_,supportsMediaSource:()=>f.supportsMediaSource});var h=o("./index_mediaplayerOnly.js"),f=o("./src/streaming/utils/Capabilities.js"),d=o("./src/streaming/metrics/MetricsReporting.js"),m=o("./src/streaming/protection/Protection.js"),g=o("./src/streaming/MediaPlayerFactory.js"),v=o("./src/core/Debug.js");dashjs.Protection=m.default,dashjs.MetricsReporting=d.default,dashjs.MediaPlayerFactory=g.default,dashjs.Debug=v.default,dashjs.supportsMediaSource=f.supportsMediaSource;const _=dashjs})(),u=u.default,u})())})(Ooe);const SI=Zb(wb);function Noe({dispatchReqList:n,manifestURI:e}){const t=Ot.useRef(null);return Ot.useEffect(()=>{var r="query";const o=SI.MediaPlayer().create();o.initialize(t.current,e,!0),o.updateSettings({streaming:{cmcd:{enabled:!0,mode:r}}}),o.on(SI.MediaPlayer.events.FRAGMENT_LOADING_COMPLETED,function(u){n({type:"saveQuery",payload:{url:u.request.url,result:Kf(u.request.url)}})}),o.on(SI.MediaPlayer.events.MANIFEST_LOADED,function(u){n({type:"saveQuery",payload:{url:u.data.url,result:Kf(u.data.url)}})})},[e]),ln("video",{ref:t,controls:!0,width:"100%",height:"100%"})}var a0={},Foe={get exports(){return a0},set exports(n){a0=n}};(function(n,e){(function(t){var r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,o=/^(?=([^\/?#]*))\1([^]*)$/,u=/(?:\/|^)\.(?=\/)/g,h=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,f={buildAbsoluteURL:function(d,m,g){if(g=g||{},d=d.trim(),m=m.trim(),!m){if(!g.alwaysNormalize)return d;var v=f.parseURL(d);if(!v)throw new Error("Error trying to parse base URL.");return v.path=f.normalizePath(v.path),f.buildURLFromParts(v)}var _=f.parseURL(m);if(!_)throw new Error("Error trying to parse relative URL.");if(_.scheme)return g.alwaysNormalize?(_.path=f.normalizePath(_.path),f.buildURLFromParts(_)):m;var S=f.parseURL(d);if(!S)throw new Error("Error trying to parse base URL.");if(!S.netLoc&&S.path&&S.path[0]!=="/"){var E=o.exec(S.path);S.netLoc=E[1],S.path=E[2]}S.netLoc&&!S.path&&(S.path="/");var T={scheme:S.scheme,netLoc:_.netLoc,path:null,params:_.params,query:_.query,fragment:_.fragment};if(!_.netLoc&&(T.netLoc=S.netLoc,_.path[0]!=="/"))if(!_.path)T.path=S.path,_.params||(T.params=S.params,_.query||(T.query=S.query));else{var C=S.path,R=C.substring(0,C.lastIndexOf("/")+1)+_.path;T.path=f.normalizePath(R)}return T.path===null&&(T.path=g.alwaysNormalize?f.normalizePath(_.path):_.path),f.buildURLFromParts(T)},parseURL:function(d){var m=r.exec(d);return m?{scheme:m[1]||"",netLoc:m[2]||"",path:m[3]||"",params:m[4]||"",query:m[5]||"",fragment:m[6]||""}:null},normalizePath:function(d){for(d=d.split("").reverse().join("").replace(u,"");d.length!==(d=d.replace(h,"")).length;);return d.split("").reverse().join("")},buildURLFromParts:function(d){return d.scheme+d.netLoc+d.path+d.params+d.query+d.fragment}};n.exports=f})()})(Foe);function mB(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,r)}return t}function Ea(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?mB(Object(t),!0).forEach(function(r){koe(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):mB(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function koe(n,e,t){return e=Boe(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Xi(){return Xi=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Xi.apply(this,arguments)}function Uoe(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Boe(n){var e=Uoe(n,"string");return typeof e=="symbol"?e:String(e)}const Bn=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)};let ke=function(n){return n.MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached",n}({}),$n=function(n){return n.NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",n}({}),zt=function(n){return n.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",n.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",n.KEY_SYSTEM_NO_SESSION="keySystemNoSession",n.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",n.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",n.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",n.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",n.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",n.MANIFEST_LOAD_ERROR="manifestLoadError",n.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",n.MANIFEST_PARSING_ERROR="manifestParsingError",n.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",n.LEVEL_EMPTY_ERROR="levelEmptyError",n.LEVEL_LOAD_ERROR="levelLoadError",n.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",n.LEVEL_PARSING_ERROR="levelParsingError",n.LEVEL_SWITCH_ERROR="levelSwitchError",n.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",n.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",n.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",n.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",n.FRAG_LOAD_ERROR="fragLoadError",n.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",n.FRAG_DECRYPT_ERROR="fragDecryptError",n.FRAG_PARSING_ERROR="fragParsingError",n.FRAG_GAP="fragGap",n.REMUX_ALLOC_ERROR="remuxAllocError",n.KEY_LOAD_ERROR="keyLoadError",n.KEY_LOAD_TIMEOUT="keyLoadTimeOut",n.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",n.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",n.BUFFER_APPEND_ERROR="bufferAppendError",n.BUFFER_APPENDING_ERROR="bufferAppendingError",n.BUFFER_STALLED_ERROR="bufferStalledError",n.BUFFER_FULL_ERROR="bufferFullError",n.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",n.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",n.INTERNAL_EXCEPTION="internalException",n.INTERNAL_ABORTED="aborted",n.UNKNOWN="unknown",n}({});const Df=function(){},Ob={trace:Df,debug:Df,log:Df,warn:Df,info:Df,error:Df};let Am=Ob;function joe(n){const e=self.console[n];return e?e.bind(self.console,`[${n}] >`):Df}function Koe(n,...e){e.forEach(function(t){Am[t]=n[t]?n[t].bind(n):joe(t)})}function Goe(n,e){if(self.console&&n===!0||typeof n=="object"){Koe(n,"debug","log","info","warn","error");try{Am.log(`Debug logs enabled for "${e}" in hls.js version 1.4.0`)}catch{Am=Ob}}else Am=Ob}const xt=Am,Woe=/^(\d+)x(\d+)$/,vB=/(.+?)=(".*?"|.*?)(?:,|$)/g;class yi{constructor(e){typeof e=="string"&&(e=yi.parseAttrList(e));for(const t in e)e.hasOwnProperty(t)&&(t.substring(0,2)==="X-"&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(t)),this[t]=e[t])}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const r=new Uint8Array(t.length/2);for(let o=0;o<t.length/2;o++)r[o]=parseInt(t.slice(o*2,o*2+2),16);return r}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const r=this[e];return r?parseFloat(r):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=Woe.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const r={},o='"';for(vB.lastIndex=0;(t=vB.exec(e))!==null;){let u=t[2];u.indexOf(o)===0&&u.lastIndexOf(o)===u.length-1&&(u=u.slice(1,-1));const h=t[1].trim();r[h]=u}return r}}function Hoe(n){return n!=="ID"&&n!=="CLASS"&&n!=="START-DATE"&&n!=="DURATION"&&n!=="END-DATE"&&n!=="END-ON-NEXT"}function Voe(n){return n==="SCTE35-OUT"||n==="SCTE35-IN"}class rW{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const r=t.attr;for(const o in r)if(Object.prototype.hasOwnProperty.call(e,o)&&e[o]!==r[o]){xt.warn(`DATERANGE tag attribute: "${o}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=o;break}e=Xi(new yi({}),r,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const r=new Date(this.attr["END-DATE"]);Bn(r.getTime())&&(this._endDate=r)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(Bn(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&Bn(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class lS{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var jr={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class iW{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[jr.AUDIO]:null,[jr.VIDEO]:null,[jr.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const r=e.split("@",2),o=[];r.length===1?o[0]=t?t.byteRangeEndOffset:0:o[0]=parseInt(r[1]),o[1]=parseInt(r[0])+o[0],this._byteRange=o}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=a0.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class AI extends iW{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new lS,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const r=Object.keys(this.levelkeys);if(r.length===1)return this._decryptdata=this.levelkeys[r[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!Bn(this.programDateTime))return null;const e=Bn(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),r=t.length;if(r>1||r===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,r,o,u,h=!1){const{elementaryStreams:f}=this,d=f[e];if(!d){f[e]={startPTS:t,endPTS:r,startDTS:o,endDTS:u,partial:h};return}d.startPTS=Math.min(d.startPTS,t),d.endPTS=Math.max(d.endPTS,r),d.startDTS=Math.min(d.startDTS,o),d.endDTS=Math.max(d.endDTS,u)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[jr.AUDIO]=null,e[jr.VIDEO]=null,e[jr.AUDIOVIDEO]=null}}class $oe extends iW{constructor(e,t,r,o,u){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new lS,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=o;const h=e.enumeratedString("BYTERANGE");h&&this.setByteRange(h,u),u&&(this.fragOffset=u.fragOffset+u.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const zoe=10;class Yoe{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t,this.advanced=this.endSN>e.endSN||t>0||t===0&&r>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?Bn(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||zoe}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function _1(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0))}function Xoe(n){const e=sW(n).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function qoe(n){const e=function(r,o,u){const h=r[o];r[o]=r[u],r[u]=h};e(n,0,3),e(n,1,2),e(n,4,5),e(n,6,7)}function Qoe(n){const e=n.split(":");let t=null;if(e[0]==="data"&&e.length===2){const r=e[1].split(";"),o=r[r.length-1].split(",");if(o.length===2){const u=o[0]==="base64",h=o[1];u?(r.splice(-1,1),t=_1(h)):t=Xoe(h)}}return t}function sW(n){return Uint8Array.from(unescape(encodeURIComponent(n)),e=>e.charCodeAt(0))}var Ti={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},ua={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function yB(n){switch(n){case ua.FAIRPLAY:return Ti.FAIRPLAY;case ua.PLAYREADY:return Ti.PLAYREADY;case ua.WIDEVINE:return Ti.WIDEVINE;case ua.CLEARKEY:return Ti.CLEARKEY}}var aW={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function Joe(n){if(n===aW.WIDEVINE)return Ti.WIDEVINE}function EB(n){switch(n){case Ti.FAIRPLAY:return ua.FAIRPLAY;case Ti.PLAYREADY:return ua.PLAYREADY;case Ti.WIDEVINE:return ua.WIDEVINE;case Ti.CLEARKEY:return ua.CLEARKEY}}function xI(n){const{drmSystems:e,widevineLicenseUrl:t}=n,r=e?[Ti.FAIRPLAY,Ti.WIDEVINE,Ti.PLAYREADY,Ti.CLEARKEY].filter(o=>!!e[o]):[];return!r[Ti.WIDEVINE]&&t&&r.push(Ti.WIDEVINE),r}const oW=function(){return typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function Zoe(n,e,t,r){let o;switch(n){case Ti.FAIRPLAY:o=["cenc","sinf"];break;case Ti.WIDEVINE:case Ti.PLAYREADY:o=["cenc"];break;case Ti.CLEARKEY:o=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${n}`)}return ele(o,e,t,r)}function ele(n,e,t,r){return[{initDataTypes:n,persistentState:r.persistentState||"not-allowed",distinctiveIdentifier:r.distinctiveIdentifier||"not-allowed",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:e.map(u=>({contentType:`audio/mp4; codecs="${u}"`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:t.map(u=>({contentType:`video/mp4; codecs="${u}"`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null}))}]}function Vf(n,e,t){return Uint8Array.prototype.slice?n.slice(e,t):new Uint8Array(Array.prototype.slice.call(n,e,t))}const T1=(n,e)=>e+10<=n.length&&n[e]===73&&n[e+1]===68&&n[e+2]===51&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128,lW=(n,e)=>e+10<=n.length&&n[e]===51&&n[e+1]===68&&n[e+2]===73&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128,J_=(n,e)=>{const t=e;let r=0;for(;T1(n,e);){r+=10;const o=uS(n,e+6);r+=o,lW(n,e+10)&&(r+=10),e+=r}if(r>0)return n.subarray(t,t+r)},uS=(n,e)=>{let t=0;return t=(n[e]&127)<<21,t|=(n[e+1]&127)<<14,t|=(n[e+2]&127)<<7,t|=n[e+3]&127,t},tle=(n,e)=>T1(n,e)&&uS(n,e+6)+10<=n.length-e,nle=n=>{const e=cW(n);for(let t=0;t<e.length;t++){const r=e[t];if(uW(r))return lle(r)}},uW=n=>n&&n.key==="PRIV"&&n.info==="com.apple.streaming.transportStreamTimestamp",rle=n=>{const e=String.fromCharCode(n[0],n[1],n[2],n[3]),t=uS(n,4),r=10;return{type:e,size:t,data:n.subarray(r,r+t)}},cW=n=>{let e=0;const t=[];for(;T1(n,e);){const r=uS(n,e+6);e+=10;const o=e+r;for(;e+8<o;){const u=rle(n.subarray(e)),h=ile(u);h&&t.push(h),e+=u.size+10}lW(n,e)&&(e+=10)}return t},ile=n=>n.type==="PRIV"?sle(n):n.type[0]==="W"?ole(n):ale(n),sle=n=>{if(n.size<2)return;const e=Ml(n.data,!0),t=new Uint8Array(n.data.subarray(e.length+1));return{key:n.type,info:e,data:t.buffer}},ale=n=>{if(n.size<2)return;if(n.type==="TXXX"){let t=1;const r=Ml(n.data.subarray(t),!0);t+=r.length+1;const o=Ml(n.data.subarray(t));return{key:n.type,info:r,data:o}}const e=Ml(n.data.subarray(1));return{key:n.type,data:e}},ole=n=>{if(n.type==="WXXX"){if(n.size<2)return;let t=1;const r=Ml(n.data.subarray(t),!0);t+=r.length+1;const o=Ml(n.data.subarray(t));return{key:n.type,info:r,data:o}}const e=Ml(n.data);return{key:n.type,data:e}},lle=n=>{if(n.data.byteLength===8){const e=new Uint8Array(n.data),t=e[3]&1;let r=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return r/=45,t&&(r+=4772185884e-2),Math.round(r)}},Ml=(n,e=!1)=>{const t=ule();if(t){const m=t.decode(n);if(e){const g=m.indexOf("\0");return g!==-1?m.substring(0,g):m}return m.replace(/\0/g,"")}const r=n.length;let o,u,h,f="",d=0;for(;d<r;){if(o=n[d++],o===0&&e)return f;if(o===0||o===3)continue;switch(o>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:f+=String.fromCharCode(o);break;case 12:case 13:u=n[d++],f+=String.fromCharCode((o&31)<<6|u&63);break;case 14:u=n[d++],h=n[d++],f+=String.fromCharCode((o&15)<<12|(u&63)<<6|(h&63)<<0);break}}return f};let CI;function ule(){return!CI&&typeof self.TextDecoder<"u"&&(CI=new self.TextDecoder("utf-8")),CI}const yl={hexDump:function(n){let e="";for(let t=0;t<n.length;t++){let r=n[t].toString(16);r.length<2&&(r="0"+r),e+=r}return e}},Z_=Math.pow(2,32)-1,cle=[].push,fW={video:1,audio:2,id3:3,text:4};function ds(n){return String.fromCharCode.apply(null,n)}function dW(n,e){const t=n[e]<<8|n[e+1];return t<0?65536+t:t}function Zn(n,e){const t=hW(n,e);return t<0?4294967296+t:t}function hW(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}function II(n,e,t){n[e]=t>>24,n[e+1]=t>>16&255,n[e+2]=t>>8&255,n[e+3]=t&255}function xr(n,e){const t=[];if(!e.length)return t;const r=n.byteLength;for(let o=0;o<r;){const u=Zn(n,o),h=ds(n.subarray(o+4,o+8)),f=u>1?o+u:r;if(h===e[0])if(e.length===1)t.push(n.subarray(o+8,f));else{const d=xr(n.subarray(o+8,f),e.slice(1));d.length&&cle.apply(t,d)}o=f}return t}function fle(n){const e=[],t=n[0];let r=8;const o=Zn(n,r);r+=4;const u=0,h=0;t===0?r+=8:r+=16,r+=2;let f=n.length+h;const d=dW(n,r);r+=2;for(let m=0;m<d;m++){let g=r;const v=Zn(n,g);g+=4;const _=v&2147483647;if((v&2147483648)>>>31===1)return xt.warn("SIDX has hierarchical references (not supported)"),null;const E=Zn(n,g);g+=4,e.push({referenceSize:_,subsegmentDuration:E,info:{duration:E/o,start:f,end:f+_-1}}),f+=_,g+=4,r=g}return{earliestPresentationTime:u,timescale:o,version:t,referencesCount:d,references:e}}function pW(n){const e=[],t=xr(n,["moov","trak"]);for(let o=0;o<t.length;o++){const u=t[o],h=xr(u,["tkhd"])[0];if(h){let f=h[0],d=f===0?12:20;const m=Zn(h,d),g=xr(u,["mdia","mdhd"])[0];if(g){f=g[0],d=f===0?12:20;const v=Zn(g,d),_=xr(u,["mdia","hdlr"])[0];if(_){const S=ds(_.subarray(8,12)),E={soun:jr.AUDIO,vide:jr.VIDEO}[S];if(E){const T=xr(u,["mdia","minf","stbl","stsd"])[0];let C;T&&(C=ds(T.subarray(12,16))),e[m]={timescale:v,type:E},e[E]={timescale:v,id:m,codec:C}}}}}}return xr(n,["moov","mvex","trex"]).forEach(o=>{const u=Zn(o,4),h=e[u];h&&(h.default={duration:Zn(o,12),flags:Zn(o,20)})}),e}function dle(n,e){if(!n||!e)return n;const t=e.keyId;return t&&e.isCommonEncryption&&xr(n,["moov","trak"]).forEach(o=>{const h=xr(o,["mdia","minf","stbl","stsd"])[0].subarray(8);let f=xr(h,["enca"]);const d=f.length>0;d||(f=xr(h,["encv"])),f.forEach(m=>{const g=d?m.subarray(28):m.subarray(78);xr(g,["sinf"]).forEach(_=>{const S=gW(_);if(S){const E=S.subarray(8,24);E.some(T=>T!==0)||(xt.log(`[eme] Patching keyId in 'enc${d?"a":"v"}>sinf>>tenc' box: ${yl.hexDump(E)} -> ${yl.hexDump(t)}`),S.set(t,8))}})})}),n}function gW(n){const e=xr(n,["schm"])[0];if(e){const t=ds(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return xr(n,["schi","tenc"])[0]}return xt.error("[eme] missing 'schm' box"),null}function hle(n,e){return xr(e,["moof","traf"]).reduce((t,r)=>{const o=xr(r,["tfdt"])[0],u=o[0],h=xr(r,["tfhd"]).reduce((f,d)=>{const m=Zn(d,4),g=n[m];if(g){let v=Zn(o,4);if(u===1){if(v===Z_)return xt.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),f;v*=Z_+1,v+=Zn(o,8)}const _=g.timescale||9e4,S=v/_;if(isFinite(S)&&(f===null||S<f))return S}return f},null);return h!==null&&isFinite(h)&&(t===null||h<t)?h:t},null)}function ple(n,e){let t=0,r=0,o=0;const u=xr(n,["moof","traf"]);for(let h=0;h<u.length;h++){const f=u[h],d=xr(f,["tfhd"])[0],m=Zn(d,4),g=e[m];if(!g)continue;const v=g.default,_=Zn(d,0)|(v==null?void 0:v.flags);let S=v==null?void 0:v.duration;_&8&&(_&2?S=Zn(d,12):S=Zn(d,8));const E=g.timescale||9e4,T=xr(f,["trun"]);for(let C=0;C<T.length;C++){if(t=gle(T[C]),!t&&S){const R=Zn(T[C],4);t=S*R}g.type===jr.VIDEO?r+=t/E:g.type===jr.AUDIO&&(o+=t/E)}}if(r===0&&o===0){let h=0;const f=xr(n,["sidx"]);for(let d=0;d<f.length;d++){const m=fle(f[d]);m!=null&&m.references&&(h+=m.references.reduce((g,v)=>g+v.info.duration||0,0))}return h}return r||o}function gle(n){const e=Zn(n,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let r=0;const o=Zn(n,4);for(let u=0;u<o;u++){if(e&256){const h=Zn(n,t);r+=h,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return r}function mle(n,e,t){xr(e,["moof","traf"]).forEach(r=>{xr(r,["tfhd"]).forEach(o=>{const u=Zn(o,4),h=n[u];if(!h)return;const f=h.timescale||9e4;xr(r,["tfdt"]).forEach(d=>{const m=d[0];let g=Zn(d,4);if(m===0)g-=t*f,g=Math.max(g,0),II(d,4,g);else{g*=Math.pow(2,32),g+=Zn(d,8),g-=t*f,g=Math.max(g,0);const v=Math.floor(g/(Z_+1)),_=Math.floor(g%(Z_+1));II(d,4,v),II(d,8,_)}})})})}function vle(n){const e={valid:null,remainder:null},t=xr(n,["moof"]);if(t){if(t.length<2)return e.remainder=n,e}else return e;const r=t[t.length-1];return e.valid=Vf(n,0,r.byteOffset-8),e.remainder=Vf(n,r.byteOffset-8),e}function td(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function _B(n,e){const t=[],r=e.samples,o=e.timescale,u=e.id;let h=!1;return xr(r,["moof"]).map(d=>{const m=d.byteOffset-8;xr(d,["traf"]).map(v=>{const _=xr(v,["tfdt"]).map(S=>{const E=S[0];let T=Zn(S,4);return E===1&&(T*=Math.pow(2,32),T+=Zn(S,8)),T/o})[0];return _!==void 0&&(n=_),xr(v,["tfhd"]).map(S=>{const E=Zn(S,4),T=Zn(S,0)&16777215,C=(T&1)!==0,R=(T&2)!==0,b=(T&8)!==0;let F=0;const O=(T&16)!==0;let L=0;const D=(T&32)!==0;let x=8;E===u&&(C&&(x+=8),R&&(x+=4),b&&(F=Zn(S,x),x+=4),O&&(L=Zn(S,x),x+=4),D&&(x+=4),e.type==="video"&&(h=yle(e.codec)),xr(v,["trun"]).map(B=>{const M=B[0],I=Zn(B,0)&16777215,U=(I&1)!==0;let w=0;const k=(I&4)!==0,K=(I&256)!==0;let W=0;const Y=(I&512)!==0;let J=0;const ee=(I&1024)!==0,ue=(I&2048)!==0;let ie=0;const Q=Zn(B,4);let se=8;U&&(w=Zn(B,se),se+=4),k&&(se+=4);let ve=w+m;for(let _e=0;_e<Q;_e++){if(K?(W=Zn(B,se),se+=4):W=F,Y?(J=Zn(B,se),se+=4):J=L,ee&&(se+=4),ue&&(M===0?ie=Zn(B,se):ie=hW(B,se),se+=4),e.type===jr.VIDEO){let Z=0;for(;Z<J;){const Ee=Zn(r,ve);if(ve+=4,Ele(h,r[ve])){const Se=r.subarray(ve,ve+Ee);mW(Se,h?2:1,n+ie/o,t)}ve+=Ee,Z+=Ee+4}}n+=W/o}}))})})}),t}function yle(n){if(!n)return!1;const e=n.indexOf("."),t=e<0?n:n.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function Ele(n,e){if(n){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function mW(n,e,t,r){const o=vW(n);let u=0;u+=e;let h=0,f=0,d=!1,m=0;for(;u<o.length;){h=0;do{if(u>=o.length)break;m=o[u++],h+=m}while(m===255);f=0;do{if(u>=o.length)break;m=o[u++],f+=m}while(m===255);const g=o.length-u;if(!d&&h===4&&u<o.length){if(d=!0,o[u++]===181){const _=dW(o,u);if(u+=2,_===49){const S=Zn(o,u);if(u+=4,S===1195456820){const E=o[u++];if(E===3){const T=o[u++],C=31&T,R=64&T,b=R?2+C*3:0,F=new Uint8Array(b);if(R){F[0]=T;for(let O=1;O<b;O++)F[O]=o[u++]}r.push({type:E,payloadType:h,pts:t,bytes:F})}}}}}else if(h===5&&f<g){if(d=!0,f>16){const v=[];for(let E=0;E<16;E++){const T=o[u++].toString(16);v.push(T.length==1?"0"+T:T),(E===3||E===5||E===7||E===9)&&v.push("-")}const _=f-16,S=new Uint8Array(_);for(let E=0;E<_;E++)S[E]=o[u++];r.push({payloadType:h,pts:t,uuid:v.join(""),userData:Ml(S),userDataBytes:S})}}else if(f<g)u+=f;else if(f>g)break}}function vW(n){const e=n.byteLength,t=[];let r=1;for(;r<e-2;)n[r]===0&&n[r+1]===0&&n[r+2]===3?(t.push(r+2),r+=2):r++;if(t.length===0)return n;const o=e-t.length,u=new Uint8Array(o);let h=0;for(r=0;r<o;h++,r++)h===t[0]&&(h++,t.shift()),u[r]=n[h];return u}function _le(n){const e=n[0];let t="",r="",o=0,u=0,h=0,f=0,d=0,m=0;if(e===0){for(;ds(n.subarray(m,m+1))!=="\0";)t+=ds(n.subarray(m,m+1)),m+=1;for(t+=ds(n.subarray(m,m+1)),m+=1;ds(n.subarray(m,m+1))!=="\0";)r+=ds(n.subarray(m,m+1)),m+=1;r+=ds(n.subarray(m,m+1)),m+=1,o=Zn(n,12),u=Zn(n,16),f=Zn(n,20),d=Zn(n,24),m=28}else if(e===1){m+=4,o=Zn(n,m),m+=4;const v=Zn(n,m);m+=4;const _=Zn(n,m);for(m+=4,h=2**32*v+_,Number.isSafeInteger(h)||(h=Number.MAX_SAFE_INTEGER,xt.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),f=Zn(n,m),m+=4,d=Zn(n,m),m+=4;ds(n.subarray(m,m+1))!=="\0";)t+=ds(n.subarray(m,m+1)),m+=1;for(t+=ds(n.subarray(m,m+1)),m+=1;ds(n.subarray(m,m+1))!=="\0";)r+=ds(n.subarray(m,m+1)),m+=1;r+=ds(n.subarray(m,m+1)),m+=1}const g=n.subarray(m,n.byteLength);return{schemeIdUri:t,value:r,timeScale:o,presentationTime:h,presentationTimeDelta:u,eventDuration:f,id:d,payload:g}}function Tle(n,...e){const t=e.length;let r=8,o=t;for(;o--;)r+=e[o].byteLength;const u=new Uint8Array(r);for(u[0]=r>>24&255,u[1]=r>>16&255,u[2]=r>>8&255,u[3]=r&255,u.set(n,4),o=0,r=8;o<t;o++)u.set(e[o],r),r+=e[o].byteLength;return u}function Sle(n,e,t){if(n.byteLength!==16)throw new RangeError("Invalid system id");let r,o;if(e){r=1,o=new Uint8Array(e.length*16);for(let f=0;f<e.length;f++){const d=e[f];if(d.byteLength!==16)throw new RangeError("Invalid key");o.set(d,f*16)}}else r=0,o=new Uint8Array;let u;r>0?(u=new Uint8Array(4),e.length>0&&new DataView(u.buffer).setUint32(0,e.length,!1)):u=new Uint8Array;const h=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(h.buffer).setUint32(0,t.byteLength,!1),Tle([112,115,115,104],new Uint8Array([r,0,0,0]),n,u,o,h,t||new Uint8Array)}function Ale(n){if(!(n instanceof ArrayBuffer)||n.byteLength<32)return null;const e={version:0,systemId:"",kids:null,data:null},t=new DataView(n),r=t.getUint32(0);if(n.byteLength!==r&&r>44||t.getUint32(4)!==1886614376||(e.version=t.getUint32(8)>>>24,e.version>1))return null;e.systemId=yl.hexDump(new Uint8Array(n,12,16));const u=t.getUint32(28);if(e.version===0){if(r-32<u)return null;e.data=new Uint8Array(n,32,u)}else if(e.version===1){e.kids=[];for(let h=0;h<u;h++)e.kids.push(new Uint8Array(n,32+h*16,16))}return e}let uE={};class o0{static clearKeyUriToKeyIdMap(){uE={}}constructor(e,t,r,o=[1],u=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=o,this.iv=u,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case ua.FAIRPLAY:case ua.WIDEVINE:case ua.PLAYREADY:case ua.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&xt.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const r=xle(e);return new o0(this.method,this.uri,"identity",this.keyFormatVersions,r)}const t=Qoe(this.uri);if(t)switch(this.keyFormat){case ua.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case ua.PLAYREADY:{const r=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=Sle(r,null,t);const o=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),u=String.fromCharCode.apply(null,Array.from(o)),h=u.substring(u.indexOf("<"),u.length),m=new DOMParser().parseFromString(h,"text/xml").getElementsByTagName("KID")[0];if(m){const g=m.childNodes[0]?m.childNodes[0].nodeValue:m.getAttribute("VALUE");if(g){const v=_1(g).subarray(0,16);qoe(v),this.keyId=v}}break}default:{let r=t.subarray(0,16);if(r.length!==16){const o=new Uint8Array(16);o.set(r,16-r.length),r=o}this.keyId=r;break}}if(!this.keyId||this.keyId.byteLength!==16){let r=uE[this.uri];if(!r){const o=Object.keys(uE).length%Number.MAX_SAFE_INTEGER;r=new Uint8Array(16),new DataView(r.buffer,12,4).setUint32(0,o),uE[this.uri]=r}this.keyId=r}return this}}function xle(n){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=n>>8*(15-t)&255;return e}const yW=/\{\$([a-zA-Z0-9-_]+)\}/g;function TB(n){return yW.test(n)}function ia(n,e,t){if(n.variableList!==null||n.hasVariableRefs)for(let r=t.length;r--;){const o=t[r],u=e[o];u&&(e[o]=Nb(n,u))}}function Nb(n,e){if(n.variableList!==null||n.hasVariableRefs){const t=n.variableList;return e.replace(yW,r=>{const o=r.substring(2,r.length-1),u=t==null?void 0:t[o];return u===void 0?(n.playlistParsingError||(n.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${o}"`)),r):u})}return e}function SB(n,e,t){let r=n.variableList;r||(n.variableList=r={});let o,u;if("QUERYPARAM"in e){o=e.QUERYPARAM;try{const h=new self.URL(t).searchParams;if(h.has(o))u=h.get(o);else throw new Error(`"${o}" does not match any query parameter in URI: "${t}"`)}catch(h){n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${h.message}`))}}else o=e.NAME,u=e.VALUE;o in r?n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${o}"`)):r[o]=u||""}function Cle(n,e,t){const r=e.IMPORT;if(t&&r in t){let o=n.variableList;o||(n.variableList=o={}),o[r]=t[r]}else n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}const Ile={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function Rle(n,e){const t=Ile[e];return!!t&&t[n.slice(0,4)]===!0}function RI(n,e){return MediaSource.isTypeSupported(`${e||"video"}/mp4;codecs="${n}"`)}const AB=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,xB=/#EXT-X-MEDIA:(.*)/g,ble=/^#EXT(?:INF|-X-TARGETDURATION):/m,CB=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),Dle=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Vo{static findGroup(e,t){for(let r=0;r<e.length;r++){const o=e[r];if(o.id===t)return o}}static convertAVC1ToAVCOTI(e){const t=e.split(".");if(t.length>2){let r=t.shift()+".";return r+=parseInt(t.shift()).toString(16),r+=("000"+parseInt(t.shift()).toString(16)).slice(-4),r}return e}static resolve(e,t){return a0.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return ble.test(e)}static parseMasterPlaylist(e,t){const r=TB(e),o={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:r},u=[];AB.lastIndex=0;let h;for(;(h=AB.exec(e))!=null;)if(h[1]){var f;const m=new yi(h[1]);ia(o,m,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const g=Nb(o,h[2]),v={attrs:m,bitrate:m.decimalInteger("AVERAGE-BANDWIDTH")||m.decimalInteger("BANDWIDTH"),name:m.NAME,url:Vo.resolve(g,t)},_=m.decimalResolution("RESOLUTION");_&&(v.width=_.width,v.height=_.height),Ple((m.CODECS||"").split(/[ ,]+/).filter(S=>S),v),v.videoCodec&&v.videoCodec.indexOf("avc1")!==-1&&(v.videoCodec=Vo.convertAVC1ToAVCOTI(v.videoCodec)),(f=v.unknownCodecs)!=null&&f.length||u.push(v),o.levels.push(v)}else if(h[3]){const m=h[3],g=h[4];switch(m){case"SESSION-DATA":{const v=new yi(g);ia(o,v,["DATA-ID","LANGUAGE","VALUE","URI"]);const _=v["DATA-ID"];_&&(o.sessionData===null&&(o.sessionData={}),o.sessionData[_]=v);break}case"SESSION-KEY":{const v=IB(g,t,o);v.encrypted&&v.isSupported()?(o.sessionKeys===null&&(o.sessionKeys=[]),o.sessionKeys.push(v)):xt.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${g}"`);break}case"DEFINE":{{const v=new yi(g);ia(o,v,["NAME","VALUE","QUERYPARAM"]),SB(o,v,t)}break}case"CONTENT-STEERING":{const v=new yi(g);ia(o,v,["SERVER-URI","PATHWAY-ID"]),o.contentSteering={uri:Vo.resolve(v["SERVER-URI"],t),pathwayId:v["PATHWAY-ID"]||"."};break}case"START":{o.startTimeOffset=RB(g);break}}}const d=u.length>0&&u.length<o.levels.length;return o.levels=d?u:o.levels,o.levels.length===0&&(o.playlistParsingError=new Error("no levels found in manifest")),o}static parseMasterPlaylistMedia(e,t,r){let o;const u={},h=r.levels,f={AUDIO:h.map(m=>({id:m.attrs.AUDIO,audioCodec:m.audioCodec})),SUBTITLES:h.map(m=>({id:m.attrs.SUBTITLES,textCodec:m.textCodec})),"CLOSED-CAPTIONS":[]};let d=0;for(xB.lastIndex=0;(o=xB.exec(e))!==null;){const m=new yi(o[1]),g=m.TYPE;if(g){const v=f[g],_=u[g]||[];u[g]=_,ia(r,m,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const S={attrs:m,bitrate:0,id:d++,groupId:m["GROUP-ID"]||"",instreamId:m["INSTREAM-ID"],name:m.NAME||m.LANGUAGE||"",type:g,default:m.bool("DEFAULT"),autoselect:m.bool("AUTOSELECT"),forced:m.bool("FORCED"),lang:m.LANGUAGE,url:m.URI?Vo.resolve(m.URI,t):""};if(v!=null&&v.length){const E=Vo.findGroup(v,S.groupId)||v[0];bB(S,E,"audioCodec"),bB(S,E,"textCodec")}_.push(S)}}return u}static parseLevelPlaylist(e,t,r,o,u,h){const f=new Yoe(t),d=f.fragments;let m=null,g=0,v=0,_=0,S=0,E=null,T=new AI(o,t),C,R,b,F=-1,O=!1;for(CB.lastIndex=0,f.m3u8=e,f.hasVariableRefs=TB(e);(C=CB.exec(e))!==null;){O&&(O=!1,T=new AI(o,t),T.start=_,T.sn=g,T.cc=S,T.level=r,m&&(T.initSegment=m,T.rawProgramDateTime=m.rawProgramDateTime,m.rawProgramDateTime=null));const B=C[1];if(B){T.duration=parseFloat(B);const M=(" "+C[2]).slice(1);T.title=M||null,T.tagList.push(M?["INF",B,M]:["INF",B])}else if(C[3]){if(Bn(T.duration)){T.start=_,b&&LB(T,b,f),T.sn=g,T.level=r,T.cc=S,T.urlId=u,d.push(T);const M=(" "+C[3]).slice(1);T.relurl=Nb(f,M),DB(T,E),E=T,_+=T.duration,g++,v=0,O=!0}}else if(C[4]){const M=(" "+C[4]).slice(1);E?T.setByteRange(M,E):T.setByteRange(M)}else if(C[5])T.rawProgramDateTime=(" "+C[5]).slice(1),T.tagList.push(["PROGRAM-DATE-TIME",T.rawProgramDateTime]),F===-1&&(F=d.length);else{if(C=C[0].match(Dle),!C){xt.warn("No matches on slow regex match for level playlist!");continue}for(R=1;R<C.length&&!(typeof C[R]<"u");R++);const M=(" "+C[R]).slice(1),I=(" "+C[R+1]).slice(1),U=C[R+2]?(" "+C[R+2]).slice(1):"";switch(M){case"PLAYLIST-TYPE":f.type=I.toUpperCase();break;case"MEDIA-SEQUENCE":g=f.startSN=parseInt(I);break;case"SKIP":{const w=new yi(I);ia(f,w,["RECENTLY-REMOVED-DATERANGES"]);const k=w.decimalInteger("SKIPPED-SEGMENTS");if(Bn(k)){f.skippedSegments=k;for(let W=k;W--;)d.unshift(null);g+=k}const K=w.enumeratedString("RECENTLY-REMOVED-DATERANGES");K&&(f.recentlyRemovedDateranges=K.split("	"));break}case"TARGETDURATION":f.targetduration=Math.max(parseInt(I),1);break;case"VERSION":f.version=parseInt(I);break;case"EXTM3U":break;case"ENDLIST":f.live=!1;break;case"#":(I||U)&&T.tagList.push(U?[I,U]:[I]);break;case"DISCONTINUITY":S++,T.tagList.push(["DIS"]);break;case"GAP":T.gap=!0,T.tagList.push([M]);break;case"BITRATE":T.tagList.push([M,I]);break;case"DATERANGE":{const w=new yi(I);ia(f,w,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),ia(f,w,w.clientAttrs);const k=new rW(w,f.dateRanges[w.ID]);k.isValid||f.skippedSegments?f.dateRanges[k.id]=k:xt.warn(`Ignoring invalid DATERANGE tag: "${I}"`),T.tagList.push(["EXT-X-DATERANGE",I]);break}case"DEFINE":{{const w=new yi(I);ia(f,w,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in w?Cle(f,w,h):SB(f,w,t)}break}case"DISCONTINUITY-SEQUENCE":S=parseInt(I);break;case"KEY":{const w=IB(I,t,f);if(w.isSupported()){if(w.method==="NONE"){b=void 0;break}b||(b={}),b[w.keyFormat]&&(b=Xi({},b)),b[w.keyFormat]=w}else xt.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${I}"`);break}case"START":f.startTimeOffset=RB(I);break;case"MAP":{const w=new yi(I);if(ia(f,w,["BYTERANGE","URI"]),T.duration){const k=new AI(o,t);PB(k,w,r,b),m=k,T.initSegment=m,m.rawProgramDateTime&&!T.rawProgramDateTime&&(T.rawProgramDateTime=m.rawProgramDateTime)}else PB(T,w,r,b),m=T,O=!0;break}case"SERVER-CONTROL":{const w=new yi(I);f.canBlockReload=w.bool("CAN-BLOCK-RELOAD"),f.canSkipUntil=w.optionalFloat("CAN-SKIP-UNTIL",0),f.canSkipDateRanges=f.canSkipUntil>0&&w.bool("CAN-SKIP-DATERANGES"),f.partHoldBack=w.optionalFloat("PART-HOLD-BACK",0),f.holdBack=w.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const w=new yi(I);f.partTarget=w.decimalFloatingPoint("PART-TARGET");break}case"PART":{let w=f.partList;w||(w=f.partList=[]);const k=v>0?w[w.length-1]:void 0,K=v++,W=new yi(I);ia(f,W,["BYTERANGE","URI"]);const Y=new $oe(W,T,t,K,k);w.push(Y),T.duration+=Y.duration;break}case"PRELOAD-HINT":{const w=new yi(I);ia(f,w,["URI"]),f.preloadHint=w;break}case"RENDITION-REPORT":{const w=new yi(I);ia(f,w,["URI"]),f.renditionReports=f.renditionReports||[],f.renditionReports.push(w);break}default:xt.warn(`line parsed but not handled: ${C}`);break}}}E&&!E.relurl?(d.pop(),_-=E.duration,f.partList&&(f.fragmentHint=E)):f.partList&&(DB(T,E),T.cc=S,f.fragmentHint=T,b&&LB(T,b,f));const L=d.length,D=d[0],x=d[L-1];if(_+=f.skippedSegments*f.targetduration,_>0&&L&&x){f.averagetargetduration=_/L;const B=x.sn;f.endSN=B!=="initSegment"?B:0,f.live||(x.endList=!0),D&&(f.startCC=D.cc)}else f.endSN=0,f.startCC=0;return f.fragmentHint&&(_+=f.fragmentHint.duration),f.totalduration=_,f.endCC=S,F>0&&Lle(d,F),f}}function IB(n,e,t){var r,o;const u=new yi(n);ia(t,u,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const h=(r=u.METHOD)!=null?r:"",f=u.URI,d=u.hexadecimalInteger("IV"),m=u.KEYFORMATVERSIONS,g=(o=u.KEYFORMAT)!=null?o:"identity";f&&u.IV&&!d&&xt.error(`Invalid IV: ${u.IV}`);const v=f?Vo.resolve(f,e):"",_=(m||"1").split("/").map(Number).filter(Number.isFinite);return new o0(h,v,g,_,d)}function RB(n){const t=new yi(n).decimalFloatingPoint("TIME-OFFSET");return Bn(t)?t:null}function Ple(n,e){["video","audio","text"].forEach(t=>{const r=n.filter(o=>Rle(o,t));if(r.length){const o=r.filter(u=>u.lastIndexOf("avc1",0)===0||u.lastIndexOf("mp4a",0)===0);e[`${t}Codec`]=o.length>0?o[0]:r[0],n=n.filter(u=>r.indexOf(u)===-1)}}),e.unknownCodecs=n}function bB(n,e,t){const r=e[t];r&&(n[t]=r)}function Lle(n,e){let t=n[e];for(let r=e;r--;){const o=n[r];if(!o)return;o.programDateTime=t.programDateTime-o.duration*1e3,t=o}}function DB(n,e){n.rawProgramDateTime?n.programDateTime=Date.parse(n.rawProgramDateTime):e!=null&&e.programDateTime&&(n.programDateTime=e.endProgramDateTime),Bn(n.programDateTime)||(n.programDateTime=null,n.rawProgramDateTime=null)}function PB(n,e,t,r){n.relurl=e.URI,e.BYTERANGE&&n.setByteRange(e.BYTERANGE),n.level=t,n.sn="initSegment",r&&(n.levelkeys=r),n.initSegment=null}function LB(n,e,t){n.levelkeys=e;const{encryptedFragments:r}=t;(!r.length||r[r.length-1].levelkeys!==e)&&Object.keys(e).some(o=>e[o].isCommonEncryption)&&r.push(n)}var br={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Yn={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function MB(n){const{type:e}=n;switch(e){case br.AUDIO_TRACK:return Yn.AUDIO;case br.SUBTITLE_TRACK:return Yn.SUBTITLE;default:return Yn.MAIN}}function bI(n,e){let t=n.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class Mle{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.on(ke.LEVEL_LOADING,this.onLevelLoading,this),e.on(ke.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(ke.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.off(ke.LEVEL_LOADING,this.onLevelLoading,this),e.off(ke.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(ke.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,r=t.pLoader,o=t.loader,u=r||o,h=new u(t);return this.loaders[e.type]=h,h}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:r}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:br.MANIFEST,url:r,deliveryDirectives:null})}onLevelLoading(e,t){const{id:r,level:o,url:u,deliveryDirectives:h}=t;this.load({id:r,level:o,responseType:"text",type:br.LEVEL,url:u,deliveryDirectives:h})}onAudioTrackLoading(e,t){const{id:r,groupId:o,url:u,deliveryDirectives:h}=t;this.load({id:r,groupId:o,level:null,responseType:"text",type:br.AUDIO_TRACK,url:u,deliveryDirectives:h})}onSubtitleTrackLoading(e,t){const{id:r,groupId:o,url:u,deliveryDirectives:h}=t;this.load({id:r,groupId:o,level:null,responseType:"text",type:br.SUBTITLE_TRACK,url:u,deliveryDirectives:h})}load(e){var t;const r=this.hls.config;let o=this.getInternalLoader(e);if(o){const m=o.context;if(m&&m.url===e.url){xt.trace("[playlist-loader]: playlist request ongoing");return}xt.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),o.abort()}let u;if(e.type===br.MANIFEST?u=r.manifestLoadPolicy.default:u=Xi({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),o=this.createInternalLoader(e),(t=e.deliveryDirectives)!=null&&t.part){let m;if(e.type===br.LEVEL&&e.level!==null?m=this.hls.levels[e.level].details:e.type===br.AUDIO_TRACK&&e.id!==null?m=this.hls.audioTracks[e.id].details:e.type===br.SUBTITLE_TRACK&&e.id!==null&&(m=this.hls.subtitleTracks[e.id].details),m){const g=m.partTarget,v=m.targetduration;if(g&&v){const _=Math.max(g*3,v*.8)*1e3;u=Xi({},u,{maxTimeToFirstByteMs:Math.min(_,u.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(_,u.maxTimeToFirstByteMs)})}}}const h=u.errorRetry||u.timeoutRetry||{},f={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:h.maxNumRetry||0,retryDelay:h.retryDelayMs||0,maxRetryDelay:h.maxRetryDelayMs||0},d={onSuccess:(m,g,v,_)=>{const S=this.getInternalLoader(v);this.resetInternalLoader(v.type);const E=m.data;if(E.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(m,v,new Error("no EXTM3U delimiter"),_||null,g);return}g.parsing.start=performance.now(),Vo.isMediaPlaylist(E)?this.handleTrackOrLevelPlaylist(m,g,v,_||null,S):this.handleMasterPlaylist(m,g,v,_)},onError:(m,g,v,_)=>{this.handleNetworkError(g,v,!1,m,_)},onTimeout:(m,g,v)=>{this.handleNetworkError(g,v,!0,void 0,m)}};o.load(e,f,d)}handleMasterPlaylist(e,t,r,o){const u=this.hls,h=e.data,f=bI(e,r),d=Vo.parseMasterPlaylist(h,f);if(d.playlistParsingError){this.handleManifestParsingError(e,r,d.playlistParsingError,o,t);return}const{contentSteering:m,levels:g,sessionData:v,sessionKeys:_,startTimeOffset:S,variableList:E}=d;this.variableList=E;const{AUDIO:T=[],SUBTITLES:C,"CLOSED-CAPTIONS":R}=Vo.parseMasterPlaylistMedia(h,f,d);T.length&&!T.some(F=>!F.url)&&g[0].audioCodec&&!g[0].attrs.AUDIO&&(xt.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),T.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new yi({}),bitrate:0,url:""})),u.trigger(ke.MANIFEST_LOADED,{levels:g,audioTracks:T,subtitles:C,captions:R,contentSteering:m,url:f,stats:t,networkDetails:o,sessionData:v,sessionKeys:_,startTimeOffset:S,variableList:E})}handleTrackOrLevelPlaylist(e,t,r,o,u){const h=this.hls,{id:f,level:d,type:m}=r,g=bI(e,r),v=Bn(f)?f:0,_=Bn(d)?d:v,S=MB(r),E=Vo.parseLevelPlaylist(e.data,g,_,S,v,this.variableList);if(m===br.MANIFEST){const T={attrs:new yi({}),bitrate:0,details:E,name:"",url:g};h.trigger(ke.MANIFEST_LOADED,{levels:[T],audioTracks:[],url:g,stats:t,networkDetails:o,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=E,this.handlePlaylistLoaded(E,e,t,r,o,u)}handleManifestParsingError(e,t,r,o,u){this.hls.trigger(ke.ERROR,{type:$n.NETWORK_ERROR,details:zt.MANIFEST_PARSING_ERROR,fatal:t.type===br.MANIFEST,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:o,stats:u})}handleNetworkError(e,t,r=!1,o,u){let h=`A network ${r?"timeout":"error"+(o?" (status "+o.code+")":"")} occurred while loading ${e.type}`;e.type===br.LEVEL?h+=`: ${e.level} id: ${e.id}`:(e.type===br.AUDIO_TRACK||e.type===br.SUBTITLE_TRACK)&&(h+=` id: ${e.id} group-id: "${e.groupId}"`);const f=new Error(h);xt.warn(`[playlist-loader]: ${h}`);let d=zt.UNKNOWN,m=!1;const g=this.getInternalLoader(e);switch(e.type){case br.MANIFEST:d=r?zt.MANIFEST_LOAD_TIMEOUT:zt.MANIFEST_LOAD_ERROR,m=!0;break;case br.LEVEL:d=r?zt.LEVEL_LOAD_TIMEOUT:zt.LEVEL_LOAD_ERROR,m=!1;break;case br.AUDIO_TRACK:d=r?zt.AUDIO_TRACK_LOAD_TIMEOUT:zt.AUDIO_TRACK_LOAD_ERROR,m=!1;break;case br.SUBTITLE_TRACK:d=r?zt.SUBTITLE_TRACK_LOAD_TIMEOUT:zt.SUBTITLE_LOAD_ERROR,m=!1;break}g&&this.resetInternalLoader(e.type);const v={type:$n.NETWORK_ERROR,details:d,fatal:m,url:e.url,loader:g,context:e,error:f,networkDetails:t,stats:u};if(o){const _=(t==null?void 0:t.url)||e.url;v.response=Ea({url:_,data:void 0},o)}this.hls.trigger(ke.ERROR,v)}handlePlaylistLoaded(e,t,r,o,u,h){const f=this.hls,{type:d,level:m,id:g,groupId:v,deliveryDirectives:_}=o,S=bI(t,o),E=MB(o),T=typeof o.level=="number"&&E===Yn.MAIN?m:void 0;if(!e.fragments.length){const R=new Error("No Segments found in Playlist");f.trigger(ke.ERROR,{type:$n.NETWORK_ERROR,details:zt.LEVEL_EMPTY_ERROR,fatal:!1,url:S,error:R,reason:R.message,response:t,context:o,level:T,parent:E,networkDetails:u,stats:r});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const C=e.playlistParsingError;if(C){f.trigger(ke.ERROR,{type:$n.NETWORK_ERROR,details:zt.LEVEL_PARSING_ERROR,fatal:!1,url:S,error:C,reason:C.message,response:t,context:o,level:T,parent:E,networkDetails:u,stats:r});return}switch(e.live&&h&&(h.getCacheAge&&(e.ageHeader=h.getCacheAge()||0),(!h.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),d){case br.MANIFEST:case br.LEVEL:f.trigger(ke.LEVEL_LOADED,{details:e,level:T||0,id:g||0,stats:r,networkDetails:u,deliveryDirectives:_});break;case br.AUDIO_TRACK:f.trigger(ke.AUDIO_TRACK_LOADED,{details:e,id:g||0,groupId:v||"",stats:r,networkDetails:u,deliveryDirectives:_});break;case br.SUBTITLE_TRACK:f.trigger(ke.SUBTITLE_TRACK_LOADED,{details:e,id:g||0,groupId:v||"",stats:r,networkDetails:u,deliveryDirectives:_});break}}}function EW(n,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=n,e.dispatchEvent(t)}function _W(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(e.id))try{if(n.addCue(e),!n.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(r){xt.debug(`[texttrack-utils]: ${r}`);const o=new self.TextTrackCue(e.startTime,e.endTime,e.text);o.id=e.id,n.addCue(o)}t==="disabled"&&(n.mode=t)}function Ih(n){const e=n.mode;if(e==="disabled"&&(n.mode="hidden"),n.cues)for(let t=n.cues.length;t--;)n.removeCue(n.cues[t]);e==="disabled"&&(n.mode=e)}function Fb(n,e,t,r){const o=n.mode;if(o==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0){const u=Ole(n.cues,e,t);for(let h=0;h<u.length;h++)(!r||r(u[h]))&&n.removeCue(u[h])}o==="disabled"&&(n.mode=o)}function wle(n,e){if(e<n[0].startTime)return 0;const t=n.length-1;if(e>n[t].endTime)return-1;let r=0,o=t;for(;r<=o;){const u=Math.floor((o+r)/2);if(e<n[u].startTime)o=u-1;else if(e>n[u].startTime&&r<t)r=u+1;else return u}return n[r].startTime-e<e-n[o].startTime?r:o}function Ole(n,e,t){const r=[],o=wle(n,e);if(o>-1)for(let u=o,h=n.length;u<h;u++){const f=n[u];if(f.startTime>=e&&f.endTime<=t)r.push(f);else if(f.startTime>t)return r}return r}var Go={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const Nle=.25;function kb(){if(!(typeof self>"u"))return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}const cE=(()=>{const n=kb();try{new n(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function DI(n,e){return n.getTime()/1e3-e}function Fle(n){return Uint8Array.from(n.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class kle{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(ke.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(ke.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.on(ke.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(ke.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(ke.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(ke.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(ke.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.off(ke.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(ke.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(ke.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(Ih(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const r=e[t];if(r.kind==="metadata"&&r.label==="id3")return EW(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:r,enableID3MetadataCues:o}}}=this;if(!r&&!o)return;const{samples:u}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const h=kb();for(let f=0;f<u.length;f++){const d=u[f].type;if(d===Go.emsg&&!r||!o)continue;const m=cW(u[f].data);if(m){const g=u[f].pts;let v=g+u[f].duration;v>cE&&(v=cE),v-g<=0&&(v=g+Nle);for(let S=0;S<m.length;S++){const E=m[S];if(!uW(E)){this.updateId3CueEnds(g);const T=new h(g,v,"");T.value=E,d&&(T.type=d),this.id3Track.addCue(T)}}}}}updateId3CueEnds(e){var t;const r=(t=this.id3Track)==null?void 0:t.cues;if(r)for(let o=r.length;o--;){const u=r[o];u.startTime<e&&u.endTime===cE&&(u.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:r,type:o}){const{id3Track:u,hls:h}=this;if(!h)return;const{config:{enableEmsgMetadataCues:f,enableID3MetadataCues:d}}=h;if(u&&(f||d)){let m;o==="audio"?m=g=>g.type===Go.audioId3&&d:o==="video"?m=g=>g.type===Go.emsg&&f:m=g=>g.type===Go.audioId3&&d||g.type===Go.emsg&&f,Fb(u,t,r,m)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:r,id3Track:o}=this,{dateRanges:u}=t,h=Object.keys(u);if(o){const g=Object.keys(r).filter(v=>!h.includes(v));for(let v=g.length;v--;){const _=g[v];Object.keys(r[_].cues).forEach(S=>{o.removeCue(r[_].cues[S])}),delete r[_]}}const f=t.fragments[t.fragments.length-1];if(h.length===0||!Bn(f==null?void 0:f.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const d=f.programDateTime/1e3-f.start,m=kb();for(let g=0;g<h.length;g++){const v=h[g],_=u[v],S=r[v],E=(S==null?void 0:S.cues)||{};let T=(S==null?void 0:S.durationKnown)||!1;const C=DI(_.startDate,d);let R=cE;const b=_.endDate;if(b)R=DI(b,d),T=!0;else if(_.endOnNext&&!T){const O=h.reduce((L,D)=>{const x=u[D];return x.class===_.class&&x.id!==D&&x.startDate>_.startDate&&L.push(x),L},[]).sort((L,D)=>L.startDate.getTime()-D.startDate.getTime())[0];O&&(R=DI(O.startDate,d),T=!0)}const F=Object.keys(_.attr);for(let O=0;O<F.length;O++){const L=F[O];if(!Hoe(L))continue;let D=E[L];if(D)T&&!S.durationKnown&&(D.endTime=R);else{let x=_.attr[L];D=new m(C,R,""),Voe(L)&&(x=Fle(x)),D.value={key:L,data:x},D.type=Go.dateRange,D.id=v,this.id3Track.addCue(D),E[L]=D}}r[v]={cues:E,dateRange:_,durationKnown:T}}}}class Ule{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:r,targetduration:o}=e,{liveSyncDuration:u,liveSyncDurationCount:h,lowLatencyMode:f}=this.config,d=this.hls.userConfig;let m=f&&r||t;(d.liveSyncDuration||d.liveSyncDurationCount||m===0)&&(m=u!==void 0?u:h*o);const g=o,v=1;return m+Math.min(this.stallCount*v,g)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,r=this.levelDetails;if(e===null||t===null||r===null)return null;const o=r.edge,u=e-t-this.edgeStalled,h=o-r.totalduration,f=o-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(h,u),f)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(ke.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(ke.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(ke.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(ke.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(ke.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(ke.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(ke.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(ke.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(ke.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(ke.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var r;t.details===zt.BUFFER_STALLED_ERROR&&(this.stallCount++,(r=this.levelDetails)!=null&&r.live&&xt.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const r=this.computeLatency();if(r===null)return;this._latency=r;const{lowLatencyMode:o,maxLiveSyncPlaybackRate:u}=this.config;if(!o||u===1)return;const h=this.targetLatency;if(h===null)return;const f=r-h,d=Math.min(this.maxLatency,h+t.targetduration),m=f<d;if(t.live&&m&&f>.05&&this.forwardBufferLength>1){const g=Math.min(2,Math.max(1,u)),v=Math.round(2/(1+Math.exp(-.75*f-this.edgeStalled))*20)/20;e.playbackRate=Math.min(g,Math.max(1,v))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const Ub=["NONE","TYPE-0","TYPE-1",null];var xm={No:"",Yes:"YES",v2:"v2"};function Ble(n,e){const{canSkipUntil:t,canSkipDateRanges:r,endSN:o}=n,u=e!==void 0?e-o:0;return t&&u<t?r?xm.v2:xm.Yes:xm.No}class wB{constructor(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class l0{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>t).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(e){const t=e%this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var e;return(e=this.audioGroupIds)==null?void 0:e[this.urlId]}get textGroupId(){var e;return(e=this.textGroupIds)==null?void 0:e[this.urlId]}addFallback(e){this.url.push(e.url),this._attrs.push(e.attrs)}}function PI(n,e){const t=e.startPTS;if(Bn(t)){let r=0,o;e.sn>n.sn?(r=t-n.start,o=n):(r=n.start-t,o=e),o.duration!==r&&(o.duration=r)}else e.sn>n.sn?n.cc===e.cc&&n.minEndPTS?e.start=n.start+(n.minEndPTS-n.start):e.start=n.start+n.duration:e.start=Math.max(n.start-e.duration,0)}function TW(n,e,t,r,o,u){r-t<=0&&(xt.warn("Fragment should have a positive duration",e),r=t+e.duration,u=o+e.duration);let f=t,d=r;const m=e.startPTS,g=e.endPTS;if(Bn(m)){const C=Math.abs(m-t);Bn(e.deltaPTS)?e.deltaPTS=Math.max(C,e.deltaPTS):e.deltaPTS=C,f=Math.max(t,m),t=Math.min(t,m),o=Math.min(o,e.startDTS),d=Math.min(r,g),r=Math.max(r,g),u=Math.max(u,e.endDTS)}const v=t-e.start;e.start!==0&&(e.start=t),e.duration=r-e.start,e.startPTS=t,e.maxStartPTS=f,e.startDTS=o,e.endPTS=r,e.minEndPTS=d,e.endDTS=u;const _=e.sn;if(!n||_<n.startSN||_>n.endSN)return 0;let S;const E=_-n.startSN,T=n.fragments;for(T[E]=e,S=E;S>0;S--)PI(T[S],T[S-1]);for(S=E;S<T.length-1;S++)PI(T[S],T[S+1]);return n.fragmentHint&&PI(T[T.length-1],n.fragmentHint),n.PTSKnown=n.alignedSliding=!0,v}function jle(n,e){let t=null;const r=n.fragments;for(let d=r.length-1;d>=0;d--){const m=r[d].initSegment;if(m){t=m;break}}n.fragmentHint&&delete n.fragmentHint.endPTS;let o=0,u;if(Wle(n,e,(d,m)=>{d.relurl&&(o=d.cc-m.cc),Bn(d.startPTS)&&Bn(d.endPTS)&&(m.start=m.startPTS=d.startPTS,m.startDTS=d.startDTS,m.maxStartPTS=d.maxStartPTS,m.endPTS=d.endPTS,m.endDTS=d.endDTS,m.minEndPTS=d.minEndPTS,m.duration=d.endPTS-d.startPTS,m.duration&&(u=m),e.PTSKnown=e.alignedSliding=!0),m.elementaryStreams=d.elementaryStreams,m.loader=d.loader,m.stats=d.stats,m.urlId=d.urlId,d.initSegment&&(m.initSegment=d.initSegment,t=d.initSegment)}),t&&(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach(m=>{var g;(!m.initSegment||m.initSegment.relurl===((g=t)==null?void 0:g.relurl))&&(m.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some(d=>!d),e.deltaUpdateFailed){xt.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let d=e.skippedSegments;d--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=Kle(n.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));const h=e.fragments;if(o){xt.warn("discontinuity sliding from playlist, take drift into account");for(let d=0;d<h.length;d++)h[d].cc+=o}e.skippedSegments&&(e.startCC=e.fragments[0].cc),Gle(n.partList,e.partList,(d,m)=>{m.elementaryStreams=d.elementaryStreams,m.stats=d.stats}),u?TW(e,u,u.startPTS,u.endPTS,u.startDTS,u.endDTS):SW(n,e),h.length&&(e.totalduration=e.edge-h[0].start),e.driftStartTime=n.driftStartTime,e.driftStart=n.driftStart;const f=e.advancedDateTime;if(e.advanced&&f){const d=e.edge;e.driftStart||(e.driftStartTime=f,e.driftStart=d),e.driftEndTime=f,e.driftEnd=d}else e.driftEndTime=n.driftEndTime,e.driftEnd=n.driftEnd,e.advancedDateTime=n.advancedDateTime}function Kle(n,e,t){const r=Xi({},n);return t&&t.forEach(o=>{delete r[o]}),Object.keys(e).forEach(o=>{const u=new rW(e[o].attr,r[o]);u.isValid?r[o]=u:xt.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[o].attr)}"`)}),r}function Gle(n,e,t){if(n&&e){let r=0;for(let o=0,u=n.length;o<=u;o++){const h=n[o],f=e[o+r];h&&f&&h.index===f.index&&h.fragment.sn===f.fragment.sn?t(h,f):r--}}}function Wle(n,e,t){const r=e.skippedSegments,o=Math.max(n.startSN,e.startSN)-e.startSN,u=(n.fragmentHint?1:0)+(r?e.endSN:Math.min(n.endSN,e.endSN))-e.startSN,h=e.startSN-n.startSN,f=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,d=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments;for(let m=o;m<=u;m++){const g=d[h+m];let v=f[m];r&&!v&&m<r&&(v=e.fragments[m]=g),g&&v&&t(g,v)}}function SW(n,e){const t=e.startSN+e.skippedSegments-n.startSN,r=n.fragments;t<0||t>=r.length||Bb(e,r[t].start)}function Bb(n,e){if(e){const t=n.fragments;for(let r=n.skippedSegments;r<t.length;r++)t[r].start+=e;n.fragmentHint&&(n.fragmentHint.start+=e)}}function Hle(n,e=1/0){let t=1e3*n.targetduration;if(n.updated){const r=n.fragments,o=4;if(r.length&&t*o>e){const u=r[r.length-1].duration*1e3;u<t&&(t=u)}}else t/=2;return Math.round(t)}function Vle(n,e,t){if(!(n!=null&&n.details))return null;const r=n.details;let o=r.fragments[e-r.startSN];return o||(o=r.fragmentHint,o&&o.sn===e)?o:e<r.startSN&&t&&t.sn===e?t:null}function OB(n,e,t){var r;return n!=null&&n.details?AW((r=n.details)==null?void 0:r.partList,e,t):null}function AW(n,e,t){if(n)for(let r=n.length;r--;){const o=n[r];if(o.index===t&&o.fragment.sn===e)return o}return null}function eT(n){switch(n.details){case zt.FRAG_LOAD_TIMEOUT:case zt.KEY_LOAD_TIMEOUT:case zt.LEVEL_LOAD_TIMEOUT:case zt.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function NB(n,e){const t=eT(e);return n.default[`${t?"timeout":"error"}Retry`]}function S1(n,e){const t=n.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*n.retryDelayMs,n.maxRetryDelayMs)}function FB(n){return Ea(Ea({},n),{errorRetry:null,timeoutRetry:null})}function tT(n,e,t,r){return!!n&&e<n.maxNumRetry&&($le(r)||!!t)}function $le(n){return n===0&&navigator.onLine===!1||!!n&&(n<400||n>499)}const xW={search:function(n,e){let t=0,r=n.length-1,o=null,u=null;for(;t<=r;){o=(t+r)/2|0,u=n[o];const h=e(u);if(h>0)t=o+1;else if(h<0)r=o-1;else return u}return null}};function zle(n,e,t){if(e===null||!Array.isArray(n)||!n.length||!Bn(e))return null;const r=n[0].programDateTime;if(e<(r||0))return null;const o=n[n.length-1].endProgramDateTime;if(e>=(o||0))return null;t=t||0;for(let u=0;u<n.length;++u){const h=n[u];if(Yle(e,t,h))return h}return null}function u0(n,e,t=0,r=0){let o=null;if(n?o=e[n.sn-e[0].sn+1]||null:t===0&&e[0].start===0&&(o=e[0]),o&&jb(t,r,o)===0)return o;const u=xW.search(e,jb.bind(null,t,r));return u&&(u!==n||!o)?u:o}function jb(n=0,e=0,t){if(t.start<=n&&t.start+t.duration>n)return 0;const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-r<=n?1:t.start-r>n&&t.start?-1:0}function Yle(n,e,t){const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-r>n}function Xle(n,e){return xW.search(n,t=>t.cc<e?1:t.cc>e?-1:0)}const qle=3e5;var sa={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},ro={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class Qle{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=xt.log.bind(xt,"[info]:"),this.warn=xt.warn.bind(xt,"[warning]:"),this.error=xt.error.bind(xt,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(ke.ERROR,this.onError,this),e.on(ke.MANIFEST_LOADING,this.onManifestLoading,this)}unregisterListeners(){const e=this.hls;e&&(e.off(ke.ERROR,this.onError,this),e.off(ke.ERROR,this.onErrorOut,this),e.off(ke.MANIFEST_LOADING,this.onManifestLoading,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){this.playlistError=0}stopLoad(){}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Yn.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onError(e,t){var r;if(t.fatal)return;const o=this.hls,u=t.context;switch(t.details){case zt.FRAG_LOAD_ERROR:case zt.FRAG_LOAD_TIMEOUT:case zt.KEY_LOAD_ERROR:case zt.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case zt.FRAG_GAP:case zt.FRAG_PARSING_ERROR:case zt.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=sa.SendAlternateToPenaltyBox;return}case zt.LEVEL_EMPTY_ERROR:case zt.LEVEL_PARSING_ERROR:{var h,f;const d=t.parent===Yn.MAIN?t.level:o.loadLevel;t.details===zt.LEVEL_EMPTY_ERROR&&((h=t.context)!=null&&(f=h.levelDetails)!=null&&f.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,d):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,d))}return;case zt.LEVEL_LOAD_ERROR:case zt.LEVEL_LOAD_TIMEOUT:typeof(u==null?void 0:u.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u.level));return;case zt.AUDIO_TRACK_LOAD_ERROR:case zt.AUDIO_TRACK_LOAD_TIMEOUT:case zt.SUBTITLE_LOAD_ERROR:case zt.SUBTITLE_TRACK_LOAD_TIMEOUT:if(u){const d=o.levels[o.loadLevel];if(d&&(u.type===br.AUDIO_TRACK&&u.groupId===d.audioGroupId||u.type===br.SUBTITLE_TRACK&&u.groupId===d.textGroupId)){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.loadLevel),t.errorAction.action=sa.SendAlternateToPenaltyBox,t.errorAction.flags=ro.MoveAllAlternatesMatchingHost;return}}return;case zt.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const d=o.levels[o.loadLevel],m=d==null?void 0:d.attrs["HDCP-LEVEL"];m&&(t.errorAction={action:sa.SendAlternateToPenaltyBox,flags:ro.MoveAllAlternatesMatchingHDCP,hdcpLevel:m})}return;case zt.BUFFER_ADD_CODEC_ERROR:case zt.REMUX_ALLOC_ERROR:t.errorAction=this.getLevelSwitchAction(t,(r=t.level)!=null?r:o.loadLevel);return;case zt.INTERNAL_EXCEPTION:case zt.BUFFER_APPENDING_ERROR:case zt.BUFFER_APPEND_ERROR:case zt.BUFFER_FULL_ERROR:case zt.LEVEL_SWITCH_ERROR:case zt.BUFFER_STALLED_ERROR:case zt.BUFFER_SEEK_OVER_HOLE:case zt.BUFFER_NUDGE_ON_STALL:t.errorAction={action:sa.DoNothing,flags:ro.None};return}if(t.type===$n.KEY_SYSTEM_ERROR){const d=this.getVariantLevelIndex(t.frag);t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,d);return}}getPlaylistRetryOrSwitchAction(e,t){var r,o;const u=this.hls,h=NB(u.config.playlistLoadPolicy,e),f=this.playlistError++,d=(r=e.response)==null?void 0:r.code;return tT(h,f,eT(e),d)?{action:sa.RetryRequest,flags:ro.None,retryConfig:h,retryCount:f}:(o=e.context)!=null&&o.deliveryDirectives?{action:sa.DoNothing,flags:ro.None,retryConfig:h||{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},retryCount:f}:this.getLevelSwitchAction(e,t)}getFragRetryOrSwitchAction(e){const t=this.hls,r=this.getVariantLevelIndex(e.frag),o=t.levels[r],{fragLoadPolicy:u,keyLoadPolicy:h}=t.config,f=NB(e.details.startsWith("key")?h:u,e),d=t.levels.reduce((v,_)=>v+_.fragmentError,0);if(o){var m;e.details!==zt.FRAG_GAP&&o.fragmentError++;const v=(m=e.response)==null?void 0:m.code;if(tT(f,d,eT(e),v))return{action:sa.RetryRequest,flags:ro.None,retryConfig:f,retryCount:d}}const g=this.getLevelSwitchAction(e,r);return f&&(g.retryConfig=f,g.retryCount=d),g}getLevelSwitchAction(e,t){const r=this.hls;t==null&&(t=r.loadLevel);const o=this.hls.levels[t];if(o&&(o.loadError++,r.autoLevelEnabled)){var u,h;let f=-1;const d=r.levels,m=(u=e.frag)==null?void 0:u.type,{type:g,groupId:v}=(h=e.context)!=null?h:{};for(let _=d.length;_--;){const S=(_+r.loadLevel)%d.length;if(S!==r.loadLevel&&d[S].loadError===0){const E=d[S];if(e.details===zt.FRAG_GAP&&e.frag){const T=d[S].details;if(T){const C=u0(e.frag,T.fragments,e.frag.start);if(C!=null&&C.gap)continue}}else{if(g===br.AUDIO_TRACK&&v===E.audioGroupId||g===br.SUBTITLE_TRACK&&v===E.textGroupId)continue;if(m===Yn.AUDIO&&o.audioGroupId===E.audioGroupId||m===Yn.SUBTITLE&&o.textGroupId===E.textGroupId)continue}f=S;break}}if(f>-1&&r.loadLevel!==f)return e.levelRetry=!0,{action:sa.SendAlternateToPenaltyBox,flags:ro.None,nextAutoLevel:f}}return{action:sa.SendAlternateToPenaltyBox,flags:ro.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var r;switch((r=t.errorAction)==null?void 0:r.action){case sa.DoNothing:break;case sa.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==zt.FRAG_GAP&&(t.fatal=!0);break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,r=e.errorAction;if(!r)return;const{flags:o,hdcpLevel:u,nextAutoLevel:h}=r;switch(o){case ro.None:this.switchLevel(e,h);break;case ro.MoveAllAlternatesMatchingHost:r.resolved||(r.resolved=this.redundantFailover(e));break;case ro.MoveAllAlternatesMatchingHDCP:u&&(t.maxHdcpLevel=Ub[Ub.indexOf(u)-1],r.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}r.resolved||this.switchLevel(e,h)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){const{hls:t,penalizedRenditions:r}=this,o=e.parent===Yn.MAIN?e.level:t.loadLevel,u=t.levels[o],h=u.url.length,f=e.frag?e.frag.urlId:u.urlId;u.urlId===f&&(!e.frag||u.details)&&this.penalizeRendition(u,e);for(let d=1;d<h;d++){const m=(f+d)%h,g=r[m];if(!g||Jle(g,e,r[f]))return this.warn(`Switching to Redundant Stream ${m+1}/${h}: "${u.url[m]}" after ${e.details}`),this.playlistError=0,t.levels.forEach(v=>{v.urlId=m}),t.nextLoadLevel=o,!0}return!1}penalizeRendition(e,t){const{penalizedRenditions:r}=this,o=r[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};o.lastErrorPerfMs=performance.now(),o.errors.push(t),o.details=e.details,r[e.urlId]=o}}function Jle(n,e,t){if(performance.now()-n.lastErrorPerfMs>qle)return!0;const r=n.details;if(e.details===zt.FRAG_GAP&&r&&e.frag){const o=e.frag.start,u=u0(null,r.fragments,o);if(u&&!u.gap)return!0}if(t&&n.errors.length<t.errors.length){const o=n.errors[n.errors.length-1];if(r&&o.frag&&e.frag&&Math.abs(o.frag.start-e.frag.start)>r.targetduration*3)return!0}return!1}class A1{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=xt.log.bind(xt,`${t}:`),this.warn=xt.warn.bind(xt,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){const r=t==null?void 0:t.renditionReports;if(r){let o=-1;for(let u=0;u<r.length;u++){const h=r[u];let f;try{f=new self.URL(h.URI,t.url).href}catch(d){xt.warn(`Could not construct new URL for Rendition Report: ${d}`),f=h.URI||""}if(f===e){o=u;break}else f===e.substring(0,f.length)&&(o=u)}if(o!==-1){const u=r[o],h=parseInt(u["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let f=parseInt(u["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const d=Math.min(t.age-t.partTarget,t.targetduration);f>=0&&d>t.partTarget&&(f+=1)}return new wB(h,f>=0?f:void 0,xm.No)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,r){const{details:o,stats:u}=t,h=self.performance.now(),f=u.loading.first?Math.max(0,h-u.loading.first):0;if(o.advancedDateTime=Date.now()-f,o.live||r!=null&&r.live){if(o.reloaded(r),r&&this.log(`live playlist ${e} ${o.advanced?"REFRESHED "+o.lastPartSn+"-"+o.lastPartIndex:"MISSED"}`),r&&o.fragments.length>0&&jle(r,o),!this.canLoad||!o.live)return;let d,m,g;if(o.canBlockReload&&o.endSN&&o.advanced){const C=this.hls.config.lowLatencyMode,R=o.lastPartSn,b=o.endSN,F=o.lastPartIndex,O=F!==-1,L=R===b,D=C?0:F;O?(m=L?b+1:R,g=L?D:F+1):m=b+1;const x=o.age,B=x+o.ageHeader;let M=Math.min(B-o.partTarget,o.targetduration*1.5);if(M>0){if(r&&M>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${M} with playlist age: ${o.age}`),M=0;else{const I=Math.floor(M/o.targetduration);if(m+=I,g!==void 0){const U=Math.round(M%o.targetduration/o.partTarget);g+=U}this.log(`CDN Tune-in age: ${o.ageHeader}s last advanced ${x.toFixed(2)}s goal: ${M} skip sn ${I} to part ${g}`)}o.tuneInGoal=M}if(d=this.getDeliveryDirectives(o,t.deliveryDirectives,m,g),C||!L){this.loadPlaylist(d);return}}else o.canBlockReload&&(d=this.getDeliveryDirectives(o,t.deliveryDirectives,m,g));const v=this.hls.mainForwardBufferInfo,_=v?v.end-v.len:0,S=(o.edge-_)*1e3,E=Hle(o,S);o.updated&&h>this.requestScheduled+E&&(this.requestScheduled=u.loading.start),m!==void 0&&o.canBlockReload?this.requestScheduled=u.loading.first+E-(o.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+E<h?this.requestScheduled=h:this.requestScheduled-h<=0&&(this.requestScheduled+=E);let T=this.requestScheduled-h;T=Math.max(0,T),this.log(`reload live playlist ${e} in ${Math.round(T)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(d),T)}else this.clearTimer()}getDeliveryDirectives(e,t,r,o){let u=Ble(e,r);return t!=null&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,o=t.part,u=xm.No),new wB(r,o,u)}checkRetry(e){const t=e.details,r=eT(e),o=e.errorAction,{action:u,retryCount:h=0,retryConfig:f}=o||{},d=u===sa.RetryRequest&&!!o&&!!f;if(d){var m;if(this.requestScheduled=-1,r&&(m=e.context)!=null&&m.deliveryDirectives)this.warn(`Retrying playlist loading ${h+1}/${f.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const g=S1(f,h);this.timer=self.setTimeout(()=>this.loadPlaylist(),g),this.warn(`Retrying playlist loading ${h+1}/${f.maxNumRetry} after "${t}" in ${g}ms`)}e.levelRetry=!0,o.resolved=!0}return d}}let LI;class Zle extends A1{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.on(ke.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(ke.LEVEL_LOADED,this.onLevelLoaded,this),e.on(ke.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(ke.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(ke.FRAG_LOADED,this.onFragLoaded,this),e.on(ke.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.off(ke.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(ke.LEVEL_LOADED,this.onLevelLoaded,this),e.off(ke.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(ke.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(ke.FRAG_LOADED,this.onFragLoaded,this),e.off(ke.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const r=[],o={};let u;t.levels.forEach(h=>{var f;const d=h.attrs;((f=h.audioCodec)==null?void 0:f.indexOf("mp4a.40.34"))!==-1&&(LI||(LI=/chrome|firefox/i.test(navigator.userAgent)),LI&&(h.audioCodec=void 0));const{AUDIO:m,CODECS:g,"FRAME-RATE":v,"PATHWAY-ID":_,RESOLUTION:S,SUBTITLES:E}=d,C=`${`${_||"."}-`}${h.bitrate}-${S}-${v}-${g}`;u=o[C],u?u.addFallback(h):(u=new l0(h),o[C]=u,r.push(u)),nT(u,"audio",m),nT(u,"text",E)}),this.filterAndSortMediaOptions(r,t)}filterAndSortMediaOptions(e,t){let r=[],o=[],u=!1,h=!1,f=!1,d=e.filter(({audioCodec:S,videoCodec:E,width:T,height:C,unknownCodecs:R})=>(u||(u=!!(T&&C)),h||(h=!!E),f||(f=!!S),!(R!=null&&R.length)&&(!S||RI(S,"audio"))&&(!E||RI(E,"video"))));if((u||h)&&f&&(d=d.filter(({videoCodec:S,width:E,height:T})=>!!S||!!(E&&T))),d.length===0){Promise.resolve().then(()=>{if(this.hls){const S=new Error("no level with compatible codecs found in manifest");this.hls.trigger(ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:S,reason:S.message})}});return}t.audioTracks&&(r=t.audioTracks.filter(S=>!S.audioCodec||RI(S.audioCodec,"audio")),kB(r)),t.subtitles&&(o=t.subtitles,kB(o));const m=d.slice(0);d.sort((S,E)=>S.attrs["HDCP-LEVEL"]!==E.attrs["HDCP-LEVEL"]?(S.attrs["HDCP-LEVEL"]||"")>(E.attrs["HDCP-LEVEL"]||"")?1:-1:S.bitrate!==E.bitrate?S.bitrate-E.bitrate:S.attrs["FRAME-RATE"]!==E.attrs["FRAME-RATE"]?S.attrs.decimalFloatingPoint("FRAME-RATE")-E.attrs.decimalFloatingPoint("FRAME-RATE"):S.attrs.SCORE!==E.attrs.SCORE?S.attrs.decimalFloatingPoint("SCORE")-E.attrs.decimalFloatingPoint("SCORE"):u&&S.height!==E.height?S.height-E.height:0);let g=m[0];if(this.steering&&(d=this.steering.filterParsedLevels(d),d.length!==m.length)){for(let S=0;S<m.length;S++)if(m[S].pathwayId===d[0].pathwayId){g=m[S];break}}this._levels=d;for(let S=0;S<d.length;S++)if(d[S]===g){this._firstLevel=S,this.log(`manifest loaded, ${d.length} level(s) found, first bitrate: ${g.bitrate}`);break}const v=f&&!h,_={levels:d,audioTracks:r,subtitleTracks:o,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:f,video:h,altAudio:!v&&r.some(S=>!!S.url)};this.hls.trigger(ke.MANIFEST_PARSED,_),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const g=new Error("invalid level idx"),v=e<0;if(this.hls.trigger(ke.ERROR,{type:$n.OTHER_ERROR,details:zt.LEVEL_SWITCH_ERROR,level:e,fatal:v,error:g,reason:g.message}),v)return;e=Math.min(e,t.length-1)}const r=this.currentLevelIndex,o=this.currentLevel,u=o?o.attrs["PATHWAY-ID"]:void 0,h=t[e],f=h.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=h,r===e&&h.details&&o&&u===f)return;this.log(`Switching to level ${e}${f?" with Pathway "+f:""} from level ${r}${u?" with Pathway "+u:""}`);const d=Xi({},h,{level:e,maxBitrate:h.maxBitrate,attrs:h.attrs,uri:h.uri,urlId:h.urlId});delete d._attrs,delete d._urlId,this.hls.trigger(ke.LEVEL_SWITCHING,d);const m=h.details;if(!m||m.live){const g=this.switchParams(h.uri,o==null?void 0:o.details);this.loadPlaylist(g)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this._firstLevel}else return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===br.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragLoaded(e,{frag:t}){if(t!==void 0&&t.type===Yn.MAIN){const r=this._levels[t.level];r!==void 0&&(r.loadError=0)}}onLevelLoaded(e,t){var r;const{level:o,details:u}=t,h=this._levels[o];if(!h){var f;this.warn(`Invalid level index ${o}`),(f=t.deliveryDirectives)!=null&&f.skip&&(u.deltaUpdateFailed=!0);return}o===this.currentLevelIndex?(h.fragmentError===0&&(h.loadError=0),this.playlistLoaded(o,t,h.details)):(r=t.deliveryDirectives)!=null&&r.skip&&(u.deltaUpdateFailed=!0)}onAudioTrackSwitched(e,t){const r=this.currentLevel;if(!r)return;const o=this.hls.audioTracks[t.id].groupId;if(r.audioGroupIds&&r.audioGroupId!==o){let u=-1;for(let h=0;h<r.audioGroupIds.length;h++)if(r.audioGroupIds[h]===o){u=h;break}u!==-1&&u!==r.urlId&&(r.urlId=u,this.canLoad&&this.startLoad())}}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,r=this.currentLevel;if(r&&this.shouldLoadPlaylist(r)){const o=r.urlId;let u=r.uri;if(e)try{u=e.addDirectives(u)}catch(f){this.warn(`Could not construct new URL with HLS Delivery Directives: ${f}`)}const h=r.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${h?" Pathway "+h:""} URI ${o+1}/${r.url.length} ${u}`),this.clearTimer(),this.hls.trigger(ke.LEVEL_LOADING,{url:u,level:t,id:o,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e,t){const r=(u,h)=>h!==t,o=this._levels.filter((u,h)=>h!==e?!0:u.url.length>1&&t!==void 0?(u.url=u.url.filter(r),u.audioGroupIds&&(u.audioGroupIds=u.audioGroupIds.filter(r)),u.textGroupIds&&(u.textGroupIds=u.textGroupIds.filter(r)),u.urlId=0,!0):(this.steering&&this.steering.removeLevel(u),!1));this.hls.trigger(ke.LEVELS_UPDATED,{levels:o})}onLevelsUpdated(e,{levels:t}){t.forEach((r,o)=>{const{details:u}=r;u!=null&&u.fragments&&u.fragments.forEach(h=>{h.level=o})}),this._levels=t}}function nT(n,e,t){t&&(e==="audio"?(n.audioGroupIds||(n.audioGroupIds=[]),n.audioGroupIds[n.url.length-1]=t):e==="text"&&(n.textGroupIds||(n.textGroupIds=[]),n.textGroupIds[n.url.length-1]=t))}function kB(n){const e={};n.forEach(t=>{const r=t.groupId||"";t.id=e[r]=e[r]||0,e[r]++})}var Bs={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class eue{constructor(e){this.mainFragEntity=null,this.activeParts=null,this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(ke.BUFFER_APPENDED,this.onBufferAppended,this),e.on(ke.FRAG_BUFFERED,this.onFragBuffered,this),e.on(ke.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(ke.BUFFER_APPENDED,this.onBufferAppended,this),e.off(ke.FRAG_BUFFERED,this.onFragBuffered,this),e.off(ke.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.endListFragments=this.timeRanges=this.mainFragEntity=this.activeParts=null}getAppendedFrag(e,t){if(t===Yn.MAIN){const{mainFragEntity:r,activeParts:o}=this;if(r){if(r&&o)for(let u=o.length;u--;){const h=o[u],f=h?h.end:r.appendedPTS;if(h.start<=e&&f!==null&&e<=f)return u>9&&(this.activeParts=o.slice(u-9)),h}else if(r.body.start<=e&&r.appendedPTS!==null&&e<=r.appendedPTS)return r.body}}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:r}=this,o=Object.keys(r);for(let u=o.length;u--;){const h=r[o[u]];if((h==null?void 0:h.body.type)===t&&h.buffered){const f=h.body;if(f.start<=e&&e<=f.end)return f}}return null}detectEvictedFragments(e,t,r){this.timeRanges&&(this.timeRanges[e]=t),Object.keys(this.fragments).forEach(o=>{const u=this.fragments[o];if(!u)return;if(!u.buffered&&!u.loaded){u.body.type===r&&this.removeFragment(u.body);return}const h=u.range[e];h&&h.time.some(f=>{const d=!this.isTimeBuffered(f.startPTS,f.endPTS,t);return d&&this.removeFragment(u.body),d})})}detectPartialFragments(e){const t=this.timeRanges,{frag:r,part:o}=e;if(!t||r.sn==="initSegment")return;const u=dc(r),h=this.fragments[u];h&&(Object.keys(t).forEach(f=>{const d=r.elementaryStreams[f];if(!d)return;const m=t[f],g=o!==null||d.partial===!0;h.range[f]=this.getBufferedTimes(r,o,g,m)}),h.loaded=null,Object.keys(h.range).length?(h.buffered=!0,h.body.endList&&(this.endListFragments[h.body.type]=h)):this.removeFragment(h.body))}fragBuffered(e,t){const r=dc(e);let o=this.fragments[r];!o&&t&&(o=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),o&&(o.loaded=null,o.buffered=!0)}getBufferedTimes(e,t,r,o){const u={time:[],partial:r},h=t?t.start:e.start,f=t?t.end:e.end,d=e.minEndPTS||f,m=e.maxStartPTS||h;for(let g=0;g<o.length;g++){const v=o.start(g)-this.bufferPadding,_=o.end(g)+this.bufferPadding;if(m>=v&&d<=_){u.time.push({startPTS:Math.max(h,o.start(g)),endPTS:Math.min(f,o.end(g))});break}else if(h<_&&f>v)u.partial=!0,u.time.push({startPTS:Math.max(h,o.start(g)),endPTS:Math.min(f,o.end(g))});else if(f<=v)break}return u}getPartialFragment(e){let t=null,r,o,u,h=0;const{bufferPadding:f,fragments:d}=this;return Object.keys(d).forEach(m=>{const g=d[m];g&&MI(g)&&(o=g.body.start-f,u=g.body.end+f,e>=o&&e<=u&&(r=Math.min(e-o,u-e),h<=r&&(t=g.body,h=r)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||MI(t))}getState(e){const t=dc(e),r=this.fragments[t];return r?r.buffered?MI(r)?Bs.PARTIAL:Bs.OK:Bs.APPENDING:Bs.NOT_LOADED}isTimeBuffered(e,t,r){let o,u;for(let h=0;h<r.length;h++){if(o=r.start(h)-this.bufferPadding,u=r.end(h)+this.bufferPadding,e>=o&&t<=u)return!0;if(t<=o)return!1}return!1}onFragLoaded(e,t){const{frag:r,part:o}=t;if(r.sn==="initSegment"||r.bitrateTest||o)return;const u=dc(r);this.fragments[u]={body:r,appendedPTS:null,loaded:t,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:r,part:o,timeRanges:u}=t;let h=this.mainFragEntity;if(r.type===Yn.MAIN){const f=h?h.body:null;if(f!==r){h&&f&&f.sn!==r.sn&&(h.buffered=!0,this.fragments[dc(f)]=h);const d=dc(r);h=this.mainFragEntity=this.fragments[d]||{body:r,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)}}if(o){let d=this.activeParts;d||(this.activeParts=d=[]),d.push(o)}else this.activeParts=null}this.timeRanges=u,Object.keys(u).forEach(f=>{const d=u[f];if(this.detectEvictedFragments(f,d),!o&&h){const m=r.elementaryStreams[f];if(!m)return;for(let g=0;g<d.length;g++){const v=d.end(g);v<=m.endPTS&&v>m.startPTS?h.appendedPTS=Math.max(v,h.appendedPTS||0):h.appendedPTS=m.endPTS}}})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=dc(e);return!!this.fragments[t]}removeFragmentsInRange(e,t,r,o,u){o&&!this.hasGaps||Object.keys(this.fragments).forEach(h=>{const f=this.fragments[h];if(!f)return;const d=f.body;d.type!==r||o&&!d.gap||d.start<t&&d.end>e&&(f.buffered||u)&&this.removeFragment(d)})}removeFragment(e){const t=dc(e);e.stats.loaded=0,e.clearElementaryStreamInfo(),this.mainFragEntity===this.fragments[t]&&(this.mainFragEntity=null),delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.mainFragEntity=null,this.activeParts=null,this.hasGaps=!1}}function MI(n){var e,t;return n.buffered&&(n.body.gap||((e=n.range.video)==null?void 0:e.partial)||((t=n.range.audio)==null?void 0:t.partial))}function dc(n){return`${n.type}_${n.level}_${n.urlId}_${n.sn}`}const UB=Math.pow(2,17);class tue{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const r=e.url;if(!r)return Promise.reject(new Eu({type:$n.NETWORK_ERROR,details:zt.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${r?"part list":"url"}`),networkDetails:null}));this.abort();const o=this.config,u=o.fLoader,h=o.loader;return new Promise((f,d)=>{if(this.loader&&this.loader.destroy(),e.gap){d(jB(e));return}const m=this.loader=e.loader=u?new u(o):new h(o),g=BB(e),v=FB(o.fragLoadPolicy.default),_={loadPolicy:v,timeout:v.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:UB};e.stats=m.stats,m.load(g,_,{onSuccess:(S,E,T,C)=>{this.resetLoader(e,m);let R=S.data;T.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(R.slice(0,16)),R=R.slice(16)),f({frag:e,part:null,payload:R,networkDetails:C})},onError:(S,E,T,C)=>{this.resetLoader(e,m),d(new Eu({type:$n.NETWORK_ERROR,details:zt.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Ea({url:r,data:void 0},S),error:new Error(`HTTP Error ${S.code} ${S.text}`),networkDetails:T,stats:C}))},onAbort:(S,E,T)=>{this.resetLoader(e,m),d(new Eu({type:$n.NETWORK_ERROR,details:zt.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:T,stats:S}))},onTimeout:(S,E,T)=>{this.resetLoader(e,m),d(new Eu({type:$n.NETWORK_ERROR,details:zt.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${_.timeout}ms`),networkDetails:T,stats:S}))},onProgress:(S,E,T,C)=>{t&&t({frag:e,part:null,payload:T,networkDetails:C})}})})}loadPart(e,t,r){this.abort();const o=this.config,u=o.fLoader,h=o.loader;return new Promise((f,d)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){d(jB(e,t));return}const m=this.loader=e.loader=u?new u(o):new h(o),g=BB(e,t),v=FB(o.fragLoadPolicy.default),_={loadPolicy:v,timeout:v.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:UB};t.stats=m.stats,m.load(g,_,{onSuccess:(S,E,T,C)=>{this.resetLoader(e,m),this.updateStatsFromPart(e,t);const R={frag:e,part:t,payload:S.data,networkDetails:C};r(R),f(R)},onError:(S,E,T,C)=>{this.resetLoader(e,m),d(new Eu({type:$n.NETWORK_ERROR,details:zt.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Ea({url:g.url,data:void 0},S),error:new Error(`HTTP Error ${S.code} ${S.text}`),networkDetails:T,stats:C}))},onAbort:(S,E,T)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,m),d(new Eu({type:$n.NETWORK_ERROR,details:zt.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:T,stats:S}))},onTimeout:(S,E,T)=>{this.resetLoader(e,m),d(new Eu({type:$n.NETWORK_ERROR,details:zt.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${_.timeout}ms`),networkDetails:T,stats:S}))}})})}updateStatsFromPart(e,t){const r=e.stats,o=t.stats,u=o.total;if(r.loaded+=o.loaded,u){const d=Math.round(e.duration/t.duration),m=Math.min(Math.round(r.loaded/u),d),v=(d-m)*Math.round(r.loaded/m);r.total=r.loaded+v}else r.total=Math.max(r.loaded,r.total);const h=r.loading,f=o.loading;h.start?h.first+=f.first-f.start:(h.start=f.start,h.first=f.first),h.end=f.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function BB(n,e=null){const t=e||n,r={frag:n,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},o=t.byteRangeStartOffset,u=t.byteRangeEndOffset;if(Bn(o)&&Bn(u)){var h;let f=o,d=u;if(n.sn==="initSegment"&&((h=n.decryptdata)==null?void 0:h.method)==="AES-128"){const m=u-o;m%16&&(d=u+(16-m%16)),o!==0&&(r.resetIV=!0,f=o-16)}r.rangeStart=f,r.rangeEnd=d}return r}function jB(n,e){const t=new Error(`GAP ${n.gap?"tag":"attribute"} found`),r={type:$n.MEDIA_ERROR,details:zt.FRAG_GAP,fatal:!1,frag:n,error:t,networkDetails:null};return e&&(r.part=e),(e||n).stats.aborted=!0,new Eu(r)}class Eu extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class nue{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.abort()}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=zt.KEY_LOAD_ERROR,r,o,u){return new Eu({type:$n.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:u,error:r,networkDetails:o})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:r,cc:o}=e;for(let u=0;u<t.length;u++){const h=t[u];if(o<=h.cc&&(r==="initSegment"||h.sn==="initSegment"||r<h.sn)){this.emeController.selectKeySystemFormat(h).then(f=>{h.setKeyFormat(f)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var r,o;t&&e.setKeyFormat(t);const u=e.decryptdata;if(!u){const m=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,zt.KEY_LOAD_ERROR,m))}const h=u.uri;if(!h)return Promise.reject(this.createKeyLoadError(e,zt.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${h}"`)));let f=this.keyUriToKeyInfo[h];if((r=f)!=null&&r.decryptdata.key)return u.key=f.decryptdata.key,Promise.resolve({frag:e,keyInfo:f});if((o=f)!=null&&o.keyLoadPromise){var d;switch((d=f.mediaKeySessionContext)==null?void 0:d.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return f.keyLoadPromise.then(m=>(u.key=m.keyInfo.decryptdata.key,{frag:e,keyInfo:f}))}}switch(f=this.keyUriToKeyInfo[h]={decryptdata:u,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},u.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return u.keyFormat==="identity"?this.loadKeyHTTP(f,e):this.loadKeyEME(f,e);case"AES-128":return this.loadKeyHTTP(f,e);default:return Promise.reject(this.createKeyLoadError(e,zt.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${u.method}"`)))}}loadKeyEME(e,t){const r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const o=this.emeController.loadKey(r);if(o)return(e.keyLoadPromise=o.then(u=>(e.mediaKeySessionContext=u,r))).catch(u=>{throw e.keyLoadPromise=null,u})}return Promise.resolve(r)}loadKeyHTTP(e,t){const r=this.config,o=r.loader,u=new o(r);return t.keyLoader=e.loader=u,e.keyLoadPromise=new Promise((h,f)=>{const d={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},m=r.keyLoadPolicy.default,g={loadPolicy:m,timeout:m.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},v={onSuccess:(_,S,E,T)=>{const{frag:C,keyInfo:R,url:b}=E;if(!C.decryptdata||R!==this.keyUriToKeyInfo[b])return f(this.createKeyLoadError(C,zt.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),T));R.decryptdata.key=C.decryptdata.key=new Uint8Array(_.data),C.keyLoader=null,R.loader=null,h({frag:C,keyInfo:R})},onError:(_,S,E,T)=>{this.resetLoader(S),f(this.createKeyLoadError(t,zt.KEY_LOAD_ERROR,new Error(`HTTP Error ${_.code} loading key ${_.text}`),E,Ea({url:d.url,data:void 0},_)))},onTimeout:(_,S,E)=>{this.resetLoader(S),f(this.createKeyLoadError(t,zt.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),E))},onAbort:(_,S,E)=>{this.resetLoader(S),f(this.createKeyLoadError(t,zt.INTERNAL_ABORTED,new Error("key loading aborted"),E))}};u.load(d,g,v)})}resetLoader(e){const{frag:t,keyInfo:r,url:o}=e,u=r.loader;t.keyLoader===u&&(t.keyLoader=null,r.loader=null),delete this.keyUriToKeyInfo[o],u&&u.destroy()}}class rue{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}const iue={length:0,start:()=>0,end:()=>0};class fi{static isBuffered(e,t){try{if(e){const r=fi.getBuffered(e);for(let o=0;o<r.length;o++)if(t>=r.start(o)&&t<=r.end(o))return!0}}catch{}return!1}static bufferInfo(e,t,r){try{if(e){const o=fi.getBuffered(e),u=[];let h;for(h=0;h<o.length;h++)u.push({start:o.start(h),end:o.end(h)});return this.bufferedInfo(u,t,r)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,r){t=Math.max(0,t),e.sort(function(m,g){const v=m.start-g.start;return v||g.end-m.end});let o=[];if(r)for(let m=0;m<e.length;m++){const g=o.length;if(g){const v=o[g-1].end;e[m].start-v<r?e[m].end>v&&(o[g-1].end=e[m].end):o.push(e[m])}else o.push(e[m])}else o=e;let u=0,h,f=t,d=t;for(let m=0;m<o.length;m++){const g=o[m].start,v=o[m].end;if(t+r>=g&&t<v)f=g,d=v,u=d-t;else if(t+r<g){h=g;break}}return{len:u,start:f||0,end:d||0,nextStart:h}}static getBuffered(e){try{return e.buffered}catch(t){return xt.log("failed to get media.buffered",t),iue}}}class x1{constructor(e,t,r,o=0,u=-1,h=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=fE(),this.buffering={audio:fE(),video:fE(),audiovideo:fE()},this.level=e,this.sn=t,this.id=r,this.size=o,this.part=u,this.partial=h}}function fE(){return{start:0,executeStart:0,executeEnd:0,end:0}}function CW(n,e){let t=null;for(let r=0,o=n.length;r<o;r++){const u=n[r];if(u&&u.cc===e){t=u;break}}return t}function sue(n,e,t){return!!(e.details&&(t.endCC>t.startCC||n&&n.cc<t.startCC))}function aue(n,e,t=0){const r=n.fragments,o=e.fragments;if(!o.length||!r.length){xt.log("No fragments to align");return}const u=CW(r,o[0].cc);if(!u||u&&!u.startPTS){xt.log("No frag in previous level to align on");return}return u}function KB(n,e){if(n){const t=n.start+e;n.start=n.startPTS=t,n.endPTS=t+n.duration}}function C1(n,e){const t=e.fragments;for(let r=0,o=t.length;r<o;r++)KB(t[r],n);e.fragmentHint&&KB(e.fragmentHint,n),e.alignedSliding=!0}function oue(n,e,t){e&&(lue(n,t,e),!t.alignedSliding&&e.details&&uue(t,e.details),!t.alignedSliding&&e.details&&!t.skippedSegments&&SW(e.details,t))}function lue(n,e,t){if(sue(n,t,e)){const r=aue(t.details,e);r&&Bn(r.start)&&(xt.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),C1(r.start,e))}}function uue(n,e){if(!e.fragments.length||!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=e.fragments[0].programDateTime,r=n.fragments[0].programDateTime,o=(r-t)/1e3+e.fragments[0].start;o&&Bn(o)&&(xt.log(`Adjusting PTS using programDateTime delta ${r-t}ms, sliding:${o.toFixed(3)} ${n.url} `),C1(o,n))}function IW(n,e){if(!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=n.fragments,r=e.fragments;if(!t.length||!r.length)return;const o=Math.round(r.length/2)-1,u=r[o],h=CW(t,u.cc)||t[Math.round(t.length/2)-1],f=u.programDateTime,d=h.programDateTime;if(f===null||d===null)return;const m=(d-f)/1e3-(h.start-u.start);C1(m,n)}class cue{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class fue{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function due(n){const e=n.byteLength,t=e&&new DataView(n.buffer).getUint8(e-1);return t?Vf(n,0,e-t):n}class hue{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),r=new Uint32Array(4);for(let o=0;o<4;o++)r[o]=t.getUint32(o*4);return r}initTable(){const e=this.sBox,t=this.invSBox,r=this.subMix,o=r[0],u=r[1],h=r[2],f=r[3],d=this.invSubMix,m=d[0],g=d[1],v=d[2],_=d[3],S=new Uint32Array(256);let E=0,T=0,C=0;for(C=0;C<256;C++)C<128?S[C]=C<<1:S[C]=C<<1^283;for(C=0;C<256;C++){let R=T^T<<1^T<<2^T<<3^T<<4;R=R>>>8^R&255^99,e[E]=R,t[R]=E;const b=S[E],F=S[b],O=S[F];let L=S[R]*257^R*16843008;o[E]=L<<24|L>>>8,u[E]=L<<16|L>>>16,h[E]=L<<8|L>>>24,f[E]=L,L=O*16843009^F*65537^b*257^E*16843008,m[R]=L<<24|L>>>8,g[R]=L<<16|L>>>16,v[R]=L<<8|L>>>24,_[R]=L,E?(E=b^S[S[S[O^b]]],T^=S[S[T]]):E=T=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let r=!0,o=0;for(;o<t.length&&r;)r=t[o]===this.key[o],o++;if(r)return;this.key=t;const u=this.keySize=t.length;if(u!==4&&u!==6&&u!==8)throw new Error("Invalid aes key size="+u);const h=this.ksRows=(u+6+1)*4;let f,d;const m=this.keySchedule=new Uint32Array(h),g=this.invKeySchedule=new Uint32Array(h),v=this.sBox,_=this.rcon,S=this.invSubMix,E=S[0],T=S[1],C=S[2],R=S[3];let b,F;for(f=0;f<h;f++){if(f<u){b=m[f]=t[f];continue}F=b,f%u===0?(F=F<<8|F>>>24,F=v[F>>>24]<<24|v[F>>>16&255]<<16|v[F>>>8&255]<<8|v[F&255],F^=_[f/u|0]<<24):u>6&&f%u===4&&(F=v[F>>>24]<<24|v[F>>>16&255]<<16|v[F>>>8&255]<<8|v[F&255]),m[f]=b=(m[f-u]^F)>>>0}for(d=0;d<h;d++)f=h-d,d&3?F=m[f]:F=m[f-4],d<4||f<=4?g[d]=F:g[d]=E[v[F>>>24]]^T[v[F>>>16&255]]^C[v[F>>>8&255]]^R[v[F&255]],g[d]=g[d]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,r){const o=this.keySize+6,u=this.invKeySchedule,h=this.invSBox,f=this.invSubMix,d=f[0],m=f[1],g=f[2],v=f[3],_=this.uint8ArrayToUint32Array_(r);let S=_[0],E=_[1],T=_[2],C=_[3];const R=new Int32Array(e),b=new Int32Array(R.length);let F,O,L,D,x,B,M,I,U,w,k,K,W,Y;const J=this.networkToHostOrderSwap;for(;t<R.length;){for(U=J(R[t]),w=J(R[t+1]),k=J(R[t+2]),K=J(R[t+3]),x=U^u[0],B=K^u[1],M=k^u[2],I=w^u[3],W=4,Y=1;Y<o;Y++)F=d[x>>>24]^m[B>>16&255]^g[M>>8&255]^v[I&255]^u[W],O=d[B>>>24]^m[M>>16&255]^g[I>>8&255]^v[x&255]^u[W+1],L=d[M>>>24]^m[I>>16&255]^g[x>>8&255]^v[B&255]^u[W+2],D=d[I>>>24]^m[x>>16&255]^g[B>>8&255]^v[M&255]^u[W+3],x=F,B=O,M=L,I=D,W=W+4;F=h[x>>>24]<<24^h[B>>16&255]<<16^h[M>>8&255]<<8^h[I&255]^u[W],O=h[B>>>24]<<24^h[M>>16&255]<<16^h[I>>8&255]<<8^h[x&255]^u[W+1],L=h[M>>>24]<<24^h[I>>16&255]<<16^h[x>>8&255]<<8^h[B&255]^u[W+2],D=h[I>>>24]<<24^h[x>>16&255]<<16^h[B>>8&255]<<8^h[M&255]^u[W+3],b[t]=J(F^S),b[t+1]=J(D^E),b[t+2]=J(L^T),b[t+3]=J(O^C),S=U,E=w,T=k,C=K,t=t+4}return b.buffer}}const pue=16;class I1{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch{}this.subtle===null&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?due(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,r){return this.useSoftware?new Promise((o,u)=>{this.softwareDecrypt(new Uint8Array(e),t,r);const h=this.flush();h?o(h.buffer):u(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,r)}softwareDecrypt(e,t,r){const{currentIV:o,currentResult:u,remainderData:h}=this;this.logOnce("JS AES decrypt"),h&&(e=td(h,e),this.remainderData=null);const f=this.getValidChunk(e);if(!f.length)return null;o&&(r=o);let d=this.softwareDecrypter;d||(d=this.softwareDecrypter=new hue),d.expandKey(t);const m=u;return this.currentResult=d.decrypt(f.buffer,0,r),this.currentIV=Vf(f,-16).buffer,m||null}webCryptoDecrypt(e,t,r){const o=this.subtle;return(this.key!==t||!this.fastAesKey)&&(this.key=t,this.fastAesKey=new fue(o,t)),this.fastAesKey.expandKey().then(u=>o?(this.logOnce("WebCrypto AES decrypt"),new cue(o,new Uint8Array(r)).decrypt(e.buffer,u)):Promise.reject(new Error("web crypto not initialized"))).catch(u=>(xt.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${u.name}: ${u.message}`),this.onWebCryptoError(e,t,r)))}onWebCryptoError(e,t,r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r);const o=this.flush();if(o)return o.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const r=e.length-e.length%pue;return r!==e.length&&(t=Vf(e,0,r),this.remainderData=Vf(e,r)),t}logOnce(e){this.logEnabled&&(xt.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const gue={toString:function(n){let e="";const t=n.length;for(let r=0;r<t;r++)e+=`[${n.start(r).toFixed(3)}-${n.end(r).toFixed(3)}]`;return e}},rn={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class R1 extends rue{constructor(e,t,r,o,u){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=rn.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=u,this.logPrefix=o,this.log=xt.log.bind(xt,`${o}:`),this.warn=xt.warn.bind(xt,`${o}:`),this.hls=e,this.fragmentLoader=new tue(e.config),this.keyLoader=r,this.fragmentTracker=t,this.config=e.config,this.decrypter=new I1(e.config),e.on(ke.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort();const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=rn.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const r=t.partList;if(r!=null&&r.length){const u=r[r.length-1];return fi.isBuffered(this.media,u.start+u.duration/2)}const o=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(o)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levels[this.levelLastLoaded])==null?void 0:e.details}}onMediaAttached(e,t){const r=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),r.addEventListener("seeking",this.onvseeking),r.addEventListener("ended",this.onvended);const o=this.config;this.levels&&o.autoStartLoad&&this.state===rn.STOPPED&&this.startLoad(o.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:r,mediaBuffer:o,state:u}=this,h=r?r.currentTime:0,f=fi.bufferInfo(o||r,h,e.maxBufferHole);if(this.log(`media seeking to ${Bn(h)?h.toFixed(3):h}, state: ${u}`),this.state===rn.ENDED)this.resetLoadingState();else if(t){const d=e.maxFragLookUpTolerance,m=t.start-d,g=t.start+t.duration+d;if(!f.len||g<f.start||m>f.end){const v=h>g;(h<m||v)&&(v&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests()),this.resetLoadingState())}}r&&(this.fragmentTracker.removeFragmentsInRange(h,1/0,this.playlistType,!0),this.lastCurrentTime=h),!this.loadedmetadata&&!f.len&&(this.nextLoadPosition=this.startPosition=h),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=rn.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,r){this._loadFragForPlayback(e,t,r)}_loadFragForPlayback(e,t,r){const o=u=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${u.part?" p: "+u.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(u)};this._doFragLoad(e,t,r,o).then(u=>{if(!u)return;const h=this.state;if(this.fragContextChanged(e)){(h===rn.FRAG_LOADING||!this.fragCurrent&&h===rn.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=rn.IDLE);return}"payload"in u&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(ke.FRAG_LOADED,u)),this._handleFragmentLoadComplete(u)}).catch(u=>{this.state===rn.STOPPED||this.state===rn.ERROR||(this.warn(u),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;if(this.fragmentTracker.getState(e)===Bs.APPENDING){const o=e.type,u=this.getFwdBufferInfo(this.mediaBuffer,o),h=Math.max(e.duration,u?u.len:this.config.maxBufferLength);this.reduceMaxBufferLength(h)&&this.fragmentTracker.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0&&this.fragmentTracker.removeAllFragments()}flushMainBuffer(e,t,r=null){if(!(e-t))return;const o={startOffset:e,endOffset:t,type:r};this.hls.trigger(ke.BUFFER_FLUSHING,o)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(r=>{if(!r||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return r}).then(r=>{const{hls:o}=this,{payload:u}=r,h=e.decryptdata;if(u&&u.byteLength>0&&h&&h.key&&h.iv&&h.method==="AES-128"){const f=self.performance.now();return this.decrypter.decrypt(new Uint8Array(u),h.key.buffer,h.iv.buffer).catch(d=>{throw o.trigger(ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.FRAG_DECRYPT_ERROR,fatal:!1,error:d,reason:d.message,frag:e}),d}).then(d=>{const m=self.performance.now();return o.trigger(ke.FRAG_DECRYPTED,{frag:e,payload:d,stats:{tstart:f,tdecrypt:m}}),r.payload=d,r})}return r}).then(r=>{const{fragCurrent:o,hls:u,levels:h}=this;if(!h)throw new Error("init load aborted, missing levels");const f=e.stats;this.state=rn.IDLE,t.fragmentError=0,e.data=new Uint8Array(r.payload),f.parsing.start=f.buffering.start=self.performance.now(),f.parsing.end=f.buffering.end=self.performance.now(),r.frag===o&&u.trigger(ke.FRAG_BUFFERED,{stats:f,frag:o,part:null,id:e.type}),this.tick()}).catch(r=>{this.state===rn.STOPPED||this.state===rn.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId}fragBufferedComplete(e,t){var r,o,u,h;const f=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level} (frag:[${((r=e.startPTS)!=null?r:NaN).toFixed(3)}-${((o=e.endPTS)!=null?o:NaN).toFixed(3)}] > buffer:${f?gue.toString(fi.getBuffered(f)):"(detached)"})`),this.state=rn.IDLE,f&&(!this.loadedmetadata&&e.type==Yn.MAIN&&f.buffered.length&&((u=this.fragCurrent)==null?void 0:u.sn)===((h=this.fragPrevious)==null?void 0:h.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:r,part:o,partsLoaded:u}=e,h=!u||u.length===0||u.some(d=>!d),f=new x1(r.level,r.sn,r.stats.chunkCount+1,0,o?o.index:-1,!h);t.flush(f)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,r=null,o){var u;const h=t==null?void 0:t.details;if(!this.levels||!h)throw new Error(`frag load aborted, missing level${h?"":" detail"}s`);let f=null;if(e.encrypted&&!((u=e.decryptdata)!=null&&u.key)?(this.log(`Loading key for ${e.sn} of [${h.startSN}-${h.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=rn.KEY_LOADING,this.fragCurrent=e,f=this.keyLoader.load(e).then(g=>{if(!this.fragContextChanged(g.frag))return this.hls.trigger(ke.KEY_LOADED,g),this.state===rn.KEY_LOADING&&(this.state=rn.IDLE),g}),this.hls.trigger(ke.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(f=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&h.encryptedFragments.length&&this.keyLoader.loadClear(e,h.encryptedFragments),r=Math.max(e.start,r||0),this.config.lowLatencyMode){const g=h.partList;if(g&&o){r>e.end&&h.fragmentHint&&(e=h.fragmentHint);const v=this.getNextPart(g,e,r);if(v>-1){const _=g[v];this.log(`Loading part sn: ${e.sn} p: ${_.index} cc: ${e.cc} of playlist [${h.startSN}-${h.endSN}] parts [0-${v}-${g.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=_.start+_.duration,this.state=rn.FRAG_LOADING;let S;return f?S=f.then(E=>!E||this.fragContextChanged(E.frag)?null:this.doFragPartsLoad(e,_,t,o)).catch(E=>this.handleFragLoadError(E)):S=this.doFragPartsLoad(e,_,t,o).catch(E=>this.handleFragLoadError(E)),this.hls.trigger(ke.FRAG_LOADING,{frag:e,part:_,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):S}else if(!e.url||this.loadedEndOfParts(g,r))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${h?"of ["+h.startSN+"-"+h.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(r.toFixed(3))}`),Bn(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=rn.FRAG_LOADING;const d=this.config.progressive;let m;return d&&f?m=f.then(g=>!g||this.fragContextChanged(g==null?void 0:g.frag)?null:this.fragmentLoader.load(e,o)).catch(g=>this.handleFragLoadError(g)):m=Promise.all([this.fragmentLoader.load(e,d?o:void 0),f]).then(([g])=>(!d&&g&&o&&o(g),g)).catch(g=>this.handleFragLoadError(g)),this.hls.trigger(ke.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):m}doFragPartsLoad(e,t,r,o){return new Promise((u,h)=>{var f;const d=[],m=(f=r.details)==null?void 0:f.partList,g=v=>{this.fragmentLoader.loadPart(e,v,o).then(_=>{d[v.index]=_;const S=_.part;this.hls.trigger(ke.FRAG_LOADED,_);const E=OB(r,e.sn,v.index+1)||AW(m,e.sn,v.index+1);if(E)g(E);else return u({frag:e,part:S,partsLoaded:d})}).catch(h)};g(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===zt.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(ke.ERROR,t)}else this.hls.trigger(ke.ERROR,{type:$n.OTHER_ERROR,details:zt.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==rn.PARSING){!this.fragCurrent&&this.state!==rn.STOPPED&&this.state!==rn.ERROR&&(this.state=rn.IDLE);return}const{frag:r,part:o,level:u}=t,h=self.performance.now();r.stats.parsing.end=h,o&&(o.stats.parsing.end=h),this.updateLevelTiming(r,o,u,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:r}=this,{level:o,sn:u,part:h}=e;if(!(t!=null&&t[o]))return this.warn(`Levels object was unset while buffering fragment ${u} of level ${o}. The current chunk will not be buffered.`),null;const f=t[o],d=h>-1?OB(f,u,h):null,m=d?d.fragment:Vle(f,u,r);return m?(r&&r!==m&&(m.stats=r.stats),{frag:m,part:d,level:f}):null}bufferFragmentData(e,t,r,o){var u;if(!e||this.state!==rn.PARSING)return;const{data1:h,data2:f}=e;let d=h;if(h&&f&&(d=td(h,f)),!((u=d)!=null&&u.length))return;const m={type:e.type,frag:t,part:r,chunkMeta:o,parent:t.type,data:d};this.hls.trigger(ke.BUFFER_APPENDING,m),e.dropped&&e.independent&&!r&&this.flushBufferGap(t)}flushBufferGap(e){const t=this.media;if(!t)return;if(!fi.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const r=t.currentTime,o=fi.bufferInfo(t,r,0),u=e.duration,h=Math.min(this.config.maxFragLookUpTolerance*2,u*.25),f=Math.max(Math.min(e.start-h,o.end-h),r+h);e.start-f>h&&this.flushMainBuffer(f,e.start)}getFwdBufferInfo(e,t){const r=this.getLoadPosition();return Bn(r)?this.getFwdBufferInfoAtPos(e,r,t):null}getFwdBufferInfoAtPos(e,t,r){const{config:{maxBufferHole:o}}=this,u=fi.bufferInfo(e,t,o);if(u.len===0&&u.nextStart!==void 0){const h=this.fragmentTracker.getBufferedFrag(t,r);if(h&&u.nextStart<h.end)return fi.bufferInfo(e,t,Math.max(u.nextStart,o))}return u}getMaxBufferLength(e){const{config:t}=this;let r;return e?r=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):r=t.maxBufferLength,Math.min(r,t.maxMaxBufferLength)}reduceMaxBufferLength(e){const t=this.config,r=e||t.maxBufferLength;return t.maxMaxBufferLength>=r?(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0):!1}getNextFragment(e,t){const r=t.fragments,o=r.length;if(!o)return null;const{config:u}=this,h=r[0].start;let f;if(t.live){const d=u.initialLiveManifestSize;if(o<d)return this.warn(`Not enough fragments to start playback (have: ${o}, need: ${d})`),null;!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(f=this.getInitialLiveFragment(t,r),this.startPosition=f?this.hls.liveSyncPosition||f.start:e)}else e<=h&&(f=r[0]);if(!f){const d=u.lowLatencyMode?t.partEnd:t.fragmentEnd;f=this.getFragmentAtPosition(e,d,t)}return this.mapToInitFragWhenRequired(f)}isLoopLoading(e,t){const r=this.fragmentTracker.getState(e);return(r===Bs.OK||r===Bs.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,r,o,u){const h=e.gap,f=this.getNextFragment(this.nextLoadPosition,t);if(f===null)return f;if(e=f,h&&e&&!e.gap&&r.nextStart){const d=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,o);if(d!==null&&r.len+d.len>=u)return this.log(`buffer full after gaps in "${o}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,r){let o=-1,u=!1,h=!0;for(let f=0,d=e.length;f<d;f++){const m=e[f];if(h=h&&!m.independent,o>-1&&r<m.start)break;const g=m.loaded;g?o=-1:(u||m.independent||h)&&m.fragment===t&&(o=f),u=g}return o}loadedEndOfParts(e,t){const r=e[e.length-1];return r&&t>r.start&&r.loaded}getInitialLiveFragment(e,t){const r=this.fragPrevious;let o=null;if(r){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),o=zle(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!o){const u=r.sn+1;if(u>=e.startSN&&u<=e.endSN){const h=t[u-e.startSN];r.cc===h.cc&&(o=h,this.log(`Live playlist, switching playlist, load frag with next SN: ${o.sn}`))}o||(o=Xle(t,r.cc),o&&this.log(`Live playlist, switching playlist, load frag with same CC: ${o.sn}`))}}else{const u=this.hls.liveSyncPosition;u!==null&&(o=this.getFragmentAtPosition(u,this.bitrateTest?e.fragmentEnd:e.edge,e))}return o}getFragmentAtPosition(e,t,r){const{config:o}=this;let{fragPrevious:u}=this,{fragments:h,endSN:f}=r;const{fragmentHint:d}=r,m=o.maxFragLookUpTolerance,g=!!(o.lowLatencyMode&&r.partList&&d);g&&d&&!this.bitrateTest&&(h=h.concat(d),f=d.sn);let v;if(e<t){const _=e>t-m?0:m;v=u0(u,h,e,_)}else v=h[h.length-1];if(v){const _=v.sn-r.startSN,S=this.fragmentTracker.getState(v);if((S===Bs.OK||S===Bs.PARTIAL&&v.gap)&&(u=v),u&&v.sn===u.sn&&!g&&u&&v.level===u.level){const T=h[_+1];v.sn<f&&this.fragmentTracker.getState(T)!==Bs.OK?v=T:v=null}}return v}synchronizeToLiveEdge(e){const{config:t,media:r}=this;if(!r)return;const o=this.hls.liveSyncPosition,u=r.currentTime,h=e.fragments[0].start,f=e.edge,d=u>=h-t.maxFragLookUpTolerance&&u<=f;if(o!==null&&r.duration>o&&(u<o||!d)){const m=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!d&&r.readyState<4||u<f-m)&&(this.loadedmetadata||(this.nextLoadPosition=o),r.readyState&&(this.warn(`Playback: ${u.toFixed(3)} is located too far from the end of live sliding playlist: ${f}, reset currentTime to : ${o.toFixed(3)}`),r.currentTime=o))}}alignPlaylists(e,t){const{levels:r,levelLastLoaded:o,fragPrevious:u}=this,h=o!==null?r[o]:null,f=e.fragments.length;if(!f)return this.warn("No fragments in live playlist"),0;const d=e.fragments[0].start,m=!t,g=e.alignedSliding&&Bn(d);if(m||!g&&!d){oue(u,h,e);const v=e.fragments[0].start;return this.log(`Live playlist sliding: ${v.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${u?u.sn:"na"} fragments: ${f}`),v}return d}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let r=this.startPosition;if(r<t&&(r=-1),r===-1||this.lastCurrentTime===-1){const o=this.startTimeOffset!==null,u=o?this.startTimeOffset:e.startTimeOffset;u!==null&&Bn(u)?(r=t+u,u<0&&(r+=e.totalduration),r=Math.min(Math.max(t,r),t+e.totalduration),this.log(`Start time offset ${u} found in ${o?"multivariant":"media"} playlist, adjust startPosition to ${r}`),this.startPosition=r):e.live?r=this.hls.liveSyncPosition||t:this.startPosition=r=0,this.lastCurrentTime=r}this.nextLoadPosition=r}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part"+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==rn.FRAG_LOADING_WAITING_RETRY)&&(this.state=rn.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const g=this.getCurrentContext(t.chunkMeta);g&&(t.frag=g.frag)}const r=t.frag;if(!r||r.type!==e||!this.levels)return;if(this.fragContextChanged(r)){var o;this.warn(`Frag load error must match current frag to retry ${r.url} > ${(o=this.fragCurrent)==null?void 0:o.url}`);return}const u=t.details===zt.FRAG_GAP;u&&this.fragmentTracker.fragBuffered(r,!0);const h=t.errorAction,{action:f,retryCount:d=0,retryConfig:m}=h||{};if(h&&f===sa.RetryRequest&&m){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);const g=S1(m,d);this.warn(`Fragment ${r.sn} of ${e} ${r.level} errored with ${t.details}, retrying loading ${d+1}/${m.maxNumRetry} in ${g}ms`),h.resolved=!0,this.retryDate=self.performance.now()+g,this.state=rn.FRAG_LOADING_WAITING_RETRY}else m&&h?(this.resetFragmentErrors(e),d<m.maxNumRetry?u||(h.resolved=!0):xt.warn(`${t.details} reached or exceeded max retry (${d})`)):this.state=rn.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===rn.PARSING||this.state===rn.PARSED){const t=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,t),o=r&&r.len>.5;o&&this.reduceMaxBufferLength(r.len);const u=!o;return u&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),u}return!1}resetFragmentErrors(e){e===Yn.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==rn.STOPPED&&(this.state=rn.IDLE)}afterBufferFlushed(e,t,r){if(!e)return;const o=fi.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,o,r),this.state===rn.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=rn.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=this.levels?this.levels[e].details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(e.level),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,r,o){var u;const h=r.details;if(!h){this.warn("level.details undefined");return}if(Object.keys(e.elementaryStreams).reduce((d,m)=>{const g=e.elementaryStreams[m];if(g){const v=g.endPTS-g.startPTS;if(v<=0)return this.warn(`Could not parse fragment ${e.sn} ${m} duration reliably (${v})`),d||!1;const _=o?0:TW(h,e,g.startPTS,g.endPTS,g.startDTS,g.endDTS);return this.hls.trigger(ke.LEVEL_PTS_UPDATED,{details:h,level:r,drift:_,type:m,frag:e,start:g.startPTS,end:g.endPTS}),!0}return d},!1))r.fragmentError=0;else if(((u=this.transmuxer)==null?void 0:u.error)===null){const d=new Error(`Found no media in fragment ${e.sn} of level ${r.id} resetting transmuxer to fallback to playlist timing`);if(this.warn(d.message),this.hls.trigger(ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:e,reason:`Found no media in msn ${e.sn} of level "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=rn.PARSED,this.hls.trigger(ke.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.resetTransmuxer(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function b1(){if(!(typeof self>"u"))return self.MediaSource||self.WebKitMediaSource}function RW(){return self.SourceBuffer||self.WebKitSourceBuffer}function mue(){const n=b1();if(!n)return!1;const e=RW(),t=n&&typeof n.isTypeSupported=="function"&&n.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),r=!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function";return!!t&&!!r}function vue(){var n;const e=RW();return typeof(e==null||(n=e.prototype)==null?void 0:n.changeType)=="function"}function yue(){return typeof __HLS_WORKER_BUNDLE__=="function"}function Eue(){const n=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(n);return{worker:new self.Worker(e),objectURL:e}}function _ue(n){const e=new self.URL(n,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function _l(n="",e=9e4){return{type:n,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class bW{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,r,o){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,r){}demux(e,t){this.cachedData&&(e=td(this.cachedData,e),this.cachedData=null);let r=J_(e,0),o=r?r.length:0,u;const h=this._audioTrack,f=this._id3Track,d=r?nle(r):void 0,m=e.length;for((this.basePTS===null||this.frameIndex===0&&Bn(d))&&(this.basePTS=Tue(d,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),r&&r.length>0&&f.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Go.audioId3,duration:Number.POSITIVE_INFINITY});o<m;){if(this.canParse(e,o)){const g=this.appendFrame(h,e,o);g?(this.frameIndex++,this.lastPTS=g.sample.pts,o+=g.length,u=o):o=m}else tle(e,o)?(r=J_(e,o),f.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Go.audioId3,duration:Number.POSITIVE_INFINITY}),o+=r.length,u=o):o++;if(o===m&&u!==m){const g=Vf(e,u);this.cachedData?this.cachedData=td(this.cachedData,g):this.cachedData=g}}return{audioTrack:h,videoTrack:_l(),id3Track:f,textTrack:_l()}}demuxSampleAes(e,t,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:_l(),id3Track:this._id3Track,textTrack:_l()}}destroy(){}}const Tue=(n,e,t)=>{if(Bn(n))return n*90;const r=t?t.baseTime*9e4/t.timescale:0;return e*9e4+r};function Sue(n,e,t,r){let o,u,h,f;const d=navigator.userAgent.toLowerCase(),m=r,g=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];o=((e[t+2]&192)>>>6)+1;const v=(e[t+2]&60)>>>2;if(v>g.length-1){n.trigger(ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${v}`});return}return h=(e[t+2]&1)<<2,h|=(e[t+3]&192)>>>6,xt.log(`manifest codec:${r}, ADTS type:${o}, samplingIndex:${v}`),/firefox/i.test(d)?v>=6?(o=5,f=new Array(4),u=v-3):(o=2,f=new Array(2),u=v):d.indexOf("android")!==-1?(o=2,f=new Array(2),u=v):(o=5,f=new Array(4),r&&(r.indexOf("mp4a.40.29")!==-1||r.indexOf("mp4a.40.5")!==-1)||!r&&v>=6?u=v-3:((r&&r.indexOf("mp4a.40.2")!==-1&&(v>=6&&h===1||/vivaldi/i.test(d))||!r&&h===1)&&(o=2,f=new Array(2)),u=v)),f[0]=o<<3,f[0]|=(v&14)>>1,f[1]|=(v&1)<<7,f[1]|=h<<3,o===5&&(f[1]|=(u&14)>>1,f[2]=(u&1)<<7,f[2]|=2<<2,f[3]=0),{config:f,samplerate:g[v],channelCount:h,codec:"mp4a.40."+o,manifestCodec:m}}function DW(n,e){return n[e]===255&&(n[e+1]&246)===240}function PW(n,e){return n[e+1]&1?7:9}function D1(n,e){return(n[e+3]&3)<<11|n[e+4]<<3|(n[e+5]&224)>>>5}function Aue(n,e){return e+5<n.length}function rT(n,e){return e+1<n.length&&DW(n,e)}function xue(n,e){return Aue(n,e)&&DW(n,e)&&D1(n,e)<=n.length-e}function Cue(n,e){if(rT(n,e)){const t=PW(n,e);if(e+t>=n.length)return!1;const r=D1(n,e);if(r<=t)return!1;const o=e+r;return o===n.length||rT(n,o)}return!1}function LW(n,e,t,r,o){if(!n.samplerate){const u=Sue(e,t,r,o);if(!u)return;n.config=u.config,n.samplerate=u.samplerate,n.channelCount=u.channelCount,n.codec=u.codec,n.manifestCodec=u.manifestCodec,xt.log(`parsed codec:${n.codec}, rate:${u.samplerate}, channels:${u.channelCount}`)}}function MW(n){return 1024*9e4/n}function Iue(n,e){const t=PW(n,e);if(e+t<=n.length){const r=D1(n,e)-t;if(r>0)return{headerLength:t,frameLength:r}}}function wW(n,e,t,r,o){const u=MW(n.samplerate),h=r+o*u,f=Iue(e,t);let d;if(f){const{frameLength:v,headerLength:_}=f,S=_+v,E=Math.max(0,t+S-e.length);E?(d=new Uint8Array(S-_),d.set(e.subarray(t+_,e.length),0)):d=e.subarray(t+_,t+S);const T={unit:d,pts:h};return E||n.samples.push(T),{sample:T,length:S,missing:E}}const m=e.length-t;return d=new Uint8Array(m),d.set(e.subarray(t,e.length),0),{sample:{unit:d,pts:h},length:m,missing:-1}}class Rue extends bW{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,r,o){super.resetInitSegment(e,t,r,o),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:o,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let r=(J_(e,0)||[]).length;for(let o=e.length;r<o;r++)if(Cue(e,r))return xt.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return xue(e,t)}appendFrame(e,t,r){LW(e,this.observer,t,r,e.manifestCodec);const o=wW(e,t,r,this.basePTS,this.frameIndex);if(o&&o.missing===0)return o}}const bue=/\/emsg[-/]ID3/i;class Due{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,r,o){const u=this.videoTrack=_l("video",1),h=this.audioTrack=_l("audio",1),f=this.txtTrack=_l("text",1);if(this.id3Track=_l("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const d=pW(e);if(d.video){const{id:m,timescale:g,codec:v}=d.video;u.id=m,u.timescale=f.timescale=g,u.codec=v}if(d.audio){const{id:m,timescale:g,codec:v}=d.audio;h.id=m,h.timescale=g,h.codec=v}f.id=fW.text,u.sampleDuration=0,u.duration=h.duration=o}resetContiguity(){}static probe(e){return e=e.length>16384?e.subarray(0,16384):e,xr(e,["moof"]).length>0}demux(e,t){this.timeOffset=t;let r=e;const o=this.videoTrack,u=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=td(this.remainderData,e));const f=vle(r);this.remainderData=f.remainder,o.samples=f.valid||new Uint8Array}else o.samples=r;const h=this.extractID3Track(o,t);return u.samples=_B(t,o),{videoTrack:o,audioTrack:this.audioTrack,id3Track:h,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const o=this.extractID3Track(t,this.timeOffset);return r.samples=_B(e,t),{videoTrack:t,audioTrack:_l(),id3Track:o,textTrack:_l()}}extractID3Track(e,t){const r=this.id3Track;if(e.samples.length){const o=xr(e.samples,["emsg"]);o&&o.forEach(u=>{const h=_le(u);if(bue.test(h.schemeIdUri)){const f=Bn(h.presentationTime)?h.presentationTime/h.timeScale:t+h.presentationTimeDelta/h.timeScale;let d=h.eventDuration===4294967295?Number.POSITIVE_INFINITY:h.eventDuration/h.timeScale;d<=.001&&(d=Number.POSITIVE_INFINITY);const m=h.payload;r.samples.push({data:m,len:m.byteLength,dts:f,pts:f,type:Go.emsg,duration:d})}})}return r}demuxSampleAes(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}let dE=null;const Pue=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Lue=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Mue=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],wue=[0,1,1,4];function OW(n,e,t,r,o){if(t+24>e.length)return;const u=NW(e,t);if(u&&t+u.frameLength<=e.length){const h=u.samplesPerFrame*9e4/u.sampleRate,f=r+o*h,d={unit:e.subarray(t,t+u.frameLength),pts:f,dts:f};return n.config=[],n.channelCount=u.channelCount,n.samplerate=u.sampleRate,n.samples.push(d),{sample:d,length:u.frameLength,missing:0}}}function NW(n,e){const t=n[e+1]>>3&3,r=n[e+1]>>1&3,o=n[e+2]>>4&15,u=n[e+2]>>2&3;if(t!==1&&o!==0&&o!==15&&u!==3){const h=n[e+2]>>1&1,f=n[e+3]>>6,d=t===3?3-r:r===3?3:4,m=Pue[d*14+o-1]*1e3,v=Lue[(t===3?0:t===2?1:2)*3+u],_=f===3?1:2,S=Mue[t][r],E=wue[r],T=S*8*E,C=Math.floor(S*m/v+h)*E;if(dE===null){const F=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);dE=F?parseInt(F[1]):0}return!!dE&&dE<=87&&r===2&&m>=224e3&&f===0&&(n[e+3]=n[e+3]|128),{sampleRate:v,channelCount:_,frameLength:C,samplesPerFrame:T}}}function P1(n,e){return n[e]===255&&(n[e+1]&224)===224&&(n[e+1]&6)!==0}function FW(n,e){return e+1<n.length&&P1(n,e)}function Oue(n,e){return P1(n,e)&&4<=n.length-e}function Nue(n,e){if(e+1<n.length&&P1(n,e)){const r=NW(n,e);let o=4;r!=null&&r.frameLength&&(o=r.frameLength);const u=e+o;return u===n.length||FW(n,u)}return!1}class GB{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,r=e.byteLength-t,o=new Uint8Array(4),u=Math.min(4,t);if(u===0)throw new Error("no bytes available");o.set(e.subarray(r,r+u)),this.word=new DataView(o.buffer).getUint32(0),this.bitsAvailable=u*8,this.bytesAvailable-=u}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const r=this.word>>>32-t;if(e>32&&xt.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?r<<t|this.readBits(t):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,r=8,o;for(let u=0;u<e;u++)r!==0&&(o=this.readEG(),r=(t+o+256)%256),t=r===0?t:r}readSPS(){let e=0,t=0,r=0,o=0,u,h,f;const d=this.readUByte.bind(this),m=this.readBits.bind(this),g=this.readUEG.bind(this),v=this.readBoolean.bind(this),_=this.skipBits.bind(this),S=this.skipEG.bind(this),E=this.skipUEG.bind(this),T=this.skipScalingList.bind(this);d();const C=d();if(m(5),_(3),d(),E(),C===100||C===110||C===122||C===244||C===44||C===83||C===86||C===118||C===128){const D=g();if(D===3&&_(1),E(),E(),_(1),v())for(h=D!==3?8:12,f=0;f<h;f++)v()&&(f<6?T(16):T(64))}E();const R=g();if(R===0)g();else if(R===1)for(_(1),S(),S(),u=g(),f=0;f<u;f++)S();E(),_(1);const b=g(),F=g(),O=m(1);O===0&&_(1),_(1),v()&&(e=g(),t=g(),r=g(),o=g());let L=[1,1];if(v()&&v())switch(d()){case 1:L=[1,1];break;case 2:L=[12,11];break;case 3:L=[10,11];break;case 4:L=[16,11];break;case 5:L=[40,33];break;case 6:L=[24,11];break;case 7:L=[20,11];break;case 8:L=[32,11];break;case 9:L=[80,33];break;case 10:L=[18,11];break;case 11:L=[15,11];break;case 12:L=[64,33];break;case 13:L=[160,99];break;case 14:L=[4,3];break;case 15:L=[3,2];break;case 16:L=[2,1];break;case 255:{L=[d()<<8|d(),d()<<8|d()];break}}return{width:Math.ceil((b+1)*16-e*2-t*2),height:(2-O)*(F+1)*16-(O?2:4)*(r+o),pixelRatio:L}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class Fue{constructor(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new I1(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,r){const o=e[t].unit;if(o.length<=16)return;const u=o.subarray(16,o.length-o.length%16),h=u.buffer.slice(u.byteOffset,u.byteOffset+u.length);this.decryptBuffer(h).then(f=>{const d=new Uint8Array(f);o.set(d,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,r)})}decryptAacSamples(e,t,r){for(;;t++){if(t>=e.length){r();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,r=new Int8Array(t);let o=0;for(let u=32;u<e.length-16;u+=160,o+=16)r.set(e.subarray(u,u+16),o);return r}getAvcDecryptedUnit(e,t){const r=new Uint8Array(t);let o=0;for(let u=32;u<e.length-16;u+=160,o+=16)e.set(r.subarray(o,o+16),u);return e}decryptAvcSample(e,t,r,o,u){const h=vW(u.data),f=this.getAvcEncryptedData(h);this.decryptBuffer(f.buffer).then(d=>{u.data=this.getAvcDecryptedUnit(h,d),this.decrypter.isSync()||this.decryptAvcSamples(e,t,r+1,o)})}decryptAvcSamples(e,t,r,o){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length){o();return}const u=e[t].units;for(;!(r>=u.length);r++){const h=u[r];if(!(h.data.length<=48||h.type!==1&&h.type!==5)&&(this.decryptAvcSample(e,t,r,o,h),!this.decrypter.isSync()))return}}}}const na=188;class yc{constructor(e,t,r){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=r}static probe(e){const t=yc.syncOffset(e);return t>0&&xt.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length,r=Math.min(na*5,e.length-na)+1;let o=0;for(;o<r;){let u=!1;for(let h=o;h<t&&e[h]===71;h+=na)if(!u&&Kb(e,h)===0&&(u=!0),u&&h+na>r)return o;o++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:fW[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,r,o){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=yc.createTrack("video"),this._audioTrack=yc.createTrack("audio",o),this._id3Track=yc.createTrack("id3"),this._txtTrack=yc.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=r,this._duration=o}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_avcTrack:t,_id3Track:r}=this;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(e,t,r=!1,o=!1){r||(this.sampleAes=null);let u;const h=this._avcTrack,f=this._audioTrack,d=this._id3Track,m=this._txtTrack;let g=h.pid,v=h.pesData,_=f.pid,S=d.pid,E=f.pesData,T=d.pesData,C=null,R=this.pmtParsed,b=this._pmtId,F=e.length;if(this.remainderData&&(e=td(this.remainderData,e),F=e.length,this.remainderData=null),F<na&&!o)return this.remainderData=e,{audioTrack:f,videoTrack:h,id3Track:d,textTrack:m};const O=Math.max(0,yc.syncOffset(e));F-=(F-O)%na,F<e.byteLength&&!o&&(this.remainderData=new Uint8Array(e.buffer,F,e.buffer.byteLength-F));let L=0;for(let x=O;x<F;x+=na)if(e[x]===71){const B=!!(e[x+1]&64),M=Kb(e,x),I=(e[x+3]&48)>>4;let U;if(I>1){if(U=x+5+e[x+4],U===x+na)continue}else U=x+4;switch(M){case g:B&&(v&&(u=nh(v))&&this.parseAVCPES(h,m,u,!1),v={data:[],size:0}),v&&(v.data.push(e.subarray(U,x+na)),v.size+=x+na-U);break;case _:if(B){if(E&&(u=nh(E)))switch(f.segmentCodec){case"aac":this.parseAACPES(f,u);break;case"mp3":this.parseMPEGPES(f,u);break}E={data:[],size:0}}E&&(E.data.push(e.subarray(U,x+na)),E.size+=x+na-U);break;case S:B&&(T&&(u=nh(T))&&this.parseID3PES(d,u),T={data:[],size:0}),T&&(T.data.push(e.subarray(U,x+na)),T.size+=x+na-U);break;case 0:B&&(U+=e[U]+1),b=this._pmtId=kue(e,U);break;case b:{B&&(U+=e[U]+1);const w=Uue(e,U,this.typeSupported,r);g=w.avc,g>0&&(h.pid=g),_=w.audio,_>0&&(f.pid=_,f.segmentCodec=w.segmentCodec),S=w.id3,S>0&&(d.pid=S),C!==null&&!R&&(xt.warn(`MPEG-TS PMT found at ${x} after unknown PID '${C}'. Backtracking to sync byte @${O} to parse all TS packets.`),C=null,x=O-188),R=this.pmtParsed=!0;break}case 17:case 8191:break;default:C=M;break}}else L++;if(L>0){const x=new Error(`Found ${L} TS packet/s that do not start with 0x47`);this.observer.emit(ke.ERROR,ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.FRAG_PARSING_ERROR,fatal:!1,error:x,reason:x.message})}h.pesData=v,f.pesData=E,d.pesData=T;const D={audioTrack:f,videoTrack:h,id3Track:d,textTrack:m};return o&&this.extractRemainingSamples(D),D}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:r,id3Track:o,textTrack:u}=e,h=r.pesData,f=t.pesData,d=o.pesData;let m;if(h&&(m=nh(h))?(this.parseAVCPES(r,u,m,!0),r.pesData=null):r.pesData=h,f&&(m=nh(f))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,m);break;case"mp3":this.parseMPEGPES(t,m);break}t.pesData=null}else f!=null&&f.size&&xt.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=f;d&&(m=nh(d))?(this.parseID3PES(o,m),o.pesData=null):o.pesData=d}demuxSampleAes(e,t,r){const o=this.demux(e,r,!0,!this.config.progressive),u=this.sampleAes=new Fue(this.observer,this.config,t);return this.decrypt(o,u)}decrypt(e,t){return new Promise(r=>{const{audioTrack:o,videoTrack:u}=e;o.samples&&o.segmentCodec==="aac"?t.decryptAacSamples(o.samples,0,()=>{u.samples?t.decryptAvcSamples(u.samples,0,0,()=>{r(e)}):r(e)}):u.samples&&t.decryptAvcSamples(u.samples,0,0,()=>{r(e)})})}destroy(){this._duration=0}parseAVCPES(e,t,r,o){const u=this.parseAVCNALu(e,r.data);let h=this.avcSample,f,d=!1;r.data=null,h&&u.length&&!e.audFound&&(wI(h,e),h=this.avcSample=hE(!1,r.pts,r.dts,"")),u.forEach(m=>{switch(m.type){case 1:{f=!0,h||(h=this.avcSample=hE(!0,r.pts,r.dts,"")),h.frame=!0;const g=m.data;if(d&&g.length>4){const v=new GB(g).readSliceType();(v===2||v===4||v===7||v===9)&&(h.key=!0)}break}case 5:f=!0,h||(h=this.avcSample=hE(!0,r.pts,r.dts,"")),h.key=!0,h.frame=!0;break;case 6:{f=!0,mW(m.data,1,r.pts,t.samples);break}case 7:if(f=!0,d=!0,!e.sps){const g=m.data,_=new GB(g).readSPS();e.width=_.width,e.height=_.height,e.pixelRatio=_.pixelRatio,e.sps=[g],e.duration=this._duration;const S=g.subarray(1,4);let E="avc1.";for(let T=0;T<3;T++){let C=S[T].toString(16);C.length<2&&(C="0"+C),E+=C}e.codec=E}break;case 8:f=!0,e.pps||(e.pps=[m.data]);break;case 9:f=!1,e.audFound=!0,h&&wI(h,e),h=this.avcSample=hE(!1,r.pts,r.dts,"");break;case 12:f=!0;break;default:f=!1,h&&(h.debug+="unknown NAL "+m.type+" ");break}h&&f&&h.units.push(m)}),o&&h&&(wI(h,e),this.avcSample=null)}getLastNalUnit(e){var t;let r=this.avcSample,o;if((!r||r.units.length===0)&&(r=e[e.length-1]),(t=r)!=null&&t.units){const u=r.units;o=u[u.length-1]}return o}parseAVCNALu(e,t){const r=t.byteLength;let o=e.naluState||0;const u=o,h=[];let f=0,d,m,g,v=-1,_=0;for(o===-1&&(v=0,_=t[0]&31,o=0,f=1);f<r;){if(d=t[f++],!o){o=d?0:1;continue}if(o===1){o=d?0:2;continue}if(!d)o=3;else if(d===1){if(v>=0){const S={data:t.subarray(v,f-o-1),type:_};h.push(S)}else{const S=this.getLastNalUnit(e.samples);if(S&&(u&&f<=4-u&&S.state&&(S.data=S.data.subarray(0,S.data.byteLength-u)),m=f-o-1,m>0)){const E=new Uint8Array(S.data.byteLength+m);E.set(S.data,0),E.set(t.subarray(0,m),S.data.byteLength),S.data=E,S.state=0}}f<r?(g=t[f]&31,v=f,_=g,o=0):o=-1}else o=0}if(v>=0&&o>=0){const S={data:t.subarray(v,r),type:_,state:o};h.push(S)}if(h.length===0){const S=this.getLastNalUnit(e.samples);if(S){const E=new Uint8Array(S.data.byteLength+t.byteLength);E.set(S.data,0),E.set(t,S.data.byteLength),S.data=E}}return e.naluState=o,h}parseAACPES(e,t){let r=0;const o=this.aacOverFlow;let u=t.data;if(o){this.aacOverFlow=null;const v=o.missing,_=o.sample.unit.byteLength;if(v===-1){const S=new Uint8Array(_+u.byteLength);S.set(o.sample.unit,0),S.set(u,_),u=S}else{const S=_-v;o.sample.unit.set(u.subarray(0,v),S),e.samples.push(o.sample),r=o.missing}}let h,f;for(h=r,f=u.length;h<f-1&&!rT(u,h);h++);if(h!==r){let v;const _=h<f-1;_?v=`AAC PES did not start with ADTS header,offset:${h}`:v="No ADTS header found in AAC PES";const S=new Error(v);if(xt.warn(`parsing error: ${v}`),this.observer.emit(ke.ERROR,ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.FRAG_PARSING_ERROR,fatal:!1,levelRetry:_,error:S,reason:v}),!_)return}LW(e,this.observer,u,h,this.audioCodec);let d;if(t.pts!==void 0)d=t.pts;else if(o){const v=MW(e.samplerate);d=o.sample.pts+v}else{xt.warn("[tsdemuxer]: AAC PES unknown PTS");return}let m=0,g;for(;h<f;)if(g=wW(e,u,h,d,m),h+=g.length,g.missing){this.aacOverFlow=g;break}else for(m++;h<f-1&&!rT(u,h);h++);}parseMPEGPES(e,t){const r=t.data,o=r.length;let u=0,h=0;const f=t.pts;if(f===void 0){xt.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;h<o;)if(FW(r,h)){const d=OW(e,r,h,f,u);if(d)h+=d.length,u++;else break}else h++}parseID3PES(e,t){if(t.pts===void 0){xt.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const r=Xi({},t,{type:this._avcTrack?Go.emsg:Go.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}}function hE(n,e,t,r){return{key:n,frame:!1,pts:e,dts:t,units:[],debug:r,length:0}}function Kb(n,e){return((n[e+1]&31)<<8)+n[e+2]}function kue(n,e){return(n[e+10]&31)<<8|n[e+11]}function Uue(n,e,t,r){const o={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},u=(n[e+1]&15)<<8|n[e+2],h=e+3+u-4,f=(n[e+10]&15)<<8|n[e+11];for(e+=12+f;e<h;){const d=Kb(n,e);switch(n[e]){case 207:if(!r){xt.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:o.audio===-1&&(o.audio=d);break;case 21:o.id3===-1&&(o.id3=d);break;case 219:if(!r){xt.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:o.avc===-1&&(o.avc=d);break;case 3:case 4:t.mpeg!==!0&&t.mp3!==!0?xt.log("MPEG audio found, not supported in this browser"):o.audio===-1&&(o.audio=d,o.segmentCodec="mp3");break;case 36:xt.warn("Unsupported HEVC stream type found");break}e+=((n[e+3]&15)<<8|n[e+4])+5}return o}function nh(n){let e=0,t,r,o,u,h;const f=n.data;if(!n||n.size===0)return null;for(;f[0].length<19&&f.length>1;){const m=new Uint8Array(f[0].length+f[1].length);m.set(f[0]),m.set(f[1],f[0].length),f[0]=m,f.splice(1,1)}if(t=f[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(r=(t[4]<<8)+t[5],r&&r>n.size-6)return null;const m=t[7];m&192&&(u=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,m&64?(h=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,u-h>60*9e4&&(xt.warn(`${Math.round((u-h)/9e4)}s delta between PTS and DTS, align them`),u=h)):h=u),o=t[8];let g=o+9;if(n.size<=g)return null;n.size-=g;const v=new Uint8Array(n.size);for(let _=0,S=f.length;_<S;_++){t=f[_];let E=t.byteLength;if(g)if(g>E){g-=E;continue}else t=t.subarray(g),E-=g,g=0;v.set(t,e),e+=E}return r&&(r-=o+3),{data:v,pts:u,dts:h,len:r}}return null}function wI(n,e){if(n.units.length&&n.frame){if(n.pts===void 0){const t=e.samples,r=t.length;if(r){const o=t[r-1];n.pts=o.pts,n.dts=o.dts}else{e.dropped++;return}}e.samples.push(n)}n.debug.length&&xt.log(n.pts+"/"+n.dts+":"+n.debug)}class Bue extends bW{resetInitSegment(e,t,r,o){super.resetInitSegment(e,t,r,o),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:o,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let r=(J_(e,0)||[]).length;for(let o=e.length;r<o;r++)if(Nue(e,r))return xt.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return Oue(e,t)}appendFrame(e,t,r){if(this.basePTS!==null)return OW(e,t,r,this.basePTS,this.frameIndex)}}class WB{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const hc=Math.pow(2,32)-1;class kt{static init(){kt.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in kt.types)kt.types.hasOwnProperty(e)&&(kt.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);kt.HDLR_TYPES={video:t,audio:r};const o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),u=new Uint8Array([0,0,0,0,0,0,0,0]);kt.STTS=kt.STSC=kt.STCO=u,kt.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),kt.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),kt.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),kt.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const h=new Uint8Array([105,115,111,109]),f=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);kt.FTYP=kt.box(kt.types.ftyp,h,d,h,f),kt.DINF=kt.box(kt.types.dinf,kt.box(kt.types.dref,o))}static box(e,...t){let r=8,o=t.length;const u=o;for(;o--;)r+=t[o].byteLength;const h=new Uint8Array(r);for(h[0]=r>>24&255,h[1]=r>>16&255,h[2]=r>>8&255,h[3]=r&255,h.set(e,4),o=0,r=8;o<u;o++)h.set(t[o],r),r+=t[o].byteLength;return h}static hdlr(e){return kt.box(kt.types.hdlr,kt.HDLR_TYPES[e])}static mdat(e){return kt.box(kt.types.mdat,e)}static mdhd(e,t){t*=e;const r=Math.floor(t/(hc+1)),o=Math.floor(t%(hc+1));return kt.box(kt.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,o>>24,o>>16&255,o>>8&255,o&255,85,196,0,0]))}static mdia(e){return kt.box(kt.types.mdia,kt.mdhd(e.timescale,e.duration),kt.hdlr(e.type),kt.minf(e))}static mfhd(e){return kt.box(kt.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?kt.box(kt.types.minf,kt.box(kt.types.smhd,kt.SMHD),kt.DINF,kt.stbl(e)):kt.box(kt.types.minf,kt.box(kt.types.vmhd,kt.VMHD),kt.DINF,kt.stbl(e))}static moof(e,t,r){return kt.box(kt.types.moof,kt.mfhd(e),kt.traf(r,t))}static moov(e){let t=e.length;const r=[];for(;t--;)r[t]=kt.trak(e[t]);return kt.box.apply(null,[kt.types.moov,kt.mvhd(e[0].timescale,e[0].duration)].concat(r).concat(kt.mvex(e)))}static mvex(e){let t=e.length;const r=[];for(;t--;)r[t]=kt.trex(e[t]);return kt.box.apply(null,[kt.types.mvex,...r])}static mvhd(e,t){t*=e;const r=Math.floor(t/(hc+1)),o=Math.floor(t%(hc+1)),u=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,o>>24,o>>16&255,o>>8&255,o&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return kt.box(kt.types.mvhd,u)}static sdtp(e){const t=e.samples||[],r=new Uint8Array(4+t.length);let o,u;for(o=0;o<t.length;o++)u=t[o].flags,r[o+4]=u.dependsOn<<4|u.isDependedOn<<2|u.hasRedundancy;return kt.box(kt.types.sdtp,r)}static stbl(e){return kt.box(kt.types.stbl,kt.stsd(e),kt.box(kt.types.stts,kt.STTS),kt.box(kt.types.stsc,kt.STSC),kt.box(kt.types.stsz,kt.STSZ),kt.box(kt.types.stco,kt.STCO))}static avc1(e){let t=[],r=[],o,u,h;for(o=0;o<e.sps.length;o++)u=e.sps[o],h=u.byteLength,t.push(h>>>8&255),t.push(h&255),t=t.concat(Array.prototype.slice.call(u));for(o=0;o<e.pps.length;o++)u=e.pps[o],h=u.byteLength,r.push(h>>>8&255),r.push(h&255),r=r.concat(Array.prototype.slice.call(u));const f=kt.box(kt.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(r))),d=e.width,m=e.height,g=e.pixelRatio[0],v=e.pixelRatio[1];return kt.box(kt.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,d&255,m>>8&255,m&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),f,kt.box(kt.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),kt.box(kt.types.pasp,new Uint8Array([g>>24,g>>16&255,g>>8&255,g&255,v>>24,v>>16&255,v>>8&255,v&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static mp4a(e){const t=e.samplerate;return kt.box(kt.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0]),kt.box(kt.types.esds,kt.esds(e)))}static mp3(e){const t=e.samplerate;return kt.box(kt.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0]))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?kt.box(kt.types.stsd,kt.STSD,kt.mp3(e)):kt.box(kt.types.stsd,kt.STSD,kt.mp4a(e)):kt.box(kt.types.stsd,kt.STSD,kt.avc1(e))}static tkhd(e){const t=e.id,r=e.duration*e.timescale,o=e.width,u=e.height,h=Math.floor(r/(hc+1)),f=Math.floor(r%(hc+1));return kt.box(kt.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,h>>24,h>>16&255,h>>8&255,h&255,f>>24,f>>16&255,f>>8&255,f&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,o>>8&255,o&255,0,0,u>>8&255,u&255,0,0]))}static traf(e,t){const r=kt.sdtp(e),o=e.id,u=Math.floor(t/(hc+1)),h=Math.floor(t%(hc+1));return kt.box(kt.types.traf,kt.box(kt.types.tfhd,new Uint8Array([0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255])),kt.box(kt.types.tfdt,new Uint8Array([1,0,0,0,u>>24,u>>16&255,u>>8&255,u&255,h>>24,h>>16&255,h>>8&255,h&255])),kt.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,kt.box(kt.types.trak,kt.tkhd(e),kt.mdia(e))}static trex(e){const t=e.id;return kt.box(kt.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const r=e.samples||[],o=r.length,u=12+16*o,h=new Uint8Array(u);let f,d,m,g,v,_;for(t+=8+u,h.set([e.type==="video"?1:0,0,15,1,o>>>24&255,o>>>16&255,o>>>8&255,o&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),f=0;f<o;f++)d=r[f],m=d.duration,g=d.size,v=d.flags,_=d.cts,h.set([m>>>24&255,m>>>16&255,m>>>8&255,m&255,g>>>24&255,g>>>16&255,g>>>8&255,g&255,v.isLeading<<2|v.dependsOn,v.isDependedOn<<6|v.hasRedundancy<<4|v.paddingValue<<1|v.isNonSync,v.degradPrio&240<<8,v.degradPrio&15,_>>>24&255,_>>>16&255,_>>>8&255,_&255],12+16*f);return kt.box(kt.types.trun,h)}static initSegment(e){kt.types||kt.init();const t=kt.moov(e),r=new Uint8Array(kt.FTYP.byteLength+t.byteLength);return r.set(kt.FTYP),r.set(t,kt.FTYP.byteLength),r}}kt.types=void 0;kt.HDLR_TYPES=void 0;kt.STTS=void 0;kt.STSC=void 0;kt.STCO=void 0;kt.STSZ=void 0;kt.VMHD=void 0;kt.SMHD=void 0;kt.STSD=void 0;kt.FTYP=void 0;kt.DINF=void 0;const kW=9e4;function L1(n,e,t=1,r=!1){const o=n*e*t;return r?Math.round(o):o}function jue(n,e,t=1,r=!1){return L1(n,e,1/t,r)}function Hg(n,e=!1){return L1(n,1e3,1/kW,e)}function Kue(n,e=1){return L1(n,kW,1/e)}const Gue=10*1e3,HB=1024,Wue=1152;let pE=null,OI=null;class NI{constructor(e,t,r,o=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,pE===null){const h=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);pE=h?parseInt(h[1]):0}if(OI===null){const u=navigator.userAgent.match(/Safari\/(\d+)/i);OI=u?parseInt(u[1]):0}}destroy(){}resetTimeStamp(e){xt.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){xt.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){xt.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(e){let t=!1;const r=e.reduce((o,u)=>{const h=u.pts-o;return h<-4294967296?(t=!0,io(o,u.pts)):h>0?o:u.pts},e[0].pts);return t&&xt.debug("PTS rollover detected"),r}remux(e,t,r,o,u,h,f,d){let m,g,v,_,S,E,T=u,C=u;const R=e.pid>-1,b=t.pid>-1,F=t.samples.length,O=e.samples.length>0,L=f&&F>0||F>1;if((!R||O)&&(!b||L)||this.ISGenerated||f){this.ISGenerated||(v=this.generateIS(e,t,u,h));const x=this.isVideoContiguous;let B=-1,M;if(L&&(B=Hue(t.samples),!x&&this.config.forceKeyFrameOnDiscontinuity))if(E=!0,B>0){xt.warn(`[mp4-remuxer]: Dropped ${B} out of ${F} video samples due to a missing keyframe`);const I=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(B),t.dropped+=B,C+=(t.samples[0].pts-I)/t.inputTimeScale,M=C}else B===-1&&(xt.warn(`[mp4-remuxer]: No keyframe found out of ${F} video samples`),E=!1);if(this.ISGenerated){if(O&&L){const I=this.getVideoStartPts(t.samples),w=(io(e.samples[0].pts,I)-I)/t.inputTimeScale;T+=Math.max(0,w),C+=Math.max(0,-w)}if(O){if(e.samplerate||(xt.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),v=this.generateIS(e,t,u,h)),g=this.remuxAudio(e,T,this.isAudioContiguous,h,b||L||d===Yn.AUDIO?C:void 0),L){const I=g?g.endPTS-g.startPTS:0;t.inputTimeScale||(xt.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),v=this.generateIS(e,t,u,h)),m=this.remuxVideo(t,C,x,I)}}else L&&(m=this.remuxVideo(t,C,x,0));m&&(m.firstKeyFrame=B,m.independent=B!==-1,m.firstKeyFramePTS=M)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(S=UW(r,u,this._initPTS,this._initDTS)),o.samples.length&&(_=BW(o,u,this._initPTS))),{audio:g,video:m,initSegment:v,independent:E,text:_,id3:S}}generateIS(e,t,r,o){const u=e.samples,h=t.samples,f=this.typeSupported,d={},m=this._initPTS;let g=!m||o,v="audio/mp4",_,S,E;if(g&&(_=S=1/0),e.config&&u.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":f.mpeg?(v="audio/mpeg",e.codec=""):f.mp3&&(e.codec="mp3");break}d.audio={id:"audio",container:v,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&f.mpeg?new Uint8Array(0):kt.initSegment([e]),metadata:{channelCount:e.channelCount}},g&&(E=e.inputTimeScale,!m||E!==m.timescale?_=S=u[0].pts-Math.round(E*r):g=!1)}if(t.sps&&t.pps&&h.length&&(t.timescale=t.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:kt.initSegment([t]),metadata:{width:t.width,height:t.height}},g))if(E=t.inputTimeScale,!m||E!==m.timescale){const T=this.getVideoStartPts(h),C=Math.round(E*r);S=Math.min(S,io(h[0].dts,T)-C),_=Math.min(_,T-C)}else g=!1;if(Object.keys(d).length)return this.ISGenerated=!0,g?(this._initPTS={baseTime:_,timescale:E},this._initDTS={baseTime:S,timescale:E}):_=E=void 0,{tracks:d,initPTS:_,timescale:E}}remuxVideo(e,t,r,o){const u=e.inputTimeScale,h=e.samples,f=[],d=h.length,m=this._initPTS;let g=this.nextAvcDts,v=8,_=this.videoSampleDuration,S,E,T=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,R=!1;if(!r||g===null){const ee=t*u,ue=h[0].pts-io(h[0].dts,h[0].pts);g=ee-ue}const b=m.baseTime*u/m.timescale;for(let ee=0;ee<d;ee++){const ue=h[ee];ue.pts=io(ue.pts-b,g),ue.dts=io(ue.dts-b,g),ue.dts<h[ee>0?ee-1:ee].dts&&(R=!0)}R&&h.sort(function(ee,ue){const ie=ee.dts-ue.dts,Q=ee.pts-ue.pts;return ie||Q}),S=h[0].dts,E=h[h.length-1].dts;const F=E-S,O=F?Math.round(F/(d-1)):_||e.inputTimeScale/30;if(r){const ee=S-g,ue=ee>O,ie=ee<-1;if((ue||ie)&&(ue?xt.warn(`AVC: ${Hg(ee,!0)} ms (${ee}dts) hole between fragments detected, filling it`):xt.warn(`AVC: ${Hg(-ee,!0)} ms (${ee}dts) overlapping between fragments detected`),!ie||g>h[0].pts)){S=g;const Q=h[0].pts-ee;h[0].dts=S,h[0].pts=Q,xt.log(`Video: First PTS/DTS adjusted: ${Hg(Q,!0)}/${Hg(S,!0)}, delta: ${Hg(ee,!0)} ms`)}}S=Math.max(0,S);let L=0,D=0;for(let ee=0;ee<d;ee++){const ue=h[ee],ie=ue.units,Q=ie.length;let se=0;for(let ve=0;ve<Q;ve++)se+=ie[ve].data.length;D+=se,L+=Q,ue.length=se,ue.dts=Math.max(ue.dts,S),T=Math.min(ue.pts,T),C=Math.max(ue.pts,C)}E=h[d-1].dts;const x=D+4*L+8;let B;try{B=new Uint8Array(x)}catch(ee){this.observer.emit(ke.ERROR,ke.ERROR,{type:$n.MUX_ERROR,details:zt.REMUX_ALLOC_ERROR,fatal:!1,error:ee,bytes:x,reason:`fail allocating video mdat ${x}`});return}const M=new DataView(B.buffer);M.setUint32(0,x),B.set(kt.types.mdat,4);let I=!1,U=Number.POSITIVE_INFINITY,w=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY,K=Number.NEGATIVE_INFINITY;for(let ee=0;ee<d;ee++){const ue=h[ee],ie=ue.units;let Q=0;for(let _e=0,Z=ie.length;_e<Z;_e++){const Ee=ie[_e],Se=Ee.data,Me=Ee.data.byteLength;M.setUint32(v,Me),v+=4,B.set(Se,v),v+=Me,Q+=4+Me}let se;if(ee<d-1)_=h[ee+1].dts-ue.dts,se=h[ee+1].pts-ue.pts;else{const _e=this.config,Z=ee>0?ue.dts-h[ee-1].dts:O;if(se=ee>0?ue.pts-h[ee-1].pts:O,_e.stretchShortVideoTrack&&this.nextAudioPts!==null){const Ee=Math.floor(_e.maxBufferHole*u),Se=(o?T+o*u:this.nextAudioPts)-ue.pts;Se>Ee?(_=Se-Z,_<0?_=Z:I=!0,xt.log(`[mp4-remuxer]: It is approximately ${Se/90} ms to the next segment; using duration ${_/90} ms for the last video frame.`)):_=Z}else _=Z}const ve=Math.round(ue.pts-ue.dts);U=Math.min(U,_),k=Math.max(k,_),w=Math.min(w,se),K=Math.max(K,se),f.push(new VB(ue.key,_,Q,ve))}if(f.length){if(pE){if(pE<70){const ee=f[0].flags;ee.dependsOn=2,ee.isNonSync=0}}else if(OI&&K-w<k-U&&O/k<.025&&f[0].cts===0){xt.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let ee=S;for(let ue=0,ie=f.length;ue<ie;ue++){const Q=ee+f[ue].duration,se=ee+f[ue].cts;if(ue<ie-1){const ve=Q+f[ue+1].cts;f[ue].duration=ve-se}else f[ue].duration=ue?f[ue-1].duration:O;f[ue].cts=0,ee=Q}}}_=I||!_?O:_,this.nextAvcDts=g=E+_,this.videoSampleDuration=_,this.isVideoContiguous=!0;const W=kt.moof(e.sequenceNumber++,S,Xi({},e,{samples:f})),Y="video",J={data1:W,data2:B,startPTS:T/u,endPTS:(C+_)/u,startDTS:S/u,endDTS:g/u,type:Y,hasAudio:!1,hasVideo:!0,nb:f.length,dropped:e.dropped};return e.samples=[],e.dropped=0,J}remuxAudio(e,t,r,o,u){const h=e.inputTimeScale,f=e.samplerate?e.samplerate:h,d=h/f,m=e.segmentCodec==="aac"?HB:Wue,g=m*d,v=this._initPTS,_=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,S=[],E=u!==void 0;let T=e.samples,C=_?0:8,R=this.nextAudioPts||-1;const b=t*h,F=v.baseTime*h/v.timescale;if(this.isAudioContiguous=r=r||T.length&&R>0&&(o&&Math.abs(b-R)<9e3||Math.abs(io(T[0].pts-F,b)-R)<20*g),T.forEach(function(Y){Y.pts=io(Y.pts-F,b)}),!r||R<0){if(T=T.filter(Y=>Y.pts>=0),!T.length)return;u===0?R=0:o&&!E?R=Math.max(0,b):R=T[0].pts}if(e.segmentCodec==="aac"){const Y=this.config.maxAudioFramesDrift;for(let J=0,ee=R;J<T.length;J++){const ue=T[J],ie=ue.pts,Q=ie-ee,se=Math.abs(1e3*Q/h);if(Q<=-Y*g&&E)J===0&&(xt.warn(`Audio frame @ ${(ie/h).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*Q/h)} ms.`),this.nextAudioPts=R=ee=ie);else if(Q>=Y*g&&se<Gue&&E){let ve=Math.round(Q/g);ee=ie-ve*g,ee<0&&(ve--,ee+=g),J===0&&(this.nextAudioPts=R=ee),xt.warn(`[mp4-remuxer]: Injecting ${ve} audio frame @ ${(ee/h).toFixed(3)}s due to ${Math.round(1e3*Q/h)} ms gap.`);for(let _e=0;_e<ve;_e++){const Z=Math.max(ee,0);let Ee=WB.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);Ee||(xt.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Ee=ue.unit.subarray()),T.splice(J,0,{unit:Ee,pts:Z}),ee+=g,J++}}ue.pts=ee,ee+=g}}let O=null,L=null,D,x=0,B=T.length;for(;B--;)x+=T[B].unit.byteLength;for(let Y=0,J=T.length;Y<J;Y++){const ee=T[Y],ue=ee.unit;let ie=ee.pts;if(L!==null){const se=S[Y-1];se.duration=Math.round((ie-L)/d)}else if(r&&e.segmentCodec==="aac"&&(ie=R),O=ie,x>0){x+=C;try{D=new Uint8Array(x)}catch(se){this.observer.emit(ke.ERROR,ke.ERROR,{type:$n.MUX_ERROR,details:zt.REMUX_ALLOC_ERROR,fatal:!1,error:se,bytes:x,reason:`fail allocating audio mdat ${x}`});return}_||(new DataView(D.buffer).setUint32(0,x),D.set(kt.types.mdat,4))}else return;D.set(ue,C);const Q=ue.byteLength;C+=Q,S.push(new VB(!0,m,Q,0)),L=ie}const M=S.length;if(!M)return;const I=S[S.length-1];this.nextAudioPts=R=L+d*I.duration;const U=_?new Uint8Array(0):kt.moof(e.sequenceNumber++,O/d,Xi({},e,{samples:S}));e.samples=[];const w=O/h,k=R/h,W={data1:U,data2:D,startPTS:w,endPTS:k,startDTS:w,endDTS:k,type:"audio",hasAudio:!0,hasVideo:!1,nb:M};return this.isAudioContiguous=!0,W}remuxEmptyAudio(e,t,r,o){const u=e.inputTimeScale,h=e.samplerate?e.samplerate:u,f=u/h,d=this.nextAudioPts,m=this._initDTS,g=m.baseTime*9e4/m.timescale,v=(d!==null?d:o.startDTS*u)+g,_=o.endDTS*u+g,S=f*HB,E=Math.ceil((_-v)/S),T=WB.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(xt.warn("[mp4-remuxer]: remux empty Audio"),!T){xt.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const C=[];for(let R=0;R<E;R++){const b=v+R*S;C.push({unit:T,pts:b,dts:b})}return e.samples=C,this.remuxAudio(e,t,r,!1)}}function io(n,e){let t;if(e===null)return n;for(e<n?t=-8589934592:t=8589934592;Math.abs(n-e)>4294967296;)n+=t;return n}function Hue(n){for(let e=0;e<n.length;e++)if(n[e].key)return e;return-1}function UW(n,e,t,r){const o=n.samples.length;if(!o)return;const u=n.inputTimeScale;for(let f=0;f<o;f++){const d=n.samples[f];d.pts=io(d.pts-t.baseTime*9e4/t.timescale,e*u)/u,d.dts=io(d.dts-r.baseTime*9e4/r.timescale,e*u)/u}const h=n.samples;return n.samples=[],{samples:h}}function BW(n,e,t){const r=n.samples.length;if(!r)return;const o=n.inputTimeScale;for(let h=0;h<r;h++){const f=n.samples[h];f.pts=io(f.pts-t.baseTime*9e4/t.timescale,e*o)/o}n.samples.sort((h,f)=>h.pts-f.pts);const u=n.samples;return n.samples=[],{samples:u}}class VB{constructor(e,t,r,o){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=r,this.cts=o,this.flags=new Vue(e)}}class Vue{constructor(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}}class $ue{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,r,o){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(dle(e,o)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:r}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const o=this.initData=pW(e);t||(t=$B(o.audio,jr.AUDIO)),r||(r=$B(o.video,jr.VIDEO));const u={};o.audio&&o.video?u.audiovideo={container:"video/mp4",codec:t+","+r,initSegment:e,id:"main"}:o.audio?u.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:o.video?u.video={container:"video/mp4",codec:r,initSegment:e,id:"main"}:xt.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=u}remux(e,t,r,o,u,h){var f,d;let{initPTS:m,lastEndTime:g}=this;const v={audio:void 0,video:void 0,text:o,id3:r,initSegment:void 0};Bn(g)||(g=this.lastEndTime=u||0);const _=t.samples;if(!(_!=null&&_.length))return v;const S={initPTS:void 0,timescale:1};let E=this.initData;if((f=E)!=null&&f.length||(this.generateInitSegment(_),E=this.initData),!((d=E)!=null&&d.length))return xt.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),v;this.emitInitSegment&&(S.tracks=this.initTracks,this.emitInitSegment=!1);const T=hle(E,_),C=T===null?u:T;(zue(m,C,u)||S.timescale!==m.timescale&&h)&&(S.initPTS=C-u,this.initPTS=m={baseTime:S.initPTS,timescale:1});const R=ple(_,E),b=e?C-m.baseTime/m.timescale:g,F=b+R;mle(E,_,m.baseTime/m.timescale),R>0?this.lastEndTime=F:(xt.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const O=!!E.audio,L=!!E.video;let D="";O&&(D+="audio"),L&&(D+="video");const x={data1:_,startPTS:b,startDTS:b,endPTS:F,endDTS:F,type:D,hasAudio:O,hasVideo:L,nb:1,dropped:0};return v.audio=x.type==="audio"?x:void 0,v.video=x.type!=="audio"?x:void 0,v.initSegment=S,v.id3=UW(r,u,m,m),o.samples.length&&(v.text=BW(o,u,m)),v}}function zue(n,e,t){if(n===null)return!0;const r=e-n.baseTime/n.timescale;return r<0&&Math.abs(r-t)>1}function $B(n,e){const t=n==null?void 0:n.codec;return t&&t.length>4?t:t==="hvc1"||t==="hev1"?"hvc1.1.c.L120.90":t==="av01"?"av01.0.04M.08":t==="avc1"||e===jr.VIDEO?"avc1.42e01e":"mp4a.40.5"}let _u;try{_u=self.performance.now.bind(self.performance)}catch{xt.debug("Unable to use Performance API on this environment"),_u=typeof self<"u"&&self.Date.now}const FI=[{demux:Due,remux:$ue},{demux:yc,remux:NI},{demux:Rue,remux:NI},{demux:Bue,remux:NI}];class zB{constructor(e,t,r,o,u){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.vendor=o,this.id=u}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,r,o){const u=r.transmuxing;u.executeStart=_u();let h=new Uint8Array(e);const{currentTransmuxState:f,transmuxConfig:d}=this;o&&(this.currentTransmuxState=o);const{contiguous:m,discontinuity:g,trackSwitch:v,accurateTimeOffset:_,timeOffset:S,initSegmentChange:E}=o||f,{audioCodec:T,videoCodec:C,defaultInitPts:R,duration:b,initSegmentData:F}=d,O=Yue(h,t);if(O&&O.method==="AES-128"){const B=this.getDecrypter();if(B.isSync()){let M=B.softwareDecrypt(h,O.key.buffer,O.iv.buffer);if(r.part>-1&&(M=B.flush()),!M)return u.executeEnd=_u(),kI(r);h=new Uint8Array(M)}else return this.decryptionPromise=B.webCryptoDecrypt(h,O.key.buffer,O.iv.buffer).then(M=>{const I=this.push(M,null,r);return this.decryptionPromise=null,I}),this.decryptionPromise}const L=this.needsProbing(g,v);if(L){const B=this.configureTransmuxer(h);if(B)return xt.warn(`[transmuxer] ${B.message}`),this.observer.emit(ke.ERROR,ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.FRAG_PARSING_ERROR,fatal:!1,error:B,reason:B.message}),u.executeEnd=_u(),kI(r)}(g||v||E||L)&&this.resetInitSegment(F,T,C,b,t),(g||E||L)&&this.resetInitialTimestamp(R),m||this.resetContiguity();const D=this.transmux(h,O,S,_,r),x=this.currentTransmuxState;return x.contiguous=!0,x.discontinuity=!1,x.trackSwitch=!1,u.executeEnd=_u(),D}flush(e){const t=e.transmuxing;t.executeStart=_u();const{decrypter:r,currentTransmuxState:o,decryptionPromise:u}=this;if(u)return u.then(()=>this.flush(e));const h=[],{timeOffset:f}=o;if(r){const v=r.flush();v&&h.push(this.push(v,null,e))}const{demuxer:d,remuxer:m}=this;if(!d||!m)return t.executeEnd=_u(),[kI(e)];const g=d.flush(f);return UE(g)?g.then(v=>(this.flushRemux(h,v,e),h)):(this.flushRemux(h,g,e),h)}flushRemux(e,t,r){const{audioTrack:o,videoTrack:u,id3Track:h,textTrack:f}=t,{accurateTimeOffset:d,timeOffset:m}=this.currentTransmuxState;xt.log(`[transmuxer.ts]: Flushed fragment ${r.sn}${r.part>-1?" p: "+r.part:""} of level ${r.level}`);const g=this.remuxer.remux(o,u,h,f,m,d,!0,this.id);e.push({remuxResult:g,chunkMeta:r}),r.transmuxing.executeEnd=_u()}resetInitialTimestamp(e){const{demuxer:t,remuxer:r}=this;!t||!r||(t.resetTimeStamp(e),r.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,r,o,u){const{demuxer:h,remuxer:f}=this;!h||!f||(h.resetInitSegment(e,t,r,o),f.resetInitSegment(e,t,r,u))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,r,o,u){let h;return t&&t.method==="SAMPLE-AES"?h=this.transmuxSampleAes(e,t,r,o,u):h=this.transmuxUnencrypted(e,r,o,u),h}transmuxUnencrypted(e,t,r,o){const{audioTrack:u,videoTrack:h,id3Track:f,textTrack:d}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(u,h,f,d,t,r,!1,this.id),chunkMeta:o}}transmuxSampleAes(e,t,r,o,u){return this.demuxer.demuxSampleAes(e,t,r).then(h=>({remuxResult:this.remuxer.remux(h.audioTrack,h.videoTrack,h.id3Track,h.textTrack,r,o,!1,this.id),chunkMeta:u}))}configureTransmuxer(e){const{config:t,observer:r,typeSupported:o,vendor:u}=this;let h;for(let v=0,_=FI.length;v<_;v++)if(FI[v].demux.probe(e)){h=FI[v];break}if(!h)return new Error("Failed to find demuxer by probing fragment data");const f=this.demuxer,d=this.remuxer,m=h.remux,g=h.demux;(!d||!(d instanceof m))&&(this.remuxer=new m(r,t,o,u)),(!f||!(f instanceof g))&&(this.demuxer=new g(r,t,o),this.probe=g.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new I1(this.config)),e}}function Yue(n,e){let t=null;return n.byteLength>0&&e!=null&&e.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const kI=n=>({remuxResult:{},chunkMeta:n});function UE(n){return"then"in n&&n.then instanceof Function}class Xue{constructor(e,t,r,o,u){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=o,this.defaultInitPts=u||null}}class que{constructor(e,t,r,o,u,h){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=o,this.timeOffset=u,this.initSegmentChange=h}}var c0={},Que={get exports(){return c0},set exports(n){c0=n}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function o(d,m,g){this.fn=d,this.context=m,this.once=g||!1}function u(d,m,g,v,_){if(typeof g!="function")throw new TypeError("The listener must be a function");var S=new o(g,v||d,_),E=t?t+m:m;return d._events[E]?d._events[E].fn?d._events[E]=[d._events[E],S]:d._events[E].push(S):(d._events[E]=S,d._eventsCount++),d}function h(d,m){--d._eventsCount===0?d._events=new r:delete d._events[m]}function f(){this._events=new r,this._eventsCount=0}f.prototype.eventNames=function(){var m=[],g,v;if(this._eventsCount===0)return m;for(v in g=this._events)e.call(g,v)&&m.push(t?v.slice(1):v);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(g)):m},f.prototype.listeners=function(m){var g=t?t+m:m,v=this._events[g];if(!v)return[];if(v.fn)return[v.fn];for(var _=0,S=v.length,E=new Array(S);_<S;_++)E[_]=v[_].fn;return E},f.prototype.listenerCount=function(m){var g=t?t+m:m,v=this._events[g];return v?v.fn?1:v.length:0},f.prototype.emit=function(m,g,v,_,S,E){var T=t?t+m:m;if(!this._events[T])return!1;var C=this._events[T],R=arguments.length,b,F;if(C.fn){switch(C.once&&this.removeListener(m,C.fn,void 0,!0),R){case 1:return C.fn.call(C.context),!0;case 2:return C.fn.call(C.context,g),!0;case 3:return C.fn.call(C.context,g,v),!0;case 4:return C.fn.call(C.context,g,v,_),!0;case 5:return C.fn.call(C.context,g,v,_,S),!0;case 6:return C.fn.call(C.context,g,v,_,S,E),!0}for(F=1,b=new Array(R-1);F<R;F++)b[F-1]=arguments[F];C.fn.apply(C.context,b)}else{var O=C.length,L;for(F=0;F<O;F++)switch(C[F].once&&this.removeListener(m,C[F].fn,void 0,!0),R){case 1:C[F].fn.call(C[F].context);break;case 2:C[F].fn.call(C[F].context,g);break;case 3:C[F].fn.call(C[F].context,g,v);break;case 4:C[F].fn.call(C[F].context,g,v,_);break;default:if(!b)for(L=1,b=new Array(R-1);L<R;L++)b[L-1]=arguments[L];C[F].fn.apply(C[F].context,b)}}return!0},f.prototype.on=function(m,g,v){return u(this,m,g,v,!1)},f.prototype.once=function(m,g,v){return u(this,m,g,v,!0)},f.prototype.removeListener=function(m,g,v,_){var S=t?t+m:m;if(!this._events[S])return this;if(!g)return h(this,S),this;var E=this._events[S];if(E.fn)E.fn===g&&(!_||E.once)&&(!v||E.context===v)&&h(this,S);else{for(var T=0,C=[],R=E.length;T<R;T++)(E[T].fn!==g||_&&!E[T].once||v&&E[T].context!==v)&&C.push(E[T]);C.length?this._events[S]=C.length===1?C[0]:C:h(this,S)}return this},f.prototype.removeAllListeners=function(m){var g;return m?(g=t?t+m:m,this._events[g]&&h(this,g)):(this._events=new r,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=t,f.EventEmitter=f,n.exports=f})(Que);const UI=b1()||{isTypeSupported:()=>!1};class jW{constructor(e,t,r,o){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const u=e.config;this.hls=e,this.id=t,this.useWorker=!!u.enableWorker,this.onTransmuxComplete=r,this.onFlush=o;const h=(m,g)=>{g=g||{},g.frag=this.frag,g.id=this.id,m===ke.ERROR&&(this.error=g.error),this.hls.trigger(m,g)};this.observer=new c0,this.observer.on(ke.FRAG_DECRYPTED,h),this.observer.on(ke.ERROR,h);const f={mp4:UI.isTypeSupported("video/mp4"),mpeg:UI.isTypeSupported("audio/mpeg"),mp3:UI.isTypeSupported('audio/mp4; codecs="mp3"')},d=navigator.vendor;if(this.useWorker&&typeof Worker<"u"&&(u.workerPath||yue())){try{u.workerPath?(xt.log(`loading Web Worker ${u.workerPath} for "${t}"`),this.workerContext=_ue(u.workerPath)):(xt.log(`injecting Web Worker for "${t}"`),this.workerContext=Eue()),this.onwmsg=v=>this.onWorkerMessage(v);const{worker:g}=this.workerContext;g.addEventListener("message",this.onwmsg),g.onerror=v=>{const _=new Error(`${v.message}  (${v.filename}:${v.lineno})`);u.enableWorker=!1,xt.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(ke.ERROR,{type:$n.OTHER_ERROR,details:zt.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:_})},g.postMessage({cmd:"init",typeSupported:f,vendor:d,id:t,config:JSON.stringify(u)})}catch(g){xt.warn(`Error setting up "${t}" Web Worker, fallback to inline`,g),this.resetWorker(),this.error=null,this.transmuxer=new zB(this.observer,f,u,d,t)}return}this.transmuxer=new zB(this.observer,f,u,d,t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,r,o,u,h,f,d,m,g){var v,_;m.transmuxing.start=self.performance.now();const{transmuxer:S}=this,E=h?h.start:u.start,T=u.decryptdata,C=this.frag,R=!(C&&u.cc===C.cc),b=!(C&&m.level===C.level),F=C?m.sn-C.sn:-1,O=this.part?m.part-this.part.index:-1,L=F===0&&m.id>1&&m.id===(C==null?void 0:C.stats.chunkCount),D=!b&&(F===1||F===0&&(O===1||L&&O<=0)),x=self.performance.now();(b||F||u.stats.parsing.start===0)&&(u.stats.parsing.start=x),h&&(O||!D)&&(h.stats.parsing.start=x);const B=!(C&&((v=u.initSegment)==null?void 0:v.url)===((_=C.initSegment)==null?void 0:_.url)),M=new que(R,D,d,b,E,B);if(!D||R||B){xt.log(`[transmuxer-interface, ${u.type}]: Starting new transmux session for sn: ${m.sn} p: ${m.part} level: ${m.level} id: ${m.id}
        discontinuity: ${R}
        trackSwitch: ${b}
        contiguous: ${D}
        accurateTimeOffset: ${d}
        timeOffset: ${E}
        initSegmentChange: ${B}`);const I=new Xue(r,o,t,f,g);this.configureTransmuxer(I)}if(this.frag=u,this.part=h,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:T,chunkMeta:m,state:M},e instanceof ArrayBuffer?[e]:[]);else if(S){const I=S.push(e,T,m,M);UE(I)?(S.async=!0,I.then(U=>{this.handleTransmuxComplete(U)}).catch(U=>{this.transmuxerError(U,m,"transmuxer-interface push error")})):(S.async=!1,this.handleTransmuxComplete(I))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let r=t.flush(e);UE(r)||t.async?(UE(r)||(r=Promise.resolve(r)),r.then(u=>{this.handleFlushResult(u,e)}).catch(u=>{this.transmuxerError(u,e,"transmuxer-interface flush error")})):this.handleFlushResult(r,e)}}transmuxerError(e,t,r){this.hls&&(this.error=e,this.hls.trigger(ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:r}))}handleFlushResult(e,t){e.forEach(r=>{this.handleTransmuxComplete(r)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data,r=this.hls;switch(t.event){case"init":{var o;const u=(o=this.workerContext)==null?void 0:o.objectURL;u&&self.URL.revokeObjectURL(u);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":xt[t.data.logType]&&xt[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const Jue=250,BI=2,Zue=.1,ece=.05;class tce{constructor(e,t,r,o){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=r,this.hls=o}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:r,media:o,stalled:u}=this;if(o===null)return;const{currentTime:h,seeking:f}=o,d=this.seeking&&!f,m=!this.seeking&&f;if(this.seeking=f,h!==e){if(this.moved=!0,u!==null){if(this.stallReported){const R=self.performance.now()-u;xt.warn(`playback not stuck anymore @${h}, after ${Math.round(R)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(m||d){this.stalled=null;return}if(o.paused&&!f||o.ended||o.playbackRate===0||!fi.getBuffered(o).length)return;const g=fi.bufferInfo(o,h,0),v=g.len>0,_=g.nextStart||0;if(!v&&!_)return;if(f){const R=g.len>BI,b=!_||t&&t.start<=h||_-h>BI&&!this.fragmentTracker.getPartialFragment(h);if(R||b)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var S;const R=Math.max(_,g.start||0)-h,b=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,O=(b==null||(S=b.details)==null?void 0:S.live)?b.details.targetduration*2:BI,L=this.fragmentTracker.getPartialFragment(h);if(R>0&&(R<=O||L)){this._trySkipBufferHole(L);return}}const E=self.performance.now();if(u===null){this.stalled=E;return}const T=E-u;if(!f&&T>=Jue&&(this._reportStall(g),!this.media))return;const C=fi.bufferInfo(o,h,r.maxBufferHole);this._tryFixBufferStall(C,T)}_tryFixBufferStall(e,t){const{config:r,fragmentTracker:o,media:u}=this;if(u===null)return;const h=u.currentTime,f=o.getPartialFragment(h);f&&(this._trySkipBufferHole(f)||!this.media)||(e.len>r.maxBufferHole||e.nextStart&&e.nextStart-h<r.maxBufferHole)&&t>r.highBufferWatchdogPeriod*1e3&&(xt.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:r,stallReported:o}=this;if(!o&&r){this.stallReported=!0;const u=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${JSON.stringify(e)})`);xt.warn(u.message),t.trigger(ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.BUFFER_STALLED_ERROR,fatal:!1,error:u,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:r,media:o}=this;if(o===null)return 0;const u=o.currentTime,h=fi.bufferInfo(o,u,0),f=u<h.start?h.start:h.nextStart;if(f){const d=h.len<=t.maxBufferHole,m=h.len>0&&h.len<1&&o.readyState<3,g=f-u;if(g>0&&(d||m)){if(g>t.maxBufferHole){const{fragmentTracker:_}=this;let S=!1;if(u===0){const E=_.getAppendedFrag(0,Yn.MAIN);E&&f<E.end&&(S=!0)}if(!S){const E=e||_.getAppendedFrag(u,Yn.MAIN);if(E){let T=!1,C=E.end;for(;C<f;){const R=_.getPartialFragment(C);if(R)C+=R.duration;else{T=!0;break}}if(T)return 0}}}const v=Math.max(f+ece,u+Zue);if(xt.warn(`skipping hole, adjusting currentTime from ${u} to ${v}`),this.moved=!0,this.stalled=null,o.currentTime=v,e&&!e.gap){const _=new Error(`fragment loaded with buffer holes, seeking from ${u} to ${v}`);r.trigger(ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:_,reason:_.message,frag:e})}return v}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:r,nudgeRetry:o}=this;if(r===null)return;const u=r.currentTime;if(this.nudgeRetry++,o<e.nudgeMaxRetry){const h=u+(o+1)*e.nudgeOffset,f=new Error(`Nudging 'currentTime' from ${u} to ${h}`);xt.warn(f.message),r.currentTime=h,t.trigger(ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.BUFFER_NUDGE_ON_STALL,error:f,fatal:!1})}else{const h=new Error(`Playhead still not moving while enough data buffered @${u} after ${e.nudgeMaxRetry} nudges`);xt.error(h.message),t.trigger(ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.BUFFER_STALLED_ERROR,error:h,fatal:!0})}}}const nce=100;class rce extends R1{constructor(e,t,r){super(e,t,r,"[stream-controller]",Yn.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(ke.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(ke.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.on(ke.MANIFEST_PARSED,this.onManifestParsed,this),e.on(ke.LEVEL_LOADING,this.onLevelLoading,this),e.on(ke.LEVEL_LOADED,this.onLevelLoaded,this),e.on(ke.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(ke.ERROR,this.onError,this),e.on(ke.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(ke.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(ke.BUFFER_CREATED,this.onBufferCreated,this),e.on(ke.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(ke.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(ke.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(ke.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(ke.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.off(ke.MANIFEST_PARSED,this.onManifestParsed,this),e.off(ke.LEVEL_LOADED,this.onLevelLoaded,this),e.off(ke.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(ke.ERROR,this.onError,this),e.off(ke.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(ke.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(ke.BUFFER_CREATED,this.onBufferCreated,this),e.off(ke.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(ke.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(ke.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:r}=this;if(this.stopLoad(),this.setInterval(nce),this.level=-1,!this.startFragRequested){let o=r.startLevel;o===-1&&(r.config.testBandwidth&&this.levels.length>1?(o=0,this.bitrateTest=!0):o=r.nextAutoLevel),this.level=r.nextLoadLevel=o,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=rn.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=rn.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case rn.WAITING_LEVEL:{var e;const{levels:r,level:o}=this,u=r==null||(e=r[o])==null?void 0:e.details;if(u&&(!u.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(u))break;this.state=rn.IDLE;break}break}case rn.FRAG_LOADING_WAITING_RETRY:{var t;const r=self.performance.now(),o=this.retryDate;(!o||r>=o||(t=this.media)!=null&&t.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=rn.IDLE)}break}this.state===rn.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:r,media:o}=this,{config:u,nextLoadLevel:h}=e;if(t===null||!o&&(this.startFragRequested||!u.startFragPrefetch)||this.altAudio&&this.audioOnly||!(r!=null&&r[h]))return;const f=r[h],d=this.getMainFwdBufferInfo();if(d===null)return;const m=this.getLevelDetails();if(m&&this._streamEnded(d,m)){const C={};this.altAudio&&(C.type="video"),this.hls.trigger(ke.BUFFER_EOS,C),this.state=rn.ENDED;return}e.loadLevel!==h&&e.manualLevel===-1&&this.log(`Adapting to level ${h} from level ${this.level}`),this.level=e.nextLoadLevel=h;const g=f.details;if(!g||this.state===rn.WAITING_LEVEL||g.live&&this.levelLastLoaded!==h){this.level=h,this.state=rn.WAITING_LEVEL;return}const v=d.len,_=this.getMaxBufferLength(f.maxBitrate);if(v>=_)return;this.backtrackFragment&&this.backtrackFragment.start>d.end&&(this.backtrackFragment=null);const S=this.backtrackFragment?this.backtrackFragment.start:d.end;let E=this.getNextFragment(S,g);if(this.couldBacktrack&&!this.fragPrevious&&E&&E.sn!=="initSegment"&&this.fragmentTracker.getState(E)!==Bs.OK){var T;const R=((T=this.backtrackFragment)!=null?T:E).sn-g.startSN,b=g.fragments[R-1];b&&E.cc===b.cc&&(E=b,this.fragmentTracker.removeFragment(b))}else this.backtrackFragment&&d.len&&(this.backtrackFragment=null);if(E&&this.isLoopLoading(E,S)){if(!E.gap){const R=this.audioOnly&&!this.altAudio?jr.AUDIO:jr.VIDEO,b=(R===jr.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;b&&this.afterBufferFlushed(b,R,Yn.MAIN)}E=this.getNextFragmentLoopLoading(E,g,d,Yn.MAIN,_)}E&&(E.initSegment&&!E.initSegment.data&&!this.bitrateTest&&(E=E.initSegment),this.loadFragment(E,f,S))}loadFragment(e,t,r){const o=this.fragmentTracker.getState(e);this.fragCurrent=e,o===Bs.NOT_LOADED?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,r)):this.clearTrackerIfNeeded(e)}getAppendedFrag(e){const t=this.fragmentTracker.getAppendedFrag(e,Yn.MAIN);return t&&"fragment"in t?t.fragment:t}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Yn.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let r;const o=this.getAppendedFrag(t.currentTime);if(o&&o.start>1&&this.flushMainBuffer(0,o.start-1),!t.paused&&e){const h=this.hls.nextLoadLevel,f=e[h],d=this.fragLastKbps;d&&this.fragCurrent?r=this.fragCurrent.duration*f.maxBitrate/(1e3*d)+1:r=0}else r=0;const u=this.getBufferedFrag(t.currentTime+r);if(u){const h=this.followingBufferedFrag(u);if(h){this.abortCurrentFrag();const f=h.maxStartPTS?h.maxStartPTS:h.start,d=h.duration,m=Math.max(u.end,f+Math.min(Math.max(d-this.config.maxFragLookUpTolerance,d*.5),d*.75));this.flushMainBuffer(m,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case rn.KEY_LOADING:case rn.FRAG_LOADING:case rn.FRAG_LOADING_WAITING_RETRY:case rn.PARSING:case rn.PARSED:this.state=rn.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const r=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),r.addEventListener("playing",this.onvplaying),r.addEventListener("seeked",this.onvseeked),this.gapController=new tce(this.config,r,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;Bn(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const r=this.getMainFwdBufferInfo();if(r===null||r.len===0){this.warn(`Main forward buffer length on "seeked" event ${r?r.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(ke.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null}onManifestParsed(e,t){let r=!1,o=!1,u;t.levels.forEach(h=>{u=h.audioCodec,u&&(u.indexOf("mp4a.40.2")!==-1&&(r=!0),u.indexOf("mp4a.40.5")!==-1&&(o=!0))}),this.audioCodecSwitch=r&&o&&!vue(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:r}=this;if(!r||this.state!==rn.IDLE)return;const o=r[t.level];(!o.details||o.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(o.details))&&(this.state=rn.WAITING_LEVEL)}onLevelLoaded(e,t){var r;const{levels:o}=this,u=t.level,h=t.details,f=h.totalduration;if(!o){this.warn(`Levels were reset while loading level ${u}`);return}this.log(`Level ${u} loaded [${h.startSN},${h.endSN}], cc [${h.startCC}, ${h.endCC}] duration:${f}`);const d=o[u],m=this.fragCurrent;m&&(this.state===rn.FRAG_LOADING||this.state===rn.FRAG_LOADING_WAITING_RETRY)&&(m.level!==t.level||m.urlId!==d.urlId)&&m.loader&&this.abortCurrentFrag();let g=0;if(h.live||(r=d.details)!=null&&r.live){if(h.fragments[0]||(h.deltaUpdateFailed=!0),h.deltaUpdateFailed)return;g=this.alignPlaylists(h,d.details)}if(d.details=h,this.levelLastLoaded=u,this.hls.trigger(ke.LEVEL_UPDATED,{details:h,level:u}),this.state===rn.WAITING_LEVEL){if(this.waitForCdnTuneIn(h))return;this.state=rn.IDLE}this.startFragRequested?h.live&&this.synchronizeToLiveEdge(h):this.setStartPosition(h,g),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:r,part:o,payload:u}=e,{levels:h}=this;if(!h){this.warn(`Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const f=h[r.level],d=f.details;if(!d){this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),this.fragmentTracker.removeFragment(r);return}const m=f.videoCodec,g=d.PTSKnown||!d.live,v=(t=r.initSegment)==null?void 0:t.data,_=this._getAudioCodec(f),S=this.transmuxer=this.transmuxer||new jW(this.hls,Yn.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),E=o?o.index:-1,T=E!==-1,C=new x1(r.level,r.sn,r.stats.chunkCount,u.byteLength,E,T),R=this.initPTS[r.cc];S.push(u,v,_,m,r,o,d.totalduration,g,C,R)}onAudioTrackSwitching(e,t){const r=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const h=this.fragCurrent;h&&(this.log("Switching to main audio track, cancel main fragment load"),h.abortRequests(),this.fragmentTracker.removeFragment(h)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const u=this.hls;r&&(u.trigger(ke.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),u.trigger(ke.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const r=t.id,o=!!this.hls.audioTracks[r].url;if(o){const u=this.videoBuffer;u&&this.mediaBuffer!==u&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=u)}this.altAudio=o,this.tick()}onBufferCreated(e,t){const r=t.tracks;let o,u,h=!1;for(const f in r){const d=r[f];if(d.id==="main"){if(u=f,o=d,f==="video"){const m=r[f];m&&(this.videoBuffer=m.buffer)}}else h=!0}h&&o?(this.log(`Alternate track found, use ${u}.buffered to schedule main fragment loading`),this.mediaBuffer=o.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:r,part:o}=t;if(r&&r.type!==Yn.MAIN)return;if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${o?" p: "+o.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`),this.state===rn.PARSED&&(this.state=rn.IDLE);return}const u=o?o.stats:r.stats;this.fragLastKbps=Math.round(8*u.total/(u.buffering.end-u.loading.first)),r.sn!=="initSegment"&&(this.fragPrevious=r),this.fragBufferedComplete(r,o)}onError(e,t){var r;if(t.fatal){this.state=rn.ERROR;return}switch(t.details){case zt.FRAG_GAP:case zt.FRAG_PARSING_ERROR:case zt.FRAG_DECRYPT_ERROR:case zt.FRAG_LOAD_ERROR:case zt.FRAG_LOAD_TIMEOUT:case zt.KEY_LOAD_ERROR:case zt.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Yn.MAIN,t);break;case zt.LEVEL_LOAD_ERROR:case zt.LEVEL_LOAD_TIMEOUT:case zt.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===rn.WAITING_LEVEL&&((r=t.context)==null?void 0:r.type)===br.LEVEL&&(this.state=rn.IDLE);break;case zt.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case zt.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!fi.getBuffered(e).length){const r=this.state!==rn.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,r)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=rn.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==jr.AUDIO||this.audioOnly&&!this.altAudio){const r=(t===jr.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(r,t,Yn.MAIN)}}onLevelsUpdated(e,t){this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let r=this.startPosition;if(r>=0&&t<r){if(e.seeking){this.log(`could not seek to ${r}, already seeking at ${t}`);return}const o=fi.getBuffered(e),h=(o.length?o.start(0):0)-r;h>0&&(h<this.config.maxBufferHole||h<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${h} to match buffer start`),r+=h,this.startPosition=r),this.log(`seek to target start position ${r} from current time ${t}`),e.currentTime=r}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(r=>{const{hls:o}=this;if(!r||this.fragContextChanged(e))return;t.fragmentError=0,this.state=rn.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const u=e.stats;u.parsing.start=u.parsing.end=u.buffering.start=u.buffering.end=self.performance.now(),o.trigger(ke.FRAG_LOADED,r),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const r="main",{hls:o}=this,{remuxResult:u,chunkMeta:h}=e,f=this.getCurrentContext(h);if(!f){this.resetWhenMissingContext(h);return}const{frag:d,part:m,level:g}=f,{video:v,text:_,id3:S,initSegment:E}=u,{details:T}=g,C=this.altAudio?void 0:u.audio;if(this.fragContextChanged(d)){this.fragmentTracker.removeFragment(d);return}if(this.state=rn.PARSING,E){E.tracks&&(this._bufferInitSegment(g,E.tracks,d,h),o.trigger(ke.FRAG_PARSING_INIT_SEGMENT,{frag:d,id:r,tracks:E.tracks}));const R=E.initPTS,b=E.timescale;Bn(R)&&(this.initPTS[d.cc]={baseTime:R,timescale:b},o.trigger(ke.INIT_PTS_FOUND,{frag:d,id:r,initPTS:R,timescale:b}))}if(v&&u.independent!==!1){if(T){const{startPTS:R,endPTS:b,startDTS:F,endDTS:O}=v;if(m)m.elementaryStreams[v.type]={startPTS:R,endPTS:b,startDTS:F,endDTS:O};else if(v.firstKeyFrame&&v.independent&&h.id===1&&(this.couldBacktrack=!0),v.dropped&&v.independent){const L=this.getMainFwdBufferInfo(),D=(L?L.end:this.getLoadPosition())+this.config.maxBufferHole,x=v.firstKeyFramePTS?v.firstKeyFramePTS:R;if(D<x-this.config.maxBufferHole){this.backtrack(d);return}d.setElementaryStreamInfo(v.type,d.start,b,d.start,O,!0)}d.setElementaryStreamInfo(v.type,R,b,F,O),this.backtrackFragment&&(this.backtrackFragment=d),this.bufferFragmentData(v,d,m,h)}}else if(u.independent===!1){this.backtrack(d);return}if(C){const{startPTS:R,endPTS:b,startDTS:F,endDTS:O}=C;m&&(m.elementaryStreams[jr.AUDIO]={startPTS:R,endPTS:b,startDTS:F,endDTS:O}),d.setElementaryStreamInfo(jr.AUDIO,R,b,F,O),this.bufferFragmentData(C,d,m,h)}if(T&&S!=null&&(t=S.samples)!=null&&t.length){const R={id:r,frag:d,details:T,samples:S.samples};o.trigger(ke.FRAG_PARSING_METADATA,R)}if(T&&_){const R={id:r,frag:d,details:T,samples:_.samples};o.trigger(ke.FRAG_PARSING_USERDATA,R)}}_bufferInitSegment(e,t,r,o){if(this.state!==rn.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:u,video:h,audiovideo:f}=t;if(u){let d=e.audioCodec;const m=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(d&&(d.indexOf("mp4a.40.5")!==-1?d="mp4a.40.2":d="mp4a.40.5"),u.metadata.channelCount!==1&&m.indexOf("firefox")===-1&&(d="mp4a.40.5")),m.indexOf("android")!==-1&&u.container!=="audio/mpeg"&&(d="mp4a.40.2",this.log(`Android: force audio codec to ${d}`)),e.audioCodec&&e.audioCodec!==d&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${d}"`),u.levelCodec=d,u.id="main",this.log(`Init audio buffer, container:${u.container}, codecs[selected/level/parsed]=[${d||""}/${e.audioCodec||""}/${u.codec}]`)}h&&(h.levelCodec=e.videoCodec,h.id="main",this.log(`Init video buffer, container:${h.container}, codecs[level/parsed]=[${e.videoCodec||""}/${h.codec}]`)),f&&this.log(`Init audiovideo buffer, container:${f.container}, codecs[level/parsed]=[${e.attrs.CODECS||""}/${f.codec}]`),this.hls.trigger(ke.BUFFER_CODECS,t),Object.keys(t).forEach(d=>{const g=t[d].initSegment;g!=null&&g.byteLength&&this.hls.trigger(ke.BUFFER_APPENDING,{type:d,data:g,frag:r,part:null,chunkMeta:o,parent:r.type})}),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Yn.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=rn.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const r=e.currentTime;if(fi.isBuffered(e,r)?t=this.getAppendedFrag(r):fi.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;const o=this.fragPlaying,u=t.level;(!o||t.sn!==o.sn||o.level!==u||t.urlId!==o.urlId)&&(this.fragPlaying=t,this.hls.trigger(ke.FRAG_CHANGED,{frag:t}),(!o||o.level!==u)&&this.hls.trigger(ke.LEVEL_SWITCHED,{level:u}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,r=this.currentFrag;if(r&&Bn(t)&&Bn(r.programDateTime)){const o=r.programDateTime+(t-r.start)*1e3;return new Date(o)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class rh{constructor(e,t=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}sample(e,t){const r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class ice{constructor(e,t,r,o=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new rh(e),this.fast_=new rh(t),this.defaultTTFB_=o,this.ttfb_=new rh(e)}update(e,t){const{slow_:r,fast_:o,ttfb_:u}=this;r.halfLife!==e&&(this.slow_=new rh(e,r.getEstimate(),r.getTotalWeight())),o.halfLife!==t&&(this.fast_=new rh(t,o.getEstimate(),o.getTotalWeight())),u.halfLife!==e&&(this.ttfb_=new rh(e,u.getEstimate(),u.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const r=8*t,o=e/1e3,u=r/o;this.fast_.sample(o,u),this.slow_.sample(o,u)}sampleTTFB(e){const t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class sce{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;const t=e.config;this.bwEstimator=new ice(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(ke.FRAG_LOADING,this.onFragLoading,this),e.on(ke.FRAG_LOADED,this.onFragLoaded,this),e.on(ke.FRAG_BUFFERED,this.onFragBuffered,this),e.on(ke.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(ke.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){const{hls:e}=this;e.off(ke.FRAG_LOADING,this.onFragLoading,this),e.off(ke.FRAG_LOADED,this.onFragLoaded,this),e.off(ke.FRAG_BUFFERED,this.onFragBuffered,this),e.off(ke.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(ke.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(e,t){var r;const o=t.frag;this.ignoreFragment(o)||(this.fragCurrent=o,this.partCurrent=(r=t.part)!=null?r:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(e,t){this.clearTimer()}getTimeToLoadFrag(e,t,r,o){const u=e+r/t,h=o?this.lastLevelLoadSec:0;return u+h}onLevelLoaded(e,t){const r=this.hls.config,{total:o,bwEstimate:u}=t.stats;Bn(o)&&Bn(u)&&(this.lastLevelLoadSec=8*o/u),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD)}_abandonRulesCheck(){const{fragCurrent:e,partCurrent:t,hls:r}=this,{autoLevelEnabled:o,media:u}=r;if(!e||!u)return;const h=performance.now(),f=t?t.stats:e.stats,d=t?t.duration:e.duration,m=h-f.loading.start;if(f.aborted||f.loaded&&f.loaded===f.total||e.level===0){this.clearTimer(),this._nextAutoLevel=-1;return}if(!o||u.paused||!u.playbackRate||!u.readyState)return;const g=r.mainForwardBufferInfo;if(g===null)return;const v=this.bwEstimator.getEstimateTTFB(),_=Math.abs(u.playbackRate);if(m<=Math.max(v,1e3*(d/(_*2))))return;const S=g.len/_;if(S>=2*d/_)return;const E=f.loading.first?f.loading.first-f.loading.start:-1,T=f.loaded&&E>-1,C=this.bwEstimator.getEstimate(),{levels:R,minAutoLevel:b}=r,F=R[e.level],O=f.total||Math.max(f.loaded,Math.round(d*F.maxBitrate/8));let L=m-E;L<1&&T&&(L=Math.min(m,f.loaded*8/C));const D=T?f.loaded*1e3/L:0,x=D?(O-f.loaded)/D:O*8/C+v/1e3;if(x<=S)return;const B=D?D*8:C;let M=Number.POSITIVE_INFINITY,I;for(I=e.level-1;I>b;I--){const U=R[I].maxBitrate;if(M=this.getTimeToLoadFrag(v/1e3,B,d*U,!R[I].details),M<S)break}M>=x||M>d*10||(r.nextLoadLevel=I,T?this.bwEstimator.sample(m-Math.min(v,E),f.loaded):this.bwEstimator.sampleTTFB(m),this.clearTimer(),xt.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;
      Time to underbuffer: ${S.toFixed(3)} s
      Estimated load time for current fragment: ${x.toFixed(3)} s
      Estimated load time for down switch fragment: ${M.toFixed(3)} s
      TTFB estimate: ${E}
      Current BW estimate: ${Bn(C)?(C/1024).toFixed(3):"Unknown"} Kb/s
      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s
      Aborting and switching to level ${I}`),e.loader&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),r.trigger(ke.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:f}))}onFragLoaded(e,{frag:t,part:r}){const o=r?r.stats:t.stats;if(t.type===Yn.MAIN&&this.bwEstimator.sampleTTFB(o.loading.first-o.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){const u=r?r.duration:t.duration,h=this.hls.levels[t.level],f=(h.loaded?h.loaded.bytes:0)+o.loaded,d=(h.loaded?h.loaded.duration:0)+u;h.loaded={bytes:f,duration:d},h.realBitrate=Math.round(8*f/d)}if(t.bitrateTest){const u={stats:o,frag:t,part:r,id:t.type};this.onFragBuffered(ke.FRAG_BUFFERED,u),t.bitrateTest=!1}}}onFragBuffered(e,t){const{frag:r,part:o}=t,u=o!=null&&o.stats.loaded?o.stats:r.stats;if(u.aborted||this.ignoreFragment(r))return;const h=u.parsing.end-u.loading.start-Math.min(u.loading.first-u.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(h,u.loaded),u.bwEstimate=this.bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=h/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Yn.MAIN||e.sn==="initSegment"}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){const e=this._nextAutoLevel,t=this.bwEstimator;if(e!==-1&&!t.canEstimate())return e;let r=this.getNextABRAutoLevel();if(e!==-1){const o=this.hls.levels;if(o.length>Math.max(e,r)&&o[e].loadError<=o[r].loadError)return e}return e!==-1&&(r=Math.min(e,r)),r}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:r}=this,{maxAutoLevel:o,config:u,minAutoLevel:h,media:f}=r,d=t?t.duration:e?e.duration:0,m=f&&f.playbackRate!==0?Math.abs(f.playbackRate):1,g=this.bwEstimator?this.bwEstimator.getEstimate():u.abrEwmaDefaultEstimate,v=r.mainForwardBufferInfo,_=(v?v.len:0)/m;let S=this.findBestLevel(g,h,o,_,u.abrBandWidthFactor,u.abrBandWidthUpFactor);if(S>=0)return S;xt.trace(`[abr] ${_?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let E=d?Math.min(d,u.maxStarvationDelay):u.maxStarvationDelay,T=u.abrBandWidthFactor,C=u.abrBandWidthUpFactor;if(!_){const R=this.bitrateTestDelay;R&&(E=(d?Math.min(d,u.maxLoadingDelay):u.maxLoadingDelay)-R,xt.trace(`[abr] bitrate test took ${Math.round(1e3*R)}ms, set first fragment max fetchDuration to ${Math.round(1e3*E)} ms`),T=C=1)}return S=this.findBestLevel(g,h,o,_+E,T,C),Math.max(S,0)}findBestLevel(e,t,r,o,u,h){var f;const{fragCurrent:d,partCurrent:m,lastLoadedFragLevel:g}=this,{levels:v}=this.hls,_=v[g],S=!!(_!=null&&(f=_.details)!=null&&f.live),E=_==null?void 0:_.codecSet,T=m?m.duration:d?d.duration:0,C=this.bwEstimator.getEstimateTTFB()/1e3;let R=t,b=-1;for(let F=r;F>=t;F--){const O=v[F];if(!O||E&&O.codecSet!==E){O&&(R=Math.min(F,R),b=Math.max(F,b));continue}b!==-1&&xt.trace(`[abr] Skipped level(s) ${R}-${b} with CODECS:"${v[b].attrs.CODECS}"; not compatible with "${_.attrs.CODECS}"`);const L=O.details,D=(m?L==null?void 0:L.partTarget:L==null?void 0:L.averagetargetduration)||T;let x;F<=g?x=u*e:x=h*e;const B=v[F].maxBitrate,M=this.getTimeToLoadFrag(C,x,B*D,L===void 0);if(xt.trace(`[abr] level:${F} adjustedbw-bitrate:${Math.round(x-B)} avgDuration:${D.toFixed(1)} maxFetchDuration:${o.toFixed(1)} fetchDuration:${M.toFixed(1)}`),x>B&&(M===0||!Bn(M)||S&&!this.bitrateTestDelay||M<o))return F}return-1}set nextAutoLevel(e){this._nextAutoLevel=e}}class KW{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let r;if(e.length)e.length===1?r=e[0]:r=ace(e,t);else return new Uint8Array(0);return this.reset(),r}reset(){this.chunks.length=0,this.dataLength=0}}function ace(n,e){const t=new Uint8Array(e);let r=0;for(let o=0;o<n.length;o++){const u=n[o];t.set(u,r),r+=u.length}return t}const YB=100;class oce extends R1{constructor(e,t,r){super(e,t,r,"[audio-stream-controller]",Yn.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(ke.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(ke.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.on(ke.LEVEL_LOADED,this.onLevelLoaded,this),e.on(ke.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(ke.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(ke.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(ke.ERROR,this.onError,this),e.on(ke.BUFFER_RESET,this.onBufferReset,this),e.on(ke.BUFFER_CREATED,this.onBufferCreated,this),e.on(ke.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(ke.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(ke.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(ke.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(ke.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.off(ke.LEVEL_LOADED,this.onLevelLoaded,this),e.off(ke.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(ke.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(ke.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(ke.ERROR,this.onError,this),e.off(ke.BUFFER_RESET,this.onBufferReset,this),e.off(ke.BUFFER_CREATED,this.onBufferCreated,this),e.off(ke.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(ke.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(ke.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:r,initPTS:o,timescale:u}){if(r==="main"){const h=t.cc;this.initPTS[t.cc]={baseTime:o,timescale:u},this.log(`InitPTS for cc: ${h} found from main: ${o}`),this.videoTrackCC=h,this.state===rn.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=rn.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(YB),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=rn.IDLE):(this.loadedmetadata=!1,this.state=rn.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case rn.IDLE:this.doTickIdle();break;case rn.WAITING_TRACK:{var e;const{levels:r,trackId:o}=this,u=r==null||(e=r[o])==null?void 0:e.details;if(u){if(this.waitForCdnTuneIn(u))break;this.state=rn.WAITING_INIT_PTS}break}case rn.FRAG_LOADING_WAITING_RETRY:{var t;const r=performance.now(),o=this.retryDate;(!o||r>=o||(t=this.media)!=null&&t.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=rn.IDLE);break}case rn.WAITING_INIT_PTS:{const r=this.waitingData;if(r){const{frag:o,part:u,cache:h,complete:f}=r;if(this.initPTS[o.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=rn.FRAG_LOADING;const d=h.flush(),m={frag:o,part:u,payload:d,networkDetails:null};this._handleFragmentLoadProgress(m),f&&super._handleFragmentLoadComplete(m)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${o.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const d=this.getLoadPosition(),m=fi.bufferInfo(this.mediaBuffer,d,this.config.maxBufferHole);jb(m.end,this.config.maxFragLookUpTolerance,o)<0&&(this.log(`Waiting fragment cc (${o.cc}) @ ${o.start} cancelled because another fragment at ${m.end} is needed`),this.clearWaitingFragment())}}else this.state=rn.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=rn.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:r,trackId:o}=this,u=e.config;if(!(t!=null&&t[o])||!r&&(this.startFragRequested||!u.startFragPrefetch))return;const h=t[o],f=h.details;if(!f||f.live&&this.levelLastLoaded!==o||this.waitForCdnTuneIn(f)){this.state=rn.WAITING_TRACK;return}const d=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&d&&(this.bufferFlushed=!1,this.afterBufferFlushed(d,jr.AUDIO,Yn.AUDIO));const m=this.getFwdBufferInfo(d,Yn.AUDIO);if(m===null)return;const{bufferedTrack:g,switchingTrack:v}=this;if(!v&&this._streamEnded(m,f)){e.trigger(ke.BUFFER_EOS,{type:"audio"}),this.state=rn.ENDED;return}const _=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Yn.MAIN),S=m.len,E=this.getMaxBufferLength(_==null?void 0:_.len);if(S>=E&&!v)return;const C=f.fragments[0].start;let R=m.end;if(v&&r){const L=this.getLoadPosition();g&&v.attrs!==g.attrs&&(R=L),f.PTSKnown&&L<C&&(m.end>C||m.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=C+.05)}let b=this.getNextFragment(R,f),F=!1;if(b&&this.isLoopLoading(b,R)&&(F=!!b.gap,b=this.getNextFragmentLoopLoading(b,f,m,Yn.MAIN,E)),!b){this.bufferFlushed=!0;return}const O=_&&b.start>_.end+f.targetduration;if(O||!(_!=null&&_.len)&&m.len){const L=this.fragmentTracker.getBufferedFrag(b.start,Yn.MAIN);if(L===null||(F||(F=!!L.gap||!!O&&_.len===0),O&&!F||F&&m.nextStart&&m.nextStart<L.end))return}this.loadFragment(b,h,R)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(r=>new l0(r))}onAudioTrackSwitching(e,t){const r=!!t.url;this.trackId=t.id;const{fragCurrent:o}=this;o&&(o.abortRequests(),this.removeUnbufferedFrags(o.start)),this.resetLoadingState(),r?this.setInterval(YB):this.resetTransmuxer(),r?(this.switchingTrack=t,this.state=rn.IDLE):(this.switchingTrack=null,this.bufferedTrack=t,this.state=rn.STOPPED),this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.bufferedTrack=null,this.switchingTrack=null}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(ke.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var r;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:o}=this,{details:u,id:h}=t;if(!o){this.warn(`Audio tracks were reset while loading level ${h}`);return}this.log(`Track ${h} loaded [${u.startSN},${u.endSN}],duration:${u.totalduration}`);const f=o[h];let d=0;if(u.live||(r=f.details)!=null&&r.live){const m=this.mainDetails;if(u.fragments[0]||(u.deltaUpdateFailed=!0),u.deltaUpdateFailed||!m)return;!f.details&&u.hasProgramDateTime&&m.hasProgramDateTime?(IW(u,m),d=u.fragments[0].start):d=this.alignPlaylists(u,f.details)}f.details=u,this.levelLastLoaded=h,!this.startFragRequested&&(this.mainDetails||!u.live)&&this.setStartPosition(f.details,d),this.state===rn.WAITING_TRACK&&!this.waitForCdnTuneIn(u)&&(this.state=rn.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:r,part:o,payload:u}=e,{config:h,trackId:f,levels:d}=this;if(!d){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const m=d[f];if(!m){this.warn("Audio track is undefined on fragment load progress");return}const g=m.details;if(!g){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(r.start);return}const v=h.defaultAudioCodec||m.audioCodec||"mp4a.40.2";let _=this.transmuxer;_||(_=this.transmuxer=new jW(this.hls,Yn.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const S=this.initPTS[r.cc],E=(t=r.initSegment)==null?void 0:t.data;if(S!==void 0){const C=o?o.index:-1,R=C!==-1,b=new x1(r.level,r.sn,r.stats.chunkCount,u.byteLength,C,R);_.push(u,E,v,"",r,o,g.totalduration,!1,b,S)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${g.startSN} ,${g.endSN}],track ${f}`);const{cache:T}=this.waitingData=this.waitingData||{frag:r,part:o,cache:new KW,complete:!1};T.push(new Uint8Array(u)),this.waitingVideoCC=this.videoTrackCC,this.state=rn.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:r,part:o}=t;if(r.type!==Yn.AUDIO){if(!this.loadedmetadata&&r.type===Yn.MAIN){var u;(u=this.videoBuffer||this.media)!=null&&u.buffered.length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${o?" p: "+o.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(r.sn!=="initSegment"){this.fragPrevious=r;const h=this.switchingTrack;h&&(this.bufferedTrack=h,this.switchingTrack=null,this.hls.trigger(ke.AUDIO_TRACK_SWITCHED,Ea({},h)))}this.fragBufferedComplete(r,o)}onError(e,t){var r;if(t.fatal){this.state=rn.ERROR;return}switch(t.details){case zt.FRAG_GAP:case zt.FRAG_PARSING_ERROR:case zt.FRAG_DECRYPT_ERROR:case zt.FRAG_LOAD_ERROR:case zt.FRAG_LOAD_TIMEOUT:case zt.KEY_LOAD_ERROR:case zt.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Yn.AUDIO,t);break;case zt.AUDIO_TRACK_LOAD_ERROR:case zt.AUDIO_TRACK_LOAD_TIMEOUT:case zt.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===rn.WAITING_TRACK&&((r=t.context)==null?void 0:r.type)===br.AUDIO_TRACK&&(this.state=rn.IDLE);break;case zt.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case zt.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushed(e,{type:t}){t===jr.AUDIO&&(this.bufferFlushed=!0,this.state===rn.ENDED&&(this.state=rn.IDLE))}_handleTransmuxComplete(e){var t;const r="audio",{hls:o}=this,{remuxResult:u,chunkMeta:h}=e,f=this.getCurrentContext(h);if(!f){this.resetWhenMissingContext(h);return}const{frag:d,part:m,level:g}=f,{details:v}=g,{audio:_,text:S,id3:E,initSegment:T}=u;if(this.fragContextChanged(d)||!v){this.fragmentTracker.removeFragment(d);return}if(this.state=rn.PARSING,this.switchingTrack&&_&&this.completeAudioSwitch(this.switchingTrack),T!=null&&T.tracks&&(this._bufferInitSegment(T.tracks,d,h),o.trigger(ke.FRAG_PARSING_INIT_SEGMENT,{frag:d,id:r,tracks:T.tracks})),_){const{startPTS:C,endPTS:R,startDTS:b,endDTS:F}=_;m&&(m.elementaryStreams[jr.AUDIO]={startPTS:C,endPTS:R,startDTS:b,endDTS:F}),d.setElementaryStreamInfo(jr.AUDIO,C,R,b,F),this.bufferFragmentData(_,d,m,h)}if(E!=null&&(t=E.samples)!=null&&t.length){const C=Xi({id:r,frag:d,details:v},E);o.trigger(ke.FRAG_PARSING_METADATA,C)}if(S){const C=Xi({id:r,frag:d,details:v},S);o.trigger(ke.FRAG_PARSING_USERDATA,C)}}_bufferInitSegment(e,t,r){if(this.state!==rn.PARSING)return;e.video&&delete e.video;const o=e.audio;if(!o)return;o.levelCodec=o.codec,o.id="audio",this.log(`Init audio buffer, container:${o.container}, codecs[parsed]=[${o.codec}]`),this.hls.trigger(ke.BUFFER_CODECS,e);const u=o.initSegment;if(u!=null&&u.byteLength){const h={type:"audio",frag:t,part:null,chunkMeta:r,parent:t.type,data:u};this.hls.trigger(ke.BUFFER_APPENDING,h)}this.tick()}loadFragment(e,t,r){const o=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||o===Bs.NOT_LOADED||o===Bs.PARTIAL){var u;e.sn==="initSegment"?this._loadInitSegment(e,t):(u=t.details)!=null&&u.live&&!this.initPTS[e.cc]?(this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=rn.WAITING_INIT_PTS):(this.startFragRequested=!0,super.loadFragment(e,t,r))}else this.clearTrackerIfNeeded(e)}completeAudioSwitch(e){const{hls:t,media:r,bufferedTrack:o}=this,u=o==null?void 0:o.attrs,h=e.attrs;r&&u&&(u.CHANNELS!==h.CHANNELS||u.NAME!==h.NAME||u.LANGUAGE!==h.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(ke.AUDIO_TRACK_SWITCHED,Ea({},e))}}class lce extends A1{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.on(ke.MANIFEST_PARSED,this.onManifestParsed,this),e.on(ke.LEVEL_LOADING,this.onLevelLoading,this),e.on(ke.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(ke.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(ke.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.off(ke.MANIFEST_PARSED,this.onManifestParsed,this),e.off(ke.LEVEL_LOADING,this.onLevelLoading,this),e.off(ke.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(ke.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(ke.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:r,groupId:o,details:u}=t,h=this.tracksInGroup[r];if(!h||h.groupId!==o){this.warn(`Track with id:${r} and group:${o} not found in active group ${h.groupId}`);return}const f=h.details;h.details=t.details,this.log(`audio-track ${r} "${h.name}" lang:${h.lang} group:${o} loaded [${u.startSN}-${u.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,f)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!(t!=null&&t.audioGroupIds))return;const r=t.audioGroupIds[t.urlId];if(this.groupId!==r){this.groupId=r||null;const o=this.tracks.filter(h=>!r||h.groupId===r);this.selectDefaultTrack&&!o.some(h=>h.default)&&(this.selectDefaultTrack=!1),this.tracksInGroup=o;const u={audioTracks:o};this.log(`Updating audio tracks, ${o.length} track(s) found in group:${r}`),this.hls.trigger(ke.AUDIO_TRACKS_UPDATED,u),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===br.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(t))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();const r=this.currentTrack;t[this.trackId];const o=t[e],{groupId:u,name:h}=o;if(this.log(`Switching to audio-track ${e} "${h}" lang:${o.lang} group:${u}`),this.trackId=e,this.currentTrack=o,this.selectDefaultTrack=!1,this.hls.trigger(ke.AUDIO_TRACK_SWITCHING,Ea({},o)),o.details&&!o.details.live)return;const f=this.switchParams(o.url,r==null?void 0:r.details);this.loadPlaylist(f)}selectInitialTrack(){const e=this.tracksInGroup,t=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(t!==-1)this.setAudioTrack(t);else{const r=new Error(`No track found for running audio group-ID: ${this.groupId} track count: ${e.length}`);this.warn(r.message),this.hls.trigger(ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:r})}}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const o=t[r];if((!this.selectDefaultTrack||o.default)&&(!e||e.attrs["STABLE-RENDITION-ID"]===o.attrs["STABLE-RENDITION-ID"]||e.name===o.name&&e.lang===o.lang))return o.id}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const r=t.id,o=t.groupId;let u=t.url;if(e)try{u=e.addDirectives(u)}catch(h){this.warn(`Could not construct new URL with HLS Delivery Directives: ${h}`)}this.log(`loading audio-track playlist ${r} "${t.name}" lang:${t.lang} group:${o}`),this.clearTimer(),this.hls.trigger(ke.AUDIO_TRACK_LOADING,{url:u,id:r,groupId:o,deliveryDirectives:e||null})}}}function GW(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!uce(n[t].attrs,e[t].attrs))return!1;return!0}function uce(n,e){const t=n["STABLE-RENDITION-ID"];return t?t===e["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some(r=>n[r]!==e[r])}const XB=500;class cce extends R1{constructor(e,t,r){super(e,t,r,"[subtitle-stream-controller]",Yn.SUBTITLE),this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(ke.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(ke.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.on(ke.LEVEL_LOADED,this.onLevelLoaded,this),e.on(ke.ERROR,this.onError,this),e.on(ke.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(ke.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(ke.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(ke.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(ke.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(ke.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(ke.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(ke.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.off(ke.LEVEL_LOADED,this.onLevelLoaded,this),e.off(ke.ERROR,this.onError,this),e.off(ke.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(ke.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(ke.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(ke.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(ke.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(ke.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=rn.IDLE,this.setInterval(XB),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:r,success:o}=t;if(this.fragPrevious=r,this.state=rn.IDLE,!o)return;const u=this.tracksBuffered[this.currentTrackId];if(!u)return;let h;const f=r.start;for(let m=0;m<u.length;m++)if(f>=u[m].start&&f<=u[m].end){h=u[m];break}const d=r.start+r.duration;h?h.end=d:(h={start:f,end:d},u.push(h)),this.fragmentTracker.fragBuffered(r)}onBufferFlushing(e,t){const{startOffset:r,endOffset:o}=t;if(r===0&&o!==Number.POSITIVE_INFINITY){const{currentTrackId:u,levels:h}=this;if(!h.length||!h[u]||!h[u].details)return;const d=h[u].details.targetduration,m=o-d;if(m<=0)return;t.endOffsetSubtitles=Math.max(0,m),this.tracksBuffered.forEach(g=>{for(let v=0;v<g.length;){if(g[v].end<=m){g.shift();continue}else if(g[v].start<m)g[v].start=m;else break;v++}}),this.fragmentTracker.removeFragmentsInRange(r,m,Yn.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===Yn.MAIN){var r;(r=this.media)!=null&&r.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const r=t.frag;(r==null?void 0:r.type)===Yn.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==rn.STOPPED&&(this.state=rn.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(GW(this.levels,t)){this.levels=t.map(r=>new l0(r));return}this.tracksBuffered=[],this.levels=t.map(r=>{const o=new l0(r);return this.tracksBuffered[o.id]=[],o}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Yn.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){if(this.currentTrackId=t.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}const r=this.levels[this.currentTrackId];r!=null&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.setInterval(XB)}onSubtitleTrackLoaded(e,t){var r;const{details:o,id:u}=t,{currentTrackId:h,levels:f}=this;if(!f.length)return;const d=f[h];if(u>=f.length||u!==h||!d)return;this.mediaBuffer=this.mediaBufferTimeRanges;let m=0;if(o.live||(r=d.details)!=null&&r.live){const g=this.mainDetails;if(o.deltaUpdateFailed||!g)return;const v=g.fragments[0];d.details?(m=this.alignPlaylists(o,d.details),m===0&&v&&(m=v.start,Bb(o,m))):o.hasProgramDateTime&&g.hasProgramDateTime?(IW(o,g),m=o.fragments[0].start):v&&(m=v.start,Bb(o,m))}d.details=o,this.levelLastLoaded=u,!this.startFragRequested&&(this.mainDetails||!o.live)&&this.setStartPosition(d.details,m),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===rn.IDLE&&(u0(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),d.details=void 0))}_handleFragmentLoadComplete(e){const{frag:t,payload:r}=e,o=t.decryptdata,u=this.hls;if(!this.fragContextChanged(t)&&r&&r.byteLength>0&&o&&o.key&&o.iv&&o.method==="AES-128"){const h=performance.now();this.decrypter.decrypt(new Uint8Array(r),o.key.buffer,o.iv.buffer).catch(f=>{throw u.trigger(ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.FRAG_DECRYPT_ERROR,fatal:!1,error:f,reason:f.message,frag:t}),f}).then(f=>{const d=performance.now();u.trigger(ke.FRAG_DECRYPTED,{frag:t,payload:f,stats:{tstart:h,tdecrypt:d}})}).catch(f=>{this.warn(`${f.name}: ${f.message}`),this.state=rn.IDLE})}}doTick(){if(!this.media){this.state=rn.IDLE;return}if(this.state===rn.IDLE){const{currentTrackId:e,levels:t}=this,r=t[e];if(!t.length||!r||!r.details)return;const o=r.details,u=o.targetduration,{config:h}=this,f=this.getLoadPosition(),d=fi.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],f-u,h.maxBufferHole),{end:m,len:g}=d,v=this.getFwdBufferInfo(this.media,Yn.MAIN),_=this.getMaxBufferLength(v==null?void 0:v.len)+u;if(g>_)return;const S=o.fragments,E=S.length,T=o.edge;let C=null;const R=this.fragPrevious;if(m<T){const{maxFragLookUpTolerance:b}=h;C=u0(R,S,Math.max(S[0].start,m),b),!C&&R&&R.start<S[0].start&&(C=S[0])}else C=S[E-1];if(!C)return;C=this.mapToInitFragWhenRequired(C),this.fragmentTracker.getState(C)===Bs.NOT_LOADED&&this.loadFragment(C,r,m)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,r){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,r))}get mediaBufferTimeRanges(){return new fce(this.tracksBuffered[this.currentTrackId]||[])}}class fce{constructor(e){this.buffered=void 0;const t=(r,o,u)=>{if(o=o>>>0,o>u-1)throw new DOMException(`Failed to execute '${r}' on 'TimeRanges': The index provided (${o}) is greater than the maximum bound (${u})`);return e[o][r]};this.buffered={get length(){return e.length},end(r){return t("end",r,e.length)},start(r){return t("start",r,e.length)}}}}class dce extends A1{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){const{hls:e}=this;e.on(ke.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(ke.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.on(ke.MANIFEST_PARSED,this.onManifestParsed,this),e.on(ke.LEVEL_LOADING,this.onLevelLoading,this),e.on(ke.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(ke.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(ke.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(ke.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(ke.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.off(ke.MANIFEST_PARSED,this.onManifestParsed,this),e.off(ke.LEVEL_LOADING,this.onLevelLoading,this),e.off(ke.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(ke.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(ke.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),jI(this.media.textTracks).forEach(t=>{Ih(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:r,details:o}=t,{trackId:u}=this,h=this.tracksInGroup[u];if(!h){this.warn(`Invalid subtitle track id ${r}`);return}const f=h.details;h.details=t.details,this.log(`subtitle track ${r} loaded [${o.startSN}-${o.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,f)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!(t!=null&&t.textGroupIds))return;const r=t.textGroupIds[t.urlId],o=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==r){const u=this.tracks.filter(d=>!r||d.groupId===r);this.tracksInGroup=u;const h=this.findTrackId(o==null?void 0:o.name)||this.findTrackId();this.groupId=r||null;const f={subtitleTracks:u};this.log(`Updating subtitle tracks, ${u.length} track(s) found in "${r}" group-id`),this.hls.trigger(ke.SUBTITLE_TRACKS_UPDATED,f),h!==-1&&this.setSubtitleTrack(h,o)}else this.shouldReloadPlaylist(o)&&this.setSubtitleTrack(this.trackId,o)}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const o=t[r];if((!this.selectDefaultTrack||o.default)&&(!e||e===o.name))return o.id}return-1}onError(e,t){t.fatal||!t.context||t.context.type===br.SUBTITLE_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.checkRetry(t)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1;const t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const r=t.id,o=t.groupId;let u=t.url;if(e)try{u=e.addDirectives(u)}catch(h){this.warn(`Could not construct new URL with HLS Delivery Directives: ${h}`)}this.log(`Loading subtitle playlist for id ${r}`),this.hls.trigger(ke.SUBTITLE_TRACK_LOADING,{url:u,id:r,groupId:o,deliveryDirectives:e||null})}}toggleTrackModes(e){const{media:t,trackId:r}=this;if(!t)return;const o=jI(t.textTracks),u=o.filter(f=>f.groupId===this.groupId);if(e===-1)[].slice.call(o).forEach(f=>{f.mode="disabled"});else{const f=u[r];f&&(f.mode="disabled")}const h=u[e];h&&(h.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(e,t){var r;const o=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(this.trackId!==e&&this.toggleTrackModes(e),this.trackId===e&&(e===-1||(r=o[e])!=null&&r.details)||e<-1||e>=o.length)return;this.clearTimer();const u=o[e];if(this.log(`Switching to subtitle-track ${e}`+(u?` "${u.name}" lang:${u.lang} group:${u.groupId}`:"")),this.trackId=e,u){const{id:h,groupId:f="",name:d,type:m,url:g}=u;this.hls.trigger(ke.SUBTITLE_TRACK_SWITCH,{id:h,groupId:f,name:d,type:m,url:g});const v=this.switchParams(u.url,t==null?void 0:t.details);this.loadPlaylist(v)}else this.hls.trigger(ke.SUBTITLE_TRACK_SWITCH,{id:e})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=-1;const t=jI(this.media.textTracks);for(let r=0;r<t.length;r++)if(t[r].mode==="hidden")e=r;else if(t[r].mode==="showing"){e=r;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}}function jI(n){const e=[];for(let t=0;t<n.length;t++){const r=n[t];(r.kind==="subtitles"||r.kind==="captions")&&r.label&&e.push(n[t])}return e}class hce{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t){const r=this.queues[t];r.push(e),r.length===1&&this.buffers[t]&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const r=new Promise(u=>{t=u}),o={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(o,e),r}executeNext(e){const{buffers:t,queues:r}=this,o=t[e],u=r[e];if(u.length){const h=u[0];try{h.execute()}catch(f){xt.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),h.onError(f),o!=null&&o.updating||(u.shift(),this.executeNext(e))}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const qB=b1(),QB=/([ha]vc.)(?:\.[^.,]+)+/;class pce{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{const{media:t,mediaSource:r}=this;xt.log("[buffer-controller]: Media source opened"),t&&(t.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(ke.MEDIA_ATTACHED,{media:t})),r&&r.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{xt.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{xt.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{const{media:t,_objectUrl:r}=this;t&&t.src!==r&&xt.error(`Media element src was set while attaching MediaSource (${r} > ${t.src})`)},this.hls=e,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){const{hls:e}=this;e.on(ke.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(ke.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(ke.MANIFEST_PARSED,this.onManifestParsed,this),e.on(ke.BUFFER_RESET,this.onBufferReset,this),e.on(ke.BUFFER_APPENDING,this.onBufferAppending,this),e.on(ke.BUFFER_CODECS,this.onBufferCodecs,this),e.on(ke.BUFFER_EOS,this.onBufferEos,this),e.on(ke.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(ke.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(ke.FRAG_PARSED,this.onFragParsed,this),e.on(ke.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(ke.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(ke.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(ke.MANIFEST_PARSED,this.onManifestParsed,this),e.off(ke.BUFFER_RESET,this.onBufferReset,this),e.off(ke.BUFFER_APPENDING,this.onBufferAppending,this),e.off(ke.BUFFER_CODECS,this.onBufferCodecs,this),e.off(ke.BUFFER_EOS,this.onBufferEos,this),e.off(ke.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(ke.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(ke.FRAG_PARSED,this.onFragParsed,this),e.off(ke.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new hce(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestParsed(e,t){let r=2;(t.audio&&!t.video||!t.altAudio)&&(r=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=r,this.details=null,xt.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const r=this.media=t.media;if(r&&qB){const o=this.mediaSource=new qB;o.addEventListener("sourceopen",this._onMediaSourceOpen),o.addEventListener("sourceended",this._onMediaSourceEnded),o.addEventListener("sourceclose",this._onMediaSourceClose),r.src=self.URL.createObjectURL(o),this._objectUrl=r.src,r.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:r}=this;if(t){if(xt.log("[buffer-controller]: media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(o){xt.warn(`[buffer-controller]: onMediaDetaching: ${o.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(e.removeEventListener("emptied",this._onMediaEmptied),r&&self.URL.revokeObjectURL(r),e.src===r?(e.removeAttribute("src"),e.load()):xt.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(ke.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{const t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(r){xt.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,r)}}),this._initSourceBuffer()}onBufferCodecs(e,t){const r=this.getSourceBufferTypes().length;Object.keys(t).forEach(o=>{if(r){const u=this.tracks[o];if(u&&typeof u.buffer.changeType=="function"){const{id:h,codec:f,levelCodec:d,container:m,metadata:g}=t[o],v=(u.levelCodec||u.codec).replace(QB,"$1"),_=(d||f).replace(QB,"$1");if(v!==_){const S=`${m};codecs=${d||f}`;this.appendChangeType(o,S),xt.log(`[buffer-controller]: switching codec ${v} to ${_}`),this.tracks[o]={buffer:u.buffer,codec:f,container:m,levelCodec:d,metadata:g,id:h}}}}else this.pendingTracks[o]=t[o]}),!r&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())}appendChangeType(e,t){const{operationQueue:r}=this,o={execute:()=>{const u=this.sourceBuffer[e];u&&(xt.log(`[buffer-controller]: changing ${e} sourceBuffer type to ${t}`),u.changeType(t)),r.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:u=>{xt.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,u)}};r.append(o,e)}onBufferAppending(e,t){const{hls:r,operationQueue:o,tracks:u}=this,{data:h,type:f,frag:d,part:m,chunkMeta:g}=t,v=g.buffering[f],_=self.performance.now();v.start=_;const S=d.stats.buffering,E=m?m.stats.buffering:null;S.start===0&&(S.start=_),E&&E.start===0&&(E.start=_);const T=u.audio;let C=!1;f==="audio"&&(T==null?void 0:T.container)==="audio/mpeg"&&(C=!this.lastMpegAudioChunk||g.id===1||this.lastMpegAudioChunk.sn!==g.sn,this.lastMpegAudioChunk=g);const R=d.start,b={execute:()=>{if(v.executeStart=self.performance.now(),C){const F=this.sourceBuffer[f];if(F){const O=R-F.timestampOffset;Math.abs(O)>=.1&&(xt.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${R} (delta: ${O}) sn: ${d.sn})`),F.timestampOffset=R)}}this.appendExecutor(h,f)},onStart:()=>{},onComplete:()=>{const F=self.performance.now();v.executeEnd=v.end=F,S.first===0&&(S.first=F),E&&E.first===0&&(E.first=F);const{sourceBuffer:O}=this,L={};for(const D in O)L[D]=fi.getBuffered(O[D]);this.appendError=0,this.hls.trigger(ke.BUFFER_APPENDED,{type:f,frag:d,part:m,chunkMeta:g,parent:d.type,timeRanges:L})},onError:F=>{xt.error(`[buffer-controller]: Error encountered while trying to append to the ${f} SourceBuffer`,F);const O={type:$n.MEDIA_ERROR,parent:d.type,details:zt.BUFFER_APPEND_ERROR,frag:d,part:m,chunkMeta:g,error:F,err:F,fatal:!1};F.code===DOMException.QUOTA_EXCEEDED_ERR?O.details=zt.BUFFER_FULL_ERROR:(this.appendError++,O.details=zt.BUFFER_APPEND_ERROR,this.appendError>r.config.appendErrorMaxRetry&&(xt.error(`[buffer-controller]: Failed ${r.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),O.fatal=!0)),r.trigger(ke.ERROR,O)}};o.append(b,f)}onBufferFlushing(e,t){const{operationQueue:r}=this,o=u=>({execute:this.removeExecutor.bind(this,u,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(ke.BUFFER_FLUSHED,{type:u})},onError:h=>{xt.warn(`[buffer-controller]: Failed to remove from ${u} SourceBuffer`,h)}});t.type?r.append(o(t.type),t.type):this.getSourceBufferTypes().forEach(u=>{r.append(o(u),u)})}onFragParsed(e,t){const{frag:r,part:o}=t,u=[],h=o?o.elementaryStreams:r.elementaryStreams;h[jr.AUDIOVIDEO]?u.push("audiovideo"):(h[jr.AUDIO]&&u.push("audio"),h[jr.VIDEO]&&u.push("video"));const f=()=>{const d=self.performance.now();r.stats.buffering.end=d,o&&(o.stats.buffering.end=d);const m=o?o.stats:r.stats;this.hls.trigger(ke.FRAG_BUFFERED,{frag:r,part:o,stats:m,id:r.type})};u.length===0&&xt.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers(f,u)}onFragChanged(e,t){this.flushBackBuffer()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((o,u)=>{const h=this.sourceBuffer[u];return h&&(!t.type||t.type===u)&&(h.ending=!0,h.ended||(h.ended=!0,xt.log(`[buffer-controller]: ${u} sourceBuffer now EOS`))),o&&!!(!h||h.ended)},!0)&&(xt.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(u=>{const h=this.sourceBuffer[u];h&&(h.ending=!1)});const{mediaSource:o}=this;if(!o||o.readyState!=="open"){o&&xt.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${o.readyState}`);return}xt.log("[buffer-controller]: Calling mediaSource.endOfStream()"),o.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:e,details:t,media:r,sourceBuffer:o}=this;if(!r||t===null)return;const u=this.getSourceBufferTypes();if(!u.length)return;const h=t.live&&e.config.liveBackBufferLength!==null?e.config.liveBackBufferLength:e.config.backBufferLength;if(!Bn(h)||h<0)return;const f=r.currentTime,d=t.levelTargetDuration,m=Math.max(h,d),g=Math.floor(f/d)*d-m;u.forEach(v=>{const _=o[v];if(_){const S=fi.getBuffered(_);if(S.length>0&&g>S.start(0)){if(e.trigger(ke.BACK_BUFFER_REACHED,{bufferEnd:g}),t.live)e.trigger(ke.LIVE_BACK_BUFFER_REACHED,{bufferEnd:g});else if(_.ended&&S.end(S.length-1)-f<d*2){xt.info(`[buffer-controller]: Cannot flush ${v} back buffer while SourceBuffer is in ended state`);return}e.trigger(ke.BUFFER_FLUSHING,{startOffset:0,endOffset:g,type:v})}}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:r,mediaSource:o}=this,u=e.fragments[0].start+e.totalduration,h=r.duration,f=Bn(o.duration)?o.duration:0;e.live&&t.config.liveDurationInfinity?(xt.log("[buffer-controller]: Media Source duration is set to Infinity"),o.duration=1/0,this.updateSeekableRange(e)):(u>f&&u>h||!Bn(h))&&(xt.log(`[buffer-controller]: Updating Media Source duration to ${u.toFixed(3)}`),o.duration=u)}updateSeekableRange(e){const t=this.mediaSource,r=e.fragments;if(r.length&&e.live&&t!=null&&t.setLiveSeekableRange){const u=Math.max(0,r[0].start),h=Math.max(u,u+e.totalduration);t.setLiveSeekableRange(u,h)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:r}=this,o=Object.keys(r).length;if(o&&!e||o===2){this.createSourceBuffers(r),this.pendingTracks={};const u=this.getSourceBufferTypes();if(u.length)this.hls.trigger(ke.BUFFER_CREATED,{tracks:this.tracks}),u.forEach(h=>{t.executeNext(h)});else{const h=new Error("could not create source buffer for media codec(s)");this.hls.trigger(ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:h,reason:h.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:r}=this;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(const o in e)if(!t[o]){const u=e[o];if(!u)throw Error(`source buffer exists for track ${o}, however track does not`);const h=u.levelCodec||u.codec,f=`${u.container};codecs=${h}`;xt.log(`[buffer-controller]: creating sourceBuffer(${f})`);try{const d=t[o]=r.addSourceBuffer(f),m=o;this.addBufferListener(m,"updatestart",this._onSBUpdateStart),this.addBufferListener(m,"updateend",this._onSBUpdateEnd),this.addBufferListener(m,"error",this._onSBUpdateError),this.tracks[o]={buffer:d,codec:h,container:u.container,levelCodec:u.levelCodec,metadata:u.metadata,id:u.id}}catch(d){xt.error(`[buffer-controller]: error while trying to add sourceBuffer: ${d.message}`),this.hls.trigger(ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:d,mimeType:f})}}}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){const{operationQueue:t}=this;t.current(e).onComplete(),t.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){const r=new Error(`${e} SourceBuffer error`);xt.error(`[buffer-controller]: ${r}`,t),this.hls.trigger(ke.ERROR,{type:$n.MEDIA_ERROR,details:zt.BUFFER_APPENDING_ERROR,error:r,fatal:!1});const o=this.operationQueue.current(e);o&&o.onError(t)}removeExecutor(e,t,r){const{media:o,mediaSource:u,operationQueue:h,sourceBuffer:f}=this,d=f[e];if(!o||!u||!d){xt.warn(`[buffer-controller]: Attempting to remove from the ${e} SourceBuffer, but it does not exist`),h.shiftAndExecuteNext(e);return}const m=Bn(o.duration)?o.duration:1/0,g=Bn(u.duration)?u.duration:1/0,v=Math.max(0,t),_=Math.min(r,m,g);_>v&&!d.ending?(d.ended=!1,xt.log(`[buffer-controller]: Removing [${v},${_}] from the ${e} SourceBuffer`),d.remove(v,_)):h.shiftAndExecuteNext(e)}appendExecutor(e,t){const{operationQueue:r,sourceBuffer:o}=this,u=o[t];if(!u){xt.warn(`[buffer-controller]: Attempting to append to the ${t} SourceBuffer, but it does not exist`),r.shiftAndExecuteNext(t);return}u.ended=!1,u.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){xt.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:r}=this,o=t.map(u=>r.appendBlocker(u));Promise.all(o).then(()=>{e(),t.forEach(u=>{const h=this.sourceBuffer[u];h!=null&&h.updating||r.shiftAndExecuteNext(u)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,r){const o=this.sourceBuffer[e];if(!o)return;const u=r.bind(this,e);this.listeners[e].push({event:t,listener:u}),o.addEventListener(t,u)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(r=>{t.removeEventListener(r.event,r.listener)})}}const JB={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},WW=function(e){let t=e;return JB.hasOwnProperty(e)&&(t=JB[e]),String.fromCharCode(t)},ko=15,vu=100,gce={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},mce={17:2,18:4,21:6,22:8,23:10,19:13,20:15},vce={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},yce={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Ece=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class _ce{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const r=typeof t=="function"?t():t;xt.log(`${this.time} [${e}] ${r}`)}}}const xf=function(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r].toString(16));return t};class HW{constructor(e,t,r,o,u){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=o||"black",this.flash=u||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let r=0;r<t.length;r++){const o=t[r];e.hasOwnProperty(o)&&(this[o]=e[o])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class Tce{constructor(e,t,r,o,u,h){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new HW(t,r,o,u,h)}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}let Sce=class{constructor(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let t=0;t<vu;t++)this.chars.push(new Tce);this.logger=e,this.pos=0,this.currPenState=new HW}equals(e){let t=!0;for(let r=0;r<vu;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t}copy(e){for(let t=0;t<vu;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<vu;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>vu&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=vu)}moveCursor(e){const t=this.pos+e;if(e>1)for(let r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=WW(e);if(this.pos>=vu){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<vu;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let r=0;r<vu;r++){const o=this.chars[r].uchar;o!==" "&&(t=!1),e.push(o)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}};class KI{constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<ko;t++)this.rows.push(new Sce(e));this.logger=e,this.currRow=ko-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let e=0;e<ko;e++)this.rows[e].clear();this.currRow=ko-1}equals(e){let t=!0;for(let r=0;r<ko;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}copy(e){for(let t=0;t<ko;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<ko;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let f=0;f<ko;f++)this.rows[f].clear();const u=this.currRow+1-this.nrRollUpRows,h=this.lastOutputScreen;if(h){const f=h.rows[u].cueStartTime,d=this.logger.time;if(f&&d!==null&&f<d)for(let m=0;m<this.nrRollUpRows;m++)this.rows[t-this.nrRollUpRows+m+1].copy(h.rows[u+m])}}this.currRow=t;const r=this.rows[this.currRow];if(e.indent!==null){const u=e.indent,h=Math.max(u-1,0);r.setCursor(e.indent),e.color=r.chars[h].penState.foreground}const o={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(o)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let r="",o=-1;for(let u=0;u<ko;u++){const h=this.rows[u].getTextString();h&&(o=u+1,e?t.push("Row "+o+": '"+h+"'"):t.push(h.trim()))}return t.length>0&&(e?r="["+t.join(" | ")+"]":r=t.join(`
`)),r}getTextAndFormat(){return this.rows}}class ZB{constructor(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new KI(r),this.nonDisplayedMemory=new KI(r),this.lastOutputScreen=new KI(r),this.currRollUpRow=this.displayedMemory.rows[ko-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[ko-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const r=Math.floor(e/2)-16,o=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=o[r]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class e4{constructor(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;const o=new _ce;this.channels=[null,new ZB(e,t,o),new ZB(e+1,r,o)],this.cmdHistory=n4(),this.logger=o}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let r,o,u,h=!1;this.logger.time=e;for(let f=0;f<t.length;f+=2)if(o=t[f]&127,u=t[f+1]&127,!(o===0&&u===0)){if(this.logger.log(3,"["+xf([t[f],t[f+1]])+"] -> ("+xf([o,u])+")"),r=this.parseCmd(o,u),r||(r=this.parseMidrow(o,u)),r||(r=this.parsePAC(o,u)),r||(r=this.parseBackgroundAttributes(o,u)),!r&&(h=this.parseChars(o,u),h)){const d=this.currentChannel;d&&d>0?this.channels[d].insertChars(h):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!r&&!h&&this.logger.log(2,"Couldn't parse cleaned data "+xf([o,u])+" orig: "+xf([t[f],t[f+1]]))}}parseCmd(e,t){const{cmdHistory:r}=this,o=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,u=(e===23||e===31)&&t>=33&&t<=35;if(!(o||u))return!1;if(t4(e,t,r))return ih(null,null,r),this.logger.log(3,"Repeated command ("+xf([e,t])+") is dropped"),!0;const h=e===20||e===21||e===23?1:2,f=this.channels[h];return e===20||e===21||e===28||e===29?t===32?f.ccRCL():t===33?f.ccBS():t===34?f.ccAOF():t===35?f.ccAON():t===36?f.ccDER():t===37?f.ccRU(2):t===38?f.ccRU(3):t===39?f.ccRU(4):t===40?f.ccFON():t===41?f.ccRDC():t===42?f.ccTR():t===43?f.ccRTD():t===44?f.ccEDM():t===45?f.ccCR():t===46?f.ccENM():t===47&&f.ccEOC():f.ccTO(t-32),ih(e,t,r),this.currentChannel=h,!0}parseMidrow(e,t){let r=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?r=1:r=2,r!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const o=this.channels[r];return o?(o.ccMIDROW(t),this.logger.log(3,"MIDROW ("+xf([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let r;const o=this.cmdHistory,u=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,h=(e===16||e===24)&&t>=64&&t<=95;if(!(u||h))return!1;if(t4(e,t,o))return ih(null,null,o),!0;const f=e<=23?1:2;t>=64&&t<=95?r=f===1?gce[e]:vce[e]:r=f===1?mce[e]:yce[e];const d=this.channels[f];return d?(d.setPAC(this.interpretPAC(r,t)),ih(e,t,o),this.currentChannel=f,!0):!1}interpretPAC(e,t){let r;const o={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?r=t-96:r=t-64,o.underline=(r&1)===1,r<=13?o.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(o.italics=!0,o.color="white"):o.indent=Math.floor((r-16)/2)*4,o}parseChars(e,t){let r,o=null,u=null;if(e>=25?(r=2,u=e-8):(r=1,u=e),u>=17&&u<=19){let h;u===17?h=t+80:u===18?h=t+112:h=t+144,this.logger.log(2,"Special char '"+WW(h)+"' in channel "+r),o=[h]}else e>=32&&e<=127&&(o=t===0?[e]:[e,t]);if(o){const h=xf(o);this.logger.log(3,"Char codes =  "+h.join(",")),ih(e,t,this.cmdHistory)}return o}parseBackgroundAttributes(e,t){const r=(e===16||e===24)&&t>=32&&t<=47,o=(e===23||e===31)&&t>=45&&t<=47;if(!(r||o))return!1;let u;const h={};e===16||e===24?(u=Math.floor((t-32)/2),h.background=Ece[u],t%2===1&&(h.background=h.background+"_semi")):t===45?h.background="transparent":(h.foreground="black",t===47&&(h.underline=!0));const f=e<=23?1:2;return this.channels[f].setBkgData(h),ih(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}this.cmdHistory=n4()}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const r=this.channels[t];r&&r.cueSplitAtTime(e)}}}function ih(n,e,t){t.a=n,t.b=e}function t4(n,e,t){return t.a===n&&t.b===e}function n4(){return{a:null,b:null}}class gE{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,r){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var M1=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;const n=["","lr","rl"],e=["start","middle","end","left","right"];function t(f,d){if(typeof d!="string"||!Array.isArray(f))return!1;const m=d.toLowerCase();return~f.indexOf(m)?m:!1}function r(f){return t(n,f)}function o(f){return t(e,f)}function u(f,...d){let m=1;for(;m<arguments.length;m++){const g=arguments[m];for(const v in g)f[v]=g[v]}return f}function h(f,d,m){const g=this,v={enumerable:!0};g.hasBeenReset=!1;let _="",S=!1,E=f,T=d,C=m,R=null,b="",F=!0,O="auto",L="start",D=50,x="middle",B=50,M="middle";Object.defineProperty(g,"id",u({},v,{get:function(){return _},set:function(I){_=""+I}})),Object.defineProperty(g,"pauseOnExit",u({},v,{get:function(){return S},set:function(I){S=!!I}})),Object.defineProperty(g,"startTime",u({},v,{get:function(){return E},set:function(I){if(typeof I!="number")throw new TypeError("Start time must be set to a number.");E=I,this.hasBeenReset=!0}})),Object.defineProperty(g,"endTime",u({},v,{get:function(){return T},set:function(I){if(typeof I!="number")throw new TypeError("End time must be set to a number.");T=I,this.hasBeenReset=!0}})),Object.defineProperty(g,"text",u({},v,{get:function(){return C},set:function(I){C=""+I,this.hasBeenReset=!0}})),Object.defineProperty(g,"region",u({},v,{get:function(){return R},set:function(I){R=I,this.hasBeenReset=!0}})),Object.defineProperty(g,"vertical",u({},v,{get:function(){return b},set:function(I){const U=r(I);if(U===!1)throw new SyntaxError("An invalid or illegal string was specified.");b=U,this.hasBeenReset=!0}})),Object.defineProperty(g,"snapToLines",u({},v,{get:function(){return F},set:function(I){F=!!I,this.hasBeenReset=!0}})),Object.defineProperty(g,"line",u({},v,{get:function(){return O},set:function(I){if(typeof I!="number"&&I!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");O=I,this.hasBeenReset=!0}})),Object.defineProperty(g,"lineAlign",u({},v,{get:function(){return L},set:function(I){const U=o(I);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");L=U,this.hasBeenReset=!0}})),Object.defineProperty(g,"position",u({},v,{get:function(){return D},set:function(I){if(I<0||I>100)throw new Error("Position must be between 0 and 100.");D=I,this.hasBeenReset=!0}})),Object.defineProperty(g,"positionAlign",u({},v,{get:function(){return x},set:function(I){const U=o(I);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");x=U,this.hasBeenReset=!0}})),Object.defineProperty(g,"size",u({},v,{get:function(){return B},set:function(I){if(I<0||I>100)throw new Error("Size must be between 0 and 100.");B=I,this.hasBeenReset=!0}})),Object.defineProperty(g,"align",u({},v,{get:function(){return M},set:function(I){const U=o(I);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");M=U,this.hasBeenReset=!0}})),g.displayState=void 0}return h.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},h}();class Ace{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function VW(n){function e(r,o,u,h){return(r|0)*3600+(o|0)*60+(u|0)+parseFloat(h||0)}const t=n.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class xce{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,r){for(let o=0;o<r.length;++o)if(t===r[o]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}function $W(n,e,t,r){const o=r?n.split(r):[n];for(const u in o){if(typeof o[u]!="string")continue;const h=o[u].split(t);if(h.length!==2)continue;const f=h[0],d=h[1];e(f,d)}}const Gb=new M1(0,0,""),mE=Gb.align==="middle"?"middle":"center";function Cce(n,e,t){const r=n;function o(){const f=VW(n);if(f===null)throw new Error("Malformed timestamp: "+r);return n=n.replace(/^[^\sa-zA-Z-]+/,""),f}function u(f,d){const m=new xce;$W(f,function(_,S){let E;switch(_){case"region":for(let T=t.length-1;T>=0;T--)if(t[T].id===S){m.set(_,t[T].region);break}break;case"vertical":m.alt(_,S,["rl","lr"]);break;case"line":E=S.split(","),m.integer(_,E[0]),m.percent(_,E[0])&&m.set("snapToLines",!1),m.alt(_,E[0],["auto"]),E.length===2&&m.alt("lineAlign",E[1],["start",mE,"end"]);break;case"position":E=S.split(","),m.percent(_,E[0]),E.length===2&&m.alt("positionAlign",E[1],["start",mE,"end","line-left","line-right","auto"]);break;case"size":m.percent(_,S);break;case"align":m.alt(_,S,["start",mE,"end","left","right"]);break}},/:/,/\s/),d.region=m.get("region",null),d.vertical=m.get("vertical","");let g=m.get("line","auto");g==="auto"&&Gb.line===-1&&(g=-1),d.line=g,d.lineAlign=m.get("lineAlign","start"),d.snapToLines=m.get("snapToLines",!0),d.size=m.get("size",100),d.align=m.get("align",mE);let v=m.get("position","auto");v==="auto"&&Gb.position===50&&(v=d.align==="start"||d.align==="left"?0:d.align==="end"||d.align==="right"?100:50),d.position=v}function h(){n=n.replace(/^\s+/,"")}if(h(),e.startTime=o(),h(),n.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);n=n.slice(3),h(),e.endTime=o(),h(),u(n,e)}function zW(n){return n.replace(/<br(?: \/)?>/gi,`
`)}class Ice{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Ace,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function r(){let u=t.buffer,h=0;for(u=zW(u);h<u.length&&u[h]!=="\r"&&u[h]!==`
`;)++h;const f=u.slice(0,h);return u[h]==="\r"&&++h,u[h]===`
`&&++h,t.buffer=u.slice(h),f}function o(u){$W(u,function(h,f){},/:/)}try{let u="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;u=r();const f=u.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(f!=null&&f[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let h=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(h?h=!1:u=r(),t.state){case"HEADER":/:/.test(u)?o(u):u||(t.state="ID");continue;case"NOTE":u||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(u)){t.state="NOTE";break}if(!u)continue;if(t.cue=new M1(0,0,""),t.state="CUE",u.indexOf("-->")===-1){t.cue.id=u;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{Cce(u,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const f=u.indexOf("-->")!==-1;if(!u||f&&(h=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=u}continue;case"BADCUE":u||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const Rce=/\r\n|\n\r|\n|\r/g,GI=function(e,t,r=0){return e.slice(r,r+t.length)===t},bce=function(e){let t=parseInt(e.slice(-3));const r=parseInt(e.slice(-6,-4)),o=parseInt(e.slice(-9,-7)),u=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!Bn(t)||!Bn(r)||!Bn(o)||!Bn(u))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*r,t+=60*1e3*o,t+=60*60*1e3*u,t},WI=function(e){let t=5381,r=e.length;for(;r;)t=t*33^e.charCodeAt(--r);return(t>>>0).toString()};function w1(n,e,t){return WI(n.toString())+WI(e.toString())+WI(t)}const Dce=function(e,t,r){let o=e[t],u=e[o.prevCC];if(!u||!u.new&&o.new){e.ccOffset=e.presentationOffset=o.start,o.new=!1;return}for(;(h=u)!=null&&h.new;){var h;e.ccOffset+=o.start-u.start,o.new=!1,o=u,u=e[o.prevCC]}e.presentationOffset=r};function Pce(n,e,t,r,o,u,h){const f=new Ice,d=Ml(new Uint8Array(n)).trim().replace(Rce,`
`).split(`
`),m=[],g=Kue(e.baseTime,e.timescale);let v="00:00.000",_=0,S=0,E,T=!0;f.oncue=function(C){const R=t[r];let b=t.ccOffset;const F=(_-g)/9e4;R!=null&&R.new&&(S!==void 0?b=t.ccOffset=R.start:Dce(t,r,F)),F&&(b=F-t.presentationOffset);const O=C.endTime-C.startTime,L=io((C.startTime+b-S)*9e4,o*9e4)/9e4;C.startTime=Math.max(L,0),C.endTime=Math.max(L+O,0);const D=C.text.trim();C.text=decodeURIComponent(encodeURIComponent(D)),C.id||(C.id=w1(C.startTime,C.endTime,D)),C.endTime>0&&m.push(C)},f.onparsingerror=function(C){E=C},f.onflush=function(){if(E){h(E);return}u(m)},d.forEach(C=>{if(T)if(GI(C,"X-TIMESTAMP-MAP=")){T=!1,C.slice(16).split(",").forEach(R=>{GI(R,"LOCAL:")?v=R.slice(6):GI(R,"MPEGTS:")&&(_=parseInt(R.slice(7)))});try{S=bce(v)/1e3}catch(R){E=R}return}else C===""&&(T=!1);f.parse(C+`
`)}),f.flush()}const HI="stpp.ttml.im1t",YW=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,XW=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Lce={left:"start",center:"center",right:"end",start:"start",end:"end"};function r4(n,e,t,r){const o=xr(new Uint8Array(n),["mdat"]);if(o.length===0){r(new Error("Could not parse IMSC1 mdat"));return}const u=o.map(f=>Ml(f)),h=jue(e.baseTime,1,e.timescale);try{u.forEach(f=>t(Mce(f,h)))}catch(f){r(f)}}function Mce(n,e){const o=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("tt")[0];if(!o)throw new Error("Invalid ttml");const u={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},h=Object.keys(u).reduce((v,_)=>(v[_]=o.getAttribute(`ttp:${_}`)||u[_],v),{}),f=o.getAttribute("xml:space")!=="preserve",d=i4(VI(o,"styling","style")),m=i4(VI(o,"layout","region")),g=VI(o,"body","[begin]");return[].map.call(g,v=>{const _=qW(v,f);if(!_||!v.hasAttribute("begin"))return null;const S=zI(v.getAttribute("begin"),h),E=zI(v.getAttribute("dur"),h);let T=zI(v.getAttribute("end"),h);if(S===null)throw s4(v);if(T===null){if(E===null)throw s4(v);T=S+E}const C=new M1(S-e,T-e,_);C.id=w1(C.startTime,C.endTime,C.text);const R=m[v.getAttribute("region")],b=d[v.getAttribute("style")],F=wce(R,b,d),{textAlign:O}=F;if(O){const L=Lce[O];L&&(C.lineAlign=L),C.align=O}return Xi(C,F),C}).filter(v=>v!==null)}function VI(n,e,t){const r=n.getElementsByTagName(e)[0];return r?[].slice.call(r.querySelectorAll(t)):[]}function i4(n){return n.reduce((e,t)=>{const r=t.getAttribute("xml:id");return r&&(e[r]=t),e},{})}function qW(n,e){return[].slice.call(n.childNodes).reduce((t,r,o)=>{var u;return r.nodeName==="br"&&o?t+`
`:(u=r.childNodes)!=null&&u.length?qW(r,e):e?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent},"")}function wce(n,e,t){const r="http://www.w3.org/ns/ttml#styling";let o=null;const u=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],h=n!=null&&n.hasAttribute("style")?n.getAttribute("style"):null;return h&&t.hasOwnProperty(h)&&(o=t[h]),u.reduce((f,d)=>{const m=$I(e,r,d)||$I(n,r,d)||$I(o,r,d);return m&&(f[d]=m),f},{})}function $I(n,e,t){return n&&n.hasAttributeNS(e,t)?n.getAttributeNS(e,t):null}function s4(n){return new Error(`Could not parse ttml timestamp ${n}`)}function zI(n,e){if(!n)return null;let t=VW(n);return t===null&&(YW.test(n)?t=Oce(n,e):XW.test(n)&&(t=Nce(n,e))),t}function Oce(n,e){const t=YW.exec(n),r=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+r/e.frameRate}function Nce(n,e){const t=XW.exec(n),r=Number(t[1]);switch(t[2]){case"h":return r*3600;case"m":return r*60;case"ms":return r*1e3;case"f":return r/e.frameRate;case"t":return r/e.tickRate}return r}class Fce{constructor(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=a4(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){const t=new gE(this,"textTrack1"),r=new gE(this,"textTrack2"),o=new gE(this,"textTrack3"),u=new gE(this,"textTrack4");this.cea608Parser1=new e4(1,t,r),this.cea608Parser2=new e4(3,o,u)}e.on(ke.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(ke.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.on(ke.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(ke.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(ke.FRAG_LOADING,this.onFragLoading,this),e.on(ke.FRAG_LOADED,this.onFragLoaded,this),e.on(ke.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(ke.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(ke.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(ke.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(ke.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(ke.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(ke.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.off(ke.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(ke.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(ke.FRAG_LOADING,this.onFragLoading,this),e.off(ke.FRAG_LOADED,this.onFragLoaded,this),e.off(ke.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(ke.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(ke.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(ke.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(ke.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(e,t,r,o,u){let h=!1;for(let f=u.length;f--;){const d=u[f],m=Uce(d[0],d[1],t,r);if(m>=0&&(d[0]=Math.min(d[0],t),d[1]=Math.max(d[1],r),h=!0,m/(r-t)>.5))return}if(h||u.push([t,r]),this.config.renderTextTracksNatively){const f=this.captionsTracks[e];this.Cues.newCue(f,t,r,o)}else{const f=this.Cues.newCue(null,t,r,o);this.hls.trigger(ke.CUES_PARSED,{type:"captions",cues:f,track:e})}}onInitPtsFound(e,{frag:t,id:r,initPTS:o,timescale:u}){const{unparsedVttFrags:h}=this;r==="main"&&(this.initPTS[t.cc]={baseTime:o,timescale:u}),h.length&&(this.unparsedVttFrags=[],h.forEach(f=>{this.onFragLoaded(ke.FRAG_LOADED,f)}))}getExistingTrack(e){const{media:t}=this;if(t)for(let r=0;r<t.textTracks.length;r++){const o=t.textTracks[r];if(o[e])return o}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:r,media:o}=this,{label:u,languageCode:h}=t[e],f=this.getExistingTrack(e);if(f)r[e]=f,Ih(r[e]),EW(r[e],o);else{const d=this.createTextTrack("captions",u,h);d&&(d[e]=!0,r[e]=d)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const r=t.label,o={_id:e,label:r,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=o,this.hls.trigger(ke.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[o]})}createTextTrack(e,t,r){const o=this.media;if(o)return o.addTextTrack(e,t,r)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{Ih(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=a4(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let r=0;r<t.length;r++)Ih(t[r])}onSubtitleTracksUpdated(e,t){const r=t.subtitleTracks||[],o=r.some(u=>u.textCodec===HI);if(this.config.enableWebVTT||o&&this.config.enableIMSC1){if(GW(this.tracks,r)){this.tracks=r;return}if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){const h=this.media?this.media.textTracks:null;this.tracks.forEach((f,d)=>{let m;if(h&&d<h.length){let g=null;for(let v=0;v<h.length;v++)if(kce(h[v],f)){g=h[v];break}g&&(m=g)}if(m)Ih(m);else{const g=this._captionsOrSubtitlesFromCharacteristics(f);m=this.createTextTrack(g,f.name,f.lang),m&&(m.mode="disabled")}m&&(m.groupId=f.groupId,this.textTracks.push(m))})}else if(this.tracks.length){const h=this.tracks.map(f=>({label:f.name,kind:f.type.toLowerCase(),default:f.default,subtitleTrack:f}));this.hls.trigger(ke.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:h})}}}_captionsOrSubtitlesFromCharacteristics(e){if(e.attrs.CHARACTERISTICS){const t=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),r=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(t&&r)return"captions"}return"subtitles"}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(r=>{const o=/(?:CC|SERVICE)([1-4])/.exec(r.instreamId);if(!o)return;const u=`textTrack${o[1]}`,h=this.captionsProperties[u];h&&(h.label=r.name,r.lang&&(h.languageCode=r.lang),h.media=r)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){const{cea608Parser1:r,cea608Parser2:o,lastSn:u,lastPartIndex:h}=this;if(!(!this.enabled||!(r&&o))&&t.frag.type===Yn.MAIN){var f,d;const m=t.frag.sn,g=(f=t==null||(d=t.part)==null?void 0:d.index)!=null?f:-1;m===u+1||m===u&&g===h+1||(r.reset(),o.reset()),this.lastSn=m,this.lastPartIndex=g}}onFragLoaded(e,t){const{frag:r,payload:o}=t,{initPTS:u,unparsedVttFrags:h}=this;if(r.type===Yn.SUBTITLE)if(o.byteLength){if(!u[r.cc]){h.push(t),u.length&&this.hls.trigger(ke.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Missing initial subtitle PTS")});return}const f=r.decryptdata,d="stats"in t;if(f==null||!f.encrypted||d){const m=this.tracks[r.level],g=this.vttCCs;g[r.cc]||(g[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),m&&m.textCodec===HI?this._parseIMSC1(r,o):this._parseVTTs(r,o,g)}}else this.hls.trigger(ke.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const r=this.hls;r4(t,this.initPTS[e.cc],o=>{this._appendCues(o,e.level),r.trigger(ke.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},o=>{xt.log(`Failed to parse IMSC1: ${o}`),r.trigger(ke.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:o})})}_parseVTTs(e,t,r){var o;const u=this.hls,h=(o=e.initSegment)!=null&&o.data?td(e.initSegment.data,new Uint8Array(t)):t;Pce(h,this.initPTS[e.cc],r,e.cc,e.start,f=>{this._appendCues(f,e.level),u.trigger(ke.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},f=>{this._fallbackToIMSC1(e,t),xt.log(`Failed to parse VTT cue: ${f}`),u.trigger(ke.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:f})})}_fallbackToIMSC1(e,t){const r=this.tracks[e.level];r.textCodec||r4(t,this.initPTS[e.cc],()=>{r.textCodec=HI,this._parseIMSC1(e,t)},()=>{r.textCodec="wvtt"})}_appendCues(e,t){const r=this.hls;if(this.config.renderTextTracksNatively){const o=this.textTracks[t];if(!o||o.mode==="disabled")return;e.forEach(u=>_W(o,u))}else{const o=this.tracks[t];if(!o)return;const u=o.default?"default":"subtitles"+t;r.trigger(ke.CUES_PARSED,{type:"subtitles",cues:e,track:u})}}onFragDecrypted(e,t){const{frag:r}=t;if(r.type===Yn.SUBTITLE){if(!this.initPTS[r.cc]){this.unparsedVttFrags.push(t);return}this.onFragLoaded(ke.FRAG_LOADED,t)}}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){const{cea608Parser1:r,cea608Parser2:o}=this;if(!this.enabled||!(r&&o))return;const{frag:u,samples:h}=t;if(!(u.type===Yn.MAIN&&this.closedCaptionsForLevel(u)==="NONE"))for(let f=0;f<h.length;f++){const d=h[f].bytes;if(d){const m=this.extractCea608Data(d);r.addData(h[f].pts,m[0]),o.addData(h[f].pts,m[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:r,endOffsetSubtitles:o,type:u}){const{media:h}=this;if(!(!h||h.currentTime<r)){if(!u||u==="video"){const{captionsTracks:f}=this;Object.keys(f).forEach(d=>Fb(f[d],t,r))}if(this.config.renderTextTracksNatively&&t===0&&o!==void 0){const{textTracks:f}=this;Object.keys(f).forEach(d=>Fb(f[d],t,o))}}}extractCea608Data(e){const t=[[],[]],r=e[0]&31;let o=2;for(let u=0;u<r;u++){const h=e[o++],f=127&e[o++],d=127&e[o++];if(f===0&&d===0)continue;if((4&h)!==0){const g=3&h;(g===0||g===1)&&(t[g].push(f),t[g].push(d))}}return t}}function kce(n,e){return!!n&&n.label===e.name&&!(n.textTrack1||n.textTrack2)}function Uce(n,e,t,r){return Math.min(e,r)-Math.max(n,t)}function a4(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class O1{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(ke.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(ke.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(ke.MANIFEST_PARSED,this.onManifestParsed,this),e.on(ke.BUFFER_CODECS,this.onBufferCodecs,this),e.on(ke.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(ke.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(ke.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(ke.MANIFEST_PARSED,this.onManifestParsed,this),e.off(ke.BUFFER_CODECS,this.onBufferCodecs,this),e.off(ke.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null}onManifestParsed(e,t){const r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){const e=this.hls.levels;if(e.length){const t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const r=t.filter((o,u)=>this.isLevelAllowed(o)&&u<=e);return this.clientRect=null,O1.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,!t.width&&!t.height&&(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(r=>e.bitrate===r.bitrate&&e.width===r.width&&e.height===r.height)}static getMaxLevelByMediaSize(e,t,r){if(!(e!=null&&e.length))return-1;const o=(h,f)=>f?h.width!==f.width||h.height!==f.height:!0;let u=e.length-1;for(let h=0;h<e.length;h+=1){const f=e[h];if((f.width>=t||f.height>=r)&&o(f,e[h+1])){u=h;break}}return u}}class Bce{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(ke.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(ke.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const r=this.hls.config;if(r.capLevelOnFPSDrop){const o=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=o,o&&typeof o.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,r){const o=performance.now();if(t){if(this.lastTime){const u=o-this.lastTime,h=r-this.lastDroppedFrames,f=t-this.lastDecodedFrames,d=1e3*h/u,m=this.hls;if(m.trigger(ke.FPS_DROP,{currentDropped:h,currentDecoded:f,totalDroppedFrames:r}),d>0&&h>m.config.fpsDroppedMonitoringThreshold*f){let g=m.currentLevel;xt.warn("drop FPS ratio greater than max allowed value for currentLevel: "+g),g>0&&(m.autoLevelCapping===-1||m.autoLevelCapping>=g)&&(g=g-1,m.trigger(ke.FPS_DROP_LEVEL_CAPPING,{level:g,droppedLevel:m.currentLevel}),m.autoLevelCapping=g,this.streamController.nextLevelSwitch())}}this.lastTime=o,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const vE="[eme]";class Kh{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Kh.CDMCleanupPromise?[Kh.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=xt.debug.bind(xt,vE),this.log=xt.log.bind(xt,vE),this.warn=xt.warn.bind(xt,vE),this.error=xt.error.bind(xt,vE),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(ke.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(ke.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(ke.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(ke.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(ke.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(ke.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:r}=this.config,o=t[e];if(o)return o.licenseUrl;if(e===Ti.WIDEVINE&&r)return r;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,r=t[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,r=(h,f,d)=>!!h&&d.indexOf(h)===f,o=t.map(h=>h.audioCodec).filter(r),u=t.map(h=>h.videoCodec).filter(r);return o.length+u.length===0&&u.push("avc1.42e01e"),new Promise((h,f)=>{const d=m=>{const g=m.shift();this.getMediaKeysPromise(g,o,u).then(v=>h({keySystem:g,mediaKeys:v})).catch(v=>{m.length?d(m):v instanceof no?f(v):f(new no({type:$n.KEY_SYSTEM_ERROR,details:zt.KEY_SYSTEM_NO_ACCESS,error:v,fatal:!0},v.message))})};d(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:r}=this.config;if(typeof r!="function"){let o=`Configured requestMediaKeySystemAccess is not a function ${r}`;return oW===null&&self.location.protocol==="http:"&&(o=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(o))}return r(e,t)}getMediaKeysPromise(e,t,r){const o=Zoe(e,t,r,this.config.drmSystemOptions),u=this.keySystemAccessPromises[e];let h=u==null?void 0:u.keySystemAccess;if(!h){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(o)}`),h=this.requestMediaKeySystemAccess(e,o);const f=this.keySystemAccessPromises[e]={keySystemAccess:h};return h.catch(d=>{this.log(`Failed to obtain access to key-system "${e}": ${d}`)}),h.then(d=>{this.log(`Access for key-system "${d.keySystem}" obtained`);const m=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),f.mediaKeys=d.createMediaKeys().then(g=>(this.log(`Media-keys created for "${e}"`),m.then(v=>v?this.setMediaKeysServerCertificate(g,e,v):g))),f.mediaKeys.catch(g=>{this.error(`Failed to create media-keys for "${e}"}: ${g}`)}),f.mediaKeys})}return h.then(()=>u.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:r}){this.log(`Creating key-system session "${t}" keyId: ${yl.hexDump(e.keyId||[])}`);const o=r.createSession(),u={decryptdata:e,keySystem:t,mediaKeys:r,mediaKeysSession:o,keyStatus:"status-pending"};return this.mediaKeySessions.push(u),u}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const r=this.createMediaKeySessionContext(e),o=this.getKeyIdString(t),u="cenc";this.keyIdToKeySessionPromise[o]=this.generateRequestWithPreferredKeySession(r,u,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return yl.hexDump(e.keyId)}updateKeySession(e,t){var r;const o=e.mediaKeysSession;return this.log(`Updating key-session "${o.sessionId}" for keyID ${yl.hexDump(((r=e.decryptdata)==null?void 0:r.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),o.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,r)=>{const o=xI(this.config),u=e.map(yB).filter(h=>!!h&&o.indexOf(h)!==-1);return this.getKeySystemSelectionPromise(u).then(({keySystem:h})=>{const f=EB(h);f?t(f):r(new Error(`Unable to find format for key-system "${h}"`))}).catch(r)})}loadKey(e){const t=e.keyInfo.decryptdata,r=this.getKeyIdString(t),o=`(keyId: ${r} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${o}`);let u=this.keyIdToKeySessionPromise[r];return u||(u=this.keyIdToKeySessionPromise[r]=this.getKeySystemForKeyPromise(t).then(({keySystem:h,mediaKeys:f})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${o}`),this.attemptSetMediaKeys(h,f).then(()=>{this.throwIfDestroyed();const d=this.createMediaKeySessionContext({keySystem:h,mediaKeys:f,decryptdata:t}),m="cenc";return this.generateRequestWithPreferredKeySession(d,m,t.pssh,"playlist-key")}))),u.catch(h=>this.handleError(h))),u}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof no?this.hls.trigger(ke.ERROR,e.data):this.hls.trigger(ke.ERROR,{type:$n.KEY_SYSTEM_ERROR,details:zt.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),r=this.keyIdToKeySessionPromise[t];if(!r){const o=yB(e.keyFormat),u=o?[o]:xI(this.config);return this.attemptKeySystemAccess(u)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=xI(this.config)),e.length===0)throw new no({type:$n.KEY_SYSTEM_ERROR,details:zt.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:r}=e;if(this.debug(`"${e.type}" event: init data type: "${t}"`),r===null)return;let o,u;if(t==="sinf"&&this.config.drmSystems[Ti.FAIRPLAY]){const g=ds(new Uint8Array(r));try{const v=_1(JSON.parse(g).sinf),_=gW(new Uint8Array(v));if(!_)return;o=_.subarray(8,24),u=Ti.FAIRPLAY}catch{this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{const g=Ale(r);if(g===null)return;g.version===0&&g.systemId===aW.WIDEVINE&&g.data&&(o=g.data.subarray(8,24)),u=Joe(g.systemId)}if(!u||!o)return;const h=yl.hexDump(o),{keyIdToKeySessionPromise:f,mediaKeySessions:d}=this;let m=f[h];for(let g=0;g<d.length;g++){const v=d[g],_=v.decryptdata;if(_.pssh||!_.keyId)continue;const S=yl.hexDump(_.keyId);if(h===S||_.uri.replace(/-/g,"").indexOf(h)!==-1){m=f[S],delete f[S],_.pssh=new Uint8Array(r),_.keyId=o,m=f[h]=m.then(()=>this.generateRequestWithPreferredKeySession(v,t,r,"encrypted-event-key-match"));break}}m||(m=f[h]=this.getKeySystemSelectionPromise([u]).then(({keySystem:g,mediaKeys:v})=>{var _;this.throwIfDestroyed();const S=new o0("ISO-23001-7",h,(_=EB(g))!=null?_:"");return S.pssh=new Uint8Array(r),S.keyId=o,this.attemptSetMediaKeys(g,v).then(()=>{this.throwIfDestroyed();const E=this.createMediaKeySessionContext({decryptdata:S,keySystem:g,mediaKeys:v});return this.generateRequestWithPreferredKeySession(E,t,r,"encrypted-event-no-match")})})),m.catch(g=>this.handleError(g))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const o=Promise.all(r).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(o),o.then(()=>{this.log(`Media-keys set for "${e}"`),r.push(o),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(u=>r.indexOf(u)===-1)})}generateRequestWithPreferredKeySession(e,t,r,o){var u,h;const f=(u=this.config.drmSystems)==null||(h=u[e.keySystem])==null?void 0:h.generateRequest;if(f)try{const _=f.call(this.hls,t,r,e);if(!_)throw new Error("Invalid response from configured generateRequest filter");t=_.initDataType,r=e.decryptdata.pssh=_.initData?new Uint8Array(_.initData):null}catch(_){var d;if(this.warn(_.message),(d=this.hls)!=null&&d.config.debug)throw _}if(r===null)return this.log(`Skipping key-session request for "${o}" (no initData)`),Promise.resolve(e);const m=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${o}": ${m} (init data type: ${t} length: ${r?r.byteLength:null})`);const g=new c0;e.mediaKeysSession.onmessage=_=>{const S=e.mediaKeysSession;if(!S){g.emit("error",new Error("invalid state"));return}const{messageType:E,message:T}=_;this.log(`"${E}" message event for session "${S.sessionId}" message size: ${T.byteLength}`),E==="license-request"||E==="license-renewal"?this.renewLicense(e,T).catch(C=>{this.handleError(C),g.emit("error",C)}):E==="license-release"?e.keySystem===Ti.FAIRPLAY&&(this.updateKeySession(e,sW("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${E}"`)},e.mediaKeysSession.onkeystatuseschange=_=>{if(!e.mediaKeysSession){g.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const E=e.keyStatus;g.emit("keyStatus",E),E==="expired"&&(this.warn(`${e.keySystem} expired for key ${m}`),this.renewKeySession(e))};const v=new Promise((_,S)=>{g.on("error",S),g.on("keyStatus",E=>{E.startsWith("usable")?_():E==="output-restricted"?S(new no({type:$n.KEY_SYSTEM_ERROR,details:zt.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):E==="internal-error"?S(new no({type:$n.KEY_SYSTEM_ERROR,details:zt.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${E}"`)):E==="expired"?S(new Error("key expired while generating request")):this.warn(`unhandled key status change "${E}"`)})});return e.mediaKeysSession.generateRequest(t,r).then(()=>{var _;this.log(`Request generated for key-session "${(_=e.mediaKeysSession)==null?void 0:_.sessionId}" keyId: ${m}`)}).catch(_=>{throw new no({type:$n.KEY_SYSTEM_ERROR,details:zt.KEY_SYSTEM_NO_SESSION,error:_,fatal:!1},`Error generating key-session request: ${_}`)}).then(()=>v).catch(_=>{throw g.removeAllListeners(),this.removeSession(e),_}).then(()=>(g.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,r)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${yl.hexDump("buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r))} session keyId: ${yl.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,r=t.loader,o=new r(t),u=this.getServerCertificateUrl(e);return u?(this.log(`Fetching serverCertificate for "${e}"`),new Promise((h,f)=>{const d={responseType:"arraybuffer",url:u},m=t.certLoadPolicy.default,g={loadPolicy:m,timeout:m.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},v={onSuccess:(_,S,E,T)=>{h(_.data)},onError:(_,S,E,T)=>{f(new no({type:$n.KEY_SYSTEM_ERROR,details:zt.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:E,response:Ea({url:d.url,data:void 0},_)},`"${e}" certificate request failed (${u}). Status: ${_.code} (${_.text})`))},onTimeout:(_,S,E)=>{f(new no({type:$n.KEY_SYSTEM_ERROR,details:zt.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:E,response:{url:d.url,data:void 0}},`"${e}" certificate request timed out (${u})`))},onAbort:(_,S,E)=>{f(new Error("aborted"))}};o.load(d,g,v)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,r){return new Promise((o,u)=>{e.setServerCertificate(r).then(h=>{this.log(`setServerCertificate ${h?"success":"not supported by CDM"} (${r==null?void 0:r.byteLength}) on "${t}"`),o(e)}).catch(h=>{u(new no({type:$n.KEY_SYSTEM_ERROR,details:zt.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:h,fatal:!0},h.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(r=>this.updateKeySession(e,new Uint8Array(r)).catch(o=>{throw new no({type:$n.KEY_SYSTEM_ERROR,details:zt.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:o,fatal:!0},o.message)}))}setupLicenseXHR(e,t,r,o){const u=this.config.licenseXhrSetup;return u?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return u.call(this.hls,e,t,r,o)}).catch(h=>{if(!r.decryptdata)throw h;return e.open("POST",t,!0),u.call(this.hls,e,t,r,o)}).then(h=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:h||o})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:o}))}requestLicense(e,t){const r=this.config.keyLoadPolicy.default;return new Promise((o,u)=>{const h=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${h}`);const f=new XMLHttpRequest;f.responseType="arraybuffer",f.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return u(new Error("invalid state"));if(f.readyState===4)if(f.status===200){this._requestLicenseFailureCount=0;let d=f.response;this.log(`License received ${d instanceof ArrayBuffer?d.byteLength:d}`);const m=this.config.licenseResponseCallback;if(m)try{d=m.call(this.hls,f,h,e)}catch(g){this.error(g)}o(d)}else{const d=r.errorRetry,m=d?d.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>m||f.status>=400&&f.status<500)u(new no({type:$n.KEY_SYSTEM_ERROR,details:zt.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:f,response:{url:h,data:void 0,code:f.status,text:f.statusText}},`License Request XHR failed (${h}). Status: ${f.status} (${f.statusText})`));else{const g=m-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${g} attempts left`),this.requestLicense(e,t).then(o,u)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=f,this.setupLicenseXHR(f,h,e,t).then(({xhr:d,licenseChallenge:m})=>{d.send(m)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const r=t.media;this.media=r,r.addEventListener("encrypted",this.onMediaEncrypted),r.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},o0.clearKeyUriToKeyIdMap();const r=t.length;Kh.CDMCleanupPromise=Promise.all(t.map(o=>this.removeSession(o)).concat(e==null?void 0:e.setMediaKeys(null).catch(o=>{this.log(`Could not clear media keys: ${o}. media.src: ${e==null?void 0:e.src}`)}))).then(()=>{r&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(o=>{this.log(`Could not close sessions and clear media keys: ${o}. media.src: ${e==null?void 0:e.src}`)})}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const r=t.reduce((o,u)=>(o.indexOf(u.keyFormat)===-1&&o.push(u.keyFormat),o),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:r}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),t.onmessage=null,t.onkeystatuseschange=null,r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const o=this.mediaKeySessions.indexOf(e);return o>-1&&this.mediaKeySessions.splice(o,1),t.remove().catch(u=>{this.log(`Could not remove session: ${u}`)}).then(()=>t.close()).catch(u=>{this.log(`Could not close session: ${u}`)})}}}Kh.CDMCleanupPromise=void 0;class no extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}const jce=1;var ra={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"};const Kce="h";class Ec{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=o=>{try{this.apply(o,{ot:ra.MANIFEST,su:!this.initialized})}catch(u){xt.warn("Could not generate manifest CMCD data.",u)}},this.applyFragmentData=o=>{try{const u=o.frag,h=this.hls.levels[u.level],f=this.getObjectType(u),d={d:u.duration*1e3,ot:f};(f===ra.VIDEO||f===ra.AUDIO||f==ra.MUXED)&&(d.br=h.bitrate/1e3,d.tb=this.getTopBandwidth(f)/1e3,d.bl=this.getBufferLength(f)),this.apply(o,d)}catch(u){xt.warn("Could not generate segment CMCD data.",u)}},this.hls=e;const t=this.config=e.config,{cmcd:r}=t;r!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||Ec.uuid(),this.cid=r.contentId,this.useHeaders=r.useHeaders===!0,this.registerListeners())}registerListeners(){const e=this.hls;e.on(ke.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(ke.MEDIA_DETACHED,this.onMediaDetached,this),e.on(ke.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(ke.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(ke.MEDIA_DETACHED,this.onMediaDetached,this),e.off(ke.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var r,o;this.audioBuffer=(r=t.tracks.audio)==null?void 0:r.buffer,this.videoBuffer=(o=t.tracks.video)==null?void 0:o.buffer}createData(){var e;return{v:jce,sf:Kce,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Xi(t,this.createData());const r=t.ot===ra.INIT||t.ot===ra.VIDEO||t.ot===ra.MUXED;if(this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering),this.useHeaders){const o=Ec.toHeaders(t);if(!Object.keys(o).length)return;e.headers||(e.headers={}),Xi(e.headers,o)}else{const o=Ec.toQuery(t);if(!o)return;e.url=Ec.appendQueryToUri(e.url,o)}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return ra.TIMED_TEXT;if(e.sn==="initSegment")return ra.INIT;if(t==="audio")return ra.AUDIO;if(t==="main")return this.hls.audioTracks.length?ra.VIDEO:ra.MUXED}getTopBandwidth(e){let t=0,r;const o=this.hls;if(e===ra.AUDIO)r=o.audioTracks;else{const u=o.maxAutoLevel,h=u>-1?u+1:o.levels.length;r=o.levels.slice(0,h)}for(const u of r)u.bitrate>t&&(t=u.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,r=e===ra.AUDIO?this.audioBuffer:this.videoBuffer;return!r||!t?NaN:fi.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,r=e||this.config.loader;return class{constructor(u){this.loader=void 0,this.loader=new r(u)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(u,h,f){t(u),this.loader.load(u,h,f)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,r=e||this.config.loader;return class{constructor(u){this.loader=void 0,this.loader=new r(u)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(u,h,f){t(u),this.loader.load(u,h,f)}}}static uuid(){const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}static serialize(e){const t=[],r=m=>!Number.isNaN(m)&&m!=null&&m!==""&&m!==!1,o=m=>Math.round(m),u=m=>o(m/100)*100,f={br:o,d:o,bl:u,dl:u,mtp:u,nor:m=>encodeURIComponent(m),rtp:u,tb:o},d=Object.keys(e||{}).sort();for(const m of d){let g=e[m];if(!r(g)||m==="v"&&g===1||m=="pr"&&g===1)continue;const v=f[m];v&&(g=v(g));const _=typeof g;let S;m==="ot"||m==="sf"||m==="st"?S=`${m}=${g}`:_==="boolean"?S=m:_==="number"?S=`${m}=${g}`:S=`${m}=${JSON.stringify(g)}`,t.push(S)}return t.join(",")}static toHeaders(e){const t=Object.keys(e),r={},o=["Object","Request","Session","Status"],u=[{},{},{},{}],h={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(const f of t){const d=h[f]!=null?h[f]:1;u[d][f]=e[f]}for(let f=0;f<u.length;f++){const d=Ec.serialize(u[f]);d&&(r[`CMCD-${o[f]}`]=d)}return r}static toQuery(e){return`CMCD=${encodeURIComponent(Ec.serialize(e))}`}static appendQueryToUri(e,t){if(!t)return e;const r=e.includes("?")?"&":"?";return`${e}${r}${t}`}}const Gce=3e5;class Wce{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=xt.log.bind(xt,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.on(ke.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(ke.MANIFEST_PARSED,this.onManifestParsed,this),e.on(ke.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(ke.MANIFEST_LOADING,this.onManifestLoading,this),e.off(ke.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(ke.MANIFEST_PARSED,this.onManifestParsed,this),e.off(ke.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){const e=Math.max(this.timeToLoad*1e3-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(r=>r!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:r}=t;r!==null&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:r}=t;if((r==null?void 0:r.action)===sa.SendAlternateToPenaltyBox&&r.flags===ro.MoveAllAlternatesMatchingHost){let o=this.pathwayPriority;const u=this.pathwayId;this.penalizedPathways[u]||(this.penalizedPathways[u]=performance.now()),!o&&this.levels&&(o=this.levels.reduce((h,f)=>(h.indexOf(f.pathwayId)===-1&&h.push(f.pathwayId),h),[])),o&&o.length>1&&(this.updatePathwayPriority(o),r.resolved=this.pathwayId!==u)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const r=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const r=this.penalizedPathways,o=performance.now();Object.keys(r).forEach(u=>{o-r[u]>Gce&&delete r[u]});for(let u=0;u<e.length;u++){const h=e[u];if(r[h])continue;if(h===this.pathwayId)return;const f=this.hls.nextLoadLevel,d=this.hls.levels[f];if(t=this.getLevelsForPathway(h),t.length>0){this.log(`Setting Pathway to "${h}"`),this.pathwayId=h,this.hls.trigger(ke.LEVELS_UPDATED,{levels:t});const m=this.hls.levels[f];d&&m&&this.levels&&(m.attrs["STABLE-VARIANT-ID"]!==d.attrs["STABLE-VARIANT-ID"]&&m.bitrate!==d.bitrate&&this.log(`Unstable Pathways change from bitrate ${d.bitrate} to ${m.bitrate}`),this.hls.nextLoadLevel=f);break}}}clonePathways(e){const t=this.levels;if(!t)return;const r={},o={};e.forEach(u=>{const{ID:h,"BASE-ID":f,"URI-REPLACEMENT":d}=u;if(t.some(g=>g.pathwayId===h))return;const m=this.getLevelsForPathway(f).map(g=>{const v=Xi({},g);v.details=void 0,v.url=QW(g.uri,g.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",d);const _=new yi(g.attrs);_["PATHWAY-ID"]=h;const S=_.AUDIO&&`${_.AUDIO}_clone_${h}`,E=_.SUBTITLES&&`${_.SUBTITLES}_clone_${h}`;S&&(r[_.AUDIO]=S,_.AUDIO=S),E&&(o[_.SUBTITLES]=E,_.SUBTITLES=E),v.attrs=_;const T=new l0(v);return nT(T,"audio",S),nT(T,"text",E),T});t.push(...m),o4(this.audioTracks,r,d,h),o4(this.subtitleTracks,o,d,h)})}loadSteeringManifest(e){const t=this.hls.config,r=t.loader;this.loader&&this.loader.destroy(),this.loader=new r(t);let o;try{o=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(o.protocol!=="data:"){const g=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;o.searchParams.set("_HLS_pathway",this.pathwayId),o.searchParams.set("_HLS_throughput",""+g)}const u={responseType:"json",url:o.href},h=t.steeringManifestLoadPolicy.default,f=h.errorRetry||h.timeoutRetry||{},d={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:f.maxNumRetry||0,retryDelay:f.retryDelayMs||0,maxRetryDelay:f.maxRetryDelayMs||0},m={onSuccess:(g,v,_,S)=>{this.log(`Loaded steering manifest: "${o}"`);const E=g.data;if(E.VERSION!==1){this.log(`Steering VERSION ${E.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=E.TTL;const{"RELOAD-URI":T,"PATHWAY-CLONES":C,"PATHWAY-PRIORITY":R}=E;if(T)try{this.uri=new self.URL(T,o).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${T}`);return}this.scheduleRefresh(this.uri||_.url),C&&this.clonePathways(C),R&&this.updatePathwayPriority(R)},onError:(g,v,_,S)=>{if(this.log(`Error loading steering manifest: ${g.code} ${g.text} (${v.url})`),this.stopLoad(),g.code===410){this.enabled=!1,this.log(`Steering manifest ${v.url} no longer available`);return}let E=this.timeToLoad*1e3;if(g.code===429){const T=this.loader;if(typeof(T==null?void 0:T.getResponseHeader)=="function"){const C=T.getResponseHeader("Retry-After");C&&(E=parseFloat(C)*1e3)}this.log(`Steering manifest ${v.url} rate limited`);return}this.scheduleRefresh(this.uri||v.url,E)},onTimeout:(g,v,_)=>{this.log(`Timeout loading steering manifest (${v.url})`),this.scheduleRefresh(this.uri||v.url)}};this.log(`Requesting steering manifest: ${o}`),this.loader.load(u,d,m)}scheduleRefresh(e,t=this.timeToLoad*1e3){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout(()=>{this.loadSteeringManifest(e)},t)}}function o4(n,e,t,r){n&&Object.keys(e).forEach(o=>{const u=n.filter(h=>h.groupId===o).map(h=>{const f=Xi({},h);return f.details=void 0,f.attrs=new yi(f.attrs),f.url=f.attrs.URI=QW(h.url,h.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),f.groupId=f.attrs["GROUP-ID"]=e[o],f.attrs["PATHWAY-ID"]=r,f});n.push(...u)})}function QW(n,e,t,r){const{HOST:o,PARAMS:u,[t]:h}=r;let f;e&&(f=h==null?void 0:h[e],f&&(n=f));const d=new self.URL(n);return o&&!f&&(d.host=o),u&&Object.keys(u).sort().forEach(m=>{m&&d.searchParams.set(m,u[m])}),d.href}const Hce=/^age:\s*[\d.]+\s*$/im;class JW{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new lS,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e)return;const r=this.loader=new self.XMLHttpRequest,o=this.stats;o.loading.first=0,o.loaded=0;const u=this.xhrSetup;u?Promise.resolve().then(()=>{if(!this.stats.aborted)return u(r,t.url)}).catch(h=>(r.open("GET",t.url,!0),u(r,t.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(r,t,e)}).catch(h=>{this.callbacks.onError({code:r.status,text:h.message},t,r,o)}):this.openAndSendXhr(r,t,e)}openAndSendXhr(e,t,r){e.readyState||e.open("GET",t.url,!0);const o=this.context.headers,{maxTimeToFirstByteMs:u,maxLoadTimeMs:h}=r.loadPolicy;if(o)for(const f in o)e.setRequestHeader(f,o[f]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=u&&Bn(u)?u:h,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:r}=this;if(!e||!t)return;const o=t.readyState,u=this.config;if(!r.aborted&&o>=2&&(r.loading.first===0&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),u.timeout!==u.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),u.timeout=u.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),u.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),o===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const h=t.status,f=t.responseType!=="text";if(h>=200&&h<300&&(f&&t.response||t.responseText!==null)){r.loading.end=Math.max(self.performance.now(),r.loading.first);const d=f?t.response:t.responseText,m=t.responseType==="arraybuffer"?d.byteLength:d.length;if(r.loaded=r.total=m,r.bwEstimate=r.total*8e3/(r.loading.end-r.loading.first),!this.callbacks)return;const g=this.callbacks.onProgress;if(g&&g(r,e,d,t),!this.callbacks)return;const v={url:t.responseURL,data:d,code:h};this.callbacks.onSuccess(v,r,e,t)}else{const d=u.loadPolicy.errorRetry,m=r.retry;tT(d,m,!1,h)?this.retry(d):(xt.error(`${h} while loading ${e.url}`),this.callbacks.onError({code:h,text:t.statusText},e,t,r))}}}loadtimeout(){var e;const t=(e=this.config)==null?void 0:e.loadPolicy.timeoutRetry,r=this.stats.retry;if(tT(t,r,!0))this.retry(t);else{xt.warn(`timeout while loading ${this.context.url}`);const o=this.callbacks;o&&(this.abortInternal(),o.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:r}=this;this.retryDelay=S1(e,r.retry),r.retry++,xt.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&Hce.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function Vce(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const $ce=/(\d+)-(\d+)\/(\d+)/;class l4{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||qce,this.controller=new self.AbortController,this.stats=new lS}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){const e=this.response;e!=null&&e.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,r){const o=this.stats;if(o.loading.start)throw new Error("Loader can only be used once.");o.loading.start=self.performance.now();const u=zce(e,this.controller.signal),h=r.onProgress,f=e.responseType==="arraybuffer",d=f?"byteLength":"length",{maxTimeToFirstByteMs:m,maxLoadTimeMs:g}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,u),self.clearTimeout(this.requestTimeout),t.timeout=m&&Bn(m)?m:g,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),r.onTimeout(o,e,this.response)},t.timeout),self.fetch(this.request).then(v=>{this.response=this.loader=v;const _=Math.max(self.performance.now(),o.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=g,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),r.onTimeout(o,e,this.response)},g-(_-o.loading.start)),!v.ok){const{status:S,statusText:E}=v;throw new Qce(E||"fetch, bad network response",S,v)}return o.loading.first=_,o.total=Xce(v.headers)||o.total,h&&Bn(t.highWaterMark)?this.loadProgressively(v,o,e,t.highWaterMark,h):f?v.arrayBuffer():e.responseType==="json"?v.json():v.text()}).then(v=>{const{response:_}=this;self.clearTimeout(this.requestTimeout),o.loading.end=Math.max(self.performance.now(),o.loading.first);const S=v[d];S&&(o.loaded=o.total=S);const E={url:_.url,data:v,code:_.status};h&&!Bn(t.highWaterMark)&&h(o,e,v,_),r.onSuccess(E,o,e,_)}).catch(v=>{if(self.clearTimeout(this.requestTimeout),o.aborted)return;const _=v&&v.code||0,S=v?v.message:null;r.onError({code:_,text:S},e,v?v.details:null,o)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,r,o=0,u){const h=new KW,f=e.body.getReader(),d=()=>f.read().then(m=>{if(m.done)return h.dataLength&&u(t,r,h.flush(),e),Promise.resolve(new ArrayBuffer(0));const g=m.value,v=g.length;return t.loaded+=v,v<o||h.dataLength?(h.push(g),h.dataLength>=o&&u(t,r,h.flush(),e)):u(t,r,g,e),d()}).catch(()=>Promise.reject());return d()}}function zce(n,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Xi({},n.headers))};return n.rangeEnd&&t.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),t}function Yce(n){const e=$ce.exec(n);if(e)return parseInt(e[2])-parseInt(e[1])+1}function Xce(n){const e=n.get("Content-Range");if(e){const r=Yce(e);if(Bn(r))return r}const t=n.get("Content-Length");if(t)return parseInt(t)}function qce(n,e){return new self.Request(n.url,e)}class Qce extends Error{constructor(e,t,r){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=r}}const Jce=/\s/,Zce={newCue(n,e,t,r){const o=[];let u,h,f,d,m;const g=self.VTTCue||self.TextTrackCue;for(let _=0;_<r.rows.length;_++)if(u=r.rows[_],f=!0,d=0,m="",!u.isEmpty()){var v;for(let T=0;T<u.chars.length;T++)Jce.test(u.chars[T].uchar)&&f?d++:(m+=u.chars[T].uchar,f=!1);u.cueStartTime=e,e===t&&(t+=1e-4),d>=16?d--:d++;const S=zW(m.trim()),E=w1(e,t,S);n!=null&&(v=n.cues)!=null&&v.getCueById(E)||(h=new g(e,t,S),h.id=E,h.line=_+1,h.align="left",h.position=10+Math.min(80,Math.floor(d*8/32)*10),o.push(h))}return n&&o.length&&(o.sort((_,S)=>_.line==="auto"||S.line==="auto"?0:_.line>8&&S.line>8?S.line-_.line:_.line-S.line),o.forEach(_=>_W(n,_))),o}},efe={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},tfe=Ea(Ea({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:JW,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:sce,bufferController:pce,capLevelController:O1,errorController:Qle,fpsController:Bce,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:oW,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:efe},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},nfe()),{},{subtitleStreamController:cce,subtitleTrackController:dce,timelineController:Fce,audioStreamController:oce,audioTrackController:lce,emeController:Kh,cmcdController:Ec,contentSteeringController:Wce});function nfe(){return{cueHandler:Zce,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function rfe(n,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=Wb(n),r=["manifest","level","frag"],o=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return r.forEach(u=>{const h=`${u==="level"?"playlist":u}LoadPolicy`,f=e[h]===void 0,d=[];o.forEach(m=>{const g=`${u}Loading${m}`,v=e[g];if(v!==void 0&&f){d.push(g);const _=t[h].default;switch(e[h]={default:_},m){case"TimeOut":_.maxLoadTimeMs=v,_.maxTimeToFirstByteMs=v;break;case"MaxRetry":_.errorRetry.maxNumRetry=v,_.timeoutRetry.maxNumRetry=v;break;case"RetryDelay":_.errorRetry.retryDelayMs=v,_.timeoutRetry.retryDelayMs=v;break;case"MaxRetryTimeout":_.errorRetry.maxRetryDelayMs=v,_.timeoutRetry.maxRetryDelayMs=v;break}}}),d.length&&xt.warn(`hls.js config: "${d.join('", "')}" setting(s) are deprecated, use "${h}": ${JSON.stringify(e[h])}`)}),Ea(Ea({},t),e)}function Wb(n){return n&&typeof n=="object"?Array.isArray(n)?n.map(Wb):Object.keys(n).reduce((e,t)=>(e[t]=Wb(n[t]),e),{}):n}function ife(n){const e=n.loader;e!==l4&&e!==JW?(xt.log("[config]: Custom loader detected, cannot enable progressive streaming"),n.progressive=!1):Vce()&&(n.loader=l4,n.progressive=!0,n.enableSoftwareAES=!0,xt.log("[config]: Progressive streaming enabled, using FetchLoader"))}class hs{static get version(){return"1.4.0"}static isSupported(){return mue()}static get Events(){return ke}static get ErrorTypes(){return $n}static get ErrorDetails(){return zt}static get DefaultConfig(){return hs.defaultConfig?hs.defaultConfig:tfe}static set DefaultConfig(e){hs.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new c0,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,Goe(e.debug||!1,"Hls instance");const t=this.config=rfe(hs.DefaultConfig,e);this.userConfig=e,this._autoLevelCapping=-1,t.progressive&&ife(t);const{abrController:r,bufferController:o,capLevelController:u,errorController:h,fpsController:f}=t,d=new h(this),m=this.abrController=new r(this),g=this.bufferController=new o(this),v=this.capLevelController=new u(this),_=new f(this),S=new Mle(this),E=new kle(this),T=t.contentSteeringController,C=T?new T(this):null,R=this.levelController=new Zle(this,C),b=new eue(this),F=new nue(this.config),O=this.streamController=new rce(this,b,F);v.setStreamController(O),_.setStreamController(O);const L=[S,R,O];C&&L.splice(1,0,C),this.networkControllers=L;const D=[m,g,v,_,E,b];this.audioTrackController=this.createController(t.audioTrackController,L);const x=t.audioStreamController;x&&L.push(new x(this,b,F)),this.subtitleTrackController=this.createController(t.subtitleTrackController,L);const B=t.subtitleStreamController;B&&L.push(new B(this,b,F)),this.createController(t.timelineController,D),F.emeController=this.emeController=this.createController(t.emeController,D),this.cmcdController=this.createController(t.cmcdController,D),this.latencyController=this.createController(Ule,D),this.coreComponents=D,L.push(d);const M=d.onErrorOut;typeof M=="function"&&this.on(ke.ERROR,M,d)}createController(e,t){if(e){const r=new e(this);return t&&t.push(r),r}return null}on(e,t,r=this){this._emitter.on(e,t,r)}once(e,t,r=this){this._emitter.once(e,t,r)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,r=this,o){this._emitter.off(e,t,r,o)}listeners(e){return this._emitter.listeners(e)}emit(e,t,r){return this._emitter.emit(e,t,r)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(r){xt.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),this.trigger(ke.ERROR,{type:$n.OTHER_ERROR,details:zt.INTERNAL_EXCEPTION,fatal:!1,event:e,error:r})}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){xt.log("destroy"),this.trigger(ke.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){xt.log("attachMedia"),this._media=e,this.trigger(ke.MEDIA_ATTACHING,{media:e})}detachMedia(){xt.log("detachMedia"),this.trigger(ke.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,r=this.url,o=this.url=a0.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});xt.log(`loadSource:${o}`),t&&r&&r!==o&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(t)),this.trigger(ke.MANIFEST_LOADING,{url:e})}startLoad(e=-1){xt.log(`startLoad(${e})`),this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){xt.log("stopLoad"),this.networkControllers.forEach(e=>{e.stopLoad()})}swapAudioCodec(){xt.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){xt.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e,t=0){this.levelController.removeLevel(e,t)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){xt.log(`set currentLevel:${e}`),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){xt.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){xt.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){xt.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){return this.levelController.startLevel}set startLevel(e){xt.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(xt.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){Ub.indexOf(e)>-1&&(this._maxHdcpLevel=e)}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const r=e.length;for(let o=0;o<r;o++)if(e[o].maxBitrate>=t)return o;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:r}=this;let o;if(t===-1&&e&&e.length?o=e.length-1:o=t,r)for(let u=o;u--;){const h=e[u].attrs["HDCP-LEVEL"];if(h&&h<=r)return u}return o}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}hs.defaultConfig=void 0;var Hb={},sfe={get exports(){return Hb},set exports(n){Hb=n}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var r=[],o=0;o<arguments.length;o++){var u=arguments[o];if(u){var h=typeof u;if(h==="string"||h==="number")r.push(u);else if(Array.isArray(u)){if(u.length){var f=t.apply(null,u);f&&r.push(f)}}else if(h==="object"){if(u.toString!==Object.prototype.toString&&!u.toString.toString().includes("[native code]")){r.push(u.toString());continue}for(var d in u)e.call(u,d)&&u[d]&&r.push(d)}}}return r.join(" ")}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(sfe);const Wr=Hb;function ZW(n,e){if(n==null)return{};var t={},r=Object.keys(n),o,u;for(u=0;u<r.length;u++)o=r[u],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}function u4(n){return"default"+n.charAt(0).toUpperCase()+n.substr(1)}function afe(n){var e=ofe(n,"string");return typeof e=="symbol"?e:String(e)}function ofe(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function lfe(n,e,t){var r=Ot.useRef(n!==void 0),o=Ot.useState(e),u=o[0],h=o[1],f=n!==void 0,d=r.current;return r.current=f,!f&&d&&u!==e&&h(e),[f?n:u,Ot.useCallback(function(m){for(var g=arguments.length,v=new Array(g>1?g-1:0),_=1;_<g;_++)v[_-1]=arguments[_];t&&t.apply(void 0,[m].concat(v)),h(m)},[t])]}function e5(n,e){return Object.keys(e).reduce(function(t,r){var o,u=t,h=u[u4(r)],f=u[r],d=ZW(u,[u4(r),r].map(afe)),m=e[r],g=lfe(f,h,n[m]),v=g[0],_=g[1];return qo({},d,(o={},o[r]=v,o[m]=_,o))},n)}function Vb(n,e){return Vb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},Vb(n,e)}function ufe(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,Vb(n,e)}function cfe(n){var e=Ot.useRef(n);return Ot.useEffect(function(){e.current=n},[n]),e}function wl(n){var e=cfe(n);return Ot.useCallback(function(){return e.current&&e.current.apply(e,arguments)},[e])}function ffe(){return Ot.useState(null)}function dfe(n,e,t,r){r===void 0&&(r=!1);var o=wl(t);Ot.useEffect(function(){var u=typeof n=="function"?n():n;return u.addEventListener(e,o,r),function(){return u.removeEventListener(e,o,r)}},[n])}function hfe(){var n=Ot.useRef(!0),e=Ot.useRef(function(){return n.current});return Ot.useEffect(function(){return n.current=!0,function(){n.current=!1}},[]),e.current}function pfe(n){var e=Ot.useRef(null);return Ot.useEffect(function(){e.current=n}),e.current}var gfe=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",mfe=typeof document<"u";const vfe=mfe||gfe?Ot.useLayoutEffect:Ot.useEffect,yfe=["as","disabled"];function Efe(n,e){if(n==null)return{};var t={},r=Object.keys(n),o,u;for(u=0;u<r.length;u++)o=r[u],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}function _fe(n){return!n||n.trim()==="#"}function N1({tagName:n,disabled:e,href:t,target:r,rel:o,role:u,onClick:h,tabIndex:f=0,type:d}){n||(t!=null||r!=null||o!=null?n="a":n="button");const m={tagName:n};if(n==="button")return[{type:d||"button",disabled:e},m];const g=_=>{if((e||n==="a"&&_fe(t))&&_.preventDefault(),e){_.stopPropagation();return}h==null||h(_)},v=_=>{_.key===" "&&(_.preventDefault(),g(_))};return n==="a"&&(t||(t="#"),e&&(t=void 0)),[{role:u??"button",disabled:void 0,tabIndex:e?void 0:f,href:t,target:n==="a"?r:void 0,"aria-disabled":e||void 0,rel:n==="a"?o:void 0,onClick:g,onKeyDown:v},m]}const t5=Ot.forwardRef((n,e)=>{let{as:t,disabled:r}=n,o=Efe(n,yfe);const[u,{tagName:h}]=N1(Object.assign({tagName:t,disabled:r},o));return ln(h,Object.assign({},o,u,{ref:e}))});t5.displayName="Button";const Tfe=["onKeyDown"];function Sfe(n,e){if(n==null)return{};var t={},r=Object.keys(n),o,u;for(u=0;u<r.length;u++)o=r[u],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}function Afe(n){return!n||n.trim()==="#"}const n5=Ot.forwardRef((n,e)=>{let{onKeyDown:t}=n,r=Sfe(n,Tfe);const[o]=N1(Object.assign({tagName:"a"},r)),u=wl(h=>{o.onKeyDown(h),t==null||t(h)});return Afe(r.href)||r.role==="button"?ln("a",Object.assign({ref:e},r,o,{onKeyDown:u})):ln("a",Object.assign({ref:e},r,{onKeyDown:t}))});n5.displayName="Anchor";const r5=n5,xfe=["xxl","xl","lg","md","sm","xs"],Cfe="xs",cS=Ot.createContext({prefixes:{},breakpoints:xfe,minBreakpoint:Cfe});function Li(n,e){const{prefixes:t}=Ot.useContext(cS);return n||t[e]||e}function i5(){const{breakpoints:n}=Ot.useContext(cS);return n}function s5(){const{minBreakpoint:n}=Ot.useContext(cS);return n}function Ife(){const{dir:n}=Ot.useContext(cS);return n==="rtl"}var pr={},Rfe={get exports(){return pr},set exports(n){pr=n}},bfe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Dfe=bfe,Pfe=Dfe;function a5(){}function o5(){}o5.resetWarningCache=a5;var Lfe=function(){function n(r,o,u,h,f,d){if(d!==Pfe){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o5,resetWarningCache:a5};return t.PropTypes=t,t};Rfe.exports=Lfe();const c4={disabled:!1},l5=Ws.createContext(null);var Mfe=function(e){return e.scrollTop},sm="unmounted",Pf="exited",_c="entering",wf="entered",$b="exiting",Wu=function(n){ufe(e,n);function e(r,o){var u;u=n.call(this,r,o)||this;var h=o,f=h&&!h.isMounting?r.enter:r.appear,d;return u.appearStatus=null,r.in?f?(d=Pf,u.appearStatus=_c):d=wf:r.unmountOnExit||r.mountOnEnter?d=sm:d=Pf,u.state={status:d},u.nextCallback=null,u}e.getDerivedStateFromProps=function(o,u){var h=o.in;return h&&u.status===sm?{status:Pf}:null};var t=e.prototype;return t.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},t.componentDidUpdate=function(o){var u=null;if(o!==this.props){var h=this.state.status;this.props.in?h!==_c&&h!==wf&&(u=_c):(h===_c||h===wf)&&(u=$b)}this.updateStatus(!1,u)},t.componentWillUnmount=function(){this.cancelNextCallback()},t.getTimeouts=function(){var o=this.props.timeout,u,h,f;return u=h=f=o,o!=null&&typeof o!="number"&&(u=o.exit,h=o.enter,f=o.appear!==void 0?o.appear:h),{exit:u,enter:h,appear:f}},t.updateStatus=function(o,u){if(o===void 0&&(o=!1),u!==null)if(this.cancelNextCallback(),u===_c){if(this.props.unmountOnExit||this.props.mountOnEnter){var h=this.props.nodeRef?this.props.nodeRef.current:qg.findDOMNode(this);h&&Mfe(h)}this.performEnter(o)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Pf&&this.setState({status:sm})},t.performEnter=function(o){var u=this,h=this.props.enter,f=this.context?this.context.isMounting:o,d=this.props.nodeRef?[f]:[qg.findDOMNode(this),f],m=d[0],g=d[1],v=this.getTimeouts(),_=f?v.appear:v.enter;if(!o&&!h||c4.disabled){this.safeSetState({status:wf},function(){u.props.onEntered(m)});return}this.props.onEnter(m,g),this.safeSetState({status:_c},function(){u.props.onEntering(m,g),u.onTransitionEnd(_,function(){u.safeSetState({status:wf},function(){u.props.onEntered(m,g)})})})},t.performExit=function(){var o=this,u=this.props.exit,h=this.getTimeouts(),f=this.props.nodeRef?void 0:qg.findDOMNode(this);if(!u||c4.disabled){this.safeSetState({status:Pf},function(){o.props.onExited(f)});return}this.props.onExit(f),this.safeSetState({status:$b},function(){o.props.onExiting(f),o.onTransitionEnd(h.exit,function(){o.safeSetState({status:Pf},function(){o.props.onExited(f)})})})},t.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},t.safeSetState=function(o,u){u=this.setNextCallback(u),this.setState(o,u)},t.setNextCallback=function(o){var u=this,h=!0;return this.nextCallback=function(f){h&&(h=!1,u.nextCallback=null,o(f))},this.nextCallback.cancel=function(){h=!1},this.nextCallback},t.onTransitionEnd=function(o,u){this.setNextCallback(u);var h=this.props.nodeRef?this.props.nodeRef.current:qg.findDOMNode(this),f=o==null&&!this.props.addEndListener;if(!h||f){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var d=this.props.nodeRef?[this.nextCallback]:[h,this.nextCallback],m=d[0],g=d[1];this.props.addEndListener(m,g)}o!=null&&setTimeout(this.nextCallback,o)},t.render=function(){var o=this.state.status;if(o===sm)return null;var u=this.props,h=u.children;u.in,u.mountOnEnter,u.unmountOnExit,u.appear,u.enter,u.exit,u.timeout,u.addEndListener,u.onEnter,u.onEntering,u.onEntered,u.onExit,u.onExiting,u.onExited,u.nodeRef;var f=ZW(u,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Ws.createElement(l5.Provider,{value:null},typeof h=="function"?h(o,f):Ws.cloneElement(Ws.Children.only(h),f))},e}(Ws.Component);Wu.contextType=l5;Wu.propTypes={};function sh(){}Wu.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:sh,onEntering:sh,onEntered:sh,onExit:sh,onExiting:sh,onExited:sh};Wu.UNMOUNTED=sm;Wu.EXITED=Pf;Wu.ENTERING=_c;Wu.ENTERED=wf;Wu.EXITING=$b;function u5(n){return n&&n.ownerDocument||document}function wfe(n){var e=u5(n);return e&&e.defaultView||window}function Ofe(n,e){return wfe(n).getComputedStyle(n,e)}var Nfe=/([A-Z])/g;function Ffe(n){return n.replace(Nfe,"-$1").toLowerCase()}var kfe=/^ms-/;function yE(n){return Ffe(n).replace(kfe,"-ms-")}var Ufe=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function Bfe(n){return!!(n&&Ufe.test(n))}function c5(n,e){var t="",r="";if(typeof e=="string")return n.style.getPropertyValue(yE(e))||Ofe(n).getPropertyValue(yE(e));Object.keys(e).forEach(function(o){var u=e[o];!u&&u!==0?n.style.removeProperty(yE(o)):Bfe(o)?r+=o+"("+u+") ":t+=yE(o)+": "+u+";"}),r&&(t+="transform: "+r+";"),n.style.cssText+=";"+t}const f5=!!(typeof window<"u"&&window.document&&window.document.createElement);var zb=!1,Yb=!1;try{var YI={get passive(){return zb=!0},get once(){return Yb=zb=!0}};f5&&(window.addEventListener("test",YI,YI),window.removeEventListener("test",YI,!0))}catch{}function d5(n,e,t,r){if(r&&typeof r!="boolean"&&!Yb){var o=r.once,u=r.capture,h=t;!Yb&&o&&(h=t.__once||function f(d){this.removeEventListener(e,f,u),t.call(this,d)},t.__once=h),n.addEventListener(e,h,zb?r:u)}n.addEventListener(e,t,r)}function jfe(n,e,t,r){var o=r&&typeof r!="boolean"?r.capture:r;n.removeEventListener(e,t,o),t.__once&&n.removeEventListener(e,t.__once,o)}function Rh(n,e,t,r){return d5(n,e,t,r),function(){jfe(n,e,t,r)}}function Kfe(n,e,t,r){if(t===void 0&&(t=!1),r===void 0&&(r=!0),n){var o=document.createEvent("HTMLEvents");o.initEvent(e,t,r),n.dispatchEvent(o)}}function Gfe(n){var e=c5(n,"transitionDuration")||"",t=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*t}function Wfe(n,e,t){t===void 0&&(t=5);var r=!1,o=setTimeout(function(){r||Kfe(n,"transitionend",!0)},e+t),u=Rh(n,"transitionend",function(){r=!0},{once:!0});return function(){clearTimeout(o),u()}}function Hfe(n,e,t,r){t==null&&(t=Gfe(n)||0);var o=Wfe(n,t,r),u=Rh(n,"transitionend",e);return function(){o(),u()}}function f4(n,e){const t=c5(n,e)||"",r=t.indexOf("ms")===-1?1e3:1;return parseFloat(t)*r}function Vfe(n,e){const t=f4(n,"transitionDuration"),r=f4(n,"transitionDelay"),o=Hfe(n,u=>{u.target===n&&(o(),e(u))},t+r)}function $fe(n){n.offsetHeight}var d4=function(e){return!e||typeof e=="function"?e:function(t){e.current=t}};function zfe(n,e){var t=d4(n),r=d4(e);return function(o){t&&t(o),r&&r(o)}}function F1(n,e){return Ot.useMemo(function(){return zfe(n,e)},[n,e])}function Yfe(n){return n&&"setState"in n?qg.findDOMNode(n):n??null}const Xfe=Ws.forwardRef(({onEnter:n,onEntering:e,onEntered:t,onExit:r,onExiting:o,onExited:u,addEndListener:h,children:f,childRef:d,...m},g)=>{const v=Ot.useRef(null),_=F1(v,d),S=D=>{_(Yfe(D))},E=D=>x=>{D&&v.current&&D(v.current,x)},T=Ot.useCallback(E(n),[n]),C=Ot.useCallback(E(e),[e]),R=Ot.useCallback(E(t),[t]),b=Ot.useCallback(E(r),[r]),F=Ot.useCallback(E(o),[o]),O=Ot.useCallback(E(u),[u]),L=Ot.useCallback(E(h),[h]);return ln(Wu,{ref:g,...m,onEnter:T,onEntered:R,onEntering:C,onExit:b,onExited:O,onExiting:F,addEndListener:L,nodeRef:v,children:typeof f=="function"?(D,x)=>f(D,{...x,ref:S}):Ws.cloneElement(f,{ref:S})})}),qfe={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1},Qfe={[_c]:"show",[wf]:"show"},fS=Ot.forwardRef(({className:n,children:e,transitionClasses:t={},...r},o)=>{const u=Ot.useCallback((h,f)=>{$fe(h),r.onEnter==null||r.onEnter(h,f)},[r]);return ln(Xfe,{ref:o,addEndListener:Vfe,...r,onEnter:u,childRef:e.ref,children:(h,f)=>Ot.cloneElement(e,{...f,className:Wr("fade",n,e.props.className,Qfe[h],t[h])})})});fS.defaultProps=qfe;fS.displayName="Fade";const Jfe={"aria-label":pr.string,onClick:pr.func,variant:pr.oneOf(["white"])},Zfe={"aria-label":"Close"},dS=Ot.forwardRef(({className:n,variant:e,...t},r)=>ln("button",{ref:r,type:"button",className:Wr("btn-close",e&&`btn-close-${e}`,n),...t}));dS.displayName="CloseButton";dS.propTypes=Jfe;dS.defaultProps=Zfe;const ede=n=>Ot.forwardRef((e,t)=>ln("div",{...e,ref:t,className:Wr(e.className,n)}));var tde=/-(.)/g;function nde(n){return n.replace(tde,function(e,t){return t.toUpperCase()})}const rde=n=>n[0].toUpperCase()+nde(n).slice(1);function od(n,{displayName:e=rde(n),Component:t,defaultProps:r}={}){const o=Ot.forwardRef(({className:u,bsPrefix:h,as:f=t||"div",...d},m)=>{const g=Li(h,n);return ln(f,{ref:m,className:Wr(u,g),...d})});return o.defaultProps=r,o.displayName=e,o}const h5=ede("h4");h5.displayName="DivStyledAsH4";const ide=od("alert-heading",{Component:h5}),sde=od("alert-link",{Component:r5}),ade={variant:"primary",show:!0,transition:fS,closeLabel:"Close alert"},k1=Ot.forwardRef((n,e)=>{const{bsPrefix:t,show:r,closeLabel:o,closeVariant:u,className:h,children:f,variant:d,onClose:m,dismissible:g,transition:v,..._}=e5(n,{show:"onClose"}),S=Li(t,"alert"),E=wl(R=>{m&&m(!1,R)}),T=v===!0?fS:v,C=Ts("div",{role:"alert",...T?void 0:_,ref:e,className:Wr(h,S,d&&`${S}-${d}`,g&&`${S}-dismissible`),children:[g&&ln(dS,{onClick:E,"aria-label":o,variant:u}),f]});return T?ln(T,{unmountOnExit:!0,..._,ref:void 0,in:r,children:C}):r?C:null});k1.displayName="Alert";k1.defaultProps=ade;const Xb=Object.assign(k1,{Link:sde,Heading:ide});function ode({manifestURI:n,dispatchReqList:e}){const r=Ot.useRef(null),[o,u]=Ot.useState("");return Ot.useEffect(()=>{e(o)},[o]),Ot.useEffect(()=>{let h;r.current;function f(){h!=null&&h.destroy();const d=new hs({enableWorker:!1,cmcd:!0});d.on(hs.Events.MANIFEST_LOADED,function(m,g){u({type:"saveQuery",payload:{url:g.url,result:Kf(g.url)}})}),d.on(hs.Events.FRAG_LOADED,function(m,g){u({type:"saveQuery",payload:{url:g.networkDetails.responseURL,result:Kf(g.networkDetails.responseURL)}})}),d.on(hs.Events.LEVEL_LOADED,function(m,g){u({type:"saveQuery",payload:{url:g.networkDetails.responseURL,result:Kf(g.networkDetails.responseURL)}})}),r.current!=null&&d.attachMedia(r.current),d.on(hs.Events.MEDIA_ATTACHED,()=>{d.loadSource(n),d.on(hs.Events.MANIFEST_PARSED,()=>{var m;(m=r==null?void 0:r.current)==null||m.play().catch(()=>console.log("Unable to autoplay prior to user interaction with the dom."))})}),d.on(hs.Events.ERROR,function(m,g){if(g.fatal)switch(g.type){case hs.ErrorTypes.NETWORK_ERROR:d.startLoad();break;case hs.ErrorTypes.MEDIA_ERROR:d.recoverMediaError();break;default:f();break}}),h=d}return hs.isSupported()&&f(),()=>{h!=null&&h.destroy()}},[!0,r,n]),hs.isSupported()?ln("video",{width:"100%",height:"100%",ref:r,autoPlay:!0,controls:!0}):Ts(Xb,{variant:"danger",children:[ln(Xb.Heading,{children:"Oh snap! HLS is not supported!"}),ln("p",{children:"Sorry, your browser does not support HLS video playback. Try with another player or switching browsers!"})]})}const lde=({playerSelected:n,playerDispatch:e,manifestURI:t})=>{const[r,o]=Ot.useState(ln("div",{}));return Ot.useEffect(()=>{switch(n){case"SHAKA":return o(ln("div",{children:ln(xee,{dispatchReqList:e,manifestURI:t})}));case"HLS":return o(ln("div",{children:ln(ode,{dispatchReqList:e,manifestURI:t})}));case"DASH":return o(ln("div",{children:ln(Noe,{dispatchReqList:e,manifestURI:t})}));case"VIDEOJS":return o(ln("div",{children:ln(woe,{dispatchReqList:e,manifestURI:t})}));default:return o(ln("div",{}))}},[n,t]),r};var ude=Function.prototype.bind.call(Function.prototype.call,[].slice);function h4(n,e){return ude(n.querySelectorAll(e))}function cde(n,e,t){const r=Ot.useRef(n!==void 0),[o,u]=Ot.useState(e),h=n!==void 0,f=r.current;return r.current=h,!h&&f&&o!==e&&u(e),[h?n:o,Ot.useCallback((d,...m)=>{t&&t(d,...m),u(d)},[t])]}function fde(){var n=Ot.useReducer(function(t){return!t},!1),e=n[1];return e}const dde=Ot.createContext(null),hS=dde;var p4=Object.prototype.hasOwnProperty;function g4(n,e,t){for(t of n.keys())if(Cm(t,e))return t}function Cm(n,e){var t,r,o;if(n===e)return!0;if(n&&e&&(t=n.constructor)===e.constructor){if(t===Date)return n.getTime()===e.getTime();if(t===RegExp)return n.toString()===e.toString();if(t===Array){if((r=n.length)===e.length)for(;r--&&Cm(n[r],e[r]););return r===-1}if(t===Set){if(n.size!==e.size)return!1;for(r of n)if(o=r,o&&typeof o=="object"&&(o=g4(e,o),!o)||!e.has(o))return!1;return!0}if(t===Map){if(n.size!==e.size)return!1;for(r of n)if(o=r[0],o&&typeof o=="object"&&(o=g4(e,o),!o)||!Cm(r[1],e.get(o)))return!1;return!0}if(t===ArrayBuffer)n=new Uint8Array(n),e=new Uint8Array(e);else if(t===DataView){if((r=n.byteLength)===e.byteLength)for(;r--&&n.getInt8(r)===e.getInt8(r););return r===-1}if(ArrayBuffer.isView(n)){if((r=n.byteLength)===e.byteLength)for(;r--&&n[r]===e[r];);return r===-1}if(!t||typeof n=="object"){r=0;for(t in n)if(p4.call(n,t)&&++r&&!p4.call(e,t)||!(t in e)||!Cm(n[t],e[t]))return!1;return Object.keys(e).length===r}}return n!==n&&e!==e}function hde(n){var e=hfe();return[n[0],Ot.useCallback(function(t){if(e())return n[1](t)},[e,n[1]])]}var ma="top",mo="bottom",vo="right",va="left",U1="auto",R0=[ma,mo,vo,va],lp="start",f0="end",pde="clippingParents",p5="viewport",Vg="popper",gde="reference",m4=R0.reduce(function(n,e){return n.concat([e+"-"+lp,e+"-"+f0])},[]),g5=[].concat(R0,[U1]).reduce(function(n,e){return n.concat([e,e+"-"+lp,e+"-"+f0])},[]),mde="beforeRead",vde="read",yde="afterRead",Ede="beforeMain",_de="main",Tde="afterMain",Sde="beforeWrite",Ade="write",xde="afterWrite",Cde=[mde,vde,yde,Ede,_de,Tde,Sde,Ade,xde];function Ol(n){return n.split("-")[0]}function yo(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function nd(n){var e=yo(n).Element;return n instanceof e||n instanceof Element}function Nl(n){var e=yo(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function B1(n){if(typeof ShadowRoot>"u")return!1;var e=yo(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}var $f=Math.max,iT=Math.min,up=Math.round;function qb(){var n=navigator.userAgentData;return n!=null&&n.brands?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function m5(){return!/^((?!chrome|android).)*safari/i.test(qb())}function cp(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var r=n.getBoundingClientRect(),o=1,u=1;e&&Nl(n)&&(o=n.offsetWidth>0&&up(r.width)/n.offsetWidth||1,u=n.offsetHeight>0&&up(r.height)/n.offsetHeight||1);var h=nd(n)?yo(n):window,f=h.visualViewport,d=!m5()&&t,m=(r.left+(d&&f?f.offsetLeft:0))/o,g=(r.top+(d&&f?f.offsetTop:0))/u,v=r.width/o,_=r.height/u;return{width:v,height:_,top:g,right:m+v,bottom:g+_,left:m,x:m,y:g}}function j1(n){var e=cp(n),t=n.offsetWidth,r=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:r}}function v5(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&B1(t)){var r=e;do{if(r&&n.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Bc(n){return n?(n.nodeName||"").toLowerCase():null}function Uu(n){return yo(n).getComputedStyle(n)}function Ide(n){return["table","td","th"].indexOf(Bc(n))>=0}function $c(n){return((nd(n)?n.ownerDocument:n.document)||window.document).documentElement}function pS(n){return Bc(n)==="html"?n:n.assignedSlot||n.parentNode||(B1(n)?n.host:null)||$c(n)}function v4(n){return!Nl(n)||Uu(n).position==="fixed"?null:n.offsetParent}function Rde(n){var e=/firefox/i.test(qb()),t=/Trident/i.test(qb());if(t&&Nl(n)){var r=Uu(n);if(r.position==="fixed")return null}var o=pS(n);for(B1(o)&&(o=o.host);Nl(o)&&["html","body"].indexOf(Bc(o))<0;){var u=Uu(o);if(u.transform!=="none"||u.perspective!=="none"||u.contain==="paint"||["transform","perspective"].indexOf(u.willChange)!==-1||e&&u.willChange==="filter"||e&&u.filter&&u.filter!=="none")return o;o=o.parentNode}return null}function b0(n){for(var e=yo(n),t=v4(n);t&&Ide(t)&&Uu(t).position==="static";)t=v4(t);return t&&(Bc(t)==="html"||Bc(t)==="body"&&Uu(t).position==="static")?e:t||Rde(n)||e}function K1(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Im(n,e,t){return $f(n,iT(e,t))}function bde(n,e,t){var r=Im(n,e,t);return r>t?t:r}function y5(){return{top:0,right:0,bottom:0,left:0}}function E5(n){return Object.assign({},y5(),n)}function _5(n,e){return e.reduce(function(t,r){return t[r]=n,t},{})}var Dde=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,E5(typeof e!="number"?e:_5(e,R0))};function Pde(n){var e,t=n.state,r=n.name,o=n.options,u=t.elements.arrow,h=t.modifiersData.popperOffsets,f=Ol(t.placement),d=K1(f),m=[va,vo].indexOf(f)>=0,g=m?"height":"width";if(!(!u||!h)){var v=Dde(o.padding,t),_=j1(u),S=d==="y"?ma:va,E=d==="y"?mo:vo,T=t.rects.reference[g]+t.rects.reference[d]-h[d]-t.rects.popper[g],C=h[d]-t.rects.reference[d],R=b0(u),b=R?d==="y"?R.clientHeight||0:R.clientWidth||0:0,F=T/2-C/2,O=v[S],L=b-_[g]-v[E],D=b/2-_[g]/2+F,x=Im(O,D,L),B=d;t.modifiersData[r]=(e={},e[B]=x,e.centerOffset=x-D,e)}}function Lde(n){var e=n.state,t=n.options,r=t.element,o=r===void 0?"[data-popper-arrow]":r;o!=null&&(typeof o=="string"&&(o=e.elements.popper.querySelector(o),!o)||v5(e.elements.popper,o)&&(e.elements.arrow=o))}const Mde={name:"arrow",enabled:!0,phase:"main",fn:Pde,effect:Lde,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function fp(n){return n.split("-")[1]}var wde={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ode(n){var e=n.x,t=n.y,r=window,o=r.devicePixelRatio||1;return{x:up(e*o)/o||0,y:up(t*o)/o||0}}function y4(n){var e,t=n.popper,r=n.popperRect,o=n.placement,u=n.variation,h=n.offsets,f=n.position,d=n.gpuAcceleration,m=n.adaptive,g=n.roundOffsets,v=n.isFixed,_=h.x,S=_===void 0?0:_,E=h.y,T=E===void 0?0:E,C=typeof g=="function"?g({x:S,y:T}):{x:S,y:T};S=C.x,T=C.y;var R=h.hasOwnProperty("x"),b=h.hasOwnProperty("y"),F=va,O=ma,L=window;if(m){var D=b0(t),x="clientHeight",B="clientWidth";if(D===yo(t)&&(D=$c(t),Uu(D).position!=="static"&&f==="absolute"&&(x="scrollHeight",B="scrollWidth")),D=D,o===ma||(o===va||o===vo)&&u===f0){O=mo;var M=v&&D===L&&L.visualViewport?L.visualViewport.height:D[x];T-=M-r.height,T*=d?1:-1}if(o===va||(o===ma||o===mo)&&u===f0){F=vo;var I=v&&D===L&&L.visualViewport?L.visualViewport.width:D[B];S-=I-r.width,S*=d?1:-1}}var U=Object.assign({position:f},m&&wde),w=g===!0?Ode({x:S,y:T}):{x:S,y:T};if(S=w.x,T=w.y,d){var k;return Object.assign({},U,(k={},k[O]=b?"0":"",k[F]=R?"0":"",k.transform=(L.devicePixelRatio||1)<=1?"translate("+S+"px, "+T+"px)":"translate3d("+S+"px, "+T+"px, 0)",k))}return Object.assign({},U,(e={},e[O]=b?T+"px":"",e[F]=R?S+"px":"",e.transform="",e))}function Nde(n){var e=n.state,t=n.options,r=t.gpuAcceleration,o=r===void 0?!0:r,u=t.adaptive,h=u===void 0?!0:u,f=t.roundOffsets,d=f===void 0?!0:f,m={placement:Ol(e.placement),variation:fp(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:o,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,y4(Object.assign({},m,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:h,roundOffsets:d})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,y4(Object.assign({},m,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:d})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Fde={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Nde,data:{}};var EE={passive:!0};function kde(n){var e=n.state,t=n.instance,r=n.options,o=r.scroll,u=o===void 0?!0:o,h=r.resize,f=h===void 0?!0:h,d=yo(e.elements.popper),m=[].concat(e.scrollParents.reference,e.scrollParents.popper);return u&&m.forEach(function(g){g.addEventListener("scroll",t.update,EE)}),f&&d.addEventListener("resize",t.update,EE),function(){u&&m.forEach(function(g){g.removeEventListener("scroll",t.update,EE)}),f&&d.removeEventListener("resize",t.update,EE)}}const Ude={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:kde,data:{}};var Bde={left:"right",right:"left",bottom:"top",top:"bottom"};function BE(n){return n.replace(/left|right|bottom|top/g,function(e){return Bde[e]})}var jde={start:"end",end:"start"};function E4(n){return n.replace(/start|end/g,function(e){return jde[e]})}function G1(n){var e=yo(n),t=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:t,scrollTop:r}}function W1(n){return cp($c(n)).left+G1(n).scrollLeft}function Kde(n,e){var t=yo(n),r=$c(n),o=t.visualViewport,u=r.clientWidth,h=r.clientHeight,f=0,d=0;if(o){u=o.width,h=o.height;var m=m5();(m||!m&&e==="fixed")&&(f=o.offsetLeft,d=o.offsetTop)}return{width:u,height:h,x:f+W1(n),y:d}}function Gde(n){var e,t=$c(n),r=G1(n),o=(e=n.ownerDocument)==null?void 0:e.body,u=$f(t.scrollWidth,t.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),h=$f(t.scrollHeight,t.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),f=-r.scrollLeft+W1(n),d=-r.scrollTop;return Uu(o||t).direction==="rtl"&&(f+=$f(t.clientWidth,o?o.clientWidth:0)-u),{width:u,height:h,x:f,y:d}}function H1(n){var e=Uu(n),t=e.overflow,r=e.overflowX,o=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+o+r)}function T5(n){return["html","body","#document"].indexOf(Bc(n))>=0?n.ownerDocument.body:Nl(n)&&H1(n)?n:T5(pS(n))}function Rm(n,e){var t;e===void 0&&(e=[]);var r=T5(n),o=r===((t=n.ownerDocument)==null?void 0:t.body),u=yo(r),h=o?[u].concat(u.visualViewport||[],H1(r)?r:[]):r,f=e.concat(h);return o?f:f.concat(Rm(pS(h)))}function Qb(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Wde(n,e){var t=cp(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function _4(n,e,t){return e===p5?Qb(Kde(n,t)):nd(e)?Wde(e,t):Qb(Gde($c(n)))}function Hde(n){var e=Rm(pS(n)),t=["absolute","fixed"].indexOf(Uu(n).position)>=0,r=t&&Nl(n)?b0(n):n;return nd(r)?e.filter(function(o){return nd(o)&&v5(o,r)&&Bc(o)!=="body"}):[]}function Vde(n,e,t,r){var o=e==="clippingParents"?Hde(n):[].concat(e),u=[].concat(o,[t]),h=u[0],f=u.reduce(function(d,m){var g=_4(n,m,r);return d.top=$f(g.top,d.top),d.right=iT(g.right,d.right),d.bottom=iT(g.bottom,d.bottom),d.left=$f(g.left,d.left),d},_4(n,h,r));return f.width=f.right-f.left,f.height=f.bottom-f.top,f.x=f.left,f.y=f.top,f}function S5(n){var e=n.reference,t=n.element,r=n.placement,o=r?Ol(r):null,u=r?fp(r):null,h=e.x+e.width/2-t.width/2,f=e.y+e.height/2-t.height/2,d;switch(o){case ma:d={x:h,y:e.y-t.height};break;case mo:d={x:h,y:e.y+e.height};break;case vo:d={x:e.x+e.width,y:f};break;case va:d={x:e.x-t.width,y:f};break;default:d={x:e.x,y:e.y}}var m=o?K1(o):null;if(m!=null){var g=m==="y"?"height":"width";switch(u){case lp:d[m]=d[m]-(e[g]/2-t[g]/2);break;case f0:d[m]=d[m]+(e[g]/2-t[g]/2);break}}return d}function d0(n,e){e===void 0&&(e={});var t=e,r=t.placement,o=r===void 0?n.placement:r,u=t.strategy,h=u===void 0?n.strategy:u,f=t.boundary,d=f===void 0?pde:f,m=t.rootBoundary,g=m===void 0?p5:m,v=t.elementContext,_=v===void 0?Vg:v,S=t.altBoundary,E=S===void 0?!1:S,T=t.padding,C=T===void 0?0:T,R=E5(typeof C!="number"?C:_5(C,R0)),b=_===Vg?gde:Vg,F=n.rects.popper,O=n.elements[E?b:_],L=Vde(nd(O)?O:O.contextElement||$c(n.elements.popper),d,g,h),D=cp(n.elements.reference),x=S5({reference:D,element:F,strategy:"absolute",placement:o}),B=Qb(Object.assign({},F,x)),M=_===Vg?B:D,I={top:L.top-M.top+R.top,bottom:M.bottom-L.bottom+R.bottom,left:L.left-M.left+R.left,right:M.right-L.right+R.right},U=n.modifiersData.offset;if(_===Vg&&U){var w=U[o];Object.keys(I).forEach(function(k){var K=[vo,mo].indexOf(k)>=0?1:-1,W=[ma,mo].indexOf(k)>=0?"y":"x";I[k]+=w[W]*K})}return I}function $de(n,e){e===void 0&&(e={});var t=e,r=t.placement,o=t.boundary,u=t.rootBoundary,h=t.padding,f=t.flipVariations,d=t.allowedAutoPlacements,m=d===void 0?g5:d,g=fp(r),v=g?f?m4:m4.filter(function(E){return fp(E)===g}):R0,_=v.filter(function(E){return m.indexOf(E)>=0});_.length===0&&(_=v);var S=_.reduce(function(E,T){return E[T]=d0(n,{placement:T,boundary:o,rootBoundary:u,padding:h})[Ol(T)],E},{});return Object.keys(S).sort(function(E,T){return S[E]-S[T]})}function zde(n){if(Ol(n)===U1)return[];var e=BE(n);return[E4(n),e,E4(e)]}function Yde(n){var e=n.state,t=n.options,r=n.name;if(!e.modifiersData[r]._skip){for(var o=t.mainAxis,u=o===void 0?!0:o,h=t.altAxis,f=h===void 0?!0:h,d=t.fallbackPlacements,m=t.padding,g=t.boundary,v=t.rootBoundary,_=t.altBoundary,S=t.flipVariations,E=S===void 0?!0:S,T=t.allowedAutoPlacements,C=e.options.placement,R=Ol(C),b=R===C,F=d||(b||!E?[BE(C)]:zde(C)),O=[C].concat(F).reduce(function(_e,Z){return _e.concat(Ol(Z)===U1?$de(e,{placement:Z,boundary:g,rootBoundary:v,padding:m,flipVariations:E,allowedAutoPlacements:T}):Z)},[]),L=e.rects.reference,D=e.rects.popper,x=new Map,B=!0,M=O[0],I=0;I<O.length;I++){var U=O[I],w=Ol(U),k=fp(U)===lp,K=[ma,mo].indexOf(w)>=0,W=K?"width":"height",Y=d0(e,{placement:U,boundary:g,rootBoundary:v,altBoundary:_,padding:m}),J=K?k?vo:va:k?mo:ma;L[W]>D[W]&&(J=BE(J));var ee=BE(J),ue=[];if(u&&ue.push(Y[w]<=0),f&&ue.push(Y[J]<=0,Y[ee]<=0),ue.every(function(_e){return _e})){M=U,B=!1;break}x.set(U,ue)}if(B)for(var ie=E?3:1,Q=function(Z){var Ee=O.find(function(Se){var Me=x.get(Se);if(Me)return Me.slice(0,Z).every(function(de){return de})});if(Ee)return M=Ee,"break"},se=ie;se>0;se--){var ve=Q(se);if(ve==="break")break}e.placement!==M&&(e.modifiersData[r]._skip=!0,e.placement=M,e.reset=!0)}}const Xde={name:"flip",enabled:!0,phase:"main",fn:Yde,requiresIfExists:["offset"],data:{_skip:!1}};function T4(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function S4(n){return[ma,vo,mo,va].some(function(e){return n[e]>=0})}function qde(n){var e=n.state,t=n.name,r=e.rects.reference,o=e.rects.popper,u=e.modifiersData.preventOverflow,h=d0(e,{elementContext:"reference"}),f=d0(e,{altBoundary:!0}),d=T4(h,r),m=T4(f,o,u),g=S4(d),v=S4(m);e.modifiersData[t]={referenceClippingOffsets:d,popperEscapeOffsets:m,isReferenceHidden:g,hasPopperEscaped:v},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":g,"data-popper-escaped":v})}const Qde={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:qde};function Jde(n,e,t){var r=Ol(n),o=[va,ma].indexOf(r)>=0?-1:1,u=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,h=u[0],f=u[1];return h=h||0,f=(f||0)*o,[va,vo].indexOf(r)>=0?{x:f,y:h}:{x:h,y:f}}function Zde(n){var e=n.state,t=n.options,r=n.name,o=t.offset,u=o===void 0?[0,0]:o,h=g5.reduce(function(g,v){return g[v]=Jde(v,e.rects,u),g},{}),f=h[e.placement],d=f.x,m=f.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=d,e.modifiersData.popperOffsets.y+=m),e.modifiersData[r]=h}const ehe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Zde};function the(n){var e=n.state,t=n.name;e.modifiersData[t]=S5({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const nhe={name:"popperOffsets",enabled:!0,phase:"read",fn:the,data:{}};function rhe(n){return n==="x"?"y":"x"}function ihe(n){var e=n.state,t=n.options,r=n.name,o=t.mainAxis,u=o===void 0?!0:o,h=t.altAxis,f=h===void 0?!1:h,d=t.boundary,m=t.rootBoundary,g=t.altBoundary,v=t.padding,_=t.tether,S=_===void 0?!0:_,E=t.tetherOffset,T=E===void 0?0:E,C=d0(e,{boundary:d,rootBoundary:m,padding:v,altBoundary:g}),R=Ol(e.placement),b=fp(e.placement),F=!b,O=K1(R),L=rhe(O),D=e.modifiersData.popperOffsets,x=e.rects.reference,B=e.rects.popper,M=typeof T=="function"?T(Object.assign({},e.rects,{placement:e.placement})):T,I=typeof M=="number"?{mainAxis:M,altAxis:M}:Object.assign({mainAxis:0,altAxis:0},M),U=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,w={x:0,y:0};if(D){if(u){var k,K=O==="y"?ma:va,W=O==="y"?mo:vo,Y=O==="y"?"height":"width",J=D[O],ee=J+C[K],ue=J-C[W],ie=S?-B[Y]/2:0,Q=b===lp?x[Y]:B[Y],se=b===lp?-B[Y]:-x[Y],ve=e.elements.arrow,_e=S&&ve?j1(ve):{width:0,height:0},Z=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:y5(),Ee=Z[K],Se=Z[W],Me=Im(0,x[Y],_e[Y]),de=F?x[Y]/2-ie-Me-Ee-I.mainAxis:Q-Me-Ee-I.mainAxis,xe=F?-x[Y]/2+ie+Me+Se+I.mainAxis:se+Me+Se+I.mainAxis,Fe=e.elements.arrow&&b0(e.elements.arrow),Le=Fe?O==="y"?Fe.clientTop||0:Fe.clientLeft||0:0,De=(k=U==null?void 0:U[O])!=null?k:0,Ae=J+de-De-Le,ge=J+xe-De,pe=Im(S?iT(ee,Ae):ee,J,S?$f(ue,ge):ue);D[O]=pe,w[O]=pe-J}if(f){var Re,me=O==="x"?ma:va,V=O==="x"?mo:vo,j=D[L],$=L==="y"?"height":"width",re=j+C[me],oe=j-C[V],X=[ma,va].indexOf(R)!==-1,z=(Re=U==null?void 0:U[L])!=null?Re:0,ne=X?re:j-x[$]-B[$]-z+I.altAxis,fe=X?j+x[$]+B[$]-z-I.altAxis:oe,Ce=S&&X?bde(ne,j,fe):Im(S?ne:re,j,S?fe:oe);D[L]=Ce,w[L]=Ce-j}e.modifiersData[r]=w}}const she={name:"preventOverflow",enabled:!0,phase:"main",fn:ihe,requiresIfExists:["offset"]};function ahe(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function ohe(n){return n===yo(n)||!Nl(n)?G1(n):ahe(n)}function lhe(n){var e=n.getBoundingClientRect(),t=up(e.width)/n.offsetWidth||1,r=up(e.height)/n.offsetHeight||1;return t!==1||r!==1}function uhe(n,e,t){t===void 0&&(t=!1);var r=Nl(e),o=Nl(e)&&lhe(e),u=$c(e),h=cp(n,o,t),f={scrollLeft:0,scrollTop:0},d={x:0,y:0};return(r||!r&&!t)&&((Bc(e)!=="body"||H1(u))&&(f=ohe(e)),Nl(e)?(d=cp(e,!0),d.x+=e.clientLeft,d.y+=e.clientTop):u&&(d.x=W1(u))),{x:h.left+f.scrollLeft-d.x,y:h.top+f.scrollTop-d.y,width:h.width,height:h.height}}function che(n){var e=new Map,t=new Set,r=[];n.forEach(function(u){e.set(u.name,u)});function o(u){t.add(u.name);var h=[].concat(u.requires||[],u.requiresIfExists||[]);h.forEach(function(f){if(!t.has(f)){var d=e.get(f);d&&o(d)}}),r.push(u)}return n.forEach(function(u){t.has(u.name)||o(u)}),r}function fhe(n){var e=che(n);return Cde.reduce(function(t,r){return t.concat(e.filter(function(o){return o.phase===r}))},[])}function dhe(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function hhe(n){var e=n.reduce(function(t,r){var o=t[r.name];return t[r.name]=o?Object.assign({},o,r,{options:Object.assign({},o.options,r.options),data:Object.assign({},o.data,r.data)}):r,t},{});return Object.keys(e).map(function(t){return e[t]})}var A4={placement:"bottom",modifiers:[],strategy:"absolute"};function x4(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function phe(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,r=t===void 0?[]:t,o=e.defaultOptions,u=o===void 0?A4:o;return function(f,d,m){m===void 0&&(m=u);var g={placement:"bottom",orderedModifiers:[],options:Object.assign({},A4,u),modifiersData:{},elements:{reference:f,popper:d},attributes:{},styles:{}},v=[],_=!1,S={state:g,setOptions:function(R){var b=typeof R=="function"?R(g.options):R;T(),g.options=Object.assign({},u,g.options,b),g.scrollParents={reference:nd(f)?Rm(f):f.contextElement?Rm(f.contextElement):[],popper:Rm(d)};var F=fhe(hhe([].concat(r,g.options.modifiers)));return g.orderedModifiers=F.filter(function(O){return O.enabled}),E(),S.update()},forceUpdate:function(){if(!_){var R=g.elements,b=R.reference,F=R.popper;if(x4(b,F)){g.rects={reference:uhe(b,b0(F),g.options.strategy==="fixed"),popper:j1(F)},g.reset=!1,g.placement=g.options.placement,g.orderedModifiers.forEach(function(I){return g.modifiersData[I.name]=Object.assign({},I.data)});for(var O=0;O<g.orderedModifiers.length;O++){if(g.reset===!0){g.reset=!1,O=-1;continue}var L=g.orderedModifiers[O],D=L.fn,x=L.options,B=x===void 0?{}:x,M=L.name;typeof D=="function"&&(g=D({state:g,options:B,name:M,instance:S})||g)}}}},update:dhe(function(){return new Promise(function(C){S.forceUpdate(),C(g)})}),destroy:function(){T(),_=!0}};if(!x4(f,d))return S;S.setOptions(m).then(function(C){!_&&m.onFirstUpdate&&m.onFirstUpdate(C)});function E(){g.orderedModifiers.forEach(function(C){var R=C.name,b=C.options,F=b===void 0?{}:b,O=C.effect;if(typeof O=="function"){var L=O({state:g,name:R,instance:S,options:F}),D=function(){};v.push(L||D)}})}function T(){v.forEach(function(C){return C()}),v=[]}return S}}const ghe=phe({defaultModifiers:[Qde,nhe,Fde,Ude,ehe,Xde,she,Mde]}),mhe=["enabled","placement","strategy","modifiers"];function vhe(n,e){if(n==null)return{};var t={},r=Object.keys(n),o,u;for(u=0;u<r.length;u++)o=r[u],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}const yhe={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},Ehe={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:n})=>()=>{const{reference:e,popper:t}=n.elements;if("removeAttribute"in e){const r=(e.getAttribute("aria-describedby")||"").split(",").filter(o=>o.trim()!==t.id);r.length?e.setAttribute("aria-describedby",r.join(",")):e.removeAttribute("aria-describedby")}},fn:({state:n})=>{var e;const{popper:t,reference:r}=n.elements,o=(e=t.getAttribute("role"))==null?void 0:e.toLowerCase();if(t.id&&o==="tooltip"&&"setAttribute"in r){const u=r.getAttribute("aria-describedby");if(u&&u.split(",").indexOf(t.id)!==-1)return;r.setAttribute("aria-describedby",u?`${u},${t.id}`:t.id)}}},_he=[];function The(n,e,t={}){let{enabled:r=!0,placement:o="bottom",strategy:u="absolute",modifiers:h=_he}=t,f=vhe(t,mhe);const d=Ot.useRef(h),m=Ot.useRef(),g=Ot.useCallback(()=>{var C;(C=m.current)==null||C.update()},[]),v=Ot.useCallback(()=>{var C;(C=m.current)==null||C.forceUpdate()},[]),[_,S]=hde(Ot.useState({placement:o,update:g,forceUpdate:v,attributes:{},styles:{popper:{},arrow:{}}})),E=Ot.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:C})=>{const R={},b={};Object.keys(C.elements).forEach(F=>{R[F]=C.styles[F],b[F]=C.attributes[F]}),S({state:C,styles:R,attributes:b,update:g,forceUpdate:v,placement:C.placement})}}),[g,v,S]),T=Ot.useMemo(()=>(Cm(d.current,h)||(d.current=h),d.current),[h]);return Ot.useEffect(()=>{!m.current||!r||m.current.setOptions({placement:o,strategy:u,modifiers:[...T,E,yhe]})},[u,o,E,r,T]),Ot.useEffect(()=>{if(!(!r||n==null||e==null))return m.current=ghe(n,e,Object.assign({},f,{placement:o,strategy:u,modifiers:[...T,Ehe,E]})),()=>{m.current!=null&&(m.current.destroy(),m.current=void 0,S(C=>Object.assign({},C,{attributes:{},styles:{popper:{}}})))}},[r,n,e]),_}function C4(n,e){if(n.contains)return n.contains(e);if(n.compareDocumentPosition)return n===e||!!(n.compareDocumentPosition(e)&16)}const I4=()=>{};function She(n){return n.button===0}function Ahe(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}const XI=n=>n&&("current"in n?n.current:n),R4={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function xhe(n,e=I4,{disabled:t,clickTrigger:r="click"}={}){const o=Ot.useRef(!1),u=Ot.useRef(!1),h=Ot.useCallback(m=>{const g=XI(n);o.current=!g||Ahe(m)||!She(m)||!!C4(g,m.target)||u.current,u.current=!1},[n]),f=wl(m=>{const g=XI(n);g&&C4(g,m.target)&&(u.current=!0)}),d=wl(m=>{o.current||e(m)});Ot.useEffect(()=>{if(t||n==null)return;const m=u5(XI(n));let g=(m.defaultView||window).event,v=null;R4[r]&&(v=Rh(m,R4[r],f,!0));const _=Rh(m,r,h,!0),S=Rh(m,r,T=>{if(T===g){g=void 0;return}d(T)});let E=[];return"ontouchstart"in m.documentElement&&(E=[].slice.call(m.body.children).map(T=>Rh(T,"mousemove",I4))),()=>{v==null||v(),_(),S(),E.forEach(T=>T())}},[n,t,r,h,f,d])}function Che(n){const e={};return Array.isArray(n)?(n==null||n.forEach(t=>{e[t.name]=t}),e):n||e}function Ihe(n={}){return Array.isArray(n)?n:Object.keys(n).map(e=>(n[e].name=e,n[e]))}function Rhe({enabled:n,enableEvents:e,placement:t,flip:r,offset:o,fixed:u,containerPadding:h,arrowElement:f,popperConfig:d={}}){var m,g,v,_,S;const E=Che(d.modifiers);return Object.assign({},d,{placement:t,enabled:n,strategy:u?"fixed":d.strategy,modifiers:Ihe(Object.assign({},E,{eventListeners:{enabled:e,options:(m=E.eventListeners)==null?void 0:m.options},preventOverflow:Object.assign({},E.preventOverflow,{options:h?Object.assign({padding:h},(g=E.preventOverflow)==null?void 0:g.options):(v=E.preventOverflow)==null?void 0:v.options}),offset:{options:Object.assign({offset:o},(_=E.offset)==null?void 0:_.options)},arrow:Object.assign({},E.arrow,{enabled:!!f,options:Object.assign({},(S=E.arrow)==null?void 0:S.options,{element:f})}),flip:Object.assign({enabled:!!r},E.flip)}))})}const bhe=["children"];function Dhe(n,e){if(n==null)return{};var t={},r=Object.keys(n),o,u;for(u=0;u<r.length;u++)o=r[u],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}const Phe=()=>{};function A5(n={}){const e=Ot.useContext(hS),[t,r]=ffe(),o=Ot.useRef(!1),{flip:u,offset:h,rootCloseEvent:f,fixed:d=!1,placement:m,popperConfig:g={},enableEventListeners:v=!0,usePopper:_=!!e}=n,S=(e==null?void 0:e.show)==null?!!n.show:e.show;S&&!o.current&&(o.current=!0);const E=D=>{e==null||e.toggle(!1,D)},{placement:T,setMenu:C,menuElement:R,toggleElement:b}=e||{},F=The(b,R,Rhe({placement:m||T||"bottom-start",enabled:_,enableEvents:v??S,offset:h,flip:u,fixed:d,arrowElement:t,popperConfig:g})),O=Object.assign({ref:C||Phe,"aria-labelledby":b==null?void 0:b.id},F.attributes.popper,{style:F.styles.popper}),L={show:S,placement:T,hasShown:o.current,toggle:e==null?void 0:e.toggle,popper:_?F:null,arrowProps:_?Object.assign({ref:r},F.attributes.arrow,{style:F.styles.arrow}):{}};return xhe(R,E,{clickTrigger:f,disabled:!S}),[O,L]}const Lhe={usePopper:!0};function V1(n){let{children:e}=n,t=Dhe(n,bhe);const[r,o]=A5(t);return ln(iD,{children:e(r,o)})}V1.displayName="DropdownMenu";V1.defaultProps=Lhe;const x5={prefix:String(Math.round(Math.random()*1e10)),current:0},C5=Ws.createContext(x5);let Mhe=Boolean(typeof window<"u"&&window.document&&window.document.createElement),qI=new WeakMap;function whe(n=!1){let e=Ot.useContext(C5),t=Ot.useRef(null);if(t.current===null&&!n){var r,o;let u=(r=Ws.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)===null||r===void 0||(o=r.ReactCurrentOwner)===null||o===void 0?void 0:o.current;if(u){let h=qI.get(u);h==null?qI.set(u,{id:e.current,state:u.memoizedState}):u.memoizedState!==h.state&&(e.current=h.id,qI.delete(u))}t.current=++e.current}return t.current}function Ohe(n){let e=Ot.useContext(C5);e===x5&&!Mhe&&console.warn("When server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server.");let t=whe(!!n);return n||`react-aria${e.prefix}-${t}`}const I5=n=>{var e;return((e=n.getAttribute("role"))==null?void 0:e.toLowerCase())==="menu"},b4=()=>{};function R5(){const n=Ohe(),{show:e=!1,toggle:t=b4,setToggle:r,menuElement:o}=Ot.useContext(hS)||{},u=Ot.useCallback(f=>{t(!e,f)},[e,t]),h={id:n,ref:r||b4,onClick:u,"aria-expanded":!!e};return o&&I5(o)&&(h["aria-haspopup"]=!0),[h,{show:e,toggle:t}]}function b5({children:n}){const[e,t]=R5();return ln(iD,{children:n(e,t)})}b5.displayName="DropdownToggle";const Nhe=Ot.createContext(null),D4=(n,e=null)=>n!=null?String(n):e||null,Jb=Nhe,D5=Ot.createContext(null);D5.displayName="NavContext";const Fhe=D5,khe="data-rr-ui-";function P5(n){return`${khe}${n}`}const Uhe=["eventKey","disabled","onClick","active","as"];function Bhe(n,e){if(n==null)return{};var t={},r=Object.keys(n),o,u;for(u=0;u<r.length;u++)o=r[u],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}function L5({key:n,href:e,active:t,disabled:r,onClick:o}){const u=Ot.useContext(Jb),h=Ot.useContext(Fhe),{activeKey:f}=h||{},d=D4(n,e),m=t==null&&n!=null?D4(f)===d:t;return[{onClick:wl(v=>{r||(o==null||o(v),u&&!v.isPropagationStopped()&&u(d,v))}),"aria-disabled":r||void 0,"aria-selected":m,[P5("dropdown-item")]:""},{isActive:m}]}const M5=Ot.forwardRef((n,e)=>{let{eventKey:t,disabled:r,onClick:o,active:u,as:h=t5}=n,f=Bhe(n,Uhe);const[d]=L5({key:t,href:f.href,disabled:r,onClick:o,active:u});return ln(h,Object.assign({},f,{ref:e},d))});M5.displayName="DropdownItem";const w5=Ot.createContext(f5?window:void 0);w5.Provider;function jhe(){return Ot.useContext(w5)}function P4(){const n=fde(),e=Ot.useRef(null),t=Ot.useCallback(r=>{e.current=r,n()},[n]);return[e,t]}function D0({defaultShow:n,show:e,onSelect:t,onToggle:r,itemSelector:o=`* [${P5("dropdown-item")}]`,focusFirstItemOnShow:u,placement:h="bottom-start",children:f}){const d=jhe(),[m,g]=cde(e,n,r),[v,_]=P4(),S=v.current,[E,T]=P4(),C=E.current,R=pfe(m),b=Ot.useRef(null),F=Ot.useRef(!1),O=Ot.useContext(Jb),L=Ot.useCallback((U,w,k=w==null?void 0:w.type)=>{g(U,{originalEvent:w,source:k})},[g]),D=wl((U,w)=>{t==null||t(U,w),L(!1,w,"select"),w.isPropagationStopped()||O==null||O(U,w)}),x=Ot.useMemo(()=>({toggle:L,placement:h,show:m,menuElement:S,toggleElement:C,setMenu:_,setToggle:T}),[L,h,m,S,C,_,T]);S&&R&&!m&&(F.current=S.contains(S.ownerDocument.activeElement));const B=wl(()=>{C&&C.focus&&C.focus()}),M=wl(()=>{const U=b.current;let w=u;if(w==null&&(w=v.current&&I5(v.current)?"keyboard":!1),w===!1||w==="keyboard"&&!/^key.+$/.test(U))return;const k=h4(v.current,o)[0];k&&k.focus&&k.focus()});Ot.useEffect(()=>{m?M():F.current&&(F.current=!1,B())},[m,F,B,M]),Ot.useEffect(()=>{b.current=null});const I=(U,w)=>{if(!v.current)return null;const k=h4(v.current,o);let K=k.indexOf(U)+w;return K=Math.max(0,Math.min(K,k.length)),k[K]};return dfe(Ot.useCallback(()=>d.document,[d]),"keydown",U=>{var w,k;const{key:K}=U,W=U.target,Y=(w=v.current)==null?void 0:w.contains(W),J=(k=E.current)==null?void 0:k.contains(W);if(/input|textarea/i.test(W.tagName)&&(K===" "||K!=="Escape"&&Y||K==="Escape"&&W.type==="search")||!Y&&!J||K==="Tab"&&(!v.current||!m))return;b.current=U.type;const ue={originalEvent:U,source:U.type};switch(K){case"ArrowUp":{const ie=I(W,-1);ie&&ie.focus&&ie.focus(),U.preventDefault();return}case"ArrowDown":if(U.preventDefault(),!m)g(!0,ue);else{const ie=I(W,1);ie&&ie.focus&&ie.focus()}return;case"Tab":d5(W.ownerDocument,"keyup",ie=>{var Q;(ie.key==="Tab"&&!ie.target||!((Q=v.current)!=null&&Q.contains(ie.target)))&&g(!1,ue)},{once:!0});break;case"Escape":K==="Escape"&&(U.preventDefault(),U.stopPropagation()),g(!1,ue);break}}),ln(Jb.Provider,{value:D,children:ln(hS.Provider,{value:x,children:f})})}D0.displayName="Dropdown";D0.Menu=V1;D0.Toggle=b5;D0.Item=M5;const $1=Ot.createContext({});$1.displayName="DropdownContext";const O5=Ot.forwardRef(({bsPrefix:n,className:e,eventKey:t,disabled:r=!1,onClick:o,active:u,as:h=r5,...f},d)=>{const m=Li(n,"dropdown-item"),[g,v]=L5({key:t,href:f.href,disabled:r,onClick:o,active:u});return ln(h,{...f,...g,ref:d,className:Wr(e,m,v.isActive&&"active",r&&"disabled")})});O5.displayName="DropdownItem";const gS=Ot.createContext(null);gS.displayName="InputGroupContext";const N5=Ot.createContext(null);N5.displayName="NavbarContext";function F5(n,e){return n}const ah=pr.oneOf(["start","end"]),Khe=pr.oneOfType([ah,pr.shape({sm:ah}),pr.shape({md:ah}),pr.shape({lg:ah}),pr.shape({xl:ah}),pr.shape({xxl:ah}),pr.object]),Ghe={flip:!0};function k5(n,e,t){const r=t?"top-end":"top-start",o=t?"top-start":"top-end",u=t?"bottom-end":"bottom-start",h=t?"bottom-start":"bottom-end",f=t?"right-start":"left-start",d=t?"right-end":"left-end",m=t?"left-start":"right-start",g=t?"left-end":"right-end";let v=n?h:u;return e==="up"?v=n?o:r:e==="end"?v=n?g:m:e==="start"?v=n?d:f:e==="down-centered"?v="bottom":e==="up-centered"&&(v="top"),v}const mS=Ot.forwardRef(({bsPrefix:n,className:e,align:t,rootCloseEvent:r,flip:o,show:u,renderOnMount:h,as:f="div",popperConfig:d,variant:m,...g},v)=>{let _=!1;const S=Ot.useContext(N5),E=Li(n,"dropdown-menu"),{align:T,drop:C,isRTL:R}=Ot.useContext($1);t=t||T;const b=Ot.useContext(gS),F=[];if(t)if(typeof t=="object"){const U=Object.keys(t);if(U.length){const w=U[0],k=t[w];_=k==="start",F.push(`${E}-${w}-${k}`)}}else t==="end"&&(_=!0);const O=k5(_,C,R),[L,{hasShown:D,popper:x,show:B,toggle:M}]=A5({flip:o,rootCloseEvent:r,show:u,usePopper:!S&&F.length===0,offset:[0,2],popperConfig:d,placement:O});if(L.ref=F1(F5(v),L.ref),vfe(()=>{B&&(x==null||x.update())},[B]),!D&&!h&&!b)return null;typeof f!="string"&&(L.show=B,L.close=()=>M==null?void 0:M(!1),L.align=t);let I=g.style;return x!=null&&x.placement&&(I={...g.style,...L.style},g["x-placement"]=x.placement),ln(f,{...g,...L,style:I,...(F.length||S)&&{"data-bs-popper":"static"},className:Wr(e,E,B&&"show",_&&`${E}-end`,m&&`${E}-${m}`,...F)})});mS.displayName="DropdownMenu";mS.defaultProps=Ghe;const Whe={variant:"primary",active:!1,disabled:!1},P0=Ot.forwardRef(({as:n,bsPrefix:e,variant:t,size:r,active:o,className:u,...h},f)=>{const d=Li(e,"btn"),[m,{tagName:g}]=N1({tagName:n,...h});return ln(g,{...m,...h,ref:f,className:Wr(u,d,o&&"active",t&&`${d}-${t}`,r&&`${d}-${r}`,h.href&&h.disabled&&"disabled")})});P0.displayName="Button";P0.defaultProps=Whe;const z1=Ot.forwardRef(({bsPrefix:n,split:e,className:t,childBsPrefix:r,as:o=P0,...u},h)=>{const f=Li(n,"dropdown-toggle"),d=Ot.useContext(hS);r!==void 0&&(u.bsPrefix=r);const[m]=R5();return m.ref=F1(m.ref,F5(h)),ln(o,{className:Wr(t,f,e&&`${f}-split`,(d==null?void 0:d.show)&&"show"),...m,...u})});z1.displayName="DropdownToggle";const Hhe=od("dropdown-header",{defaultProps:{role:"heading"}}),Vhe=od("dropdown-divider",{Component:"hr",defaultProps:{role:"separator"}}),$he=od("dropdown-item-text",{Component:"span"}),zhe={navbar:!1,align:"start",autoClose:!0,drop:"down"},Y1=Ot.forwardRef((n,e)=>{const{bsPrefix:t,drop:r,show:o,className:u,align:h,onSelect:f,onToggle:d,focusFirstItemOnShow:m,as:g="div",navbar:v,autoClose:_,...S}=e5(n,{show:"onToggle"}),E=Ot.useContext(gS),T=Li(t,"dropdown"),C=Ife(),R=x=>_===!1?x==="click":_==="inside"?x!=="rootClose":_==="outside"?x!=="select":!0,b=wl((x,B)=>{B.originalEvent.currentTarget===document&&(B.source!=="keydown"||B.originalEvent.key==="Escape")&&(B.source="rootClose"),R(B.source)&&(d==null||d(x,B))}),O=k5(h==="end",r,C),L=Ot.useMemo(()=>({align:h,drop:r,isRTL:C}),[h,r,C]),D={down:T,"down-centered":`${T}-center`,up:"dropup","up-centered":"dropup-center dropup",end:"dropend",start:"dropstart"};return ln($1.Provider,{value:L,children:ln(D0,{placement:O,show:o,onSelect:f,onToggle:b,focusFirstItemOnShow:m,itemSelector:`.${T}-item:not(.disabled):not(:disabled)`,children:E?S.children:ln(g,{...S,ref:e,className:Wr(u,o&&"show",D[r])})})})});Y1.displayName="Dropdown";Y1.defaultProps=zhe;const U5=Object.assign(Y1,{Toggle:z1,Menu:mS,Item:O5,ItemText:$he,Divider:Vhe,Header:Hhe}),Yhe={id:pr.string,href:pr.string,onClick:pr.func,title:pr.node.isRequired,disabled:pr.bool,align:Khe,menuRole:pr.string,renderMenuOnMount:pr.bool,rootCloseEvent:pr.string,menuVariant:pr.oneOf(["dark"]),flip:pr.bool,bsPrefix:pr.string,variant:pr.string,size:pr.string},X1=Ot.forwardRef(({title:n,children:e,bsPrefix:t,rootCloseEvent:r,variant:o,size:u,menuRole:h,renderMenuOnMount:f,disabled:d,href:m,id:g,menuVariant:v,flip:_,...S},E)=>Ts(U5,{ref:E,...S,children:[ln(z1,{id:g,href:m,size:u,variant:o,disabled:d,childBsPrefix:t,children:n}),ln(mS,{role:h,renderOnMount:f,rootCloseEvent:r,variant:v,flip:_,children:e})]}));X1.displayName="DropdownButton";X1.propTypes=Yhe;const QI=[{key:"SHAKA",value:"Shaka"},{key:"HLS",value:"hls.js"},{key:"VIDEOJS",value:"VideoJs"},{key:"DASH",value:"Dash.js"}],Xhe=({setPlayerSelected:n})=>{const[e,t]=Ot.useState({});return ln(X1,{id:"dropdown-basic-button",className:"floatRight",onSelect:o=>{o!==e.key&&(n(QI[o].key),t({key:o,value:"Player: "+QI[o].value}))},title:(e==null?void 0:e.value)||"Select Player",children:QI.map((o,u)=>ln(U5.Item,{eventKey:u,children:o.value},u))})};pr.string,pr.bool,pr.bool,pr.bool,pr.bool;const qhe={fluid:!1,rounded:!1,roundedCircle:!1,thumbnail:!1},q1=Ot.forwardRef(({bsPrefix:n,className:e,fluid:t,rounded:r,roundedCircle:o,thumbnail:u,...h},f)=>(n=Li(n,"img"),ln("img",{ref:f,...h,className:Wr(e,t&&`${n}-fluid`,r&&"rounded",o&&"rounded-circle",u&&`${n}-thumbnail`)})));q1.displayName="Image";q1.defaultProps=qhe;const Qhe="/cmcd-validator/assets/warning-2c39ce86.svg",Jhe="/cmcd-validator/assets/error-bcdb507f.svg",Zhe="/cmcd-validator/assets/success-04284a73.svg",epe=n=>n<768?"mobile":"desktop",B5=()=>{const n=typeof window<"u",[e,t]=Ws.useState(n?480:window.innerWidth);function r(){t(window.innerWidth)}return Ws.useEffect(()=>(r(),window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r)}),[]),{widthSize:e,device:epe(e)}},tpe=n=>{const{message:e,type:t,onClick:r}=n,{widthSize:o,device:u}=B5();return Ts(P0,{variant:t,onClick:r,style:{width:"100%"},children:[(()=>{switch(t){case"warning":return ln("img",{width:"27",className:"pe-2",fluid:!0,src:Qhe});case"danger":return ln("img",{width:"27",className:"pe-2",fluid:!0,src:Jhe});default:return ln("img",{width:"27",className:"pe-2",fluid:!0,src:Zhe})}})(),`${e==null?void 0:e.slice(0,u==="mobile"?35:20+o/50)}...`]})};function npe({data:n,setValidatorOutput:e}){const t=n.map((r,o)=>{var h,f;const u=(h=r==null?void 0:r.result)!=null&&h.valid?((f=r==null?void 0:r.result)==null?void 0:f.warnings)!=[]?"success":"warning":"danger";if(Object.keys(r).length>0)return ln("div",{className:"py-1",children:ln(tpe,{message:r.url,type:u,onClick:()=>e(r)},o)})});return ln("div",{className:"data-window-wrapper",children:ln("div",{className:"data-window",children:t})})}var rpe=ya&&ya.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var u in o)o.hasOwnProperty(u)&&(r[u]=o[u])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),sT=ya&&ya.__assign||function(){return sT=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},sT.apply(this,arguments)},ipe=ya&&ya.__rest||function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&(t[r[o]]=n[r[o]]);return t},j5=ya&&ya.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e},gl=j5(pr),JI=j5(Ot);function spe(n,e,t){var r=t[n+"Style"]||"",o=e&&e[n]||"";return r?r+";"+o:o}function oh(n,e,t){var r=spe(n,e,t);return r?' style="'+r+'"':""}var ape={'"':"&quot;","'":"&apos;","&":"&amp;",">":"&gt;","<":"&lt"};function ope(n){return n&&n.replace(/<|>|&|"|'/g,function(e){return ape[e]})}var lpe=function(n){rpe(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(){var t=this.props,r=t.json,o=t.data,u=t.replacer,h=t.space,f=t.themeClassName,d=t.theme,m=t.onJSONPrettyError,g=t.onError,v=t.silent,_=t.mainStyle,S=t.keyStyle,E=t.valueStyle,T=t.stringStyle,C=t.booleanStyle,R=t.errorStyle,b=ipe(t,["json","data","replacer","space","themeClassName","theme","onJSONPrettyError","onError","silent","mainStyle","keyStyle","valueStyle","stringStyle","booleanStyle","errorStyle"]),F={mainStyle:_,keyStyle:S,valueStyle:E,stringStyle:T,booleanStyle:C,errorStyle:R},O=o||r;if(typeof O=="string")try{O=JSON.parse(O)}catch(L){return v||console.warn("[react-json-pretty]: "+L.message),m&&m(L),!m&&g&&(g(L),console.warn("JSONPretty#onError is deprecated, please use JSONPretty#onJSONPrettyError instead")),JI.createElement("div",sT({},b,{dangerouslySetInnerHTML:{__html:'<pre class="__json-pretty-error__"'+oh("error",d,F)+">"+ope(O)+"</pre>"}}))}return JI.createElement("div",sT({},b,{dangerouslySetInnerHTML:{__html:'<pre class="'+f+'"'+oh("main",d,F)+">"+this._pretty(d,O,u,+h,F)+"</pre>"}}))},e.prototype._pretty=function(t,r,o,u,h){var f=/^( *)("[^"]+": )?("[^"]*"|[\w.+-]*)?([,[{]|\[\s*\],?|\{\s*\},?)?$/mg,d=JSON.stringify(r,typeof o=="function"?o:null,isNaN(u)?2:u);return d&&d.replace(/&/g,"&amp;").replace(/\\"([^,])/g,"\\&quot;$1").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(f,this._replace.bind(null,t,h))},e.prototype._replace=function(t,r,o,u,h,f,d){var m="</span>",g='<span class="__json-key__"'+oh("key",t,r)+">",v='<span class="__json-value__"'+oh("value",t,r)+">",_='<span class="__json-string__"'+oh("string",t,r)+">",S='<span class="__json-boolean__"'+oh("boolean",t,r)+">",E=u||"";return h&&(E=E+'"'+g+h.replace(/^"|":\s$/g,"")+m+'": '),f&&(f==="true"||f==="false"?E=E+S+f+m:E=E+(f[0]==='"'?_:v)+f+m),E+(d||"")},e.propTypes={data:gl.any,json:gl.any,replacer:gl.func,silent:gl.bool,space:gl.oneOfType([gl.number,gl.string]),theme:gl.object,themeClassName:gl.string,onJSONPrettyError:gl.func},e.defaultProps={data:"",json:"",silent:!0,space:2,themeClassName:"__json-pretty__"},e}(JI.Component),upe=lpe,cpe={main:"line-height:1.3;color:#f5bb12;background:#1e1e1e;overflow:auto;",error:"line-height:1.3;color:#f5bb12;background:#1e1e1e;overflow:auto;",key:"color:#d3422e;",string:"color:#7fd6fa;",value:"color:#bfd7db;",boolean:"color:#4bae16;"};function fpe({output:n}){const[e,t]=Ot.useState(!1),[r,o]=Ot.useState("success");return Ot.useEffect(()=>{var u,h;if(n){t(!0);const f=(u=n==null?void 0:n.result)!=null&&u.valid?((h=n==null?void 0:n.result)==null?void 0:h.warnings)!=[]?"success":"warning":"danger";o(f)}},[n]),Ts(Xb,{show:e,variant:r,onClose:()=>t(!1),dismissible:!0,children:[ln("p",{className:"validatorBoxHeader",children:n.url}),ln("hr",{}),ln("div",{className:"validatorBox",children:ln(upe,{id:"json-pretty",theme:cpe,data:n.result})})]})}const dpe={type:pr.string,tooltip:pr.bool,as:pr.elementType},vS=Ot.forwardRef(({as:n="div",className:e,type:t="valid",tooltip:r=!1,...o},u)=>ln(n,{...o,ref:u,className:Wr(e,`${t}-${r?"tooltip":"feedback"}`)}));vS.displayName="Feedback";vS.propTypes=dpe;const Bu=Ot.createContext({}),L0=Ot.forwardRef(({id:n,bsPrefix:e,className:t,type:r="checkbox",isValid:o=!1,isInvalid:u=!1,as:h="input",...f},d)=>{const{controlId:m}=Ot.useContext(Bu);return e=Li(e,"form-check-input"),ln(h,{...f,ref:d,type:r,id:n||m,className:Wr(t,e,o&&"is-valid",u&&"is-invalid")})});L0.displayName="FormCheckInput";const aT=Ot.forwardRef(({bsPrefix:n,className:e,htmlFor:t,...r},o)=>{const{controlId:u}=Ot.useContext(Bu);return n=Li(n,"form-check-label"),ln("label",{...r,ref:o,htmlFor:t||u,className:Wr(e,n)})});aT.displayName="FormCheckLabel";function hpe(n,e){return Ot.Children.toArray(n).some(t=>Ot.isValidElement(t)&&t.type===e)}const K5=Ot.forwardRef(({id:n,bsPrefix:e,bsSwitchPrefix:t,inline:r=!1,reverse:o=!1,disabled:u=!1,isValid:h=!1,isInvalid:f=!1,feedbackTooltip:d=!1,feedback:m,feedbackType:g,className:v,style:_,title:S="",type:E="checkbox",label:T,children:C,as:R="input",...b},F)=>{e=Li(e,"form-check"),t=Li(t,"form-switch");const{controlId:O}=Ot.useContext(Bu),L=Ot.useMemo(()=>({controlId:n||O}),[O,n]),D=!C&&T!=null&&T!==!1||hpe(C,aT),x=ln(L0,{...b,type:E==="switch"?"checkbox":E,ref:F,isValid:h,isInvalid:f,disabled:u,as:R});return ln(Bu.Provider,{value:L,children:ln("div",{style:_,className:Wr(v,D&&e,r&&`${e}-inline`,o&&`${e}-reverse`,E==="switch"&&t),children:C||Ts(iD,{children:[x,D&&ln(aT,{title:S,children:T}),m&&ln(vS,{type:g,tooltip:d,children:m})]})})})});K5.displayName="FormCheck";const oT=Object.assign(K5,{Input:L0,Label:aT}),G5=Ot.forwardRef(({bsPrefix:n,type:e,size:t,htmlSize:r,id:o,className:u,isValid:h=!1,isInvalid:f=!1,plaintext:d,readOnly:m,as:g="input",...v},_)=>{const{controlId:S}=Ot.useContext(Bu);n=Li(n,"form-control");let E;return d?E={[`${n}-plaintext`]:!0}:E={[n]:!0,[`${n}-${t}`]:t},ln(g,{...v,type:e,size:r,ref:_,readOnly:m,id:o||S,className:Wr(u,E,h&&"is-valid",f&&"is-invalid",e==="color"&&`${n}-color`)})});G5.displayName="FormControl";const ppe=Object.assign(G5,{Feedback:vS}),gpe=od("form-floating"),Q1=Ot.forwardRef(({controlId:n,as:e="div",...t},r)=>{const o=Ot.useMemo(()=>({controlId:n}),[n]);return ln(Bu.Provider,{value:o,children:ln(e,{...t,ref:r})})});Q1.displayName="FormGroup";function mpe({as:n,bsPrefix:e,className:t,...r}){e=Li(e,"col");const o=i5(),u=s5(),h=[],f=[];return o.forEach(d=>{const m=r[d];delete r[d];let g,v,_;typeof m=="object"&&m!=null?{span:g,offset:v,order:_}=m:g=m;const S=d!==u?`-${d}`:"";g&&h.push(g===!0?`${e}${S}`:`${e}${S}-${g}`),_!=null&&f.push(`order${S}-${_}`),v!=null&&f.push(`offset${S}-${v}`)}),[{...r,className:Wr(t,...h,...f)},{as:n,bsPrefix:e,spans:h}]}const bh=Ot.forwardRef((n,e)=>{const[{className:t,...r},{as:o="div",bsPrefix:u,spans:h}]=mpe(n);return ln(o,{...r,ref:e,className:Wr(t,!h.length&&u)})});bh.displayName="Col";const vpe={column:!1,visuallyHidden:!1},J1=Ot.forwardRef(({as:n="label",bsPrefix:e,column:t,visuallyHidden:r,className:o,htmlFor:u,...h},f)=>{const{controlId:d}=Ot.useContext(Bu);e=Li(e,"form-label");let m="col-form-label";typeof t=="string"&&(m=`${m} ${m}-${t}`);const g=Wr(o,e,r&&"visually-hidden",t&&m);return u=u||d,t?ln(bh,{ref:f,as:"label",className:g,htmlFor:u,...h}):ln(n,{ref:f,className:g,htmlFor:u,...h})});J1.displayName="FormLabel";J1.defaultProps=vpe;const W5=Ot.forwardRef(({bsPrefix:n,className:e,id:t,...r},o)=>{const{controlId:u}=Ot.useContext(Bu);return n=Li(n,"form-range"),ln("input",{...r,type:"range",ref:o,className:Wr(e,n),id:t||u})});W5.displayName="FormRange";const H5=Ot.forwardRef(({bsPrefix:n,size:e,htmlSize:t,className:r,isValid:o=!1,isInvalid:u=!1,id:h,...f},d)=>{const{controlId:m}=Ot.useContext(Bu);return n=Li(n,"form-select"),ln("select",{...f,size:t,ref:d,className:Wr(r,n,e&&`${n}-${e}`,o&&"is-valid",u&&"is-invalid"),id:h||m})});H5.displayName="FormSelect";const V5=Ot.forwardRef(({bsPrefix:n,className:e,as:t="small",muted:r,...o},u)=>(n=Li(n,"form-text"),ln(t,{...o,ref:u,className:Wr(e,n,r&&"text-muted")})));V5.displayName="FormText";const $5=Ot.forwardRef((n,e)=>ln(oT,{...n,ref:e,type:"switch"}));$5.displayName="Switch";const ype=Object.assign($5,{Input:oT.Input,Label:oT.Label}),z5=Ot.forwardRef(({bsPrefix:n,className:e,children:t,controlId:r,label:o,...u},h)=>(n=Li(n,"form-floating"),Ts(Q1,{ref:h,className:Wr(e,n),controlId:r,...u,children:[t,ln("label",{htmlFor:r,children:o})]})));z5.displayName="FloatingLabel";const Epe={_ref:pr.any,validated:pr.bool,as:pr.elementType},Z1=Ot.forwardRef(({className:n,validated:e,as:t="form",...r},o)=>ln(t,{...r,ref:o,className:Wr(n,e&&"was-validated")}));Z1.displayName="Form";Z1.propTypes=Epe;const L4=Object.assign(Z1,{Group:Q1,Control:ppe,Floating:gpe,Check:oT,Switch:ype,Label:J1,Text:V5,Range:W5,Select:H5,FloatingLabel:z5}),eL=od("input-group-text",{Component:"span"}),_pe=n=>ln(eL,{children:ln(L0,{type:"checkbox",...n})}),Tpe=n=>ln(eL,{children:ln(L0,{type:"radio",...n})}),Y5=Ot.forwardRef(({bsPrefix:n,size:e,hasValidation:t,className:r,as:o="div",...u},h)=>{n=Li(n,"input-group");const f=Ot.useMemo(()=>({}),[]);return ln(gS.Provider,{value:f,children:ln(o,{ref:h,...u,className:Wr(r,n,e&&`${n}-${e}`,t&&"has-validation")})})});Y5.displayName="InputGroup";const Spe=Object.assign(Y5,{Text:eL,Radio:Tpe,Checkbox:_pe}),Ape={fluid:!1},tL=Ot.forwardRef(({bsPrefix:n,fluid:e,as:t="div",className:r,...o},u)=>{const h=Li(n,"container"),f=typeof e=="string"?`-${e}`:"-fluid";return ln(t,{ref:u,...o,className:Wr(r,e?`${h}${f}`:h)})});tL.displayName="Container";tL.defaultProps=Ape;const Lf=Ot.forwardRef(({bsPrefix:n,className:e,as:t="div",...r},o)=>{const u=Li(n,"row"),h=i5(),f=s5(),d=`${u}-cols`,m=[];return h.forEach(g=>{const v=r[g];delete r[g];let _;v!=null&&typeof v=="object"?{cols:_}=v:_=v;const S=g!==f?`-${g}`:"";_!=null&&m.push(`${d}${S}-${_}`)}),ln(t,{ref:o,...r,className:Wr(e,u,...m)})});Lf.displayName="Row";function xpe(n,e){let t=[];switch(e.type){case"saveQuery":t=[e.payload,...n],t.splice(30,t.length-30>0?t.length-30:0);break}return t}function Cpe(){const[n,e]=Ot.useState(""),[t,r]=Ot.useReducer(xpe,[]),[o,u]=Ot.useState(""),[h,f]=Ot.useState(""),{device:d}=B5(),m=S=>{e(S),r({type:"reset",payload:{}}),f("")},g=S=>{r({...S})},v=S=>{S.preventDefault(),f(S.target.manifest.value)},_=S=>{if(d===S)return ln(npe,{data:t,setValidatorOutput:u})};return Ts(tL,{fluid:!0,className:"px-5",children:[ln(Lf,{className:"justify-content-md-center pb-4",children:ln("a",{className:"logo",href:"https://montevideotech.dev/",children:ln(q1,{fluid:!0,src:"https://montevideotech.dev/wp-content/uploads/2020/09/mvd-tech-1.png",alt:"MontevideoTech logo"})})}),Ts(Lf,{className:"mainContainer",children:[Ts(bh,{sm:8,children:[" ",Ts(Lf,{className:"justify-content-between",children:[" ",ln(bh,{className:"mb-3",md:"auto",children:ln(Xhe,{setPlayerSelected:m})}),ln(bh,{children:ln(L4,{onSubmit:v,children:Ts(Spe,{className:"mb-3",children:[ln(L4.Control,{name:"manifest",required:!0,placeholder:"Manifest URL","aria-label":"Recipient's username","aria-describedby":"basic-addon2"}),ln(P0,{variant:"primary",type:"submit",children:"start"})]})})})]}),Ts(Lf,{className:"mb-3",children:[" ",ln(lde,{playerSelected:n,playerDispatch:g,manifestURI:h})]}),Ts(Lf,{className:"mb-3",children:[" ",_("mobile")]}),Ts(Lf,{className:"px-3",children:[" ",ln(fpe,{output:o})]})]}),Ts(bh,{sm:4,children:[" ",_("desktop")]})]})]})}ZI.createRoot(document.getElementById("root")).render(ln(Cpe,{}));
